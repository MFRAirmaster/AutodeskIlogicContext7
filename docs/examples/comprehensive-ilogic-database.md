# Comprehensive iLogic Code Database

**Total Posts:** 213
**Total Code Snippets:** 1878

## Statistics by Category

- **Advanced**: 160 posts
- **Api**: 45 posts
- **Basic**: 3 posts
- **Troubleshooting**: 5 posts

---

## Table of Contents

- [Advanced Examples (#160)](#advanced-examples)
- [Api Examples (#45)](#api-examples)
- [Basic Examples (#3)](#basic-examples)
- [Troubleshooting Examples (#5)](#troubleshooting-examples)

---

## Advanced Examples

Total: 160 posts

### 1. 3D sketch line between two UCS center points

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/3d-sketch-line-between-two-ucs-center-points/td-p/13839610](https://forums.autodesk.com/t5/inventor-programming-forum/3d-sketch-line-between-two-ucs-center-points/td-p/13839610)

**Author:** jarle_oudalstoelEN4BR

**Date:** ‎10-06-2025
	
		
		11:19 AM

**Description:** Hi.  I am trying to create a 3D sketch between two predefined UCS center points.  I have then UCS's named so in this case it would be between NR0-00 and NR1-01 I did find a code snippet that let's me pick the points but I would like the code to do it for me.  Here is the code I found:Dim doc As Part...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim doc As PartDocument = ThisDoc.Document
Dim def As PartComponentDefinition = doc.ComponentDefinition

Dim wpA1 = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkPointFilter, "Select work point A1")
Dim wpB1 = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkPointFilter, "Select work point B1")


Dim sketch3D As Sketch3D = def.Sketches3D.Add()
sketch3D.SketchLines3D.AddByTwoPoints(wpA1, wpB1)
sketch3D.Name = ("Strut 01")
```

#### Code Block 2

```vb
Dim doc As PartDocument = ThisDoc.Document
Dim def As PartComponentDefinition = doc.ComponentDefinition

Dim wpA1 = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkPointFilter, "Select work point A1")
Dim wpB1 = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkPointFilter, "Select work point B1")


Dim sketch3D As Sketch3D = def.Sketches3D.Add()
sketch3D.SketchLines3D.AddByTwoPoints(wpA1, wpB1)
sketch3D.Name = ("Strut 01")
```

#### Code Block 3

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As PartDocument = App.ActiveDocument
	Dim oCompDef As PartComponentDefinition = oDoc.ComponentDefinition
	
	Dim oTG As TransientGeometry = App.TransientGeometry
	
	Dim UCS1 As UserCoordinateSystem
	Dim UCS2 As UserCoordinateSystem
	
	For Each iUCS As UserCoordinateSystem In oCompDef.UserCoordinateSystems 'Collect the UCS objects dynamically, This example uses their names. 
		If iUCS.Name.Contains("First UCS") Then 
			UCS1 = iUCS
		Else If iUCS.Name.Contains("Second UCS") Then 
			UCS2 = iUCS
		End If 
	Next
		
	Dim UCSPoint1 As Point = UCS1.Origin.Point 'Throw the points of the origins into usable point objects. 
	Dim UCSPoint2 As Point = UCS2.Origin.Point
	
	Dim UCSPoint1B As WorkPoint = oTG.CreatePoint(UCS1.Origin.Point.X, UCS1.Origin.Point.Y, UCS1.Origin.Point.Z) 'How to create different kinds of points depending on needs. 
	Dim UCSPoint2B As WorkPoint = oTG.CreatePoint(UCS2.Origin.Point.X, UCS2.Origin.Point.Y, UCS2.Origin.Point.Z)
	
	
	Dim Sketch3d As Sketch3D = oCompDef.Sketches3D.Add()


	Dim SketchLine As SketchLine3D
	
	Try
		SketchLine	= Sketch3d.SketchLines3D.AddByTwoPoints(UCSPoint1, UCSPoint2)
	Catch
		SketchLine = Sketch3d.SketchLines3D.AddByTwoPoints(UCSPoint1B, UCSPoint2B) 'The .addbytwo points calls for general point objects. Sometimes finniky, you might need to supply different points. 
	End Try
	
	
	
	
End Sub
```

#### Code Block 4

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As PartDocument = App.ActiveDocument
	Dim oCompDef As PartComponentDefinition = oDoc.ComponentDefinition
	
	Dim oTG As TransientGeometry = App.TransientGeometry
	
	Dim UCS1 As UserCoordinateSystem
	Dim UCS2 As UserCoordinateSystem
	
	For Each iUCS As UserCoordinateSystem In oCompDef.UserCoordinateSystems 'Collect the UCS objects dynamically, This example uses their names. 
		If iUCS.Name.Contains("First UCS") Then 
			UCS1 = iUCS
		Else If iUCS.Name.Contains("Second UCS") Then 
			UCS2 = iUCS
		End If 
	Next
		
	Dim UCSPoint1 As Point = UCS1.Origin.Point 'Throw the points of the origins into usable point objects. 
	Dim UCSPoint2 As Point = UCS2.Origin.Point
	
	Dim UCSPoint1B As WorkPoint = oTG.CreatePoint(UCS1.Origin.Point.X, UCS1.Origin.Point.Y, UCS1.Origin.Point.Z) 'How to create different kinds of points depending on needs. 
	Dim UCSPoint2B As WorkPoint = oTG.CreatePoint(UCS2.Origin.Point.X, UCS2.Origin.Point.Y, UCS2.Origin.Point.Z)
	
	
	Dim Sketch3d As Sketch3D = oCompDef.Sketches3D.Add()


	Dim SketchLine As SketchLine3D
	
	Try
		SketchLine	= Sketch3d.SketchLines3D.AddByTwoPoints(UCSPoint1, UCSPoint2)
	Catch
		SketchLine = Sketch3d.SketchLines3D.AddByTwoPoints(UCSPoint1B, UCSPoint2B) 'The .addbytwo points calls for general point objects. Sometimes finniky, you might need to supply different points. 
	End Try
	
	
	
	
End Sub
```

#### Code Block 5

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As PartDocument = App.ActiveDocument
	Dim oCompDef As PartComponentDefinition = oDoc.ComponentDefinition
	
	Dim oTG As TransientGeometry = App.TransientGeometry
	
	Dim UCS1 As UserCoordinateSystem
	Dim UCS2 As UserCoordinateSystem
	
	For Each iUCS As UserCoordinateSystem In oCompDef.UserCoordinateSystems 'Collect the UCS objects dynamically, This example uses their names. 
		If iUCS.Name.Contains("First UCS") Then 
			UCS1 = iUCS
		Else If iUCS.Name.Contains("Second UCS") Then 
			UCS2 = iUCS
		End If 
	Next
		
	Dim UCSPoint1 As Point = UCS1.Origin.Point 'Throw the points of the origins into usable point objects. 
	Dim UCSPoint2 As Point = UCS2.Origin.Point
	
	Dim UCSPoint1B As WorkPoint = oTG.CreatePoint(UCS1.Origin.Point.X, UCS1.Origin.Point.Y, UCS1.Origin.Point.Z) 'How to create different kinds of points depending on needs. 
	Dim UCSPoint2B As WorkPoint = oTG.CreatePoint(UCS2.Origin.Point.X, UCS2.Origin.Point.Y, UCS2.Origin.Point.Z)
	
	
	Dim Sketch3d As Sketch3D = oCompDef.Sketches3D.Add()


	Dim SketchLine As SketchLine3D
	
	Try
		SketchLine	= Sketch3d.SketchLines3D.AddByTwoPoints(UCSPoint1, UCSPoint2)
	Catch
		SketchLine = Sketch3d.SketchLines3D.AddByTwoPoints(UCSPoint1B, UCSPoint2B) 'The .addbytwo points calls for general point objects. Sometimes finniky, you might need to supply different points. 
	End Try
	
	
	
	
End Sub
```

#### Code Block 6

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As PartDocument = App.ActiveDocument
	Dim oCompDef As PartComponentDefinition = oDoc.ComponentDefinition
	
	Dim oTG As TransientGeometry = App.TransientGeometry
	
	Dim UCS1 As UserCoordinateSystem
	Dim UCS2 As UserCoordinateSystem
	
	For Each iUCS As UserCoordinateSystem In oCompDef.UserCoordinateSystems 'Collect the UCS objects dynamically, This example uses their names. 
		If iUCS.Name.Contains("First UCS") Then 
			UCS1 = iUCS
		Else If iUCS.Name.Contains("Second UCS") Then 
			UCS2 = iUCS
		End If 
	Next
		
	Dim UCSPoint1 As Point = UCS1.Origin.Point 'Throw the points of the origins into usable point objects. 
	Dim UCSPoint2 As Point = UCS2.Origin.Point
	
	Dim UCSPoint1B As WorkPoint = oTG.CreatePoint(UCS1.Origin.Point.X, UCS1.Origin.Point.Y, UCS1.Origin.Point.Z) 'How to create different kinds of points depending on needs. 
	Dim UCSPoint2B As WorkPoint = oTG.CreatePoint(UCS2.Origin.Point.X, UCS2.Origin.Point.Y, UCS2.Origin.Point.Z)
	
	
	Dim Sketch3d As Sketch3D = oCompDef.Sketches3D.Add()


	Dim SketchLine As SketchLine3D
	
	Try
		SketchLine	= Sketch3d.SketchLines3D.AddByTwoPoints(UCSPoint1, UCSPoint2)
	Catch
		SketchLine = Sketch3d.SketchLines3D.AddByTwoPoints(UCSPoint1B, UCSPoint2B) 'The .addbytwo points calls for general point objects. Sometimes finniky, you might need to supply different points. 
	End Try
	
	
	
	
End Sub
```

---

### 2. About the issue of obtaining the extrusion start face

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/about-the-issue-of-obtaining-the-extrusion-start-face/td-p/13788769](https://forums.autodesk.com/t5/inventor-programming-forum/about-the-issue-of-obtaining-the-extrusion-start-face/td-p/13788769)

**Author:** Willem1

**Date:** ‎08-29-2025
	
		
		07:19 AM

**Description:** Hi, Guys.When I rebuild the extruder feature, if this extruder feature starts from workplanes, my code works.However, if the start face is from other features, it’s not working. The face I captured is invalid. Private Function HandleDistanceFromFaceExtent(oExtrude As ExtrudeFeature) As Boolean      ...

**Code Snippets (4):**

#### Code Block 1

```vb
Private Function HandleDistanceFromFaceExtent(oExtrude As ExtrudeFeature) As Boolean
        Try
            Dim oDistFace As DistanceFromFaceExtent = CType(oExtrude.Extent, DistanceFromFaceExtent)
            Dim dirs As PartFeatureExtentDirectionEnum() = {
                PartFeatureExtentDirectionEnum.kPositiveExtentDirection,
                PartFeatureExtentDirectionEnum.kNegativeExtentDirection,
                PartFeatureExtentDirectionEnum.kSymmetricExtentDirection
            }

            Dim currentDir As PartFeatureExtentDirectionEnum = oDistFace.Direction
            Dim idx As Integer = Array.IndexOf(dirs, currentDir)
            Dim newDir As PartFeatureExtentDirectionEnum = dirs((If(idx = -1, 0, idx + 1) Mod dirs.Length))

            Dim fromFace As Object = oDistFace.FromFace
            Dim distance As Object = oDistFace.Distance.Expression

            oExtrude.Definition.SetDistanceFromFaceExtent(fromFace, True, newDir, distance)
            Return True
        Catch
            Return False
        End Try
    End Function
```

#### Code Block 2

```vb
Private Function HandleDistanceFromFaceExtent(oExtrude As ExtrudeFeature) As Boolean
        Try
            Dim oDistFace As DistanceFromFaceExtent = CType(oExtrude.Extent, DistanceFromFaceExtent)
            Dim dirs As PartFeatureExtentDirectionEnum() = {
                PartFeatureExtentDirectionEnum.kPositiveExtentDirection,
                PartFeatureExtentDirectionEnum.kNegativeExtentDirection,
                PartFeatureExtentDirectionEnum.kSymmetricExtentDirection
            }

            Dim currentDir As PartFeatureExtentDirectionEnum = oDistFace.Direction
            Dim idx As Integer = Array.IndexOf(dirs, currentDir)
            Dim newDir As PartFeatureExtentDirectionEnum = dirs((If(idx = -1, 0, idx + 1) Mod dirs.Length))

            Dim fromFace As Object = oDistFace.FromFace
            Dim distance As Object = oDistFace.Distance.Expression

            oExtrude.Definition.SetDistanceFromFaceExtent(fromFace, True, newDir, distance)
            Return True
        Catch
            Return False
        End Try
    End Function
```

#### Code Block 3

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(oInvApp.ActiveDocument, PartDocument)
	If HandleDistanceFromFaceExtent(oPDoc.ComponentDefinition.Features(1)) Then
		Logger.Info("GOOD!")
	Else
		Logger.Info("NOT GOOD!")
	End If	
End Sub

Private Function HandleDistanceFromFaceExtent(oExtrude As ExtrudeFeature) As Boolean
    Try
        Dim oDistFace As PartFeatureExtent = CType(oExtrude.Definition.Extent, PartFeatureExtent)
        Dim dirs As PartFeatureExtentDirectionEnum() = {
            PartFeatureExtentDirectionEnum.kPositiveExtentDirection,
            PartFeatureExtentDirectionEnum.kNegativeExtentDirection,
            PartFeatureExtentDirectionEnum.kSymmetricExtentDirection
        }

        Dim currentDir As PartFeatureExtentDirectionEnum = oDistFace.Direction
        Dim idx As Integer = Array.IndexOf(dirs, currentDir)
        Dim newDir As PartFeatureExtentDirectionEnum = dirs((If (idx = -1, 0, idx + 1) Mod dirs.Length))
		
	    Dim distance As Object = oDistFace.Distance.Expression
		If oDistFace.Type = 83917824 Then
			oExtrude.Definition.SetDistanceExtent(distance, newDir)
		Else
	        Dim fromFace As Object = oDistFace.FromFace	
	        oExtrude.Definition.SetDistanceFromFaceExtent(fromFace, True, newDir, distance)
		End If
        Return True
    Catch
        Return False
    End Try
End Function
```

#### Code Block 4

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(oInvApp.ActiveDocument, PartDocument)
	If HandleDistanceFromFaceExtent(oPDoc.ComponentDefinition.Features(1)) Then
		Logger.Info("GOOD!")
	Else
		Logger.Info("NOT GOOD!")
	End If	
End Sub

Private Function HandleDistanceFromFaceExtent(oExtrude As ExtrudeFeature) As Boolean
    Try
        Dim oDistFace As PartFeatureExtent = CType(oExtrude.Definition.Extent, PartFeatureExtent)
        Dim dirs As PartFeatureExtentDirectionEnum() = {
            PartFeatureExtentDirectionEnum.kPositiveExtentDirection,
            PartFeatureExtentDirectionEnum.kNegativeExtentDirection,
            PartFeatureExtentDirectionEnum.kSymmetricExtentDirection
        }

        Dim currentDir As PartFeatureExtentDirectionEnum = oDistFace.Direction
        Dim idx As Integer = Array.IndexOf(dirs, currentDir)
        Dim newDir As PartFeatureExtentDirectionEnum = dirs((If (idx = -1, 0, idx + 1) Mod dirs.Length))
		
	    Dim distance As Object = oDistFace.Distance.Expression
		If oDistFace.Type = 83917824 Then
			oExtrude.Definition.SetDistanceExtent(distance, newDir)
		Else
	        Dim fromFace As Object = oDistFace.FromFace	
	        oExtrude.Definition.SetDistanceFromFaceExtent(fromFace, True, newDir, distance)
		End If
        Return True
    Catch
        Return False
    End Try
End Function
```

---

### 3. Access IManagedDrawingView from External Rule

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/access-imanageddrawingview-from-external-rule/td-p/11823860](https://forums.autodesk.com/t5/inventor-programming-forum/access-imanageddrawingview-from-external-rule/td-p/11823860)

**Author:** jhomerWAP8S

**Date:** ‎03-15-2023
	
		
		11:11 AM

**Description:** Hello!I am trying to automate some design tasks and would like to create a series of drawings from a rule run from an assembly document. I would like to access the IManagedDrawingView of each drawing I create, in order to run GetIntent from each view. Is there any way to access this without using Th...

**Code Snippets (4):**

#### Code Block 1

```vb
iLogicVb.CreateObjectProvider(ThisDoc.Document)
```

#### Code Block 2

```vb
iLogicVb.CreateObjectProvider(ThisDoc.Document)
```

#### Code Block 3

```vb
iLogicVb.CreateObjectProvider(ThisDoc.Document)
```

#### Code Block 4

```vb
iLogicVb.CreateObjectProvider(ThisDoc.Document)
```

#### Code Block 5

```vb
oDoc = ThisDoc.Document
SOP = StandardObjectFactory.Create(oDoc)
oManagedDView = SOP.ThisDrawing.Sheet("SheetName").View("ViewName")
```

#### Code Block 6

```vb
oDoc = ThisDoc.Document
SOP = StandardObjectFactory.Create(oDoc)
oManagedDView = SOP.ThisDrawing.Sheet("SheetName").View("ViewName")
```

#### Code Block 7

```vb
oDoc = ThisDoc.Document
SOP = StandardObjectFactory.Create(oDoc)
oManagedDView = SOP.ThisDrawing.Sheet("SheetName").View("ViewName")
```

#### Code Block 8

```vb
oDoc = ThisDoc.Document
SOP = StandardObjectFactory.Create(oDoc)
oManagedDView = SOP.ThisDrawing.Sheet("SheetName").View("ViewName")
```

---

### 4. Add sketchedsymbol and weldingsymbol

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/add-sketchedsymbol-and-weldingsymbol/td-p/13746582](https://forums.autodesk.com/t5/inventor-programming-forum/add-sketchedsymbol-and-weldingsymbol/td-p/13746582)

**Author:** m.schrepfer

**Date:** ‎07-30-2025
	
		
		07:33 AM

**Description:** Hi,I want to add a sketchedsymbol and a weldingsymbol. The weldingsymbol should be referenced to the sketchedsymbol like this screenshot. The sketchedsymbol is placed at the drawingsheet but adding the weldingsymbol runs into an error.I use a sketchedsymbol to work with Inventor User Defined Propert...

**Code Snippets (4):**

#### Code Block 1

```vb
Public Function AddDrawingWeldingSymbol()

    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrwDoc As DrawingDocument
    Set oDrwDoc = ThisApplication.ActiveDocument

    ' Set a reference to the active sheet.
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrwDoc.ActiveSheet

    ' Obtain a reference to the desired sketched symbol definition.
    Dim oSketchedSymbolDef As SketchedSymbolDefinition
    Set oSketchedSymbolDef = oDrwDoc.SketchedSymbolDefinitions.Item("Schweisshinweis_01")

    Dim getPoint As New CLS_GetPoint
    Dim pnt As Point2d
    
    Set pnt = getPoint.GetDrawingPoint("Platzierpunkt", kLeftMouseButton)
    
    ' Set a reference to the TransientGeometry object.
    Dim oTG As TransientGeometry
    Set oTG = ThisApplication.TransientGeometry
    
    Dim oPointPlace As Point2d
    Set oPointPlace = oTG.CreatePoint2d(pnt.X, pnt.Y)
    
    ' Add an instance of the sketched symbol definition to the sheet.
    Dim oSketchedSymbol As SketchedSymbol
    Set oSketchedSymbol = oActiveSheet.SketchedSymbols.Add(oSketchedSymbolDef, oPointPlace)

    Dim oLeaderPoints As ObjectCollection
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

    ' Create a few leader points.
    Call oLeaderPoints.Add(oPointPlace)
    
    Dim oLine As SketchLine
    Set oLine = oSketchedSymbol.Definition.Sketch.SketchLines(1)

    ' Create an intent and add to the leader points collection.
    ' This is the geometry that the symbol will attach to.
    Dim oGeometryIntent As GeometryIntent
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(oLine, oLine.StartSketchPoint)

    Call oLeaderPoints.Add(oGeometryIntent)
    
    Dim oWeldingSymDefs As DrawingWeldingSymbolDefinitions
    Set oWeldingSymDefs = oActiveSheet.WeldingSymbols.CreateDefinitions()
   
    Dim oWeldingSymDef As DrawingWeldingSymbolDefinition
    Set oWeldingSymDef = oWeldingSymDefs.Add(1)
    
    ' Specify the weld symbol type(WeldSymbolTypeEnum/BackingSymbolTypeEnum)
    ' Kehlnaht
    oWeldingSymDef.WeldSymbolOne.WeldSymbolType = 124162
    oWeldingSymDef.WeldSymbolOne.SizeOrStrength = "a3"
    
    ' Create the symbol with a leader
    Dim oSymbol As DrawingWeldingSymbol
    Set oSymbol = oActiveSheet.WeldingSymbols.Add(oLeaderPoints, oWeldingSymDefs)
    
End Function
```

#### Code Block 2

```vb
Public Function AddDrawingWeldingSymbol()

    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrwDoc As DrawingDocument
    Set oDrwDoc = ThisApplication.ActiveDocument

    ' Set a reference to the active sheet.
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrwDoc.ActiveSheet

    ' Obtain a reference to the desired sketched symbol definition.
    Dim oSketchedSymbolDef As SketchedSymbolDefinition
    Set oSketchedSymbolDef = oDrwDoc.SketchedSymbolDefinitions.Item("Schweisshinweis_01")

    Dim getPoint As New CLS_GetPoint
    Dim pnt As Point2d
    
    Set pnt = getPoint.GetDrawingPoint("Platzierpunkt", kLeftMouseButton)
    
    ' Set a reference to the TransientGeometry object.
    Dim oTG As TransientGeometry
    Set oTG = ThisApplication.TransientGeometry
    
    Dim oPointPlace As Point2d
    Set oPointPlace = oTG.CreatePoint2d(pnt.X, pnt.Y)
    
    ' Add an instance of the sketched symbol definition to the sheet.
    Dim oSketchedSymbol As SketchedSymbol
    Set oSketchedSymbol = oActiveSheet.SketchedSymbols.Add(oSketchedSymbolDef, oPointPlace)

    Dim oLeaderPoints As ObjectCollection
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

    ' Create a few leader points.
    Call oLeaderPoints.Add(oPointPlace)
    
    Dim oLine As SketchLine
    Set oLine = oSketchedSymbol.Definition.Sketch.SketchLines(1)

    ' Create an intent and add to the leader points collection.
    ' This is the geometry that the symbol will attach to.
    Dim oGeometryIntent As GeometryIntent
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(oLine, oLine.StartSketchPoint)

    Call oLeaderPoints.Add(oGeometryIntent)
    
    Dim oWeldingSymDefs As DrawingWeldingSymbolDefinitions
    Set oWeldingSymDefs = oActiveSheet.WeldingSymbols.CreateDefinitions()
   
    Dim oWeldingSymDef As DrawingWeldingSymbolDefinition
    Set oWeldingSymDef = oWeldingSymDefs.Add(1)
    
    ' Specify the weld symbol type(WeldSymbolTypeEnum/BackingSymbolTypeEnum)
    ' Kehlnaht
    oWeldingSymDef.WeldSymbolOne.WeldSymbolType = 124162
    oWeldingSymDef.WeldSymbolOne.SizeOrStrength = "a3"
    
    ' Create the symbol with a leader
    Dim oSymbol As DrawingWeldingSymbol
    Set oSymbol = oActiveSheet.WeldingSymbols.Add(oLeaderPoints, oWeldingSymDefs)
    
End Function
```

#### Code Block 3

```vb
Public Function AddDrawingWeldingSymbol()

    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrwDoc As DrawingDocument
    Set oDrwDoc = ThisApplication.ActiveDocument

    ' Set a reference to the active sheet.
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrwDoc.ActiveSheet

    ' Obtain a reference to the desired sketched symbol definition.
    Dim oSketchedSymbolDef As SketchedSymbolDefinition
    Set oSketchedSymbolDef = oDrwDoc.SketchedSymbolDefinitions.Item("Schweisshinweis_01")

    Dim getPoint As New CLS_GetPoint
    Dim pnt As Point2d
    
    Set pnt = getPoint.GetDrawingPoint("Platzierpunkt", kLeftMouseButton)
    
    ' Set a reference to the TransientGeometry object.
    Dim oTG As TransientGeometry
    Set oTG = ThisApplication.TransientGeometry
    
    Dim oPointPlace As Point2d
    Set oPointPlace = oTG.CreatePoint2d(pnt.X, pnt.Y)
    
    ' Add an instance of the sketched symbol definition to the sheet.
    Dim oSketchedSymbol As SketchedSymbol
    Set oSketchedSymbol = oActiveSheet.SketchedSymbols.Add(oSketchedSymbolDef, oPointPlace)

    Dim oLeaderPoints As ObjectCollection
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

    ' Create a few leader points.
    Call oLeaderPoints.Add(oPointPlace)
    
    Dim oLine As SketchLine
    Set oLine = oSketchedSymbol.Definition.Sketch.SketchLines(1)

    ' Create an intent and add to the leader points collection.
    ' This is the geometry that the symbol will attach to.
    Dim oGeometryIntent As GeometryIntent
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(oLine, oLine.StartSketchPoint)

    Call oLeaderPoints.Add(oGeometryIntent)
    
    Dim oWeldingSymDefs As DrawingWeldingSymbolDefinitions
    Set oWeldingSymDefs = oActiveSheet.WeldingSymbols.CreateDefinitions()
   
    Dim oWeldingSymDef As DrawingWeldingSymbolDefinition
    Set oWeldingSymDef = oWeldingSymDefs.Add(1)
    
    ' Specify the weld symbol type(WeldSymbolTypeEnum/BackingSymbolTypeEnum)
    ' Kehlnaht
    oWeldingSymDef.WeldSymbolOne.WeldSymbolType = 124162
    oWeldingSymDef.WeldSymbolOne.SizeOrStrength = "a3"
    
    ' Create the symbol with a leader
    Dim oSymbol As DrawingWeldingSymbol
    Set oSymbol = oActiveSheet.WeldingSymbols.Add(oLeaderPoints, oWeldingSymDefs)
    
End Function
```

#### Code Block 4

```vb
Public Function AddDrawingWeldingSymbol()

    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrwDoc As DrawingDocument
    Set oDrwDoc = ThisApplication.ActiveDocument

    ' Set a reference to the active sheet.
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrwDoc.ActiveSheet

    ' Obtain a reference to the desired sketched symbol definition.
    Dim oSketchedSymbolDef As SketchedSymbolDefinition
    Set oSketchedSymbolDef = oDrwDoc.SketchedSymbolDefinitions.Item("Schweisshinweis_01")

    Dim getPoint As New CLS_GetPoint
    Dim pnt As Point2d
    
    Set pnt = getPoint.GetDrawingPoint("Platzierpunkt", kLeftMouseButton)
    
    ' Set a reference to the TransientGeometry object.
    Dim oTG As TransientGeometry
    Set oTG = ThisApplication.TransientGeometry
    
    Dim oPointPlace As Point2d
    Set oPointPlace = oTG.CreatePoint2d(pnt.X, pnt.Y)
    
    ' Add an instance of the sketched symbol definition to the sheet.
    Dim oSketchedSymbol As SketchedSymbol
    Set oSketchedSymbol = oActiveSheet.SketchedSymbols.Add(oSketchedSymbolDef, oPointPlace)

    Dim oLeaderPoints As ObjectCollection
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

    ' Create a few leader points.
    Call oLeaderPoints.Add(oPointPlace)
    
    Dim oLine As SketchLine
    Set oLine = oSketchedSymbol.Definition.Sketch.SketchLines(1)

    ' Create an intent and add to the leader points collection.
    ' This is the geometry that the symbol will attach to.
    Dim oGeometryIntent As GeometryIntent
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(oLine, oLine.StartSketchPoint)

    Call oLeaderPoints.Add(oGeometryIntent)
    
    Dim oWeldingSymDefs As DrawingWeldingSymbolDefinitions
    Set oWeldingSymDefs = oActiveSheet.WeldingSymbols.CreateDefinitions()
   
    Dim oWeldingSymDef As DrawingWeldingSymbolDefinition
    Set oWeldingSymDef = oWeldingSymDefs.Add(1)
    
    ' Specify the weld symbol type(WeldSymbolTypeEnum/BackingSymbolTypeEnum)
    ' Kehlnaht
    oWeldingSymDef.WeldSymbolOne.WeldSymbolType = 124162
    oWeldingSymDef.WeldSymbolOne.SizeOrStrength = "a3"
    
    ' Create the symbol with a leader
    Dim oSymbol As DrawingWeldingSymbol
    Set oSymbol = oActiveSheet.WeldingSymbols.Add(oLeaderPoints, oWeldingSymDefs)
    
End Function
```

#### Code Block 5

```vb
Public Function InsertSketchedSymbolOnSheet()
    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrwDoc As DrawingDocument
    Set oDrwDoc = ThisApplication.ActiveDocument

'    ' Obtain a reference to the desired sketched symbol definition.
'    Dim oSSDefs As SketchedSymbolDefinitions
'    Set oSSDefs = oDrwDoc.SketchedSymbolDefinitions
'
'    Dim oLibrary As SketchedSymbolDefinitionLibrary
'    Set oLibrary = oSSDefs.SketchedSymbolDefinitionLibraries.Item("ROESLER-symbol-library-01.idw")
'
'    Dim oSketchedSymbolDef As SketchedSymbolDefinition
'    Set oSketchedSymbolDef = oSSDefs.AddFromLibrary(oLibrary, "Schweißhinweis", True)
    
    ' Obtain a reference to the desired sketched symbol definition.
    Dim oSketchedSymbolDef As SketchedSymbolDefinition
    Set oSketchedSymbolDef = oDrwDoc.SketchedSymbolDefinitions.Item("Schweißhinweis")
    
    Dim oSheet As Sheet
    Set oSheet = oDrwDoc.ActiveSheet

    Dim getPoint As New CLS_GetPoint
    Dim pnt As Point2d
    
    Set pnt = getPoint.GetDrawingPoint("Click the desired location", kLeftMouseButton)

    Dim oTG As TransientGeometry
    Set oTG = ThisApplication.TransientGeometry
    
    Dim oPoint1 As Point2d
    Set oPoint1 = oTG.CreatePoint2d(pnt.X, pnt.Y)
    
    Dim oLine As SketchLine
    Set oLine = oSketchedSymbolDef.Sketch.SketchLines(1)


    ' Add an instance of the sketched symbol definition to the sheet.
    Dim oSketchedSymbol As SketchedSymbol
    Set oSketchedSymbol = oSheet.SketchedSymbols.Add(oSketchedSymbolDef, oPoint1)
    
    Dim oLeaderPoints As ObjectCollection
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

    ' Create a few leader points.
    Call oLeaderPoints.Add(oPoint1)

    ' Create an intent and add to the leader points collection.
    ' This is the geometry that the symbol will attach to.
    Dim oGeometryIntent As GeometryIntent
    Set oGeometryIntent = oSheet.CreateGeometryIntent(oLine)

    Call oLeaderPoints.Add(oGeometryIntent)
    
    Dim oWeldingSymDefs As DrawingWeldingSymbolDefinitions
    Set oWeldingSymDefs = oSheet.WeldingSymbols.CreateDefinitions()
   
    Dim oWeldingSymDef As DrawingWeldingSymbolDefinition
    Set oWeldingSymDef = oWeldingSymDefs.Add(1)
     
    ' Specify the weld symbol type(WeldSymbolTypeEnum/BackingSymbolTypeEnum)
    ' Kehlnaht
    oWeldingSymDef.WeldSymbolOne.WeldSymbolType = 124162
    oWeldingSymDef.WeldSymbolOne.SizeOrStrength = "a3"
    
    ' Create the symbol with a leader
    Dim oSymbol As DrawingWeldingSymbol
    Set oSymbol = oSheet.WeldingSymbols.Add(oLeaderPoints, oWeldingSymDefs)
    
End Function
```

#### Code Block 6

```vb
Public Function InsertSketchedSymbolOnSheet()
    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrwDoc As DrawingDocument
    Set oDrwDoc = ThisApplication.ActiveDocument

'    ' Obtain a reference to the desired sketched symbol definition.
'    Dim oSSDefs As SketchedSymbolDefinitions
'    Set oSSDefs = oDrwDoc.SketchedSymbolDefinitions
'
'    Dim oLibrary As SketchedSymbolDefinitionLibrary
'    Set oLibrary = oSSDefs.SketchedSymbolDefinitionLibraries.Item("ROESLER-symbol-library-01.idw")
'
'    Dim oSketchedSymbolDef As SketchedSymbolDefinition
'    Set oSketchedSymbolDef = oSSDefs.AddFromLibrary(oLibrary, "Schweißhinweis", True)
    
    ' Obtain a reference to the desired sketched symbol definition.
    Dim oSketchedSymbolDef As SketchedSymbolDefinition
    Set oSketchedSymbolDef = oDrwDoc.SketchedSymbolDefinitions.Item("Schweißhinweis")
    
    Dim oSheet As Sheet
    Set oSheet = oDrwDoc.ActiveSheet

    Dim getPoint As New CLS_GetPoint
    Dim pnt As Point2d
    
    Set pnt = getPoint.GetDrawingPoint("Click the desired location", kLeftMouseButton)

    Dim oTG As TransientGeometry
    Set oTG = ThisApplication.TransientGeometry
    
    Dim oPoint1 As Point2d
    Set oPoint1 = oTG.CreatePoint2d(pnt.X, pnt.Y)
    
    Dim oLine As SketchLine
    Set oLine = oSketchedSymbolDef.Sketch.SketchLines(1)


    ' Add an instance of the sketched symbol definition to the sheet.
    Dim oSketchedSymbol As SketchedSymbol
    Set oSketchedSymbol = oSheet.SketchedSymbols.Add(oSketchedSymbolDef, oPoint1)
    
    Dim oLeaderPoints As ObjectCollection
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

    ' Create a few leader points.
    Call oLeaderPoints.Add(oPoint1)

    ' Create an intent and add to the leader points collection.
    ' This is the geometry that the symbol will attach to.
    Dim oGeometryIntent As GeometryIntent
    Set oGeometryIntent = oSheet.CreateGeometryIntent(oLine)

    Call oLeaderPoints.Add(oGeometryIntent)
    
    Dim oWeldingSymDefs As DrawingWeldingSymbolDefinitions
    Set oWeldingSymDefs = oSheet.WeldingSymbols.CreateDefinitions()
   
    Dim oWeldingSymDef As DrawingWeldingSymbolDefinition
    Set oWeldingSymDef = oWeldingSymDefs.Add(1)
     
    ' Specify the weld symbol type(WeldSymbolTypeEnum/BackingSymbolTypeEnum)
    ' Kehlnaht
    oWeldingSymDef.WeldSymbolOne.WeldSymbolType = 124162
    oWeldingSymDef.WeldSymbolOne.SizeOrStrength = "a3"
    
    ' Create the symbol with a leader
    Dim oSymbol As DrawingWeldingSymbol
    Set oSymbol = oSheet.WeldingSymbols.Add(oLeaderPoints, oWeldingSymDefs)
    
End Function
```

#### Code Block 7

```vb
Public Function InsertSketchedSymbolOnSheet()
    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrwDoc As DrawingDocument
    Set oDrwDoc = ThisApplication.ActiveDocument

'    ' Obtain a reference to the desired sketched symbol definition.
'    Dim oSSDefs As SketchedSymbolDefinitions
'    Set oSSDefs = oDrwDoc.SketchedSymbolDefinitions
'
'    Dim oLibrary As SketchedSymbolDefinitionLibrary
'    Set oLibrary = oSSDefs.SketchedSymbolDefinitionLibraries.Item("ROESLER-symbol-library-01.idw")
'
'    Dim oSketchedSymbolDef As SketchedSymbolDefinition
'    Set oSketchedSymbolDef = oSSDefs.AddFromLibrary(oLibrary, "Schweißhinweis", True)
    
    ' Obtain a reference to the desired sketched symbol definition.
    Dim oSketchedSymbolDef As SketchedSymbolDefinition
    Set oSketchedSymbolDef = oDrwDoc.SketchedSymbolDefinitions.Item("Schweißhinweis")
    
    Dim oSheet As Sheet
    Set oSheet = oDrwDoc.ActiveSheet

    Dim getPoint As New CLS_GetPoint
    Dim pnt As Point2d
    
    Set pnt = getPoint.GetDrawingPoint("Click the desired location", kLeftMouseButton)

    Dim oTG As TransientGeometry
    Set oTG = ThisApplication.TransientGeometry
    
    Dim oPoint1 As Point2d
    Set oPoint1 = oTG.CreatePoint2d(pnt.X, pnt.Y)
    
    Dim oLine As SketchLine
    Set oLine = oSketchedSymbolDef.Sketch.SketchLines(1)


    ' Add an instance of the sketched symbol definition to the sheet.
    Dim oSketchedSymbol As SketchedSymbol
    Set oSketchedSymbol = oSheet.SketchedSymbols.Add(oSketchedSymbolDef, oPoint1)
    
    Dim oLeaderPoints As ObjectCollection
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

    ' Create a few leader points.
    Call oLeaderPoints.Add(oPoint1)

    ' Create an intent and add to the leader points collection.
    ' This is the geometry that the symbol will attach to.
    Dim oGeometryIntent As GeometryIntent
    Set oGeometryIntent = oSheet.CreateGeometryIntent(oLine)

    Call oLeaderPoints.Add(oGeometryIntent)
    
    Dim oWeldingSymDefs As DrawingWeldingSymbolDefinitions
    Set oWeldingSymDefs = oSheet.WeldingSymbols.CreateDefinitions()
   
    Dim oWeldingSymDef As DrawingWeldingSymbolDefinition
    Set oWeldingSymDef = oWeldingSymDefs.Add(1)
     
    ' Specify the weld symbol type(WeldSymbolTypeEnum/BackingSymbolTypeEnum)
    ' Kehlnaht
    oWeldingSymDef.WeldSymbolOne.WeldSymbolType = 124162
    oWeldingSymDef.WeldSymbolOne.SizeOrStrength = "a3"
    
    ' Create the symbol with a leader
    Dim oSymbol As DrawingWeldingSymbol
    Set oSymbol = oSheet.WeldingSymbols.Add(oLeaderPoints, oWeldingSymDefs)
    
End Function
```

#### Code Block 8

```vb
Public Function InsertSketchedSymbolOnSheet()
    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrwDoc As DrawingDocument
    Set oDrwDoc = ThisApplication.ActiveDocument

'    ' Obtain a reference to the desired sketched symbol definition.
'    Dim oSSDefs As SketchedSymbolDefinitions
'    Set oSSDefs = oDrwDoc.SketchedSymbolDefinitions
'
'    Dim oLibrary As SketchedSymbolDefinitionLibrary
'    Set oLibrary = oSSDefs.SketchedSymbolDefinitionLibraries.Item("ROESLER-symbol-library-01.idw")
'
'    Dim oSketchedSymbolDef As SketchedSymbolDefinition
'    Set oSketchedSymbolDef = oSSDefs.AddFromLibrary(oLibrary, "Schweißhinweis", True)
    
    ' Obtain a reference to the desired sketched symbol definition.
    Dim oSketchedSymbolDef As SketchedSymbolDefinition
    Set oSketchedSymbolDef = oDrwDoc.SketchedSymbolDefinitions.Item("Schweißhinweis")
    
    Dim oSheet As Sheet
    Set oSheet = oDrwDoc.ActiveSheet

    Dim getPoint As New CLS_GetPoint
    Dim pnt As Point2d
    
    Set pnt = getPoint.GetDrawingPoint("Click the desired location", kLeftMouseButton)

    Dim oTG As TransientGeometry
    Set oTG = ThisApplication.TransientGeometry
    
    Dim oPoint1 As Point2d
    Set oPoint1 = oTG.CreatePoint2d(pnt.X, pnt.Y)
    
    Dim oLine As SketchLine
    Set oLine = oSketchedSymbolDef.Sketch.SketchLines(1)


    ' Add an instance of the sketched symbol definition to the sheet.
    Dim oSketchedSymbol As SketchedSymbol
    Set oSketchedSymbol = oSheet.SketchedSymbols.Add(oSketchedSymbolDef, oPoint1)
    
    Dim oLeaderPoints As ObjectCollection
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

    ' Create a few leader points.
    Call oLeaderPoints.Add(oPoint1)

    ' Create an intent and add to the leader points collection.
    ' This is the geometry that the symbol will attach to.
    Dim oGeometryIntent As GeometryIntent
    Set oGeometryIntent = oSheet.CreateGeometryIntent(oLine)

    Call oLeaderPoints.Add(oGeometryIntent)
    
    Dim oWeldingSymDefs As DrawingWeldingSymbolDefinitions
    Set oWeldingSymDefs = oSheet.WeldingSymbols.CreateDefinitions()
   
    Dim oWeldingSymDef As DrawingWeldingSymbolDefinition
    Set oWeldingSymDef = oWeldingSymDefs.Add(1)
     
    ' Specify the weld symbol type(WeldSymbolTypeEnum/BackingSymbolTypeEnum)
    ' Kehlnaht
    oWeldingSymDef.WeldSymbolOne.WeldSymbolType = 124162
    oWeldingSymDef.WeldSymbolOne.SizeOrStrength = "a3"
    
    ' Create the symbol with a leader
    Dim oSymbol As DrawingWeldingSymbol
    Set oSymbol = oSheet.WeldingSymbols.Add(oLeaderPoints, oWeldingSymDefs)
    
End Function
```

---

### 5. AddAngularDimension throws exception

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/addangulardimension-throws-exception/td-p/13800019](https://forums.autodesk.com/t5/inventor-programming-forum/addangulardimension-throws-exception/td-p/13800019)

**Author:** KarolisCAMax

**Date:** ‎09-07-2025
	
		
		07:38 AM

**Description:** I am trying to add a simple angular dimension, but I do struggle with parameter passing.I have tried 2 options:1. Create GeometryIntent objects which would represent Curve2dLineI can see that an actual geometry Type is my drawing curves are Curve2dLine, but the value of property IntentType returns:k...

**Code Snippets (6):**

#### Code Block 1

```vb
// 1. Find the shared point between the two curves
Point2d sharedPoint = FindSharedEndpoint(curve1, curve2);
if (sharedPoint == null)
    throw new Exception("Drawing curves do not share a common endpoint.");

// 2. Determine the other endpoints
Point2d otherPoint1 = GetOtherEndpoint(curve1, sharedPoint);
Point2d otherPoint2 = GetOtherEndpoint(curve2, sharedPoint);

// 3. Create GeometryIntents for the three points
GeometryIntent intentShared = parentLayout.sheet.CreateGeometryIntent(sharedPoint, IntentTypeEnum.kPointIntent);
GeometryIntent intent1 = parentLayout.sheet.CreateGeometryIntent(otherPoint1);
GeometryIntent intent2 = parentLayout.sheet.CreateGeometryIntent(otherPoint2);

var tg = parentLayout.m_application.TransientGeometry;
var newPos = tg.CreatePoint2d(intentShared.PointOnSheet.X - 1, intentShared.PointOnSheet.Y - 2);

//DrawingSketch tempSketch = parentLayout.drawingView.Sketches.Add();
DrawingSketch tempSketch = parentLayout.sheet.Sketches.Add();
tempSketch.Edit();
SketchLine tempLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, newPos);
SketchLine curveLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, otherPoint1);
SketchLine otherLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, otherPoint2);
tempSketch.SketchPoints.Add(newPos);

tempSketch.ExitEdit();

// 4. Add angular dimension using 3-point method
//Point2d position = /* your text position here */;
AngularGeneralDimension angDim = genDims.AddAngular(
    newPos,
    intentShared,
    intent1,
    intent2);
```

#### Code Block 2

```vb
// 1. Find the shared point between the two curves
Point2d sharedPoint = FindSharedEndpoint(curve1, curve2);
if (sharedPoint == null)
    throw new Exception("Drawing curves do not share a common endpoint.");

// 2. Determine the other endpoints
Point2d otherPoint1 = GetOtherEndpoint(curve1, sharedPoint);
Point2d otherPoint2 = GetOtherEndpoint(curve2, sharedPoint);

// 3. Create GeometryIntents for the three points
GeometryIntent intentShared = parentLayout.sheet.CreateGeometryIntent(sharedPoint, IntentTypeEnum.kPointIntent);
GeometryIntent intent1 = parentLayout.sheet.CreateGeometryIntent(otherPoint1);
GeometryIntent intent2 = parentLayout.sheet.CreateGeometryIntent(otherPoint2);

var tg = parentLayout.m_application.TransientGeometry;
var newPos = tg.CreatePoint2d(intentShared.PointOnSheet.X - 1, intentShared.PointOnSheet.Y - 2);

//DrawingSketch tempSketch = parentLayout.drawingView.Sketches.Add();
DrawingSketch tempSketch = parentLayout.sheet.Sketches.Add();
tempSketch.Edit();
SketchLine tempLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, newPos);
SketchLine curveLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, otherPoint1);
SketchLine otherLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, otherPoint2);
tempSketch.SketchPoints.Add(newPos);

tempSketch.ExitEdit();

// 4. Add angular dimension using 3-point method
//Point2d position = /* your text position here */;
AngularGeneralDimension angDim = genDims.AddAngular(
    newPos,
    intentShared,
    intent1,
    intent2);
```

#### Code Block 3

```vb
// 1. Find the shared point between the two curves
Point2d sharedPoint = FindSharedEndpoint(curve1, curve2);
if (sharedPoint == null)
    throw new Exception("Drawing curves do not share a common endpoint.");

// 2. Determine the other endpoints
Point2d otherPoint1 = GetOtherEndpoint(curve1, sharedPoint);
Point2d otherPoint2 = GetOtherEndpoint(curve2, sharedPoint);

// 3. Create GeometryIntents for the three points
GeometryIntent intentShared = parentLayout.sheet.CreateGeometryIntent(sharedPoint, IntentTypeEnum.kPointIntent);
GeometryIntent intent1 = parentLayout.sheet.CreateGeometryIntent(otherPoint1);
GeometryIntent intent2 = parentLayout.sheet.CreateGeometryIntent(otherPoint2);

var tg = parentLayout.m_application.TransientGeometry;
var newPos = tg.CreatePoint2d(intentShared.PointOnSheet.X - 1, intentShared.PointOnSheet.Y - 2);

//DrawingSketch tempSketch = parentLayout.drawingView.Sketches.Add();
DrawingSketch tempSketch = parentLayout.sheet.Sketches.Add();
tempSketch.Edit();
SketchLine tempLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, newPos);
SketchLine curveLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, otherPoint1);
SketchLine otherLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, otherPoint2);
tempSketch.SketchPoints.Add(newPos);

tempSketch.ExitEdit();

// 4. Add angular dimension using 3-point method
//Point2d position = /* your text position here */;
AngularGeneralDimension angDim = genDims.AddAngular(
    newPos,
    intentShared,
    intent1,
    intent2);
```

#### Code Block 4

```vb
// 1. Find the shared point between the two curves
Point2d sharedPoint = FindSharedEndpoint(curve1, curve2);
if (sharedPoint == null)
    throw new Exception("Drawing curves do not share a common endpoint.");

// 2. Determine the other endpoints
Point2d otherPoint1 = GetOtherEndpoint(curve1, sharedPoint);
Point2d otherPoint2 = GetOtherEndpoint(curve2, sharedPoint);

// 3. Create GeometryIntents for the three points
GeometryIntent intentShared = parentLayout.sheet.CreateGeometryIntent(sharedPoint, IntentTypeEnum.kPointIntent);
GeometryIntent intent1 = parentLayout.sheet.CreateGeometryIntent(otherPoint1);
GeometryIntent intent2 = parentLayout.sheet.CreateGeometryIntent(otherPoint2);

var tg = parentLayout.m_application.TransientGeometry;
var newPos = tg.CreatePoint2d(intentShared.PointOnSheet.X - 1, intentShared.PointOnSheet.Y - 2);

//DrawingSketch tempSketch = parentLayout.drawingView.Sketches.Add();
DrawingSketch tempSketch = parentLayout.sheet.Sketches.Add();
tempSketch.Edit();
SketchLine tempLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, newPos);
SketchLine curveLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, otherPoint1);
SketchLine otherLine = tempSketch.SketchLines.AddByTwoPoints(sharedPoint, otherPoint2);
tempSketch.SketchPoints.Add(newPos);

tempSketch.ExitEdit();

// 4. Add angular dimension using 3-point method
//Point2d position = /* your text position here */;
AngularGeneralDimension angDim = genDims.AddAngular(
    newPos,
    intentShared,
    intent1,
    intent2);
```

#### Code Block 5

```vb
var curveIntent = sheet.CreateGeometryIntent(angularCurve);
            var otherCurveIntent = sheet.CreateGeometryIntent(baseCurve);
```

#### Code Block 6

```vb
var curveIntent = sheet.CreateGeometryIntent(angularCurve);
            var otherCurveIntent = sheet.CreateGeometryIntent(baseCurve);
```

#### Code Block 7

```vb
var curveIntent = sheet.CreateGeometryIntent(angularCurve);
            var otherCurveIntent = sheet.CreateGeometryIntent(baseCurve);
```

#### Code Block 8

```vb
var curveIntent = sheet.CreateGeometryIntent(angularCurve);
            var otherCurveIntent = sheet.CreateGeometryIntent(baseCurve);
```

#### Code Block 9

```vb
var curveSegment = curve.Segments[1];
            var otherCurveSegment = otherCurve.Segments[1];

            var curveIntent = parentLayout.sheet.CreateGeometryIntent(curveSegment, IntentTypeEnum.kGeometryIntent);
            var otherCurveIntent = parentLayout.sheet.CreateGeometryIntent(otherCurveSegment, IntentTypeEnum.kGeometryIntent);
```

#### Code Block 10

```vb
var curveSegment = curve.Segments[1];
            var otherCurveSegment = otherCurve.Segments[1];

            var curveIntent = parentLayout.sheet.CreateGeometryIntent(curveSegment, IntentTypeEnum.kGeometryIntent);
            var otherCurveIntent = parentLayout.sheet.CreateGeometryIntent(otherCurveSegment, IntentTypeEnum.kGeometryIntent);
```

#### Code Block 11

```vb
var curveSegment = curve.Segments[1];
            var otherCurveSegment = otherCurve.Segments[1];

            var curveIntent = parentLayout.sheet.CreateGeometryIntent(curveSegment, IntentTypeEnum.kGeometryIntent);
            var otherCurveIntent = parentLayout.sheet.CreateGeometryIntent(otherCurveSegment, IntentTypeEnum.kGeometryIntent);
```

#### Code Block 12

```vb
var curveSegment = curve.Segments[1];
            var otherCurveSegment = otherCurve.Segments[1];

            var curveIntent = parentLayout.sheet.CreateGeometryIntent(curveSegment, IntentTypeEnum.kGeometryIntent);
            var otherCurveIntent = parentLayout.sheet.CreateGeometryIntent(otherCurveSegment, IntentTypeEnum.kGeometryIntent);
```

---

### 6. Adding Surface Texture to FlatPattern View

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/adding-surface-texture-to-flatpattern-view/td-p/13339496#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/adding-surface-texture-to-flatpattern-view/td-p/13339496#messageview_0)

**Author:** miha_bokan

**Date:** ‎02-25-2025
	
		
		01:58 PM

**Description:** I am trying to enrich my "auto-weldment-drawing", which automatically adds all necessary views and also raw parts that need to be cut, bend, before welding. My program works actually pretty good, but I want to add surface texture symbol to sheet metal flat pattern views. There isn't much resources a...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim drw As DrawingDocument = ThisDoc.Document
Dim osheet As Sheet = drw.ActiveSheet
For Each oDv As DrawingView In osheet.DrawingViews
	If oDv.IsFlatPatternView Then
		drw.SelectSet.Clear
		drw.SelectSet.Select(oDv)
		If oDv.Camera.Eye.X > oDv.Camera.Eye.Z Or oDv.Camera.Eye.Y > oDv.Camera.Eye.Z Then ' if flat pattern view is side view
			Dim oiptdoc As PartDocument = oDv.ReferencedDocumentDescriptor.ReferencedDocument
			Dim ft As FlatPattern = oiptdoc.ComponentDefinition.flatpattern
			Dim oFT As Object = ft.TopFace
			Dim oFB As Object = ft.BottomFace
			Dim oDvCT As DrawingCurve = oDv.DrawingCurves(oFT)(1) ' get first drawing view curve from top flatpattern face
	 		Dim oMidPointT As Point2d = oDvCT.MidPoint
			Dim oDvCB As DrawingCurve = oDv.DrawingCurves(oFB)(1) ' get first drawing view curve from bottomflatpattern face
	 		Dim oMidPointB As Point2d = oDvCB.MidPoint
	    	' Set a reference to the TransientGeometry object.
	    	Dim oTG As TransientGeometry= ThisApplication.TransientGeometry
	    	Dim oLeaderPointsT As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
	    	' Create a few leader points.
			If Abs(oMidPointT.X - oDv.Left) >= oDv.Width Then
				Call oLeaderPointsT.Add(oTG.CreatePoint2d(oDv.Left+ oDv.Width, oMidPointT.Y))
				Else
					Call oLeaderPointsT.Add(oTG.CreatePoint2d(oDv.Left , oMidPointT.Y))
				End If
	    	
	     	' Create an intent and add to the leader points collection.
		    ' This is the geometry that the leader text will attach to.
		    Dim oGeometryIntentT As GeometryIntent = osheet.CreateGeometryIntent(oDvCT,oMidPointT)
		'Call oLeaderPointsT.Add(oTG.CreatePoint2d(oMidPointT.X,oDv.Left))
		    Call oLeaderPointsT.Add(oGeometryIntentT)
			
		  	Dim oLeaderPointsB As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
		    ' Create a few leader points.
			
		  If Abs(oMidPointB.X - oDv.Left) >= oDv.Width Then
				Call oLeaderPointsB.Add(oTG.CreatePoint2d(oDv.Left, oMidPointB.Y))
				Else
					Call oLeaderPointsB.Add(oTG.CreatePoint2d(oDv.Left + oDv.Width, oMidPointB.Y))
				End If
		     ' Create an intent and add to the leader points collection.
		    ' This is the geometry that the leader text will attach to.
		    Dim oGeometryIntentB As GeometryIntent = osheet.CreateGeometryIntent(oDvCB,oMidPointB)
		    Call oLeaderPointsB.Add(oGeometryIntentB)
		
		 	Dim oSymbolT As SurfaceTextureSymbol
		 	oSymbolT = osheet.SurfaceTextureSymbols.Add(oLeaderPointsT,kMaterialRemovalProhibitedSurfaceType)
			Dim oSymbolB As SurfaceTextureSymbol
		    oSymbolB = osheet.SurfaceTextureSymbols.Add(oLeaderPointsB,kMaterialRemovalProhibitedSurfaceType)

		End If
	End If
Next
```

#### Code Block 2

```vb
Dim drw As DrawingDocument = ThisDoc.Document
Dim osheet As Sheet = drw.ActiveSheet
For Each oDv As DrawingView In osheet.DrawingViews
	If oDv.IsFlatPatternView Then
		drw.SelectSet.Clear
		drw.SelectSet.Select(oDv)
		If oDv.Camera.Eye.X > oDv.Camera.Eye.Z Or oDv.Camera.Eye.Y > oDv.Camera.Eye.Z Then ' if flat pattern view is side view
			Dim oiptdoc As PartDocument = oDv.ReferencedDocumentDescriptor.ReferencedDocument
			Dim ft As FlatPattern = oiptdoc.ComponentDefinition.flatpattern
			Dim oFT As Object = ft.TopFace
			Dim oFB As Object = ft.BottomFace
			Dim oDvCT As DrawingCurve = oDv.DrawingCurves(oFT)(1) ' get first drawing view curve from top flatpattern face
	 		Dim oMidPointT As Point2d = oDvCT.MidPoint
			Dim oDvCB As DrawingCurve = oDv.DrawingCurves(oFB)(1) ' get first drawing view curve from bottomflatpattern face
	 		Dim oMidPointB As Point2d = oDvCB.MidPoint
	    	' Set a reference to the TransientGeometry object.
	    	Dim oTG As TransientGeometry= ThisApplication.TransientGeometry
	    	Dim oLeaderPointsT As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
	    	' Create a few leader points.
			If Abs(oMidPointT.X - oDv.Left) >= oDv.Width Then
				Call oLeaderPointsT.Add(oTG.CreatePoint2d(oDv.Left+ oDv.Width, oMidPointT.Y))
				Else
					Call oLeaderPointsT.Add(oTG.CreatePoint2d(oDv.Left , oMidPointT.Y))
				End If
	    	
	     	' Create an intent and add to the leader points collection.
		    ' This is the geometry that the leader text will attach to.
		    Dim oGeometryIntentT As GeometryIntent = osheet.CreateGeometryIntent(oDvCT,oMidPointT)
		'Call oLeaderPointsT.Add(oTG.CreatePoint2d(oMidPointT.X,oDv.Left))
		    Call oLeaderPointsT.Add(oGeometryIntentT)
			
		  	Dim oLeaderPointsB As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
		    ' Create a few leader points.
			
		  If Abs(oMidPointB.X - oDv.Left) >= oDv.Width Then
				Call oLeaderPointsB.Add(oTG.CreatePoint2d(oDv.Left, oMidPointB.Y))
				Else
					Call oLeaderPointsB.Add(oTG.CreatePoint2d(oDv.Left + oDv.Width, oMidPointB.Y))
				End If
		     ' Create an intent and add to the leader points collection.
		    ' This is the geometry that the leader text will attach to.
		    Dim oGeometryIntentB As GeometryIntent = osheet.CreateGeometryIntent(oDvCB,oMidPointB)
		    Call oLeaderPointsB.Add(oGeometryIntentB)
		
		 	Dim oSymbolT As SurfaceTextureSymbol
		 	oSymbolT = osheet.SurfaceTextureSymbols.Add(oLeaderPointsT,kMaterialRemovalProhibitedSurfaceType)
			Dim oSymbolB As SurfaceTextureSymbol
		    oSymbolB = osheet.SurfaceTextureSymbols.Add(oLeaderPointsB,kMaterialRemovalProhibitedSurfaceType)

		End If
	End If
Next
```

#### Code Block 3

```vb
Dim drw As DrawingDocument = ThisDoc.Document
Dim osheet As Sheet = drw.ActiveSheet
For Each oDv As DrawingView In osheet.DrawingViews
	If oDv.IsFlatPatternView Then
		drw.SelectSet.Clear
		drw.SelectSet.Select(oDv)
		If oDv.Camera.Eye.X > oDv.Camera.Eye.Z Or oDv.Camera.Eye.Y > oDv.Camera.Eye.Z Then ' if flat pattern view is side view
			Dim oiptdoc As PartDocument = oDv.ReferencedDocumentDescriptor.ReferencedDocument
			Dim ft As FlatPattern = oiptdoc.ComponentDefinition.flatpattern
			Dim oFT As Object = ft.TopFace
			Dim oFB As Object = ft.BottomFace
			Dim oDvCT As DrawingCurve = oDv.DrawingCurves(oFT)(1) ' get first drawing view curve from top flatpattern face
	 		Dim oMidPointT As Point2d = oDvCT.MidPoint
			Dim oDvCB As DrawingCurve = oDv.DrawingCurves(oFB)(1) ' get first drawing view curve from bottomflatpattern face
	 		Dim oMidPointB As Point2d = oDvCB.MidPoint
	    	' Set a reference to the TransientGeometry object.
	    	Dim oTG As TransientGeometry= ThisApplication.TransientGeometry
	    	Dim oLeaderPointsT As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
	    	' Create a few leader points.
	    	Call oLeaderPointsT.Add(oTG.CreatePoint2d(oMidPointT.X, oMidPointT.Y))
	     	' Create an intent and add to the leader points collection.
		    ' This is the geometry that the leader text will attach to.
		    Dim oGeometryIntentT As GeometryIntent = osheet.CreateGeometryIntent(oDvCT,oMidPointT)
		
		    Call oLeaderPointsT.Add(oGeometryIntentT)
			
		  	Dim oLeaderPointsB As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
		    ' Create a few leader points.
		    Call oLeaderPointsB.Add(oTG.CreatePoint2d(oMidPointB.X, oMidPointB.Y))
		     ' Create an intent and add to the leader points collection.
		    ' This is the geometry that the leader text will attach to.
		    Dim oGeometryIntentB As GeometryIntent = osheet.CreateGeometryIntent(oDvCB,oMidPointB)
		    Call oLeaderPointsB.Add(oGeometryIntentB)
		
		 	Dim oSymbolT As SurfaceTextureSymbol
		 	oSymbolT = osheet.SurfaceTextureSymbols.Add(oLeaderPointsT,kMaterialRemovalProhibitedSurfaceType)
			Dim oSymbolB As SurfaceTextureSymbol
		    oSymbolB = osheet.SurfaceTextureSymbols.Add(oLeaderPointsB,kMaterialRemovalProhibitedSurfaceType)
	
		End If
	End If
Next
```

#### Code Block 4

```vb
Dim drw As DrawingDocument = ThisDoc.Document
Dim osheet As Sheet = drw.ActiveSheet
For Each oDv As DrawingView In osheet.DrawingViews
	If oDv.IsFlatPatternView Then
		drw.SelectSet.Clear
		drw.SelectSet.Select(oDv)
		If oDv.Camera.Eye.X > oDv.Camera.Eye.Z Or oDv.Camera.Eye.Y > oDv.Camera.Eye.Z Then ' if flat pattern view is side view
			Dim oiptdoc As PartDocument = oDv.ReferencedDocumentDescriptor.ReferencedDocument
			Dim ft As FlatPattern = oiptdoc.ComponentDefinition.flatpattern
			Dim oFT As Object = ft.TopFace
			Dim oFB As Object = ft.BottomFace
			Dim oDvCT As DrawingCurve = oDv.DrawingCurves(oFT)(1) ' get first drawing view curve from top flatpattern face
	 		Dim oMidPointT As Point2d = oDvCT.MidPoint
			Dim oDvCB As DrawingCurve = oDv.DrawingCurves(oFB)(1) ' get first drawing view curve from bottomflatpattern face
	 		Dim oMidPointB As Point2d = oDvCB.MidPoint
	    	' Set a reference to the TransientGeometry object.
	    	Dim oTG As TransientGeometry= ThisApplication.TransientGeometry
	    	Dim oLeaderPointsT As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
	    	' Create a few leader points.
	    	Call oLeaderPointsT.Add(oTG.CreatePoint2d(oMidPointT.X, oMidPointT.Y))
	     	' Create an intent and add to the leader points collection.
		    ' This is the geometry that the leader text will attach to.
		    Dim oGeometryIntentT As GeometryIntent = osheet.CreateGeometryIntent(oDvCT,oMidPointT)
		
		    Call oLeaderPointsT.Add(oGeometryIntentT)
			
		  	Dim oLeaderPointsB As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
		    ' Create a few leader points.
		    Call oLeaderPointsB.Add(oTG.CreatePoint2d(oMidPointB.X, oMidPointB.Y))
		     ' Create an intent and add to the leader points collection.
		    ' This is the geometry that the leader text will attach to.
		    Dim oGeometryIntentB As GeometryIntent = osheet.CreateGeometryIntent(oDvCB,oMidPointB)
		    Call oLeaderPointsB.Add(oGeometryIntentB)
		
		 	Dim oSymbolT As SurfaceTextureSymbol
		 	oSymbolT = osheet.SurfaceTextureSymbols.Add(oLeaderPointsT,kMaterialRemovalProhibitedSurfaceType)
			Dim oSymbolB As SurfaceTextureSymbol
		    oSymbolB = osheet.SurfaceTextureSymbols.Add(oLeaderPointsB,kMaterialRemovalProhibitedSurfaceType)
	
		End If
	End If
Next
```

---

### 7. Addins - Using the Inventor Themes Light / Dark

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/addins-using-the-inventor-themes-light-dark/td-p/13356690](https://forums.autodesk.com/t5/inventor-programming-forum/addins-using-the-inventor-themes-light-dark/td-p/13356690)

**Author:** NachoShaw

**Date:** ‎03-06-2025
	
		
		07:48 AM

**Description:** Hi   Getting addins to adopt the light / dark themes to some has been a challenge. I went through an arduous task of creating a skin based on the dark theme and i had to fill in a lot of blanks. Then the other day i was looking for a library in the Inventor 2024/Bin folder and came across this-   Au...

**Code Snippets (8):**

#### Code Block 1

```vb
Imports DevExpress.LookAndFeel
Imports DevExpress.Skins
Imports DevExpress.UserSkins
Imports DevExpress.Utils
Imports DevExpress.XtraEditors
Imports Autodesk.iLogic.ThemeSkins
Imports DevExpress.Skins.Info
Imports System.Reflection
Imports Inventor
```

#### Code Block 2

```vb
Imports DevExpress.LookAndFeel
Imports DevExpress.Skins
Imports DevExpress.UserSkins
Imports DevExpress.Utils
Imports DevExpress.XtraEditors
Imports Autodesk.iLogic.ThemeSkins
Imports DevExpress.Skins.Info
Imports System.Reflection
Imports Inventor
```

#### Code Block 3

```vb
Imports DevExpress.LookAndFeel
Imports DevExpress.Skins
Imports DevExpress.UserSkins
Imports DevExpress.Utils
Imports DevExpress.XtraEditors
Imports Autodesk.iLogic.ThemeSkins
Imports DevExpress.Skins.Info
Imports System.Reflection
Imports Inventor
```

#### Code Block 4

```vb
Imports DevExpress.LookAndFeel
Imports DevExpress.Skins
Imports DevExpress.UserSkins
Imports DevExpress.Utils
Imports DevExpress.XtraEditors
Imports Autodesk.iLogic.ThemeSkins
Imports DevExpress.Skins.Info
Imports System.Reflection
Imports Inventor
```

#### Code Block 5

```vb
Public Sub New()

    ' This call is required by the designer.
    InitializeComponent()

    Dim DarkTheme As String = "inventor dark theme"
    Dim LightTheme As String = "inventor light theme"

    Dim AdeskLib As String = "Autodesk.iLogic.ThemeSkins.CustomSkins."

    SkinManager.EnableFormSkins()
    Dim valDark As New SkinBlobXmlCreator(DarkTheme, AdeskLib, GetType(CustomThemeSkins).Assembly, DirectCast(Nothing, String))
    Dim valLight As New SkinBlobXmlCreator(LightTheme, AdeskLib, GetType(CustomThemeSkins).Assembly, DirectCast(Nothing, String))

    SkinManager.Default.RegisterSkin(valDark)
    SkinManager.Default.RegisterSkin(valLight)

    Dim oThemeManager As Inventor.ThemeManager = AddinGlobal.InventorApp.ThemeManager
    Dim oTheme As Inventor.Theme = oThemeManager.ActiveTheme

    Select Case oTheme.Name
        Case "LightTheme"
            Me.LookAndFeel.SetSkinStyle(LightTheme)
        Case "DarkTheme"
            Me.LookAndFeel.SetSkinStyle(DarkTheme)
    End Select
    LookAndFeel.UpdateStyleSettings()

End Sub
```

#### Code Block 6

```vb
Public Sub New()

    ' This call is required by the designer.
    InitializeComponent()

    Dim DarkTheme As String = "inventor dark theme"
    Dim LightTheme As String = "inventor light theme"

    Dim AdeskLib As String = "Autodesk.iLogic.ThemeSkins.CustomSkins."

    SkinManager.EnableFormSkins()
    Dim valDark As New SkinBlobXmlCreator(DarkTheme, AdeskLib, GetType(CustomThemeSkins).Assembly, DirectCast(Nothing, String))
    Dim valLight As New SkinBlobXmlCreator(LightTheme, AdeskLib, GetType(CustomThemeSkins).Assembly, DirectCast(Nothing, String))

    SkinManager.Default.RegisterSkin(valDark)
    SkinManager.Default.RegisterSkin(valLight)

    Dim oThemeManager As Inventor.ThemeManager = AddinGlobal.InventorApp.ThemeManager
    Dim oTheme As Inventor.Theme = oThemeManager.ActiveTheme

    Select Case oTheme.Name
        Case "LightTheme"
            Me.LookAndFeel.SetSkinStyle(LightTheme)
        Case "DarkTheme"
            Me.LookAndFeel.SetSkinStyle(DarkTheme)
    End Select
    LookAndFeel.UpdateStyleSettings()

End Sub
```

#### Code Block 7

```vb
Public Sub New()

    ' This call is required by the designer.
    InitializeComponent()

    Dim DarkTheme As String = "inventor dark theme"
    Dim LightTheme As String = "inventor light theme"

    Dim AdeskLib As String = "Autodesk.iLogic.ThemeSkins.CustomSkins."

    SkinManager.EnableFormSkins()
    Dim valDark As New SkinBlobXmlCreator(DarkTheme, AdeskLib, GetType(CustomThemeSkins).Assembly, DirectCast(Nothing, String))
    Dim valLight As New SkinBlobXmlCreator(LightTheme, AdeskLib, GetType(CustomThemeSkins).Assembly, DirectCast(Nothing, String))

    SkinManager.Default.RegisterSkin(valDark)
    SkinManager.Default.RegisterSkin(valLight)

    Dim oThemeManager As Inventor.ThemeManager = AddinGlobal.InventorApp.ThemeManager
    Dim oTheme As Inventor.Theme = oThemeManager.ActiveTheme

    Select Case oTheme.Name
        Case "LightTheme"
            Me.LookAndFeel.SetSkinStyle(LightTheme)
        Case "DarkTheme"
            Me.LookAndFeel.SetSkinStyle(DarkTheme)
    End Select
    LookAndFeel.UpdateStyleSettings()

End Sub
```

#### Code Block 8

```vb
Public Sub New()

    ' This call is required by the designer.
    InitializeComponent()

    Dim DarkTheme As String = "inventor dark theme"
    Dim LightTheme As String = "inventor light theme"

    Dim AdeskLib As String = "Autodesk.iLogic.ThemeSkins.CustomSkins."

    SkinManager.EnableFormSkins()
    Dim valDark As New SkinBlobXmlCreator(DarkTheme, AdeskLib, GetType(CustomThemeSkins).Assembly, DirectCast(Nothing, String))
    Dim valLight As New SkinBlobXmlCreator(LightTheme, AdeskLib, GetType(CustomThemeSkins).Assembly, DirectCast(Nothing, String))

    SkinManager.Default.RegisterSkin(valDark)
    SkinManager.Default.RegisterSkin(valLight)

    Dim oThemeManager As Inventor.ThemeManager = AddinGlobal.InventorApp.ThemeManager
    Dim oTheme As Inventor.Theme = oThemeManager.ActiveTheme

    Select Case oTheme.Name
        Case "LightTheme"
            Me.LookAndFeel.SetSkinStyle(LightTheme)
        Case "DarkTheme"
            Me.LookAndFeel.SetSkinStyle(DarkTheme)
    End Select
    LookAndFeel.UpdateStyleSettings()

End Sub
```

#### Code Block 9

```vb
public YourClassName()
{
    // This call is required by the designer.
    InitializeComponent();

    string DarkTheme = "inventor dark theme";
    string LightTheme = "inventor light theme";

    string AdeskLib = "Autodesk.iLogic.ThemeSkins.CustomSkins.";

    SkinManager.EnableFormSkins();

    var valDark = new SkinBlobXmlCreator(DarkTheme, AdeskLib, typeof(CustomThemeSkins).Assembly, null as string);
    var valLight = new SkinBlobXmlCreator(LightTheme, AdeskLib, typeof(CustomThemeSkins).Assembly, null as string);

    SkinManager.Default.RegisterSkin(valDark);
    SkinManager.Default.RegisterSkin(valLight);

    Inventor.ThemeManager oThemeManager = AddinGlobal.InventorApp.ThemeManager;
    Inventor.Theme oTheme = oThemeManager.ActiveTheme;

    switch (oTheme.Name)
    {
        case "LightTheme":
            this.LookAndFeel.SetSkinStyle(LightTheme);
            break;
        case "DarkTheme":
            this.LookAndFeel.SetSkinStyle(DarkTheme);
            break;
    }

    LookAndFeel.UpdateStyleSettings();
}
```

#### Code Block 10

```vb
public YourClassName()
{
    // This call is required by the designer.
    InitializeComponent();

    string DarkTheme = "inventor dark theme";
    string LightTheme = "inventor light theme";

    string AdeskLib = "Autodesk.iLogic.ThemeSkins.CustomSkins.";

    SkinManager.EnableFormSkins();

    var valDark = new SkinBlobXmlCreator(DarkTheme, AdeskLib, typeof(CustomThemeSkins).Assembly, null as string);
    var valLight = new SkinBlobXmlCreator(LightTheme, AdeskLib, typeof(CustomThemeSkins).Assembly, null as string);

    SkinManager.Default.RegisterSkin(valDark);
    SkinManager.Default.RegisterSkin(valLight);

    Inventor.ThemeManager oThemeManager = AddinGlobal.InventorApp.ThemeManager;
    Inventor.Theme oTheme = oThemeManager.ActiveTheme;

    switch (oTheme.Name)
    {
        case "LightTheme":
            this.LookAndFeel.SetSkinStyle(LightTheme);
            break;
        case "DarkTheme":
            this.LookAndFeel.SetSkinStyle(DarkTheme);
            break;
    }

    LookAndFeel.UpdateStyleSettings();
}
```

#### Code Block 11

```vb
public YourClassName()
{
    // This call is required by the designer.
    InitializeComponent();

    string DarkTheme = "inventor dark theme";
    string LightTheme = "inventor light theme";

    string AdeskLib = "Autodesk.iLogic.ThemeSkins.CustomSkins.";

    SkinManager.EnableFormSkins();

    var valDark = new SkinBlobXmlCreator(DarkTheme, AdeskLib, typeof(CustomThemeSkins).Assembly, null as string);
    var valLight = new SkinBlobXmlCreator(LightTheme, AdeskLib, typeof(CustomThemeSkins).Assembly, null as string);

    SkinManager.Default.RegisterSkin(valDark);
    SkinManager.Default.RegisterSkin(valLight);

    Inventor.ThemeManager oThemeManager = AddinGlobal.InventorApp.ThemeManager;
    Inventor.Theme oTheme = oThemeManager.ActiveTheme;

    switch (oTheme.Name)
    {
        case "LightTheme":
            this.LookAndFeel.SetSkinStyle(LightTheme);
            break;
        case "DarkTheme":
            this.LookAndFeel.SetSkinStyle(DarkTheme);
            break;
    }

    LookAndFeel.UpdateStyleSettings();
}
```

#### Code Block 12

```vb
public YourClassName()
{
    // This call is required by the designer.
    InitializeComponent();

    string DarkTheme = "inventor dark theme";
    string LightTheme = "inventor light theme";

    string AdeskLib = "Autodesk.iLogic.ThemeSkins.CustomSkins.";

    SkinManager.EnableFormSkins();

    var valDark = new SkinBlobXmlCreator(DarkTheme, AdeskLib, typeof(CustomThemeSkins).Assembly, null as string);
    var valLight = new SkinBlobXmlCreator(LightTheme, AdeskLib, typeof(CustomThemeSkins).Assembly, null as string);

    SkinManager.Default.RegisterSkin(valDark);
    SkinManager.Default.RegisterSkin(valLight);

    Inventor.ThemeManager oThemeManager = AddinGlobal.InventorApp.ThemeManager;
    Inventor.Theme oTheme = oThemeManager.ActiveTheme;

    switch (oTheme.Name)
    {
        case "LightTheme":
            this.LookAndFeel.SetSkinStyle(LightTheme);
            break;
        case "DarkTheme":
            this.LookAndFeel.SetSkinStyle(DarkTheme);
            break;
    }

    LookAndFeel.UpdateStyleSettings();
}
```

#### Code Block 13

```vb
using DevExpress.LookAndFeel;
using DevExpress.Skins;
using DevExpress.UserSkins;
using DevExpress.Utils;
using DevExpress.XtraEditors;
using Autodesk.iLogic.ThemeSkins;
using DevExpress.Skins.Info;
using System.Reflection;
using Inventor;
```

#### Code Block 14

```vb
using DevExpress.LookAndFeel;
using DevExpress.Skins;
using DevExpress.UserSkins;
using DevExpress.Utils;
using DevExpress.XtraEditors;
using Autodesk.iLogic.ThemeSkins;
using DevExpress.Skins.Info;
using System.Reflection;
using Inventor;
```

#### Code Block 15

```vb
using DevExpress.LookAndFeel;
using DevExpress.Skins;
using DevExpress.UserSkins;
using DevExpress.Utils;
using DevExpress.XtraEditors;
using Autodesk.iLogic.ThemeSkins;
using DevExpress.Skins.Info;
using System.Reflection;
using Inventor;
```

#### Code Block 16

```vb
using DevExpress.LookAndFeel;
using DevExpress.Skins;
using DevExpress.UserSkins;
using DevExpress.Utils;
using DevExpress.XtraEditors;
using Autodesk.iLogic.ThemeSkins;
using DevExpress.Skins.Info;
using System.Reflection;
using Inventor;
```

---

### 8. Alpha Sort Component: natural sorting order

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/alpha-sort-component-natural-sorting-order/td-p/13829502#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/alpha-sort-component-natural-sorting-order/td-p/13829502#messageview_0)

**Author:** progettazionesviluppo

**Date:** ‎09-29-2025
	
		
		02:55 AM

**Description:** Hello,I would appreciate if someone already had made the code that would sort the occurences within the browser in natural order (as on the immage bellow). Thanks! 					 				 			 			 				 			 			 				 	 			 				 					 						Solved! 					 					Go to Solution.

**Code Snippets (2):**

#### Code Block 1

```vb
Public Class ThisRule

    Sub Main()

        Dim doc As AssemblyDocument = ThisDoc.Document
        Dim topNode As BrowserNode = doc.BrowserPanes.Item("Model").TopNode
        Dim nodesList As List(Of BrowserNode) = New List(Of BrowserNode)()
        Dim orginNode As BrowserNode = Nothing

        For Each node As BrowserNode In topNode.BrowserNodes
            If (node.BrowserNodeDefinition.Label.Equals("Origin")) Then
                orginNode = node
            End If
            If (node.NativeObject IsNot Nothing) Then
                If (node.NativeObject.Type = ObjectTypeEnum.kComponentOccurrenceObject) Then
                    nodesList.Add(node)
                End If
            End If
        Next

        Dim nodeArray() = nodesList.ToArray()

        Array.Sort(nodeArray, New AlphanumReverseComparator())

        Dim transAction As Transaction = ThisApplication.TransactionManager.StartTransaction(ThisDoc.Document, "Alphanum sort")
        For Each node As BrowserNode In nodeArray
            doc.BrowserPanes.Item("Model").Reorder(orginNode, False, node)
        Next
        transAction.End()
    End Sub


End Class

Public Class AlphanumReverseComparator
    Implements IComparer
    ' Taken from:
    ' https://www.dotnetperls.com/alphanumeric-sorting-vbnet 

    Public Function Compare(ByVal x As Object,
                            ByVal y As Object) As Integer Implements IComparer.Compare

        ' [1] Validate the arguments.
        Dim s1 As String = y.BrowserNodeDefinition.Label
        If s1 = Nothing Then
            Return 0
        End If

        Dim s2 As String = x.BrowserNodeDefinition.Label
        If s2 = Nothing Then
            Return 0
        End If

        Dim len1 As Integer = s1.Length
        Dim len2 As Integer = s2.Length
        Dim marker1 As Integer = 0
        Dim marker2 As Integer = 0

        ' [2] Loop over both Strings.
        While marker1 < len1 And marker2 < len2

            ' [3] Get Chars.
            Dim ch1 As Char = s1(marker1)
            Dim ch2 As Char = s2(marker2)

            Dim space1(len1) As Char
            Dim loc1 As Integer = 0
            Dim space2(len2) As Char
            Dim loc2 As Integer = 0

            ' [4] Collect digits for String one.
            Do
                space1(loc1) = ch1
                loc1 += 1
                marker1 += 1

                If marker1 < len1 Then
                    ch1 = s1(marker1)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch1) = Char.IsDigit(space1(0))

            ' [5] Collect digits for String two.
            Do
                space2(loc2) = ch2
                loc2 += 1
                marker2 += 1

                If marker2 < len2 Then
                    ch2 = s2(marker2)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch2) = Char.IsDigit(space2(0))

            ' [6] Convert to Strings.
            Dim str1 = New String(space1)
            Dim str2 = New String(space2)

            ' [7] Parse Strings into Integers.
            Dim result As Integer
            If Char.IsDigit(space1(0)) And Char.IsDigit(space2(0)) Then
                Dim thisNumericChunk = Integer.Parse(str1)
                Dim thatNumericChunk = Integer.Parse(str2)
                result = thisNumericChunk.CompareTo(thatNumericChunk)
            Else
                result = str1.CompareTo(str2)
            End If

            ' [8] Return result if not equal.
            If Not result = 0 Then
                Return result
            End If
        End While

        ' [9] Compare lengths.
        Return len1 - len2
    End Function
End Class
```

#### Code Block 2

```vb
Public Class ThisRule

    Sub Main()

        Dim doc As AssemblyDocument = ThisDoc.Document
        Dim topNode As BrowserNode = doc.BrowserPanes.Item("Model").TopNode
        Dim nodesList As List(Of BrowserNode) = New List(Of BrowserNode)()
        Dim orginNode As BrowserNode = Nothing

        For Each node As BrowserNode In topNode.BrowserNodes
            If (node.BrowserNodeDefinition.Label.Equals("Origin")) Then
                orginNode = node
            End If
            If (node.NativeObject IsNot Nothing) Then
                If (node.NativeObject.Type = ObjectTypeEnum.kComponentOccurrenceObject) Then
                    nodesList.Add(node)
                End If
            End If
        Next

        Dim nodeArray() = nodesList.ToArray()

        Array.Sort(nodeArray, New AlphanumReverseComparator())

        Dim transAction As Transaction = ThisApplication.TransactionManager.StartTransaction(ThisDoc.Document, "Alphanum sort")
        For Each node As BrowserNode In nodeArray
            doc.BrowserPanes.Item("Model").Reorder(orginNode, False, node)
        Next
        transAction.End()
    End Sub


End Class

Public Class AlphanumReverseComparator
    Implements IComparer
    ' Taken from:
    ' https://www.dotnetperls.com/alphanumeric-sorting-vbnet 

    Public Function Compare(ByVal x As Object,
                            ByVal y As Object) As Integer Implements IComparer.Compare

        ' [1] Validate the arguments.
        Dim s1 As String = y.BrowserNodeDefinition.Label
        If s1 = Nothing Then
            Return 0
        End If

        Dim s2 As String = x.BrowserNodeDefinition.Label
        If s2 = Nothing Then
            Return 0
        End If

        Dim len1 As Integer = s1.Length
        Dim len2 As Integer = s2.Length
        Dim marker1 As Integer = 0
        Dim marker2 As Integer = 0

        ' [2] Loop over both Strings.
        While marker1 < len1 And marker2 < len2

            ' [3] Get Chars.
            Dim ch1 As Char = s1(marker1)
            Dim ch2 As Char = s2(marker2)

            Dim space1(len1) As Char
            Dim loc1 As Integer = 0
            Dim space2(len2) As Char
            Dim loc2 As Integer = 0

            ' [4] Collect digits for String one.
            Do
                space1(loc1) = ch1
                loc1 += 1
                marker1 += 1

                If marker1 < len1 Then
                    ch1 = s1(marker1)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch1) = Char.IsDigit(space1(0))

            ' [5] Collect digits for String two.
            Do
                space2(loc2) = ch2
                loc2 += 1
                marker2 += 1

                If marker2 < len2 Then
                    ch2 = s2(marker2)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch2) = Char.IsDigit(space2(0))

            ' [6] Convert to Strings.
            Dim str1 = New String(space1)
            Dim str2 = New String(space2)

            ' [7] Parse Strings into Integers.
            Dim result As Integer
            If Char.IsDigit(space1(0)) And Char.IsDigit(space2(0)) Then
                Dim thisNumericChunk = Integer.Parse(str1)
                Dim thatNumericChunk = Integer.Parse(str2)
                result = thisNumericChunk.CompareTo(thatNumericChunk)
            Else
                result = str1.CompareTo(str2)
            End If

            ' [8] Return result if not equal.
            If Not result = 0 Then
                Return result
            End If
        End While

        ' [9] Compare lengths.
        Return len1 - len2
    End Function
End Class
```

#### Code Block 3

```vb
Public Class ThisRule

    Sub Main()

        Dim doc As AssemblyDocument = ThisDoc.Document
        Dim topNode As BrowserNode = doc.BrowserPanes.Item("Model").TopNode
        Dim nodesList As List(Of BrowserNode) = New List(Of BrowserNode)()
        Dim orginNode As BrowserNode = Nothing

        For Each node As BrowserNode In topNode.BrowserNodes
            If (node.BrowserNodeDefinition.Label.Equals("Origin")) Then
                orginNode = node
            End If
            If (node.NativeObject IsNot Nothing) Then
                If (node.NativeObject.Type = ObjectTypeEnum.kComponentOccurrenceObject) Then
                    nodesList.Add(node)
                End If
            End If
        Next

        Dim nodeArray() = nodesList.ToArray()

        Array.Sort(nodeArray, New AlphanumReverseComparator())

        Dim transAction As Transaction = ThisApplication.TransactionManager.StartTransaction(ThisDoc.Document, "Alphanum sort")
        For Each node As BrowserNode In nodeArray
            doc.BrowserPanes.Item("Model").Reorder(orginNode, False, node)
        Next
        transAction.End()
    End Sub


End Class

Public Class AlphanumReverseComparator
    Implements IComparer
    ' Taken from:
    ' https://www.dotnetperls.com/alphanumeric-sorting-vbnet 

    Public Function Compare(ByVal x As Object,
                            ByVal y As Object) As Integer Implements IComparer.Compare

        ' [1] Validate the arguments.
        Dim s1 As String = y.BrowserNodeDefinition.Label
        If s1 = Nothing Then
            Return 0
        End If

        Dim s2 As String = x.BrowserNodeDefinition.Label
        If s2 = Nothing Then
            Return 0
        End If

        Dim len1 As Integer = s1.Length
        Dim len2 As Integer = s2.Length
        Dim marker1 As Integer = 0
        Dim marker2 As Integer = 0

        ' [2] Loop over both Strings.
        While marker1 < len1 And marker2 < len2

            ' [3] Get Chars.
            Dim ch1 As Char = s1(marker1)
            Dim ch2 As Char = s2(marker2)

            Dim space1(len1) As Char
            Dim loc1 As Integer = 0
            Dim space2(len2) As Char
            Dim loc2 As Integer = 0

            ' [4] Collect digits for String one.
            Do
                space1(loc1) = ch1
                loc1 += 1
                marker1 += 1

                If marker1 < len1 Then
                    ch1 = s1(marker1)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch1) = Char.IsDigit(space1(0))

            ' [5] Collect digits for String two.
            Do
                space2(loc2) = ch2
                loc2 += 1
                marker2 += 1

                If marker2 < len2 Then
                    ch2 = s2(marker2)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch2) = Char.IsDigit(space2(0))

            ' [6] Convert to Strings.
            Dim str1 = New String(space1)
            Dim str2 = New String(space2)

            ' [7] Parse Strings into Integers.
            Dim result As Integer
            If Char.IsDigit(space1(0)) And Char.IsDigit(space2(0)) Then
                Dim thisNumericChunk = Integer.Parse(str1)
                Dim thatNumericChunk = Integer.Parse(str2)
                result = thisNumericChunk.CompareTo(thatNumericChunk)
            Else
                result = str1.CompareTo(str2)
            End If

            ' [8] Return result if not equal.
            If Not result = 0 Then
                Return result
            End If
        End While

        ' [9] Compare lengths.
        Return len1 - len2
    End Function
End Class
```

#### Code Block 4

```vb
Public Class ThisRule

    Sub Main()

        Dim doc As AssemblyDocument = ThisDoc.Document
        Dim topNode As BrowserNode = doc.BrowserPanes.Item("Model").TopNode
        Dim nodesList As List(Of BrowserNode) = New List(Of BrowserNode)()
        Dim orginNode As BrowserNode = Nothing

        For Each node As BrowserNode In topNode.BrowserNodes
            If (node.BrowserNodeDefinition.Label.Equals("Origin")) Then
                orginNode = node
            End If
            If (node.NativeObject IsNot Nothing) Then
                If (node.NativeObject.Type = ObjectTypeEnum.kComponentOccurrenceObject) Then
                    nodesList.Add(node)
                End If
            End If
        Next

        Dim nodeArray() = nodesList.ToArray()

        Array.Sort(nodeArray, New AlphanumReverseComparator())

        Dim transAction As Transaction = ThisApplication.TransactionManager.StartTransaction(ThisDoc.Document, "Alphanum sort")
        For Each node As BrowserNode In nodeArray
            doc.BrowserPanes.Item("Model").Reorder(orginNode, False, node)
        Next
        transAction.End()
    End Sub


End Class

Public Class AlphanumReverseComparator
    Implements IComparer
    ' Taken from:
    ' https://www.dotnetperls.com/alphanumeric-sorting-vbnet 

    Public Function Compare(ByVal x As Object,
                            ByVal y As Object) As Integer Implements IComparer.Compare

        ' [1] Validate the arguments.
        Dim s1 As String = y.BrowserNodeDefinition.Label
        If s1 = Nothing Then
            Return 0
        End If

        Dim s2 As String = x.BrowserNodeDefinition.Label
        If s2 = Nothing Then
            Return 0
        End If

        Dim len1 As Integer = s1.Length
        Dim len2 As Integer = s2.Length
        Dim marker1 As Integer = 0
        Dim marker2 As Integer = 0

        ' [2] Loop over both Strings.
        While marker1 < len1 And marker2 < len2

            ' [3] Get Chars.
            Dim ch1 As Char = s1(marker1)
            Dim ch2 As Char = s2(marker2)

            Dim space1(len1) As Char
            Dim loc1 As Integer = 0
            Dim space2(len2) As Char
            Dim loc2 As Integer = 0

            ' [4] Collect digits for String one.
            Do
                space1(loc1) = ch1
                loc1 += 1
                marker1 += 1

                If marker1 < len1 Then
                    ch1 = s1(marker1)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch1) = Char.IsDigit(space1(0))

            ' [5] Collect digits for String two.
            Do
                space2(loc2) = ch2
                loc2 += 1
                marker2 += 1

                If marker2 < len2 Then
                    ch2 = s2(marker2)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch2) = Char.IsDigit(space2(0))

            ' [6] Convert to Strings.
            Dim str1 = New String(space1)
            Dim str2 = New String(space2)

            ' [7] Parse Strings into Integers.
            Dim result As Integer
            If Char.IsDigit(space1(0)) And Char.IsDigit(space2(0)) Then
                Dim thisNumericChunk = Integer.Parse(str1)
                Dim thatNumericChunk = Integer.Parse(str2)
                result = thisNumericChunk.CompareTo(thatNumericChunk)
            Else
                result = str1.CompareTo(str2)
            End If

            ' [8] Return result if not equal.
            If Not result = 0 Then
                Return result
            End If
        End While

        ' [9] Compare lengths.
        Return len1 - len2
    End Function
End Class
```

#### Code Block 5

```vb
Public Class ThisRule

    Sub Main()

        Dim doc As AssemblyDocument = ThisDoc.Document
        Dim topNode As BrowserNode = doc.BrowserPanes.Item("Model").TopNode
        Dim nodesList As List(Of BrowserNode) = New List(Of BrowserNode)()
        Dim orginNode As BrowserNode = Nothing

        For Each node As BrowserNode In topNode.BrowserNodes
            If (node.BrowserNodeDefinition.Label.Equals("Origin")) Then
                orginNode = node
            End If
            If (node.NativeObject IsNot Nothing) Then
                If (node.NativeObject.Type = ObjectTypeEnum.kComponentOccurrenceObject) Then
                    nodesList.Add(node)
                End If
            End If
        Next

        Dim nodeArray() = nodesList.ToArray()

        Array.Sort(nodeArray, New AlphanumReverseComparator())

        Dim transAction As Transaction = ThisApplication.TransactionManager.StartTransaction(ThisDoc.Document, "Alphanum sort")
        For Each node As BrowserNode In nodeArray
            doc.BrowserPanes.Item("Model").Reorder(orginNode, False, node)
        Next
        transAction.End()
    End Sub


End Class

Public Class AlphanumReverseComparator
    Implements IComparer
    ' Taken from:
    ' https://www.dotnetperls.com/alphanumeric-sorting-vbnet 

    Public Function Compare(ByVal x As Object,
                            ByVal y As Object) As Integer Implements IComparer.Compare

        ' [1] Validate the arguments.
        Dim s1 As String = y.BrowserNodeDefinition.Label
        If s1 = Nothing Then
            Return 0
        End If

        Dim s2 As String = x.BrowserNodeDefinition.Label
        If s2 = Nothing Then
            Return 0
        End If

        Dim len1 As Integer = s1.Length
        Dim len2 As Integer = s2.Length
        Dim marker1 As Integer = 0
        Dim marker2 As Integer = 0

        ' [2] Loop over both Strings.
        While marker1 < len1 And marker2 < len2

            ' [3] Get Chars.
            Dim ch1 As Char = s1(marker1)
            Dim ch2 As Char = s2(marker2)

            Dim space1(len1) As Char
            Dim loc1 As Integer = 0
            Dim space2(len2) As Char
            Dim loc2 As Integer = 0

            ' [4] Collect digits for String one.
            Do
                space1(loc1) = ch1
                loc1 += 1
                marker1 += 1

                If marker1 < len1 Then
                    ch1 = s1(marker1)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch1) = Char.IsDigit(space1(0))

            ' [5] Collect digits for String two.
            Do
                space2(loc2) = ch2
                loc2 += 1
                marker2 += 1

                If marker2 < len2 Then
                    ch2 = s2(marker2)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch2) = Char.IsDigit(space2(0))

            ' [6] Convert to Strings.
            Dim str1 = New String(space1)
            Dim str2 = New String(space2)

            ' [7] Parse Strings into Integers.
            Dim result As Integer
            If Char.IsDigit(space1(0)) And Char.IsDigit(space2(0)) Then
                Dim thisNumericChunk = Integer.Parse(str1)
                Dim thatNumericChunk = Integer.Parse(str2)
                result = thisNumericChunk.CompareTo(thatNumericChunk)
            Else
                result = str1.CompareTo(str2)
            End If

            ' [8] Return result if not equal.
            If Not result = 0 Then
                Return result
            End If
        End While

        ' [9] Compare lengths.
        Return len1 - len2
    End Function
End Class
```

#### Code Block 6

```vb
Public Class ThisRule

    Sub Main()

        Dim doc As AssemblyDocument = ThisDoc.Document
        Dim topNode As BrowserNode = doc.BrowserPanes.Item("Model").TopNode
        Dim nodesList As List(Of BrowserNode) = New List(Of BrowserNode)()
        Dim orginNode As BrowserNode = Nothing

        For Each node As BrowserNode In topNode.BrowserNodes
            If (node.BrowserNodeDefinition.Label.Equals("Origin")) Then
                orginNode = node
            End If
            If (node.NativeObject IsNot Nothing) Then
                If (node.NativeObject.Type = ObjectTypeEnum.kComponentOccurrenceObject) Then
                    nodesList.Add(node)
                End If
            End If
        Next

        Dim nodeArray() = nodesList.ToArray()

        Array.Sort(nodeArray, New AlphanumReverseComparator())

        Dim transAction As Transaction = ThisApplication.TransactionManager.StartTransaction(ThisDoc.Document, "Alphanum sort")
        For Each node As BrowserNode In nodeArray
            doc.BrowserPanes.Item("Model").Reorder(orginNode, False, node)
        Next
        transAction.End()
    End Sub


End Class

Public Class AlphanumReverseComparator
    Implements IComparer
    ' Taken from:
    ' https://www.dotnetperls.com/alphanumeric-sorting-vbnet 

    Public Function Compare(ByVal x As Object,
                            ByVal y As Object) As Integer Implements IComparer.Compare

        ' [1] Validate the arguments.
        Dim s1 As String = y.BrowserNodeDefinition.Label
        If s1 = Nothing Then
            Return 0
        End If

        Dim s2 As String = x.BrowserNodeDefinition.Label
        If s2 = Nothing Then
            Return 0
        End If

        Dim len1 As Integer = s1.Length
        Dim len2 As Integer = s2.Length
        Dim marker1 As Integer = 0
        Dim marker2 As Integer = 0

        ' [2] Loop over both Strings.
        While marker1 < len1 And marker2 < len2

            ' [3] Get Chars.
            Dim ch1 As Char = s1(marker1)
            Dim ch2 As Char = s2(marker2)

            Dim space1(len1) As Char
            Dim loc1 As Integer = 0
            Dim space2(len2) As Char
            Dim loc2 As Integer = 0

            ' [4] Collect digits for String one.
            Do
                space1(loc1) = ch1
                loc1 += 1
                marker1 += 1

                If marker1 < len1 Then
                    ch1 = s1(marker1)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch1) = Char.IsDigit(space1(0))

            ' [5] Collect digits for String two.
            Do
                space2(loc2) = ch2
                loc2 += 1
                marker2 += 1

                If marker2 < len2 Then
                    ch2 = s2(marker2)
                Else
                    Exit Do
                End If
            Loop While Char.IsDigit(ch2) = Char.IsDigit(space2(0))

            ' [6] Convert to Strings.
            Dim str1 = New String(space1)
            Dim str2 = New String(space2)

            ' [7] Parse Strings into Integers.
            Dim result As Integer
            If Char.IsDigit(space1(0)) And Char.IsDigit(space2(0)) Then
                Dim thisNumericChunk = Integer.Parse(str1)
                Dim thatNumericChunk = Integer.Parse(str2)
                result = thisNumericChunk.CompareTo(thatNumericChunk)
            Else
                result = str1.CompareTo(str2)
            End If

            ' [8] Return result if not equal.
            If Not result = 0 Then
                Return result
            End If
        End While

        ' [9] Compare lengths.
        Return len1 - len2
    End Function
End Class
```

---

### 9. Apply Finish to Sub Assembly within Assembly

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/apply-finish-to-sub-assembly-within-assembly/td-p/13753431#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/apply-finish-to-sub-assembly-within-assembly/td-p/13753431#messageview_0)

**Author:** mitchELAHB

**Date:** ‎08-04-2025
	
		
		04:50 PM

**Description:** I'm trying to add a finish to a sub assembly within an assembly. I have the following code that selects every face of a sub assembly when the user picks one in an assembly, but when I try to add those faces to a finish feature definition I get the error "The parameter is incorrect. (0x80070057 (E_IN...

**Code Snippets (13):**

#### Code Block 1

```vb
Dim oFinishDef As FinishDefinition = oFinishFeatures.CreateFinishDefinition(oFaceCol, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
```

#### Code Block 2

```vb
Dim oFinishDef As FinishDefinition = oFinishFeatures.CreateFinishDefinition(oFaceCol, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
```

#### Code Block 3

```vb
Function GetFaces(occ As Inventor.ComponentOccurrence, _
	Optional ByRef faceColl As Inventor.FaceCollection = Nothing) As Inventor.FaceCollection
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl)
		Next 'oSubOcc
	End If
	Return faceColl
End Function
```

#### Code Block 4

```vb
Function GetFaces(occ As Inventor.ComponentOccurrence, _
	Optional ByRef faceColl As Inventor.FaceCollection = Nothing) As Inventor.FaceCollection
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl)
		Next 'oSubOcc
	End If
	Return faceColl
End Function
```

#### Code Block 5

```vb
Function GetFaces(occ As Inventor.ComponentOccurrence, _
	Optional ByRef faceColl As Inventor.FaceCollection = Nothing) As Inventor.FaceCollection
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl)
		Next 'oSubOcc
	End If
	Return faceColl
End Function
```

#### Code Block 6

```vb
Function GetFaces(occ As Inventor.ComponentOccurrence, _
	Optional ByRef faceColl As Inventor.FaceCollection = Nothing) As Inventor.FaceCollection
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl)
		Next 'oSubOcc
	End If
	Return faceColl
End Function
```

#### Code Block 7

```vb
Sub Main
	
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition

	'set list of components to skip
	Dim oSkipList As New ArrayList
	oSkipList.Clear 
	oSkipList.Add("20110")
	oSkipList.Add("20224")
	
	Dim oFaceColl As Inventor.FaceCollection
	
	For Each oComponent In oADoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceColl, oSkipList)
		
	Next
	
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oADoc.AppearanceAssets.Item(oFinishColour)
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
	
End Sub


Function GetFaces(occ As Inventor.ComponentOccurrence, Optional ByRef faceColl As Inventor.FaceCollection = Nothing, Optional oSkipList As ArrayList = Nothing) As Inventor.FaceCollection
	
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	
	Dim oOccName As String = Split(occ.Name, ":")(0)
	If oSkipList.Contains(oOccName) Then Return Nothing
	
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
		
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl, oSkipList)
		Next 'oSubOcc
	End If
	
	Return faceColl
	
End Function
```

#### Code Block 8

```vb
Sub Main
	
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition

	'set list of components to skip
	Dim oSkipList As New ArrayList
	oSkipList.Clear 
	oSkipList.Add("20110")
	oSkipList.Add("20224")
	
	Dim oFaceColl As Inventor.FaceCollection
	
	For Each oComponent In oADoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceColl, oSkipList)
		
	Next
	
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oADoc.AppearanceAssets.Item(oFinishColour)
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
	
End Sub


Function GetFaces(occ As Inventor.ComponentOccurrence, Optional ByRef faceColl As Inventor.FaceCollection = Nothing, Optional oSkipList As ArrayList = Nothing) As Inventor.FaceCollection
	
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	
	Dim oOccName As String = Split(occ.Name, ":")(0)
	If oSkipList.Contains(oOccName) Then Return Nothing
	
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
		
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl, oSkipList)
		Next 'oSubOcc
	End If
	
	Return faceColl
	
End Function
```

#### Code Block 9

```vb
Sub Main
	
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition

	'set list of components to skip
	Dim oSkipList As New ArrayList
	oSkipList.Clear 
	oSkipList.Add("20110")
	oSkipList.Add("20224")
	
	Dim oFaceColl As Inventor.FaceCollection
	
	For Each oComponent In oADoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceColl, oSkipList)
		
	Next
	
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oADoc.AppearanceAssets.Item(oFinishColour)
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
	
End Sub


Function GetFaces(occ As Inventor.ComponentOccurrence, Optional ByRef faceColl As Inventor.FaceCollection = Nothing, Optional oSkipList As ArrayList = Nothing) As Inventor.FaceCollection
	
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	
	Dim oOccName As String = Split(occ.Name, ":")(0)
	If oSkipList.Contains(oOccName) Then Return Nothing
	
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
		
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl, oSkipList)
		Next 'oSubOcc
	End If
	
	Return faceColl
	
End Function
```

#### Code Block 10

```vb
Sub Main
	
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition

	'set list of components to skip
	Dim oSkipList As New ArrayList
	oSkipList.Clear 
	oSkipList.Add("20110")
	oSkipList.Add("20224")
	
	Dim oFaceColl As Inventor.FaceCollection
	
	For Each oComponent In oADoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceColl, oSkipList)
		
	Next
	
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oADoc.AppearanceAssets.Item(oFinishColour)
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
	
End Sub


Function GetFaces(occ As Inventor.ComponentOccurrence, Optional ByRef faceColl As Inventor.FaceCollection = Nothing, Optional oSkipList As ArrayList = Nothing) As Inventor.FaceCollection
	
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	
	Dim oOccName As String = Split(occ.Name, ":")(0)
	If oSkipList.Contains(oOccName) Then Return Nothing
	
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
		
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl, oSkipList)
		Next 'oSubOcc
	End If
	
	Return faceColl
	
End Function
```

#### Code Block 11

```vb
Sub Main
	
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition

	'set list of components to skip
	Dim oSkipList As New ArrayList
	oSkipList.Clear 
	oSkipList.Add("20110")
	oSkipList.Add("20224")
	
	Dim oFaceColl As Inventor.FaceCollection
	
	For Each oComponent In oADoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceColl, oSkipList)
		
	Next
	
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oADoc.AppearanceAssets.Item(oFinishColour)
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
	
End Sub


Function GetFaces(occ As Inventor.ComponentOccurrence, Optional ByRef faceColl As Inventor.FaceCollection = Nothing, Optional oSkipList As ArrayList = Nothing) As Inventor.FaceCollection
	
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	
	Dim oOccName As String = Split(occ.Name, ":")(0)
	If oSkipList.Contains(oOccName) Then Return Nothing
	
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
		
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl, oSkipList)
		Next 'oSubOcc
	End If
	
	Return faceColl
	
End Function
```

#### Code Block 12

```vb
Sub Main
	
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition

	'set list of components to skip
	Dim oSkipList As New ArrayList
	oSkipList.Clear 
	oSkipList.Add("20110")
	oSkipList.Add("20224")
	
	Dim oFaceColl As Inventor.FaceCollection
	
	For Each oComponent In oADoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceColl, oSkipList)
		
	Next
	
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oADoc.AppearanceAssets.Item(oFinishColour)
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
	
End Sub


Function GetFaces(occ As Inventor.ComponentOccurrence, Optional ByRef faceColl As Inventor.FaceCollection = Nothing, Optional oSkipList As ArrayList = Nothing) As Inventor.FaceCollection
	
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	
	Dim oOccName As String = Split(occ.Name, ":")(0)
	If oSkipList.Contains(oOccName) Then Return Nothing
	
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
		
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl, oSkipList)
		Next 'oSubOcc
	End If
	
	Return faceColl
	
End Function
```

#### Code Block 13

```vb
Sub Main
	
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition

	'set list of components to skip
	Dim oSkipList As New ArrayList
	oSkipList.Clear 
	oSkipList.Add("20110")
	oSkipList.Add("20224")
	
	Dim oFaceColl As Inventor.FaceCollection
	
	For Each oComponent In oADoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceColl, oSkipList)
		
	Next
	
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oADoc.AppearanceAssets.Item(oFinishColour)
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
	
End Sub


Function GetFaces(occ As Inventor.ComponentOccurrence, Optional ByRef faceColl As Inventor.FaceCollection = Nothing, Optional oSkipList As ArrayList = Nothing) As Inventor.FaceCollection
	
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	
	Dim oOccName As String = Split(occ.Name, ":")(0)
	If oSkipList.Contains(oOccName) Then Return Nothing
	
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
		
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl, oSkipList)
		Next 'oSubOcc
	End If
	
	Return faceColl
	
End Function
```

#### Code Block 14

```vb
Sub Main
	
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition

	'set list of components to skip
	Dim oSkipList As New ArrayList
	oSkipList.Clear 
	oSkipList.Add("20110")
	oSkipList.Add("20224")
	
	Dim oFaceColl As Inventor.FaceCollection
	
	For Each oComponent In oADoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceColl, oSkipList)
		
	Next
	
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oADoc.AppearanceAssets.Item(oFinishColour)
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
	
End Sub


Function GetFaces(occ As Inventor.ComponentOccurrence, Optional ByRef faceColl As Inventor.FaceCollection = Nothing, Optional oSkipList As ArrayList = Nothing) As Inventor.FaceCollection
	
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	
	Dim oOccName As String = Split(occ.Name, ":")(0)
	If oSkipList.Contains(oOccName) Then Return Nothing
	
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
		
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl, oSkipList)
		Next 'oSubOcc
	End If
	
	Return faceColl
	
End Function
```

#### Code Block 15

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
	
	Dim oPickedOcc As ComponentOccurrence = oInvApp.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
	If oPickedOcc Is Nothing Then Return
	
	Dim oFaceColl1 As Inventor.FaceCollection = oInvApp.TransientObjects.CreateFaceCollection()
	GetFaces2(oPickedOcc, oFaceColl1)
	
'	Dim oFaceColl2 As Inventor.FaceCollection = GetFaces(oPickedOcc)
	
	Dim oAppAsset As Inventor.Asset = oADoc.AppearanceAssets.Item("Red")
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition( _
	oFaceColl1, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppAsset)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
End Sub

'works OK when the component is a part, not a sub assembly
Function GetFaces(occ As Inventor.ComponentOccurrence) As Inventor.FaceCollection
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	Dim oFaceColl As Inventor.FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			oFaceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	Return oFaceColl
End Function

'works when the component is either a part, or sub assembly
Sub GetFaces2(occ As Inventor.ComponentOccurrence, ByRef faceColl As Inventor.FaceCollection)
	If (occ Is Nothing) OrElse occ.Suppressed Then Return
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces2(oSubOcc, faceColl)
		Next
	End If
End Sub
```

#### Code Block 16

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
	
	Dim oPickedOcc As ComponentOccurrence = oInvApp.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
	If oPickedOcc Is Nothing Then Return
	
	Dim oFaceColl1 As Inventor.FaceCollection = oInvApp.TransientObjects.CreateFaceCollection()
	GetFaces2(oPickedOcc, oFaceColl1)
	
'	Dim oFaceColl2 As Inventor.FaceCollection = GetFaces(oPickedOcc)
	
	Dim oAppAsset As Inventor.Asset = oADoc.AppearanceAssets.Item("Red")
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition( _
	oFaceColl1, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppAsset)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
End Sub

'works OK when the component is a part, not a sub assembly
Function GetFaces(occ As Inventor.ComponentOccurrence) As Inventor.FaceCollection
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	Dim oFaceColl As Inventor.FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			oFaceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	Return oFaceColl
End Function

'works when the component is either a part, or sub assembly
Sub GetFaces2(occ As Inventor.ComponentOccurrence, ByRef faceColl As Inventor.FaceCollection)
	If (occ Is Nothing) OrElse occ.Suppressed Then Return
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces2(oSubOcc, faceColl)
		Next
	End If
End Sub
```

#### Code Block 17

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
	
	Dim oPickedOcc As ComponentOccurrence = oInvApp.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
	If oPickedOcc Is Nothing Then Return
	
	Dim oFaceColl1 As Inventor.FaceCollection = oInvApp.TransientObjects.CreateFaceCollection()
	GetFaces2(oPickedOcc, oFaceColl1)
	
'	Dim oFaceColl2 As Inventor.FaceCollection = GetFaces(oPickedOcc)
	
	Dim oAppAsset As Inventor.Asset = oADoc.AppearanceAssets.Item("Red")
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition( _
	oFaceColl1, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppAsset)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
End Sub

'works OK when the component is a part, not a sub assembly
Function GetFaces(occ As Inventor.ComponentOccurrence) As Inventor.FaceCollection
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	Dim oFaceColl As Inventor.FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			oFaceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	Return oFaceColl
End Function

'works when the component is either a part, or sub assembly
Sub GetFaces2(occ As Inventor.ComponentOccurrence, ByRef faceColl As Inventor.FaceCollection)
	If (occ Is Nothing) OrElse occ.Suppressed Then Return
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces2(oSubOcc, faceColl)
		Next
	End If
End Sub
```

#### Code Block 18

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
	
	Dim oPickedOcc As ComponentOccurrence = oInvApp.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
	If oPickedOcc Is Nothing Then Return
	
	Dim oFaceColl1 As Inventor.FaceCollection = oInvApp.TransientObjects.CreateFaceCollection()
	GetFaces2(oPickedOcc, oFaceColl1)
	
'	Dim oFaceColl2 As Inventor.FaceCollection = GetFaces(oPickedOcc)
	
	Dim oAppAsset As Inventor.Asset = oADoc.AppearanceAssets.Item("Red")
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition( _
	oFaceColl1, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppAsset)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
End Sub

'works OK when the component is a part, not a sub assembly
Function GetFaces(occ As Inventor.ComponentOccurrence) As Inventor.FaceCollection
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	Dim oFaceColl As Inventor.FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			oFaceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	Return oFaceColl
End Function

'works when the component is either a part, or sub assembly
Sub GetFaces2(occ As Inventor.ComponentOccurrence, ByRef faceColl As Inventor.FaceCollection)
	If (occ Is Nothing) OrElse occ.Suppressed Then Return
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces2(oSubOcc, faceColl)
		Next
	End If
End Sub
```

#### Code Block 19

```vb
Sub Main()
	
	Dim oAsm As AssemblyDocument = ThisDoc.Document
	Dim oFaceCol As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
	Dim oFaceProx As FaceProxy
	Dim oComponent As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "select subassembly")
	
	If oComponent.Definition.Type = ObjectTypeEnum.kAssemblyComponentDefinitionObject
		Dim oDef As AssemblyComponentDefinition = oComponent.Definition
		For Each oFaceProx In GetProxies(oComponent)
			ThisApplication.CommandManager.DoSelect(oFaceProx)
			oFaceCol.Add(oFaceProx)
		Next
	End If
	
	MsgBox(oFaceCol.Count)
	
	'Create finish definition.
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oAsm.AppearanceAssets.Item(oFinishColour)
	Dim oFinishFeatures As FinishFeatures = oAsm.ComponentDefinition.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeatures.CreateFinishDefinition(oFaceCol, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)

'Create finish feature 
	Try
	    Dim oFinish As FinishFeature = oFinishFeatures.Add(oFinishDef)
	Catch
		Logger.Trace("Couldn't create finish in " & oAsm.DisplayName & ".")
	End Try

End Sub

Function GetProxies(oComponent As ComponentOccurrence) As ObjectCollection
	
	Dim oProxCol As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
	Dim oDef As AssemblyComponentDefinition = oComponent.Definition
	
	For Each oComp As ComponentOccurrence In oDef.Occurrences
		If oComp.Definition.Type = ObjectTypeEnum.kAssemblyComponentDefinitionObject
			For Each oProx1 As FaceProxy In GetProxies(oComp)
				Dim oProx2 As FaceProxy
				Call oComponent.CreateGeometryProxy(oProx1, oProx2)
				oProxCol.Add(oProx2)
			Next
		Else
			Dim oCompDef As PartComponentDefinition = oComp.Definition
			For Each oBod As SurfaceBody In oCompDef.SurfaceBodies
				For Each oFace As Face In oBod.Faces
				Dim oProx1 As FaceProxy
				Dim oProx2 As FaceProxy
				Call oComp.CreateGeometryProxy(oFace, oProx1)
				Call oComponent.CreateGeometryProxy(oProx1, oProx2)
				oProxCol.Add(oProx2)
				Next
			Next
		End If
	Next
	
	Return oProxCol
	
End Function
```

#### Code Block 20

```vb
Sub Main()
	
	Dim oAsm As AssemblyDocument = ThisDoc.Document
	Dim oFaceCol As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
	Dim oFaceProx As FaceProxy
	Dim oComponent As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "select subassembly")
	
	If oComponent.Definition.Type = ObjectTypeEnum.kAssemblyComponentDefinitionObject
		Dim oDef As AssemblyComponentDefinition = oComponent.Definition
		For Each oFaceProx In GetProxies(oComponent)
			ThisApplication.CommandManager.DoSelect(oFaceProx)
			oFaceCol.Add(oFaceProx)
		Next
	End If
	
	MsgBox(oFaceCol.Count)
	
	'Create finish definition.
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oAsm.AppearanceAssets.Item(oFinishColour)
	Dim oFinishFeatures As FinishFeatures = oAsm.ComponentDefinition.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeatures.CreateFinishDefinition(oFaceCol, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)

'Create finish feature 
	Try
	    Dim oFinish As FinishFeature = oFinishFeatures.Add(oFinishDef)
	Catch
		Logger.Trace("Couldn't create finish in " & oAsm.DisplayName & ".")
	End Try

End Sub

Function GetProxies(oComponent As ComponentOccurrence) As ObjectCollection
	
	Dim oProxCol As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
	Dim oDef As AssemblyComponentDefinition = oComponent.Definition
	
	For Each oComp As ComponentOccurrence In oDef.Occurrences
		If oComp.Definition.Type = ObjectTypeEnum.kAssemblyComponentDefinitionObject
			For Each oProx1 As FaceProxy In GetProxies(oComp)
				Dim oProx2 As FaceProxy
				Call oComponent.CreateGeometryProxy(oProx1, oProx2)
				oProxCol.Add(oProx2)
			Next
		Else
			Dim oCompDef As PartComponentDefinition = oComp.Definition
			For Each oBod As SurfaceBody In oCompDef.SurfaceBodies
				For Each oFace As Face In oBod.Faces
				Dim oProx1 As FaceProxy
				Dim oProx2 As FaceProxy
				Call oComp.CreateGeometryProxy(oFace, oProx1)
				Call oComponent.CreateGeometryProxy(oProx1, oProx2)
				oProxCol.Add(oProx2)
				Next
			Next
		End If
	Next
	
	Return oProxCol
	
End Function
```

#### Code Block 21

```vb
Sub Main()
	
	Dim oAsm As AssemblyDocument = ThisDoc.Document
	Dim oFaceCol As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
	Dim oFaceProx As FaceProxy
	Dim oComponent As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "select subassembly")
	
	If oComponent.Definition.Type = ObjectTypeEnum.kAssemblyComponentDefinitionObject
		Dim oDef As AssemblyComponentDefinition = oComponent.Definition
		For Each oFaceProx In GetProxies(oComponent)
			ThisApplication.CommandManager.DoSelect(oFaceProx)
			oFaceCol.Add(oFaceProx)
		Next
	End If
	
	MsgBox(oFaceCol.Count)
	
	'Create finish definition.
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oAsm.AppearanceAssets.Item(oFinishColour)
	Dim oFinishFeatures As FinishFeatures = oAsm.ComponentDefinition.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeatures.CreateFinishDefinition(oFaceCol, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)

'Create finish feature 
	Try
	    Dim oFinish As FinishFeature = oFinishFeatures.Add(oFinishDef)
	Catch
		Logger.Trace("Couldn't create finish in " & oAsm.DisplayName & ".")
	End Try

End Sub

Function GetProxies(oComponent As ComponentOccurrence) As ObjectCollection
	
	Dim oProxCol As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
	Dim oDef As AssemblyComponentDefinition = oComponent.Definition
	
	For Each oComp As ComponentOccurrence In oDef.Occurrences
		If oComp.Definition.Type = ObjectTypeEnum.kAssemblyComponentDefinitionObject
			For Each oProx1 As FaceProxy In GetProxies(oComp)
				Dim oProx2 As FaceProxy
				Call oComponent.CreateGeometryProxy(oProx1, oProx2)
				oProxCol.Add(oProx2)
			Next
		Else
			Dim oCompDef As PartComponentDefinition = oComp.Definition
			For Each oBod As SurfaceBody In oCompDef.SurfaceBodies
				For Each oFace As Face In oBod.Faces
				Dim oProx1 As FaceProxy
				Dim oProx2 As FaceProxy
				Call oComp.CreateGeometryProxy(oFace, oProx1)
				Call oComponent.CreateGeometryProxy(oProx1, oProx2)
				oProxCol.Add(oProx2)
				Next
			Next
		End If
	Next
	
	Return oProxCol
	
End Function
```

#### Code Block 22

```vb
Sub Main()
	
	Dim oAsm As AssemblyDocument = ThisDoc.Document
	Dim oFaceCol As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
	Dim oFaceProx As FaceProxy
	Dim oComponent As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "select subassembly")
	
	If oComponent.Definition.Type = ObjectTypeEnum.kAssemblyComponentDefinitionObject
		Dim oDef As AssemblyComponentDefinition = oComponent.Definition
		For Each oFaceProx In GetProxies(oComponent)
			ThisApplication.CommandManager.DoSelect(oFaceProx)
			oFaceCol.Add(oFaceProx)
		Next
	End If
	
	MsgBox(oFaceCol.Count)
	
	'Create finish definition.
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oAsm.AppearanceAssets.Item(oFinishColour)
	Dim oFinishFeatures As FinishFeatures = oAsm.ComponentDefinition.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeatures.CreateFinishDefinition(oFaceCol, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)

'Create finish feature 
	Try
	    Dim oFinish As FinishFeature = oFinishFeatures.Add(oFinishDef)
	Catch
		Logger.Trace("Couldn't create finish in " & oAsm.DisplayName & ".")
	End Try

End Sub

Function GetProxies(oComponent As ComponentOccurrence) As ObjectCollection
	
	Dim oProxCol As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
	Dim oDef As AssemblyComponentDefinition = oComponent.Definition
	
	For Each oComp As ComponentOccurrence In oDef.Occurrences
		If oComp.Definition.Type = ObjectTypeEnum.kAssemblyComponentDefinitionObject
			For Each oProx1 As FaceProxy In GetProxies(oComp)
				Dim oProx2 As FaceProxy
				Call oComponent.CreateGeometryProxy(oProx1, oProx2)
				oProxCol.Add(oProx2)
			Next
		Else
			Dim oCompDef As PartComponentDefinition = oComp.Definition
			For Each oBod As SurfaceBody In oCompDef.SurfaceBodies
				For Each oFace As Face In oBod.Faces
				Dim oProx1 As FaceProxy
				Dim oProx2 As FaceProxy
				Call oComp.CreateGeometryProxy(oFace, oProx1)
				Call oComponent.CreateGeometryProxy(oProx1, oProx2)
				oProxCol.Add(oProx2)
				Next
			Next
		End If
	Next
	
	Return oProxCol
	
End Function
```

#### Code Block 23

```vb
Sub Main()
	
	Dim oDoc As AssemblyDocument = ThisDoc.Document
	
	'set up face collection 
	Dim oFace As Face
	Dim oFaceCol As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
	
	For Each oComponent In oDoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
			
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceCol)
		
	Next
	
	For Each oFace In oFaceCol
		
		ThisApplication.CommandManager.DoSelect(oFace)
		
	Next
	
	MsgBox("Number of faces: " & oFaceCol.Count)
	
	'Create finish definition.
	Dim oFinish As FinishFeature
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oDoc.AppearanceAssets.Item(oFinishColour)
	Dim oFinishFeatures As FinishFeatures = oDoc.ComponentDefinition.Features.FinishFeatures
    Dim oFinishDef As FinishDefinition = oFinishFeatures.CreateFinishDefinition(oFaceCol, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	
    'Create finish feature and rename
	Try
	    oFinish = oFinishFeatures.Add(oFinishDef)
		'oFinish.Name = oFinishName
	Catch
		Logger.Trace("Couldn't create finish in " & oDoc.DisplayName & ".")
	End Try
	
End Sub

Sub GetFaces(oOcc As ComponentOccurrence, oFaceCollection As FaceCollection)
		
		'check if occurance is assembly
		If oOcc.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
			
			For Each oComponent In oOcc.SubOccurrences
				
				'skip if component component is suppressed
				If oComponent.Suppressed = True Then Continue For
				
				'skip if virtual component
				If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
				
				GetFaces(oComponent, oFaceCollection) 
				
			Next
			
		Else
		
		    For Each oSurfaceBody In oOcc.SurfaceBodies
		        For Each oFace In oSurfaceBody.Faces
		            oFaceCollection.Add(oFace)
		        Next
		    Next
			
		End If
	
End Sub
```

#### Code Block 24

```vb
Sub Main()
	
	Dim oDoc As AssemblyDocument = ThisDoc.Document
	
	'set up face collection 
	Dim oFace As Face
	Dim oFaceCol As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
	
	For Each oComponent In oDoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
			
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceCol)
		
	Next
	
	For Each oFace In oFaceCol
		
		ThisApplication.CommandManager.DoSelect(oFace)
		
	Next
	
	MsgBox("Number of faces: " & oFaceCol.Count)
	
	'Create finish definition.
	Dim oFinish As FinishFeature
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oDoc.AppearanceAssets.Item(oFinishColour)
	Dim oFinishFeatures As FinishFeatures = oDoc.ComponentDefinition.Features.FinishFeatures
    Dim oFinishDef As FinishDefinition = oFinishFeatures.CreateFinishDefinition(oFaceCol, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	
    'Create finish feature and rename
	Try
	    oFinish = oFinishFeatures.Add(oFinishDef)
		'oFinish.Name = oFinishName
	Catch
		Logger.Trace("Couldn't create finish in " & oDoc.DisplayName & ".")
	End Try
	
End Sub

Sub GetFaces(oOcc As ComponentOccurrence, oFaceCollection As FaceCollection)
		
		'check if occurance is assembly
		If oOcc.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
			
			For Each oComponent In oOcc.SubOccurrences
				
				'skip if component component is suppressed
				If oComponent.Suppressed = True Then Continue For
				
				'skip if virtual component
				If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
				
				GetFaces(oComponent, oFaceCollection) 
				
			Next
			
		Else
		
		    For Each oSurfaceBody In oOcc.SurfaceBodies
		        For Each oFace In oSurfaceBody.Faces
		            oFaceCollection.Add(oFace)
		        Next
		    Next
			
		End If
	
End Sub
```

#### Code Block 25

```vb
Sub Main()
	
	Dim oDoc As AssemblyDocument = ThisDoc.Document
	
	'set up face collection 
	Dim oFace As Face
	Dim oFaceCol As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
	
	For Each oComponent In oDoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
			
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceCol)
		
	Next
	
	For Each oFace In oFaceCol
		
		ThisApplication.CommandManager.DoSelect(oFace)
		
	Next
	
	MsgBox("Number of faces: " & oFaceCol.Count)
	
	'Create finish definition.
	Dim oFinish As FinishFeature
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oDoc.AppearanceAssets.Item(oFinishColour)
	Dim oFinishFeatures As FinishFeatures = oDoc.ComponentDefinition.Features.FinishFeatures
    Dim oFinishDef As FinishDefinition = oFinishFeatures.CreateFinishDefinition(oFaceCol, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	
    'Create finish feature and rename
	Try
	    oFinish = oFinishFeatures.Add(oFinishDef)
		'oFinish.Name = oFinishName
	Catch
		Logger.Trace("Couldn't create finish in " & oDoc.DisplayName & ".")
	End Try
	
End Sub

Sub GetFaces(oOcc As ComponentOccurrence, oFaceCollection As FaceCollection)
		
		'check if occurance is assembly
		If oOcc.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
			
			For Each oComponent In oOcc.SubOccurrences
				
				'skip if component component is suppressed
				If oComponent.Suppressed = True Then Continue For
				
				'skip if virtual component
				If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
				
				GetFaces(oComponent, oFaceCollection) 
				
			Next
			
		Else
		
		    For Each oSurfaceBody In oOcc.SurfaceBodies
		        For Each oFace In oSurfaceBody.Faces
		            oFaceCollection.Add(oFace)
		        Next
		    Next
			
		End If
	
End Sub
```

#### Code Block 26

```vb
Sub Main()
	
	Dim oDoc As AssemblyDocument = ThisDoc.Document
	
	'set up face collection 
	Dim oFace As Face
	Dim oFaceCol As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
	
	For Each oComponent In oDoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
			
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceCol)
		
	Next
	
	For Each oFace In oFaceCol
		
		ThisApplication.CommandManager.DoSelect(oFace)
		
	Next
	
	MsgBox("Number of faces: " & oFaceCol.Count)
	
	'Create finish definition.
	Dim oFinish As FinishFeature
	Dim oFinishColour = iProperties.Value("Custom", "Box Colour")
	Dim oAppearance As Object = oDoc.AppearanceAssets.Item(oFinishColour)
	Dim oFinishFeatures As FinishFeatures = oDoc.ComponentDefinition.Features.FinishFeatures
    Dim oFinishDef As FinishDefinition = oFinishFeatures.CreateFinishDefinition(oFaceCol, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	
    'Create finish feature and rename
	Try
	    oFinish = oFinishFeatures.Add(oFinishDef)
		'oFinish.Name = oFinishName
	Catch
		Logger.Trace("Couldn't create finish in " & oDoc.DisplayName & ".")
	End Try
	
End Sub

Sub GetFaces(oOcc As ComponentOccurrence, oFaceCollection As FaceCollection)
		
		'check if occurance is assembly
		If oOcc.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
			
			For Each oComponent In oOcc.SubOccurrences
				
				'skip if component component is suppressed
				If oComponent.Suppressed = True Then Continue For
				
				'skip if virtual component
				If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
				
				GetFaces(oComponent, oFaceCollection) 
				
			Next
			
		Else
		
		    For Each oSurfaceBody In oOcc.SurfaceBodies
		        For Each oFace In oSurfaceBody.Faces
		            oFaceCollection.Add(oFace)
		        Next
		    Next
			
		End If
	
End Sub
```

---

### 10. Apprentice Server with powershell, working prefix copy design

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/apprentice-server-with-powershell-working-prefix-copy-design/td-p/13750480#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/apprentice-server-with-powershell-working-prefix-copy-design/td-p/13750480#messageview_0)

**Author:** maxim.teleguz

**Date:** ‎08-01-2025
	
		
		12:59 PM

**Description:** I am posting this so the community can figure out more items related to this so we can expand what we can do with this. I still need to figure out the renaming structure, but that should be easy. Now copy design should be possible from inventor as it reuses the current session for this.powershell sc...

**Code Snippets (4):**

#### Code Block 1

```vb
# --------------------------------------------------------------------------------
# CopyDesign Script
#
# DESCRIPTION
#   Copies an Inventor assembly (.iam), its referenced parts (.ipt/.iam), and
#   drawing files (.idw/.dwg/.ipn) into a new folder, renames them with a user-
#   specified prefix, relinks all references, suppresses iLogic rule execution,
#   and updates the Part Number iProperty on each copied file.
#
# NAMING CONVENTION REQUIRED
#   • Model files (.iam, .ipt):
#       – Base name must start with '0' and end with '-<digits>' 
#         e.g. 0001-1.ipt, 0001-501.iam
#       – OR base name must start with one of your custom prefixes 
#         (e.g. WIP_, WIP2_)
#   • Drawing files (.idw):
#       – Base name must start with '0' and end with a digit 
#         e.g. 0001.idw
#       – OR start with one of your custom prefixes
#   • Other drawing types (.dwg, .ipn) are always copied regardless of name.
#   • Enter any extra prefixes when prompted; leave blank to skip.
#
# NOTE
#   Inventor must be running. The script attaches to the existing session.
# --------------------------------------------------------------------------------

$ErrorActionPreference = 'Stop'

#
# ←—— USER INPUT Prompts ————————————————————————————————————————
#

# Prompt for the folder containing the top-level assembly
$asmDir = Read-Host 'Enter the directory containing the top-level assembly'
if (-not (Test-Path $asmDir)) {
    Write-Error "Directory not found: $asmDir"
    exit 1
}

# Prompt for the assembly filename (with or without .iam)
$inputName = Read-Host 'Enter the top-level assembly filename (with or without .iam extension)'
if ($inputName -match '\.iam$') {
    $asmName = $inputName
} else {
    $asmName = "$inputName.iam"
}

# Build the full assembly path
$asmPath = Join-Path $asmDir $asmName
if (-not (Test-Path $asmPath)) {
    Write-Error "Assembly not found: $asmPath"
    exit 1
}

# Prompt for the destination folder
$destDir = Read-Host 'Enter the destination directory for copied files'
if (-not (Test-Path $destDir)) {
    New-Item -ItemType Directory -Path $destDir | Out-Null
}

# Prompt for the filename prefix
$prefix = Read-Host 'Enter the prefix to prepend to copied filenames (e.g. Copy_)'
if (-not $prefix) {
    Write-Error "Prefix cannot be empty."
    exit 1
}

#
# ←—— Existing logic below unchanged, using $asmPath, $destDir, $prefix ——————————————————
#

# Prompt for any existing filename prefixes (e.g. WIP_, WIP2_) that should be allowed
# even if they don’t follow the “0…-digit” naming rule
$custom = Read-Host 'Enter any any existing filename prefixes if they do not follow the naming rule, to include in the copy, (comma-separated for different ones), or press Enter to skip'
if ($custom) { $extraPrefixes = $custom -split ',' | ForEach-Object { $_.Trim() } } else { $extraPrefixes = @() }

# ApprenticeServer for CAD-only copy
$appr = New-Object -ComObject Inventor.ApprenticeServer
$asm  = $appr.Open($asmPath)
$save = $appr.FileSaveAs

function Pref([string]$path) {
    $prefix + ([IO.Path]::GetFileName($path))
}

# 1) queue the main assembly
$save.AddFileToSave(
    $asm,
    (Join-Path $destDir (Pref $asmPath))
)

# 2) queue filtered parts & sub-assemblies
foreach ($doc in $asm.AllReferencedDocuments) {
    if ($doc.NeedsMigrating) { continue }

    $fileName = [IO.Path]::GetFileName($doc.FullFileName)
    $baseName = [IO.Path]::GetFileNameWithoutExtension($fileName)
    $ext      = [IO.Path]::GetExtension($fileName).ToLowerInvariant()

    $matchesPattern = $baseName -match '^0.*-\d+$'
    $matchesExtra   = $false
    foreach ($p in $extraPrefixes) {
        if ($p -and $baseName.StartsWith($p)) { $matchesExtra = $true; break }
    }

    if (($ext -in '.iam','.ipt') -and ($matchesPattern -or $matchesExtra)) {
        $out    = Join-Path $destDir (Pref $doc.FullFileName)
        $outDir = Split-Path $out
        if (-not (Test-Path $outDir)) {
            New-Item -ItemType Directory -Path $outDir -Force | Out-Null
        }
        $save.AddFileToSave(
            $doc,
            $out
        )
    }
    else {
        Write-Host "Skipping $fileName (naming filter)" -ForegroundColor DarkYellow
    }
}

# 3) perform CAD copy
$save.ExecuteSaveCopyAs()

# 4) copy drawings from disk, filtered
$exts = '.idw','.dwg','.ipn'
function CopyDrawings($folder) {
    foreach ($e in $exts) {
        Get-ChildItem -Path $folder -Filter "*$e" -File -ErrorAction SilentlyContinue |
        Where-Object {
            if ($_.Extension -ieq '.idw') {
                $b = $_.BaseName
                $okPattern = $b -match '^0.*\d$'
                $okExtra   = $false
                foreach ($p in $extraPrefixes) {
                    if ($p -and $b.StartsWith($p)) { $okExtra = $true; break }
                }
                $okPattern -or $okExtra
            }
            else { $true }
        } |
        ForEach-Object {
            Copy-Item $_.FullName (Join-Path $destDir ($prefix + $_.Name)) -Force
        }
    }
}
CopyDrawings (Split-Path $asmPath -Parent)
foreach ($doc in @($asm) + $asm.AllReferencedDocuments) {
    CopyDrawings (Split-Path $doc.FullFileName -Parent)
}

# 4.5) remove Read-Only attribute
Get-ChildItem -Path $destDir -Recurse -File |
    Where-Object { $_.Extension -in '.iam','.ipt','.idw' } |
    ForEach-Object {
        if ($_.IsReadOnly) {
            $_.IsReadOnly = $false
            Write-Host "Removed ReadOnly: $($_.FullName)"
        }
    }

# 5) first relink pass via ApprenticeServer
function RelinkDrawings {
    param($folder, $filePrefix)
    $invApp = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")
    Get-ChildItem -Path $folder -Include '*.idw','*.dwg' -File | ForEach-Object {
        $draw = $invApp.Documents.Open($_.FullName, $true)
        foreach ($desc in $draw.ReferencedDocumentDescriptors) {
            $old  = $desc.ReferencedFileDescriptor.FullFileName
            $base = [IO.Path]::GetFileName($old)
            $new  = Join-Path $folder ($filePrefix + $base)
            if (Test-Path $new) {
                $desc.ReferencedFileDescriptor.Path = $new
            }
        }
        $draw.Update(); $draw.Save(); $draw.Close()
    }
}
RelinkDrawings -folder $destDir -filePrefix $prefix

# 6) open result folder
Start-Process explorer.exe -ArgumentList $destDir

# 7) full-session ReplaceReference relink (suppress pop-ups & iLogic)
Write-Host "Preparing full-session relink with iLogic/events off…" -ForegroundColor Cyan

# attach to running Inventor
$inv = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")

# allow alerts, but run silently
try { $inv.DisplayAlerts  = $true  } catch {}
try { $inv.SilentOperation = $true  } catch {}

# disable VB iLogic automation mode
try {
    $iLogicVB = $inv.ApplicationAddIns.ItemById('{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}')
    if (-not $iLogicVB.Activated) { $iLogicVB.Activate() }
    $iLogicVB.Automation.RulesEnabled           = $false
    $iLogicVB.Automation.RulesOnEventsEnabled   = $false
    $iLogicVB.Automation.SilentOperation        = $true
    $iLogicVB.Automation.CallingFromOutside     = $true
    Write-Host "iLogic VB automation mode ON."
}
catch { Write-Warning "VB iLogic disable failed: $($_.Exception.Message)" }

# build source->dest map
$map = @{}
$allDocs = New-Object System.Collections.Generic.List[Object]
$queue   = New-Object System.Collections.Generic.Queue[Object]
$queue.Enqueue($asm)
while ($queue.Count -gt 0) {
    $d = $queue.Dequeue()
    if (-not ($allDocs -contains $d)) {
        $allDocs.Add($d)
        foreach ($child in $d.AllReferencedDocuments) {
            if ($child.FullFileName) { $queue.Enqueue($child) }
        }
    }
}
foreach ($doc in $allDocs) {
    if ($doc.FullFileName) {
        $map[$doc.FullFileName.ToLower()] = Join-Path $destDir ($prefix + [IO.Path]::GetFileName($doc.FullFileName))
    }
}
foreach ($file in Get-ChildItem -Path $destDir -Filter "$prefix*.idw" -File) {
    $orig = $file.Name.Substring($prefix.Length)
    $map[(Join-Path (Split-Path $asmPath -Parent) $orig).ToLower()] = $file.FullName
}

# ReplaceReference relink loop
Get-ChildItem -Path $destDir -Filter "$prefix*.idw" -Recurse -File | ForEach-Object {
    Write-Host "  • $($_.Name)"
    $dw = $inv.Documents.Open($_.FullName, $false)
    foreach ($r in $dw.ReferencedFileDescriptors) {
        $k = $r.FullFileName.ToLower()
        if ($map.ContainsKey($k)) {
            $r.DocumentDescriptor.ReferencedFileDescriptor.ReplaceReference($map[$k])
        }
    }
    $dw.Update(); $dw.Save2(); $dw.Close($true)
}

# 8) update Part Number iProperties
Write-Host "Updating Part Number iProperties…" -ForegroundColor Cyan
$inv2 = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")
Get-ChildItem -Path $destDir -Filter "$prefix*" -File | ForEach-Object {
    Write-Host "  • $($_.Name)"
    $doc2 = $inv2.Documents.Open($_.FullName, $false)
    try {
        $ps = $doc2.PropertySets.Item("Design Tracking Properties")
        $ps.Item("Part Number").Value = [IO.Path]::GetFileNameWithoutExtension($_.Name)
        $doc2.Update(); $doc2.Save2()
    }
    catch {
        Write-Warning "  ! Part Number failed on $($_.Name): $($_.Exception.Message)"
    }
    finally {
        $doc2.Close($true)
    }
}
Write-Host "Part Number update complete." -ForegroundColor Green
```

#### Code Block 2

```vb
# --------------------------------------------------------------------------------
# CopyDesign Script
#
# DESCRIPTION
#   Copies an Inventor assembly (.iam), its referenced parts (.ipt/.iam), and
#   drawing files (.idw/.dwg/.ipn) into a new folder, renames them with a user-
#   specified prefix, relinks all references, suppresses iLogic rule execution,
#   and updates the Part Number iProperty on each copied file.
#
# NAMING CONVENTION REQUIRED
#   • Model files (.iam, .ipt):
#       – Base name must start with '0' and end with '-<digits>' 
#         e.g. 0001-1.ipt, 0001-501.iam
#       – OR base name must start with one of your custom prefixes 
#         (e.g. WIP_, WIP2_)
#   • Drawing files (.idw):
#       – Base name must start with '0' and end with a digit 
#         e.g. 0001.idw
#       – OR start with one of your custom prefixes
#   • Other drawing types (.dwg, .ipn) are always copied regardless of name.
#   • Enter any extra prefixes when prompted; leave blank to skip.
#
# NOTE
#   Inventor must be running. The script attaches to the existing session.
# --------------------------------------------------------------------------------

$ErrorActionPreference = 'Stop'

#
# ←—— USER INPUT Prompts ————————————————————————————————————————
#

# Prompt for the folder containing the top-level assembly
$asmDir = Read-Host 'Enter the directory containing the top-level assembly'
if (-not (Test-Path $asmDir)) {
    Write-Error "Directory not found: $asmDir"
    exit 1
}

# Prompt for the assembly filename (with or without .iam)
$inputName = Read-Host 'Enter the top-level assembly filename (with or without .iam extension)'
if ($inputName -match '\.iam$') {
    $asmName = $inputName
} else {
    $asmName = "$inputName.iam"
}

# Build the full assembly path
$asmPath = Join-Path $asmDir $asmName
if (-not (Test-Path $asmPath)) {
    Write-Error "Assembly not found: $asmPath"
    exit 1
}

# Prompt for the destination folder
$destDir = Read-Host 'Enter the destination directory for copied files'
if (-not (Test-Path $destDir)) {
    New-Item -ItemType Directory -Path $destDir | Out-Null
}

# Prompt for the filename prefix
$prefix = Read-Host 'Enter the prefix to prepend to copied filenames (e.g. Copy_)'
if (-not $prefix) {
    Write-Error "Prefix cannot be empty."
    exit 1
}

#
# ←—— Existing logic below unchanged, using $asmPath, $destDir, $prefix ——————————————————
#

# Prompt for any existing filename prefixes (e.g. WIP_, WIP2_) that should be allowed
# even if they don’t follow the “0…-digit” naming rule
$custom = Read-Host 'Enter any any existing filename prefixes if they do not follow the naming rule, to include in the copy, (comma-separated for different ones), or press Enter to skip'
if ($custom) { $extraPrefixes = $custom -split ',' | ForEach-Object { $_.Trim() } } else { $extraPrefixes = @() }

# ApprenticeServer for CAD-only copy
$appr = New-Object -ComObject Inventor.ApprenticeServer
$asm  = $appr.Open($asmPath)
$save = $appr.FileSaveAs

function Pref([string]$path) {
    $prefix + ([IO.Path]::GetFileName($path))
}

# 1) queue the main assembly
$save.AddFileToSave(
    $asm,
    (Join-Path $destDir (Pref $asmPath))
)

# 2) queue filtered parts & sub-assemblies
foreach ($doc in $asm.AllReferencedDocuments) {
    if ($doc.NeedsMigrating) { continue }

    $fileName = [IO.Path]::GetFileName($doc.FullFileName)
    $baseName = [IO.Path]::GetFileNameWithoutExtension($fileName)
    $ext      = [IO.Path]::GetExtension($fileName).ToLowerInvariant()

    $matchesPattern = $baseName -match '^0.*-\d+$'
    $matchesExtra   = $false
    foreach ($p in $extraPrefixes) {
        if ($p -and $baseName.StartsWith($p)) { $matchesExtra = $true; break }
    }

    if (($ext -in '.iam','.ipt') -and ($matchesPattern -or $matchesExtra)) {
        $out    = Join-Path $destDir (Pref $doc.FullFileName)
        $outDir = Split-Path $out
        if (-not (Test-Path $outDir)) {
            New-Item -ItemType Directory -Path $outDir -Force | Out-Null
        }
        $save.AddFileToSave(
            $doc,
            $out
        )
    }
    else {
        Write-Host "Skipping $fileName (naming filter)" -ForegroundColor DarkYellow
    }
}

# 3) perform CAD copy
$save.ExecuteSaveCopyAs()

# 4) copy drawings from disk, filtered
$exts = '.idw','.dwg','.ipn'
function CopyDrawings($folder) {
    foreach ($e in $exts) {
        Get-ChildItem -Path $folder -Filter "*$e" -File -ErrorAction SilentlyContinue |
        Where-Object {
            if ($_.Extension -ieq '.idw') {
                $b = $_.BaseName
                $okPattern = $b -match '^0.*\d$'
                $okExtra   = $false
                foreach ($p in $extraPrefixes) {
                    if ($p -and $b.StartsWith($p)) { $okExtra = $true; break }
                }
                $okPattern -or $okExtra
            }
            else { $true }
        } |
        ForEach-Object {
            Copy-Item $_.FullName (Join-Path $destDir ($prefix + $_.Name)) -Force
        }
    }
}
CopyDrawings (Split-Path $asmPath -Parent)
foreach ($doc in @($asm) + $asm.AllReferencedDocuments) {
    CopyDrawings (Split-Path $doc.FullFileName -Parent)
}

# 4.5) remove Read-Only attribute
Get-ChildItem -Path $destDir -Recurse -File |
    Where-Object { $_.Extension -in '.iam','.ipt','.idw' } |
    ForEach-Object {
        if ($_.IsReadOnly) {
            $_.IsReadOnly = $false
            Write-Host "Removed ReadOnly: $($_.FullName)"
        }
    }

# 5) first relink pass via ApprenticeServer
function RelinkDrawings {
    param($folder, $filePrefix)
    $invApp = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")
    Get-ChildItem -Path $folder -Include '*.idw','*.dwg' -File | ForEach-Object {
        $draw = $invApp.Documents.Open($_.FullName, $true)
        foreach ($desc in $draw.ReferencedDocumentDescriptors) {
            $old  = $desc.ReferencedFileDescriptor.FullFileName
            $base = [IO.Path]::GetFileName($old)
            $new  = Join-Path $folder ($filePrefix + $base)
            if (Test-Path $new) {
                $desc.ReferencedFileDescriptor.Path = $new
            }
        }
        $draw.Update(); $draw.Save(); $draw.Close()
    }
}
RelinkDrawings -folder $destDir -filePrefix $prefix

# 6) open result folder
Start-Process explorer.exe -ArgumentList $destDir

# 7) full-session ReplaceReference relink (suppress pop-ups & iLogic)
Write-Host "Preparing full-session relink with iLogic/events off…" -ForegroundColor Cyan

# attach to running Inventor
$inv = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")

# allow alerts, but run silently
try { $inv.DisplayAlerts  = $true  } catch {}
try { $inv.SilentOperation = $true  } catch {}

# disable VB iLogic automation mode
try {
    $iLogicVB = $inv.ApplicationAddIns.ItemById('{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}')
    if (-not $iLogicVB.Activated) { $iLogicVB.Activate() }
    $iLogicVB.Automation.RulesEnabled           = $false
    $iLogicVB.Automation.RulesOnEventsEnabled   = $false
    $iLogicVB.Automation.SilentOperation        = $true
    $iLogicVB.Automation.CallingFromOutside     = $true
    Write-Host "iLogic VB automation mode ON."
}
catch { Write-Warning "VB iLogic disable failed: $($_.Exception.Message)" }

# build source->dest map
$map = @{}
$allDocs = New-Object System.Collections.Generic.List[Object]
$queue   = New-Object System.Collections.Generic.Queue[Object]
$queue.Enqueue($asm)
while ($queue.Count -gt 0) {
    $d = $queue.Dequeue()
    if (-not ($allDocs -contains $d)) {
        $allDocs.Add($d)
        foreach ($child in $d.AllReferencedDocuments) {
            if ($child.FullFileName) { $queue.Enqueue($child) }
        }
    }
}
foreach ($doc in $allDocs) {
    if ($doc.FullFileName) {
        $map[$doc.FullFileName.ToLower()] = Join-Path $destDir ($prefix + [IO.Path]::GetFileName($doc.FullFileName))
    }
}
foreach ($file in Get-ChildItem -Path $destDir -Filter "$prefix*.idw" -File) {
    $orig = $file.Name.Substring($prefix.Length)
    $map[(Join-Path (Split-Path $asmPath -Parent) $orig).ToLower()] = $file.FullName
}

# ReplaceReference relink loop
Get-ChildItem -Path $destDir -Filter "$prefix*.idw" -Recurse -File | ForEach-Object {
    Write-Host "  • $($_.Name)"
    $dw = $inv.Documents.Open($_.FullName, $false)
    foreach ($r in $dw.ReferencedFileDescriptors) {
        $k = $r.FullFileName.ToLower()
        if ($map.ContainsKey($k)) {
            $r.DocumentDescriptor.ReferencedFileDescriptor.ReplaceReference($map[$k])
        }
    }
    $dw.Update(); $dw.Save2(); $dw.Close($true)
}

# 8) update Part Number iProperties
Write-Host "Updating Part Number iProperties…" -ForegroundColor Cyan
$inv2 = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")
Get-ChildItem -Path $destDir -Filter "$prefix*" -File | ForEach-Object {
    Write-Host "  • $($_.Name)"
    $doc2 = $inv2.Documents.Open($_.FullName, $false)
    try {
        $ps = $doc2.PropertySets.Item("Design Tracking Properties")
        $ps.Item("Part Number").Value = [IO.Path]::GetFileNameWithoutExtension($_.Name)
        $doc2.Update(); $doc2.Save2()
    }
    catch {
        Write-Warning "  ! Part Number failed on $($_.Name): $($_.Exception.Message)"
    }
    finally {
        $doc2.Close($true)
    }
}
Write-Host "Part Number update complete." -ForegroundColor Green
```

#### Code Block 3

```vb
# --------------------------------------------------------------------------------
# CopyDesign Script
#
# DESCRIPTION
#   Copies an Inventor assembly (.iam), its referenced parts (.ipt/.iam), and
#   drawing files (.idw/.dwg/.ipn) into a new folder, renames them with a user-
#   specified prefix, relinks all references, suppresses iLogic rule execution,
#   and updates the Part Number iProperty on each copied file.
#
# NAMING CONVENTION REQUIRED
#   • Model files (.iam, .ipt):
#       – Base name must start with '0' and end with '-<digits>' 
#         e.g. 0001-1.ipt, 0001-501.iam
#       – OR base name must start with one of your custom prefixes 
#         (e.g. WIP_, WIP2_)
#   • Drawing files (.idw):
#       – Base name must start with '0' and end with a digit 
#         e.g. 0001.idw
#       – OR start with one of your custom prefixes
#   • Other drawing types (.dwg, .ipn) are always copied regardless of name.
#   • Enter any extra prefixes when prompted; leave blank to skip.
#
# NOTE
#   Inventor must be running. The script attaches to the existing session.
# --------------------------------------------------------------------------------

$ErrorActionPreference = 'Stop'

#
# ←—— USER INPUT Prompts ————————————————————————————————————————
#

# Prompt for the folder containing the top-level assembly
$asmDir = Read-Host 'Enter the directory containing the top-level assembly'
if (-not (Test-Path $asmDir)) {
    Write-Error "Directory not found: $asmDir"
    exit 1
}

# Prompt for the assembly filename (with or without .iam)
$inputName = Read-Host 'Enter the top-level assembly filename (with or without .iam extension)'
if ($inputName -match '\.iam$') {
    $asmName = $inputName
} else {
    $asmName = "$inputName.iam"
}

# Build the full assembly path
$asmPath = Join-Path $asmDir $asmName
if (-not (Test-Path $asmPath)) {
    Write-Error "Assembly not found: $asmPath"
    exit 1
}

# Prompt for the destination folder
$destDir = Read-Host 'Enter the destination directory for copied files'
if (-not (Test-Path $destDir)) {
    New-Item -ItemType Directory -Path $destDir | Out-Null
}

# Prompt for the filename prefix
$prefix = Read-Host 'Enter the prefix to prepend to copied filenames (e.g. Copy_)'
if (-not $prefix) {
    Write-Error "Prefix cannot be empty."
    exit 1
}

#
# ←—— Existing logic below unchanged, using $asmPath, $destDir, $prefix ——————————————————
#

# Prompt for any existing filename prefixes (e.g. WIP_, WIP2_) that should be allowed
# even if they don’t follow the “0…-digit” naming rule
$custom = Read-Host 'Enter any any existing filename prefixes if they do not follow the naming rule, to include in the copy, (comma-separated for different ones), or press Enter to skip'
if ($custom) { $extraPrefixes = $custom -split ',' | ForEach-Object { $_.Trim() } } else { $extraPrefixes = @() }

# ApprenticeServer for CAD-only copy
$appr = New-Object -ComObject Inventor.ApprenticeServer
$asm  = $appr.Open($asmPath)
$save = $appr.FileSaveAs

function Pref([string]$path) {
    $prefix + ([IO.Path]::GetFileName($path))
}

# 1) queue the main assembly
$save.AddFileToSave(
    $asm,
    (Join-Path $destDir (Pref $asmPath))
)

# 2) queue filtered parts & sub-assemblies
foreach ($doc in $asm.AllReferencedDocuments) {
    if ($doc.NeedsMigrating) { continue }

    $fileName = [IO.Path]::GetFileName($doc.FullFileName)
    $baseName = [IO.Path]::GetFileNameWithoutExtension($fileName)
    $ext      = [IO.Path]::GetExtension($fileName).ToLowerInvariant()

    $matchesPattern = $baseName -match '^0.*-\d+$'
    $matchesExtra   = $false
    foreach ($p in $extraPrefixes) {
        if ($p -and $baseName.StartsWith($p)) { $matchesExtra = $true; break }
    }

    if (($ext -in '.iam','.ipt') -and ($matchesPattern -or $matchesExtra)) {
        $out    = Join-Path $destDir (Pref $doc.FullFileName)
        $outDir = Split-Path $out
        if (-not (Test-Path $outDir)) {
            New-Item -ItemType Directory -Path $outDir -Force | Out-Null
        }
        $save.AddFileToSave(
            $doc,
            $out
        )
    }
    else {
        Write-Host "Skipping $fileName (naming filter)" -ForegroundColor DarkYellow
    }
}

# 3) perform CAD copy
$save.ExecuteSaveCopyAs()

# 4) copy drawings from disk, filtered
$exts = '.idw','.dwg','.ipn'
function CopyDrawings($folder) {
    foreach ($e in $exts) {
        Get-ChildItem -Path $folder -Filter "*$e" -File -ErrorAction SilentlyContinue |
        Where-Object {
            if ($_.Extension -ieq '.idw') {
                $b = $_.BaseName
                $okPattern = $b -match '^0.*\d$'
                $okExtra   = $false
                foreach ($p in $extraPrefixes) {
                    if ($p -and $b.StartsWith($p)) { $okExtra = $true; break }
                }
                $okPattern -or $okExtra
            }
            else { $true }
        } |
        ForEach-Object {
            Copy-Item $_.FullName (Join-Path $destDir ($prefix + $_.Name)) -Force
        }
    }
}
CopyDrawings (Split-Path $asmPath -Parent)
foreach ($doc in @($asm) + $asm.AllReferencedDocuments) {
    CopyDrawings (Split-Path $doc.FullFileName -Parent)
}

# 4.5) remove Read-Only attribute
Get-ChildItem -Path $destDir -Recurse -File |
    Where-Object { $_.Extension -in '.iam','.ipt','.idw' } |
    ForEach-Object {
        if ($_.IsReadOnly) {
            $_.IsReadOnly = $false
            Write-Host "Removed ReadOnly: $($_.FullName)"
        }
    }

# 5) first relink pass via ApprenticeServer
function RelinkDrawings {
    param($folder, $filePrefix)
    $invApp = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")
    Get-ChildItem -Path $folder -Include '*.idw','*.dwg' -File | ForEach-Object {
        $draw = $invApp.Documents.Open($_.FullName, $true)
        foreach ($desc in $draw.ReferencedDocumentDescriptors) {
            $old  = $desc.ReferencedFileDescriptor.FullFileName
            $base = [IO.Path]::GetFileName($old)
            $new  = Join-Path $folder ($filePrefix + $base)
            if (Test-Path $new) {
                $desc.ReferencedFileDescriptor.Path = $new
            }
        }
        $draw.Update(); $draw.Save(); $draw.Close()
    }
}
RelinkDrawings -folder $destDir -filePrefix $prefix

# 6) open result folder
Start-Process explorer.exe -ArgumentList $destDir

# 7) full-session ReplaceReference relink (suppress pop-ups & iLogic)
Write-Host "Preparing full-session relink with iLogic/events off…" -ForegroundColor Cyan

# attach to running Inventor
$inv = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")

# allow alerts, but run silently
try { $inv.DisplayAlerts  = $true  } catch {}
try { $inv.SilentOperation = $true  } catch {}

# disable VB iLogic automation mode
try {
    $iLogicVB = $inv.ApplicationAddIns.ItemById('{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}')
    if (-not $iLogicVB.Activated) { $iLogicVB.Activate() }
    $iLogicVB.Automation.RulesEnabled           = $false
    $iLogicVB.Automation.RulesOnEventsEnabled   = $false
    $iLogicVB.Automation.SilentOperation        = $true
    $iLogicVB.Automation.CallingFromOutside     = $true
    Write-Host "iLogic VB automation mode ON."
}
catch { Write-Warning "VB iLogic disable failed: $($_.Exception.Message)" }

# build source->dest map
$map = @{}
$allDocs = New-Object System.Collections.Generic.List[Object]
$queue   = New-Object System.Collections.Generic.Queue[Object]
$queue.Enqueue($asm)
while ($queue.Count -gt 0) {
    $d = $queue.Dequeue()
    if (-not ($allDocs -contains $d)) {
        $allDocs.Add($d)
        foreach ($child in $d.AllReferencedDocuments) {
            if ($child.FullFileName) { $queue.Enqueue($child) }
        }
    }
}
foreach ($doc in $allDocs) {
    if ($doc.FullFileName) {
        $map[$doc.FullFileName.ToLower()] = Join-Path $destDir ($prefix + [IO.Path]::GetFileName($doc.FullFileName))
    }
}
foreach ($file in Get-ChildItem -Path $destDir -Filter "$prefix*.idw" -File) {
    $orig = $file.Name.Substring($prefix.Length)
    $map[(Join-Path (Split-Path $asmPath -Parent) $orig).ToLower()] = $file.FullName
}

# ReplaceReference relink loop
Get-ChildItem -Path $destDir -Filter "$prefix*.idw" -Recurse -File | ForEach-Object {
    Write-Host "  • $($_.Name)"
    $dw = $inv.Documents.Open($_.FullName, $false)
    foreach ($r in $dw.ReferencedFileDescriptors) {
        $k = $r.FullFileName.ToLower()
        if ($map.ContainsKey($k)) {
            $r.DocumentDescriptor.ReferencedFileDescriptor.ReplaceReference($map[$k])
        }
    }
    $dw.Update(); $dw.Save2(); $dw.Close($true)
}

# 8) update Part Number iProperties
Write-Host "Updating Part Number iProperties…" -ForegroundColor Cyan
$inv2 = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")
Get-ChildItem -Path $destDir -Filter "$prefix*" -File | ForEach-Object {
    Write-Host "  • $($_.Name)"
    $doc2 = $inv2.Documents.Open($_.FullName, $false)
    try {
        $ps = $doc2.PropertySets.Item("Design Tracking Properties")
        $ps.Item("Part Number").Value = [IO.Path]::GetFileNameWithoutExtension($_.Name)
        $doc2.Update(); $doc2.Save2()
    }
    catch {
        Write-Warning "  ! Part Number failed on $($_.Name): $($_.Exception.Message)"
    }
    finally {
        $doc2.Close($true)
    }
}
Write-Host "Part Number update complete." -ForegroundColor Green
```

#### Code Block 4

```vb
# --------------------------------------------------------------------------------
# CopyDesign Script
#
# DESCRIPTION
#   Copies an Inventor assembly (.iam), its referenced parts (.ipt/.iam), and
#   drawing files (.idw/.dwg/.ipn) into a new folder, renames them with a user-
#   specified prefix, relinks all references, suppresses iLogic rule execution,
#   and updates the Part Number iProperty on each copied file.
#
# NAMING CONVENTION REQUIRED
#   • Model files (.iam, .ipt):
#       – Base name must start with '0' and end with '-<digits>' 
#         e.g. 0001-1.ipt, 0001-501.iam
#       – OR base name must start with one of your custom prefixes 
#         (e.g. WIP_, WIP2_)
#   • Drawing files (.idw):
#       – Base name must start with '0' and end with a digit 
#         e.g. 0001.idw
#       – OR start with one of your custom prefixes
#   • Other drawing types (.dwg, .ipn) are always copied regardless of name.
#   • Enter any extra prefixes when prompted; leave blank to skip.
#
# NOTE
#   Inventor must be running. The script attaches to the existing session.
# --------------------------------------------------------------------------------

$ErrorActionPreference = 'Stop'

#
# ←—— USER INPUT Prompts ————————————————————————————————————————
#

# Prompt for the folder containing the top-level assembly
$asmDir = Read-Host 'Enter the directory containing the top-level assembly'
if (-not (Test-Path $asmDir)) {
    Write-Error "Directory not found: $asmDir"
    exit 1
}

# Prompt for the assembly filename (with or without .iam)
$inputName = Read-Host 'Enter the top-level assembly filename (with or without .iam extension)'
if ($inputName -match '\.iam$') {
    $asmName = $inputName
} else {
    $asmName = "$inputName.iam"
}

# Build the full assembly path
$asmPath = Join-Path $asmDir $asmName
if (-not (Test-Path $asmPath)) {
    Write-Error "Assembly not found: $asmPath"
    exit 1
}

# Prompt for the destination folder
$destDir = Read-Host 'Enter the destination directory for copied files'
if (-not (Test-Path $destDir)) {
    New-Item -ItemType Directory -Path $destDir | Out-Null
}

# Prompt for the filename prefix
$prefix = Read-Host 'Enter the prefix to prepend to copied filenames (e.g. Copy_)'
if (-not $prefix) {
    Write-Error "Prefix cannot be empty."
    exit 1
}

#
# ←—— Existing logic below unchanged, using $asmPath, $destDir, $prefix ——————————————————
#

# Prompt for any existing filename prefixes (e.g. WIP_, WIP2_) that should be allowed
# even if they don’t follow the “0…-digit” naming rule
$custom = Read-Host 'Enter any any existing filename prefixes if they do not follow the naming rule, to include in the copy, (comma-separated for different ones), or press Enter to skip'
if ($custom) { $extraPrefixes = $custom -split ',' | ForEach-Object { $_.Trim() } } else { $extraPrefixes = @() }

# ApprenticeServer for CAD-only copy
$appr = New-Object -ComObject Inventor.ApprenticeServer
$asm  = $appr.Open($asmPath)
$save = $appr.FileSaveAs

function Pref([string]$path) {
    $prefix + ([IO.Path]::GetFileName($path))
}

# 1) queue the main assembly
$save.AddFileToSave(
    $asm,
    (Join-Path $destDir (Pref $asmPath))
)

# 2) queue filtered parts & sub-assemblies
foreach ($doc in $asm.AllReferencedDocuments) {
    if ($doc.NeedsMigrating) { continue }

    $fileName = [IO.Path]::GetFileName($doc.FullFileName)
    $baseName = [IO.Path]::GetFileNameWithoutExtension($fileName)
    $ext      = [IO.Path]::GetExtension($fileName).ToLowerInvariant()

    $matchesPattern = $baseName -match '^0.*-\d+$'
    $matchesExtra   = $false
    foreach ($p in $extraPrefixes) {
        if ($p -and $baseName.StartsWith($p)) { $matchesExtra = $true; break }
    }

    if (($ext -in '.iam','.ipt') -and ($matchesPattern -or $matchesExtra)) {
        $out    = Join-Path $destDir (Pref $doc.FullFileName)
        $outDir = Split-Path $out
        if (-not (Test-Path $outDir)) {
            New-Item -ItemType Directory -Path $outDir -Force | Out-Null
        }
        $save.AddFileToSave(
            $doc,
            $out
        )
    }
    else {
        Write-Host "Skipping $fileName (naming filter)" -ForegroundColor DarkYellow
    }
}

# 3) perform CAD copy
$save.ExecuteSaveCopyAs()

# 4) copy drawings from disk, filtered
$exts = '.idw','.dwg','.ipn'
function CopyDrawings($folder) {
    foreach ($e in $exts) {
        Get-ChildItem -Path $folder -Filter "*$e" -File -ErrorAction SilentlyContinue |
        Where-Object {
            if ($_.Extension -ieq '.idw') {
                $b = $_.BaseName
                $okPattern = $b -match '^0.*\d$'
                $okExtra   = $false
                foreach ($p in $extraPrefixes) {
                    if ($p -and $b.StartsWith($p)) { $okExtra = $true; break }
                }
                $okPattern -or $okExtra
            }
            else { $true }
        } |
        ForEach-Object {
            Copy-Item $_.FullName (Join-Path $destDir ($prefix + $_.Name)) -Force
        }
    }
}
CopyDrawings (Split-Path $asmPath -Parent)
foreach ($doc in @($asm) + $asm.AllReferencedDocuments) {
    CopyDrawings (Split-Path $doc.FullFileName -Parent)
}

# 4.5) remove Read-Only attribute
Get-ChildItem -Path $destDir -Recurse -File |
    Where-Object { $_.Extension -in '.iam','.ipt','.idw' } |
    ForEach-Object {
        if ($_.IsReadOnly) {
            $_.IsReadOnly = $false
            Write-Host "Removed ReadOnly: $($_.FullName)"
        }
    }

# 5) first relink pass via ApprenticeServer
function RelinkDrawings {
    param($folder, $filePrefix)
    $invApp = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")
    Get-ChildItem -Path $folder -Include '*.idw','*.dwg' -File | ForEach-Object {
        $draw = $invApp.Documents.Open($_.FullName, $true)
        foreach ($desc in $draw.ReferencedDocumentDescriptors) {
            $old  = $desc.ReferencedFileDescriptor.FullFileName
            $base = [IO.Path]::GetFileName($old)
            $new  = Join-Path $folder ($filePrefix + $base)
            if (Test-Path $new) {
                $desc.ReferencedFileDescriptor.Path = $new
            }
        }
        $draw.Update(); $draw.Save(); $draw.Close()
    }
}
RelinkDrawings -folder $destDir -filePrefix $prefix

# 6) open result folder
Start-Process explorer.exe -ArgumentList $destDir

# 7) full-session ReplaceReference relink (suppress pop-ups & iLogic)
Write-Host "Preparing full-session relink with iLogic/events off…" -ForegroundColor Cyan

# attach to running Inventor
$inv = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")

# allow alerts, but run silently
try { $inv.DisplayAlerts  = $true  } catch {}
try { $inv.SilentOperation = $true  } catch {}

# disable VB iLogic automation mode
try {
    $iLogicVB = $inv.ApplicationAddIns.ItemById('{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}')
    if (-not $iLogicVB.Activated) { $iLogicVB.Activate() }
    $iLogicVB.Automation.RulesEnabled           = $false
    $iLogicVB.Automation.RulesOnEventsEnabled   = $false
    $iLogicVB.Automation.SilentOperation        = $true
    $iLogicVB.Automation.CallingFromOutside     = $true
    Write-Host "iLogic VB automation mode ON."
}
catch { Write-Warning "VB iLogic disable failed: $($_.Exception.Message)" }

# build source->dest map
$map = @{}
$allDocs = New-Object System.Collections.Generic.List[Object]
$queue   = New-Object System.Collections.Generic.Queue[Object]
$queue.Enqueue($asm)
while ($queue.Count -gt 0) {
    $d = $queue.Dequeue()
    if (-not ($allDocs -contains $d)) {
        $allDocs.Add($d)
        foreach ($child in $d.AllReferencedDocuments) {
            if ($child.FullFileName) { $queue.Enqueue($child) }
        }
    }
}
foreach ($doc in $allDocs) {
    if ($doc.FullFileName) {
        $map[$doc.FullFileName.ToLower()] = Join-Path $destDir ($prefix + [IO.Path]::GetFileName($doc.FullFileName))
    }
}
foreach ($file in Get-ChildItem -Path $destDir -Filter "$prefix*.idw" -File) {
    $orig = $file.Name.Substring($prefix.Length)
    $map[(Join-Path (Split-Path $asmPath -Parent) $orig).ToLower()] = $file.FullName
}

# ReplaceReference relink loop
Get-ChildItem -Path $destDir -Filter "$prefix*.idw" -Recurse -File | ForEach-Object {
    Write-Host "  • $($_.Name)"
    $dw = $inv.Documents.Open($_.FullName, $false)
    foreach ($r in $dw.ReferencedFileDescriptors) {
        $k = $r.FullFileName.ToLower()
        if ($map.ContainsKey($k)) {
            $r.DocumentDescriptor.ReferencedFileDescriptor.ReplaceReference($map[$k])
        }
    }
    $dw.Update(); $dw.Save2(); $dw.Close($true)
}

# 8) update Part Number iProperties
Write-Host "Updating Part Number iProperties…" -ForegroundColor Cyan
$inv2 = [Runtime.InteropServices.Marshal]::GetActiveObject("Inventor.Application")
Get-ChildItem -Path $destDir -Filter "$prefix*" -File | ForEach-Object {
    Write-Host "  • $($_.Name)"
    $doc2 = $inv2.Documents.Open($_.FullName, $false)
    try {
        $ps = $doc2.PropertySets.Item("Design Tracking Properties")
        $ps.Item("Part Number").Value = [IO.Path]::GetFileNameWithoutExtension($_.Name)
        $doc2.Update(); $doc2.Save2()
    }
    catch {
        Write-Warning "  ! Part Number failed on $($_.Name): $($_.Exception.Message)"
    }
    finally {
        $doc2.Close($true)
    }
}
Write-Host "Part Number update complete." -ForegroundColor Green
```

#### Code Block 5

```vb
AddReference "System.IO"
AddReference "System.Windows.Forms"
AddReference "System.Drawing"
Imports Inventor
Imports IO = System.IO
Imports WF = System.Windows.Forms
Imports SD = System.Drawing
Imports System.Text
Imports System.Diagnostics

Public Class CopyDesignRule

  Public Sub Main()
    ' 1) Source assembly path from the active document
    Dim asmPath As String = ThisDoc.ModelDocument.FullFileName
    If String.IsNullOrEmpty(asmPath) OrElse Not IO.File.Exists(asmPath) Then
      WF.MessageBox.Show("Active document path not found or file does not exist.", _
                         "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Error)
      Exit Sub
    End If

    ' 2) Build the form
    Dim frm As New WF.Form With {
      .Text            = "Copy Design (PowerShell)",
      .AutoScaleMode   = WF.AutoScaleMode.Dpi,
      .Size            = New SD.Size(760, 340),
      .Font            = New SD.Font("Segoe UI", 10.0!),
      .StartPosition   = WF.FormStartPosition.CenterScreen,
      .FormBorderStyle = WF.FormBorderStyle.FixedDialog,
      .MaximizeBox     = False,
      .MinimizeBox     = False
    }
    AddHandler frm.KeyDown, Sub(s, E) If E.KeyCode = WF.Keys.Escape Then frm.Close()

    Dim y As Integer = 18
    Dim gap As Integer = 40

    ' — Source (readonly)
    frm.Controls.Add(New WF.Label With {.Text = "Source assembly:", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbSrc As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 530, .Text = asmPath, .ReadOnly = True}
    frm.Controls.Add(tbSrc)
    y += gap

    ' — New sub-folder name
    frm.Controls.Add(New WF.Label With {.Text = "New folder name:", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbFolder As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 300, .Text = "CopyDesign"}
    frm.Controls.Add(tbFolder)
    y += gap

    ' — Destination root (optional)
    frm.Controls.Add(New WF.Label With {.Text = "Destination root (optional):", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbRoot As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 530, .Text = ""}
    frm.Controls.Add(tbRoot)
    y += gap

    ' — Copy prefix
    frm.Controls.Add(New WF.Label With {.Text = "Copy prefix (e.g. Copy_):", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbPrefix As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 180, .Text = "Copy_"}
    frm.Controls.Add(tbPrefix)
    y += gap

    ' — Existing prefixes to allow (comma-separated)
    frm.Controls.Add(New WF.Label With {
        .Text = "Existing prefixes to allow (comma-separated, e.g. WIP_,WIP2_):",
        .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbExtra As New WF.TextBox With {.Location = New SD.Point(15, y + 22), .Width = 695, .Text = ""}
    frm.Controls.Add(tbExtra)
    y += 70

    ' — Buttons
    Dim btnStart As New WF.Button With {.Text = "Start", .Location = New SD.Point(520, y), .Width = 90, .DialogResult = WF.DialogResult.OK}
    Dim btnClose As New WF.Button With {.Text = "Close", .Location = New SD.Point(620, y), .Width = 90, .DialogResult = WF.DialogResult.Cancel}
    frm.Controls.AddRange({btnStart, btnClose})
    frm.AcceptButton = btnStart
    frm.CancelButton = btnClose

    If frm.ShowDialog() <> WF.DialogResult.OK Then Exit Sub

    ' 3) Validate inputs and compute destination folder
    Dim baseFolder As String = IO.Path.GetDirectoryName(asmPath)
    Dim newFolder  As String = tbFolder.Text.Trim()
    If newFolder = "" Then
      WF.MessageBox.Show("You must enter a folder name.", "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Warning)
      Exit Sub
    End If

    Dim rootPath As String = tbRoot.Text.Trim()
    Dim destDir As String
    If rootPath = "" Then
      ' default: new sub-folder next to the source assembly
      destDir = IO.Path.Combine(baseFolder, newFolder)
    Else
      ' user-supplied root path
      destDir = IO.Path.Combine(rootPath, newFolder)
    End If

    Dim prefix As String = tbPrefix.Text.Trim()
    If prefix = "" Then prefix = "Copy_"

    Dim extraText As String = tbExtra.Text.Trim()
    Dim extraList As New List(Of String)
    If extraText <> "" Then
      For Each tok In extraText.Split(","c)
        Dim p = tok.Trim()
        If p <> "" Then extraList.Add(p)
      Next
    End If

    ' 4) Generate and run the latest PowerShell script
    GenerateAndRunPS(asmPath, destDir, prefix, extraList)
  End Sub



  Private Sub GenerateAndRunPS(asmPath As String, destDir As String, prefix As String, extraPrefixes As List(Of String))
    ' Build PowerShell array literal for extra prefixes, with safe quoting
    Dim psExtra As String
    If extraPrefixes IsNot Nothing AndAlso extraPrefixes.Count > 0 Then
      Dim esc = extraPrefixes.Select(Function(s) s.Replace("'", "''"))
      psExtra = "@('" & String.Join("','", esc) & "')"
    Else
      psExtra = "@()"
    End If

    ' Create temp .ps1
    Dim psFile As String = IO.Path.Combine(IO.Path.GetTempPath(), "CopyDesign_" & Guid.NewGuid().ToString("N") & ".ps1")
    Dim sb As New StringBuilder()

    ' NOTE: This is the latest baseline logic (no Read-Host; uses values from the form)
    With sb
      .AppendLine("$ErrorActionPreference = 'Stop'")
      .AppendLine("")
      .AppendLine("# Inputs from iLogic")
      .AppendLine("$asmPath  = '" & asmPath.Replace("'", "''") & "'")
      .AppendLine("$destDir  = '" & destDir.Replace("'", "''") & "'")
      .AppendLine("$prefix   = '" & prefix.Replace("'", "''") & "'")
      .AppendLine("$extraPrefixes = " & psExtra)
      .AppendLine("")
      .AppendLine("# ensure output folder exists")
      .AppendLine("if (-not (Test-Path $destDir)) { New-Item -ItemType Directory -Path $destDir | Out-Null }")
      .AppendLine("")
      .AppendLine("# ApprenticeServer for CAD-only copy")
      .AppendLine("$appr = New-Object -ComObject Inventor.ApprenticeServer")
      .AppendLine("$asm  = $appr.Open($asmPath)")
      .AppendLine("$save = $appr.FileSaveAs")
      .AppendLine("")
      .AppendLine("function Pref([string]$path) { $prefix + ([IO.Path]::GetFileName($path)) }")
      .AppendLine("")
      .AppendLine("# 1) queue the main assembly")
      .AppendLine("$save.AddFileToSave($asm, (Join-Path $destDir (Pref $asmPath)))")
      .AppendLine("")
      .AppendLine("# 2) queue parts & sub-assemblies, filtered")
      .AppendLine("foreach ($doc in $asm.AllReferencedDocuments) {")
      .AppendLine("  if ($doc.NeedsMigrating) { continue }")
      .AppendLine("  $fileName = [IO.Path]::GetFileName($doc.FullFileName)")
      .AppendLine("  $baseName = [IO.Path]::GetFileNameWithoutExtension($fileName)")
      .AppendLine("  $ext      = [IO.Path]::GetExtension($fileName).ToLowerInvariant()")
      .AppendLine("  $matchesPattern = $baseName -match '^0.*-\d+$'")
      .AppendLine("  $matchesExtra   = $false")
      .AppendLine("  foreach ($p in $extraPrefixes) { if ($p -and $baseName.StartsWith($p)) { $matchesExtra = $true; break } }")
      .AppendLine("  if (($ext -in '.iam','.ipt') -and ($matchesPattern -or $matchesExtra)) {")
      .AppendLine("    $out    = Join-Path $destDir (Pref $doc.FullFileName)")
      .AppendLine("    $outDir = Split-Path $out")
      .AppendLine("    if (-not (Test-Path $outDir)) { New-Item -ItemType Directory -Path $outDir -Force | Out-Null }")
      .AppendLine("    $save.AddFileToSave($doc, $out)")
      .AppendLine("  } else {")
      .AppendLine("    Write-Host ('Skipping ' + $fileName + ' (naming filter)') -ForegroundColor DarkYellow")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 3) perform CAD copy")
      .AppendLine("$save.ExecuteSaveCopyAs()")
      .AppendLine("")
      .AppendLine("# 4) copy drawings from disk, filtered")
      .AppendLine("$exts = '.idw','.dwg','.ipn'")
      .AppendLine("function CopyDrawings($folder) {")
      .AppendLine("  foreach ($e in $exts) {")
      .AppendLine("    Get-ChildItem -Path $folder -Filter ""*$e"" -File -ErrorAction SilentlyContinue |")
      .AppendLine("    Where-Object {")
      .AppendLine("      if ($_.Extension -ieq '.idw') {")
      .AppendLine("        $b = $_.BaseName")
      .AppendLine("        $okPattern = $b -match '^0.*\d$'")
      .AppendLine("        $okExtra   = $false")
      .AppendLine("        foreach ($p in $extraPrefixes) { if ($p -and $b.StartsWith($p)) { $okExtra = $true; break } }")
      .AppendLine("        $okPattern -or $okExtra")
      .AppendLine("      } else { $true }")
      .AppendLine("    } |")
      .AppendLine("    ForEach-Object { Copy-Item $_.FullName (Join-Path $destDir ($prefix + $_.Name)) -Force }")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("CopyDrawings (Split-Path $asmPath -Parent)")
      .AppendLine("foreach ($doc in @($asm) + $asm.AllReferencedDocuments) { CopyDrawings (Split-Path $doc.FullFileName -Parent) }")
      .AppendLine("")
      .AppendLine("# 4.5) remove Read-Only attribute")
      .AppendLine("Get-ChildItem -Path $destDir -Recurse -File | Where-Object { $_.Extension -in '.iam','.ipt','.idw' } | ForEach-Object {")
      .AppendLine("  if ($_.IsReadOnly) { $_.IsReadOnly = $false; Write-Host ('Removed ReadOnly: ' + $_.FullName) }")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 5) first relink pass via Inventor.Application (.Path)")
      .AppendLine("function RelinkDrawings {")
      .AppendLine("  param($folder, $filePrefix)")
      .AppendLine("  $invApp = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("  Get-ChildItem -Path $folder -Include '*.idw','*.dwg' -File | ForEach-Object {")
      .AppendLine("    $draw = $invApp.Documents.Open($_.FullName, $true)")
      .AppendLine("    foreach ($desc in $draw.ReferencedDocumentDescriptors) {")
      .AppendLine("      $old  = $desc.ReferencedFileDescriptor.FullFileName")
      .AppendLine("      $base = [IO.Path]::GetFileName($old)")
      .AppendLine("      $new  = Join-Path $folder ($filePrefix + $base)")
      .AppendLine("      if (Test-Path $new) { $desc.ReferencedFileDescriptor.Path = $new }")
      .AppendLine("    }")
      .AppendLine("    $draw.Update(); $draw.Save(); $draw.Close()")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("RelinkDrawings -folder $destDir -filePrefix $prefix")
      .AppendLine("")
      .AppendLine("# 6) open result folder")
      .AppendLine("Start-Process explorer.exe -ArgumentList $destDir")
      .AppendLine("")
      .AppendLine("# 7) full-session ReplaceReference relink with iLogic suppression")
      .AppendLine("Write-Host 'Preparing full-session relink with iLogic/events off…' -ForegroundColor Cyan")
      .AppendLine("$inv = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("try { $inv.DisplayAlerts = $true } catch {}")
      .AppendLine("try { $inv.SilentOperation = $true } catch {}")
      .AppendLine("")
      .AppendLine("try {")
      .AppendLine("  $iLogicVB = $inv.ApplicationAddIns.ItemById('{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}')")
      .AppendLine("  if (-not $iLogicVB.Activated) { $iLogicVB.Activate() }")
      .AppendLine("  $iLogicVB.Automation.RulesEnabled           = $false")
      .AppendLine("  $iLogicVB.Automation.RulesOnEventsEnabled   = $false")
      .AppendLine("  $iLogicVB.Automation.SilentOperation        = $true")
      .AppendLine("  $iLogicVB.Automation.CallingFromOutside     = $true")
      .AppendLine("  Write-Host 'iLogic VB automation mode ON.'")
      .AppendLine("} catch { Write-Warning ('VB iLogic disable failed: ' + $_.Exception.Message) }")
      .AppendLine("")
      .AppendLine("# build source->dest map")
      .AppendLine("$map = @{}")
      .AppendLine("$allDocs = New-Object System.Collections.Generic.List[Object]")
      .AppendLine("$queue   = New-Object System.Collections.Generic.Queue[Object]")
      .AppendLine("$queue.Enqueue($asm)")
      .AppendLine("while ($queue.Count -gt 0) {")
      .AppendLine("  $d = $queue.Dequeue()")
      .AppendLine("  if (-not ($allDocs -contains $d)) {")
      .AppendLine("    $allDocs.Add($d)")
      .AppendLine("    foreach ($child in $d.AllReferencedDocuments) { if ($child.FullFileName) { $queue.Enqueue($child) } }")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("foreach ($doc in $allDocs) {")
      .AppendLine("  if ($doc.FullFileName) { $map[$doc.FullFileName.ToLower()] = Join-Path $destDir ($prefix + [IO.Path]::GetFileName($doc.FullFileName)) }")
      .AppendLine("}")
      .AppendLine("foreach ($file in Get-ChildItem -Path $destDir -Filter ""$prefix*.idw"" -File) {")
      .AppendLine("  $orig = $file.Name.Substring($prefix.Length)")
      .AppendLine("  $map[(Join-Path (Split-Path $asmPath -Parent) $orig).ToLower()] = $file.FullName")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("Get-ChildItem -Path $destDir -Filter ""$prefix*.idw"" -Recurse -File | ForEach-Object {")
      .AppendLine("  Write-Host ('  • ' + $_.Name)")
      .AppendLine("  $dw = $inv.Documents.Open($_.FullName, $false)")
      .AppendLine("  foreach ($r in $dw.ReferencedFileDescriptors) {")
      .AppendLine("    $k = $r.FullFileName.ToLower()")
      .AppendLine("    if ($map.ContainsKey($k)) { $r.DocumentDescriptor.ReferencedFileDescriptor.ReplaceReference($map[$k]) }")
      .AppendLine("  }")
      .AppendLine("  $dw.Update(); $dw.Save2(); $dw.Close($true)")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 8) update Part Number iProperties")
      .AppendLine("Write-Host 'Updating Part Number iProperties…' -ForegroundColor Cyan")
      .AppendLine("$inv2 = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("Get-ChildItem -Path $destDir -Filter ""$prefix*"" -File | ForEach-Object {")
      .AppendLine("  Write-Host ('  • ' + $_.Name)")
      .AppendLine("  $doc2 = $inv2.Documents.Open($_.FullName, $false)")
      .AppendLine("  try {")
      .AppendLine("    $ps = $doc2.PropertySets.Item('Design Tracking Properties')")
      .AppendLine("    $ps.Item('Part Number').Value = [IO.Path]::GetFileNameWithoutExtension($_.Name)")
      .AppendLine("    $doc2.Update(); $doc2.Save2()")
      .AppendLine("  } catch {")
      .AppendLine("    Write-Warning ('  ! Part Number failed on ' + $_.Name + ': ' + $_.Exception.Message)")
      .AppendLine("  } finally { $doc2.Close($true) }")
      .AppendLine("}")
      .AppendLine("Write-Host 'Part Number update complete.' -ForegroundColor Green")
    End With

    IO.File.WriteAllText(psFile, sb.ToString())

    ' Launch PowerShell so progress/errors are visible
    Dim psi As New ProcessStartInfo() With {
      .FileName        = "powershell.exe",
      .Arguments       = "-NoProfile -ExecutionPolicy Bypass -File """ & psFile & """",
      .UseShellExecute = True,
      .WindowStyle     = ProcessWindowStyle.Normal
    }

    Dim proc As Process = Process.Start(psi)
    ' Optional: wait for completion
    ' proc.WaitForExit()

    ' (Optional) delete temp script afterward
    ' Try
    '   IO.File.Delete(psFile)
    ' Catch ex As Exception
    '   WF.MessageBox.Show("Could not delete temp script:" & vbCrLf & ex.Message, "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Warning)
    ' End Try
  End Sub

End Class
```

#### Code Block 6

```vb
AddReference "System.IO"
AddReference "System.Windows.Forms"
AddReference "System.Drawing"
Imports Inventor
Imports IO = System.IO
Imports WF = System.Windows.Forms
Imports SD = System.Drawing
Imports System.Text
Imports System.Diagnostics

Public Class CopyDesignRule

  Public Sub Main()
    ' 1) Source assembly path from the active document
    Dim asmPath As String = ThisDoc.ModelDocument.FullFileName
    If String.IsNullOrEmpty(asmPath) OrElse Not IO.File.Exists(asmPath) Then
      WF.MessageBox.Show("Active document path not found or file does not exist.", _
                         "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Error)
      Exit Sub
    End If

    ' 2) Build the form
    Dim frm As New WF.Form With {
      .Text            = "Copy Design (PowerShell)",
      .AutoScaleMode   = WF.AutoScaleMode.Dpi,
      .Size            = New SD.Size(760, 340),
      .Font            = New SD.Font("Segoe UI", 10.0!),
      .StartPosition   = WF.FormStartPosition.CenterScreen,
      .FormBorderStyle = WF.FormBorderStyle.FixedDialog,
      .MaximizeBox     = False,
      .MinimizeBox     = False
    }
    AddHandler frm.KeyDown, Sub(s, E) If E.KeyCode = WF.Keys.Escape Then frm.Close()

    Dim y As Integer = 18
    Dim gap As Integer = 40

    ' — Source (readonly)
    frm.Controls.Add(New WF.Label With {.Text = "Source assembly:", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbSrc As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 530, .Text = asmPath, .ReadOnly = True}
    frm.Controls.Add(tbSrc)
    y += gap

    ' — New sub-folder name
    frm.Controls.Add(New WF.Label With {.Text = "New folder name:", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbFolder As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 300, .Text = "CopyDesign"}
    frm.Controls.Add(tbFolder)
    y += gap

    ' — Destination root (optional)
    frm.Controls.Add(New WF.Label With {.Text = "Destination root (optional):", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbRoot As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 530, .Text = ""}
    frm.Controls.Add(tbRoot)
    y += gap

    ' — Copy prefix
    frm.Controls.Add(New WF.Label With {.Text = "Copy prefix (e.g. Copy_):", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbPrefix As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 180, .Text = "Copy_"}
    frm.Controls.Add(tbPrefix)
    y += gap

    ' — Existing prefixes to allow (comma-separated)
    frm.Controls.Add(New WF.Label With {
        .Text = "Existing prefixes to allow (comma-separated, e.g. WIP_,WIP2_):",
        .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbExtra As New WF.TextBox With {.Location = New SD.Point(15, y + 22), .Width = 695, .Text = ""}
    frm.Controls.Add(tbExtra)
    y += 70

    ' — Buttons
    Dim btnStart As New WF.Button With {.Text = "Start", .Location = New SD.Point(520, y), .Width = 90, .DialogResult = WF.DialogResult.OK}
    Dim btnClose As New WF.Button With {.Text = "Close", .Location = New SD.Point(620, y), .Width = 90, .DialogResult = WF.DialogResult.Cancel}
    frm.Controls.AddRange({btnStart, btnClose})
    frm.AcceptButton = btnStart
    frm.CancelButton = btnClose

    If frm.ShowDialog() <> WF.DialogResult.OK Then Exit Sub

    ' 3) Validate inputs and compute destination folder
    Dim baseFolder As String = IO.Path.GetDirectoryName(asmPath)
    Dim newFolder  As String = tbFolder.Text.Trim()
    If newFolder = "" Then
      WF.MessageBox.Show("You must enter a folder name.", "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Warning)
      Exit Sub
    End If

    Dim rootPath As String = tbRoot.Text.Trim()
    Dim destDir As String
    If rootPath = "" Then
      ' default: new sub-folder next to the source assembly
      destDir = IO.Path.Combine(baseFolder, newFolder)
    Else
      ' user-supplied root path
      destDir = IO.Path.Combine(rootPath, newFolder)
    End If

    Dim prefix As String = tbPrefix.Text.Trim()
    If prefix = "" Then prefix = "Copy_"

    Dim extraText As String = tbExtra.Text.Trim()
    Dim extraList As New List(Of String)
    If extraText <> "" Then
      For Each tok In extraText.Split(","c)
        Dim p = tok.Trim()
        If p <> "" Then extraList.Add(p)
      Next
    End If

    ' 4) Generate and run the latest PowerShell script
    GenerateAndRunPS(asmPath, destDir, prefix, extraList)
  End Sub



  Private Sub GenerateAndRunPS(asmPath As String, destDir As String, prefix As String, extraPrefixes As List(Of String))
    ' Build PowerShell array literal for extra prefixes, with safe quoting
    Dim psExtra As String
    If extraPrefixes IsNot Nothing AndAlso extraPrefixes.Count > 0 Then
      Dim esc = extraPrefixes.Select(Function(s) s.Replace("'", "''"))
      psExtra = "@('" & String.Join("','", esc) & "')"
    Else
      psExtra = "@()"
    End If

    ' Create temp .ps1
    Dim psFile As String = IO.Path.Combine(IO.Path.GetTempPath(), "CopyDesign_" & Guid.NewGuid().ToString("N") & ".ps1")
    Dim sb As New StringBuilder()

    ' NOTE: This is the latest baseline logic (no Read-Host; uses values from the form)
    With sb
      .AppendLine("$ErrorActionPreference = 'Stop'")
      .AppendLine("")
      .AppendLine("# Inputs from iLogic")
      .AppendLine("$asmPath  = '" & asmPath.Replace("'", "''") & "'")
      .AppendLine("$destDir  = '" & destDir.Replace("'", "''") & "'")
      .AppendLine("$prefix   = '" & prefix.Replace("'", "''") & "'")
      .AppendLine("$extraPrefixes = " & psExtra)
      .AppendLine("")
      .AppendLine("# ensure output folder exists")
      .AppendLine("if (-not (Test-Path $destDir)) { New-Item -ItemType Directory -Path $destDir | Out-Null }")
      .AppendLine("")
      .AppendLine("# ApprenticeServer for CAD-only copy")
      .AppendLine("$appr = New-Object -ComObject Inventor.ApprenticeServer")
      .AppendLine("$asm  = $appr.Open($asmPath)")
      .AppendLine("$save = $appr.FileSaveAs")
      .AppendLine("")
      .AppendLine("function Pref([string]$path) { $prefix + ([IO.Path]::GetFileName($path)) }")
      .AppendLine("")
      .AppendLine("# 1) queue the main assembly")
      .AppendLine("$save.AddFileToSave($asm, (Join-Path $destDir (Pref $asmPath)))")
      .AppendLine("")
      .AppendLine("# 2) queue parts & sub-assemblies, filtered")
      .AppendLine("foreach ($doc in $asm.AllReferencedDocuments) {")
      .AppendLine("  if ($doc.NeedsMigrating) { continue }")
      .AppendLine("  $fileName = [IO.Path]::GetFileName($doc.FullFileName)")
      .AppendLine("  $baseName = [IO.Path]::GetFileNameWithoutExtension($fileName)")
      .AppendLine("  $ext      = [IO.Path]::GetExtension($fileName).ToLowerInvariant()")
      .AppendLine("  $matchesPattern = $baseName -match '^0.*-\d+$'")
      .AppendLine("  $matchesExtra   = $false")
      .AppendLine("  foreach ($p in $extraPrefixes) { if ($p -and $baseName.StartsWith($p)) { $matchesExtra = $true; break } }")
      .AppendLine("  if (($ext -in '.iam','.ipt') -and ($matchesPattern -or $matchesExtra)) {")
      .AppendLine("    $out    = Join-Path $destDir (Pref $doc.FullFileName)")
      .AppendLine("    $outDir = Split-Path $out")
      .AppendLine("    if (-not (Test-Path $outDir)) { New-Item -ItemType Directory -Path $outDir -Force | Out-Null }")
      .AppendLine("    $save.AddFileToSave($doc, $out)")
      .AppendLine("  } else {")
      .AppendLine("    Write-Host ('Skipping ' + $fileName + ' (naming filter)') -ForegroundColor DarkYellow")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 3) perform CAD copy")
      .AppendLine("$save.ExecuteSaveCopyAs()")
      .AppendLine("")
      .AppendLine("# 4) copy drawings from disk, filtered")
      .AppendLine("$exts = '.idw','.dwg','.ipn'")
      .AppendLine("function CopyDrawings($folder) {")
      .AppendLine("  foreach ($e in $exts) {")
      .AppendLine("    Get-ChildItem -Path $folder -Filter ""*$e"" -File -ErrorAction SilentlyContinue |")
      .AppendLine("    Where-Object {")
      .AppendLine("      if ($_.Extension -ieq '.idw') {")
      .AppendLine("        $b = $_.BaseName")
      .AppendLine("        $okPattern = $b -match '^0.*\d$'")
      .AppendLine("        $okExtra   = $false")
      .AppendLine("        foreach ($p in $extraPrefixes) { if ($p -and $b.StartsWith($p)) { $okExtra = $true; break } }")
      .AppendLine("        $okPattern -or $okExtra")
      .AppendLine("      } else { $true }")
      .AppendLine("    } |")
      .AppendLine("    ForEach-Object { Copy-Item $_.FullName (Join-Path $destDir ($prefix + $_.Name)) -Force }")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("CopyDrawings (Split-Path $asmPath -Parent)")
      .AppendLine("foreach ($doc in @($asm) + $asm.AllReferencedDocuments) { CopyDrawings (Split-Path $doc.FullFileName -Parent) }")
      .AppendLine("")
      .AppendLine("# 4.5) remove Read-Only attribute")
      .AppendLine("Get-ChildItem -Path $destDir -Recurse -File | Where-Object { $_.Extension -in '.iam','.ipt','.idw' } | ForEach-Object {")
      .AppendLine("  if ($_.IsReadOnly) { $_.IsReadOnly = $false; Write-Host ('Removed ReadOnly: ' + $_.FullName) }")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 5) first relink pass via Inventor.Application (.Path)")
      .AppendLine("function RelinkDrawings {")
      .AppendLine("  param($folder, $filePrefix)")
      .AppendLine("  $invApp = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("  Get-ChildItem -Path $folder -Include '*.idw','*.dwg' -File | ForEach-Object {")
      .AppendLine("    $draw = $invApp.Documents.Open($_.FullName, $true)")
      .AppendLine("    foreach ($desc in $draw.ReferencedDocumentDescriptors) {")
      .AppendLine("      $old  = $desc.ReferencedFileDescriptor.FullFileName")
      .AppendLine("      $base = [IO.Path]::GetFileName($old)")
      .AppendLine("      $new  = Join-Path $folder ($filePrefix + $base)")
      .AppendLine("      if (Test-Path $new) { $desc.ReferencedFileDescriptor.Path = $new }")
      .AppendLine("    }")
      .AppendLine("    $draw.Update(); $draw.Save(); $draw.Close()")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("RelinkDrawings -folder $destDir -filePrefix $prefix")
      .AppendLine("")
      .AppendLine("# 6) open result folder")
      .AppendLine("Start-Process explorer.exe -ArgumentList $destDir")
      .AppendLine("")
      .AppendLine("# 7) full-session ReplaceReference relink with iLogic suppression")
      .AppendLine("Write-Host 'Preparing full-session relink with iLogic/events off…' -ForegroundColor Cyan")
      .AppendLine("$inv = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("try { $inv.DisplayAlerts = $true } catch {}")
      .AppendLine("try { $inv.SilentOperation = $true } catch {}")
      .AppendLine("")
      .AppendLine("try {")
      .AppendLine("  $iLogicVB = $inv.ApplicationAddIns.ItemById('{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}')")
      .AppendLine("  if (-not $iLogicVB.Activated) { $iLogicVB.Activate() }")
      .AppendLine("  $iLogicVB.Automation.RulesEnabled           = $false")
      .AppendLine("  $iLogicVB.Automation.RulesOnEventsEnabled   = $false")
      .AppendLine("  $iLogicVB.Automation.SilentOperation        = $true")
      .AppendLine("  $iLogicVB.Automation.CallingFromOutside     = $true")
      .AppendLine("  Write-Host 'iLogic VB automation mode ON.'")
      .AppendLine("} catch { Write-Warning ('VB iLogic disable failed: ' + $_.Exception.Message) }")
      .AppendLine("")
      .AppendLine("# build source->dest map")
      .AppendLine("$map = @{}")
      .AppendLine("$allDocs = New-Object System.Collections.Generic.List[Object]")
      .AppendLine("$queue   = New-Object System.Collections.Generic.Queue[Object]")
      .AppendLine("$queue.Enqueue($asm)")
      .AppendLine("while ($queue.Count -gt 0) {")
      .AppendLine("  $d = $queue.Dequeue()")
      .AppendLine("  if (-not ($allDocs -contains $d)) {")
      .AppendLine("    $allDocs.Add($d)")
      .AppendLine("    foreach ($child in $d.AllReferencedDocuments) { if ($child.FullFileName) { $queue.Enqueue($child) } }")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("foreach ($doc in $allDocs) {")
      .AppendLine("  if ($doc.FullFileName) { $map[$doc.FullFileName.ToLower()] = Join-Path $destDir ($prefix + [IO.Path]::GetFileName($doc.FullFileName)) }")
      .AppendLine("}")
      .AppendLine("foreach ($file in Get-ChildItem -Path $destDir -Filter ""$prefix*.idw"" -File) {")
      .AppendLine("  $orig = $file.Name.Substring($prefix.Length)")
      .AppendLine("  $map[(Join-Path (Split-Path $asmPath -Parent) $orig).ToLower()] = $file.FullName")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("Get-ChildItem -Path $destDir -Filter ""$prefix*.idw"" -Recurse -File | ForEach-Object {")
      .AppendLine("  Write-Host ('  • ' + $_.Name)")
      .AppendLine("  $dw = $inv.Documents.Open($_.FullName, $false)")
      .AppendLine("  foreach ($r in $dw.ReferencedFileDescriptors) {")
      .AppendLine("    $k = $r.FullFileName.ToLower()")
      .AppendLine("    if ($map.ContainsKey($k)) { $r.DocumentDescriptor.ReferencedFileDescriptor.ReplaceReference($map[$k]) }")
      .AppendLine("  }")
      .AppendLine("  $dw.Update(); $dw.Save2(); $dw.Close($true)")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 8) update Part Number iProperties")
      .AppendLine("Write-Host 'Updating Part Number iProperties…' -ForegroundColor Cyan")
      .AppendLine("$inv2 = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("Get-ChildItem -Path $destDir -Filter ""$prefix*"" -File | ForEach-Object {")
      .AppendLine("  Write-Host ('  • ' + $_.Name)")
      .AppendLine("  $doc2 = $inv2.Documents.Open($_.FullName, $false)")
      .AppendLine("  try {")
      .AppendLine("    $ps = $doc2.PropertySets.Item('Design Tracking Properties')")
      .AppendLine("    $ps.Item('Part Number').Value = [IO.Path]::GetFileNameWithoutExtension($_.Name)")
      .AppendLine("    $doc2.Update(); $doc2.Save2()")
      .AppendLine("  } catch {")
      .AppendLine("    Write-Warning ('  ! Part Number failed on ' + $_.Name + ': ' + $_.Exception.Message)")
      .AppendLine("  } finally { $doc2.Close($true) }")
      .AppendLine("}")
      .AppendLine("Write-Host 'Part Number update complete.' -ForegroundColor Green")
    End With

    IO.File.WriteAllText(psFile, sb.ToString())

    ' Launch PowerShell so progress/errors are visible
    Dim psi As New ProcessStartInfo() With {
      .FileName        = "powershell.exe",
      .Arguments       = "-NoProfile -ExecutionPolicy Bypass -File """ & psFile & """",
      .UseShellExecute = True,
      .WindowStyle     = ProcessWindowStyle.Normal
    }

    Dim proc As Process = Process.Start(psi)
    ' Optional: wait for completion
    ' proc.WaitForExit()

    ' (Optional) delete temp script afterward
    ' Try
    '   IO.File.Delete(psFile)
    ' Catch ex As Exception
    '   WF.MessageBox.Show("Could not delete temp script:" & vbCrLf & ex.Message, "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Warning)
    ' End Try
  End Sub

End Class
```

#### Code Block 7

```vb
AddReference "System.IO"
AddReference "System.Windows.Forms"
AddReference "System.Drawing"
Imports Inventor
Imports IO = System.IO
Imports WF = System.Windows.Forms
Imports SD = System.Drawing
Imports System.Text
Imports System.Diagnostics

Public Class CopyDesignRule

  Public Sub Main()
    ' 1) Source assembly path from the active document
    Dim asmPath As String = ThisDoc.ModelDocument.FullFileName
    If String.IsNullOrEmpty(asmPath) OrElse Not IO.File.Exists(asmPath) Then
      WF.MessageBox.Show("Active document path not found or file does not exist.", _
                         "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Error)
      Exit Sub
    End If

    ' 2) Build the form
    Dim frm As New WF.Form With {
      .Text            = "Copy Design (PowerShell)",
      .AutoScaleMode   = WF.AutoScaleMode.Dpi,
      .Size            = New SD.Size(760, 340),
      .Font            = New SD.Font("Segoe UI", 10.0!),
      .StartPosition   = WF.FormStartPosition.CenterScreen,
      .FormBorderStyle = WF.FormBorderStyle.FixedDialog,
      .MaximizeBox     = False,
      .MinimizeBox     = False
    }
    AddHandler frm.KeyDown, Sub(s, E) If E.KeyCode = WF.Keys.Escape Then frm.Close()

    Dim y As Integer = 18
    Dim gap As Integer = 40

    ' — Source (readonly)
    frm.Controls.Add(New WF.Label With {.Text = "Source assembly:", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbSrc As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 530, .Text = asmPath, .ReadOnly = True}
    frm.Controls.Add(tbSrc)
    y += gap

    ' — New sub-folder name
    frm.Controls.Add(New WF.Label With {.Text = "New folder name:", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbFolder As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 300, .Text = "CopyDesign"}
    frm.Controls.Add(tbFolder)
    y += gap

    ' — Destination root (optional)
    frm.Controls.Add(New WF.Label With {.Text = "Destination root (optional):", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbRoot As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 530, .Text = ""}
    frm.Controls.Add(tbRoot)
    y += gap

    ' — Copy prefix
    frm.Controls.Add(New WF.Label With {.Text = "Copy prefix (e.g. Copy_):", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbPrefix As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 180, .Text = "Copy_"}
    frm.Controls.Add(tbPrefix)
    y += gap

    ' — Existing prefixes to allow (comma-separated)
    frm.Controls.Add(New WF.Label With {
        .Text = "Existing prefixes to allow (comma-separated, e.g. WIP_,WIP2_):",
        .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbExtra As New WF.TextBox With {.Location = New SD.Point(15, y + 22), .Width = 695, .Text = ""}
    frm.Controls.Add(tbExtra)
    y += 70

    ' — Buttons
    Dim btnStart As New WF.Button With {.Text = "Start", .Location = New SD.Point(520, y), .Width = 90, .DialogResult = WF.DialogResult.OK}
    Dim btnClose As New WF.Button With {.Text = "Close", .Location = New SD.Point(620, y), .Width = 90, .DialogResult = WF.DialogResult.Cancel}
    frm.Controls.AddRange({btnStart, btnClose})
    frm.AcceptButton = btnStart
    frm.CancelButton = btnClose

    If frm.ShowDialog() <> WF.DialogResult.OK Then Exit Sub

    ' 3) Validate inputs and compute destination folder
    Dim baseFolder As String = IO.Path.GetDirectoryName(asmPath)
    Dim newFolder  As String = tbFolder.Text.Trim()
    If newFolder = "" Then
      WF.MessageBox.Show("You must enter a folder name.", "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Warning)
      Exit Sub
    End If

    Dim rootPath As String = tbRoot.Text.Trim()
    Dim destDir As String
    If rootPath = "" Then
      ' default: new sub-folder next to the source assembly
      destDir = IO.Path.Combine(baseFolder, newFolder)
    Else
      ' user-supplied root path
      destDir = IO.Path.Combine(rootPath, newFolder)
    End If

    Dim prefix As String = tbPrefix.Text.Trim()
    If prefix = "" Then prefix = "Copy_"

    Dim extraText As String = tbExtra.Text.Trim()
    Dim extraList As New List(Of String)
    If extraText <> "" Then
      For Each tok In extraText.Split(","c)
        Dim p = tok.Trim()
        If p <> "" Then extraList.Add(p)
      Next
    End If

    ' 4) Generate and run the latest PowerShell script
    GenerateAndRunPS(asmPath, destDir, prefix, extraList)
  End Sub



  Private Sub GenerateAndRunPS(asmPath As String, destDir As String, prefix As String, extraPrefixes As List(Of String))
    ' Build PowerShell array literal for extra prefixes, with safe quoting
    Dim psExtra As String
    If extraPrefixes IsNot Nothing AndAlso extraPrefixes.Count > 0 Then
      Dim esc = extraPrefixes.Select(Function(s) s.Replace("'", "''"))
      psExtra = "@('" & String.Join("','", esc) & "')"
    Else
      psExtra = "@()"
    End If

    ' Create temp .ps1
    Dim psFile As String = IO.Path.Combine(IO.Path.GetTempPath(), "CopyDesign_" & Guid.NewGuid().ToString("N") & ".ps1")
    Dim sb As New StringBuilder()

    ' NOTE: This is the latest baseline logic (no Read-Host; uses values from the form)
    With sb
      .AppendLine("$ErrorActionPreference = 'Stop'")
      .AppendLine("")
      .AppendLine("# Inputs from iLogic")
      .AppendLine("$asmPath  = '" & asmPath.Replace("'", "''") & "'")
      .AppendLine("$destDir  = '" & destDir.Replace("'", "''") & "'")
      .AppendLine("$prefix   = '" & prefix.Replace("'", "''") & "'")
      .AppendLine("$extraPrefixes = " & psExtra)
      .AppendLine("")
      .AppendLine("# ensure output folder exists")
      .AppendLine("if (-not (Test-Path $destDir)) { New-Item -ItemType Directory -Path $destDir | Out-Null }")
      .AppendLine("")
      .AppendLine("# ApprenticeServer for CAD-only copy")
      .AppendLine("$appr = New-Object -ComObject Inventor.ApprenticeServer")
      .AppendLine("$asm  = $appr.Open($asmPath)")
      .AppendLine("$save = $appr.FileSaveAs")
      .AppendLine("")
      .AppendLine("function Pref([string]$path) { $prefix + ([IO.Path]::GetFileName($path)) }")
      .AppendLine("")
      .AppendLine("# 1) queue the main assembly")
      .AppendLine("$save.AddFileToSave($asm, (Join-Path $destDir (Pref $asmPath)))")
      .AppendLine("")
      .AppendLine("# 2) queue parts & sub-assemblies, filtered")
      .AppendLine("foreach ($doc in $asm.AllReferencedDocuments) {")
      .AppendLine("  if ($doc.NeedsMigrating) { continue }")
      .AppendLine("  $fileName = [IO.Path]::GetFileName($doc.FullFileName)")
      .AppendLine("  $baseName = [IO.Path]::GetFileNameWithoutExtension($fileName)")
      .AppendLine("  $ext      = [IO.Path]::GetExtension($fileName).ToLowerInvariant()")
      .AppendLine("  $matchesPattern = $baseName -match '^0.*-\d+$'")
      .AppendLine("  $matchesExtra   = $false")
      .AppendLine("  foreach ($p in $extraPrefixes) { if ($p -and $baseName.StartsWith($p)) { $matchesExtra = $true; break } }")
      .AppendLine("  if (($ext -in '.iam','.ipt') -and ($matchesPattern -or $matchesExtra)) {")
      .AppendLine("    $out    = Join-Path $destDir (Pref $doc.FullFileName)")
      .AppendLine("    $outDir = Split-Path $out")
      .AppendLine("    if (-not (Test-Path $outDir)) { New-Item -ItemType Directory -Path $outDir -Force | Out-Null }")
      .AppendLine("    $save.AddFileToSave($doc, $out)")
      .AppendLine("  } else {")
      .AppendLine("    Write-Host ('Skipping ' + $fileName + ' (naming filter)') -ForegroundColor DarkYellow")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 3) perform CAD copy")
      .AppendLine("$save.ExecuteSaveCopyAs()")
      .AppendLine("")
      .AppendLine("# 4) copy drawings from disk, filtered")
      .AppendLine("$exts = '.idw','.dwg','.ipn'")
      .AppendLine("function CopyDrawings($folder) {")
      .AppendLine("  foreach ($e in $exts) {")
      .AppendLine("    Get-ChildItem -Path $folder -Filter ""*$e"" -File -ErrorAction SilentlyContinue |")
      .AppendLine("    Where-Object {")
      .AppendLine("      if ($_.Extension -ieq '.idw') {")
      .AppendLine("        $b = $_.BaseName")
      .AppendLine("        $okPattern = $b -match '^0.*\d$'")
      .AppendLine("        $okExtra   = $false")
      .AppendLine("        foreach ($p in $extraPrefixes) { if ($p -and $b.StartsWith($p)) { $okExtra = $true; break } }")
      .AppendLine("        $okPattern -or $okExtra")
      .AppendLine("      } else { $true }")
      .AppendLine("    } |")
      .AppendLine("    ForEach-Object { Copy-Item $_.FullName (Join-Path $destDir ($prefix + $_.Name)) -Force }")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("CopyDrawings (Split-Path $asmPath -Parent)")
      .AppendLine("foreach ($doc in @($asm) + $asm.AllReferencedDocuments) { CopyDrawings (Split-Path $doc.FullFileName -Parent) }")
      .AppendLine("")
      .AppendLine("# 4.5) remove Read-Only attribute")
      .AppendLine("Get-ChildItem -Path $destDir -Recurse -File | Where-Object { $_.Extension -in '.iam','.ipt','.idw' } | ForEach-Object {")
      .AppendLine("  if ($_.IsReadOnly) { $_.IsReadOnly = $false; Write-Host ('Removed ReadOnly: ' + $_.FullName) }")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 5) first relink pass via Inventor.Application (.Path)")
      .AppendLine("function RelinkDrawings {")
      .AppendLine("  param($folder, $filePrefix)")
      .AppendLine("  $invApp = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("  Get-ChildItem -Path $folder -Include '*.idw','*.dwg' -File | ForEach-Object {")
      .AppendLine("    $draw = $invApp.Documents.Open($_.FullName, $true)")
      .AppendLine("    foreach ($desc in $draw.ReferencedDocumentDescriptors) {")
      .AppendLine("      $old  = $desc.ReferencedFileDescriptor.FullFileName")
      .AppendLine("      $base = [IO.Path]::GetFileName($old)")
      .AppendLine("      $new  = Join-Path $folder ($filePrefix + $base)")
      .AppendLine("      if (Test-Path $new) { $desc.ReferencedFileDescriptor.Path = $new }")
      .AppendLine("    }")
      .AppendLine("    $draw.Update(); $draw.Save(); $draw.Close()")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("RelinkDrawings -folder $destDir -filePrefix $prefix")
      .AppendLine("")
      .AppendLine("# 6) open result folder")
      .AppendLine("Start-Process explorer.exe -ArgumentList $destDir")
      .AppendLine("")
      .AppendLine("# 7) full-session ReplaceReference relink with iLogic suppression")
      .AppendLine("Write-Host 'Preparing full-session relink with iLogic/events off…' -ForegroundColor Cyan")
      .AppendLine("$inv = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("try { $inv.DisplayAlerts = $true } catch {}")
      .AppendLine("try { $inv.SilentOperation = $true } catch {}")
      .AppendLine("")
      .AppendLine("try {")
      .AppendLine("  $iLogicVB = $inv.ApplicationAddIns.ItemById('{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}')")
      .AppendLine("  if (-not $iLogicVB.Activated) { $iLogicVB.Activate() }")
      .AppendLine("  $iLogicVB.Automation.RulesEnabled           = $false")
      .AppendLine("  $iLogicVB.Automation.RulesOnEventsEnabled   = $false")
      .AppendLine("  $iLogicVB.Automation.SilentOperation        = $true")
      .AppendLine("  $iLogicVB.Automation.CallingFromOutside     = $true")
      .AppendLine("  Write-Host 'iLogic VB automation mode ON.'")
      .AppendLine("} catch { Write-Warning ('VB iLogic disable failed: ' + $_.Exception.Message) }")
      .AppendLine("")
      .AppendLine("# build source->dest map")
      .AppendLine("$map = @{}")
      .AppendLine("$allDocs = New-Object System.Collections.Generic.List[Object]")
      .AppendLine("$queue   = New-Object System.Collections.Generic.Queue[Object]")
      .AppendLine("$queue.Enqueue($asm)")
      .AppendLine("while ($queue.Count -gt 0) {")
      .AppendLine("  $d = $queue.Dequeue()")
      .AppendLine("  if (-not ($allDocs -contains $d)) {")
      .AppendLine("    $allDocs.Add($d)")
      .AppendLine("    foreach ($child in $d.AllReferencedDocuments) { if ($child.FullFileName) { $queue.Enqueue($child) } }")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("foreach ($doc in $allDocs) {")
      .AppendLine("  if ($doc.FullFileName) { $map[$doc.FullFileName.ToLower()] = Join-Path $destDir ($prefix + [IO.Path]::GetFileName($doc.FullFileName)) }")
      .AppendLine("}")
      .AppendLine("foreach ($file in Get-ChildItem -Path $destDir -Filter ""$prefix*.idw"" -File) {")
      .AppendLine("  $orig = $file.Name.Substring($prefix.Length)")
      .AppendLine("  $map[(Join-Path (Split-Path $asmPath -Parent) $orig).ToLower()] = $file.FullName")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("Get-ChildItem -Path $destDir -Filter ""$prefix*.idw"" -Recurse -File | ForEach-Object {")
      .AppendLine("  Write-Host ('  • ' + $_.Name)")
      .AppendLine("  $dw = $inv.Documents.Open($_.FullName, $false)")
      .AppendLine("  foreach ($r in $dw.ReferencedFileDescriptors) {")
      .AppendLine("    $k = $r.FullFileName.ToLower()")
      .AppendLine("    if ($map.ContainsKey($k)) { $r.DocumentDescriptor.ReferencedFileDescriptor.ReplaceReference($map[$k]) }")
      .AppendLine("  }")
      .AppendLine("  $dw.Update(); $dw.Save2(); $dw.Close($true)")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 8) update Part Number iProperties")
      .AppendLine("Write-Host 'Updating Part Number iProperties…' -ForegroundColor Cyan")
      .AppendLine("$inv2 = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("Get-ChildItem -Path $destDir -Filter ""$prefix*"" -File | ForEach-Object {")
      .AppendLine("  Write-Host ('  • ' + $_.Name)")
      .AppendLine("  $doc2 = $inv2.Documents.Open($_.FullName, $false)")
      .AppendLine("  try {")
      .AppendLine("    $ps = $doc2.PropertySets.Item('Design Tracking Properties')")
      .AppendLine("    $ps.Item('Part Number').Value = [IO.Path]::GetFileNameWithoutExtension($_.Name)")
      .AppendLine("    $doc2.Update(); $doc2.Save2()")
      .AppendLine("  } catch {")
      .AppendLine("    Write-Warning ('  ! Part Number failed on ' + $_.Name + ': ' + $_.Exception.Message)")
      .AppendLine("  } finally { $doc2.Close($true) }")
      .AppendLine("}")
      .AppendLine("Write-Host 'Part Number update complete.' -ForegroundColor Green")
    End With

    IO.File.WriteAllText(psFile, sb.ToString())

    ' Launch PowerShell so progress/errors are visible
    Dim psi As New ProcessStartInfo() With {
      .FileName        = "powershell.exe",
      .Arguments       = "-NoProfile -ExecutionPolicy Bypass -File """ & psFile & """",
      .UseShellExecute = True,
      .WindowStyle     = ProcessWindowStyle.Normal
    }

    Dim proc As Process = Process.Start(psi)
    ' Optional: wait for completion
    ' proc.WaitForExit()

    ' (Optional) delete temp script afterward
    ' Try
    '   IO.File.Delete(psFile)
    ' Catch ex As Exception
    '   WF.MessageBox.Show("Could not delete temp script:" & vbCrLf & ex.Message, "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Warning)
    ' End Try
  End Sub

End Class
```

#### Code Block 8

```vb
AddReference "System.IO"
AddReference "System.Windows.Forms"
AddReference "System.Drawing"
Imports Inventor
Imports IO = System.IO
Imports WF = System.Windows.Forms
Imports SD = System.Drawing
Imports System.Text
Imports System.Diagnostics

Public Class CopyDesignRule

  Public Sub Main()
    ' 1) Source assembly path from the active document
    Dim asmPath As String = ThisDoc.ModelDocument.FullFileName
    If String.IsNullOrEmpty(asmPath) OrElse Not IO.File.Exists(asmPath) Then
      WF.MessageBox.Show("Active document path not found or file does not exist.", _
                         "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Error)
      Exit Sub
    End If

    ' 2) Build the form
    Dim frm As New WF.Form With {
      .Text            = "Copy Design (PowerShell)",
      .AutoScaleMode   = WF.AutoScaleMode.Dpi,
      .Size            = New SD.Size(760, 340),
      .Font            = New SD.Font("Segoe UI", 10.0!),
      .StartPosition   = WF.FormStartPosition.CenterScreen,
      .FormBorderStyle = WF.FormBorderStyle.FixedDialog,
      .MaximizeBox     = False,
      .MinimizeBox     = False
    }
    AddHandler frm.KeyDown, Sub(s, E) If E.KeyCode = WF.Keys.Escape Then frm.Close()

    Dim y As Integer = 18
    Dim gap As Integer = 40

    ' — Source (readonly)
    frm.Controls.Add(New WF.Label With {.Text = "Source assembly:", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbSrc As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 530, .Text = asmPath, .ReadOnly = True}
    frm.Controls.Add(tbSrc)
    y += gap

    ' — New sub-folder name
    frm.Controls.Add(New WF.Label With {.Text = "New folder name:", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbFolder As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 300, .Text = "CopyDesign"}
    frm.Controls.Add(tbFolder)
    y += gap

    ' — Destination root (optional)
    frm.Controls.Add(New WF.Label With {.Text = "Destination root (optional):", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbRoot As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 530, .Text = ""}
    frm.Controls.Add(tbRoot)
    y += gap

    ' — Copy prefix
    frm.Controls.Add(New WF.Label With {.Text = "Copy prefix (e.g. Copy_):", .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbPrefix As New WF.TextBox With {.Location = New SD.Point(180, y - 3), .Width = 180, .Text = "Copy_"}
    frm.Controls.Add(tbPrefix)
    y += gap

    ' — Existing prefixes to allow (comma-separated)
    frm.Controls.Add(New WF.Label With {
        .Text = "Existing prefixes to allow (comma-separated, e.g. WIP_,WIP2_):",
        .Location = New SD.Point(15, y), .AutoSize = True})
    Dim tbExtra As New WF.TextBox With {.Location = New SD.Point(15, y + 22), .Width = 695, .Text = ""}
    frm.Controls.Add(tbExtra)
    y += 70

    ' — Buttons
    Dim btnStart As New WF.Button With {.Text = "Start", .Location = New SD.Point(520, y), .Width = 90, .DialogResult = WF.DialogResult.OK}
    Dim btnClose As New WF.Button With {.Text = "Close", .Location = New SD.Point(620, y), .Width = 90, .DialogResult = WF.DialogResult.Cancel}
    frm.Controls.AddRange({btnStart, btnClose})
    frm.AcceptButton = btnStart
    frm.CancelButton = btnClose

    If frm.ShowDialog() <> WF.DialogResult.OK Then Exit Sub

    ' 3) Validate inputs and compute destination folder
    Dim baseFolder As String = IO.Path.GetDirectoryName(asmPath)
    Dim newFolder  As String = tbFolder.Text.Trim()
    If newFolder = "" Then
      WF.MessageBox.Show("You must enter a folder name.", "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Warning)
      Exit Sub
    End If

    Dim rootPath As String = tbRoot.Text.Trim()
    Dim destDir As String
    If rootPath = "" Then
      ' default: new sub-folder next to the source assembly
      destDir = IO.Path.Combine(baseFolder, newFolder)
    Else
      ' user-supplied root path
      destDir = IO.Path.Combine(rootPath, newFolder)
    End If

    Dim prefix As String = tbPrefix.Text.Trim()
    If prefix = "" Then prefix = "Copy_"

    Dim extraText As String = tbExtra.Text.Trim()
    Dim extraList As New List(Of String)
    If extraText <> "" Then
      For Each tok In extraText.Split(","c)
        Dim p = tok.Trim()
        If p <> "" Then extraList.Add(p)
      Next
    End If

    ' 4) Generate and run the latest PowerShell script
    GenerateAndRunPS(asmPath, destDir, prefix, extraList)
  End Sub



  Private Sub GenerateAndRunPS(asmPath As String, destDir As String, prefix As String, extraPrefixes As List(Of String))
    ' Build PowerShell array literal for extra prefixes, with safe quoting
    Dim psExtra As String
    If extraPrefixes IsNot Nothing AndAlso extraPrefixes.Count > 0 Then
      Dim esc = extraPrefixes.Select(Function(s) s.Replace("'", "''"))
      psExtra = "@('" & String.Join("','", esc) & "')"
    Else
      psExtra = "@()"
    End If

    ' Create temp .ps1
    Dim psFile As String = IO.Path.Combine(IO.Path.GetTempPath(), "CopyDesign_" & Guid.NewGuid().ToString("N") & ".ps1")
    Dim sb As New StringBuilder()

    ' NOTE: This is the latest baseline logic (no Read-Host; uses values from the form)
    With sb
      .AppendLine("$ErrorActionPreference = 'Stop'")
      .AppendLine("")
      .AppendLine("# Inputs from iLogic")
      .AppendLine("$asmPath  = '" & asmPath.Replace("'", "''") & "'")
      .AppendLine("$destDir  = '" & destDir.Replace("'", "''") & "'")
      .AppendLine("$prefix   = '" & prefix.Replace("'", "''") & "'")
      .AppendLine("$extraPrefixes = " & psExtra)
      .AppendLine("")
      .AppendLine("# ensure output folder exists")
      .AppendLine("if (-not (Test-Path $destDir)) { New-Item -ItemType Directory -Path $destDir | Out-Null }")
      .AppendLine("")
      .AppendLine("# ApprenticeServer for CAD-only copy")
      .AppendLine("$appr = New-Object -ComObject Inventor.ApprenticeServer")
      .AppendLine("$asm  = $appr.Open($asmPath)")
      .AppendLine("$save = $appr.FileSaveAs")
      .AppendLine("")
      .AppendLine("function Pref([string]$path) { $prefix + ([IO.Path]::GetFileName($path)) }")
      .AppendLine("")
      .AppendLine("# 1) queue the main assembly")
      .AppendLine("$save.AddFileToSave($asm, (Join-Path $destDir (Pref $asmPath)))")
      .AppendLine("")
      .AppendLine("# 2) queue parts & sub-assemblies, filtered")
      .AppendLine("foreach ($doc in $asm.AllReferencedDocuments) {")
      .AppendLine("  if ($doc.NeedsMigrating) { continue }")
      .AppendLine("  $fileName = [IO.Path]::GetFileName($doc.FullFileName)")
      .AppendLine("  $baseName = [IO.Path]::GetFileNameWithoutExtension($fileName)")
      .AppendLine("  $ext      = [IO.Path]::GetExtension($fileName).ToLowerInvariant()")
      .AppendLine("  $matchesPattern = $baseName -match '^0.*-\d+$'")
      .AppendLine("  $matchesExtra   = $false")
      .AppendLine("  foreach ($p in $extraPrefixes) { if ($p -and $baseName.StartsWith($p)) { $matchesExtra = $true; break } }")
      .AppendLine("  if (($ext -in '.iam','.ipt') -and ($matchesPattern -or $matchesExtra)) {")
      .AppendLine("    $out    = Join-Path $destDir (Pref $doc.FullFileName)")
      .AppendLine("    $outDir = Split-Path $out")
      .AppendLine("    if (-not (Test-Path $outDir)) { New-Item -ItemType Directory -Path $outDir -Force | Out-Null }")
      .AppendLine("    $save.AddFileToSave($doc, $out)")
      .AppendLine("  } else {")
      .AppendLine("    Write-Host ('Skipping ' + $fileName + ' (naming filter)') -ForegroundColor DarkYellow")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 3) perform CAD copy")
      .AppendLine("$save.ExecuteSaveCopyAs()")
      .AppendLine("")
      .AppendLine("# 4) copy drawings from disk, filtered")
      .AppendLine("$exts = '.idw','.dwg','.ipn'")
      .AppendLine("function CopyDrawings($folder) {")
      .AppendLine("  foreach ($e in $exts) {")
      .AppendLine("    Get-ChildItem -Path $folder -Filter ""*$e"" -File -ErrorAction SilentlyContinue |")
      .AppendLine("    Where-Object {")
      .AppendLine("      if ($_.Extension -ieq '.idw') {")
      .AppendLine("        $b = $_.BaseName")
      .AppendLine("        $okPattern = $b -match '^0.*\d$'")
      .AppendLine("        $okExtra   = $false")
      .AppendLine("        foreach ($p in $extraPrefixes) { if ($p -and $b.StartsWith($p)) { $okExtra = $true; break } }")
      .AppendLine("        $okPattern -or $okExtra")
      .AppendLine("      } else { $true }")
      .AppendLine("    } |")
      .AppendLine("    ForEach-Object { Copy-Item $_.FullName (Join-Path $destDir ($prefix + $_.Name)) -Force }")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("CopyDrawings (Split-Path $asmPath -Parent)")
      .AppendLine("foreach ($doc in @($asm) + $asm.AllReferencedDocuments) { CopyDrawings (Split-Path $doc.FullFileName -Parent) }")
      .AppendLine("")
      .AppendLine("# 4.5) remove Read-Only attribute")
      .AppendLine("Get-ChildItem -Path $destDir -Recurse -File | Where-Object { $_.Extension -in '.iam','.ipt','.idw' } | ForEach-Object {")
      .AppendLine("  if ($_.IsReadOnly) { $_.IsReadOnly = $false; Write-Host ('Removed ReadOnly: ' + $_.FullName) }")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 5) first relink pass via Inventor.Application (.Path)")
      .AppendLine("function RelinkDrawings {")
      .AppendLine("  param($folder, $filePrefix)")
      .AppendLine("  $invApp = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("  Get-ChildItem -Path $folder -Include '*.idw','*.dwg' -File | ForEach-Object {")
      .AppendLine("    $draw = $invApp.Documents.Open($_.FullName, $true)")
      .AppendLine("    foreach ($desc in $draw.ReferencedDocumentDescriptors) {")
      .AppendLine("      $old  = $desc.ReferencedFileDescriptor.FullFileName")
      .AppendLine("      $base = [IO.Path]::GetFileName($old)")
      .AppendLine("      $new  = Join-Path $folder ($filePrefix + $base)")
      .AppendLine("      if (Test-Path $new) { $desc.ReferencedFileDescriptor.Path = $new }")
      .AppendLine("    }")
      .AppendLine("    $draw.Update(); $draw.Save(); $draw.Close()")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("RelinkDrawings -folder $destDir -filePrefix $prefix")
      .AppendLine("")
      .AppendLine("# 6) open result folder")
      .AppendLine("Start-Process explorer.exe -ArgumentList $destDir")
      .AppendLine("")
      .AppendLine("# 7) full-session ReplaceReference relink with iLogic suppression")
      .AppendLine("Write-Host 'Preparing full-session relink with iLogic/events off…' -ForegroundColor Cyan")
      .AppendLine("$inv = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("try { $inv.DisplayAlerts = $true } catch {}")
      .AppendLine("try { $inv.SilentOperation = $true } catch {}")
      .AppendLine("")
      .AppendLine("try {")
      .AppendLine("  $iLogicVB = $inv.ApplicationAddIns.ItemById('{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}')")
      .AppendLine("  if (-not $iLogicVB.Activated) { $iLogicVB.Activate() }")
      .AppendLine("  $iLogicVB.Automation.RulesEnabled           = $false")
      .AppendLine("  $iLogicVB.Automation.RulesOnEventsEnabled   = $false")
      .AppendLine("  $iLogicVB.Automation.SilentOperation        = $true")
      .AppendLine("  $iLogicVB.Automation.CallingFromOutside     = $true")
      .AppendLine("  Write-Host 'iLogic VB automation mode ON.'")
      .AppendLine("} catch { Write-Warning ('VB iLogic disable failed: ' + $_.Exception.Message) }")
      .AppendLine("")
      .AppendLine("# build source->dest map")
      .AppendLine("$map = @{}")
      .AppendLine("$allDocs = New-Object System.Collections.Generic.List[Object]")
      .AppendLine("$queue   = New-Object System.Collections.Generic.Queue[Object]")
      .AppendLine("$queue.Enqueue($asm)")
      .AppendLine("while ($queue.Count -gt 0) {")
      .AppendLine("  $d = $queue.Dequeue()")
      .AppendLine("  if (-not ($allDocs -contains $d)) {")
      .AppendLine("    $allDocs.Add($d)")
      .AppendLine("    foreach ($child in $d.AllReferencedDocuments) { if ($child.FullFileName) { $queue.Enqueue($child) } }")
      .AppendLine("  }")
      .AppendLine("}")
      .AppendLine("foreach ($doc in $allDocs) {")
      .AppendLine("  if ($doc.FullFileName) { $map[$doc.FullFileName.ToLower()] = Join-Path $destDir ($prefix + [IO.Path]::GetFileName($doc.FullFileName)) }")
      .AppendLine("}")
      .AppendLine("foreach ($file in Get-ChildItem -Path $destDir -Filter ""$prefix*.idw"" -File) {")
      .AppendLine("  $orig = $file.Name.Substring($prefix.Length)")
      .AppendLine("  $map[(Join-Path (Split-Path $asmPath -Parent) $orig).ToLower()] = $file.FullName")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("Get-ChildItem -Path $destDir -Filter ""$prefix*.idw"" -Recurse -File | ForEach-Object {")
      .AppendLine("  Write-Host ('  • ' + $_.Name)")
      .AppendLine("  $dw = $inv.Documents.Open($_.FullName, $false)")
      .AppendLine("  foreach ($r in $dw.ReferencedFileDescriptors) {")
      .AppendLine("    $k = $r.FullFileName.ToLower()")
      .AppendLine("    if ($map.ContainsKey($k)) { $r.DocumentDescriptor.ReferencedFileDescriptor.ReplaceReference($map[$k]) }")
      .AppendLine("  }")
      .AppendLine("  $dw.Update(); $dw.Save2(); $dw.Close($true)")
      .AppendLine("}")
      .AppendLine("")
      .AppendLine("# 8) update Part Number iProperties")
      .AppendLine("Write-Host 'Updating Part Number iProperties…' -ForegroundColor Cyan")
      .AppendLine("$inv2 = [Runtime.InteropServices.Marshal]::GetActiveObject('Inventor.Application')")
      .AppendLine("Get-ChildItem -Path $destDir -Filter ""$prefix*"" -File | ForEach-Object {")
      .AppendLine("  Write-Host ('  • ' + $_.Name)")
      .AppendLine("  $doc2 = $inv2.Documents.Open($_.FullName, $false)")
      .AppendLine("  try {")
      .AppendLine("    $ps = $doc2.PropertySets.Item('Design Tracking Properties')")
      .AppendLine("    $ps.Item('Part Number').Value = [IO.Path]::GetFileNameWithoutExtension($_.Name)")
      .AppendLine("    $doc2.Update(); $doc2.Save2()")
      .AppendLine("  } catch {")
      .AppendLine("    Write-Warning ('  ! Part Number failed on ' + $_.Name + ': ' + $_.Exception.Message)")
      .AppendLine("  } finally { $doc2.Close($true) }")
      .AppendLine("}")
      .AppendLine("Write-Host 'Part Number update complete.' -ForegroundColor Green")
    End With

    IO.File.WriteAllText(psFile, sb.ToString())

    ' Launch PowerShell so progress/errors are visible
    Dim psi As New ProcessStartInfo() With {
      .FileName        = "powershell.exe",
      .Arguments       = "-NoProfile -ExecutionPolicy Bypass -File """ & psFile & """",
      .UseShellExecute = True,
      .WindowStyle     = ProcessWindowStyle.Normal
    }

    Dim proc As Process = Process.Start(psi)
    ' Optional: wait for completion
    ' proc.WaitForExit()

    ' (Optional) delete temp script afterward
    ' Try
    '   IO.File.Delete(psFile)
    ' Catch ex As Exception
    '   WF.MessageBox.Show("Could not delete temp script:" & vbCrLf & ex.Message, "Copy Design", WF.MessageBoxButtons.OK, WF.MessageBoxIcon.Warning)
    ' End Try
  End Sub

End Class
```

---

### 11. Ataching leader note to sketched symbol in drawing

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ataching-leader-note-to-sketched-symbol-in-drawing/td-p/13833109#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ataching-leader-note-to-sketched-symbol-in-drawing/td-p/13833109#messageview_0)

**Author:** omartin

**Date:** ‎10-01-2025
	
		
		08:29 AM

**Description:** Trying to attach a leader note to a sketched symbol, but I get errors when adding geometry intent (commenting out the line adding the intent will add the leader but it is not attached) If I were just to add a leader manually to the sketchedsymbol and move around the symbol, this leader is attached a...

**Code Snippets (5):**

#### Code Block 1

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

Dim oSegment As DrawingCurveSegment
oSegment = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingCurveSegmentFilter, "Select an edge")

If oSegment is nothing then exit sub

Dim oSymbol As SketchedSymbol

Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

oSymbol = oActiveSheet.SketchedSymbols(1)

Dim oMidPoint As Point2d = oSymbol.Position

Dim SelectPt As Point2d = oSegment.Parent.MidPoint

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

Dim oGeometryIntent As GeometryIntent
oLeaderPoints.Add(oSymbol.Position)

oGeometryIntent = oActiveSheet.CreateGeometryIntent(oSegment.Parent)

Call oLeaderPoints.Add(oGeometryIntent)


'oSymbol.LeaderClipping = True
'oSymbol.LeaderVisible = True

Try
	oSymbol.Leader.AddLeader(oLeaderPoints)
Catch 
	'if the symbol already has a leader
	oSymbol.Leader.RootNode.AddLeader(oLeaderPoints)
End Try
```

#### Code Block 2

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

Dim oSegment As DrawingCurveSegment
oSegment = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingCurveSegmentFilter, "Select an edge")

If oSegment is nothing then exit sub

Dim oSymbol As SketchedSymbol

Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

oSymbol = oActiveSheet.SketchedSymbols(1)

Dim oMidPoint As Point2d = oSymbol.Position

Dim SelectPt As Point2d = oSegment.Parent.MidPoint

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

Dim oGeometryIntent As GeometryIntent
oLeaderPoints.Add(oSymbol.Position)

oGeometryIntent = oActiveSheet.CreateGeometryIntent(oSegment.Parent)

Call oLeaderPoints.Add(oGeometryIntent)


'oSymbol.LeaderClipping = True
'oSymbol.LeaderVisible = True

Try
	oSymbol.Leader.AddLeader(oLeaderPoints)
Catch 
	'if the symbol already has a leader
	oSymbol.Leader.RootNode.AddLeader(oLeaderPoints)
End Try
```

#### Code Block 3

```vb
Public Sub AddLeaderNotetestxx()
    Dim trg As TransientGeometry
    Set trg = ThisApplication.TransientGeometry
    
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.activeDocument
    
    Dim sk As SketchedSymbol
   
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrawDoc.ActiveSheet

    Set sk = oActiveSheet.SketchedSymbols(1).leader.Parent

    Dim oMidPoint As Point2d
    Set oMidPoint = sk.Position

    Dim oLeaderPoints As ObjectCollection
  
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection
    
    Dim oGeometryIntent As GeometryIntent
    Call oLeaderPoints.Add(trg.CreatePoint2d(oMidPoint.x + 5, oMidPoint.Y + 5))
    Call oLeaderPoints.Add(trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk.leader.Parent, trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    
    Call oLeaderPoints.Add(oGeometryIntent)

    Dim sText As String
    sText = "API Leader Note"

    Dim oLeaderNote As LeaderNote
    Set oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints, sText)
    
End Sub
```

#### Code Block 4

```vb
Public Sub AddLeaderNotetestxx()
    Dim trg As TransientGeometry
    Set trg = ThisApplication.TransientGeometry
    
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.activeDocument
    
    Dim sk As SketchedSymbol
   
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrawDoc.ActiveSheet

    Set sk = oActiveSheet.SketchedSymbols(1).leader.Parent

    Dim oMidPoint As Point2d
    Set oMidPoint = sk.Position

    Dim oLeaderPoints As ObjectCollection
  
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection
    
    Dim oGeometryIntent As GeometryIntent
    Call oLeaderPoints.Add(trg.CreatePoint2d(oMidPoint.x + 5, oMidPoint.Y + 5))
    Call oLeaderPoints.Add(trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk.leader.Parent, trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    
    Call oLeaderPoints.Add(oGeometryIntent)

    Dim sText As String
    sText = "API Leader Note"

    Dim oLeaderNote As LeaderNote
    Set oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints, sText)
    
End Sub
```

#### Code Block 5

```vb
Public Sub AddLeaderNotetestxx()
    Dim trg As TransientGeometry
    Set trg = ThisApplication.TransientGeometry
    
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.activeDocument
    
    Dim sk As SketchedSymbol
   
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrawDoc.ActiveSheet

    Set sk = oActiveSheet.SketchedSymbols(1).leader.Parent

    Dim oMidPoint As Point2d
    Set oMidPoint = sk.Position

    Dim oLeaderPoints As ObjectCollection
  
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection
    
    Dim oGeometryIntent As GeometryIntent
    Call oLeaderPoints.Add(trg.CreatePoint2d(oMidPoint.x + 5, oMidPoint.Y + 5))
    Call oLeaderPoints.Add(trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk.leader.Parent, trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    
    Call oLeaderPoints.Add(oGeometryIntent)

    Dim sText As String
    sText = "API Leader Note"

    Dim oLeaderNote As LeaderNote
    Set oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints, sText)
    
End Sub
```

#### Code Block 6

```vb
Public Sub AddLeaderNotetestxx()
    Dim trg As TransientGeometry
    Set trg = ThisApplication.TransientGeometry
    
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.activeDocument
    
    Dim sk As SketchedSymbol
   
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrawDoc.ActiveSheet

    Set sk = oActiveSheet.SketchedSymbols(1).leader.Parent

    Dim oMidPoint As Point2d
    Set oMidPoint = sk.Position

    Dim oLeaderPoints As ObjectCollection
  
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection
    
    Dim oGeometryIntent As GeometryIntent
    Call oLeaderPoints.Add(trg.CreatePoint2d(oMidPoint.x + 5, oMidPoint.Y + 5))
    Call oLeaderPoints.Add(trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk.leader.Parent, trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    
    Call oLeaderPoints.Add(oGeometryIntent)

    Dim sText As String
    sText = "API Leader Note"

    Dim oLeaderNote As LeaderNote
    Set oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints, sText)
    
End Sub
```

#### Code Block 7

```vb
Public Sub AddLeaderNotetestxx()
    Dim trg As TransientGeometry
    Set trg = ThisApplication.TransientGeometry
    
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.activeDocument
    
    Dim sk As SketchedSymbol
    Dim ds As DrawingSketch
   
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrawDoc.ActiveSheet

    Set sk = oActiveSheet.SketchedSymbols(1)
    Set ds = sk.Definition.Sketch
    
    Dim sl As SketchLine
    Set sl = ds.SketchLines(1)
    
    Dim oMidPoint As Point2d
    Set oMidPoint = ds.SketchToSheetSpace(sl.Geometry.StartPoint)

    Dim oLeaderPoints As ObjectCollection
  
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection
    
    Dim oGeometryIntent As GeometryIntent
    
    Call oLeaderPoints.Add(trg.CreatePoint2d(oMidPoint.x + 5, oMidPoint.Y + 5))
    Call oLeaderPoints.Add(trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, sk.leader.RootNode.Position)
'also tried
' Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, omidpoint)
' Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1) (this is the start point of the line on the sheetpace)
    
    Call oLeaderPoints.Add(oGeometryIntent)

    Dim sText As String
    sText = "API Leader Note"
    

    Dim oLeaderNote As LeaderNote
    Set oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints, sText)
    
End Sub
```

#### Code Block 8

```vb
Public Sub AddLeaderNotetestxx()
    Dim trg As TransientGeometry
    Set trg = ThisApplication.TransientGeometry
    
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.activeDocument
    
    Dim sk As SketchedSymbol
    Dim ds As DrawingSketch
   
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrawDoc.ActiveSheet

    Set sk = oActiveSheet.SketchedSymbols(1)
    Set ds = sk.Definition.Sketch
    
    Dim sl As SketchLine
    Set sl = ds.SketchLines(1)
    
    Dim oMidPoint As Point2d
    Set oMidPoint = ds.SketchToSheetSpace(sl.Geometry.StartPoint)

    Dim oLeaderPoints As ObjectCollection
  
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection
    
    Dim oGeometryIntent As GeometryIntent
    
    Call oLeaderPoints.Add(trg.CreatePoint2d(oMidPoint.x + 5, oMidPoint.Y + 5))
    Call oLeaderPoints.Add(trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, sk.leader.RootNode.Position)
'also tried
' Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, omidpoint)
' Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1) (this is the start point of the line on the sheetpace)
    
    Call oLeaderPoints.Add(oGeometryIntent)

    Dim sText As String
    sText = "API Leader Note"
    

    Dim oLeaderNote As LeaderNote
    Set oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints, sText)
    
End Sub
```

#### Code Block 9

```vb
Public Sub AddLeaderNotetestxx()
    Dim trg As TransientGeometry
    Set trg = ThisApplication.TransientGeometry
    
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.activeDocument
    
    Dim sk As SketchedSymbol
    Dim ds As DrawingSketch
   
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrawDoc.ActiveSheet

    Set sk = oActiveSheet.SketchedSymbols(1)
    Set ds = sk.Definition.Sketch
    
    Dim sl As SketchLine
    Set sl = ds.SketchLines(1)
    
    Dim oMidPoint As Point2d
    Set oMidPoint = ds.SketchToSheetSpace(sl.Geometry.StartPoint)

    Dim oLeaderPoints As ObjectCollection
  
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection
    
    Dim oGeometryIntent As GeometryIntent
    
    Call oLeaderPoints.Add(trg.CreatePoint2d(oMidPoint.x + 5, oMidPoint.Y + 5))
    Call oLeaderPoints.Add(trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, sk.leader.RootNode.Position)
'also tried
' Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, omidpoint)
' Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1) (this is the start point of the line on the sheetpace)
    
    Call oLeaderPoints.Add(oGeometryIntent)

    Dim sText As String
    sText = "API Leader Note"
    

    Dim oLeaderNote As LeaderNote
    Set oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints, sText)
    
End Sub
```

#### Code Block 10

```vb
Public Sub AddLeaderNotetestxx()
    Dim trg As TransientGeometry
    Set trg = ThisApplication.TransientGeometry
    
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.activeDocument
    
    Dim sk As SketchedSymbol
    Dim ds As DrawingSketch
   
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrawDoc.ActiveSheet

    Set sk = oActiveSheet.SketchedSymbols(1)
    Set ds = sk.Definition.Sketch
    
    Dim sl As SketchLine
    Set sl = ds.SketchLines(1)
    
    Dim oMidPoint As Point2d
    Set oMidPoint = ds.SketchToSheetSpace(sl.Geometry.StartPoint)

    Dim oLeaderPoints As ObjectCollection
  
    Set oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection
    
    Dim oGeometryIntent As GeometryIntent
    
    Call oLeaderPoints.Add(trg.CreatePoint2d(oMidPoint.x + 5, oMidPoint.Y + 5))
    Call oLeaderPoints.Add(trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1))
    Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, sk.leader.RootNode.Position)
'also tried
' Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, omidpoint)
' Set oGeometryIntent = oActiveSheet.CreateGeometryIntent(sk, trg.CreatePoint2d(sk.Position.x, sk.Position.Y + 1.1) (this is the start point of the line on the sheetpace)
    
    Call oLeaderPoints.Add(oGeometryIntent)

    Dim sText As String
    sText = "API Leader Note"
    

    Dim oLeaderNote As LeaderNote
    Set oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints, sText)
    
End Sub
```

---

### 12. Auto Ordinate Dimensions

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/auto-ordinate-dimensions/td-p/8275718#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/auto-ordinate-dimensions/td-p/8275718#messageview_0)

**Author:** Anonymous

**Date:** ‎09-18-2018
	
		
		07:41 AM

**Description:** I'm trying to use iLogic or VBA to add ordinate dimensions to a drawing. This picture explains it. Here is the code I'm working with so far. Dim oDrawDoc As DrawingDocumentoDrawDoc = ThisApplication.ActiveDocumentDim oActiveSheet As SheetoActiveSheet = oDrawDoc.ActiveSheetDim oIntentCollection As Ob...

**Code Snippets (6):**

#### Code Block 1

```vb
' Taken from the inventor APIOrdinateDimensions.Add( Intent As GeometryIntent, TextOrigin As Point2d, DimensionType As DimensionTypeEnum, [DimensionStyle] As Variant, [Layer] As Variant ) As OrdinateDimension
```

#### Code Block 2

```vb
Public Sub Main()
    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.ActiveDocument
    
    ' Set a reference to the active sheet.
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrawDoc.ActiveSheet
    
    '   a reference to the drawing curve segment.
    ' This assumes that a linear drawing curve is selected.
    Dim oDrawingCurveSegment As DrawingCurveSegment
    Set oDrawingCurveSegment = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingCurveSegmentFilter, "Select start line to start ordinate dimension")
    
    '   a reference to the drawing curve.
    Dim oDrawingCurve As DrawingCurve
    Set oDrawingCurve = oDrawingCurveSegment.Parent
    
    
    If Not oDrawingCurve.CurveType = CurveTypeEnum.kLineSegmentCurve Then
        MsgBox ("A linear curve should be selected for this sample.")
    Exit Sub
    End If
    
    ' Create point intents to anchor the dimension to.
    Dim oDimIntent  As GeometryIntent
    Set oDimIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kEndPointIntent)
    
    '   a reference to the view to which the curve belongs.
    Dim oDrawingView As DrawingView
    Set oDrawingView = oDrawingCurve.Parent
    
    ' If origin indicator has not been already created, create it first.
    If Not oDrawingView.HasOriginIndicator Then
        ' The indicator will be located at the start point of the selected curve.
        Call oDrawingView.CreateOriginIndicator(oDimIntent)
    End If
    
    '   a reference to the ordinate dimensions collection.
    Dim oOrdinateDimensions As OrdinateDimensions
    Set oOrdinateDimensions = oActiveSheet.DrawingDimensions.OrdinateDimensions
    
    Dim oTextOrigin  As Point2d
    Dim DimType As DimensionTypeEnum
    
    ' Selected curve is vertical or at an angle.
    DimType = DimensionTypeEnum.kHorizontalDimensionType
    
    '   the text points for the 2 dimensions.
    Set oTextOrigin = ThisApplication.TransientGeometry.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.StartPoint.Y)
    
    ' Create the first ordinate dimension.
    Dim oOrdinateDimension1 As OrdinateDimension
    Set oOrdinateDimension1 = oOrdinateDimensions.Add(oDimIntent, oTextOrigin, DimType)

    
    For Each oDrawingCurve In oDrawingView.DrawingCurves
    If oDrawingCurve.CurveType = kCircleCurve Then
        Dim oIntent As GeometryIntent
        Set oIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kCenterPointIntent)
        
        Dim origin As Point2d
        Set origin = ThisApplication.TransientGeometry.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.CenterPoint.Y)
        
        Call oOrdinateDimensions.Add(oIntent, origin, DimType)
    End If
    Next
    
    Set oDrawingCurveSegment = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select end line to complete ordinate dimension")
    
    Set oDrawingCurve = oDrawingCurveSegment.Parent
    
    If Not oDrawingCurve.CurveType = kLineSegmentCurve Then
        MsgBox ("A linear curve should be selected for this sample.")
        Exit Sub
    End If
    
    Set oDimIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kEndPointIntent)
    
    Set oTextOrigin = ThisApplication.TransientGeometry.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.StartPoint.Y)
    
    Call oOrdinateDimensions.Add(oDimIntent, oTextOrigin, DimType)
  
End Sub
```

#### Code Block 3

```vb
Public Sub Main()
    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.ActiveDocument
    
    ' Set a reference to the active sheet.
    Dim oActiveSheet As Sheet
    Set oActiveSheet = oDrawDoc.ActiveSheet
    
    Dim oDoc As Document
    Set oDoc = oActiveSheet.DrawingViews.Item(1).ReferencedDocumentDescriptor.ReferencedDocument
    
    If oDoc.DocumentType = kAssemblyDocumentObject Then
    
        '   a reference to the drawing curve segment.
        ' This assumes that a linear drawing curve is selected.
        Dim oDrawingCurveSegment As DrawingCurveSegment
        Set oDrawingCurveSegment = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingCurveSegmentFilter, "Select start line to find occurrence")
        
        '   a reference to the drawing curve.
        Dim oDrawingCurve As DrawingCurve
        Set oDrawingCurve = oDrawingCurveSegment.Parent
        
        Dim oReferDef As AssemblyComponentDefinition
        Set oReferDef = oDoc.ComponentDefinition
        
        Dim pt As WorkPoint
        Set pt = oReferDef.WorkPoints.Item(1)
        
        Call oActiveSheet.DrawingViews.Item(1).SetIncludeStatus(pt, True)
        
        If Not oDrawingCurve.CurveType = CurveTypeEnum.kLineSegmentCurve Then
            MsgBox ("A linear curve should be selected for this sample.")
            Exit Sub
        End If
        
        Dim oCenterMark As Centermark
        Set oCenterMark = oActiveSheet.Centermarks.Item(oActiveSheet.Centermarks.Count)
        ' Create point intents to anchor the dimension to.
        Dim oDimIntent  As GeometryIntent
        Set oDimIntent = oActiveSheet.CreateGeometryIntent(oCenterMark, kCenterPointIntent)
        
        '   a reference to the view to which the curve belongs.
        Dim oDrawingView As DrawingView
        Set oDrawingView = oDrawingCurve.Parent
        
        ' If origin indicator has not been already created, create it first.
        If Not oDrawingView.HasOriginIndicator Then
            ' The indicator will be located at the start point of the selected curve.
            Call oDrawingView.CreateOriginIndicator(oDimIntent)
        End If
        
        '   a reference to the ordinate dimensions collection.
        Dim oOrdinateDimensions As OrdinateDimensions
        Set oOrdinateDimensions = oActiveSheet.DrawingDimensions.OrdinateDimensions
        
        Dim oTextOrigin  As Point2d
        Dim DimType As DimensionTypeEnum
        
        ' Selected curve is vertical or at an angle.
        DimType = DimensionTypeEnum.kVerticalDimensionType
        
        '   the text points for the 2 dimensions.
        
        Set oTextOrigin = ThisApplication.TransientGeometry.CreatePoint2d(oCenterMark.Position.X, oCenterMark.Position.Y - 2)
        
        ' Create the first ordinate dimension.
        Dim oOrdinateDimension1 As OrdinateDimension
        Set oOrdinateDimension1 = oOrdinateDimensions.Add(oDimIntent, oTextOrigin, DimType)
        
        Dim LArray() As String
        LArray = Split(oDrawingCurve.ModelGeometry.ContainingOccurrence.Name, ":")
        
        Dim occ As ComponentOccurrence
        For Each occ In oReferDef.Occurrences
            Dim occName() As String
            occName = Split(occ.Name, ":")
            If occName(0) = LArray(0) Then
                Set pt = occ.Definition.WorkPoints.Item(1)
                
                Dim oProxy As WorkPointProxy
                Call occ.CreateGeometryProxy(pt, oProxy)
                
                Call oActiveSheet.DrawingViews.Item(1).SetIncludeStatus(oProxy, True)
                
                Set oCenterMark = oActiveSheet.Centermarks.Item(oActiveSheet.Centermarks.Count)
                
                Dim oIntent As GeometryIntent
                Set oIntent = oActiveSheet.CreateGeometryIntent(oCenterMark, kCenterPointIntent)
                
                Dim origin As Point2d
                Set origin = ThisApplication.TransientGeometry.CreatePoint2d(oCenterMark.Position.X, oCenterMark.Position.Y - 2)
                
                Call oOrdinateDimensions.Add(oIntent, origin, DimType)
            End If
        Next
         
    
    Else
        MsgBox ("Referenced document is not an assembly document")
    End If
  
End Sub
```

#### Code Block 4

```vb
Public Sub Main()
  ' Set a reference to the drawing document.
  ' This assumes a drawing document is active.
  Dim oDrawDoc As DrawingDocument
    oDrawDoc = ThisApplication.ActiveDocument

  ' Set a reference to the active sheet.
  Dim oActiveSheet As Sheet
    oActiveSheet = oDrawDoc.ActiveSheet

  '   a reference to the drawing curve segment.
  ' This assumes that a linear drawing curve is selected.
  Dim oDrawingCurveSegment As DrawingCurveSegment
    oDrawingCurveSegment = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select start line to start ordinate dimension")

  '   a reference to the drawing curve.
  Dim oDrawingCurve As DrawingCurve
    oDrawingCurve = oDrawingCurveSegment.Parent

  If Not oDrawingCurve.CurveType = kLineSegmentCurve Then
    MsgBox ("A linear curve should be selected for this sample.")
    Exit Sub
  End If

  ' Create point intents to anchor the dimension to.
  Dim oDimIntent  As GeometryIntent
    oDimIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kEndPointIntent)

  '   a reference to the view to which the curve belongs.
  Dim oDrawingView As DrawingView
    oDrawingView = oDrawingCurve.Parent

  ' If origin indicator has not been already created, create it first.
  If Not oDrawingView.HasOriginIndicator Then
    ' The indicator will be located at the start point of the selected curve.
    oDrawingView.CreateOriginIndicator (oDimIntent)
  End If

  '   a reference to the ordinate dimensions collection.
  Dim oOrdinateDimensions As OrdinateDimensions
    oOrdinateDimensions = oActiveSheet.DrawingDimensions.OrdinateDimensions

  Dim oTextOrigin  As Point2d
  Dim DimType As DimensionTypeEnum
  
  ' Selected curve is vertical or at an angle.
  DimType = kHorizontalDimensionType
    
  '   the text points for the 2 dimensions.
    oTextOrigin = ThisApplication.TransientGeometry.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.StartPoint.Y)
 
  ' Create the first ordinate dimension.
  Call oOrdinateDimensions.Add(oDimIntent, oTextOrigin, DimType)
  
  For Each oDrawingCurve In oDrawingView.DrawingCurves
    If oDrawingCurve.CurveType = kCircleCurve Then
        Dim oIntent As GeometryIntent
          oIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kCenterPointIntent)
        
        Dim origin As Point2d
          origin = ThisApplication.TransientGeometry.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.CenterPoint.Y)
        
        Call oOrdinateDimensions.Add(oIntent, origin, DimType)
    End If
  Next
  
    oDrawingCurveSegment = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select end line to complete ordinate dimension")
  
    oDrawingCurve = oDrawingCurveSegment.Parent
  
  If Not oDrawingCurve.CurveType = kLineSegmentCurve Then
    MsgBox ("A linear curve should be selected for this sample.")
    Exit Sub
  End If
  
    oDimIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kEndPointIntent)
  
    oTextOrigin = ThisApplication.TransientGeometry.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.StartPoint.Y)
  
  Call oOrdinateDimensions.Add(oDimIntent, oTextOrigin, DimType)
  
End Sub
```

#### Code Block 5

```vb
Sub Main()
	
	Dim oDrawDoc As DrawingDocument
	oDrawDoc = ThisApplication.ActiveDocument
	
	Dim oActiveSheet As Sheet
	oActiveSheet = oDrawDoc.ActiveSheet
	
	Dim oTG As TransientGeometry
	oTG = ThisApplication.TransientGeometry
	
	Dim oDimIntent As GeometryIntent

	Dim Entity As DrawingCurveSegment
	Entity = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingCurveSegmentFilter, "Select a kDrawingCurveSegmentFilter")
	
	' Get all the selected drawing curve segments.
	Dim oDrawingCurve As DrawingCurve
	oDrawingCurve = Entity.Parent
	
	Dim oDrawingView As DrawingView
	oDrawingView = oDrawingCurve.Parent
	
	Dim oDCE As DrawingCurvesEnumerator
	oDCE = oDrawingView.DrawingCurves()
	
	Dim oODS As OrdinateDimensions
	oODS = oActiveSheet.DrawingDimensions.OrdinateDimensions
	
	Dim oOD As OrdinateDimension
	
	Dim j As Integer
	Dim CurveTypeCount(3) As Integer
	CurveTypeCount(1)=0
	CurveTypeCount(2)=0
	CurveTypeCount(3)=0
		
	For j = 1 To oDCE.Count()
	
		oDrawingCurve = oDCE.Item(j)
		
		Select Case oDrawingCurve.ProjectedCurveType()
			Case 5252 'kCircleCurve2d 
				CurveTypeCount(1)=CurveTypeCount(1) + 1
			Case 5253 'kCircularArcCurve2d 
				CurveTypeCount(2)=CurveTypeCount(2) + 1
			Case 5251 'kLineSegmentCurve2d 
				CurveTypeCount(3)=CurveTypeCount(3) + 1
		End Select
		
		If oDrawingCurve.ProjectedCurveType() = 5252  Then'kCircleCurve2d
			
			MessageBox.Show("oDrawingCurve.Type())" & oDrawingCurve.Type(), "kCircleCurve2d") ' kDrawingCurveObject 
			
			oDimIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, oDrawingCurve)

			Dim oTextOrigin1 As Point2d
			oTextOrigin1 = oTG.CreatePoint2d(5, 5)
			MessageBox.Show("oTextOrigin1 initialized")
			
			oOD = oODS.Add( kCenterPointIntent, oTextOrigin1, kHorizontalDimensionType)
			MessageBox.Show("HURRAY IT WORKED!!!!!!!!!!!!")
		End If
	Next
End Sub
```

#### Code Block 6

```vb
oOD = oODS.Add( kCenterPointIntent, oTextOrigin1, kHorizontalDimensionType)
```

---

### 13. Auto ballooning a drawing - Attach balloon to DrawingCurveSegment

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/auto-ballooning-a-drawing-attach-balloon-to-drawingcurvesegment/td-p/10096249](https://forums.autodesk.com/t5/inventor-programming-forum/auto-ballooning-a-drawing-attach-balloon-to-drawingcurvesegment/td-p/10096249)

**Author:** j.haggenjos

**Date:** ‎02-19-2021
	
		
		06:18 AM

**Description:** Hello all, I am trying to create a macro that will automatically create all balloons for a selected view. The simplified logic is the following: For each item in the partslist, find the longest DrawingCurve in the view and attach a balloon to it. Depending if it's a circle or not, I create the attac...

**Code Snippets (22):**

#### Code Block 1

```vb
Imports Inventor
Module AutoBalloon
#Region "Auto Balloon"
    Private ReadOnly Property _blnViewMargin As Double = 2
    Private ReadOnly Property _blnVerticalOffset As Double = 0.9
    Private ReadOnly Property _blnHorizontalOffset As Double = 1
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
    Friend Sub AddBallonToView(View As DrawingView)
        Dim PartsList As PartsList = View.Parent.PartsLists.Item(1)
        InitialiseViewBoundingBox(View)
        For Each row As PartsListRow In PartsList.PartsListRows
            If Not row.Ballooned Then CreateRowItemBalloon(row, View)
        Next
        ArrangeBalloonsOnView(View)
    End Sub
    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TransGeom As TransientGeometry = InventorApplication.TransientGeometry
        Dim TopLeft As Point2d, TopRight As Point2d, BtmLeft As Point2d, BtmRight As Point2d
        TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)
    End Sub
    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim TransGeom As TransientGeometry = InventorApplication.TransientGeometry
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub
        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        Dim LeaderPoints As ObjectCollection = InventorApplication.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub
    Private Sub ArrangeBalloonsOnView(View As DrawingView)
        Dim leftBalloon As New List(Of Balloon)
        Dim rightBalloon As New List(Of Balloon)
        Dim topBalloon As New List(Of Balloon)
        Dim btmBalloon As New List(Of Balloon)
        For Each balloon As Balloon In View.Parent.Balloons
            If balloon.ParentView Is View Then
                If balloon.Position.X = View.Left - _blnViewMargin Then
                    leftBalloon.Add(balloon)
                ElseIf balloon.Position.X = View.Left + View.Width + _blnViewMargin Then
                    rightBalloon.Add(balloon)
                ElseIf balloon.Position.Y = View.Top + _blnViewMargin Then
                    topBalloon.Add(balloon)
                ElseIf balloon.Position.Y = View.Top - View.Height - _blnViewMargin Then
                    btmBalloon.Add(balloon)
                End If
            End If
        Next
        If leftBalloon.Count > 1 Then ArrangeBalloonVerticaly(leftBalloon)
        If rightBalloon.Count > 1 Then ArrangeBalloonVerticaly(rightBalloon)
        If topBalloon.Count > 1 Then ArrangeBalloonHorizontaly(topBalloon)
        If btmBalloon.Count > 1 Then ArrangeBalloonHorizontaly(btmBalloon)
    End Sub
    Private Sub ArrangeBalloonVerticaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.Y.CompareTo(x.Position.Y))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.Y - ballons(index).Position.Y < _blnVerticalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.Y = ballons(index - 1).Position.Y - _blnVerticalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Sub ArrangeBalloonHorizontaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.X.CompareTo(x.Position.X))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.X - ballons(index).Position.X < _blnHorizontalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.X = ballons(index - 1).Position.X - _blnHorizontalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d

        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double
        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Quadrant not Found"
                Return Nothing
        End Select
        Return leaderPoint
    End Function
    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView)
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle Or PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function
    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim itemOccurrences As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim OccurrencesCurves As List(Of DrawingCurve) = GetCurvesFromOcc(itemOccurrences, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(OccurrencesCurves))
    End Function
#End Region
#Region "Curves analysis methods"
    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim Curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not Curves.Contains(curve) Then Curves.Add(curve)
                Next
            End If
        Next
        Return Curves
    End Function
    Private Function GetBestSegmentFromOccurrence(OccurrenceCurves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0, bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In OccurrenceCurves
            Dim rating As Double
            Dim bestInCurve As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then bestSegment = bestInCurve : bestRating = rating
        Next
        Return bestSegment
    End Function
    Private Function GetBestSegmentFromCurve(Curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In Curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            Dim segmentPoints As List(Of Point2d) = SplitSegment(segment, 10)
            Dim closestDist As Double = Double.PositiveInfinity
            Dim distanceSum As Double = 0
            For Each point As Point2d In segmentPoints
                Dim pointDist As Double = DistanceToViewRangeBox(point, Curve.Parent)
                If pointDist < closestDist Then closestDist = pointDist
                distanceSum += pointDist
            Next
            Dim avgDistance = distanceSum / segmentPoints.Count
            Dim rating As Double = segLength ' / (avgDistance * closestDist ^ 2)
            If Curve.EdgeType = DrawingEdgeTypeEnum.kTangentEdge Then rating /= 10
            If rating > segmentRating Then bestSegment = segment : segmentRating = rating
        Next
        Return bestSegment
    End Function
    Private Function SplitSegment(Segment As DrawingCurveSegment, SplitPrecision As Integer) As List(Of Point2d)
        Dim pointList As New List(Of Point2d), MinParam, MaxParam As Double, TransGeom As TransientGeometry
        TransGeom = InventorApplication.TransientGeometry
        Segment.Geometry.Evaluator.GetParamExtents(MinParam, MaxParam)
        For i = 0 To SplitPrecision
            Dim pCoordinate(0 To 1) As Double
            Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision}, pCoordinate)
            pointList.Add(TransGeom.CreatePoint2d(pCoordinate(0), pCoordinate(1)))
        Next
        Return pointList
    End Function
    Private Function DistanceToViewRangeBox(TestPoint As Point2d, DView As DrawingView) As Double

        Dim shortest As Double = _topLine.DistanceTo(TestPoint)
        Dim dist As Double = _btmLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        Return shortest
    End Function
    Private Function GetSegmentLength(Segment As DrawingCurveSegment) As Double
        Select Case Segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return Segment.EndPoint.DistanceTo(Segment.StartPoint)
            Case Else
                Return GetCurveLength(Segment.Geometry.Evaluator)
        End Select
    End Function
    Private Function GetSegmentMidPoint(Segment As DrawingCurveSegment) As Point2d
        Dim CurveEval As Curve2dEvaluator = Segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), midPointCoordinates(1), curveLength As Double
        CurveEval.GetParamExtents(minParam, maxParam)
        CurveEval.GetLengthAtParam(minParam, maxParam, curveLength)
        CurveEval.GetParamAtLength(minParam, curveLength / 2, midParam(0))
        CurveEval.GetPointAtParam(midParam, midPointCoordinates)
        Return InventorApplication.TransientGeometry.CreatePoint2d(midPointCoordinates(0), midPointCoordinates(1))
    End Function
    Private Function GetCurveLength(Eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, curveLength As Double
        Eval.GetParamExtents(minParam, maxParam)
        Eval.GetLengthAtParam(minParam, maxParam, curveLength)
        Return curveLength
    End Function
    Private Function GetAttachPoint(Segment As DrawingCurveSegment) As GeometryIntent
        If Segment Is Nothing Then Return Nothing
        Dim DrawingSheet As Sheet = Segment.Parent.Parent.Parent
        If Segment.GeometryType = Curve2dTypeEnum.kCircleCurve2d Or Segment.GeometryType = Curve2dTypeEnum.kEllipseFullCurve2d Then
            Select Case GetQuadrant(Segment.Geometry.Center, Segment.Parent.Parent)
                Case "Top"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularTopPointIntent)
                Case "Bottom"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularBottomPointIntent)
                Case "Left"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularLeftPointIntent)
                Case "Right"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularRightPointIntent)
                Case "Quadrant not Found"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCenterPointIntent)
            End Select
        End If
        Return DrawingSheet.CreateGeometryIntent(Segment.Parent, GetSegmentMidPoint(Segment))
    End Function
#End Region
End Module
```

#### Code Block 2

```vb
Imports Inventor
Module AutoBalloon
#Region "Auto Balloon"
    Private ReadOnly Property _blnViewMargin As Double = 2
    Private ReadOnly Property _blnVerticalOffset As Double = 0.9
    Private ReadOnly Property _blnHorizontalOffset As Double = 1
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
    Friend Sub AddBallonToView(View As DrawingView)
        Dim PartsList As PartsList = View.Parent.PartsLists.Item(1)
        InitialiseViewBoundingBox(View)
        For Each row As PartsListRow In PartsList.PartsListRows
            If Not row.Ballooned Then CreateRowItemBalloon(row, View)
        Next
        ArrangeBalloonsOnView(View)
    End Sub
    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TransGeom As TransientGeometry = InventorApplication.TransientGeometry
        Dim TopLeft As Point2d, TopRight As Point2d, BtmLeft As Point2d, BtmRight As Point2d
        TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)
    End Sub
    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim TransGeom As TransientGeometry = InventorApplication.TransientGeometry
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub
        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        Dim LeaderPoints As ObjectCollection = InventorApplication.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub
    Private Sub ArrangeBalloonsOnView(View As DrawingView)
        Dim leftBalloon As New List(Of Balloon)
        Dim rightBalloon As New List(Of Balloon)
        Dim topBalloon As New List(Of Balloon)
        Dim btmBalloon As New List(Of Balloon)
        For Each balloon As Balloon In View.Parent.Balloons
            If balloon.ParentView Is View Then
                If balloon.Position.X = View.Left - _blnViewMargin Then
                    leftBalloon.Add(balloon)
                ElseIf balloon.Position.X = View.Left + View.Width + _blnViewMargin Then
                    rightBalloon.Add(balloon)
                ElseIf balloon.Position.Y = View.Top + _blnViewMargin Then
                    topBalloon.Add(balloon)
                ElseIf balloon.Position.Y = View.Top - View.Height - _blnViewMargin Then
                    btmBalloon.Add(balloon)
                End If
            End If
        Next
        If leftBalloon.Count > 1 Then ArrangeBalloonVerticaly(leftBalloon)
        If rightBalloon.Count > 1 Then ArrangeBalloonVerticaly(rightBalloon)
        If topBalloon.Count > 1 Then ArrangeBalloonHorizontaly(topBalloon)
        If btmBalloon.Count > 1 Then ArrangeBalloonHorizontaly(btmBalloon)
    End Sub
    Private Sub ArrangeBalloonVerticaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.Y.CompareTo(x.Position.Y))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.Y - ballons(index).Position.Y < _blnVerticalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.Y = ballons(index - 1).Position.Y - _blnVerticalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Sub ArrangeBalloonHorizontaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.X.CompareTo(x.Position.X))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.X - ballons(index).Position.X < _blnHorizontalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.X = ballons(index - 1).Position.X - _blnHorizontalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d

        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double
        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Quadrant not Found"
                Return Nothing
        End Select
        Return leaderPoint
    End Function
    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView)
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle Or PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function
    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim itemOccurrences As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim OccurrencesCurves As List(Of DrawingCurve) = GetCurvesFromOcc(itemOccurrences, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(OccurrencesCurves))
    End Function
#End Region
#Region "Curves analysis methods"
    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim Curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not Curves.Contains(curve) Then Curves.Add(curve)
                Next
            End If
        Next
        Return Curves
    End Function
    Private Function GetBestSegmentFromOccurrence(OccurrenceCurves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0, bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In OccurrenceCurves
            Dim rating As Double
            Dim bestInCurve As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then bestSegment = bestInCurve : bestRating = rating
        Next
        Return bestSegment
    End Function
    Private Function GetBestSegmentFromCurve(Curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In Curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            Dim segmentPoints As List(Of Point2d) = SplitSegment(segment, 10)
            Dim closestDist As Double = Double.PositiveInfinity
            Dim distanceSum As Double = 0
            For Each point As Point2d In segmentPoints
                Dim pointDist As Double = DistanceToViewRangeBox(point, Curve.Parent)
                If pointDist < closestDist Then closestDist = pointDist
                distanceSum += pointDist
            Next
            Dim avgDistance = distanceSum / segmentPoints.Count
            Dim rating As Double = segLength ' / (avgDistance * closestDist ^ 2)
            If Curve.EdgeType = DrawingEdgeTypeEnum.kTangentEdge Then rating /= 10
            If rating > segmentRating Then bestSegment = segment : segmentRating = rating
        Next
        Return bestSegment
    End Function
    Private Function SplitSegment(Segment As DrawingCurveSegment, SplitPrecision As Integer) As List(Of Point2d)
        Dim pointList As New List(Of Point2d), MinParam, MaxParam As Double, TransGeom As TransientGeometry
        TransGeom = InventorApplication.TransientGeometry
        Segment.Geometry.Evaluator.GetParamExtents(MinParam, MaxParam)
        For i = 0 To SplitPrecision
            Dim pCoordinate(0 To 1) As Double
            Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision}, pCoordinate)
            pointList.Add(TransGeom.CreatePoint2d(pCoordinate(0), pCoordinate(1)))
        Next
        Return pointList
    End Function
    Private Function DistanceToViewRangeBox(TestPoint As Point2d, DView As DrawingView) As Double

        Dim shortest As Double = _topLine.DistanceTo(TestPoint)
        Dim dist As Double = _btmLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        Return shortest
    End Function
    Private Function GetSegmentLength(Segment As DrawingCurveSegment) As Double
        Select Case Segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return Segment.EndPoint.DistanceTo(Segment.StartPoint)
            Case Else
                Return GetCurveLength(Segment.Geometry.Evaluator)
        End Select
    End Function
    Private Function GetSegmentMidPoint(Segment As DrawingCurveSegment) As Point2d
        Dim CurveEval As Curve2dEvaluator = Segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), midPointCoordinates(1), curveLength As Double
        CurveEval.GetParamExtents(minParam, maxParam)
        CurveEval.GetLengthAtParam(minParam, maxParam, curveLength)
        CurveEval.GetParamAtLength(minParam, curveLength / 2, midParam(0))
        CurveEval.GetPointAtParam(midParam, midPointCoordinates)
        Return InventorApplication.TransientGeometry.CreatePoint2d(midPointCoordinates(0), midPointCoordinates(1))
    End Function
    Private Function GetCurveLength(Eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, curveLength As Double
        Eval.GetParamExtents(minParam, maxParam)
        Eval.GetLengthAtParam(minParam, maxParam, curveLength)
        Return curveLength
    End Function
    Private Function GetAttachPoint(Segment As DrawingCurveSegment) As GeometryIntent
        If Segment Is Nothing Then Return Nothing
        Dim DrawingSheet As Sheet = Segment.Parent.Parent.Parent
        If Segment.GeometryType = Curve2dTypeEnum.kCircleCurve2d Or Segment.GeometryType = Curve2dTypeEnum.kEllipseFullCurve2d Then
            Select Case GetQuadrant(Segment.Geometry.Center, Segment.Parent.Parent)
                Case "Top"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularTopPointIntent)
                Case "Bottom"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularBottomPointIntent)
                Case "Left"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularLeftPointIntent)
                Case "Right"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularRightPointIntent)
                Case "Quadrant not Found"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCenterPointIntent)
            End Select
        End If
        Return DrawingSheet.CreateGeometryIntent(Segment.Parent, GetSegmentMidPoint(Segment))
    End Function
#End Region
End Module
```

#### Code Block 3

```vb
Imports Inventor
Module AutoBalloon
#Region "Auto Balloon"
    Private ReadOnly Property _blnViewMargin As Double = 2
    Private ReadOnly Property _blnVerticalOffset As Double = 0.9
    Private ReadOnly Property _blnHorizontalOffset As Double = 1
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
    Friend Sub AddBallonToView(View As DrawingView)
        Dim PartsList As PartsList = View.Parent.PartsLists.Item(1)
        InitialiseViewBoundingBox(View)
        For Each row As PartsListRow In PartsList.PartsListRows
            If Not row.Ballooned Then CreateRowItemBalloon(row, View)
        Next
        ArrangeBalloonsOnView(View)
    End Sub
    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TransGeom As TransientGeometry = InventorApplication.TransientGeometry
        Dim TopLeft As Point2d, TopRight As Point2d, BtmLeft As Point2d, BtmRight As Point2d
        TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)
    End Sub
    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim TransGeom As TransientGeometry = InventorApplication.TransientGeometry
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub
        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        Dim LeaderPoints As ObjectCollection = InventorApplication.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub
    Private Sub ArrangeBalloonsOnView(View As DrawingView)
        Dim leftBalloon As New List(Of Balloon)
        Dim rightBalloon As New List(Of Balloon)
        Dim topBalloon As New List(Of Balloon)
        Dim btmBalloon As New List(Of Balloon)
        For Each balloon As Balloon In View.Parent.Balloons
            If balloon.ParentView Is View Then
                If balloon.Position.X = View.Left - _blnViewMargin Then
                    leftBalloon.Add(balloon)
                ElseIf balloon.Position.X = View.Left + View.Width + _blnViewMargin Then
                    rightBalloon.Add(balloon)
                ElseIf balloon.Position.Y = View.Top + _blnViewMargin Then
                    topBalloon.Add(balloon)
                ElseIf balloon.Position.Y = View.Top - View.Height - _blnViewMargin Then
                    btmBalloon.Add(balloon)
                End If
            End If
        Next
        If leftBalloon.Count > 1 Then ArrangeBalloonVerticaly(leftBalloon)
        If rightBalloon.Count > 1 Then ArrangeBalloonVerticaly(rightBalloon)
        If topBalloon.Count > 1 Then ArrangeBalloonHorizontaly(topBalloon)
        If btmBalloon.Count > 1 Then ArrangeBalloonHorizontaly(btmBalloon)
    End Sub
    Private Sub ArrangeBalloonVerticaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.Y.CompareTo(x.Position.Y))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.Y - ballons(index).Position.Y < _blnVerticalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.Y = ballons(index - 1).Position.Y - _blnVerticalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Sub ArrangeBalloonHorizontaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.X.CompareTo(x.Position.X))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.X - ballons(index).Position.X < _blnHorizontalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.X = ballons(index - 1).Position.X - _blnHorizontalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d

        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double
        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Quadrant not Found"
                Return Nothing
        End Select
        Return leaderPoint
    End Function
    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView)
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle Or PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function
    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim itemOccurrences As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim OccurrencesCurves As List(Of DrawingCurve) = GetCurvesFromOcc(itemOccurrences, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(OccurrencesCurves))
    End Function
#End Region
#Region "Curves analysis methods"
    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim Curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not Curves.Contains(curve) Then Curves.Add(curve)
                Next
            End If
        Next
        Return Curves
    End Function
    Private Function GetBestSegmentFromOccurrence(OccurrenceCurves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0, bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In OccurrenceCurves
            Dim rating As Double
            Dim bestInCurve As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then bestSegment = bestInCurve : bestRating = rating
        Next
        Return bestSegment
    End Function
    Private Function GetBestSegmentFromCurve(Curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In Curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            Dim segmentPoints As List(Of Point2d) = SplitSegment(segment, 10)
            Dim closestDist As Double = Double.PositiveInfinity
            Dim distanceSum As Double = 0
            For Each point As Point2d In segmentPoints
                Dim pointDist As Double = DistanceToViewRangeBox(point, Curve.Parent)
                If pointDist < closestDist Then closestDist = pointDist
                distanceSum += pointDist
            Next
            Dim avgDistance = distanceSum / segmentPoints.Count
            Dim rating As Double = segLength ' / (avgDistance * closestDist ^ 2)
            If Curve.EdgeType = DrawingEdgeTypeEnum.kTangentEdge Then rating /= 10
            If rating > segmentRating Then bestSegment = segment : segmentRating = rating
        Next
        Return bestSegment
    End Function
    Private Function SplitSegment(Segment As DrawingCurveSegment, SplitPrecision As Integer) As List(Of Point2d)
        Dim pointList As New List(Of Point2d), MinParam, MaxParam As Double, TransGeom As TransientGeometry
        TransGeom = InventorApplication.TransientGeometry
        Segment.Geometry.Evaluator.GetParamExtents(MinParam, MaxParam)
        For i = 0 To SplitPrecision
            Dim pCoordinate(0 To 1) As Double
            Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision}, pCoordinate)
            pointList.Add(TransGeom.CreatePoint2d(pCoordinate(0), pCoordinate(1)))
        Next
        Return pointList
    End Function
    Private Function DistanceToViewRangeBox(TestPoint As Point2d, DView As DrawingView) As Double

        Dim shortest As Double = _topLine.DistanceTo(TestPoint)
        Dim dist As Double = _btmLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        Return shortest
    End Function
    Private Function GetSegmentLength(Segment As DrawingCurveSegment) As Double
        Select Case Segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return Segment.EndPoint.DistanceTo(Segment.StartPoint)
            Case Else
                Return GetCurveLength(Segment.Geometry.Evaluator)
        End Select
    End Function
    Private Function GetSegmentMidPoint(Segment As DrawingCurveSegment) As Point2d
        Dim CurveEval As Curve2dEvaluator = Segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), midPointCoordinates(1), curveLength As Double
        CurveEval.GetParamExtents(minParam, maxParam)
        CurveEval.GetLengthAtParam(minParam, maxParam, curveLength)
        CurveEval.GetParamAtLength(minParam, curveLength / 2, midParam(0))
        CurveEval.GetPointAtParam(midParam, midPointCoordinates)
        Return InventorApplication.TransientGeometry.CreatePoint2d(midPointCoordinates(0), midPointCoordinates(1))
    End Function
    Private Function GetCurveLength(Eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, curveLength As Double
        Eval.GetParamExtents(minParam, maxParam)
        Eval.GetLengthAtParam(minParam, maxParam, curveLength)
        Return curveLength
    End Function
    Private Function GetAttachPoint(Segment As DrawingCurveSegment) As GeometryIntent
        If Segment Is Nothing Then Return Nothing
        Dim DrawingSheet As Sheet = Segment.Parent.Parent.Parent
        If Segment.GeometryType = Curve2dTypeEnum.kCircleCurve2d Or Segment.GeometryType = Curve2dTypeEnum.kEllipseFullCurve2d Then
            Select Case GetQuadrant(Segment.Geometry.Center, Segment.Parent.Parent)
                Case "Top"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularTopPointIntent)
                Case "Bottom"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularBottomPointIntent)
                Case "Left"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularLeftPointIntent)
                Case "Right"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularRightPointIntent)
                Case "Quadrant not Found"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCenterPointIntent)
            End Select
        End If
        Return DrawingSheet.CreateGeometryIntent(Segment.Parent, GetSegmentMidPoint(Segment))
    End Function
#End Region
End Module
```

#### Code Block 4

```vb
Imports Inventor
Module AutoBalloon
#Region "Auto Balloon"
    Private ReadOnly Property _blnViewMargin As Double = 2
    Private ReadOnly Property _blnVerticalOffset As Double = 0.9
    Private ReadOnly Property _blnHorizontalOffset As Double = 1
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
    Friend Sub AddBallonToView(View As DrawingView)
        Dim PartsList As PartsList = View.Parent.PartsLists.Item(1)
        InitialiseViewBoundingBox(View)
        For Each row As PartsListRow In PartsList.PartsListRows
            If Not row.Ballooned Then CreateRowItemBalloon(row, View)
        Next
        ArrangeBalloonsOnView(View)
    End Sub
    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TransGeom As TransientGeometry = InventorApplication.TransientGeometry
        Dim TopLeft As Point2d, TopRight As Point2d, BtmLeft As Point2d, BtmRight As Point2d
        TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)
    End Sub
    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim TransGeom As TransientGeometry = InventorApplication.TransientGeometry
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub
        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        Dim LeaderPoints As ObjectCollection = InventorApplication.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub
    Private Sub ArrangeBalloonsOnView(View As DrawingView)
        Dim leftBalloon As New List(Of Balloon)
        Dim rightBalloon As New List(Of Balloon)
        Dim topBalloon As New List(Of Balloon)
        Dim btmBalloon As New List(Of Balloon)
        For Each balloon As Balloon In View.Parent.Balloons
            If balloon.ParentView Is View Then
                If balloon.Position.X = View.Left - _blnViewMargin Then
                    leftBalloon.Add(balloon)
                ElseIf balloon.Position.X = View.Left + View.Width + _blnViewMargin Then
                    rightBalloon.Add(balloon)
                ElseIf balloon.Position.Y = View.Top + _blnViewMargin Then
                    topBalloon.Add(balloon)
                ElseIf balloon.Position.Y = View.Top - View.Height - _blnViewMargin Then
                    btmBalloon.Add(balloon)
                End If
            End If
        Next
        If leftBalloon.Count > 1 Then ArrangeBalloonVerticaly(leftBalloon)
        If rightBalloon.Count > 1 Then ArrangeBalloonVerticaly(rightBalloon)
        If topBalloon.Count > 1 Then ArrangeBalloonHorizontaly(topBalloon)
        If btmBalloon.Count > 1 Then ArrangeBalloonHorizontaly(btmBalloon)
    End Sub
    Private Sub ArrangeBalloonVerticaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.Y.CompareTo(x.Position.Y))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.Y - ballons(index).Position.Y < _blnVerticalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.Y = ballons(index - 1).Position.Y - _blnVerticalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Sub ArrangeBalloonHorizontaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.X.CompareTo(x.Position.X))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.X - ballons(index).Position.X < _blnHorizontalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.X = ballons(index - 1).Position.X - _blnHorizontalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d

        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double
        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Quadrant not Found"
                Return Nothing
        End Select
        Return leaderPoint
    End Function
    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView)
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle Or PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function
    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim itemOccurrences As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim OccurrencesCurves As List(Of DrawingCurve) = GetCurvesFromOcc(itemOccurrences, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(OccurrencesCurves))
    End Function
#End Region
#Region "Curves analysis methods"
    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim Curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not Curves.Contains(curve) Then Curves.Add(curve)
                Next
            End If
        Next
        Return Curves
    End Function
    Private Function GetBestSegmentFromOccurrence(OccurrenceCurves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0, bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In OccurrenceCurves
            Dim rating As Double
            Dim bestInCurve As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then bestSegment = bestInCurve : bestRating = rating
        Next
        Return bestSegment
    End Function
    Private Function GetBestSegmentFromCurve(Curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In Curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            Dim segmentPoints As List(Of Point2d) = SplitSegment(segment, 10)
            Dim closestDist As Double = Double.PositiveInfinity
            Dim distanceSum As Double = 0
            For Each point As Point2d In segmentPoints
                Dim pointDist As Double = DistanceToViewRangeBox(point, Curve.Parent)
                If pointDist < closestDist Then closestDist = pointDist
                distanceSum += pointDist
            Next
            Dim avgDistance = distanceSum / segmentPoints.Count
            Dim rating As Double = segLength ' / (avgDistance * closestDist ^ 2)
            If Curve.EdgeType = DrawingEdgeTypeEnum.kTangentEdge Then rating /= 10
            If rating > segmentRating Then bestSegment = segment : segmentRating = rating
        Next
        Return bestSegment
    End Function
    Private Function SplitSegment(Segment As DrawingCurveSegment, SplitPrecision As Integer) As List(Of Point2d)
        Dim pointList As New List(Of Point2d), MinParam, MaxParam As Double, TransGeom As TransientGeometry
        TransGeom = InventorApplication.TransientGeometry
        Segment.Geometry.Evaluator.GetParamExtents(MinParam, MaxParam)
        For i = 0 To SplitPrecision
            Dim pCoordinate(0 To 1) As Double
            Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision}, pCoordinate)
            pointList.Add(TransGeom.CreatePoint2d(pCoordinate(0), pCoordinate(1)))
        Next
        Return pointList
    End Function
    Private Function DistanceToViewRangeBox(TestPoint As Point2d, DView As DrawingView) As Double

        Dim shortest As Double = _topLine.DistanceTo(TestPoint)
        Dim dist As Double = _btmLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        Return shortest
    End Function
    Private Function GetSegmentLength(Segment As DrawingCurveSegment) As Double
        Select Case Segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return Segment.EndPoint.DistanceTo(Segment.StartPoint)
            Case Else
                Return GetCurveLength(Segment.Geometry.Evaluator)
        End Select
    End Function
    Private Function GetSegmentMidPoint(Segment As DrawingCurveSegment) As Point2d
        Dim CurveEval As Curve2dEvaluator = Segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), midPointCoordinates(1), curveLength As Double
        CurveEval.GetParamExtents(minParam, maxParam)
        CurveEval.GetLengthAtParam(minParam, maxParam, curveLength)
        CurveEval.GetParamAtLength(minParam, curveLength / 2, midParam(0))
        CurveEval.GetPointAtParam(midParam, midPointCoordinates)
        Return InventorApplication.TransientGeometry.CreatePoint2d(midPointCoordinates(0), midPointCoordinates(1))
    End Function
    Private Function GetCurveLength(Eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, curveLength As Double
        Eval.GetParamExtents(minParam, maxParam)
        Eval.GetLengthAtParam(minParam, maxParam, curveLength)
        Return curveLength
    End Function
    Private Function GetAttachPoint(Segment As DrawingCurveSegment) As GeometryIntent
        If Segment Is Nothing Then Return Nothing
        Dim DrawingSheet As Sheet = Segment.Parent.Parent.Parent
        If Segment.GeometryType = Curve2dTypeEnum.kCircleCurve2d Or Segment.GeometryType = Curve2dTypeEnum.kEllipseFullCurve2d Then
            Select Case GetQuadrant(Segment.Geometry.Center, Segment.Parent.Parent)
                Case "Top"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularTopPointIntent)
                Case "Bottom"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularBottomPointIntent)
                Case "Left"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularLeftPointIntent)
                Case "Right"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularRightPointIntent)
                Case "Quadrant not Found"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCenterPointIntent)
            End Select
        End If
        Return DrawingSheet.CreateGeometryIntent(Segment.Parent, GetSegmentMidPoint(Segment))
    End Function
#End Region
End Module
```

#### Code Block 5

```vb
Private Oapp As Inventor.Application
    Private TransGeom As TransientGeometry

    Public Sub New(inventorApp As Inventor.Application)
        Oapp = inventorApp
        TransGeom = Oapp.TransientGeometry
    End Sub

    Public Sub Main(oDrawingDoc As DrawingDocument, oSheet As Sheet, oView As DrawingView, sectionview As DrawingView)
        Dim sw As New Stopwatch()
        sw.Start()

        If oView IsNot Nothing Then
            Dim sheet2 As Sheet = oDrawingDoc.Sheets.Item(2)
            Dim partlist As PartsList = sheet2.PartsLists.Item(1)

            AddBalloonToView(oView, partlist)
            AddBalloonToView(sectionview, partlist)
        End If

        sw.Stop()
        Dim elapsedMinutes As Integer = sw.Elapsed.Minutes
        Dim elapsedSeconds As Integer = sw.Elapsed.Seconds
        Dim message As String = $"Balloon generation completed in {elapsedMinutes} minute(s) and {elapsedSeconds} second(s)."
        System.Windows.Forms.MessageBox.Show(message, "Balloon Generation Time")

    End Sub

    Private Sub AddBalloonToView(View As DrawingView, partlist1 As PartsList)
        InitialiseViewBoundingBox(View)

        For Each row As PartsListRow In partlist1.PartsListRows
            If Not row.Ballooned AndAlso row.Visible Then
                CreateRowItemBalloon(row, View)
            End If
        Next

        ArrangeBalloonsAroundView(View)
    End Sub

    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        Dim TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        Dim BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        Dim BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)

        _blnViewMargin = 3
        _blnVerticalOffset = 2.0
        _blnHorizontalOffset = 2.0
    End Sub

    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub

        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        If leaderPoint Is Nothing Then Exit Sub

        Dim LeaderPoints As ObjectCollection = Oapp.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub

    Private Sub ArrangeBalloonsAroundView(View As DrawingView)
    Dim allBalloons As New List(Of Balloon)
    For Each balloon As Balloon In View.Parent.Balloons
        If balloon.ParentView Is View Then
            allBalloons.Add(balloon)
        End If
    Next

    Dim topBalloons As New List(Of Balloon)
    Dim bottomBalloons As New List(Of Balloon)
    Dim leftBalloons As New List(Of Balloon)
    Dim rightBalloons As New List(Of Balloon)

    ' Classify balloons by approximate quadrant
    For Each balloon As Balloon In allBalloons
        Dim attachX = balloon.Position.X
        Dim attachY = balloon.Position.Y

        If attachY > View.Center.Y + View.Height / 4 Then
            topBalloons.Add(balloon)
        ElseIf attachY < View.Center.Y - View.Height / 4 Then
            bottomBalloons.Add(balloon)
        ElseIf attachX < View.Center.X Then
            leftBalloons.Add(balloon)
        Else
            rightBalloons.Add(balloon)
        End If
    Next

    ' Distribute using vertical and horizontal offsets
    DistributeBalloonsAlongTopOrBottom(topBalloons, View.Top + _blnViewMargin + _blnVerticalOffset, View.Left, View.Left + View.Width)
    DistributeBalloonsAlongTopOrBottom(bottomBalloons, View.Top - View.Height - _blnViewMargin - _blnVerticalOffset, View.Left, View.Left + View.Width)
    DistributeBalloonsAlongLeftOrRight(leftBalloons, View.Left - _blnViewMargin - _blnHorizontalOffset, View.Top, View.Top - View.Height)
    DistributeBalloonsAlongLeftOrRight(rightBalloons, View.Left + View.Width + _blnViewMargin + _blnHorizontalOffset, View.Top, View.Top - View.Height)
End Sub

    Private Sub DistributeBalloonsAlongTopOrBottom(balloons As List(Of Balloon), yPos As Double, xStart As Double, xEnd As Double)
        If balloons.Count = 0 Then Exit Sub

        balloons.Sort(Function(a, b) a.Position.X.CompareTo(b.Position.X))
        Dim spacing As Double = (xEnd - xStart) / (balloons.Count + 1)

        For i = 0 To balloons.Count - 1
            Dim newX = xStart + spacing * (i + 1)
            balloons(i).Position = TransGeom.CreatePoint2d(newX, yPos)
        Next
    End Sub

    Private Sub DistributeBalloonsAlongLeftOrRight(balloons As List(Of Balloon), xPos As Double, yStart As Double, yEnd As Double)
        If balloons.Count = 0 Then Exit Sub

        balloons.Sort(Function(a, b) a.Position.Y.CompareTo(b.Position.Y))
        Dim spacing As Double = (yStart - yEnd) / (balloons.Count + 1)

        For i = 0 To balloons.Count - 1
            Dim newY = yStart - spacing * (i + 1)
            balloons(i).Position = TransGeom.CreatePoint2d(xPos, newY)
        Next
    End Sub

    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d
        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double

        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case Else
                Return Nothing
        End Select
        Return leaderPoint
    End Function

    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView) As String
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle OrElse PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function

    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim occEnum As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim curves As List(Of DrawingCurve) = GetCurvesFromOcc(occEnum, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(curves))
    End Function

#Region "Curve helpers"

    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not curves.Contains(curve) Then curves.Add(curve)
                Next
            End If
        Next
        Return curves
    End Function

    Private Function GetBestSegmentFromOccurrence(curves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0
        Dim bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In curves
            Dim rating As Double
            Dim seg As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then
                bestRating = rating
                bestSegment = seg
            End If
        Next
        Return bestSegment
    End Function

    Private Function GetBestSegmentFromCurve(curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            If segLength > segmentRating Then
                bestSegment = segment
                segmentRating = segLength
            End If
        Next
        Return bestSegment
    End Function

    Private Function GetSegmentLength(segment As DrawingCurveSegment) As Double
        Select Case segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return segment.StartPoint.DistanceTo(segment.EndPoint)
            Case Else
                Return GetCurveLength(segment.Geometry.Evaluator)
        End Select
    End Function

    Private Function GetCurveLength(eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, length As Double
        eval.GetParamExtents(minParam, maxParam)
        eval.GetLengthAtParam(minParam, maxParam, length)
        Return length
    End Function

    Private Function GetAttachPoint(segment As DrawingCurveSegment) As GeometryIntent
        If segment Is Nothing Then Return Nothing
        Dim sheet As Sheet = segment.Parent.Parent.Parent
        Return sheet.CreateGeometryIntent(segment.Parent, GetSegmentMidPoint(segment))
    End Function

    Private Function GetSegmentMidPoint(segment As DrawingCurveSegment) As Point2d
        Dim eval As Curve2dEvaluator = segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), point(1), length As Double
        eval.GetParamExtents(minParam, maxParam)
        eval.GetLengthAtParam(minParam, maxParam, length)
        eval.GetParamAtLength(minParam, length / 2, midParam(0))
        eval.GetPointAtParam(midParam, point)
        Return TransGeom.CreatePoint2d(point(0), point(1))
    End Function

#End Region

    ' Private properties
    Private Property _blnViewMargin As Double
    Private Property _blnVerticalOffset As Double
    Private Property _blnHorizontalOffset As Double
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
```

#### Code Block 6

```vb
Private Oapp As Inventor.Application
    Private TransGeom As TransientGeometry

    Public Sub New(inventorApp As Inventor.Application)
        Oapp = inventorApp
        TransGeom = Oapp.TransientGeometry
    End Sub

    Public Sub Main(oDrawingDoc As DrawingDocument, oSheet As Sheet, oView As DrawingView, sectionview As DrawingView)
        Dim sw As New Stopwatch()
        sw.Start()

        If oView IsNot Nothing Then
            Dim sheet2 As Sheet = oDrawingDoc.Sheets.Item(2)
            Dim partlist As PartsList = sheet2.PartsLists.Item(1)

            AddBalloonToView(oView, partlist)
            AddBalloonToView(sectionview, partlist)
        End If

        sw.Stop()
        Dim elapsedMinutes As Integer = sw.Elapsed.Minutes
        Dim elapsedSeconds As Integer = sw.Elapsed.Seconds
        Dim message As String = $"Balloon generation completed in {elapsedMinutes} minute(s) and {elapsedSeconds} second(s)."
        System.Windows.Forms.MessageBox.Show(message, "Balloon Generation Time")

    End Sub

    Private Sub AddBalloonToView(View As DrawingView, partlist1 As PartsList)
        InitialiseViewBoundingBox(View)

        For Each row As PartsListRow In partlist1.PartsListRows
            If Not row.Ballooned AndAlso row.Visible Then
                CreateRowItemBalloon(row, View)
            End If
        Next

        ArrangeBalloonsAroundView(View)
    End Sub

    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        Dim TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        Dim BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        Dim BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)

        _blnViewMargin = 3
        _blnVerticalOffset = 2.0
        _blnHorizontalOffset = 2.0
    End Sub

    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub

        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        If leaderPoint Is Nothing Then Exit Sub

        Dim LeaderPoints As ObjectCollection = Oapp.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub

    Private Sub ArrangeBalloonsAroundView(View As DrawingView)
    Dim allBalloons As New List(Of Balloon)
    For Each balloon As Balloon In View.Parent.Balloons
        If balloon.ParentView Is View Then
            allBalloons.Add(balloon)
        End If
    Next

    Dim topBalloons As New List(Of Balloon)
    Dim bottomBalloons As New List(Of Balloon)
    Dim leftBalloons As New List(Of Balloon)
    Dim rightBalloons As New List(Of Balloon)

    ' Classify balloons by approximate quadrant
    For Each balloon As Balloon In allBalloons
        Dim attachX = balloon.Position.X
        Dim attachY = balloon.Position.Y

        If attachY > View.Center.Y + View.Height / 4 Then
            topBalloons.Add(balloon)
        ElseIf attachY < View.Center.Y - View.Height / 4 Then
            bottomBalloons.Add(balloon)
        ElseIf attachX < View.Center.X Then
            leftBalloons.Add(balloon)
        Else
            rightBalloons.Add(balloon)
        End If
    Next

    ' Distribute using vertical and horizontal offsets
    DistributeBalloonsAlongTopOrBottom(topBalloons, View.Top + _blnViewMargin + _blnVerticalOffset, View.Left, View.Left + View.Width)
    DistributeBalloonsAlongTopOrBottom(bottomBalloons, View.Top - View.Height - _blnViewMargin - _blnVerticalOffset, View.Left, View.Left + View.Width)
    DistributeBalloonsAlongLeftOrRight(leftBalloons, View.Left - _blnViewMargin - _blnHorizontalOffset, View.Top, View.Top - View.Height)
    DistributeBalloonsAlongLeftOrRight(rightBalloons, View.Left + View.Width + _blnViewMargin + _blnHorizontalOffset, View.Top, View.Top - View.Height)
End Sub

    Private Sub DistributeBalloonsAlongTopOrBottom(balloons As List(Of Balloon), yPos As Double, xStart As Double, xEnd As Double)
        If balloons.Count = 0 Then Exit Sub

        balloons.Sort(Function(a, b) a.Position.X.CompareTo(b.Position.X))
        Dim spacing As Double = (xEnd - xStart) / (balloons.Count + 1)

        For i = 0 To balloons.Count - 1
            Dim newX = xStart + spacing * (i + 1)
            balloons(i).Position = TransGeom.CreatePoint2d(newX, yPos)
        Next
    End Sub

    Private Sub DistributeBalloonsAlongLeftOrRight(balloons As List(Of Balloon), xPos As Double, yStart As Double, yEnd As Double)
        If balloons.Count = 0 Then Exit Sub

        balloons.Sort(Function(a, b) a.Position.Y.CompareTo(b.Position.Y))
        Dim spacing As Double = (yStart - yEnd) / (balloons.Count + 1)

        For i = 0 To balloons.Count - 1
            Dim newY = yStart - spacing * (i + 1)
            balloons(i).Position = TransGeom.CreatePoint2d(xPos, newY)
        Next
    End Sub

    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d
        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double

        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case Else
                Return Nothing
        End Select
        Return leaderPoint
    End Function

    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView) As String
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle OrElse PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function

    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim occEnum As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim curves As List(Of DrawingCurve) = GetCurvesFromOcc(occEnum, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(curves))
    End Function

#Region "Curve helpers"

    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not curves.Contains(curve) Then curves.Add(curve)
                Next
            End If
        Next
        Return curves
    End Function

    Private Function GetBestSegmentFromOccurrence(curves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0
        Dim bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In curves
            Dim rating As Double
            Dim seg As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then
                bestRating = rating
                bestSegment = seg
            End If
        Next
        Return bestSegment
    End Function

    Private Function GetBestSegmentFromCurve(curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            If segLength > segmentRating Then
                bestSegment = segment
                segmentRating = segLength
            End If
        Next
        Return bestSegment
    End Function

    Private Function GetSegmentLength(segment As DrawingCurveSegment) As Double
        Select Case segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return segment.StartPoint.DistanceTo(segment.EndPoint)
            Case Else
                Return GetCurveLength(segment.Geometry.Evaluator)
        End Select
    End Function

    Private Function GetCurveLength(eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, length As Double
        eval.GetParamExtents(minParam, maxParam)
        eval.GetLengthAtParam(minParam, maxParam, length)
        Return length
    End Function

    Private Function GetAttachPoint(segment As DrawingCurveSegment) As GeometryIntent
        If segment Is Nothing Then Return Nothing
        Dim sheet As Sheet = segment.Parent.Parent.Parent
        Return sheet.CreateGeometryIntent(segment.Parent, GetSegmentMidPoint(segment))
    End Function

    Private Function GetSegmentMidPoint(segment As DrawingCurveSegment) As Point2d
        Dim eval As Curve2dEvaluator = segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), point(1), length As Double
        eval.GetParamExtents(minParam, maxParam)
        eval.GetLengthAtParam(minParam, maxParam, length)
        eval.GetParamAtLength(minParam, length / 2, midParam(0))
        eval.GetPointAtParam(midParam, point)
        Return TransGeom.CreatePoint2d(point(0), point(1))
    End Function

#End Region

    ' Private properties
    Private Property _blnViewMargin As Double
    Private Property _blnVerticalOffset As Double
    Private Property _blnHorizontalOffset As Double
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
```

#### Code Block 7

```vb
Private Oapp As Inventor.Application
    Private TransGeom As TransientGeometry

    Public Sub New(inventorApp As Inventor.Application)
        Oapp = inventorApp
        TransGeom = Oapp.TransientGeometry
    End Sub

    Public Sub Main(oDrawingDoc As DrawingDocument, oSheet As Sheet, oView As DrawingView, sectionview As DrawingView)
        Dim sw As New Stopwatch()
        sw.Start()

        If oView IsNot Nothing Then
            Dim sheet2 As Sheet = oDrawingDoc.Sheets.Item(2)
            Dim partlist As PartsList = sheet2.PartsLists.Item(1)

            AddBalloonToView(oView, partlist)
            AddBalloonToView(sectionview, partlist)
        End If

        sw.Stop()
        Dim elapsedMinutes As Integer = sw.Elapsed.Minutes
        Dim elapsedSeconds As Integer = sw.Elapsed.Seconds
        Dim message As String = $"Balloon generation completed in {elapsedMinutes} minute(s) and {elapsedSeconds} second(s)."
        System.Windows.Forms.MessageBox.Show(message, "Balloon Generation Time")

    End Sub

    Private Sub AddBalloonToView(View As DrawingView, partlist1 As PartsList)
        InitialiseViewBoundingBox(View)

        For Each row As PartsListRow In partlist1.PartsListRows
            If Not row.Ballooned AndAlso row.Visible Then
                CreateRowItemBalloon(row, View)
            End If
        Next

        ArrangeBalloonsAroundView(View)
    End Sub

    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        Dim TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        Dim BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        Dim BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)

        _blnViewMargin = 3
        _blnVerticalOffset = 2.0
        _blnHorizontalOffset = 2.0
    End Sub

    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub

        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        If leaderPoint Is Nothing Then Exit Sub

        Dim LeaderPoints As ObjectCollection = Oapp.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub

    Private Sub ArrangeBalloonsAroundView(View As DrawingView)
    Dim allBalloons As New List(Of Balloon)
    For Each balloon As Balloon In View.Parent.Balloons
        If balloon.ParentView Is View Then
            allBalloons.Add(balloon)
        End If
    Next

    Dim topBalloons As New List(Of Balloon)
    Dim bottomBalloons As New List(Of Balloon)
    Dim leftBalloons As New List(Of Balloon)
    Dim rightBalloons As New List(Of Balloon)

    ' Classify balloons by approximate quadrant
    For Each balloon As Balloon In allBalloons
        Dim attachX = balloon.Position.X
        Dim attachY = balloon.Position.Y

        If attachY > View.Center.Y + View.Height / 4 Then
            topBalloons.Add(balloon)
        ElseIf attachY < View.Center.Y - View.Height / 4 Then
            bottomBalloons.Add(balloon)
        ElseIf attachX < View.Center.X Then
            leftBalloons.Add(balloon)
        Else
            rightBalloons.Add(balloon)
        End If
    Next

    ' Distribute using vertical and horizontal offsets
    DistributeBalloonsAlongTopOrBottom(topBalloons, View.Top + _blnViewMargin + _blnVerticalOffset, View.Left, View.Left + View.Width)
    DistributeBalloonsAlongTopOrBottom(bottomBalloons, View.Top - View.Height - _blnViewMargin - _blnVerticalOffset, View.Left, View.Left + View.Width)
    DistributeBalloonsAlongLeftOrRight(leftBalloons, View.Left - _blnViewMargin - _blnHorizontalOffset, View.Top, View.Top - View.Height)
    DistributeBalloonsAlongLeftOrRight(rightBalloons, View.Left + View.Width + _blnViewMargin + _blnHorizontalOffset, View.Top, View.Top - View.Height)
End Sub

    Private Sub DistributeBalloonsAlongTopOrBottom(balloons As List(Of Balloon), yPos As Double, xStart As Double, xEnd As Double)
        If balloons.Count = 0 Then Exit Sub

        balloons.Sort(Function(a, b) a.Position.X.CompareTo(b.Position.X))
        Dim spacing As Double = (xEnd - xStart) / (balloons.Count + 1)

        For i = 0 To balloons.Count - 1
            Dim newX = xStart + spacing * (i + 1)
            balloons(i).Position = TransGeom.CreatePoint2d(newX, yPos)
        Next
    End Sub

    Private Sub DistributeBalloonsAlongLeftOrRight(balloons As List(Of Balloon), xPos As Double, yStart As Double, yEnd As Double)
        If balloons.Count = 0 Then Exit Sub

        balloons.Sort(Function(a, b) a.Position.Y.CompareTo(b.Position.Y))
        Dim spacing As Double = (yStart - yEnd) / (balloons.Count + 1)

        For i = 0 To balloons.Count - 1
            Dim newY = yStart - spacing * (i + 1)
            balloons(i).Position = TransGeom.CreatePoint2d(xPos, newY)
        Next
    End Sub

    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d
        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double

        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case Else
                Return Nothing
        End Select
        Return leaderPoint
    End Function

    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView) As String
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle OrElse PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function

    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim occEnum As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim curves As List(Of DrawingCurve) = GetCurvesFromOcc(occEnum, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(curves))
    End Function

#Region "Curve helpers"

    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not curves.Contains(curve) Then curves.Add(curve)
                Next
            End If
        Next
        Return curves
    End Function

    Private Function GetBestSegmentFromOccurrence(curves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0
        Dim bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In curves
            Dim rating As Double
            Dim seg As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then
                bestRating = rating
                bestSegment = seg
            End If
        Next
        Return bestSegment
    End Function

    Private Function GetBestSegmentFromCurve(curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            If segLength > segmentRating Then
                bestSegment = segment
                segmentRating = segLength
            End If
        Next
        Return bestSegment
    End Function

    Private Function GetSegmentLength(segment As DrawingCurveSegment) As Double
        Select Case segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return segment.StartPoint.DistanceTo(segment.EndPoint)
            Case Else
                Return GetCurveLength(segment.Geometry.Evaluator)
        End Select
    End Function

    Private Function GetCurveLength(eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, length As Double
        eval.GetParamExtents(minParam, maxParam)
        eval.GetLengthAtParam(minParam, maxParam, length)
        Return length
    End Function

    Private Function GetAttachPoint(segment As DrawingCurveSegment) As GeometryIntent
        If segment Is Nothing Then Return Nothing
        Dim sheet As Sheet = segment.Parent.Parent.Parent
        Return sheet.CreateGeometryIntent(segment.Parent, GetSegmentMidPoint(segment))
    End Function

    Private Function GetSegmentMidPoint(segment As DrawingCurveSegment) As Point2d
        Dim eval As Curve2dEvaluator = segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), point(1), length As Double
        eval.GetParamExtents(minParam, maxParam)
        eval.GetLengthAtParam(minParam, maxParam, length)
        eval.GetParamAtLength(minParam, length / 2, midParam(0))
        eval.GetPointAtParam(midParam, point)
        Return TransGeom.CreatePoint2d(point(0), point(1))
    End Function

#End Region

    ' Private properties
    Private Property _blnViewMargin As Double
    Private Property _blnVerticalOffset As Double
    Private Property _blnHorizontalOffset As Double
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
```

#### Code Block 8

```vb
Private Oapp As Inventor.Application
    Private TransGeom As TransientGeometry

    Public Sub New(inventorApp As Inventor.Application)
        Oapp = inventorApp
        TransGeom = Oapp.TransientGeometry
    End Sub

    Public Sub Main(oDrawingDoc As DrawingDocument, oSheet As Sheet, oView As DrawingView, sectionview As DrawingView)
        Dim sw As New Stopwatch()
        sw.Start()

        If oView IsNot Nothing Then
            Dim sheet2 As Sheet = oDrawingDoc.Sheets.Item(2)
            Dim partlist As PartsList = sheet2.PartsLists.Item(1)

            AddBalloonToView(oView, partlist)
            AddBalloonToView(sectionview, partlist)
        End If

        sw.Stop()
        Dim elapsedMinutes As Integer = sw.Elapsed.Minutes
        Dim elapsedSeconds As Integer = sw.Elapsed.Seconds
        Dim message As String = $"Balloon generation completed in {elapsedMinutes} minute(s) and {elapsedSeconds} second(s)."
        System.Windows.Forms.MessageBox.Show(message, "Balloon Generation Time")

    End Sub

    Private Sub AddBalloonToView(View As DrawingView, partlist1 As PartsList)
        InitialiseViewBoundingBox(View)

        For Each row As PartsListRow In partlist1.PartsListRows
            If Not row.Ballooned AndAlso row.Visible Then
                CreateRowItemBalloon(row, View)
            End If
        Next

        ArrangeBalloonsAroundView(View)
    End Sub

    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        Dim TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        Dim BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        Dim BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)

        _blnViewMargin = 3
        _blnVerticalOffset = 2.0
        _blnHorizontalOffset = 2.0
    End Sub

    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub

        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        If leaderPoint Is Nothing Then Exit Sub

        Dim LeaderPoints As ObjectCollection = Oapp.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub

    Private Sub ArrangeBalloonsAroundView(View As DrawingView)
    Dim allBalloons As New List(Of Balloon)
    For Each balloon As Balloon In View.Parent.Balloons
        If balloon.ParentView Is View Then
            allBalloons.Add(balloon)
        End If
    Next

    Dim topBalloons As New List(Of Balloon)
    Dim bottomBalloons As New List(Of Balloon)
    Dim leftBalloons As New List(Of Balloon)
    Dim rightBalloons As New List(Of Balloon)

    ' Classify balloons by approximate quadrant
    For Each balloon As Balloon In allBalloons
        Dim attachX = balloon.Position.X
        Dim attachY = balloon.Position.Y

        If attachY > View.Center.Y + View.Height / 4 Then
            topBalloons.Add(balloon)
        ElseIf attachY < View.Center.Y - View.Height / 4 Then
            bottomBalloons.Add(balloon)
        ElseIf attachX < View.Center.X Then
            leftBalloons.Add(balloon)
        Else
            rightBalloons.Add(balloon)
        End If
    Next

    ' Distribute using vertical and horizontal offsets
    DistributeBalloonsAlongTopOrBottom(topBalloons, View.Top + _blnViewMargin + _blnVerticalOffset, View.Left, View.Left + View.Width)
    DistributeBalloonsAlongTopOrBottom(bottomBalloons, View.Top - View.Height - _blnViewMargin - _blnVerticalOffset, View.Left, View.Left + View.Width)
    DistributeBalloonsAlongLeftOrRight(leftBalloons, View.Left - _blnViewMargin - _blnHorizontalOffset, View.Top, View.Top - View.Height)
    DistributeBalloonsAlongLeftOrRight(rightBalloons, View.Left + View.Width + _blnViewMargin + _blnHorizontalOffset, View.Top, View.Top - View.Height)
End Sub

    Private Sub DistributeBalloonsAlongTopOrBottom(balloons As List(Of Balloon), yPos As Double, xStart As Double, xEnd As Double)
        If balloons.Count = 0 Then Exit Sub

        balloons.Sort(Function(a, b) a.Position.X.CompareTo(b.Position.X))
        Dim spacing As Double = (xEnd - xStart) / (balloons.Count + 1)

        For i = 0 To balloons.Count - 1
            Dim newX = xStart + spacing * (i + 1)
            balloons(i).Position = TransGeom.CreatePoint2d(newX, yPos)
        Next
    End Sub

    Private Sub DistributeBalloonsAlongLeftOrRight(balloons As List(Of Balloon), xPos As Double, yStart As Double, yEnd As Double)
        If balloons.Count = 0 Then Exit Sub

        balloons.Sort(Function(a, b) a.Position.Y.CompareTo(b.Position.Y))
        Dim spacing As Double = (yStart - yEnd) / (balloons.Count + 1)

        For i = 0 To balloons.Count - 1
            Dim newY = yStart - spacing * (i + 1)
            balloons(i).Position = TransGeom.CreatePoint2d(xPos, newY)
        Next
    End Sub

    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d
        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double

        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case Else
                Return Nothing
        End Select
        Return leaderPoint
    End Function

    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView) As String
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle OrElse PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function

    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim occEnum As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim curves As List(Of DrawingCurve) = GetCurvesFromOcc(occEnum, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(curves))
    End Function

#Region "Curve helpers"

    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not curves.Contains(curve) Then curves.Add(curve)
                Next
            End If
        Next
        Return curves
    End Function

    Private Function GetBestSegmentFromOccurrence(curves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0
        Dim bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In curves
            Dim rating As Double
            Dim seg As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then
                bestRating = rating
                bestSegment = seg
            End If
        Next
        Return bestSegment
    End Function

    Private Function GetBestSegmentFromCurve(curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            If segLength > segmentRating Then
                bestSegment = segment
                segmentRating = segLength
            End If
        Next
        Return bestSegment
    End Function

    Private Function GetSegmentLength(segment As DrawingCurveSegment) As Double
        Select Case segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return segment.StartPoint.DistanceTo(segment.EndPoint)
            Case Else
                Return GetCurveLength(segment.Geometry.Evaluator)
        End Select
    End Function

    Private Function GetCurveLength(eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, length As Double
        eval.GetParamExtents(minParam, maxParam)
        eval.GetLengthAtParam(minParam, maxParam, length)
        Return length
    End Function

    Private Function GetAttachPoint(segment As DrawingCurveSegment) As GeometryIntent
        If segment Is Nothing Then Return Nothing
        Dim sheet As Sheet = segment.Parent.Parent.Parent
        Return sheet.CreateGeometryIntent(segment.Parent, GetSegmentMidPoint(segment))
    End Function

    Private Function GetSegmentMidPoint(segment As DrawingCurveSegment) As Point2d
        Dim eval As Curve2dEvaluator = segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), point(1), length As Double
        eval.GetParamExtents(minParam, maxParam)
        eval.GetLengthAtParam(minParam, maxParam, length)
        eval.GetParamAtLength(minParam, length / 2, midParam(0))
        eval.GetPointAtParam(midParam, point)
        Return TransGeom.CreatePoint2d(point(0), point(1))
    End Function

#End Region

    ' Private properties
    Private Property _blnViewMargin As Double
    Private Property _blnVerticalOffset As Double
    Private Property _blnHorizontalOffset As Double
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
```

#### Code Block 9

```vb
Public Sub AddBalloonsForOccurrenceNames(view As DrawingView,
                                         partList As PartsList,
                                         targetNames As IEnumerable(Of String),
                                         Optional topOffsetCm As Double = 1.0)

        If view Is Nothing OrElse partList Is Nothing Then Exit Sub
        If targetNames Is Nothing Then Exit Sub

        Dim wanted As New HashSet(Of String)(targetNames, StringComparer.OrdinalIgnoreCase)
        Dim tg = g_inventorApplication.TransientGeometry
        Dim created As New List(Of Balloon)

        InitialiseViewBoundingBox(view)

        For Each row As PartsListRow In partList.PartsListRows
            If row Is Nothing OrElse row.Ballooned OrElse Not row.Visible Then Continue For

            ' ---- inlined GetBalloonAttachGeometryFiltered ----
            Dim gi As GeometryIntent = Nothing

            If wanted.Count > 0 Then
                ' All occurrences for this row's referenced file
                Dim refDocDesc As DocumentDescriptor = row.ReferencedFiles.Item(1).DocumentDescriptor
                Dim occAll As ComponentOccurrencesEnumerator =
                view.ReferencedDocumentDescriptor.ReferencedDocument.
                    ComponentDefinition.Occurrences.AllReferencedOccurrences(refDocDesc)

                ' Filter occurrences by base name in "wanted"
                Dim occFiltered As New List(Of ComponentOccurrence)
                For Each occ As ComponentOccurrence In occAll
                    If occ Is Nothing OrElse occ.Suppressed Then Continue For

                    ' ---- inlined NormalizeOccName ----
                    Dim nm As String = occ.Name
                    Dim baseName As String
                    If String.IsNullOrEmpty(nm) Then
                        baseName = nm
                    Else
                        Dim p As Integer = nm.IndexOf(":"c)
                        baseName = If(p >= 0, nm.Substring(0, p), nm)
                    End If
                    If wanted.Contains(baseName) Then occFiltered.Add(occ)
                Next

                If occFiltered.Count > 0 Then
                    ' ---- inlined GetCurvesFromOccasList ----
                    Dim curves As New List(Of DrawingCurve)
                    For Each o As ComponentOccurrence In occFiltered
                        If o Is Nothing OrElse o.Suppressed Then Continue For
                        For Each dc As DrawingCurve In view.DrawingCurves(o)
                            If Not curves.Contains(dc) Then curves.Add(dc)
                        Next
                    Next
                    If curves.Count > 0 Then
                        Dim seg As DrawingCurveSegment = GetBestSegmentFromOccurrence(curves)
                        If seg IsNot Nothing Then
                            Dim sheet As Sheet = seg.Parent.Parent.Parent
                            gi = sheet.CreateGeometryIntent(seg.Parent, GetSegmentMidPoint(seg))
                        End If
                    End If
                End If
            End If
            If gi Is Nothing Then Continue For

            Dim topY As Double = view.Top + topOffsetCm
            Dim midX As Double = view.Left + (view.Width / 2.0)

            Dim leaders As ObjectCollection = g_inventorApplication.TransientObjects.CreateObjectCollection
            leaders.Add(tg.CreatePoint2d(midX, topY))
            leaders.Add(gi)

            Dim b As Balloon = view.Parent.Balloons.Add(leaders)
            created.Add(b)
        Next

        If created.Count > 0 Then
            DistributeBalloonsAlongTopOrBottom(
            created,
            yPos:=view.Top + topOffsetCm,
            xStart:=view.Left,
            xEnd:=view.Left + view.Width)
        End If
    End Sub
```

#### Code Block 10

```vb
Public Sub AddBalloonsForOccurrenceNames(view As DrawingView,
                                         partList As PartsList,
                                         targetNames As IEnumerable(Of String),
                                         Optional topOffsetCm As Double = 1.0)

        If view Is Nothing OrElse partList Is Nothing Then Exit Sub
        If targetNames Is Nothing Then Exit Sub

        Dim wanted As New HashSet(Of String)(targetNames, StringComparer.OrdinalIgnoreCase)
        Dim tg = g_inventorApplication.TransientGeometry
        Dim created As New List(Of Balloon)

        InitialiseViewBoundingBox(view)

        For Each row As PartsListRow In partList.PartsListRows
            If row Is Nothing OrElse row.Ballooned OrElse Not row.Visible Then Continue For

            ' ---- inlined GetBalloonAttachGeometryFiltered ----
            Dim gi As GeometryIntent = Nothing

            If wanted.Count > 0 Then
                ' All occurrences for this row's referenced file
                Dim refDocDesc As DocumentDescriptor = row.ReferencedFiles.Item(1).DocumentDescriptor
                Dim occAll As ComponentOccurrencesEnumerator =
                view.ReferencedDocumentDescriptor.ReferencedDocument.
                    ComponentDefinition.Occurrences.AllReferencedOccurrences(refDocDesc)

                ' Filter occurrences by base name in "wanted"
                Dim occFiltered As New List(Of ComponentOccurrence)
                For Each occ As ComponentOccurrence In occAll
                    If occ Is Nothing OrElse occ.Suppressed Then Continue For

                    ' ---- inlined NormalizeOccName ----
                    Dim nm As String = occ.Name
                    Dim baseName As String
                    If String.IsNullOrEmpty(nm) Then
                        baseName = nm
                    Else
                        Dim p As Integer = nm.IndexOf(":"c)
                        baseName = If(p >= 0, nm.Substring(0, p), nm)
                    End If
                    If wanted.Contains(baseName) Then occFiltered.Add(occ)
                Next

                If occFiltered.Count > 0 Then
                    ' ---- inlined GetCurvesFromOccasList ----
                    Dim curves As New List(Of DrawingCurve)
                    For Each o As ComponentOccurrence In occFiltered
                        If o Is Nothing OrElse o.Suppressed Then Continue For
                        For Each dc As DrawingCurve In view.DrawingCurves(o)
                            If Not curves.Contains(dc) Then curves.Add(dc)
                        Next
                    Next
                    If curves.Count > 0 Then
                        Dim seg As DrawingCurveSegment = GetBestSegmentFromOccurrence(curves)
                        If seg IsNot Nothing Then
                            Dim sheet As Sheet = seg.Parent.Parent.Parent
                            gi = sheet.CreateGeometryIntent(seg.Parent, GetSegmentMidPoint(seg))
                        End If
                    End If
                End If
            End If
            If gi Is Nothing Then Continue For

            Dim topY As Double = view.Top + topOffsetCm
            Dim midX As Double = view.Left + (view.Width / 2.0)

            Dim leaders As ObjectCollection = g_inventorApplication.TransientObjects.CreateObjectCollection
            leaders.Add(tg.CreatePoint2d(midX, topY))
            leaders.Add(gi)

            Dim b As Balloon = view.Parent.Balloons.Add(leaders)
            created.Add(b)
        Next

        If created.Count > 0 Then
            DistributeBalloonsAlongTopOrBottom(
            created,
            yPos:=view.Top + topOffsetCm,
            xStart:=view.Left,
            xEnd:=view.Left + view.Width)
        End If
    End Sub
```

#### Code Block 11

```vb
Public Sub AddBalloonsForOccurrenceNames(view As DrawingView,
                                         partList As PartsList,
                                         targetNames As IEnumerable(Of String),
                                         Optional topOffsetCm As Double = 1.0)

        If view Is Nothing OrElse partList Is Nothing Then Exit Sub
        If targetNames Is Nothing Then Exit Sub

        Dim wanted As New HashSet(Of String)(targetNames, StringComparer.OrdinalIgnoreCase)
        Dim tg = g_inventorApplication.TransientGeometry
        Dim created As New List(Of Balloon)

        InitialiseViewBoundingBox(view)

        For Each row As PartsListRow In partList.PartsListRows
            If row Is Nothing OrElse row.Ballooned OrElse Not row.Visible Then Continue For

            ' ---- inlined GetBalloonAttachGeometryFiltered ----
            Dim gi As GeometryIntent = Nothing

            If wanted.Count > 0 Then
                ' All occurrences for this row's referenced file
                Dim refDocDesc As DocumentDescriptor = row.ReferencedFiles.Item(1).DocumentDescriptor
                Dim occAll As ComponentOccurrencesEnumerator =
                view.ReferencedDocumentDescriptor.ReferencedDocument.
                    ComponentDefinition.Occurrences.AllReferencedOccurrences(refDocDesc)

                ' Filter occurrences by base name in "wanted"
                Dim occFiltered As New List(Of ComponentOccurrence)
                For Each occ As ComponentOccurrence In occAll
                    If occ Is Nothing OrElse occ.Suppressed Then Continue For

                    ' ---- inlined NormalizeOccName ----
                    Dim nm As String = occ.Name
                    Dim baseName As String
                    If String.IsNullOrEmpty(nm) Then
                        baseName = nm
                    Else
                        Dim p As Integer = nm.IndexOf(":"c)
                        baseName = If(p >= 0, nm.Substring(0, p), nm)
                    End If
                    If wanted.Contains(baseName) Then occFiltered.Add(occ)
                Next

                If occFiltered.Count > 0 Then
                    ' ---- inlined GetCurvesFromOccasList ----
                    Dim curves As New List(Of DrawingCurve)
                    For Each o As ComponentOccurrence In occFiltered
                        If o Is Nothing OrElse o.Suppressed Then Continue For
                        For Each dc As DrawingCurve In view.DrawingCurves(o)
                            If Not curves.Contains(dc) Then curves.Add(dc)
                        Next
                    Next
                    If curves.Count > 0 Then
                        Dim seg As DrawingCurveSegment = GetBestSegmentFromOccurrence(curves)
                        If seg IsNot Nothing Then
                            Dim sheet As Sheet = seg.Parent.Parent.Parent
                            gi = sheet.CreateGeometryIntent(seg.Parent, GetSegmentMidPoint(seg))
                        End If
                    End If
                End If
            End If
            If gi Is Nothing Then Continue For

            Dim topY As Double = view.Top + topOffsetCm
            Dim midX As Double = view.Left + (view.Width / 2.0)

            Dim leaders As ObjectCollection = g_inventorApplication.TransientObjects.CreateObjectCollection
            leaders.Add(tg.CreatePoint2d(midX, topY))
            leaders.Add(gi)

            Dim b As Balloon = view.Parent.Balloons.Add(leaders)
            created.Add(b)
        Next

        If created.Count > 0 Then
            DistributeBalloonsAlongTopOrBottom(
            created,
            yPos:=view.Top + topOffsetCm,
            xStart:=view.Left,
            xEnd:=view.Left + view.Width)
        End If
    End Sub
```

#### Code Block 12

```vb
Public Sub AddBalloonsForOccurrenceNames(view As DrawingView,
                                         partList As PartsList,
                                         targetNames As IEnumerable(Of String),
                                         Optional topOffsetCm As Double = 1.0)

        If view Is Nothing OrElse partList Is Nothing Then Exit Sub
        If targetNames Is Nothing Then Exit Sub

        Dim wanted As New HashSet(Of String)(targetNames, StringComparer.OrdinalIgnoreCase)
        Dim tg = g_inventorApplication.TransientGeometry
        Dim created As New List(Of Balloon)

        InitialiseViewBoundingBox(view)

        For Each row As PartsListRow In partList.PartsListRows
            If row Is Nothing OrElse row.Ballooned OrElse Not row.Visible Then Continue For

            ' ---- inlined GetBalloonAttachGeometryFiltered ----
            Dim gi As GeometryIntent = Nothing

            If wanted.Count > 0 Then
                ' All occurrences for this row's referenced file
                Dim refDocDesc As DocumentDescriptor = row.ReferencedFiles.Item(1).DocumentDescriptor
                Dim occAll As ComponentOccurrencesEnumerator =
                view.ReferencedDocumentDescriptor.ReferencedDocument.
                    ComponentDefinition.Occurrences.AllReferencedOccurrences(refDocDesc)

                ' Filter occurrences by base name in "wanted"
                Dim occFiltered As New List(Of ComponentOccurrence)
                For Each occ As ComponentOccurrence In occAll
                    If occ Is Nothing OrElse occ.Suppressed Then Continue For

                    ' ---- inlined NormalizeOccName ----
                    Dim nm As String = occ.Name
                    Dim baseName As String
                    If String.IsNullOrEmpty(nm) Then
                        baseName = nm
                    Else
                        Dim p As Integer = nm.IndexOf(":"c)
                        baseName = If(p >= 0, nm.Substring(0, p), nm)
                    End If
                    If wanted.Contains(baseName) Then occFiltered.Add(occ)
                Next

                If occFiltered.Count > 0 Then
                    ' ---- inlined GetCurvesFromOccasList ----
                    Dim curves As New List(Of DrawingCurve)
                    For Each o As ComponentOccurrence In occFiltered
                        If o Is Nothing OrElse o.Suppressed Then Continue For
                        For Each dc As DrawingCurve In view.DrawingCurves(o)
                            If Not curves.Contains(dc) Then curves.Add(dc)
                        Next
                    Next
                    If curves.Count > 0 Then
                        Dim seg As DrawingCurveSegment = GetBestSegmentFromOccurrence(curves)
                        If seg IsNot Nothing Then
                            Dim sheet As Sheet = seg.Parent.Parent.Parent
                            gi = sheet.CreateGeometryIntent(seg.Parent, GetSegmentMidPoint(seg))
                        End If
                    End If
                End If
            End If
            If gi Is Nothing Then Continue For

            Dim topY As Double = view.Top + topOffsetCm
            Dim midX As Double = view.Left + (view.Width / 2.0)

            Dim leaders As ObjectCollection = g_inventorApplication.TransientObjects.CreateObjectCollection
            leaders.Add(tg.CreatePoint2d(midX, topY))
            leaders.Add(gi)

            Dim b As Balloon = view.Parent.Balloons.Add(leaders)
            created.Add(b)
        Next

        If created.Count > 0 Then
            DistributeBalloonsAlongTopOrBottom(
            created,
            yPos:=view.Top + topOffsetCm,
            xStart:=view.Left,
            xEnd:=view.Left + view.Width)
        End If
    End Sub
```

#### Code Block 13

```vb
Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision }, pCoordinate)
```

#### Code Block 14

```vb
Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision }, pCoordinate)
```

#### Code Block 15

```vb
Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision }, pCoordinate)
```

#### Code Block 16

```vb
Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision }, pCoordinate)
```

#### Code Block 17

```vb
Sheet.Balloons.Add(LeaderPoints)
```

#### Code Block 18

```vb
Sheet.Balloons.Add(LeaderPoints)
```

#### Code Block 19

```vb
Sheet.Balloons.Add(LeaderPoints)
```

#### Code Block 20

```vb
Sheet.Balloons.Add(LeaderPoints)
```

#### Code Block 21

```vb
Sheet.CreateGeometryIntent(DrawingCurve, Point2dOnSelectedSegment)
```

#### Code Block 22

```vb
Sheet.CreateGeometryIntent(DrawingCurve, Point2dOnSelectedSegment)
```

#### Code Block 23

```vb
Sheet.CreateGeometryIntent(DrawingCurve, Point2dOnSelectedSegment)
```

#### Code Block 24

```vb
Sheet.CreateGeometryIntent(DrawingCurve, Point2dOnSelectedSegment)
```

#### Code Block 25

```vb
Sheet.CreateGeometryIntent(DrawingCurve, PointIntentEnum.kMidPointIntent)
Sheet.CreateGeometryIntent(DrawingCurve, PointIntentEnum.kCircularTopPointIntent)
```

#### Code Block 26

```vb
Sheet.CreateGeometryIntent(DrawingCurve, PointIntentEnum.kMidPointIntent)
Sheet.CreateGeometryIntent(DrawingCurve, PointIntentEnum.kCircularTopPointIntent)
```

#### Code Block 27

```vb
Sheet.CreateGeometryIntent(DrawingCurve, PointIntentEnum.kMidPointIntent)
Sheet.CreateGeometryIntent(DrawingCurve, PointIntentEnum.kCircularTopPointIntent)
```

#### Code Block 28

```vb
Sheet.CreateGeometryIntent(DrawingCurve, PointIntentEnum.kMidPointIntent)
Sheet.CreateGeometryIntent(DrawingCurve, PointIntentEnum.kCircularTopPointIntent)
```

#### Code Block 29

```vb
Sheet.CreateGeometryIntent(DrawingCurveSegment, PointIntentEnum.kMidPointIntent)
```

#### Code Block 30

```vb
Sheet.CreateGeometryIntent(DrawingCurveSegment, PointIntentEnum.kMidPointIntent)
```

#### Code Block 31

```vb
Sheet.CreateGeometryIntent(DrawingCurveSegment, PointIntentEnum.kMidPointIntent)
```

#### Code Block 32

```vb
Sheet.CreateGeometryIntent(DrawingCurveSegment, PointIntentEnum.kMidPointIntent)
```

#### Code Block 33

```vb
Sub main()
	Dim selectSet As SelectSet = ThisDrawing.Document.SelectSet
    If selectSet.Count = 0 Then
        Dim selectedObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select a drawing view")
        If selectedObj IsNot Nothing Then selectSet.Select(selectedObj)
    End If
    For Each obj In selectSet
        If TypeOf obj Is DrawingView Then
            AddBallonToView(obj)
        End If
    Next
End Sub

#Region "Auto Balloon"
    Private  Property _blnViewMargin As Double 
    Private  Property _blnVerticalOffset As Double 
    Private  Property _blnHorizontalOffset As Double
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
    Friend Sub AddBallonToView(View As DrawingView)
        Dim PartsList As PartsList = View.Parent.PartsLists.Item(1)
        InitialiseViewBoundingBox(View)
        For Each row As PartsListRow In PartsList.PartsListRows
            If Not Row.Ballooned Then CreateRowItemBalloon(Row, View)
        Next
        ArrangeBalloonsOnView(View)
    End Sub
    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TransGeom As TransientGeometry = ThisApplication.TransientGeometry
        Dim TopLeft As Point2d, TopRight As Point2d, BtmLeft As Point2d, BtmRight As Point2d
        TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)
		
		_blnViewMargin  = 2
    _blnVerticalOffset  = 0.9
     _blnHorizontalOffset  = 1
		
		
    End Sub
    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim TransGeom As TransientGeometry = ThisApplication.TransientGeometry
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub
        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        Dim LeaderPoints As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub
    Private Sub ArrangeBalloonsOnView(View As DrawingView)
        Dim leftBalloon As New List(Of Balloon)
        Dim rightBalloon As New List(Of Balloon)
        Dim topBalloon As New List(Of Balloon)
        Dim btmBalloon As New List(Of Balloon)
        For Each balloon As Balloon In View.Parent.Balloons
            If Balloon.ParentView Is View Then
                If Balloon.Position.X = View.Left - _blnViewMargin Then
                    leftBalloon.Add(Balloon)
                ElseIf Balloon.Position.X = View.Left + View.Width + _blnViewMargin Then
                    rightBalloon.Add(Balloon)
                ElseIf Balloon.Position.Y = View.Top + _blnViewMargin Then
                    topBalloon.Add(Balloon)
                ElseIf Balloon.Position.Y = View.Top - View.Height - _blnViewMargin Then
                    btmBalloon.Add(Balloon)
                End If
            End If
        Next
        If leftBalloon.Count > 1 Then ArrangeBalloonVerticaly(leftBalloon)
        If rightBalloon.Count > 1 Then ArrangeBalloonVerticaly(rightBalloon)
        If topBalloon.Count > 1 Then ArrangeBalloonHorizontaly(topBalloon)
        If btmBalloon.Count > 1 Then ArrangeBalloonHorizontaly(btmBalloon)
    End Sub
    Private Sub ArrangeBalloonVerticaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.Y.CompareTo(x.Position.Y))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.Y - ballons(index).Position.Y < _blnVerticalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.Y = ballons(index - 1).Position.Y - _blnVerticalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Sub ArrangeBalloonHorizontaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.X.CompareTo(x.Position.X))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.X - ballons(index).Position.X < _blnHorizontalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.X = ballons(index - 1).Position.X - _blnHorizontalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d

        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double
        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Quadrant not Found"
                Return Nothing
        End Select
        Return leaderPoint
    End Function
    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView)
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle Or PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function
    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim itemOccurrences As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim OccurrencesCurves As List(Of DrawingCurve) = GetCurvesFromOcc(itemOccurrences, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(OccurrencesCurves))
    End Function
#End Region
#Region "Curves analysis methods"
    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim Curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not Curves.Contains(curve) Then Curves.Add(curve)
                Next
            End If
        Next
        Return Curves
    End Function
    Private Function GetBestSegmentFromOccurrence(OccurrenceCurves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0, bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In OccurrenceCurves
            Dim rating As Double
            Dim bestInCurve As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then bestSegment = bestInCurve : bestRating = rating
        Next
        Return bestSegment
    End Function
    Private Function GetBestSegmentFromCurve(Curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In Curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            Dim segmentPoints As List(Of Point2d) = SplitSegment(segment, 10)
            Dim closestDist As Double = Double.PositiveInfinity
            Dim distanceSum As Double = 0
            For Each point As Point2d In segmentPoints
                Dim pointDist As Double = DistanceToViewRangeBox(Point, Curve.Parent)
                If pointDist < closestDist Then closestDist = pointDist
                distanceSum += pointDist
            Next
            Dim avgDistance = distanceSum / segmentPoints.Count
            Dim rating As Double = segLength ' / (avgDistance * closestDist ^ 2)
            If Curve.EdgeType = DrawingEdgeTypeEnum.kTangentEdge Then rating /= 10
            If rating > segmentRating Then bestSegment = segment : segmentRating = rating
        Next
        Return bestSegment
    End Function
    Private Function SplitSegment(Segment As DrawingCurveSegment, SplitPrecision As Integer) As List(Of Point2d)
        Dim pointList As New List(Of Point2d), MinParam, MaxParam As Double, TransGeom As TransientGeometry
        TransGeom = ThisApplication.TransientGeometry
        Segment.Geometry.Evaluator.GetParamExtents(MinParam, MaxParam)
        For i = 0 To SplitPrecision
            Dim pCoordinate(0 To 1) As Double
            Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision}, pCoordinate)
            pointList.Add(TransGeom.CreatePoint2d(pCoordinate(0), pCoordinate(1)))
        Next
        Return pointList
    End Function
    Private Function DistanceToViewRangeBox(TestPoint As Point2d, DView As DrawingView) As Double

        Dim shortest As Double = _topLine.DistanceTo(TestPoint)
        Dim dist As Double = _btmLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        Return shortest
    End Function
    Private Function GetSegmentLength(Segment As DrawingCurveSegment) As Double
        Select Case Segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return Segment.EndPoint.DistanceTo(Segment.StartPoint)
            Case Else
                Return GetCurveLength(Segment.Geometry.Evaluator)
        End Select
    End Function
    Private Function GetSegmentMidPoint(Segment As DrawingCurveSegment) As Point2d
        Dim CurveEval As Curve2dEvaluator = Segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), midPointCoordinates(1), curveLength As Double
        CurveEval.GetParamExtents(minParam, maxParam)
        CurveEval.GetLengthAtParam(minParam, maxParam, curveLength)
        CurveEval.GetParamAtLength(minParam, curveLength / 2, midParam(0))
        CurveEval.GetPointAtParam(midParam, midPointCoordinates)
        Return ThisApplication.TransientGeometry.CreatePoint2d(midPointCoordinates(0), midPointCoordinates(1))
    End Function
    Private Function GetCurveLength(Eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, curveLength As Double
        Eval.GetParamExtents(minParam, maxParam)
        Eval.GetLengthAtParam(minParam, maxParam, curveLength)
        Return curveLength
    End Function
    Private Function GetAttachPoint(Segment As DrawingCurveSegment) As GeometryIntent
        If Segment Is Nothing Then Return Nothing
        Dim DrawingSheet As Sheet = Segment.Parent.Parent.Parent
        If Segment.GeometryType = Curve2dTypeEnum.kCircleCurve2d Or Segment.GeometryType = Curve2dTypeEnum.kEllipseFullCurve2d Then
            Select Case GetQuadrant(Segment.Geometry.Center, Segment.Parent.Parent)
                Case "Top"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularTopPointIntent)
                Case "Bottom"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularBottomPointIntent)
                Case "Left"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularLeftPointIntent)
                Case "Right"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularRightPointIntent)
                Case "Quadrant not Found"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCenterPointIntent)
            End Select
        End If
        Return DrawingSheet.CreateGeometryIntent(Segment.Parent, GetSegmentMidPoint(Segment))
    End Function
#End Region
```

#### Code Block 34

```vb
Sub main()
	Dim selectSet As SelectSet = ThisDrawing.Document.SelectSet
    If selectSet.Count = 0 Then
        Dim selectedObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select a drawing view")
        If selectedObj IsNot Nothing Then selectSet.Select(selectedObj)
    End If
    For Each obj In selectSet
        If TypeOf obj Is DrawingView Then
            AddBallonToView(obj)
        End If
    Next
End Sub

#Region "Auto Balloon"
    Private  Property _blnViewMargin As Double 
    Private  Property _blnVerticalOffset As Double 
    Private  Property _blnHorizontalOffset As Double
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
    Friend Sub AddBallonToView(View As DrawingView)
        Dim PartsList As PartsList = View.Parent.PartsLists.Item(1)
        InitialiseViewBoundingBox(View)
        For Each row As PartsListRow In PartsList.PartsListRows
            If Not Row.Ballooned Then CreateRowItemBalloon(Row, View)
        Next
        ArrangeBalloonsOnView(View)
    End Sub
    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TransGeom As TransientGeometry = ThisApplication.TransientGeometry
        Dim TopLeft As Point2d, TopRight As Point2d, BtmLeft As Point2d, BtmRight As Point2d
        TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)
		
		_blnViewMargin  = 2
    _blnVerticalOffset  = 0.9
     _blnHorizontalOffset  = 1
		
		
    End Sub
    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim TransGeom As TransientGeometry = ThisApplication.TransientGeometry
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub
        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        Dim LeaderPoints As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub
    Private Sub ArrangeBalloonsOnView(View As DrawingView)
        Dim leftBalloon As New List(Of Balloon)
        Dim rightBalloon As New List(Of Balloon)
        Dim topBalloon As New List(Of Balloon)
        Dim btmBalloon As New List(Of Balloon)
        For Each balloon As Balloon In View.Parent.Balloons
            If Balloon.ParentView Is View Then
                If Balloon.Position.X = View.Left - _blnViewMargin Then
                    leftBalloon.Add(Balloon)
                ElseIf Balloon.Position.X = View.Left + View.Width + _blnViewMargin Then
                    rightBalloon.Add(Balloon)
                ElseIf Balloon.Position.Y = View.Top + _blnViewMargin Then
                    topBalloon.Add(Balloon)
                ElseIf Balloon.Position.Y = View.Top - View.Height - _blnViewMargin Then
                    btmBalloon.Add(Balloon)
                End If
            End If
        Next
        If leftBalloon.Count > 1 Then ArrangeBalloonVerticaly(leftBalloon)
        If rightBalloon.Count > 1 Then ArrangeBalloonVerticaly(rightBalloon)
        If topBalloon.Count > 1 Then ArrangeBalloonHorizontaly(topBalloon)
        If btmBalloon.Count > 1 Then ArrangeBalloonHorizontaly(btmBalloon)
    End Sub
    Private Sub ArrangeBalloonVerticaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.Y.CompareTo(x.Position.Y))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.Y - ballons(index).Position.Y < _blnVerticalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.Y = ballons(index - 1).Position.Y - _blnVerticalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Sub ArrangeBalloonHorizontaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.X.CompareTo(x.Position.X))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.X - ballons(index).Position.X < _blnHorizontalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.X = ballons(index - 1).Position.X - _blnHorizontalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d

        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double
        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Quadrant not Found"
                Return Nothing
        End Select
        Return leaderPoint
    End Function
    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView)
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle Or PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function
    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim itemOccurrences As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim OccurrencesCurves As List(Of DrawingCurve) = GetCurvesFromOcc(itemOccurrences, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(OccurrencesCurves))
    End Function
#End Region
#Region "Curves analysis methods"
    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim Curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not Curves.Contains(curve) Then Curves.Add(curve)
                Next
            End If
        Next
        Return Curves
    End Function
    Private Function GetBestSegmentFromOccurrence(OccurrenceCurves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0, bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In OccurrenceCurves
            Dim rating As Double
            Dim bestInCurve As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then bestSegment = bestInCurve : bestRating = rating
        Next
        Return bestSegment
    End Function
    Private Function GetBestSegmentFromCurve(Curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In Curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            Dim segmentPoints As List(Of Point2d) = SplitSegment(segment, 10)
            Dim closestDist As Double = Double.PositiveInfinity
            Dim distanceSum As Double = 0
            For Each point As Point2d In segmentPoints
                Dim pointDist As Double = DistanceToViewRangeBox(Point, Curve.Parent)
                If pointDist < closestDist Then closestDist = pointDist
                distanceSum += pointDist
            Next
            Dim avgDistance = distanceSum / segmentPoints.Count
            Dim rating As Double = segLength ' / (avgDistance * closestDist ^ 2)
            If Curve.EdgeType = DrawingEdgeTypeEnum.kTangentEdge Then rating /= 10
            If rating > segmentRating Then bestSegment = segment : segmentRating = rating
        Next
        Return bestSegment
    End Function
    Private Function SplitSegment(Segment As DrawingCurveSegment, SplitPrecision As Integer) As List(Of Point2d)
        Dim pointList As New List(Of Point2d), MinParam, MaxParam As Double, TransGeom As TransientGeometry
        TransGeom = ThisApplication.TransientGeometry
        Segment.Geometry.Evaluator.GetParamExtents(MinParam, MaxParam)
        For i = 0 To SplitPrecision
            Dim pCoordinate(0 To 1) As Double
            Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision}, pCoordinate)
            pointList.Add(TransGeom.CreatePoint2d(pCoordinate(0), pCoordinate(1)))
        Next
        Return pointList
    End Function
    Private Function DistanceToViewRangeBox(TestPoint As Point2d, DView As DrawingView) As Double

        Dim shortest As Double = _topLine.DistanceTo(TestPoint)
        Dim dist As Double = _btmLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        Return shortest
    End Function
    Private Function GetSegmentLength(Segment As DrawingCurveSegment) As Double
        Select Case Segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return Segment.EndPoint.DistanceTo(Segment.StartPoint)
            Case Else
                Return GetCurveLength(Segment.Geometry.Evaluator)
        End Select
    End Function
    Private Function GetSegmentMidPoint(Segment As DrawingCurveSegment) As Point2d
        Dim CurveEval As Curve2dEvaluator = Segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), midPointCoordinates(1), curveLength As Double
        CurveEval.GetParamExtents(minParam, maxParam)
        CurveEval.GetLengthAtParam(minParam, maxParam, curveLength)
        CurveEval.GetParamAtLength(minParam, curveLength / 2, midParam(0))
        CurveEval.GetPointAtParam(midParam, midPointCoordinates)
        Return ThisApplication.TransientGeometry.CreatePoint2d(midPointCoordinates(0), midPointCoordinates(1))
    End Function
    Private Function GetCurveLength(Eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, curveLength As Double
        Eval.GetParamExtents(minParam, maxParam)
        Eval.GetLengthAtParam(minParam, maxParam, curveLength)
        Return curveLength
    End Function
    Private Function GetAttachPoint(Segment As DrawingCurveSegment) As GeometryIntent
        If Segment Is Nothing Then Return Nothing
        Dim DrawingSheet As Sheet = Segment.Parent.Parent.Parent
        If Segment.GeometryType = Curve2dTypeEnum.kCircleCurve2d Or Segment.GeometryType = Curve2dTypeEnum.kEllipseFullCurve2d Then
            Select Case GetQuadrant(Segment.Geometry.Center, Segment.Parent.Parent)
                Case "Top"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularTopPointIntent)
                Case "Bottom"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularBottomPointIntent)
                Case "Left"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularLeftPointIntent)
                Case "Right"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularRightPointIntent)
                Case "Quadrant not Found"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCenterPointIntent)
            End Select
        End If
        Return DrawingSheet.CreateGeometryIntent(Segment.Parent, GetSegmentMidPoint(Segment))
    End Function
#End Region
```

#### Code Block 35

```vb
Sub main()
	Dim selectSet As SelectSet = ThisDrawing.Document.SelectSet
    If selectSet.Count = 0 Then
        Dim selectedObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select a drawing view")
        If selectedObj IsNot Nothing Then selectSet.Select(selectedObj)
    End If
    For Each obj In selectSet
        If TypeOf obj Is DrawingView Then
            AddBallonToView(obj)
        End If
    Next
End Sub

#Region "Auto Balloon"
    Private  Property _blnViewMargin As Double 
    Private  Property _blnVerticalOffset As Double 
    Private  Property _blnHorizontalOffset As Double
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
    Friend Sub AddBallonToView(View As DrawingView)
        Dim PartsList As PartsList = View.Parent.PartsLists.Item(1)
        InitialiseViewBoundingBox(View)
        For Each row As PartsListRow In PartsList.PartsListRows
            If Not Row.Ballooned Then CreateRowItemBalloon(Row, View)
        Next
        ArrangeBalloonsOnView(View)
    End Sub
    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TransGeom As TransientGeometry = ThisApplication.TransientGeometry
        Dim TopLeft As Point2d, TopRight As Point2d, BtmLeft As Point2d, BtmRight As Point2d
        TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)
		
		_blnViewMargin  = 2
    _blnVerticalOffset  = 0.9
     _blnHorizontalOffset  = 1
		
		
    End Sub
    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim TransGeom As TransientGeometry = ThisApplication.TransientGeometry
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub
        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        Dim LeaderPoints As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub
    Private Sub ArrangeBalloonsOnView(View As DrawingView)
        Dim leftBalloon As New List(Of Balloon)
        Dim rightBalloon As New List(Of Balloon)
        Dim topBalloon As New List(Of Balloon)
        Dim btmBalloon As New List(Of Balloon)
        For Each balloon As Balloon In View.Parent.Balloons
            If Balloon.ParentView Is View Then
                If Balloon.Position.X = View.Left - _blnViewMargin Then
                    leftBalloon.Add(Balloon)
                ElseIf Balloon.Position.X = View.Left + View.Width + _blnViewMargin Then
                    rightBalloon.Add(Balloon)
                ElseIf Balloon.Position.Y = View.Top + _blnViewMargin Then
                    topBalloon.Add(Balloon)
                ElseIf Balloon.Position.Y = View.Top - View.Height - _blnViewMargin Then
                    btmBalloon.Add(Balloon)
                End If
            End If
        Next
        If leftBalloon.Count > 1 Then ArrangeBalloonVerticaly(leftBalloon)
        If rightBalloon.Count > 1 Then ArrangeBalloonVerticaly(rightBalloon)
        If topBalloon.Count > 1 Then ArrangeBalloonHorizontaly(topBalloon)
        If btmBalloon.Count > 1 Then ArrangeBalloonHorizontaly(btmBalloon)
    End Sub
    Private Sub ArrangeBalloonVerticaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.Y.CompareTo(x.Position.Y))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.Y - ballons(index).Position.Y < _blnVerticalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.Y = ballons(index - 1).Position.Y - _blnVerticalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Sub ArrangeBalloonHorizontaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.X.CompareTo(x.Position.X))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.X - ballons(index).Position.X < _blnHorizontalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.X = ballons(index - 1).Position.X - _blnHorizontalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d

        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double
        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Quadrant not Found"
                Return Nothing
        End Select
        Return leaderPoint
    End Function
    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView)
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle Or PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function
    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim itemOccurrences As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim OccurrencesCurves As List(Of DrawingCurve) = GetCurvesFromOcc(itemOccurrences, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(OccurrencesCurves))
    End Function
#End Region
#Region "Curves analysis methods"
    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim Curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not Curves.Contains(curve) Then Curves.Add(curve)
                Next
            End If
        Next
        Return Curves
    End Function
    Private Function GetBestSegmentFromOccurrence(OccurrenceCurves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0, bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In OccurrenceCurves
            Dim rating As Double
            Dim bestInCurve As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then bestSegment = bestInCurve : bestRating = rating
        Next
        Return bestSegment
    End Function
    Private Function GetBestSegmentFromCurve(Curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In Curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            Dim segmentPoints As List(Of Point2d) = SplitSegment(segment, 10)
            Dim closestDist As Double = Double.PositiveInfinity
            Dim distanceSum As Double = 0
            For Each point As Point2d In segmentPoints
                Dim pointDist As Double = DistanceToViewRangeBox(Point, Curve.Parent)
                If pointDist < closestDist Then closestDist = pointDist
                distanceSum += pointDist
            Next
            Dim avgDistance = distanceSum / segmentPoints.Count
            Dim rating As Double = segLength ' / (avgDistance * closestDist ^ 2)
            If Curve.EdgeType = DrawingEdgeTypeEnum.kTangentEdge Then rating /= 10
            If rating > segmentRating Then bestSegment = segment : segmentRating = rating
        Next
        Return bestSegment
    End Function
    Private Function SplitSegment(Segment As DrawingCurveSegment, SplitPrecision As Integer) As List(Of Point2d)
        Dim pointList As New List(Of Point2d), MinParam, MaxParam As Double, TransGeom As TransientGeometry
        TransGeom = ThisApplication.TransientGeometry
        Segment.Geometry.Evaluator.GetParamExtents(MinParam, MaxParam)
        For i = 0 To SplitPrecision
            Dim pCoordinate(0 To 1) As Double
            Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision}, pCoordinate)
            pointList.Add(TransGeom.CreatePoint2d(pCoordinate(0), pCoordinate(1)))
        Next
        Return pointList
    End Function
    Private Function DistanceToViewRangeBox(TestPoint As Point2d, DView As DrawingView) As Double

        Dim shortest As Double = _topLine.DistanceTo(TestPoint)
        Dim dist As Double = _btmLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        Return shortest
    End Function
    Private Function GetSegmentLength(Segment As DrawingCurveSegment) As Double
        Select Case Segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return Segment.EndPoint.DistanceTo(Segment.StartPoint)
            Case Else
                Return GetCurveLength(Segment.Geometry.Evaluator)
        End Select
    End Function
    Private Function GetSegmentMidPoint(Segment As DrawingCurveSegment) As Point2d
        Dim CurveEval As Curve2dEvaluator = Segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), midPointCoordinates(1), curveLength As Double
        CurveEval.GetParamExtents(minParam, maxParam)
        CurveEval.GetLengthAtParam(minParam, maxParam, curveLength)
        CurveEval.GetParamAtLength(minParam, curveLength / 2, midParam(0))
        CurveEval.GetPointAtParam(midParam, midPointCoordinates)
        Return ThisApplication.TransientGeometry.CreatePoint2d(midPointCoordinates(0), midPointCoordinates(1))
    End Function
    Private Function GetCurveLength(Eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, curveLength As Double
        Eval.GetParamExtents(minParam, maxParam)
        Eval.GetLengthAtParam(minParam, maxParam, curveLength)
        Return curveLength
    End Function
    Private Function GetAttachPoint(Segment As DrawingCurveSegment) As GeometryIntent
        If Segment Is Nothing Then Return Nothing
        Dim DrawingSheet As Sheet = Segment.Parent.Parent.Parent
        If Segment.GeometryType = Curve2dTypeEnum.kCircleCurve2d Or Segment.GeometryType = Curve2dTypeEnum.kEllipseFullCurve2d Then
            Select Case GetQuadrant(Segment.Geometry.Center, Segment.Parent.Parent)
                Case "Top"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularTopPointIntent)
                Case "Bottom"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularBottomPointIntent)
                Case "Left"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularLeftPointIntent)
                Case "Right"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularRightPointIntent)
                Case "Quadrant not Found"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCenterPointIntent)
            End Select
        End If
        Return DrawingSheet.CreateGeometryIntent(Segment.Parent, GetSegmentMidPoint(Segment))
    End Function
#End Region
```

#### Code Block 36

```vb
Sub main()
	Dim selectSet As SelectSet = ThisDrawing.Document.SelectSet
    If selectSet.Count = 0 Then
        Dim selectedObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select a drawing view")
        If selectedObj IsNot Nothing Then selectSet.Select(selectedObj)
    End If
    For Each obj In selectSet
        If TypeOf obj Is DrawingView Then
            AddBallonToView(obj)
        End If
    Next
End Sub

#Region "Auto Balloon"
    Private  Property _blnViewMargin As Double 
    Private  Property _blnVerticalOffset As Double 
    Private  Property _blnHorizontalOffset As Double
    Private Property _topLine As LineSegment2d
    Private Property _btmLine As LineSegment2d
    Private Property _rightLine As LineSegment2d
    Private Property _leftLine As LineSegment2d
    Friend Sub AddBallonToView(View As DrawingView)
        Dim PartsList As PartsList = View.Parent.PartsLists.Item(1)
        InitialiseViewBoundingBox(View)
        For Each row As PartsListRow In PartsList.PartsListRows
            If Not Row.Ballooned Then CreateRowItemBalloon(Row, View)
        Next
        ArrangeBalloonsOnView(View)
    End Sub
    Private Sub InitialiseViewBoundingBox(DView As DrawingView)
        Dim TransGeom As TransientGeometry = ThisApplication.TransientGeometry
        Dim TopLeft As Point2d, TopRight As Point2d, BtmLeft As Point2d, BtmRight As Point2d
        TopLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top)
        TopRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top)
        BtmLeft = TransGeom.CreatePoint2d(DView.Left, DView.Top - DView.Height)
        BtmRight = TransGeom.CreatePoint2d(DView.Left + DView.Width, DView.Top - DView.Height)

        _topLine = TransGeom.CreateLineSegment2d(TopLeft, TopRight)
        _btmLine = TransGeom.CreateLineSegment2d(BtmLeft, BtmRight)
        _leftLine = TransGeom.CreateLineSegment2d(TopLeft, BtmLeft)
        _rightLine = TransGeom.CreateLineSegment2d(TopRight, BtmRight)
		
		_blnViewMargin  = 2
    _blnVerticalOffset  = 0.9
     _blnHorizontalOffset  = 1
		
		
    End Sub
    Private Sub CreateRowItemBalloon(Item As PartsListRow, View As DrawingView)
        Dim TransGeom As TransientGeometry = ThisApplication.TransientGeometry
        Dim attachPoint As GeometryIntent = GetBalloonAttachGeometry(Item, View)
        If attachPoint Is Nothing Then Exit Sub
        Dim leaderPoint As Point2d = GetBalloonPosition(attachPoint.PointOnSheet, View)
        Dim LeaderPoints As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
        LeaderPoints.Add(leaderPoint)
        LeaderPoints.Add(attachPoint)
        View.Parent.Balloons.Add(LeaderPoints)
    End Sub
    Private Sub ArrangeBalloonsOnView(View As DrawingView)
        Dim leftBalloon As New List(Of Balloon)
        Dim rightBalloon As New List(Of Balloon)
        Dim topBalloon As New List(Of Balloon)
        Dim btmBalloon As New List(Of Balloon)
        For Each balloon As Balloon In View.Parent.Balloons
            If Balloon.ParentView Is View Then
                If Balloon.Position.X = View.Left - _blnViewMargin Then
                    leftBalloon.Add(Balloon)
                ElseIf Balloon.Position.X = View.Left + View.Width + _blnViewMargin Then
                    rightBalloon.Add(Balloon)
                ElseIf Balloon.Position.Y = View.Top + _blnViewMargin Then
                    topBalloon.Add(Balloon)
                ElseIf Balloon.Position.Y = View.Top - View.Height - _blnViewMargin Then
                    btmBalloon.Add(Balloon)
                End If
            End If
        Next
        If leftBalloon.Count > 1 Then ArrangeBalloonVerticaly(leftBalloon)
        If rightBalloon.Count > 1 Then ArrangeBalloonVerticaly(rightBalloon)
        If topBalloon.Count > 1 Then ArrangeBalloonHorizontaly(topBalloon)
        If btmBalloon.Count > 1 Then ArrangeBalloonHorizontaly(btmBalloon)
    End Sub
    Private Sub ArrangeBalloonVerticaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.Y.CompareTo(x.Position.Y))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.Y - ballons(index).Position.Y < _blnVerticalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.Y = ballons(index - 1).Position.Y - _blnVerticalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Sub ArrangeBalloonHorizontaly(ballons As List(Of Balloon))
        ballons.Sort(Function(x, y) y.Position.X.CompareTo(x.Position.X))
        For index = 1 To ballons.Count - 1
            If ballons(index - 1).Position.X - ballons(index).Position.X < _blnHorizontalOffset Then
                Dim NewPos As Point2d = ballons(index).Position.Copy
                NewPos.X = ballons(index - 1).Position.X - _blnHorizontalOffset
                ballons(index).Position = NewPos
            End If
        Next
    End Sub
    Private Function GetBalloonPosition(AttachPoint As Point2d, View As DrawingView) As Point2d

        Dim leaderPoint As Point2d = AttachPoint.Copy
        Dim translationRatio As Double
        Select Case GetQuadrant(AttachPoint, View)
            Case "Top"
                leaderPoint.Y = View.Top + _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Bottom"
                leaderPoint.Y = View.Top - View.Height - _blnViewMargin
                translationRatio = (leaderPoint.Y - View.Center.Y) / (AttachPoint.Y - View.Center.Y)
                leaderPoint.X = View.Center.X + (AttachPoint.X - View.Center.X) * translationRatio
            Case "Left"
                leaderPoint.X = View.Left - _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Right"
                leaderPoint.X = View.Left + View.Width + _blnViewMargin
                translationRatio = (leaderPoint.X - View.Center.X) / (AttachPoint.X - View.Center.X)
                leaderPoint.Y = View.Center.Y + (AttachPoint.Y - View.Center.Y) * translationRatio
            Case "Quadrant not Found"
                Return Nothing
        End Select
        Return leaderPoint
    End Function
    Private Function GetQuadrant(AttachPoint As Point2d, View As DrawingView)
        Dim CornerAngle As Double = Math.Atan2(View.Height, View.Width)
        Dim PointAngle As Double = Math.Atan2(AttachPoint.Y - View.Center.Y, AttachPoint.X - View.Center.X)
        If PointAngle < CornerAngle AndAlso PointAngle > -CornerAngle Then Return "Right"
        If PointAngle > CornerAngle AndAlso PointAngle < Math.PI - CornerAngle Then Return "Top"
        If PointAngle > Math.PI - CornerAngle Or PointAngle < -Math.PI + CornerAngle Then Return "Left"
        If PointAngle > -Math.PI + CornerAngle AndAlso PointAngle < -CornerAngle Then Return "Bottom"
        Return "Quadrant not Found"
    End Function
    Private Function GetBalloonAttachGeometry(Item As PartsListRow, View As DrawingView) As GeometryIntent
        Dim itemOccurrences As ComponentOccurrencesEnumerator = View.ReferencedDocumentDescriptor.ReferencedDocument.ComponentDefinition.Occurrences.AllReferencedOccurrences(Item.ReferencedFiles.Item(1).DocumentDescriptor)
        Dim OccurrencesCurves As List(Of DrawingCurve) = GetCurvesFromOcc(itemOccurrences, View)
        Return GetAttachPoint(GetBestSegmentFromOccurrence(OccurrencesCurves))
    End Function
#End Region
#Region "Curves analysis methods"
    Private Function GetCurvesFromOcc(Occurrences As ComponentOccurrencesEnumerator, View As DrawingView) As List(Of DrawingCurve)
        Dim Curves As New List(Of DrawingCurve)
        For Each occ As ComponentOccurrence In Occurrences
            If Not occ.Suppressed Then
                For Each curve As DrawingCurve In View.DrawingCurves(occ)
                    If Not Curves.Contains(curve) Then Curves.Add(curve)
                Next
            End If
        Next
        Return Curves
    End Function
    Private Function GetBestSegmentFromOccurrence(OccurrenceCurves As List(Of DrawingCurve)) As DrawingCurveSegment
        Dim bestRating As Double = 0, bestSegment As DrawingCurveSegment = Nothing
        For Each curve As DrawingCurve In OccurrenceCurves
            Dim rating As Double
            Dim bestInCurve As DrawingCurveSegment = GetBestSegmentFromCurve(curve, rating)
            If rating > bestRating Then bestSegment = bestInCurve : bestRating = rating
        Next
        Return bestSegment
    End Function
    Private Function GetBestSegmentFromCurve(Curve As DrawingCurve, ByRef segmentRating As Double) As DrawingCurveSegment
        Dim bestSegment As DrawingCurveSegment = Nothing
        segmentRating = 0
        For Each segment As DrawingCurveSegment In Curve.Segments
            Dim segLength As Double = GetSegmentLength(segment)
            Dim segmentPoints As List(Of Point2d) = SplitSegment(segment, 10)
            Dim closestDist As Double = Double.PositiveInfinity
            Dim distanceSum As Double = 0
            For Each point As Point2d In segmentPoints
                Dim pointDist As Double = DistanceToViewRangeBox(Point, Curve.Parent)
                If pointDist < closestDist Then closestDist = pointDist
                distanceSum += pointDist
            Next
            Dim avgDistance = distanceSum / segmentPoints.Count
            Dim rating As Double = segLength ' / (avgDistance * closestDist ^ 2)
            If Curve.EdgeType = DrawingEdgeTypeEnum.kTangentEdge Then rating /= 10
            If rating > segmentRating Then bestSegment = segment : segmentRating = rating
        Next
        Return bestSegment
    End Function
    Private Function SplitSegment(Segment As DrawingCurveSegment, SplitPrecision As Integer) As List(Of Point2d)
        Dim pointList As New List(Of Point2d), MinParam, MaxParam As Double, TransGeom As TransientGeometry
        TransGeom = ThisApplication.TransientGeometry
        Segment.Geometry.Evaluator.GetParamExtents(MinParam, MaxParam)
        For i = 0 To SplitPrecision
            Dim pCoordinate(0 To 1) As Double
            Segment.Geometry.Evaluator.GetPointAtParam({MinParam + i * (MaxParam - MinParam) / SplitPrecision}, pCoordinate)
            pointList.Add(TransGeom.CreatePoint2d(pCoordinate(0), pCoordinate(1)))
        Next
        Return pointList
    End Function
    Private Function DistanceToViewRangeBox(TestPoint As Point2d, DView As DrawingView) As Double

        Dim shortest As Double = _topLine.DistanceTo(TestPoint)
        Dim dist As Double = _btmLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        dist = _leftLine.DistanceTo(TestPoint)
        If dist < shortest Then shortest = dist
        Return shortest
    End Function
    Private Function GetSegmentLength(Segment As DrawingCurveSegment) As Double
        Select Case Segment.GeometryType
            Case Curve2dTypeEnum.kLineCurve2d
                Return Segment.EndPoint.DistanceTo(Segment.StartPoint)
            Case Else
                Return GetCurveLength(Segment.Geometry.Evaluator)
        End Select
    End Function
    Private Function GetSegmentMidPoint(Segment As DrawingCurveSegment) As Point2d
        Dim CurveEval As Curve2dEvaluator = Segment.Geometry.Evaluator
        Dim minParam, maxParam, midParam(0), midPointCoordinates(1), curveLength As Double
        CurveEval.GetParamExtents(minParam, maxParam)
        CurveEval.GetLengthAtParam(minParam, maxParam, curveLength)
        CurveEval.GetParamAtLength(minParam, curveLength / 2, midParam(0))
        CurveEval.GetPointAtParam(midParam, midPointCoordinates)
        Return ThisApplication.TransientGeometry.CreatePoint2d(midPointCoordinates(0), midPointCoordinates(1))
    End Function
    Private Function GetCurveLength(Eval As Curve2dEvaluator) As Double
        Dim minParam As Double, maxParam As Double, curveLength As Double
        Eval.GetParamExtents(minParam, maxParam)
        Eval.GetLengthAtParam(minParam, maxParam, curveLength)
        Return curveLength
    End Function
    Private Function GetAttachPoint(Segment As DrawingCurveSegment) As GeometryIntent
        If Segment Is Nothing Then Return Nothing
        Dim DrawingSheet As Sheet = Segment.Parent.Parent.Parent
        If Segment.GeometryType = Curve2dTypeEnum.kCircleCurve2d Or Segment.GeometryType = Curve2dTypeEnum.kEllipseFullCurve2d Then
            Select Case GetQuadrant(Segment.Geometry.Center, Segment.Parent.Parent)
                Case "Top"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularTopPointIntent)
                Case "Bottom"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularBottomPointIntent)
                Case "Left"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularLeftPointIntent)
                Case "Right"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCircularRightPointIntent)
                Case "Quadrant not Found"
                    Return DrawingSheet.CreateGeometryIntent(Segment.Parent, PointIntentEnum.kCenterPointIntent)
            End Select
        End If
        Return DrawingSheet.CreateGeometryIntent(Segment.Parent, GetSegmentMidPoint(Segment))
    End Function
#End Region
```

#### Code Block 37

```vb
{
  "Baloon1": [
    { "Name": "NAME1" },
    { "Name": "NAME2" },
    { "Name": "NAME3" },
    { "Name": "NAME4" },
    { "Name": "NAME5" },
    { "Name": "NAME6" },
    { "Name": "NAME7" },
    { "Name": "NAME8" },
    { "Name": "NAME9" }
  ],
  "Baloon2": [
    { "Name": "CCNAME1" },
    { "Name": "CCNAME2" },
    { "Name": "CCNAME3" },
    { "Name": "CCNAME4" },
    { "Name": "CCNAME5" }
  ]
}
```

#### Code Block 38

```vb
{
  "Baloon1": [
    { "Name": "NAME1" },
    { "Name": "NAME2" },
    { "Name": "NAME3" },
    { "Name": "NAME4" },
    { "Name": "NAME5" },
    { "Name": "NAME6" },
    { "Name": "NAME7" },
    { "Name": "NAME8" },
    { "Name": "NAME9" }
  ],
  "Baloon2": [
    { "Name": "CCNAME1" },
    { "Name": "CCNAME2" },
    { "Name": "CCNAME3" },
    { "Name": "CCNAME4" },
    { "Name": "CCNAME5" }
  ]
}
```

#### Code Block 39

```vb
{
  "Baloon1": [
    { "Name": "NAME1" },
    { "Name": "NAME2" },
    { "Name": "NAME3" },
    { "Name": "NAME4" },
    { "Name": "NAME5" },
    { "Name": "NAME6" },
    { "Name": "NAME7" },
    { "Name": "NAME8" },
    { "Name": "NAME9" }
  ],
  "Baloon2": [
    { "Name": "CCNAME1" },
    { "Name": "CCNAME2" },
    { "Name": "CCNAME3" },
    { "Name": "CCNAME4" },
    { "Name": "CCNAME5" }
  ]
}
```

#### Code Block 40

```vb
{
  "Baloon1": [
    { "Name": "NAME1" },
    { "Name": "NAME2" },
    { "Name": "NAME3" },
    { "Name": "NAME4" },
    { "Name": "NAME5" },
    { "Name": "NAME6" },
    { "Name": "NAME7" },
    { "Name": "NAME8" },
    { "Name": "NAME9" }
  ],
  "Baloon2": [
    { "Name": "CCNAME1" },
    { "Name": "CCNAME2" },
    { "Name": "CCNAME3" },
    { "Name": "CCNAME4" },
    { "Name": "CCNAME5" }
  ]
}
```

#### Code Block 41

```vb
{
  "Baloon1": [
    { "Name": "x1" },
    { "Name": "x2" },
    { "Name": "x2" },
    { "Name": "x3" },
    { "Name": "x4" },
    { "Name": "x5" },
    { "Name": "x6" },
    { "Name": "x7" },
    { "Name": "x8" }
  ],
  "Baloon2": [
    { "Name": "x9" },
    { "Name": "x10" },
    { "Name": "x11" },
    { "Name": "x12" },
    { "Name": "x13" },
    { "Name": "x14" },
    { "Name": "x15" },
    { "Name": "x16" },
    { "Name": "x17" }
  ]
}
```

#### Code Block 42

```vb
{
  "Baloon1": [
    { "Name": "x1" },
    { "Name": "x2" },
    { "Name": "x2" },
    { "Name": "x3" },
    { "Name": "x4" },
    { "Name": "x5" },
    { "Name": "x6" },
    { "Name": "x7" },
    { "Name": "x8" }
  ],
  "Baloon2": [
    { "Name": "x9" },
    { "Name": "x10" },
    { "Name": "x11" },
    { "Name": "x12" },
    { "Name": "x13" },
    { "Name": "x14" },
    { "Name": "x15" },
    { "Name": "x16" },
    { "Name": "x17" }
  ]
}
```

#### Code Block 43

```vb
{
  "Baloon1": [
    { "Name": "x1" },
    { "Name": "x2" },
    { "Name": "x2" },
    { "Name": "x3" },
    { "Name": "x4" },
    { "Name": "x5" },
    { "Name": "x6" },
    { "Name": "x7" },
    { "Name": "x8" }
  ],
  "Baloon2": [
    { "Name": "x9" },
    { "Name": "x10" },
    { "Name": "x11" },
    { "Name": "x12" },
    { "Name": "x13" },
    { "Name": "x14" },
    { "Name": "x15" },
    { "Name": "x16" },
    { "Name": "x17" }
  ]
}
```

#### Code Block 44

```vb
{
  "Baloon1": [
    { "Name": "x1" },
    { "Name": "x2" },
    { "Name": "x2" },
    { "Name": "x3" },
    { "Name": "x4" },
    { "Name": "x5" },
    { "Name": "x6" },
    { "Name": "x7" },
    { "Name": "x8" }
  ],
  "Baloon2": [
    { "Name": "x9" },
    { "Name": "x10" },
    { "Name": "x11" },
    { "Name": "x12" },
    { "Name": "x13" },
    { "Name": "x14" },
    { "Name": "x15" },
    { "Name": "x16" },
    { "Name": "x17" }
  ]
}
```

---

### 14. Auto constrain in current position with Origin Planes flush or mate

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/auto-constrain-in-current-position-with-origin-planes-flush-or/td-p/10996454](https://forums.autodesk.com/t5/inventor-programming-forum/auto-constrain-in-current-position-with-origin-planes-flush-or/td-p/10996454)

**Author:** SevInventor

**Date:** ‎03-10-2022
	
		
		06:01 AM

**Description:** Auto constrain in current position with Origin Planes flush or mate I’ve created or copy pasted  this Ilogic rule . It measures the distance of the origin planes of each occurrence to the origin planes of the active assembly. Then it creates a constraint of these two planes with the measured value.W...

**Code Snippets (14):**

#### Code Block 1

```vb
Dim oBaseTrans As Matrix = oBaseComponent.Transformation
```

#### Code Block 2

```vb
Dim oParalell As Boolean= curAsmOrPlane.Plane.IsParallelTo(curCompOriPlane.Plane, 0.00001)
Dim oSameDirection As Boolean= curAsmOrPlane.Plane.Normal.IsEqualTo(curCompOriPlane.Plane.Normal)

	


	If oParalell=True Then
'

				If oSameDirection=True Then
				oConstraint=oAsmComp.Constraints.AddFlushConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Zähler))
				End If
				If oSameDirection=False Then
				oConstraint=oAsmComp.Constraints.AddMateConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Zähler))
				End If

	  End If

	Next
	

Next
```

#### Code Block 3

```vb
I try to set a selected occurence as base for constrain the other but i don't know why he didn't work :/Any idea?Sub Main
    
Dim oAsm As AssemblyDocument= ThisApplication.ActiveDocument
On Error Resume Next
'get the active assembly
Dim oAsmComp As AssemblyComponentDefinition= ThisApplication.ActiveDocument.ComponentDefinition

For Each �Constraint In oAsmComp.Constraints
    �Constraint.Delete
Next
'set the Master LOD active
Dim oLODRep As LevelOfDetailRepresentation
oLODRep = oAsmComp.RepresentationsManager.LevelOfDetailRepresentations.Item("Master")
oLODRep.Activate

'Iterate through all of the top level occurrences
Dim oOccurrence As ComponentOccurrence
For Each oOccurrence In oAsmComp.Occurrences

'    'ground everything in the top level
    oOccurrence.Grounded = True

Next
'''''''''''''''''''''''''''''''''''''''''''''''
' Get the occurrences in the select set.
    Dim occurrenceList As New Collection
    Dim entity As Object
    entity = oAsm.Select
    Dim baseOccurrence As ComponentOccurrence
    baseOccurrence = entity
    
'''''''''''''''''''''''''''''''''''''''''''''''


Dim oUM As UnitsOfMeasure = oAsm.UnitsOfMeasure
Dim oOcc As ComponentOccurrence

For Each oOcc In oAsm.ComponentDefinition.Occurrences
    
        Dim oTransform As Matrix
        oTransform = oOcc.Transformation
    
        Dim oOriginLocation As Vector
        oOriginLocation = oTransform.Translation
    
    
    Dim AbstandvonEbene(0 To 3) As Double
    
    AbstandvonEbene(1) = oOriginLocation.X
    AbstandvonEbene(2) = oOriginLocation.Y
    AbstandvonEbene(3) = oOriginLocation.Z
    'Create a proxy for Face0 (The face in the context of the assembly)
    Dim Z�hler As Integer = 1
    'cycle each Origin plane in the top assembly
    For Z�hler = 1 To 3
    
        Dim curAsmOrPlane As WorkPlane = baseOccurrence.WorkPlanes.Item(Z�hler)
        Dim oCompAsmDef As AssemblyComponentDefinition
        Dim oCompPtDef As PartComponentDefinition
        'cycle each Origin plane in the first level Occurence in the assembly
            For Z�hler2 = 1 To 3
                
                If oOcc.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
                    oCompAsmDef = oOcc.Definition
                    oOcc.CreateGeometryProxy(oCompAsmDef.WorkPlanes.Item(Z�hler2),curCompOriPlane)
                
                ElseIf oOcc.DefinitionDocumentType = DocumentTypeEnum.kPartDocumentObject Then
                    oCompPtDef = oOcc.Definition
                    oOcc.CreateGeometryProxy(oCompPtDef.WorkPlanes.Item(Z�hler2), curCompOriPlane)

                End If
                
                Dim oParalell As Boolean= curAsmOrPlane.Plane.IsParallelTo(curCompOriPlane.Plane, 0.00001)
                Dim oSameDirection As Boolean= curAsmOrPlane.Plane.Normal.IsEqualTo(curCompOriPlane.Plane.Normal)
                
                Dim oNV As NameValueMap
                
                    If oParalell=True Then

                        If oSameDirection=True Then
                        oConstraint=oAsmComp.Constraints.AddFlushConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Z�hler))
                        End If
                        If oSameDirection=False Then
                        oConstraint=oAsmComp.Constraints.AddMateConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Z�hler))
                        End If
            
                End If
    
    Next
        

Next    

    oOcc.Grounded = False

Next
End Sub

Private Sub GetPlanes(ByVal Occurrence As ComponentOccurrence, _ 
                      ByRef BaseXY As WorkPlane, _ 
                      ByRef BaseYZ As WorkPlane, _ 
                      ByRef BaseXZ As WorkPlane)
    ' Get the work planes from the definition of the occurrence.
    ' These will be in the context of the part or subassembly, not 
    ' the top-level assembly, which is what we need to return.
     BaseXY = Occurrence.Definition.WorkPlanes.Item(3)
     BaseYZ = Occurrence.Definition.WorkPlanes.Item(1)
     BaseXZ = Occurrence.Definition.WorkPlanes.Item(2)

    ' Create proxies for these planes.  This will act as the work
    ' plane in the context of the top-level assembly.
    Call Occurrence.CreateGeometryProxy(BaseXY, BaseXY)
    Call Occurrence.CreateGeometryProxy(BaseYZ, BaseYZ)
    Call Occurrence.CreateGeometryProxy(BaseXZ, BaseXZ)
End Sub
```

#### Code Block 4

```vb
Sub Main
	
Dim oAsm As AssemblyDocument= ThisApplication.ActiveDocument
On Error Resume Next

'get the active assembly
Dim oAsmComp As AssemblyComponentDefinition= ThisApplication.ActiveDocument.ComponentDefinition
For Each oConstraint In oAsmComp.Constraints

oConstraint.Delete
Next
'set the Master LOD active
Dim oLODRep As LevelOfDetailRepresentation
oLODRep = oAsmComp.RepresentationsManager.LevelOfDetailRepresentations.Item("Master")
oLODRep.Activate

'Iterate through all of the top level occurrences
Dim oOccurrence As ComponentOccurrence
For Each oOccurrence In oAsmComp.Occurrences
'Try

'	'ground everything in the top level
	oOccurrence.Grounded = True
'Catch
'	end try
Next


	Dim oUM As UnitsOfMeasure = oAsm.UnitsOfMeasure
	Dim oOcc As ComponentOccurrence

	For Each oOcc In oAsm.ComponentDefinition.Occurrences


	'Create a proxy for Face0 (The face in the context of the assembly)
Dim Zähler As Integer = 1

'cycle each Origin plane in the top assembly
For Zähler = 1 To 3

Dim curAsmorPlane As WorkPlane = oAsmComp.WorkPlanes.Item(Zähler)

'Dim oComp1 As ComponentOccurrence = oADef.Occurrences.Item(1)

Dim oCompAsmDef As AssemblyComponentDefinition
Dim oCompPtDef As PartComponentDefinition
'cycle each Origin plane in the first level Occurence in the assembly
For Zähler2 = 1 To 3
	
If oOcc.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
	oCompAsmDef = oOcc.Definition
	oOcc.CreateGeometryProxy(oCompAsmDef.WorkPlanes.Item(Zähler2),curCompOriPlane)

ElseIf oOcc.DefinitionDocumentType = DocumentTypeEnum.kPartDocumentObject Then
	oCompPtDef = oOcc.Definition
	oOcc.CreateGeometryProxy(oCompPtDef.WorkPlanes.Item(Zähler2),curCompOriPlane)
	
End If

	'Measure distance
	Dim oNV As NameValueMap
'	Dim Distance As Double

'	Try
'Dim angle As Double = ThisApplication.MeasureTools.
	Dim angle As Double = ThisApplication.MeasureTools.GetAngle(curAsmorPlane, curCompOriPlane)
	'Angle in deg 
'	MsgBox(angle)
	angle = (angle * 180) / PI

	If angle=0 Then
'
				'Convert distance from database units to default units of the document
				Dim Distance1 As Double = ThisApplication.MeasureTools.GetMinimumDistance(curAsmorPlane, curCompOriPlane)
				Dim Distance As Double 
				Dim oConstraint As AssemblyConstraint
				Distance = oUM.ConvertUnits(Distance1, UnitsTypeEnum.kDatabaseLengthUnits, oUM.LengthUnits)
				'Return the value in a messagebox just to control that it's right
				Distance= Round(Distance,3)
'				MsgBox(Distance)
				
				oConstraint=oAsmComp.Constraints.AddMateConstraint(curAsmorPlane, curCompOriPlane, Distance1)
				
		      If oConstraint.HealthStatus = oConstraint.HealthStatus.kInconsistentHealth Then
	          oConstraint.Delete
			  oConstraint = oAsmComp.Constraints.AddMateConstraint(curAsmorPlane, curCompOriPlane, -Distance1)
			  End If
		      If oConstraint.HealthStatus = oConstraint.HealthStatus.kInconsistentHealth Then
	          oConstraint.Delete
			  oConstraint = oAsmComp.Constraints.AddFlushConstraint(curAsmorPlane, curCompOriPlane, Distance1)
			  End If
		      If oConstraint.HealthStatus = oConstraint.HealthStatus.kInconsistentHealth Then
	          oConstraint.Delete
			  oConstraint = oAsmComp.Constraints.AddFlushConstraint(curAsmorPlane, curCompOriPlane, -Distance1)
			  End If
		      If oConstraint.HealthStatus = oConstraint.HealthStatus.kInconsistentHealth Then
	          oConstraint.Delete
			  End If
	  End If
'	Catch
'	End Try
	Next
	

Next	
'Try 
	oOcc.Grounded = False
'	Catch 
'		End try
Next
End Sub
```

#### Code Block 5

```vb
Sub Main
	
Dim oAsm As AssemblyDocument= ThisApplication.ActiveDocument
On Error Resume Next

'get the active assembly
Dim oAsmComp As AssemblyComponentDefinition= ThisApplication.ActiveDocument.ComponentDefinition
For Each öConstraint In oAsmComp.Constraints

öConstraint.Delete
Next
'set the Master LOD active
Dim oLODRep As LevelOfDetailRepresentation
oLODRep = oAsmComp.RepresentationsManager.LevelOfDetailRepresentations.Item("Master")
oLODRep.Activate

'Iterate through all of the top level occurrences
Dim oOccurrence As ComponentOccurrence
For Each oOccurrence In oAsmComp.Occurrences

'	'ground everything in the top level
	oOccurrence.Grounded = True

Next


	Dim oUM As UnitsOfMeasure = oAsm.UnitsOfMeasure
	Dim oOcc As ComponentOccurrence

For Each oOcc In oAsm.ComponentDefinition.Occurrences

	Dim oTransform As Matrix
   	oTransform = oOcc.Transformation

	Dim oOriginLocation As Vector
	oOriginLocation = oTransform.Translation


Dim AbstandvonEbene(0 To 3) As Double

AbstandvonEbene(1) = oOriginLocation.X
AbstandvonEbene(2) = oOriginLocation.Y
AbstandvonEbene(3) = oOriginLocation.Z



	'Create a proxy for Face0 (The face in the context of the assembly)
Dim Zähler As Integer = 1

'cycle each Origin plane in the top assembly
For Zähler = 1 To 3

Dim curAsmOrPlane As WorkPlane = oAsmComp.WorkPlanes.Item(Zähler)
'oOcc.CreateGeometryProxy(curAsmOrPlane1, curAsmOrPlane)

'Dim oComp1 As ComponentOccurrence = oADef.Occurrences.Item(1)

Dim oCompAsmDef As AssemblyComponentDefinition
Dim oCompPtDef As PartComponentDefinition
'cycle each Origin plane in the first level Occurence in the assembly
For Zähler2 = 1 To 3
	
If oOcc.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
	oCompAsmDef = oOcc.Definition
	oOcc.CreateGeometryProxy(oCompAsmDef.WorkPlanes.Item(Zähler2),curCompOriPlane)

ElseIf oOcc.DefinitionDocumentType = DocumentTypeEnum.kPartDocumentObject Then
	oCompPtDef = oOcc.Definition
	oOcc.CreateGeometryProxy(oCompPtDef.WorkPlanes.Item(Zähler2), curCompOriPlane)
	
	

	
End If

Dim oParalell As Boolean= curAsmOrPlane.Plane.IsParallelTo(curCompOriPlane.Plane, 0.00001)
Dim oSameDirection As Boolean= curAsmOrPlane.Plane.Normal.IsEqualTo(curCompOriPlane.Plane.Normal)

	Dim oNV As NameValueMap


	If oParalell=True Then
'

				If oSameDirection=True Then
				oConstraint=oAsmComp.Constraints.AddFlushConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Zähler))
				End If
				If oSameDirection=False Then
				oConstraint=oAsmComp.Constraints.AddMateConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Zähler))
				End If

	  End If

	Next
	

Next	

	oOcc.Grounded = False

Next
End Sub
```

#### Code Block 6

```vb
Sub Main
	Dim oBaseComponent As ComponentOccurrence = PickComponent("Pick Base Component.")
	If IsNothing(oBaseComponent) Then Exit Sub
		oBaseComponent.Grounded = True
	Dim oADef As AssemblyComponentDefinition = oBaseComponent.Parent
	Dim oConsts As AssemblyConstraints = oADef.Constraints
	oTrans = ThisApplication.TransactionManager.StartTransaction(oADef.Document, "Constrain Components (API)")
	Dim oBaseWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oBaseComponent)
	If IsNothing(oBaseWPPs) OrElse (Not oBaseWPPs.Count = 3) Then
		MsgBox("Failed to get 3 WorkPlaneProxy objects from Base component. Exiting.", vbCritical, "")
		oTrans.Abort
		Exit Sub
	End If
	Dim oBaseTrans As Matrix = oBaseComponent.Transformation
	
	'<<<< Good Point For Loop Of Remaining Code >>>>
	Dim oCompToMove As ComponentOccurrence = PickComponent("Pick Component To Move.")
	If IsNothing(oCompToMove) Then oTrans.Abort : Exit Sub
		oCompToMove.Grounded = True
	Dim oCompToMoveWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oCompToMove)
	If IsNothing(oCompToMoveWPPs) OrElse (Not oCompToMoveWPPs.Count = 3) Then
		MsgBox("Failed to get 3 WorkPlaneProxy objects from component to move. Exiting.", vbCritical, "")
		oTrans.Abort
		Exit Sub
	End If
	DeleteConstraints(oCompToMove)
	Dim oCompToMoveTrans As Matrix = oCompToMove.Transformation
	
	Dim oLocationBase As Vector
    oLocationBase = oBaseTrans.Translation
	
	Dim oOriginLocation As Vector
    oOriginLocation = oCompToMoveTrans.Translation

    Dim Calcdistance(0 To 2) As Double
    
    Calcdistance(0) = (oLocationBase.X-oOriginLocation.X)*(-1)
    Calcdistance(1) = (oLocationBase.Y-oOriginLocation.Y)*(-1)
    Calcdistance(2) = (oLocationBase.Z-oOriginLocation.Z)*(-1)
	

	For i As Integer = 0 To 2
		For i2 As Integer = 0 To 2
		Dim oParallel As Boolean = oBaseWPPs.Item(i).Plane.IsParallelTo(oCompToMoveWPPs.Item(i2).Plane, 0.00001)
		Dim oSameDirection As Boolean=False
		oSameDirection= oBaseWPPs.Item(i).Plane.Normal.IsEqualTo(oCompToMoveWPPs.Item(i2).Plane.Normal)

		If oParallel=True Then
'

				If oSameDirection=True Then
				oConstraint=oConsts.AddFlushConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i2), Calcdistance(i))
				End If
				If oSameDirection=False Then
				oConstraint=oConsts.AddMateConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i2), Calcdistance(i))
				End If

	  End If

	Next
	

	
'	oConst = oConsts.AddFlushConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i), 0)
MsgBox(Calcdistance(i))
	Next
	'<<<< End Loop Here, If Using One >>>>
	oTrans.End
End Sub

Function PickComponent(oPrompt As String) As ComponentOccurrence
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, oPrompt)
	If IsNothing(oObj) OrElse (TypeOf oObj Is ComponentOccurrence = False) Then Return Nothing
	Dim oOcc As ComponentOccurrence = oObj
	Return oOcc
End Function

Function GetComponentOriginPlaneProxies(oComp As ComponentOccurrence) As List(Of WorkPlaneProxy)
	If IsNothing(oComp) Then Return Nothing
	Dim oWPs As WorkPlanes = Nothing
	Dim oWPPs As New List(Of WorkPlaneProxy)
	If TypeOf oComp.Definition Is PartComponentDefinition Or _
		TypeOf oComp.Definition Is AssemblyComponentDefinition Then
		oWPs = oComp.Definition.WorkPlanes
	Else
		Return Nothing
	End If
	For i As Integer = 1 To 3
		Dim oWPP As WorkPlaneProxy = Nothing
		oWP = oWPs.Item(i)
		oComp.CreateGeometryProxy(oWP, oWPP)
		oWPPs.Add(oWPP)
	Next
	Return oWPPs
End Function

Sub DeleteConstraints(oComp As ComponentOccurrence)
	If IsNothing(oComp) Then Exit Sub
	If oComp.Constraints.Count = 0 Then Exit Sub
	For Each oConst As AssemblyConstraint In oComp.Constraints
		oConst.Delete
	Next
End Sub
```

#### Code Block 7

```vb
Sub Main
	Dim oBaseComponent As ComponentOccurrence = PickComponent("Pick Base Component.")
	If IsNothing(oBaseComponent) Then Exit Sub
		oBaseComponent.Grounded = True
	Dim oADef As AssemblyComponentDefinition = oBaseComponent.Parent
	Dim oConsts As AssemblyConstraints = oADef.Constraints
	oTrans = ThisApplication.TransactionManager.StartTransaction(oADef.Document, "Constrain Components (API)")
	Dim oBaseWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oBaseComponent)
	If IsNothing(oBaseWPPs) OrElse (Not oBaseWPPs.Count = 3) Then
		MsgBox("Failed to get 3 WorkPlaneProxy objects from Base component. Exiting.", vbCritical, "")
		oTrans.Abort
		Exit Sub
	End If
	Dim oBaseTrans As Matrix = oBaseComponent.Transformation
	
	'<<<< Good Point For Loop Of Remaining Code >>>>
	Dim oCompToMove As ComponentOccurrence = PickComponent("Pick Component To Move.")
	If IsNothing(oCompToMove) Then oTrans.Abort : Exit Sub
		oCompToMove.Grounded = True
	Dim oCompToMoveWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oCompToMove)
	If IsNothing(oCompToMoveWPPs) OrElse (Not oCompToMoveWPPs.Count = 3) Then
		MsgBox("Failed to get 3 WorkPlaneProxy objects from component to move. Exiting.", vbCritical, "")
		oTrans.Abort
		Exit Sub
	End If
	DeleteConstraints(oCompToMove)

	

	For i As Integer = 0 To 2
		For i2 As Integer = 0 To 2
		Dim oParallel As Boolean = oBaseWPPs.Item(i).Plane.IsParallelTo(oCompToMoveWPPs.Item(i2).Plane, 0.00001)
		Dim oSameDirection As Boolean=False
		oSameDirection= oBaseWPPs.Item(i).Plane.Normal.IsEqualTo(oCompToMoveWPPs.Item(i2).Plane.Normal)
		oOffSet = oBaseWPPs.Item(i).Plane.DistanceTo(oCompToMoveWPPs.Item(i2).Plane.RootPoint)
		If oParallel=True Then
'

				If oSameDirection=True Then
				oConstraint=oConsts.AddFlushConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i2), oOffSet)
				End If
				If oSameDirection=False Then
				oConstraint=oConsts.AddMateConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i2), oOffSet)
				End If
	  			End If

		Next
	Next
	'<<<< End Loop Here, If Using One >>>>
	oTrans.End
	oCompToMove.Grounded = False
	oBaseComponent.Grounded = False
End Sub

Function PickComponent(oPrompt As String) As ComponentOccurrence
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, oPrompt)
	If IsNothing(oObj) OrElse (TypeOf oObj Is ComponentOccurrence = False) Then Return Nothing
	Dim oOcc As ComponentOccurrence = oObj
	Return oOcc
End Function

Function GetComponentOriginPlaneProxies(oComp As ComponentOccurrence) As List(Of WorkPlaneProxy)
	If IsNothing(oComp) Then Return Nothing
	Dim oWPs As WorkPlanes = Nothing
	Dim oWPPs As New List(Of WorkPlaneProxy)
	If TypeOf oComp.Definition Is PartComponentDefinition Or _
		TypeOf oComp.Definition Is AssemblyComponentDefinition Then
		oWPs = oComp.Definition.WorkPlanes
	Else
		Return Nothing
	End If
	For i As Integer = 1 To 3
		Dim oWPP As WorkPlaneProxy = Nothing
		oWP = oWPs.Item(i)
		oComp.CreateGeometryProxy(oWP, oWPP)
		oWPPs.Add(oWPP)
	Next
	Return oWPPs
End Function

Sub DeleteConstraints(oComp As ComponentOccurrence)
	If IsNothing(oComp) Then Exit Sub
	If oComp.Constraints.Count = 0 Then Exit Sub
	For Each oConst As AssemblyConstraint In oComp.Constraints
		oConst.Delete
	Next
End Sub
```

#### Code Block 8

```vb
Sub Main
	Dim oBaseComponent As ComponentOccurrence = PickComponent("Pick Base Component.")
	If IsNothing(oBaseComponent) Then Exit Sub
	Dim oADef As AssemblyComponentDefinition = oBaseComponent.Parent
	Dim oConsts As AssemblyConstraints = oADef.Constraints
	oTrans = ThisApplication.TransactionManager.StartTransaction(oADef.Document, "Constrain Components (API)")
	Dim oBaseWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oBaseComponent)
	If IsNothing(oBaseWPPs) OrElse (Not oBaseWPPs.Count = 3) Then
		MsgBox("Failed to get 3 WorkPlaneProxy objects from Base component. Exiting.", vbCritical, "")
		oTrans.Abort
		Exit Sub
	End If
	Dim oBaseTrans As Matrix = oBaseComponent.Transformation
	'<<<< Good Point For Loop Of Remaining Code >>>>
	Dim oCompToMove As ComponentOccurrence = PickComponent("Pick Component To Move.")
	If IsNothing(oCompToMove) Then oTrans.Abort : Exit Sub
	Dim oCompToMoveWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oCompToMove)
	If IsNothing(oCompToMoveWPPs) OrElse (Not oCompToMoveWPPs.Count = 3) Then
		MsgBox("Failed to get 3 WorkPlaneProxy objects from component to move. Exiting.", vbCritical, "")
		oTrans.Abort
		Exit Sub
	End If
	DeleteConstraints(oCompToMove)
	oCompToMove.Transformation = oBaseTrans
	
	For i As Integer = 0 To 2
		oConst = oConsts.AddFlushConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i), 0)
	Next
	'<<<< End Loop Here, If Using One >>>>
	oTrans.End
End Sub

Function PickComponent(oPrompt As String) As ComponentOccurrence
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, oPrompt)
	If IsNothing(oObj) OrElse (TypeOf oObj Is ComponentOccurrence = False) Then Return Nothing
	Dim oOcc As ComponentOccurrence = oObj
	Return oOcc
End Function

Function GetComponentOriginPlaneProxies(oComp As ComponentOccurrence) As List(Of WorkPlaneProxy)
	If IsNothing(oComp) Then Return Nothing
	Dim oWPs As WorkPlanes = Nothing
	Dim oWPPs As New List(Of WorkPlaneProxy)
	If TypeOf oComp.Definition Is PartComponentDefinition Or _
		TypeOf oComp.Definition Is AssemblyComponentDefinition Then
		oWPs = oComp.Definition.WorkPlanes
	Else
		Return Nothing
	End If
	For i As Integer = 1 To 3
		Dim oWPP As WorkPlaneProxy = Nothing
		oWP = oWPs.Item(i)
		oComp.CreateGeometryProxy(oWP, oWPP)
		oWPPs.Add(oWPP)
	Next
	Return oWPPs
End Function

Sub DeleteConstraints(oComp As ComponentOccurrence)
	If IsNothing(oComp) Then Exit Sub
	If oComp.Constraints.Count = 0 Then Exit Sub
	For Each oConst As AssemblyConstraint In oComp.Constraints
		oConst.Delete
	Next
End Sub
```

#### Code Block 9

```vb
Sub Main
	Dim oBaseComponent As ComponentOccurrence = PickComponent("Pick Base Component.")
	If IsNothing(oBaseComponent) Then Exit Sub
	Dim oADef As AssemblyComponentDefinition = oBaseComponent.Parent
	Dim oConsts As AssemblyConstraints = oADef.Constraints
	oTrans = ThisApplication.TransactionManager.StartTransaction(oADef.Document, "Constrain Components (API)")
	Dim oBaseWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oBaseComponent)
	If IsNothing(oBaseWPPs) OrElse (Not oBaseWPPs.Count = 3) Then
		MsgBox("Failed to get 3 WorkPlaneProxy objects from Base component. Exiting.", vbCritical, "")
		oTrans.Abort
		Exit Sub
	End If
	Dim oBaseTrans As Matrix = oBaseComponent.Transformation
	'<<<< Good Point For Loop Of Remaining Code >>>>
	Dim oCompToMove As ComponentOccurrence = PickComponent("Pick Component To Move.")
	If IsNothing(oCompToMove) Then oTrans.Abort : Exit Sub
	Dim oCompToMoveWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oCompToMove)
	If IsNothing(oCompToMoveWPPs) OrElse (Not oCompToMoveWPPs.Count = 3) Then
		MsgBox("Failed to get 3 WorkPlaneProxy objects from component to move. Exiting.", vbCritical, "")
		oTrans.Abort
		Exit Sub
	End If
	DeleteConstraints(oCompToMove)
	oCompToMove.Transformation = oBaseTrans
	
	For i As Integer = 0 To 2
		oConst = oConsts.AddFlushConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i), 0)
	Next
	'<<<< End Loop Here, If Using One >>>>
	oTrans.End
End Sub

Function PickComponent(oPrompt As String) As ComponentOccurrence
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, oPrompt)
	If IsNothing(oObj) OrElse (TypeOf oObj Is ComponentOccurrence = False) Then Return Nothing
	Dim oOcc As ComponentOccurrence = oObj
	Return oOcc
End Function

Function GetComponentOriginPlaneProxies(oComp As ComponentOccurrence) As List(Of WorkPlaneProxy)
	If IsNothing(oComp) Then Return Nothing
	Dim oWPs As WorkPlanes = Nothing
	Dim oWPPs As New List(Of WorkPlaneProxy)
	If TypeOf oComp.Definition Is PartComponentDefinition Or _
		TypeOf oComp.Definition Is AssemblyComponentDefinition Then
		oWPs = oComp.Definition.WorkPlanes
	Else
		Return Nothing
	End If
	For i As Integer = 1 To 3
		Dim oWPP As WorkPlaneProxy = Nothing
		oWP = oWPs.Item(i)
		oComp.CreateGeometryProxy(oWP, oWPP)
		oWPPs.Add(oWPP)
	Next
	Return oWPPs
End Function

Sub DeleteConstraints(oComp As ComponentOccurrence)
	If IsNothing(oComp) Then Exit Sub
	If oComp.Constraints.Count = 0 Then Exit Sub
	For Each oConst As AssemblyConstraint In oComp.Constraints
		oConst.Delete
	Next
End Sub
```

#### Code Block 10

```vb
Sub Main
	Dim oBaseComponent As ComponentOccurrence = PickComponent("Pick Base Component.")
	oDoc = ThisDoc.Document
	If IsNothing(oBaseComponent) Then Exit Sub
		oBaseComponent.Grounded = True
	Dim oADef As AssemblyComponentDefinition = oBaseComponent.Parent
	Dim oConsts As AssemblyConstraints = oADef.Constraints
	oTrans = ThisApplication.TransactionManager.StartTransaction(oADef.Document, "Constrain Components (API)")
	Dim oOcc As ComponentOccurrence
	Dim oOccCol As Inventor.ObjectCollection
	oOccCol = ThisApplication.TransientObjects.CreateObjectCollection
	Dim oBaseWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oBaseComponent)
	If IsNothing(oBaseWPPs) OrElse (Not oBaseWPPs.Count = 3) Then
		MsgBox("Failed to get 3 WorkPlaneProxy objects from Base component. Exiting.", vbCritical, "")
		oTrans.Abort
		Exit Sub
	End If
Do
	'Ask user for a selection
	oOcc = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a component :")
	If Not oOcc Is  Nothing Then
	'Add component to collection
	oOccCol.Add(oOcc)
	'Set selected component inactive
	oOcc.Enabled = False
	End If
	Loop While Not oOcc Is Nothing 
	'Add collection to selection
	oDoc.SelectSet.SelectMultiple(oOccCol)
	oSelSet = oDoc.SelectSet
	
	'<<<< Good Point For Loop Of Remaining Code >>>>
	

		
For Each oOcc In oSelSet
		oOcc.Grounded = True
	Dim oOccWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oOcc)
	If IsNothing(oOccWPPs) OrElse (Not oOccWPPs.Count = 3) Then
		MsgBox("Failed to get 3 WorkPlaneProxy objects from component to move. Exiting.", vbCritical, "")
		oTrans.Abort
		Exit Sub
	End If
'	DeleteConstraints(oOcc)

	

	For i As Integer = 0 To 2
		For i2 As Integer = 0 To 2
		Dim oParallel As Boolean = oBaseWPPs.Item(i).Plane.IsParallelTo(oOccWPPs.Item(i2).Plane, 0.00001)
		Dim oSameDirection As Boolean=False
		oSameDirection= oBaseWPPs.Item(i).Plane.Normal.IsEqualTo(oOccWPPs.Item(i2).Plane.Normal)
		oOffSet = oBaseWPPs.Item(i).Plane.DistanceTo(oOccWPPs.Item(i2).Plane.RootPoint)
'		msgbox(oOffset)
		If oParallel=True Then


				If oSameDirection = True Then
					Try
				oConstraint = oConsts.AddFlushConstraint(oBaseWPPs.Item(i), oOccWPPs.Item(i2), oOffSet)
				Catch
					End Try
				End If
				
				If oSameDirection = False Then
					Try
				oConstraint = oConsts.AddMateConstraint(oBaseWPPs.Item(i), oOccWPPs.Item(i2), oOffSet)
				Catch
					end try
				End If
	  			End If

		Next
	Next
	'<<<< End Loop Here, If Using One >>>>

	oOcc.Grounded = False
	oOcc.Enabled = True
	Next
	oBaseComponent.Grounded = False
	oDoc.SelectSet.Clear
	
	oTrans.End
End Sub

Function PickComponent(oPrompt As String) As ComponentOccurrence
    oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, oPrompt)
    If IsNothing(oObj) OrElse (TypeOf oObj Is ComponentOccurrence = False) Then Return Nothing
    Dim oOcc As ComponentOccurrence = oObj
    Return oOcc
End Function

Function GetComponentOriginPlaneProxies(oComp As ComponentOccurrence) As List(Of WorkPlaneProxy)
    If IsNothing(oComp) Then Return Nothing
    Dim oWPs As WorkPlanes = Nothing
    Dim oWPPs As New List(Of WorkPlaneProxy)
    If TypeOf oComp.Definition Is PartComponentDefinition Or _
        TypeOf oComp.Definition Is AssemblyComponentDefinition Then
        oWPs = oComp.Definition.WorkPlanes
    Else
        Return Nothing
    End If
    For i As Integer = 1 To 3
        Dim oWPP As WorkPlaneProxy = Nothing
        oWP = oWPs.Item(i)
        oComp.CreateGeometryProxy(oWP, oWPP)
        oWPPs.Add(oWPP)
    Next
    Return oWPPs
End Function

Sub DeleteConstraints(oComp As ComponentOccurrence)
    If IsNothing(oComp) Then Exit Sub
    If oComp.Constraints.Count = 0 Then Exit Sub
    For Each oConst As AssemblyConstraint In oComp.Constraints
        oConst.Delete
    Next
End Sub
```

#### Code Block 11

```vb
Sub Main
    Dim oBaseComponent As ComponentOccurrence = PickComponent("Pick Base Component.")
    If IsNothing(oBaseComponent) Then Exit Sub
    Dim oADef As AssemblyComponentDefinition = oBaseComponent.Parent
    Dim oConsts As AssemblyConstraints = oADef.Constraints
    oTrans = ThisApplication.TransactionManager.StartTransaction(oADef.Document, "Constrain Components (API)")
    Dim oBaseWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oBaseComponent)
    If IsNothing(oBaseWPPs) OrElse (Not oBaseWPPs.Count = 3) Then
        MsgBox("Failed to get 3 WorkPlaneProxy objects from Base component. Exiting.", vbCritical, "")
        oTrans.Abort
        Exit Sub
    End If
    Dim oBaseTrans As Matrix = oBaseComponent.Transformation
    '''    Dim oAsmComp As AssemblyComponentDefinition= ThisApplication.ActiveDocument.ComponentDefinition
    For Each oOccurrence In oAsmComp.Occurrences
'    'ground everything in the top level
    oOccurrence.Grounded = True
    Next
    '''    '<<<< Good Point For Loop Of Remaining Code >>>>
'''    Dim oCompToMove As ComponentOccurrence = PickComponent("Pick Component To Move.")'''    If IsNothing(oCompToMove) Then oTrans.Abort : Exit Sub'''    Dim oCompToMoveWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oCompToMove)'''    If IsNothing(oCompToMoveWPPs) OrElse (Not oCompToMoveWPPs.Count = 3) Then'''        MsgBox("Failed to get 3 WorkPlaneProxy objects from component to move. Exiting.", vbCritical, "")'''        oTrans.Abort'''        Exit Sub'''    End If

'''    DeleteConstraints(oCompToMove)'''    oCompToMove.Transformation = oBaseTrans'''    
'''    For i As Integer = 0 To 2'''        oConst = oConsts.AddFlushConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i), 0)'''    Next

    Dim oAsm As AssemblyDocument= ThisApplication.ActiveDocument
    Dim oUM As UnitsOfMeasure = oAsm.UnitsOfMeasure
    Dim oOcc As ComponentOccurrence
    For Each oOcc In oAsm.ComponentDefinition.Occurrences
        
        Dim oTransform As Matrix
        oTransform = oOcc.Transformation
        
        Dim oOriginLocation As Vector
        oOriginLocation = oTransform.Translation
        
        
        Dim AbstandvonEbene(0 To 3) As Double
        
        AbstandvonEbene(1) = oOriginLocation.X
        AbstandvonEbene(2) = oOriginLocation.Y
        AbstandvonEbene(3) = oOriginLocation.Z
        
        'Create a proxy for Face0 (The face in the context of the assembly)
        Dim Z�hler As Integer = 1
        
        'cycle each Origin plane in the top assembly
        For Z�hler = 1 To 3
        
            Dim oBaseWPPstOrPlane As WorkPlane = oBaseWPPs(Z�hler)    
            
            Dim oCompAsmDef As AssemblyComponentDefinition
            Dim oCompPtDef As PartComponentDefinition
            'cycle each Origin plane of base component in the first level Occurence in the assembly
            For Z�hler2 = 1 To 3
                
                If oOcc.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
                    oCompAsmDef = oOcc.Definition
                    oOcc.CreateGeometryProxy(oCompAsmDef.WorkPlanes.Item(Z�hler2),curCompOriPlane)
                
                ElseIf oOcc.DefinitionDocumentType = DocumentTypeEnum.kPartDocumentObject Then
                    oCompPtDef = oOcc.Definition
                    oOcc.CreateGeometryProxy(oCompPtDef.WorkPlanes.Item(Z�hler2), curCompOriPlane)
                                
                End If
                
                Dim oParalell As Boolean= oBaseWPPstOrPlane.Plane.IsParallelTo(curCompOriPlane.Plane, 0.00001)
                Dim oSameDirection As Boolean= oBaseWPPstOrPlane.Plane.Normal.IsEqualTo(curCompOriPlane.Plane.Normal)
            
                Dim oNV As NameValueMap
            
                If oParalell=True Then
                    If oSameDirection=True Then
                    oConstraint=oAsmComp.Constraints.AddFlushConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Z�hler))
                    End If
                    If oSameDirection=False Then
                    oConstraint=oAsmComp.Constraints.AddMateConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Z�hler))
                    End If
            
                End If
            Next
        Next    
Next
'''    '<<<< End Loop Here, If Using One >>>>
    oTrans.End
End Sub


Function PickComponent(oPrompt As String) As ComponentOccurrence
    oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, oPrompt)
    If IsNothing(oObj) OrElse (TypeOf oObj Is ComponentOccurrence = False) Then Return Nothing
    Dim oOcc As ComponentOccurrence = oObj
    Return oOcc
End Function

Function GetComponentOriginPlaneProxies(oComp As ComponentOccurrence) As List(Of WorkPlaneProxy)
    If IsNothing(oComp) Then Return Nothing
    Dim oWPs As WorkPlanes = Nothing
    Dim oWPPs As New List(Of WorkPlaneProxy)
    If TypeOf oComp.Definition Is PartComponentDefinition Or _
        TypeOf oComp.Definition Is AssemblyComponentDefinition Then
        oWPs = oComp.Definition.WorkPlanes
    Else
        Return Nothing
    End If
    For i As Integer = 1 To 3
        Dim oWPP As WorkPlaneProxy = Nothing
        oWP = oWPs.Item(i)
        oComp.CreateGeometryProxy(oWP, oWPP)
        oWPPs.Add(oWPP)
    Next
    Return oWPPs
End Function

Sub DeleteConstraints(oComp As ComponentOccurrence)
    If IsNothing(oComp) Then Exit Sub
    If oComp.Constraints.Count = 0 Then Exit Sub
    For Each oConst As AssemblyConstraint In oComp.Constraints
        oConst.Delete
    Next
End Sub
```

#### Code Block 12

```vb
Sub Main()

   

    Dim oDoc As AssemblyDocument

     oDoc = ThisApplication.ActiveDocument

    Dim oOcc As ComponentOccurrence

     	oOcc = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a oOcc plate")

    Dim oMat As Matrix

     oMat = oOcc.Transformation

 

    Dim aRotAngles(2) As Double

    Call CalculateRotationAngles(oMat, aRotAngles)

   

    ' Print results

'    Dim i As Integer

'    For i = 0 To 2

      msgbox(aRotAngles(0)  & vbCrLf & aRotAngles(1) & vbCrLf & aRotAngles(2))

'    Next i

    Beep

End Sub

 

 

Sub CalculateRotationAngles(ByVal oMatrix As Inventor.Matrix,ByRef aRotAngles() As Double)

    Const PI = 3.14159265358979

    Const TODEGREES As Double = 180 / PI

 

    Dim dB As Double

    Dim dC As Double

    Dim dNumer As Double

    Dim dDenom As Double

    Dim dAcosValue As Double

       

    Dim oRotate As Inventor.Matrix

    Dim oAxis As Inventor.Vector

    Dim oCenter As Inventor.Point

   

     oRotate = ThisApplication.TransientGeometry.CreateMatrix

     oAxis = ThisApplication.TransientGeometry.CreateVector

     oCenter = ThisApplication.TransientGeometry.CreatePoint

 

    oCenter.X = 0

    oCenter.Y = 0

    oCenter.Z = 0

 

    ' Choose aRotAngles[0] about x which transforms axes[2] onto the x-z plane

    '

    dB = oMatrix.Cell(2, 3)

    dC = oMatrix.Cell(3, 3)

 

    dNumer = dC

    dDenom = Sqrt(dB * dB + dC * dC)

 

    ' Make sure we can do the division.  If not, then axes[2] is already in the x-z plane

    If (Abs(dDenom) <= 0.000001) Then

        aRotAngles(0) = 0#

    Else

        If (dNumer / dDenom >= 1#) Then

            dAcosValue = 0#

        Else

            If (dNumer / dDenom <= -1#) Then

                dAcosValue = PI

            Else

                dAcosValue = Acos(dNumer / dDenom)

            End If

        End If

   

        aRotAngles(0) = Sign(dB) * dAcosValue

        oAxis.X = 1

        oAxis.Y = 0

        oAxis.Z = 0

 

        Call oRotate.SetToRotation(aRotAngles(0), oAxis, oCenter)

        Call oMatrix.PreMultiplyBy(oRotate)

    End If

 

    '

    ' Choose aRotAngles[1] about y which transforms axes[3] onto the z axis

    '

    If (oMatrix.Cell(3, 3) >= 1#) Then

        dAcosValue = 0#

    Else

        If (oMatrix.Cell(3, 3) <= -1#) Then

            dAcosValue = PI

        Else

            dAcosValue = Acos(oMatrix.Cell(3, 3))

        End If

    End If

 

    aRotAngles(1) = Math.Sign(-oMatrix.Cell(1, 3)) * dAcosValue

    oAxis.X = 0

    oAxis.Y = 1

    oAxis.Z = 0

    Call oRotate.SetToRotation(aRotAngles(1), oAxis, oCenter)

    Call oMatrix.PreMultiplyBy(oRotate)

 

    '

    ' Choose aRotAngles[2] about z which transforms axes[0] onto the x axis

    '

    If (oMatrix.Cell(1, 1) >= 1#) Then

        dAcosValue = 0#

    Else

        If (oMatrix.Cell(1, 1) <= -1#) Then

            dAcosValue = PI

        Else

            dAcosValue = Acos(oMatrix.Cell(1, 1))

        End If

    End If

 

    aRotAngles(2) = Math.Sign(-oMatrix.Cell(2, 1)) * dAcosValue

 

    'if you want to get the result in degrees

    aRotAngles(0) = Round(aRotAngles(0) * TODEGREES,4)

    aRotAngles(1) = Round(aRotAngles(1) * TODEGREES,4)

    aRotAngles(2) = Round(aRotAngles(2) * TODEGREES,4)

End Sub

 

 

Public Function Acos(value) As Double

    Acos = Math.Atan(-value / Math.Sqrt(-value * value + 1)) + 2 * Math.Atan(1)

End Function
```

#### Code Block 13

```vb
Sub Main()

    Dim _invApp As Inventor.Application
    Dim _started As Boolean = False
    Dim oTrans As Transaction
    Dim oConst As FlushConstraint
    Dim kDefaultDisplayLengthUnits As Object
    Dim asmDoc As AssemblyDocument = ThisApplication.ActiveDocument
    Dim oAsmComp As AssemblyComponentDefinition= ThisApplication.ActiveDocument.ComponentDefinition
    If asmDoc.SelectSet.Count = 0 Then
        MsgBox("Need to select a Part or Sub Assembly")
        Return
    End If

    If asmDoc.SelectSet.Count = 0 Then
        MsgBox("Need to select a Part or Sub Assembly")
        Return
    End If

    Try
        AlignOccurrencesWithConstraints()    
        '''    
        Dim oOccurrence As ComponentOccurrence
        For Each oOccurrence In oAsmComp.Occurrences
            oOccurrence.Grounded = True
        Next
        
        '''        
    Catch ex As Exception
       ' MsgBox("Is the selected item a Component?")
        MsgBox(ex.ToString())
        Return
    End Try

End Sub

Sub AlignOccurrencesWithConstraints()

        Dim assemblydoc As AssemblyDocument = ThisApplication.ActiveDocument
        Dim occurrenceList As New Collection
        Dim entity As Object

        For Each entity In assemblydoc.SelectSet
            If TypeOf entity Is ComponentOccurrence Then
                occurrenceList.Add(entity)
            End If
        Next

        If occurrenceList.Count < 2 Then
            MsgBox("At least two occurrences must be selected.")
            Exit Sub
            
        End If

        Dim baseOccurrence As ComponentOccurrence = occurrenceList.Item(1)

        Dim constraints As AssemblyConstraints = assemblydoc.ComponentDefinition.Constraints

        ' Iterate through the other occurrences
        Dim i As Integer
        For i = 2 To occurrenceList.Count
            Dim thisOcc As ComponentOccurrence = occurrenceList.Item(i)

            ConstrPlanes(baseOccurrence, thisOcc)

        Next
    End Sub

Public Sub ConstrPlanes(ByVal baseOccurrence As ComponentOccurrence,ByVal thisOcc As ComponentOccurrence)
    
    Dim oBaseComponent As ComponentOccurrence = baseOccurrence
    If IsNothing(oBaseComponent) Then Exit Sub
        oBaseComponent.Grounded = True
    Dim oADef As AssemblyComponentDefinition = oBaseComponent.Parent
    Dim oConsts As AssemblyConstraints = oADef.Constraints
    oTrans = ThisApplication.TransactionManager.StartTransaction(oADef.Document, "Constrain Components (API)")
    Dim oBaseWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oBaseComponent)
    If IsNothing(oBaseWPPs) OrElse (Not oBaseWPPs.Count = 3) Then
        MsgBox("Failed to get 3 WorkPlaneProxy objects from Base component. Exiting.", vbCritical, "")
        oTrans.Abort
        Exit Sub
    End If
    Dim oBaseTrans As Matrix = oBaseComponent.Transformation
    
    '<<<< Good Point For Loop Of Remaining Code >>>>
    Dim oCompToMove As ComponentOccurrence = thisOcc
    If IsNothing(oCompToMove) Then oTrans.Abort : Exit Sub
        oCompToMove.Grounded = True
    Dim oCompToMoveWPPs As List(Of WorkPlaneProxy) = GetComponentOriginPlaneProxies(oCompToMove)
    If IsNothing(oCompToMoveWPPs) OrElse (Not oCompToMoveWPPs.Count = 3) Then
        MsgBox("Failed to get 3 WorkPlaneProxy objects from component to move. Exiting.", vbCritical, "")
        oTrans.Abort
        Exit Sub
    End If
    DeleteConstraints(oCompToMove)
    Dim oCompToMoveTrans As Matrix = oCompToMove.Transformation
    
    Dim oLocationBase As Vector
    oLocationBase = oBaseTrans.Translation
    
    Dim oOriginLocation As Vector
    oOriginLocation = oCompToMoveTrans.Translation

    Dim Calcdistance(0 To 2) As Double
    
    Calcdistance(0) = (oLocationBase.X-oOriginLocation.X)*(-1)
    Calcdistance(1) = (oLocationBase.Y-oOriginLocation.Y)*(-1)
    Calcdistance(2) = (oLocationBase.Z-oOriginLocation.Z)*(-1)
    

    For i As Integer = 0 To 2
        For i2 As Integer = 0 To 2
        Dim oParallel As Boolean = oBaseWPPs.Item(i).Plane.IsParallelTo(oCompToMoveWPPs.Item(i2).Plane, 0.00001)
        Dim oSameDirection As Boolean=False
        oSameDirection= oBaseWPPs.Item(i).Plane.Normal.IsEqualTo(oCompToMoveWPPs.Item(i2).Plane.Normal)

        If oParallel=True Then
'
                If oSameDirection=True Then
                oConstraint=oConsts.AddFlushConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i2), Calcdistance(i))
                End If
                If oSameDirection=False Then
                oConstraint=oConsts.AddMateConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i2), Calcdistance(i))
                End If

      End If

    Next
    

    
'    oConst = oConsts.AddFlushConstraint(oBaseWPPs.Item(i), oCompToMoveWPPs.Item(i), 0)
MsgBox(Calcdistance(i))
    Next
    '<<<< End Loop Here, If Using One >>>>
    oTrans.End
End Sub

Function PickComponent(oPrompt As String) As ComponentOccurrence
    oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, oPrompt)
    If IsNothing(oObj) OrElse (TypeOf oObj Is ComponentOccurrence = False) Then Return Nothing
    Dim oOcc As ComponentOccurrence = oObj
    Return oOcc
End Function

Function GetComponentOriginPlaneProxies(oComp As ComponentOccurrence) As List(Of WorkPlaneProxy)
    If IsNothing(oComp) Then Return Nothing
    Dim oWPs As WorkPlanes = Nothing
    Dim oWPPs As New List(Of WorkPlaneProxy)
    If TypeOf oComp.Definition Is PartComponentDefinition Or _
        TypeOf oComp.Definition Is AssemblyComponentDefinition Then
        oWPs = oComp.Definition.WorkPlanes
    Else
        Return Nothing
    End If
    For i As Integer = 1 To 3
        Dim oWPP As WorkPlaneProxy = Nothing
        oWP = oWPs.Item(i)
        oComp.CreateGeometryProxy(oWP, oWPP)
        oWPPs.Add(oWPP)
    Next
    Return oWPPs
End Function

Sub DeleteConstraints(oComp As ComponentOccurrence)
    If IsNothing(oComp) Then Exit Sub
    If oComp.Constraints.Count = 0 Then Exit Sub
    For Each oConst As AssemblyConstraint In oComp.Constraints
        oConst.Delete
    Next
End Sub
```

#### Code Block 14

```vb
Sub main()
    Dim assemblydoc As AssemblyDocument
     assemblydoc = ThisApplication.ActiveDocument

    ' Get the occurrences in the select set.
    Dim occurrenceList As New Collection
    Dim entity As Object
    For Each entity In assemblydoc.SelectSet
        If TypeOf entity Is ComponentOccurrence Then
            occurrenceList.Add(entity)
        End If
    Next

    If occurrenceList.Count < 2 Then
        MsgBox("At least two occurrences must be selected.")
        Exit Sub
    End If

    ' This assumes the first selected occurrence is the "base"
    ' and will constrain the base workplanes of all the other parts
    ' to the base workplanes of the first part. If there are
    ' constraints on the other they end up being over constrained.

    ' Get the planes from the base part and create proxies for them.
    Dim baseOccurrence As ComponentOccurrence
     baseOccurrence = occurrenceList.Item(1)

    Dim BaseXY As WorkPlane
    Dim BaseYZ As WorkPlane
    Dim BaseXZ As WorkPlane
    Call GetPlanes(baseOccurrence, BaseXY, BaseYZ, BaseXZ)

    Dim constraints As AssemblyConstraints
     constraints = assemblydoc.ComponentDefinition.Constraints

    ' Iterate through the other occurrences
    Dim i As Integer
    For i = 2 To occurrenceList.Count
        Dim thisOcc As ComponentOccurrence
         thisOcc = occurrenceList.Item(i)

        ' Move it to the base occurrence so that if the base is
        ' not fully constrained it shouldn't move when the flush
        ' constraints are added.
        thisOcc.Transformation = baseOccurrence.Transformation

        ' Get the planes from the occurrence
        Dim occPlaneXY As WorkPlane
        Dim occPlaneYZ As WorkPlane
        Dim occPlaneXZ As WorkPlane
        Call GetPlanes(thisOcc, occPlaneXY, occPlaneYZ, occPlaneXZ)

        ' Add the flush constraints.
        Call constraints.AddFlushConstraint(BaseXY, occPlaneXY, 0)
        Call constraints.AddFlushConstraint(BaseYZ, occPlaneYZ, 0)
        Call constraints.AddFlushConstraint(BaseXZ, occPlaneXZ, 0)
    Next
End Sub

' Utility function used by the AlignOccurrencesWithConstraints macro.
' Given an occurrence it returns the base work planes that are in
' the part or assembly the occurrence references.  It gets the
' proxies for the planes since it needs the work planes in the
' context of the assembly and not in the part or assembly document
' where they actually exist.
Private Sub GetPlanes(ByVal Occurrence As ComponentOccurrence, _ 
                      ByRef BaseXY As WorkPlane, _ 
                      ByRef BaseYZ As WorkPlane, _ 
                      ByRef BaseXZ As WorkPlane)
    ' Get the work planes from the definition of the occurrence.
    ' These will be in the context of the part or subassembly, not 
    ' the top-level assembly, which is what we need to return.
     BaseXY = Occurrence.Definition.WorkPlanes.Item(3)
     BaseYZ = Occurrence.Definition.WorkPlanes.Item(1)
     BaseXZ = Occurrence.Definition.WorkPlanes.Item(2)

    ' Create proxies for these planes.  This will act as the work
    ' plane in the context of the top-level assembly.
    Call Occurrence.CreateGeometryProxy(BaseXY, BaseXY)
    Call Occurrence.CreateGeometryProxy(BaseYZ, BaseYZ)
    Call Occurrence.CreateGeometryProxy(BaseXZ, BaseXZ)
End Sub
```

---

### 15. Auto naming an excel file - Inventor 2025

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/auto-naming-an-excel-file-inventor-2025/td-p/13779015](https://forums.autodesk.com/t5/inventor-programming-forum/auto-naming-an-excel-file-inventor-2025/td-p/13779015)

**Author:** andregsPGJRY

**Date:** ‎08-22-2025
	
		
		07:51 AM

**Description:** Hello, I work for a tube manufacturing company, and to reduce the risk of errors caused by incorrectly loaded Excel spreadsheets, I would like to automate the process of displaying the file name on the printed drawing. Specifically, I want to add a line to the drawing showing the name of the loaded ...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim oDrawDoc As DrawingDocument
Dim oSheet As Sheet
Dim oDrawingView As DrawingView
Dim oDrawingViewComponent As PartDocument
Dim oDrawingViewComponentAsm As AssemblyDocument
Dim oDrawingViewComponentPres As PresentationDocument
Dim oPartDesc As GeneralNote
Dim oTextBoxes As GeneralNotes

If ThisApplication.ActiveDocument.DocumentType <> kDrawingDocumentObject Then
	MessageBox.Show ("Please run this rule on a drawing", "Autodesk Inventor", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Exit Sub
End If
	
oDrawDoc = ThisApplication.ActiveDocument

' Set a reference to the active sheet
oSheet = oDrawDoc.ActiveSheet

' Set a reference to general notes
oTextBoxes = oSheet.DrawingNotes.GeneralNotes
Try
If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kPartDocumentObject Then
	oDrawingViewComponent = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument  
	oSheet.Name = oDrawingViewComponent.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Else If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kAssemblyDocumentObject Then
	oDrawingViewComponentAsm = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument
	oSheet.Name = oDrawingViewComponentAsm.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Else If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kPresentationDocumentObject Then
	oDrawingViewComponentPres = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument
	oDrawingViewComponentAsm = oDrawingViewComponentPres.referencedfiles.item(1)
	oSheet.Name = oDrawingViewComponentAsm.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value	
End If
Catch ex As Exception 
	MessageBox.Show("Please run the rule after placing a view", "Autodesk Inventor", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Exit Sub
End Try	

sText = "<StyleOverride FontSize='0.6096'><Property Document='model' PropertySet='Design Tracking Properties' Property='Part Number' FormatID='{32853F0F-3444-11D1-9E93-0060B03C1CA6}' PropertyID='5'>PART NUMBER</Property></StyleOverride><Br/><StyleOverride FontSize='0.254'><Property Document='model' PropertySet='Design Tracking Properties' Property='Description' FormatID='{32853F0F-3444-11D1-9E93-0060B03C1CA6}' PropertyID='29'>DESCRIPTION</Property></StyleOverride>"                
oTG = ThisApplication.TransientGeometry
oTextBox2 = oSheet.DrawingNotes.GeneralNotes.AddFitted(oTG.CreatePoint2d(0.4, 20.6), sText)
```

#### Code Block 2

```vb
Dim oDrawDoc As DrawingDocument
Dim oSheet As Sheet
Dim oDrawingView As DrawingView
Dim oDrawingViewComponent As PartDocument
Dim oDrawingViewComponentAsm As AssemblyDocument
Dim oDrawingViewComponentPres As PresentationDocument
Dim oPartDesc As GeneralNote
Dim oTextBoxes As GeneralNotes

If ThisApplication.ActiveDocument.DocumentType <> kDrawingDocumentObject Then
	MessageBox.Show ("Please run this rule on a drawing", "Autodesk Inventor", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Exit Sub
End If
	
oDrawDoc = ThisApplication.ActiveDocument

' Set a reference to the active sheet
oSheet = oDrawDoc.ActiveSheet

' Set a reference to general notes
oTextBoxes = oSheet.DrawingNotes.GeneralNotes
Try
If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kPartDocumentObject Then
	oDrawingViewComponent = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument  
	oSheet.Name = oDrawingViewComponent.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Else If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kAssemblyDocumentObject Then
	oDrawingViewComponentAsm = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument
	oSheet.Name = oDrawingViewComponentAsm.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Else If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kPresentationDocumentObject Then
	oDrawingViewComponentPres = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument
	oDrawingViewComponentAsm = oDrawingViewComponentPres.referencedfiles.item(1)
	oSheet.Name = oDrawingViewComponentAsm.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value	
End If
Catch ex As Exception 
	MessageBox.Show("Please run the rule after placing a view", "Autodesk Inventor", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Exit Sub
End Try	

sText = "<StyleOverride FontSize='0.6096'><Property Document='model' PropertySet='Design Tracking Properties' Property='Part Number' FormatID='{32853F0F-3444-11D1-9E93-0060B03C1CA6}' PropertyID='5'>PART NUMBER</Property></StyleOverride><Br/><StyleOverride FontSize='0.254'><Property Document='model' PropertySet='Design Tracking Properties' Property='Description' FormatID='{32853F0F-3444-11D1-9E93-0060B03C1CA6}' PropertyID='29'>DESCRIPTION</Property></StyleOverride>"                
oTG = ThisApplication.TransientGeometry
oTextBox2 = oSheet.DrawingNotes.GeneralNotes.AddFitted(oTG.CreatePoint2d(0.4, 20.6), sText)
```

#### Code Block 3

```vb
Dim oDrawDoc As DrawingDocument
Dim oSheet As Sheet
Dim oDrawingView As DrawingView
Dim oDrawingViewComponent As PartDocument
Dim oDrawingViewComponentAsm As AssemblyDocument
Dim oDrawingViewComponentPres As PresentationDocument
Dim oPartDesc As GeneralNote
Dim oTextBoxes As GeneralNotes

If ThisApplication.ActiveDocument.DocumentType <> kDrawingDocumentObject Then
	MessageBox.Show ("Please run this rule on a drawing", "Autodesk Inventor", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Exit Sub
End If
	
oDrawDoc = ThisApplication.ActiveDocument

' Set a reference to the active sheet
oSheet = oDrawDoc.ActiveSheet

' Set a reference to general notes
oTextBoxes = oSheet.DrawingNotes.GeneralNotes
Try
If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kPartDocumentObject Then
	oDrawingViewComponent = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument  
	oSheet.Name = oDrawingViewComponent.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Else If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kAssemblyDocumentObject Then
	oDrawingViewComponentAsm = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument
	oSheet.Name = oDrawingViewComponentAsm.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Else If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kPresentationDocumentObject Then
	oDrawingViewComponentPres = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument
	oDrawingViewComponentAsm = oDrawingViewComponentPres.referencedfiles.item(1)
	oSheet.Name = oDrawingViewComponentAsm.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value	
End If
Catch ex As Exception 
	MessageBox.Show("Please run the rule after placing a view", "Autodesk Inventor", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Exit Sub
End Try	

sText = "<StyleOverride FontSize='0.6096'><Property Document='model' PropertySet='Design Tracking Properties' Property='Part Number' FormatID='{32853F0F-3444-11D1-9E93-0060B03C1CA6}' PropertyID='5'>PART NUMBER</Property></StyleOverride><Br/><StyleOverride FontSize='0.254'><Property Document='model' PropertySet='Design Tracking Properties' Property='Description' FormatID='{32853F0F-3444-11D1-9E93-0060B03C1CA6}' PropertyID='29'>DESCRIPTION</Property></StyleOverride>"                
oTG = ThisApplication.TransientGeometry
oTextBox2 = oSheet.DrawingNotes.GeneralNotes.AddFitted(oTG.CreatePoint2d(0.4, 20.6), sText)
```

#### Code Block 4

```vb
Dim oDrawDoc As DrawingDocument
Dim oSheet As Sheet
Dim oDrawingView As DrawingView
Dim oDrawingViewComponent As PartDocument
Dim oDrawingViewComponentAsm As AssemblyDocument
Dim oDrawingViewComponentPres As PresentationDocument
Dim oPartDesc As GeneralNote
Dim oTextBoxes As GeneralNotes

If ThisApplication.ActiveDocument.DocumentType <> kDrawingDocumentObject Then
	MessageBox.Show ("Please run this rule on a drawing", "Autodesk Inventor", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Exit Sub
End If
	
oDrawDoc = ThisApplication.ActiveDocument

' Set a reference to the active sheet
oSheet = oDrawDoc.ActiveSheet

' Set a reference to general notes
oTextBoxes = oSheet.DrawingNotes.GeneralNotes
Try
If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kPartDocumentObject Then
	oDrawingViewComponent = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument  
	oSheet.Name = oDrawingViewComponent.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Else If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kAssemblyDocumentObject Then
	oDrawingViewComponentAsm = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument
	oSheet.Name = oDrawingViewComponentAsm.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Else If oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocumentType = kPresentationDocumentObject Then
	oDrawingViewComponentPres = oSheet.DrawingViews(1).ReferencedDocumentDescriptor.ReferencedDocument
	oDrawingViewComponentAsm = oDrawingViewComponentPres.referencedfiles.item(1)
	oSheet.Name = oDrawingViewComponentAsm.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value	
End If
Catch ex As Exception 
	MessageBox.Show("Please run the rule after placing a view", "Autodesk Inventor", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Exit Sub
End Try	

sText = "<StyleOverride FontSize='0.6096'><Property Document='model' PropertySet='Design Tracking Properties' Property='Part Number' FormatID='{32853F0F-3444-11D1-9E93-0060B03C1CA6}' PropertyID='5'>PART NUMBER</Property></StyleOverride><Br/><StyleOverride FontSize='0.254'><Property Document='model' PropertySet='Design Tracking Properties' Property='Description' FormatID='{32853F0F-3444-11D1-9E93-0060B03C1CA6}' PropertyID='29'>DESCRIPTION</Property></StyleOverride>"                
oTG = ThisApplication.TransientGeometry
oTextBox2 = oSheet.DrawingNotes.GeneralNotes.AddFitted(oTG.CreatePoint2d(0.4, 20.6), sText)
```

---

### 16. Automated Break on Front View

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/automated-break-on-front-view/td-p/13765786#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/automated-break-on-front-view/td-p/13765786#messageview_0)

**Author:** layochim

**Date:** ‎08-13-2025
	
		
		06:48 AM

**Description:** Hello, I've been searching for a code to create a break in my font view(VIEW1).  The model is an assembly and when it reaches a certain length I'm trying to get the break to happen and if it's under a certain length then no break.Also, I have automated drawing dimensions on "VIEW1" I'm not sure if t...

**Code Snippets (2):**

#### Code Block 1

```vb
Public Sub CreateBreakoperationInDrawingView()
    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrawDoc As DrawingDocument = ThisApplication.ActiveDocument

    'Set a reference to the active sheet.
    Dim oSheet As Sheet = oDrawDoc.ActiveSheet

    ' Check to make sure a drawing view is selected.
    If Not TypeOf oDrawDoc.SelectSet.Item(1) Is DrawingView Then
        MsgBox "A drawing view must be selected."
        Exit Sub
    End If

    ' Set a reference to the selected drawing. This assumes
    ' that the selected view is not a draft view.
    Dim oDrawingView As DrawingView = oDrawDoc.SelectSet.Item(1)

    ' Set a reference to the center of the base view.
    Dim oCenter As Point2d = oDrawingView.Center

    ' Define the start point of the break
    Dim oStartPoint As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(oCenter.X - 1, oCenter.Y)

    ' Define the end point of the break
    Dim oEndPoint As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(oCenter.X + 1, oCenter.Y)

    Dim oBreakOperation As BreakOperation = oDrawingView.BreakOperations.Add(kHorizontalBreakOrientation, oStartPoint, oEndPoint, kRectangularBreakStyle, 5)
End Sub
```

#### Code Block 2

```vb
Public Sub CreateBreakoperationInDrawingView()
    ' Set a reference to the drawing document.
    ' This assumes a drawing document is active.
    Dim oDrawDoc As DrawingDocument = ThisApplication.ActiveDocument

    'Set a reference to the active sheet.
    Dim oSheet As Sheet = oDrawDoc.ActiveSheet

    ' Check to make sure a drawing view is selected.
    If Not TypeOf oDrawDoc.SelectSet.Item(1) Is DrawingView Then
        MsgBox "A drawing view must be selected."
        Exit Sub
    End If

    ' Set a reference to the selected drawing. This assumes
    ' that the selected view is not a draft view.
    Dim oDrawingView As DrawingView = oDrawDoc.SelectSet.Item(1)

    ' Set a reference to the center of the base view.
    Dim oCenter As Point2d = oDrawingView.Center

    ' Define the start point of the break
    Dim oStartPoint As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(oCenter.X - 1, oCenter.Y)

    ' Define the end point of the break
    Dim oEndPoint As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(oCenter.X + 1, oCenter.Y)

    Dim oBreakOperation As BreakOperation = oDrawingView.BreakOperations.Add(kHorizontalBreakOrientation, oStartPoint, oEndPoint, kRectangularBreakStyle, 5)
End Sub
```

---

### 17. Automated Mates

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/automated-mates/td-p/13756652#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/automated-mates/td-p/13756652#messageview_0)

**Author:** pranil_sevak

**Date:** ‎08-06-2025
	
		
		10:52 AM

**Description:** Hello everyone,I'm working on placing .ipt and .iam files into an assembly and want to create an iLogic rule that mates the objects to the origin — but at the position and orientation where they're placed.That means I don’t want the components to move to the origin or be grounded; instead, they shou...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim oAsm As AssemblyDocument = ThisApplication.ActiveDocument
Dim oDef As AssemblyComponentDefinition = oAsm.ComponentDefinition

Dim asmXY As WorkPlane = oDef.WorkPlanes.Item("XY Plane")
Dim asmYZ As WorkPlane = oDef.WorkPlanes.Item("YZ Plane")
Dim asmXZ As WorkPlane = oDef.WorkPlanes.Item("XZ Plane")

For Each oOcc As ComponentOccurrence In oDef.Occurrences
    If oOcc.Grounded Then Continue For

    ' Optional: Temporarily skip known problematic components
    ' If oOcc.Name = "P25237-CMS-QTS-QTS-RIC2:1" Or oOcc.Name = "25237-WALL-1" Then Continue For

    Dim compDef As Object = oOcc.Definition
    Dim xyPlane As WorkPlane = Nothing
    Dim yzPlane As WorkPlane = Nothing
    Dim xzPlane As WorkPlane = Nothing

    ' Check component type and retrieve work planes
    If TypeOf compDef Is PartComponentDefinition Then
        Dim partDef As PartComponentDefinition = compDef
        xyPlane = TryCast(partDef.WorkPlanes.Item("XY Plane"), WorkPlane)
        yzPlane = TryCast(partDef.WorkPlanes.Item("YZ Plane"), WorkPlane)
        xzPlane = TryCast(partDef.WorkPlanes.Item("XZ Plane"), WorkPlane)
    ElseIf TypeOf compDef Is AssemblyComponentDefinition Then
        Dim asmDef As AssemblyComponentDefinition = compDef
        xyPlane = TryCast(asmDef.WorkPlanes.Item("XY Plane"), WorkPlane)
        yzPlane = TryCast(asmDef.WorkPlanes.Item("YZ Plane"), WorkPlane)
        xzPlane = TryCast(asmDef.WorkPlanes.Item("XZ Plane"), WorkPlane)
    Else
        MessageBox.Show("Unsupported component type: " & oOcc.Name)
        Continue For
    End If

    ' Skip if any plane is missing
    If xyPlane Is Nothing Or yzPlane Is Nothing Or xzPlane Is Nothing Then
        MessageBox.Show("Missing work plane for: " & oOcc.Name)
        Continue For
    End If

    ' Check component state
    If oOcc.Suppressed Then
        MessageBox.Show("Component suppressed: " & oOcc.Name)
        Continue For
    End If
    If oOcc.IsPatternElement Then
        MessageBox.Show("Component in pattern: " & oOcc.Name)
        Continue For
    End If

    ' Apply flush constraints
    Try
        oDef.Constraints.AddFlushConstraint(asmXY, xyPlane, 0)
        oDef.Constraints.AddFlushConstraint(asmYZ, yzPlane, 0)
        oDef.Constraints.AddFlushConstraint(asmXZ, xzPlane, 0)
        oOcc.Grounded = False
    Catch ex As Exception
        Dim compType As String = If(TypeOf compDef Is PartComponentDefinition, "Part", "Assembly")
        MessageBox.Show("Constraint error with: " & oOcc.Name & vbCrLf & _
                        "Type: " & compType & vbCrLf & _
                        "Details: " & ex.Message & vbCrLf & _
                        "Source: " & ex.Source)
        Continue For
    End Try
Next
```

#### Code Block 2

```vb
Dim oAsm As AssemblyDocument = ThisApplication.ActiveDocument
Dim oDef As AssemblyComponentDefinition = oAsm.ComponentDefinition

Dim asmXY As WorkPlane = oDef.WorkPlanes.Item("XY Plane")
Dim asmYZ As WorkPlane = oDef.WorkPlanes.Item("YZ Plane")
Dim asmXZ As WorkPlane = oDef.WorkPlanes.Item("XZ Plane")

For Each oOcc As ComponentOccurrence In oDef.Occurrences
    If oOcc.Grounded Then Continue For

    ' Optional: Temporarily skip known problematic components
    ' If oOcc.Name = "P25237-CMS-QTS-QTS-RIC2:1" Or oOcc.Name = "25237-WALL-1" Then Continue For

    Dim compDef As Object = oOcc.Definition
    Dim xyPlane As WorkPlane = Nothing
    Dim yzPlane As WorkPlane = Nothing
    Dim xzPlane As WorkPlane = Nothing

    ' Check component type and retrieve work planes
    If TypeOf compDef Is PartComponentDefinition Then
        Dim partDef As PartComponentDefinition = compDef
        xyPlane = TryCast(partDef.WorkPlanes.Item("XY Plane"), WorkPlane)
        yzPlane = TryCast(partDef.WorkPlanes.Item("YZ Plane"), WorkPlane)
        xzPlane = TryCast(partDef.WorkPlanes.Item("XZ Plane"), WorkPlane)
    ElseIf TypeOf compDef Is AssemblyComponentDefinition Then
        Dim asmDef As AssemblyComponentDefinition = compDef
        xyPlane = TryCast(asmDef.WorkPlanes.Item("XY Plane"), WorkPlane)
        yzPlane = TryCast(asmDef.WorkPlanes.Item("YZ Plane"), WorkPlane)
        xzPlane = TryCast(asmDef.WorkPlanes.Item("XZ Plane"), WorkPlane)
    Else
        MessageBox.Show("Unsupported component type: " & oOcc.Name)
        Continue For
    End If

    ' Skip if any plane is missing
    If xyPlane Is Nothing Or yzPlane Is Nothing Or xzPlane Is Nothing Then
        MessageBox.Show("Missing work plane for: " & oOcc.Name)
        Continue For
    End If

    ' Check component state
    If oOcc.Suppressed Then
        MessageBox.Show("Component suppressed: " & oOcc.Name)
        Continue For
    End If
    If oOcc.IsPatternElement Then
        MessageBox.Show("Component in pattern: " & oOcc.Name)
        Continue For
    End If

    ' Apply flush constraints
    Try
        oDef.Constraints.AddFlushConstraint(asmXY, xyPlane, 0)
        oDef.Constraints.AddFlushConstraint(asmYZ, yzPlane, 0)
        oDef.Constraints.AddFlushConstraint(asmXZ, xzPlane, 0)
        oOcc.Grounded = False
    Catch ex As Exception
        Dim compType As String = If(TypeOf compDef Is PartComponentDefinition, "Part", "Assembly")
        MessageBox.Show("Constraint error with: " & oOcc.Name & vbCrLf & _
                        "Type: " & compType & vbCrLf & _
                        "Details: " & ex.Message & vbCrLf & _
                        "Source: " & ex.Source)
        Continue For
    End Try
Next
```

#### Code Block 3

```vb
Dim oAsm As AssemblyDocument = ThisApplication.ActiveDocument
Dim oDef As AssemblyComponentDefinition = oAsm.ComponentDefinition

Dim asmXY As WorkPlane = oDef.WorkPlanes.Item("XY Plane")
Dim asmYZ As WorkPlane = oDef.WorkPlanes.Item("YZ Plane")
Dim asmXZ As WorkPlane = oDef.WorkPlanes.Item("XZ Plane")

For Each oOcc As ComponentOccurrence In oDef.Occurrences
    If oOcc.Grounded Then Continue For

    ' Optional: Temporarily skip known problematic components
    ' If oOcc.Name = "P25237-CMS-QTS-QTS-RIC2:1" Or oOcc.Name = "25237-WALL-1" Then Continue For

    Dim compDef As Object = oOcc.Definition
    Dim xyPlane As WorkPlane = Nothing
    Dim yzPlane As WorkPlane = Nothing
    Dim xzPlane As WorkPlane = Nothing

    ' Check component type and retrieve work planes
    If TypeOf compDef Is PartComponentDefinition Then
        Dim partDef As PartComponentDefinition = compDef
        xyPlane = TryCast(partDef.WorkPlanes.Item("XY Plane"), WorkPlane)
        yzPlane = TryCast(partDef.WorkPlanes.Item("YZ Plane"), WorkPlane)
        xzPlane = TryCast(partDef.WorkPlanes.Item("XZ Plane"), WorkPlane)
    ElseIf TypeOf compDef Is AssemblyComponentDefinition Then
        Dim asmDef As AssemblyComponentDefinition = compDef
        xyPlane = TryCast(asmDef.WorkPlanes.Item("XY Plane"), WorkPlane)
        yzPlane = TryCast(asmDef.WorkPlanes.Item("YZ Plane"), WorkPlane)
        xzPlane = TryCast(asmDef.WorkPlanes.Item("XZ Plane"), WorkPlane)
    Else
        MessageBox.Show("Unsupported component type: " & oOcc.Name)
        Continue For
    End If

    ' Skip if any plane is missing
    If xyPlane Is Nothing Or yzPlane Is Nothing Or xzPlane Is Nothing Then
        MessageBox.Show("Missing work plane for: " & oOcc.Name)
        Continue For
    End If

    ' Check component state
    If oOcc.Suppressed Then
        MessageBox.Show("Component suppressed: " & oOcc.Name)
        Continue For
    End If
    If oOcc.IsPatternElement Then
        MessageBox.Show("Component in pattern: " & oOcc.Name)
        Continue For
    End If

    ' Apply flush constraints
    Try
        oDef.Constraints.AddFlushConstraint(asmXY, xyPlane, 0)
        oDef.Constraints.AddFlushConstraint(asmYZ, yzPlane, 0)
        oDef.Constraints.AddFlushConstraint(asmXZ, xzPlane, 0)
        oOcc.Grounded = False
    Catch ex As Exception
        Dim compType As String = If(TypeOf compDef Is PartComponentDefinition, "Part", "Assembly")
        MessageBox.Show("Constraint error with: " & oOcc.Name & vbCrLf & _
                        "Type: " & compType & vbCrLf & _
                        "Details: " & ex.Message & vbCrLf & _
                        "Source: " & ex.Source)
        Continue For
    End Try
Next
```

#### Code Block 4

```vb
Dim oAsm As AssemblyDocument = ThisApplication.ActiveDocument
Dim oDef As AssemblyComponentDefinition = oAsm.ComponentDefinition

Dim asmXY As WorkPlane = oDef.WorkPlanes.Item("XY Plane")
Dim asmYZ As WorkPlane = oDef.WorkPlanes.Item("YZ Plane")
Dim asmXZ As WorkPlane = oDef.WorkPlanes.Item("XZ Plane")

For Each oOcc As ComponentOccurrence In oDef.Occurrences
    If oOcc.Grounded Then Continue For

    ' Optional: Temporarily skip known problematic components
    ' If oOcc.Name = "P25237-CMS-QTS-QTS-RIC2:1" Or oOcc.Name = "25237-WALL-1" Then Continue For

    Dim compDef As Object = oOcc.Definition
    Dim xyPlane As WorkPlane = Nothing
    Dim yzPlane As WorkPlane = Nothing
    Dim xzPlane As WorkPlane = Nothing

    ' Check component type and retrieve work planes
    If TypeOf compDef Is PartComponentDefinition Then
        Dim partDef As PartComponentDefinition = compDef
        xyPlane = TryCast(partDef.WorkPlanes.Item("XY Plane"), WorkPlane)
        yzPlane = TryCast(partDef.WorkPlanes.Item("YZ Plane"), WorkPlane)
        xzPlane = TryCast(partDef.WorkPlanes.Item("XZ Plane"), WorkPlane)
    ElseIf TypeOf compDef Is AssemblyComponentDefinition Then
        Dim asmDef As AssemblyComponentDefinition = compDef
        xyPlane = TryCast(asmDef.WorkPlanes.Item("XY Plane"), WorkPlane)
        yzPlane = TryCast(asmDef.WorkPlanes.Item("YZ Plane"), WorkPlane)
        xzPlane = TryCast(asmDef.WorkPlanes.Item("XZ Plane"), WorkPlane)
    Else
        MessageBox.Show("Unsupported component type: " & oOcc.Name)
        Continue For
    End If

    ' Skip if any plane is missing
    If xyPlane Is Nothing Or yzPlane Is Nothing Or xzPlane Is Nothing Then
        MessageBox.Show("Missing work plane for: " & oOcc.Name)
        Continue For
    End If

    ' Check component state
    If oOcc.Suppressed Then
        MessageBox.Show("Component suppressed: " & oOcc.Name)
        Continue For
    End If
    If oOcc.IsPatternElement Then
        MessageBox.Show("Component in pattern: " & oOcc.Name)
        Continue For
    End If

    ' Apply flush constraints
    Try
        oDef.Constraints.AddFlushConstraint(asmXY, xyPlane, 0)
        oDef.Constraints.AddFlushConstraint(asmYZ, yzPlane, 0)
        oDef.Constraints.AddFlushConstraint(asmXZ, xzPlane, 0)
        oOcc.Grounded = False
    Catch ex As Exception
        Dim compType As String = If(TypeOf compDef Is PartComponentDefinition, "Part", "Assembly")
        MessageBox.Show("Constraint error with: " & oOcc.Name & vbCrLf & _
                        "Type: " & compType & vbCrLf & _
                        "Details: " & ex.Message & vbCrLf & _
                        "Source: " & ex.Source)
        Continue For
    End Try
Next
```

#### Code Block 5

```vb
Dim oParalell As Boolean= curAsmOrPlane.Plane.IsParallelTo(curCompOriPlane.Plane, 0.00001)
Dim oSameDirection As Boolean= curAsmOrPlane.Plane.Normal.IsEqualTo(curCompOriPlane.Plane.Normal)

	Dim oNV As NameValueMap


	If oParalell=True Then
'

				If oSameDirection=True Then
				oConstraint=oAsmComp.Constraints.AddFlushConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Zähler))
				End If
				If oSameDirection=False Then
				oConstraint=oAsmComp.Constraints.AddMateConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Zähler))
				End If

	  End If

	Next
	

Next
```

#### Code Block 6

```vb
Dim oParalell As Boolean= curAsmOrPlane.Plane.IsParallelTo(curCompOriPlane.Plane, 0.00001)
Dim oSameDirection As Boolean= curAsmOrPlane.Plane.Normal.IsEqualTo(curCompOriPlane.Plane.Normal)

	Dim oNV As NameValueMap


	If oParalell=True Then
'

				If oSameDirection=True Then
				oConstraint=oAsmComp.Constraints.AddFlushConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Zähler))
				End If
				If oSameDirection=False Then
				oConstraint=oAsmComp.Constraints.AddMateConstraint(curAsmOrPlane, curCompOriPlane, AbstandvonEbene(Zähler))
				End If

	  End If

	Next
	

Next
```

---

### 18. Automatic Drawing view sketch, projection, rectangle

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/automatic-drawing-view-sketch-projection-rectangle/td-p/13814668](https://forums.autodesk.com/t5/inventor-programming-forum/automatic-drawing-view-sketch-projection-rectangle/td-p/13814668)

**Author:** NachoShaw

**Date:** ‎09-17-2025
	
		
		07:48 AM

**Description:** Hey there!   I dont usually work code the drawing environment so im looking for a bit of help    im bringing in my parts like this    i need to automatically add a sketch to the view ( i can do this) draw a rectangle around the outside of the part (i cant do this) constrain the rectangle at .5in to ...

**Code Snippets (5):**

#### Code Block 1

```vb
Dim InventorApp As Inventor.Application = ThisApplication
Dim oDrawingDoc As DrawingDocument = InventorApp.ActiveDocument

Dim activeSheet As Sheet
Dim oView As DrawingView

oSheet = oDrawingDoc.ActiveSheet
oView = oSheet.DrawingViews(1)

Dim oSketch As DrawingSketch
Dim oCurve As DrawingCurve


oSketch = oView.Sketches.Add()
oSketch.Edit

For Each oCurve In oView.DrawingCurves
	Try
		oSketch.AddByProjectingEntity(oCurve)
	Catch
	End Try
Next

offset = 0.1 in
x = (oView.Width / 2 / oView.Scale) + offset
y = oView.Height / 2 / oView.Scale + offset
pt1 = ThisApplication.TransientGeometry.CreatePoint2d(-x, -y)
pt2 = ThisApplication.TransientGeometry.CreatePoint2d(x, y)
textPt = ThisApplication.TransientGeometry.CreatePoint2d(x+1, y+1)

oSketch.SketchLines.AddAsTwoPointRectangle(pt1, pt2)

Dim Dimension1 = oSketch.DimensionConstraints.AddTwoPointDistance(oSketch.SketchLines(1).EndSketchPoint,
oSketch.SketchLines(5).EndSketchPoint, DimensionOrientationEnum.kHorizontalDim, textPt)
oSketch.ExitEdit
```

#### Code Block 2

```vb
Dim InventorApp As Inventor.Application = ThisApplication
Dim oDrawingDoc As DrawingDocument = InventorApp.ActiveDocument

Dim activeSheet As Sheet
Dim oView As DrawingView

oSheet = oDrawingDoc.ActiveSheet
oView = oSheet.DrawingViews(1)

Dim oSketch As DrawingSketch
Dim oCurve As DrawingCurve


oSketch = oView.Sketches.Add()
oSketch.Edit

For Each oCurve In oView.DrawingCurves
	Try
		oSketch.AddByProjectingEntity(oCurve)
	Catch
	End Try
Next

offset = 0.1 in
x = (oView.Width / 2 / oView.Scale) + offset
y = oView.Height / 2 / oView.Scale + offset
pt1 = ThisApplication.TransientGeometry.CreatePoint2d(-x, -y)
pt2 = ThisApplication.TransientGeometry.CreatePoint2d(x, y)
textPt = ThisApplication.TransientGeometry.CreatePoint2d(x+1, y+1)

oSketch.SketchLines.AddAsTwoPointRectangle(pt1, pt2)

Dim Dimension1 = oSketch.DimensionConstraints.AddTwoPointDistance(oSketch.SketchLines(1).EndSketchPoint,
oSketch.SketchLines(5).EndSketchPoint, DimensionOrientationEnum.kHorizontalDim, textPt)
oSketch.ExitEdit
```

#### Code Block 3

```vb
Dim InventorApp As Inventor.Application = ThisApplication
Dim oDrawingDoc As DrawingDocument = InventorApp.ActiveDocument

Dim activeSheet As Sheet
Dim oView As DrawingView

oSheet = oDrawingDoc.ActiveSheet
oView = oSheet.DrawingViews(1)

Dim oSketch As DrawingSketch
Dim oCurve As DrawingCurve


oSketch = oView.Sketches.Add()
oSketch.Edit

For Each oCurve In oView.DrawingCurves
	Try
		oSketch.AddByProjectingEntity(oCurve)
	Catch
	End Try
Next

offset = 0.1 in
x = (oView.Width / 2 / oView.Scale) + offset
y = oView.Height / 2 / oView.Scale + offset
pt1 = ThisApplication.TransientGeometry.CreatePoint2d(-x, -y)
pt2 = ThisApplication.TransientGeometry.CreatePoint2d(x, y)
textPt = ThisApplication.TransientGeometry.CreatePoint2d(x+1, y+1)

oSketch.SketchLines.AddAsTwoPointRectangle(pt1, pt2)

Dim Dimension1 = oSketch.DimensionConstraints.AddTwoPointDistance(oSketch.SketchLines(1).EndSketchPoint,
oSketch.SketchLines(5).EndSketchPoint, DimensionOrientationEnum.kHorizontalDim, textPt)
oSketch.ExitEdit
```

#### Code Block 4

```vb
Dim InventorApp As Inventor.Application = ThisApplication 
Dim oDrawingDoc As DrawingDocument = InventorApp.ActiveDocument 
Dim activeSheet As Sheet 
Dim oView As DrawingView 
oSheet = oDrawingDoc.ActiveSheet 
oView = oSheet.DrawingViews(1) 

Dim oSketch As DrawingSketch 
Dim oCurve As DrawingCurve 
oSketch = oView.Sketches.Add() 
oSketch.Edit 
For Each oCurve In oView.DrawingCurves 
Try 
oSketch.AddByProjectingEntity(oCurve) 
Catch 
End Try 
Next 

Dim oCollection As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection() 

oCollection.Add(oSketch.SketchLines(1)) oCollection.Add(oSketch.SketchLines(2)) oCollection.Add(oSketch.SketchLines(3)) oCollection.Add(oSketch.SketchLines(4)) 

oSketch.OffsetSketchEntitiesUsingDistance(oCollection, 0.1, True, False, true) 

oSketch.DimensionConstraints.AddTwoPointDistance(oSketch.SketchLines(1).EndSketchPoint, oSketch.SketchLines(5).EndSketchPoint, DimensionOrientationEnum.kHorizontalDim, oView.Center)

 oSketch.ExitEdit
```

#### Code Block 5

```vb
Dim InventorApp As Inventor.Application = ThisApplication 
Dim oDrawingDoc As DrawingDocument = InventorApp.ActiveDocument 
Dim activeSheet As Sheet 
Dim oView As DrawingView 
oSheet = oDrawingDoc.ActiveSheet 
oView = oSheet.DrawingViews(1) 

Dim oSketch As DrawingSketch 
Dim oCurve As DrawingCurve 
oSketch = oView.Sketches.Add() 
oSketch.Edit 
For Each oCurve In oView.DrawingCurves 
Try 
oSketch.AddByProjectingEntity(oCurve) 
Catch 
End Try 
Next 

Dim oCollection As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection() 

oCollection.Add(oSketch.SketchLines(1)) oCollection.Add(oSketch.SketchLines(2)) oCollection.Add(oSketch.SketchLines(3)) oCollection.Add(oSketch.SketchLines(4)) 

oSketch.OffsetSketchEntitiesUsingDistance(oCollection, 0.1, True, False, true) 

oSketch.DimensionConstraints.AddTwoPointDistance(oSketch.SketchLines(1).EndSketchPoint, oSketch.SketchLines(5).EndSketchPoint, DimensionOrientationEnum.kHorizontalDim, oView.Center)

 oSketch.ExitEdit
```

#### Code Block 6

```vb
Dim InventorApp As Inventor.Application = ThisApplication 
Dim oDrawingDoc As DrawingDocument = InventorApp.ActiveDocument 
Dim activeSheet As Sheet 
Dim oView As DrawingView 
oSheet = oDrawingDoc.ActiveSheet 
oView = oSheet.DrawingViews(1) 

Dim oSketch As DrawingSketch 
Dim oCurve As DrawingCurve 
oSketch = oView.Sketches.Add() 
oSketch.Edit 
For Each oCurve In oView.DrawingCurves 
Try 
oSketch.AddByProjectingEntity(oCurve) 
Catch 
End Try 
Next 

Dim oCollection As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection() 

oCollection.Add(oSketch.SketchLines(1)) oCollection.Add(oSketch.SketchLines(2)) oCollection.Add(oSketch.SketchLines(3)) oCollection.Add(oSketch.SketchLines(4)) 

oSketch.OffsetSketchEntitiesUsingDistance(oCollection, 0.1, True, False, true) 

oSketch.DimensionConstraints.AddTwoPointDistance(oSketch.SketchLines(1).EndSketchPoint, oSketch.SketchLines(5).EndSketchPoint, DimensionOrientationEnum.kHorizontalDim, oView.Center)

 oSketch.ExitEdit
```

#### Code Block 7

```vb
Dim InventorApp As Inventor.Application = ThisApplication 
Dim oDrawingDoc As DrawingDocument = InventorApp.ActiveDocument 
Dim activeSheet As Sheet 
Dim oView As DrawingView 
oSheet = oDrawingDoc.ActiveSheet 
oView = oSheet.DrawingViews(1) 

Dim oSketch As DrawingSketch 
Dim oCurve As DrawingCurve 
oSketch = oView.Sketches.Add() 
oSketch.Edit 
For Each oCurve In oView.DrawingCurves 
Try 
oSketch.AddByProjectingEntity(oCurve) 
Catch 
End Try 
Next 

Dim oCollection As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection() 

oCollection.Add(oSketch.SketchLines(1)) oCollection.Add(oSketch.SketchLines(2)) oCollection.Add(oSketch.SketchLines(3)) oCollection.Add(oSketch.SketchLines(4)) 

oSketch.OffsetSketchEntitiesUsingDistance(oCollection, 0.1, True, False, true) 

oSketch.DimensionConstraints.AddTwoPointDistance(oSketch.SketchLines(1).EndSketchPoint, oSketch.SketchLines(5).EndSketchPoint, DimensionOrientationEnum.kHorizontalDim, oView.Center)

 oSketch.ExitEdit
```

#### Code Block 8

```vb
Dim InventorApp As Inventor.Application = ThisApplication 
Dim oDrawingDoc As DrawingDocument = InventorApp.ActiveDocument 
Dim activeSheet As Sheet 
Dim oView As DrawingView 
oSheet = oDrawingDoc.ActiveSheet 
oView = oSheet.DrawingViews(1) 

Dim oSketch As DrawingSketch 
Dim oCurve As DrawingCurve 
oSketch = oView.Sketches.Add() 
oSketch.Edit 
For Each oCurve In oView.DrawingCurves 
Try 
oSketch.AddByProjectingEntity(oCurve) 
Catch 
End Try 
Next 

Dim oCollection As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection() 

oCollection.Add(oSketch.SketchLines(1)) oCollection.Add(oSketch.SketchLines(2)) oCollection.Add(oSketch.SketchLines(3)) oCollection.Add(oSketch.SketchLines(4)) 

oSketch.OffsetSketchEntitiesUsingDistance(oCollection, 0.1, True, False, true) 

oSketch.DimensionConstraints.AddTwoPointDistance(oSketch.SketchLines(1).EndSketchPoint, oSketch.SketchLines(5).EndSketchPoint, DimensionOrientationEnum.kHorizontalDim, oView.Center)

 oSketch.ExitEdit
```

#### Code Block 9

```vb
Dim InventorApp As Inventor.Application = ThisApplication 
Dim oDrawingDoc As DrawingDocument = InventorApp.ActiveDocument 
Dim activeSheet As Sheet 
Dim oView As DrawingView 
oSheet = oDrawingDoc.ActiveSheet 
oView = oSheet.DrawingViews(1) 

Dim oSketch As DrawingSketch 
Dim oCurve As DrawingCurve 
oSketch = oView.Sketches.Add() 
oSketch.Edit 
For Each oCurve In oView.DrawingCurves 
Try 
oSketch.AddByProjectingEntity(oCurve) 
Catch 
End Try 
Next 

Dim oCollection As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection() 

oCollection.Add(oSketch.SketchLines(1)) oCollection.Add(oSketch.SketchLines(2)) oCollection.Add(oSketch.SketchLines(3)) oCollection.Add(oSketch.SketchLines(4)) 

oSketch.OffsetSketchEntitiesUsingDistance(oCollection, 0.1, True, False, true) 

oSketch.DimensionConstraints.AddTwoPointDistance(oSketch.SketchLines(1).EndSketchPoint, oSketch.SketchLines(5).EndSketchPoint, DimensionOrientationEnum.kHorizontalDim, oView.Center)

 oSketch.ExitEdit
```

#### Code Block 10

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As DrawingDocument = App.ActiveDocument
	Dim oTG As TransientGeometry = App.TransientGeometry
	
	Dim oSheet As Sheet = oDoc.Sheets.Item(1) 'only one sheet on doc	
	Dim OnlyView As DrawingView = oSheet.DrawingViews.Item(1) 'only one view on doc. 
	
	Dim ViewSketch As Sketch = OnlyView.Sketches.Add()
	
ViewSketch.Edit() 'You must edit the sketch to work within the view sketch. 
	
	Dim ViewCenterPoint As Point2d = oTG.CreatePoint2d(0, 0) 'The drawing sketch will always place the starting point in the center of the view.
	
	Logger.Info("View width: " & OnlyView.Width & " View height: " & OnlyView.Height)
	
	Dim HalfWidth As Double = OnlyView.Width  / 4
	Dim HalfHeight As Double = OnlyView.Height / 4
	
	Logger.Info("Half Width: " & HalfWidth /2 & " Half height: " & HalfHeight /2)
	
	Dim ViewCornerPoint As SketchPoint = ViewSketch.SketchPoints.Add(oTG.CreatePoint2d(HalfWidth /2,  HalfHeight /2))
	
	ViewSketch.SketchLines.AddAsTwoPointCenteredRectangle(ViewCenterPoint, ViewCornerPoint)
	
ViewSketch.ExitEdit() 'Exit the edit or leave ilogic stuck in sketch. 
	

End Sub
```

#### Code Block 11

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As DrawingDocument = App.ActiveDocument
	Dim oTG As TransientGeometry = App.TransientGeometry
	
	Dim oSheet As Sheet = oDoc.Sheets.Item(1) 'only one sheet on doc	
	Dim OnlyView As DrawingView = oSheet.DrawingViews.Item(1) 'only one view on doc. 
	
	Dim ViewSketch As Sketch = OnlyView.Sketches.Add()
	
ViewSketch.Edit() 'You must edit the sketch to work within the view sketch. 
	
	Dim ViewCenterPoint As Point2d = oTG.CreatePoint2d(0, 0) 'The drawing sketch will always place the starting point in the center of the view.
	
	Logger.Info("View width: " & OnlyView.Width & " View height: " & OnlyView.Height)
	
	Dim HalfWidth As Double = OnlyView.Width  / 4
	Dim HalfHeight As Double = OnlyView.Height / 4
	
	Logger.Info("Half Width: " & HalfWidth /2 & " Half height: " & HalfHeight /2)
	
	Dim ViewCornerPoint As SketchPoint = ViewSketch.SketchPoints.Add(oTG.CreatePoint2d(HalfWidth /2,  HalfHeight /2))
	
	ViewSketch.SketchLines.AddAsTwoPointCenteredRectangle(ViewCenterPoint, ViewCornerPoint)
	
ViewSketch.ExitEdit() 'Exit the edit or leave ilogic stuck in sketch. 
	

End Sub
```

#### Code Block 12

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As DrawingDocument = App.ActiveDocument
	Dim oTG As TransientGeometry = App.TransientGeometry
	
	Dim oSheet As Sheet = oDoc.Sheets.Item(1) 'only one sheet on doc	
	Dim OnlyView As DrawingView = oSheet.DrawingViews.Item(1) 'only one view on doc. 
	
	Dim ViewSketch As Sketch = OnlyView.Sketches.Add()
	
ViewSketch.Edit() 'You must edit the sketch to work within the view sketch. 
	
	Dim ViewCenterPoint As Point2d = oTG.CreatePoint2d(0, 0) 'The drawing sketch will always place the starting point in the center of the view.
	
	Logger.Info("View width: " & OnlyView.Width & " View height: " & OnlyView.Height)
	
	Dim HalfWidth As Double = OnlyView.Width  / 4
	Dim HalfHeight As Double = OnlyView.Height / 4
	
	Logger.Info("Half Width: " & HalfWidth /2 & " Half height: " & HalfHeight /2)
	
	Dim ViewCornerPoint As SketchPoint = ViewSketch.SketchPoints.Add(oTG.CreatePoint2d(HalfWidth /2,  HalfHeight /2))
	
	ViewSketch.SketchLines.AddAsTwoPointCenteredRectangle(ViewCenterPoint, ViewCornerPoint)
	
ViewSketch.ExitEdit() 'Exit the edit or leave ilogic stuck in sketch. 
	

End Sub
```

#### Code Block 13

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As DrawingDocument = App.ActiveDocument
	Dim oTG As TransientGeometry = App.TransientGeometry
	
	Dim oSheet As Sheet = oDoc.Sheets.Item(1) 'only one sheet on doc	
	Dim OnlyView As DrawingView = oSheet.DrawingViews.Item(1) 'only one view on doc. 
	
	Dim ViewSketch As Sketch = OnlyView.Sketches.Add()
	
ViewSketch.Edit() 'You must edit the sketch to work within the view sketch. 
	
	Dim ViewCenterPoint As Point2d = oTG.CreatePoint2d(0, 0) 'The drawing sketch will always place the starting point in the center of the view.
	
	Logger.Info("View width: " & OnlyView.Width & " View height: " & OnlyView.Height)
	
	Dim HalfWidth As Double = OnlyView.Width  / 4
	Dim HalfHeight As Double = OnlyView.Height / 4
	
	Logger.Info("Half Width: " & HalfWidth /2 & " Half height: " & HalfHeight /2)
	
	Dim ViewCornerPoint As SketchPoint = ViewSketch.SketchPoints.Add(oTG.CreatePoint2d(HalfWidth /2,  HalfHeight /2))
	
	ViewSketch.SketchLines.AddAsTwoPointCenteredRectangle(ViewCenterPoint, ViewCornerPoint)
	
ViewSketch.ExitEdit() 'Exit the edit or leave ilogic stuck in sketch. 
	

End Sub
```

#### Code Block 14

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As DrawingDocument = App.ActiveDocument
	Dim oTG As TransientGeometry = App.TransientGeometry
	
	Dim oSheet As Sheet = oDoc.Sheets.Item(1) 'only one sheet on doc	
	Dim OnlyView As DrawingView = oSheet.DrawingViews.Item(1) 'only one view on doc. 
	
	Dim ViewSketch As Sketch = OnlyView.Sketches.Add()
	
ViewSketch.Edit() 'You must edit the sketch to work within the view sketch. 
	
	Dim ViewCenterPoint As Point2d = oTG.CreatePoint2d(0, 0) 'The drawing sketch will always place the starting point in the center of the view.
	
	Logger.Info("View width: " & OnlyView.Width & " View height: " & OnlyView.Height)
	
	Dim HalfWidth As Double = OnlyView.Width  / 4
	Dim HalfHeight As Double = OnlyView.Height / 4
	
	Logger.Info("Half Width: " & HalfWidth /2 & " Half height: " & HalfHeight /2)
	
	Dim ViewCornerPoint As SketchPoint = ViewSketch.SketchPoints.Add(oTG.CreatePoint2d(HalfWidth /2,  HalfHeight /2))
	
	ViewSketch.SketchLines.AddAsTwoPointCenteredRectangle(ViewCenterPoint, ViewCornerPoint)
	
ViewSketch.ExitEdit() 'Exit the edit or leave ilogic stuck in sketch. 
	

End Sub
```

#### Code Block 15

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As DrawingDocument = App.ActiveDocument
	Dim oTG As TransientGeometry = App.TransientGeometry
	
	Dim oSheet As Sheet = oDoc.Sheets.Item(1) 'only one sheet on doc	
	Dim OnlyView As DrawingView = oSheet.DrawingViews.Item(1) 'only one view on doc. 
	
	Dim ViewSketch As Sketch = OnlyView.Sketches.Add()
	
ViewSketch.Edit() 'You must edit the sketch to work within the view sketch. 
	
	Dim ViewCenterPoint As Point2d = oTG.CreatePoint2d(0, 0) 'The drawing sketch will always place the starting point in the center of the view.
	
	Logger.Info("View width: " & OnlyView.Width & " View height: " & OnlyView.Height)
	
	Dim HalfWidth As Double = OnlyView.Width  / 4
	Dim HalfHeight As Double = OnlyView.Height / 4
	
	Logger.Info("Half Width: " & HalfWidth /2 & " Half height: " & HalfHeight /2)
	
	Dim ViewCornerPoint As SketchPoint = ViewSketch.SketchPoints.Add(oTG.CreatePoint2d(HalfWidth /2,  HalfHeight /2))
	
	ViewSketch.SketchLines.AddAsTwoPointCenteredRectangle(ViewCenterPoint, ViewCornerPoint)
	
ViewSketch.ExitEdit() 'Exit the edit or leave ilogic stuck in sketch. 
	

End Sub
```

---

### 19. Automating Update Model in Drawings

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/automating-update-model-in-drawings/td-p/13783094#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/automating-update-model-in-drawings/td-p/13783094#messageview_0)

**Author:** m_elsabbahyMDT3V

**Date:** ‎08-26-2025
	
		
		02:25 AM

**Description:** Hi all,I’m trying to create an ilogic external rule in Autodesk Inventor 2024 to automatically update all drawing views in all sheets of an open .idw or .dwg drawing. Specifically, I need to replicate the “Update Model” command you get when right-clicking a drawing view → Update Model.Here’s what I’...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, DrawingDocument)
If oDDoc Is Nothing Then Return
Dim oMDoc As Inventor.Document = ThisDoc.ModelDocument
If oMDoc Is Nothing Then Return
'oMDoc.Rebuild2(True)
oMDoc.Update2(True)
oDDoc.Update2(True)
For Each oSheet As Inventor.Sheet In oDDoc.Sheets
	For Each oDView As DrawingView In oSheet.DrawingViews
		Dim oRFD As FileDescriptor = oDView.ReferencedDocumentDescriptor.ReferencedFileDescriptor
		oRFD.ReplaceReference(oRFD.FullFileName)
	Next 'oDView
	oSheet.Update()
Next 'oSheet
```

#### Code Block 2

```vb
Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, DrawingDocument)
If oDDoc Is Nothing Then Return
Dim oMDoc As Inventor.Document = ThisDoc.ModelDocument
If oMDoc Is Nothing Then Return
'oMDoc.Rebuild2(True)
oMDoc.Update2(True)
oDDoc.Update2(True)
For Each oSheet As Inventor.Sheet In oDDoc.Sheets
	For Each oDView As DrawingView In oSheet.DrawingViews
		Dim oRFD As FileDescriptor = oDView.ReferencedDocumentDescriptor.ReferencedFileDescriptor
		oRFD.ReplaceReference(oRFD.FullFileName)
	Next 'oDView
	oSheet.Update()
Next 'oSheet
```

#### Code Block 3

```vb
ThisDoc.ModelDocument.Update
```

#### Code Block 4

```vb
ThisDoc.ModelDocument.Update
```

---

### 20. Automation for sheet usage

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/automation-for-sheet-usage/td-p/13794033](https://forums.autodesk.com/t5/inventor-programming-forum/automation-for-sheet-usage/td-p/13794033)

**Author:** bogholderiE4HL4

**Date:** ‎09-02-2025
	
		
		11:51 PM

**Description:** HelloI'm looking for a way to add 3 assemblies onto a sheet, and 1 representation file - .ipn.The 3 assemblies, would be seperated by two different representations, "No Walls" and "Open".I would like to be able to rotate them aswell and add a scaling to them.This kinda works fine with some help from...

**Code Snippets (2):**

#### Code Block 1

```vb
Sub ModifyPageScale()
		
		Dim Version As String = iProperties.Value("Project", "Revision Number")
		Dim JobNo As String = iProperties.Value("Project", "Project")
	
	Try	
		Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
		Dim oTG As TransientGeometry = ThisApplication.TransientGeometry
		Dim oScale As Double = .25 / 12
		
		Dim oPage1 As Sheet = oDoc.Sheets.Item(1)
	
		Dim oPageOneView1 As DrawingView
		Dim oPageOneView2 As DrawingView
		Dim oPageOneView3 As DrawingView 
		Dim oPageOneView4 As DrawingView
	
		Try
			oPageOneView1 = oPage1.DrawingViews.Item(4) 'VIEW AT 135 DEG - View 1
			oPageOneView2 = oPage1.DrawingViews.Item(3) 'VIEW AT 45 DEG - View 2
			oPageOneView3 = oPage1.DrawingViews.Item(2) 'VIEW AT 315 DEG - View 3
			oPageOneView4 = oPage1.DrawingViews.Item(1) 'VIEW AT 225 DEG - View 4
		Catch ex As Exception
			MessageBox.Show("Problem at document creation, assembly, part, or otherwise was not selected correctly at start up." * vbCrLf & "Please close this document and restart" & vbCrLf & "Exitting startup program.")
			Exit Sub
		End Try
		
		oPageOneView1.Scale = oScale
		oPageOneView2.Scale = oScale
		oPageOneView3.Scale = oScale
		oPageOneView4.Scale = oScale
		
		'MessageBox.Show("Reset scale for tesing.")
		
		Dim ViewStyle As DrawingViewStyleEnum = DrawingViewStyleEnum.kHiddenLineDrawingViewStyle
		
		Dim Box1Point As Point2d = oTG.CreatePoint2d(.635, .635)
		Dim Box2Point As Point2d = oTG.CreatePoint2d(33, 13)
		
		Dim oPage1Box As Box2d = oTG.CreateBox2d()
		oPage1Box.MinPoint = Box1Point
		oPage1Box.MaxPoint = Box2Point
		
		Dim oPage1BoxWidth As Double = Box2Point.X - Box1Point.X
		Dim oPage1BoxHeight As Double = Box2Point.Y - Box1Point.Y
		
		'MessageBox.Show(oPage1BoxWidth.ToString & " " & oPage1BoxHeight.ToString) 'This checks the size of the x and y of the box object
		
		Dim oBox1YHeight As Double = oPage1BoxHeight / 2 + .635 'This variable represents the distance from center to bottom of page for page one view placement
		Dim oBox1XWidthStart As Double = (oPage1BoxWidth / 4) / 2 + .635 'This variable represents the distance from left edge of sheet to center start point for first page 1st view placement
		Dim oBox1XWidthCenter As Double = (oPage1BoxWidth / 4) / 2 'This value represents the distance on the x axis for view spacing. 
		
		'Messagebox.Show("The first value should match 6.945 " & oBox1Yheight.ToString & " This second value should match 4.68 " & oBox1XWidthStart.ToString & " The thrid value should match 4.0456 " & oBox1XWidthCenter.ToString) 'This verifies the correct distance values mathmatically. 
		
		'Below establishes the point objects that each view on page one will be attached to upon runtime. 
		Dim PageOneViewOne As Point2d = oTG.CreatePoint2d(oBox1XWidthStart, oBox1YHeight)
		Dim PageOneViewTwo As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 2, oBox1YHeight)
		Dim PageOneViewThree As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 4, oBox1YHeight)
		Dim PageOneviewFour As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 6, oBox1YHeight)
		
		'Start the scaling of each view in sheet one to be smaller than the quadrant of the bounding box. 
		'Using height, and width of the views, we can compare that to a variable established to represent the size of the quadrant they're within. 
		Dim Page1MaxViewWidth As Double = oPage1BoxWidth / 4 ' Should equal 8.091
		Dim Page1MaxViewHeight As Double = oPage1BoxHeight 'Should be the same as the total height of the box, no reason to equate it. 
		
		i = 0
		oScale = oPageOneView1.Scale
		
		'The section below is checking the view size against the created box2d zones in the program. If the height or the width are too large, we scale by 94% and check the values again until the view size is lower than the box2d object
		Do While oPageOneView1.Width > Page1MaxViewWidth Or oPageOneView1.Height > Page1MaxViewHeight
			'
			'MessageBox.Show("Page one width: " & oPageOneView1.Width.ToString & " Page one height: " & oPageOneView1.Height.ToString & vbCrLf & " Page 1 width maximum: " & Page1MaxViewWidth & " Page 1 height maximum: " & Page1MaxViewHeight)
			oScale = oScale * .96
			oPageOneView1.Scale = oScale
			oPageOneView2.Scale = oScale
			oPageOneView3.Scale = oScale
			oPageOneView4.Scale = oScale
		
			'Logger.Info("Loop " & i & " - oScale:" & oScale & " Viewscale: " & oPageOneView1.Scale)
			'Logger.Info("   " & oPageOneView1.Width)
			'Logger.Info("   " & oPageOneView1.Height)
			'Logger.Info("   View Width: " & oPageOneView1.Width)
			'Logger.Info("   View Height: " & oPageOneView1.Height)
		
			'ActiveSheet.NativeEntity.Update
			'ThisDoc.Document.Update
		
			'endless loop killer just in case. This is a file within the C drive that exists to create a stop barrior between an endless loop and restarting the program. 
			'If the file is not found, or has it's name changed. It will enter the if block and exit the sub immediately before the need to crash the software. 
			'oFile = "C:\Temp\Endless Loop Saftey File.txt"
			'If IO.File.Exists("C:\Temp\Endless Loop Saftey File.txt") = False Then
			'	MsgBox("The rule called '" & iLogicVb.RuleName & "' stopped because text file doesn't exist:" & vbLf & oFile, , "iLogic")
			'	Exit Sub
			'End If
			
			
			i = i + 1
		Loop
	Catch ex As Exception
		MessageBox.Show("Please copy the following message into ""Bug reporting"" on teams:" & vbCrLf & vbCrLf & "Drawing template - Updating symbol library." & vbCrLf & _
		"Version: " & Version & vbCrLf & "Job no: " & JobNo & vbCrLf & "Unable to scale page 1 views, please check placement and size. ") 
	End Try
		
End Sub
```

#### Code Block 2

```vb
Sub ModifyPageScale()
		
		Dim Version As String = iProperties.Value("Project", "Revision Number")
		Dim JobNo As String = iProperties.Value("Project", "Project")
	
	Try	
		Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
		Dim oTG As TransientGeometry = ThisApplication.TransientGeometry
		Dim oScale As Double = .25 / 12
		
		Dim oPage1 As Sheet = oDoc.Sheets.Item(1)
	
		Dim oPageOneView1 As DrawingView
		Dim oPageOneView2 As DrawingView
		Dim oPageOneView3 As DrawingView 
		Dim oPageOneView4 As DrawingView
	
		Try
			oPageOneView1 = oPage1.DrawingViews.Item(4) 'VIEW AT 135 DEG - View 1
			oPageOneView2 = oPage1.DrawingViews.Item(3) 'VIEW AT 45 DEG - View 2
			oPageOneView3 = oPage1.DrawingViews.Item(2) 'VIEW AT 315 DEG - View 3
			oPageOneView4 = oPage1.DrawingViews.Item(1) 'VIEW AT 225 DEG - View 4
		Catch ex As Exception
			MessageBox.Show("Problem at document creation, assembly, part, or otherwise was not selected correctly at start up." * vbCrLf & "Please close this document and restart" & vbCrLf & "Exitting startup program.")
			Exit Sub
		End Try
		
		oPageOneView1.Scale = oScale
		oPageOneView2.Scale = oScale
		oPageOneView3.Scale = oScale
		oPageOneView4.Scale = oScale
		
		'MessageBox.Show("Reset scale for tesing.")
		
		Dim ViewStyle As DrawingViewStyleEnum = DrawingViewStyleEnum.kHiddenLineDrawingViewStyle
		
		Dim Box1Point As Point2d = oTG.CreatePoint2d(.635, .635)
		Dim Box2Point As Point2d = oTG.CreatePoint2d(33, 13)
		
		Dim oPage1Box As Box2d = oTG.CreateBox2d()
		oPage1Box.MinPoint = Box1Point
		oPage1Box.MaxPoint = Box2Point
		
		Dim oPage1BoxWidth As Double = Box2Point.X - Box1Point.X
		Dim oPage1BoxHeight As Double = Box2Point.Y - Box1Point.Y
		
		'MessageBox.Show(oPage1BoxWidth.ToString & " " & oPage1BoxHeight.ToString) 'This checks the size of the x and y of the box object
		
		Dim oBox1YHeight As Double = oPage1BoxHeight / 2 + .635 'This variable represents the distance from center to bottom of page for page one view placement
		Dim oBox1XWidthStart As Double = (oPage1BoxWidth / 4) / 2 + .635 'This variable represents the distance from left edge of sheet to center start point for first page 1st view placement
		Dim oBox1XWidthCenter As Double = (oPage1BoxWidth / 4) / 2 'This value represents the distance on the x axis for view spacing. 
		
		'Messagebox.Show("The first value should match 6.945 " & oBox1Yheight.ToString & " This second value should match 4.68 " & oBox1XWidthStart.ToString & " The thrid value should match 4.0456 " & oBox1XWidthCenter.ToString) 'This verifies the correct distance values mathmatically. 
		
		'Below establishes the point objects that each view on page one will be attached to upon runtime. 
		Dim PageOneViewOne As Point2d = oTG.CreatePoint2d(oBox1XWidthStart, oBox1YHeight)
		Dim PageOneViewTwo As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 2, oBox1YHeight)
		Dim PageOneViewThree As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 4, oBox1YHeight)
		Dim PageOneviewFour As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 6, oBox1YHeight)
		
		'Start the scaling of each view in sheet one to be smaller than the quadrant of the bounding box. 
		'Using height, and width of the views, we can compare that to a variable established to represent the size of the quadrant they're within. 
		Dim Page1MaxViewWidth As Double = oPage1BoxWidth / 4 ' Should equal 8.091
		Dim Page1MaxViewHeight As Double = oPage1BoxHeight 'Should be the same as the total height of the box, no reason to equate it. 
		
		i = 0
		oScale = oPageOneView1.Scale
		
		'The section below is checking the view size against the created box2d zones in the program. If the height or the width are too large, we scale by 94% and check the values again until the view size is lower than the box2d object
		Do While oPageOneView1.Width > Page1MaxViewWidth Or oPageOneView1.Height > Page1MaxViewHeight
			'
			'MessageBox.Show("Page one width: " & oPageOneView1.Width.ToString & " Page one height: " & oPageOneView1.Height.ToString & vbCrLf & " Page 1 width maximum: " & Page1MaxViewWidth & " Page 1 height maximum: " & Page1MaxViewHeight)
			oScale = oScale * .96
			oPageOneView1.Scale = oScale
			oPageOneView2.Scale = oScale
			oPageOneView3.Scale = oScale
			oPageOneView4.Scale = oScale
		
			'Logger.Info("Loop " & i & " - oScale:" & oScale & " Viewscale: " & oPageOneView1.Scale)
			'Logger.Info("   " & oPageOneView1.Width)
			'Logger.Info("   " & oPageOneView1.Height)
			'Logger.Info("   View Width: " & oPageOneView1.Width)
			'Logger.Info("   View Height: " & oPageOneView1.Height)
		
			'ActiveSheet.NativeEntity.Update
			'ThisDoc.Document.Update
		
			'endless loop killer just in case. This is a file within the C drive that exists to create a stop barrior between an endless loop and restarting the program. 
			'If the file is not found, or has it's name changed. It will enter the if block and exit the sub immediately before the need to crash the software. 
			'oFile = "C:\Temp\Endless Loop Saftey File.txt"
			'If IO.File.Exists("C:\Temp\Endless Loop Saftey File.txt") = False Then
			'	MsgBox("The rule called '" & iLogicVb.RuleName & "' stopped because text file doesn't exist:" & vbLf & oFile, , "iLogic")
			'	Exit Sub
			'End If
			
			
			i = i + 1
		Loop
	Catch ex As Exception
		MessageBox.Show("Please copy the following message into ""Bug reporting"" on teams:" & vbCrLf & vbCrLf & "Drawing template - Updating symbol library." & vbCrLf & _
		"Version: " & Version & vbCrLf & "Job no: " & JobNo & vbCrLf & "Unable to scale page 1 views, please check placement and size. ") 
	End Try
		
End Sub
```

#### Code Block 3

```vb
Sub ModifyPageScale()
		
		Dim Version As String = iProperties.Value("Project", "Revision Number")
		Dim JobNo As String = iProperties.Value("Project", "Project")
	
	Try	
		Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
		Dim oTG As TransientGeometry = ThisApplication.TransientGeometry
		Dim oScale As Double = .25 / 12
		
		Dim oPage1 As Sheet = oDoc.Sheets.Item(1)
	
		Dim oPageOneView1 As DrawingView
		Dim oPageOneView2 As DrawingView
		Dim oPageOneView3 As DrawingView 
		Dim oPageOneView4 As DrawingView
	
		Try
			oPageOneView1 = oPage1.DrawingViews.Item(4) 'VIEW AT 135 DEG - View 1
			oPageOneView2 = oPage1.DrawingViews.Item(3) 'VIEW AT 45 DEG - View 2
			oPageOneView3 = oPage1.DrawingViews.Item(2) 'VIEW AT 315 DEG - View 3
			oPageOneView4 = oPage1.DrawingViews.Item(1) 'VIEW AT 225 DEG - View 4
		Catch ex As Exception
			MessageBox.Show("Problem at document creation, assembly, part, or otherwise was not selected correctly at start up." * vbCrLf & "Please close this document and restart" & vbCrLf & "Exitting startup program.")
			Exit Sub
		End Try
		
		oPageOneView1.Scale = oScale
		oPageOneView2.Scale = oScale
		oPageOneView3.Scale = oScale
		oPageOneView4.Scale = oScale
		
		'MessageBox.Show("Reset scale for tesing.")
		
		Dim ViewStyle As DrawingViewStyleEnum = DrawingViewStyleEnum.kHiddenLineDrawingViewStyle
		
		Dim Box1Point As Point2d = oTG.CreatePoint2d(.635, .635)
		Dim Box2Point As Point2d = oTG.CreatePoint2d(33, 13)
		
		Dim oPage1Box As Box2d = oTG.CreateBox2d()
		oPage1Box.MinPoint = Box1Point
		oPage1Box.MaxPoint = Box2Point
		
		Dim oPage1BoxWidth As Double = Box2Point.X - Box1Point.X
		Dim oPage1BoxHeight As Double = Box2Point.Y - Box1Point.Y
		
		'MessageBox.Show(oPage1BoxWidth.ToString & " " & oPage1BoxHeight.ToString) 'This checks the size of the x and y of the box object
		
		Dim oBox1YHeight As Double = oPage1BoxHeight / 2 + .635 'This variable represents the distance from center to bottom of page for page one view placement
		Dim oBox1XWidthStart As Double = (oPage1BoxWidth / 4) / 2 + .635 'This variable represents the distance from left edge of sheet to center start point for first page 1st view placement
		Dim oBox1XWidthCenter As Double = (oPage1BoxWidth / 4) / 2 'This value represents the distance on the x axis for view spacing. 
		
		'Messagebox.Show("The first value should match 6.945 " & oBox1Yheight.ToString & " This second value should match 4.68 " & oBox1XWidthStart.ToString & " The thrid value should match 4.0456 " & oBox1XWidthCenter.ToString) 'This verifies the correct distance values mathmatically. 
		
		'Below establishes the point objects that each view on page one will be attached to upon runtime. 
		Dim PageOneViewOne As Point2d = oTG.CreatePoint2d(oBox1XWidthStart, oBox1YHeight)
		Dim PageOneViewTwo As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 2, oBox1YHeight)
		Dim PageOneViewThree As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 4, oBox1YHeight)
		Dim PageOneviewFour As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 6, oBox1YHeight)
		
		'Start the scaling of each view in sheet one to be smaller than the quadrant of the bounding box. 
		'Using height, and width of the views, we can compare that to a variable established to represent the size of the quadrant they're within. 
		Dim Page1MaxViewWidth As Double = oPage1BoxWidth / 4 ' Should equal 8.091
		Dim Page1MaxViewHeight As Double = oPage1BoxHeight 'Should be the same as the total height of the box, no reason to equate it. 
		
		i = 0
		oScale = oPageOneView1.Scale
		
		'The section below is checking the view size against the created box2d zones in the program. If the height or the width are too large, we scale by 94% and check the values again until the view size is lower than the box2d object
		Do While oPageOneView1.Width > Page1MaxViewWidth Or oPageOneView1.Height > Page1MaxViewHeight
			'
			'MessageBox.Show("Page one width: " & oPageOneView1.Width.ToString & " Page one height: " & oPageOneView1.Height.ToString & vbCrLf & " Page 1 width maximum: " & Page1MaxViewWidth & " Page 1 height maximum: " & Page1MaxViewHeight)
			oScale = oScale * .96
			oPageOneView1.Scale = oScale
			oPageOneView2.Scale = oScale
			oPageOneView3.Scale = oScale
			oPageOneView4.Scale = oScale
		
			'Logger.Info("Loop " & i & " - oScale:" & oScale & " Viewscale: " & oPageOneView1.Scale)
			'Logger.Info("   " & oPageOneView1.Width)
			'Logger.Info("   " & oPageOneView1.Height)
			'Logger.Info("   View Width: " & oPageOneView1.Width)
			'Logger.Info("   View Height: " & oPageOneView1.Height)
		
			'ActiveSheet.NativeEntity.Update
			'ThisDoc.Document.Update
		
			'endless loop killer just in case. This is a file within the C drive that exists to create a stop barrior between an endless loop and restarting the program. 
			'If the file is not found, or has it's name changed. It will enter the if block and exit the sub immediately before the need to crash the software. 
			'oFile = "C:\Temp\Endless Loop Saftey File.txt"
			'If IO.File.Exists("C:\Temp\Endless Loop Saftey File.txt") = False Then
			'	MsgBox("The rule called '" & iLogicVb.RuleName & "' stopped because text file doesn't exist:" & vbLf & oFile, , "iLogic")
			'	Exit Sub
			'End If
			
			
			i = i + 1
		Loop
	Catch ex As Exception
		MessageBox.Show("Please copy the following message into ""Bug reporting"" on teams:" & vbCrLf & vbCrLf & "Drawing template - Updating symbol library." & vbCrLf & _
		"Version: " & Version & vbCrLf & "Job no: " & JobNo & vbCrLf & "Unable to scale page 1 views, please check placement and size. ") 
	End Try
		
End Sub
```

#### Code Block 4

```vb
Sub ModifyPageScale()
		
		Dim Version As String = iProperties.Value("Project", "Revision Number")
		Dim JobNo As String = iProperties.Value("Project", "Project")
	
	Try	
		Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
		Dim oTG As TransientGeometry = ThisApplication.TransientGeometry
		Dim oScale As Double = .25 / 12
		
		Dim oPage1 As Sheet = oDoc.Sheets.Item(1)
	
		Dim oPageOneView1 As DrawingView
		Dim oPageOneView2 As DrawingView
		Dim oPageOneView3 As DrawingView 
		Dim oPageOneView4 As DrawingView
	
		Try
			oPageOneView1 = oPage1.DrawingViews.Item(4) 'VIEW AT 135 DEG - View 1
			oPageOneView2 = oPage1.DrawingViews.Item(3) 'VIEW AT 45 DEG - View 2
			oPageOneView3 = oPage1.DrawingViews.Item(2) 'VIEW AT 315 DEG - View 3
			oPageOneView4 = oPage1.DrawingViews.Item(1) 'VIEW AT 225 DEG - View 4
		Catch ex As Exception
			MessageBox.Show("Problem at document creation, assembly, part, or otherwise was not selected correctly at start up." * vbCrLf & "Please close this document and restart" & vbCrLf & "Exitting startup program.")
			Exit Sub
		End Try
		
		oPageOneView1.Scale = oScale
		oPageOneView2.Scale = oScale
		oPageOneView3.Scale = oScale
		oPageOneView4.Scale = oScale
		
		'MessageBox.Show("Reset scale for tesing.")
		
		Dim ViewStyle As DrawingViewStyleEnum = DrawingViewStyleEnum.kHiddenLineDrawingViewStyle
		
		Dim Box1Point As Point2d = oTG.CreatePoint2d(.635, .635)
		Dim Box2Point As Point2d = oTG.CreatePoint2d(33, 13)
		
		Dim oPage1Box As Box2d = oTG.CreateBox2d()
		oPage1Box.MinPoint = Box1Point
		oPage1Box.MaxPoint = Box2Point
		
		Dim oPage1BoxWidth As Double = Box2Point.X - Box1Point.X
		Dim oPage1BoxHeight As Double = Box2Point.Y - Box1Point.Y
		
		'MessageBox.Show(oPage1BoxWidth.ToString & " " & oPage1BoxHeight.ToString) 'This checks the size of the x and y of the box object
		
		Dim oBox1YHeight As Double = oPage1BoxHeight / 2 + .635 'This variable represents the distance from center to bottom of page for page one view placement
		Dim oBox1XWidthStart As Double = (oPage1BoxWidth / 4) / 2 + .635 'This variable represents the distance from left edge of sheet to center start point for first page 1st view placement
		Dim oBox1XWidthCenter As Double = (oPage1BoxWidth / 4) / 2 'This value represents the distance on the x axis for view spacing. 
		
		'Messagebox.Show("The first value should match 6.945 " & oBox1Yheight.ToString & " This second value should match 4.68 " & oBox1XWidthStart.ToString & " The thrid value should match 4.0456 " & oBox1XWidthCenter.ToString) 'This verifies the correct distance values mathmatically. 
		
		'Below establishes the point objects that each view on page one will be attached to upon runtime. 
		Dim PageOneViewOne As Point2d = oTG.CreatePoint2d(oBox1XWidthStart, oBox1YHeight)
		Dim PageOneViewTwo As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 2, oBox1YHeight)
		Dim PageOneViewThree As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 4, oBox1YHeight)
		Dim PageOneviewFour As Point2d = oTG.CreatePoint2d(oBox1XWidthStart + oBox1XWidthCenter * 6, oBox1YHeight)
		
		'Start the scaling of each view in sheet one to be smaller than the quadrant of the bounding box. 
		'Using height, and width of the views, we can compare that to a variable established to represent the size of the quadrant they're within. 
		Dim Page1MaxViewWidth As Double = oPage1BoxWidth / 4 ' Should equal 8.091
		Dim Page1MaxViewHeight As Double = oPage1BoxHeight 'Should be the same as the total height of the box, no reason to equate it. 
		
		i = 0
		oScale = oPageOneView1.Scale
		
		'The section below is checking the view size against the created box2d zones in the program. If the height or the width are too large, we scale by 94% and check the values again until the view size is lower than the box2d object
		Do While oPageOneView1.Width > Page1MaxViewWidth Or oPageOneView1.Height > Page1MaxViewHeight
			'
			'MessageBox.Show("Page one width: " & oPageOneView1.Width.ToString & " Page one height: " & oPageOneView1.Height.ToString & vbCrLf & " Page 1 width maximum: " & Page1MaxViewWidth & " Page 1 height maximum: " & Page1MaxViewHeight)
			oScale = oScale * .96
			oPageOneView1.Scale = oScale
			oPageOneView2.Scale = oScale
			oPageOneView3.Scale = oScale
			oPageOneView4.Scale = oScale
		
			'Logger.Info("Loop " & i & " - oScale:" & oScale & " Viewscale: " & oPageOneView1.Scale)
			'Logger.Info("   " & oPageOneView1.Width)
			'Logger.Info("   " & oPageOneView1.Height)
			'Logger.Info("   View Width: " & oPageOneView1.Width)
			'Logger.Info("   View Height: " & oPageOneView1.Height)
		
			'ActiveSheet.NativeEntity.Update
			'ThisDoc.Document.Update
		
			'endless loop killer just in case. This is a file within the C drive that exists to create a stop barrior between an endless loop and restarting the program. 
			'If the file is not found, or has it's name changed. It will enter the if block and exit the sub immediately before the need to crash the software. 
			'oFile = "C:\Temp\Endless Loop Saftey File.txt"
			'If IO.File.Exists("C:\Temp\Endless Loop Saftey File.txt") = False Then
			'	MsgBox("The rule called '" & iLogicVb.RuleName & "' stopped because text file doesn't exist:" & vbLf & oFile, , "iLogic")
			'	Exit Sub
			'End If
			
			
			i = i + 1
		Loop
	Catch ex As Exception
		MessageBox.Show("Please copy the following message into ""Bug reporting"" on teams:" & vbCrLf & vbCrLf & "Drawing template - Updating symbol library." & vbCrLf & _
		"Version: " & Version & vbCrLf & "Job no: " & JobNo & vbCrLf & "Unable to scale page 1 views, please check placement and size. ") 
	End Try
		
End Sub
```

---

### 21. Batch PDF ignoring one file

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/batch-pdf-ignoring-one-file/td-p/13756957#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/batch-pdf-ignoring-one-file/td-p/13756957#messageview_0)

**Author:** Dianna_Harding

**Date:** ‎08-06-2025
	
		
		02:37 PM

**Description:** Been using the batch PDF code for years without issues, until today. It doesn't recognize one drawing even though I can pull it up and manually create a PDF. Says No top level assembly drawing found. Would there be something else making this not recognize the .idw? Files attached 					 				 			 			 ...

**Code Snippets (2):**

#### Code Block 1

```vb
Try
		oAsmDrawingDoc = ThisApplication.Documents.Open(ThisDoc.ChangeExtension(".idw"), False)
	Catch
		MessageBox.Show("No top level assembly drawing found.", "Missing Drawing", MessageBoxButtons.OK)				
	End Try
```

#### Code Block 2

```vb
Try
		oAsmDrawingDoc = ThisApplication.Documents.Open(ThisDoc.ChangeExtension(".idw"), False)
	Catch
		MessageBox.Show("No top level assembly drawing found.", "Missing Drawing", MessageBoxButtons.OK)				
	End Try
```

#### Code Block 3

```vb
Try
		oAsmDrawingDoc = ThisApplication.Documents.Open(ThisDoc.ChangeExtension(".idw"), False)
	Catch
		MessageBox.Show("No top level assembly drawing found.", "Missing Drawing", MessageBoxButtons.OK)				
	End Try
```

#### Code Block 4

```vb
Try
		oAsmDrawingDoc = ThisApplication.Documents.Open(ThisDoc.ChangeExtension(".idw"), False)
	Catch
		MessageBox.Show("No top level assembly drawing found.", "Missing Drawing", MessageBoxButtons.OK)				
	End Try
```

---

### 22. Batch Plot IDWs to single PDF

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/batch-plot-idws-to-single-pdf/td-p/13437520](https://forums.autodesk.com/t5/inventor-programming-forum/batch-plot-idws-to-single-pdf/td-p/13437520)

**Author:** Jesse_Glaze

**Date:** ‎04-22-2025
	
		
		07:26 AM

**Description:** Hello,I am looking for a solution that will plot all drawings associated with an assembly to a single PDF file. Basically, the resulting PDF file should directly mimic the all-level structured BOM of the assembly. I have been browsing addons and see several (such as drawing porter) that pulls all dr...

**Code Snippets (2):**

#### Code Block 1

```vb
AddReference "C:\Users\Public\global references\itextsharp.dll"
AddReference "System.IO"

Class ThisRule


	Shared _Folder_Path As String = String.Empty
	Shared _PDF_Name As String = Nothing
	Shared _GetPDF As String = String.Empty

	Sub Main()

		'set the name of the new pdf you want to create without the extension
		_PDF_Name = IO.Path.GetFileNameWithoutExtension(thisdoc.document.fullfilename) & "_Combined"

		'set the path of the folder contaiing all of the pdfs
		_Folder_Path = "C:\Temp\My PDFs"

		If Not System.IO.Directory.Exists(_Folder_Path) Then
			System.IO.Directory.CreateDirectory(_Folder_Path)
		End If

		'call the sub to created PDFs for all drawings from the current assembly
		Call PDF_ALL_Docs

		'get the PDF result
		Dim OpenPDF As String = CreatePDF(_Folder_Path)

	End Sub



	Sub PDF_ALL_Docs
		'define the active document as an assembly file
		Dim oAsmDoc As AssemblyDocument
		oAsmDoc = ThisApplication.ActiveDocument
		oAsmName = Left(oAsmDoc.DisplayName, Len(oAsmDoc.DisplayName) -4)

		'check that the active document is an assembly file
		If ThisApplication.ActiveDocument.DocumentType <> kAssemblyDocumentObject Then
			MessageBox.Show("Please run this rule from the assembly file.", "iLogic")
			Exit Sub
		End If

		'get user input
		RUsure = MessageBox.Show( _
		"This will create a PDF file for all of the asembly components that have drawings files." _
		& vbLf & "This rule expects that the drawing file shares the same name and location as the component." _
		& vbLf & " " _
		& vbLf & "Are you sure you want to create PDF Drawings for all of the assembly components?" _
		& vbLf & "This could take a while.", "iLogic  - Batch Output PDFs ", MessageBoxButtons.YesNo)

		If RUsure = vbNo Then
			Return
		Else
		End If

		'- - - - - - - - - - - - -PDF setup - - - - - - - - - - - -
		oPath = ThisDoc.Path
		PDFAddIn = ThisApplication.ApplicationAddIns.ItemById("{0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4}")
		oContext = ThisApplication.TransientObjects.CreateTranslationContext
		oContext.Type = IOMechanismEnum.kFileBrowseIOMechanism
		oOptions = ThisApplication.TransientObjects.CreateNameValueMap
		oDataMedium = ThisApplication.TransientObjects.CreateDataMedium


		'oOptions.Value("All_Color_AS_Black") = 0
		oOptions.Value("Remove_Line_Weights") = 1
		oOptions.Value("Vector_Resolution") = 400
		oOptions.Value("Sheet_Range") = Inventor.PrintRangeEnum.kPrintAllSheets
		'oOptions.Value("Custom_Begin_Sheet") = 2
		'oOptions.Value("Custom_End_Sheet") = 4


		'get PDF target folder path
		oFolder = oPath & "\" & oAsmName & " PDF Files"

		'Check for the PDF folder and create it if it does not exist
		If Not System.IO.Directory.Exists(oFolder) Then
			System.IO.Directory.CreateDirectory(oFolder)
		End If

		'- - - - - - - - - - - - -Component Drawings - - - - - - - - - - - -
		'look at the files referenced by the assembly
		Dim oRefDocs As DocumentsEnumerator
		oRefDocs = oAsmDoc.AllReferencedDocuments
		Dim oRefDoc As Document

		'work the the drawing files for the referenced models
		'this expects that the model has a drawing of the same path and name
		For Each oRefDoc In oRefDocs
			drawingPathName = Nothing
			'check to see that the model has a drawing of the same path and name
			drawingPathName = Left(oRefDoc.FullFileName, Len(oRefDoc.FullFileName) -3) & "idw"
			If (System.IO.File.Exists(drawingPathName)) = False Then
				drawingPathName = Left(oRefDoc.FullFileName, Len(oRefDoc.FullFileName) -3) & "dwg"
				If (System.IO.File.Exists(drawingPathName)) = False Then
					Continue For
				End If
			End If

			Logger.info(oRefDoc.FullFileName)

			Dim oDrawDoc As DrawingDocument
			oDrawDoc = ThisApplication.Documents.Open(drawingPathName, False)
			oFileName = Left(oRefDoc.DisplayName, Len(oRefDoc.DisplayName) -3)

			'Set the PDF target file name
			oDataMedium.FileName = _Folder_Path & "\" & oFileName & "pdf"
			'Write out the PDF
			PDFAddIn.SaveCopyAs(oDrawDoc, oContext, oOptions, oDataMedium)
			'close the file
			oDrawDoc.Close

		Next

		drawingPathName = Nothing
		'- - - - - - - - - - - - -Top Level Drawing - - - - - - - - - - - -
		'check to see that the model has a drawing of the same path and name
		drawingPathName = ThisDoc.ChangeExtension(".idw")
		If (System.IO.File.Exists(drawingPathName)) = False Then
			drawingPathName = ThisDoc.ChangeExtension(".dwg")
			If (System.IO.File.Exists(drawingPathName)) = False Then
				drawingPathName = Nothing
			End If
		End If
				
		If Not drawingPathName = Nothing
			oAsmDrawingDoc = ThisApplication.Documents.Open(drawingPathName, False)
			
			PDFName = IO.Path.GetFileNameWithoutExtension(thisdoc.document.fullfilename)

			'Set the PDF target file name
			oDataMedium.FileName = _Folder_Path & "\" & PDFName & ".pdf"
			'Write out the PDF
			PDFAddIn.SaveCopyAs(oAsmDrawingDoc, oContext, oOptions, oDataMedium)
			'Close the top level drawing
			oAsmDrawingDoc.Close
		Else
			Logger.info("Could not find top level drawing")
			Logger.info(drawingPathName)
		End If
	End Sub




	Private Function CreatePDF(_Folder_Path As String)

		Dim bOutputfileAlreadyExists As Boolean = False
		Dim sOutFilePath As String = IO.Path.Combine(_Folder_Path, _PDF_Name & ".pdf")

		'sdet up return for a successful pdf. ret changes to FALSE if any errors occur for qualifying purposes
		Dim ret As String = sOutFilePath

		If IO.File.Exists(sOutFilePath) Then
			Try
				IO.File.Delete(sOutFilePath)
			Catch ex As Exception
				bOutputfileAlreadyExists = True
			End Try
		End If

		Dim iPageCount As Integer = GetPageCount(_Folder_Path)
		If iPageCount > 0 And bOutputfileAlreadyExists = False Then

			Dim oFiles As String() = IO.Directory.GetFiles(_Folder_Path)
			Dim oPdfDoc As New iTextSharp.text.Document()
			Dim oPdfWriter As iTextSharp.text.pdf.PdfWriter = _
			iTextSharp.text.pdf.PdfWriter.GetInstance(oPdfDoc, New IO.FileStream(sOutFilePath, IO.FileMode.Create))

			oPdfDoc.Open()

			System.Array.Sort(Of String)(oFiles)

			For i As Integer = 0 To oFiles.Length - 1
				Dim sFromFilePath As String = oFiles(i)
				Dim oFileInfo As New IO.FileInfo(sFromFilePath)
				Dim sFileType As String = "PDF"
				Dim sExt As String = PadExt(oFileInfo.Extension)

				Try
					AddPdf(sFromFilePath, oPdfDoc, oPdfWriter)
				Catch ex As Exception
					ret = "FALSE"
				End Try
			Next

			Try
				oPdfDoc.Close()
				oPdfWriter.Close()
			Catch ex As Exception

				Try
					IO.File.Delete(sOutFilePath)
				Catch ex2 As Exception
				End Try
			End Try
		End If

		Dim oFolders As String() = IO.Directory.GetDirectories(_Folder_Path)
		For i As Integer = 0 To oFolders.Length - 1
			Dim sChildFolder As String = oFolders(i)
			Dim iPos As Integer = sChildFolder.LastIndexOf("\")
			Dim sFolderName As String = sChildFolder.Substring(iPos + 1)
			CreatePDF(sChildFolder)
		Next

		Return ret

	End Function

	Private Sub AddPdf(ByVal sInFilePath As String, ByRef oPdfDoc As iTextSharp.text.Document, ByRef oPdfWriter As iTextSharp.text.pdf.PdfWriter)

		Dim oDirectContent As iTextSharp.text.pdf.PdfContentByte = oPdfWriter.DirectContent
		Dim oPdfReader As iTextSharp.text.pdf.PdfReader = New iTextSharp.text.pdf.PdfReader(sInFilePath)
		Dim iNumberOfPages As Integer = oPdfReader.NumberOfPages
		Dim iPage As Integer = 0

		Do While (iPage < iNumberOfPages)
			iPage += 1
			oPdfDoc.SetPageSize(oPdfReader.GetPageSizeWithRotation(iPage))
			oPdfDoc.NewPage()

			Dim oPdfImportedPage As iTextSharp.text.pdf.PdfImportedPage = oPdfWriter.GetImportedPage(oPdfReader, iPage)
			Dim iRotation As Integer = oPdfReader.GetPageRotation(iPage)
			If (iRotation = 90) Or (iRotation = 270) Then
				oDirectContent.AddTemplate(oPdfImportedPage, 0, -1.0F, 1.0F, 0, 0, oPdfReader.GetPageSizeWithRotation(iPage).Height)
			Else
				oDirectContent.AddTemplate(oPdfImportedPage, 1.0F, 0, 0, 1.0F, 0, 0)
			End If
		Loop

	End Sub

	Private Function PadExt(ByVal s As String) As String
		s = UCase(s)
		If s.Length > 3 Then
			s = s.Substring(1, 3)
		End If
		Return s
	End Function

	Private Function GetPageCount(ByVal _Folder_Path As String) As Integer
		Dim iRet As Integer = 0
		Dim oFiles As String() = IO.Directory.GetFiles(_Folder_Path)

		For i As Integer = 0 To oFiles.Length - 1
			Dim sFromFilePath As String = oFiles(i)
			Dim oFileInfo As New IO.FileInfo(sFromFilePath)
			Dim sFileType As String = "PDF"
			Dim sExt As String = PadExt(oFileInfo.Extension)

			iRet += 1
		Next

		Return iRet
	End Function

End Class
```

#### Code Block 2

```vb
AddReference "C:\Users\Public\global references\itextsharp.dll"
AddReference "System.IO"

Class ThisRule


	Shared _Folder_Path As String = String.Empty
	Shared _PDF_Name As String = Nothing
	Shared _GetPDF As String = String.Empty

	Sub Main()

		'set the name of the new pdf you want to create without the extension
		_PDF_Name = IO.Path.GetFileNameWithoutExtension(thisdoc.document.fullfilename) & "_Combined"

		'set the path of the folder contaiing all of the pdfs
		_Folder_Path = "C:\Temp\My PDFs"

		If Not System.IO.Directory.Exists(_Folder_Path) Then
			System.IO.Directory.CreateDirectory(_Folder_Path)
		End If

		'call the sub to created PDFs for all drawings from the current assembly
		Call PDF_ALL_Docs

		'get the PDF result
		Dim OpenPDF As String = CreatePDF(_Folder_Path)

	End Sub



	Sub PDF_ALL_Docs
		'define the active document as an assembly file
		Dim oAsmDoc As AssemblyDocument
		oAsmDoc = ThisApplication.ActiveDocument
		oAsmName = Left(oAsmDoc.DisplayName, Len(oAsmDoc.DisplayName) -4)

		'check that the active document is an assembly file
		If ThisApplication.ActiveDocument.DocumentType <> kAssemblyDocumentObject Then
			MessageBox.Show("Please run this rule from the assembly file.", "iLogic")
			Exit Sub
		End If

		'get user input
		RUsure = MessageBox.Show( _
		"This will create a PDF file for all of the asembly components that have drawings files." _
		& vbLf & "This rule expects that the drawing file shares the same name and location as the component." _
		& vbLf & " " _
		& vbLf & "Are you sure you want to create PDF Drawings for all of the assembly components?" _
		& vbLf & "This could take a while.", "iLogic  - Batch Output PDFs ", MessageBoxButtons.YesNo)

		If RUsure = vbNo Then
			Return
		Else
		End If

		'- - - - - - - - - - - - -PDF setup - - - - - - - - - - - -
		oPath = ThisDoc.Path
		PDFAddIn = ThisApplication.ApplicationAddIns.ItemById("{0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4}")
		oContext = ThisApplication.TransientObjects.CreateTranslationContext
		oContext.Type = IOMechanismEnum.kFileBrowseIOMechanism
		oOptions = ThisApplication.TransientObjects.CreateNameValueMap
		oDataMedium = ThisApplication.TransientObjects.CreateDataMedium


		'oOptions.Value("All_Color_AS_Black") = 0
		oOptions.Value("Remove_Line_Weights") = 1
		oOptions.Value("Vector_Resolution") = 400
		oOptions.Value("Sheet_Range") = Inventor.PrintRangeEnum.kPrintAllSheets
		'oOptions.Value("Custom_Begin_Sheet") = 2
		'oOptions.Value("Custom_End_Sheet") = 4


		'get PDF target folder path
		oFolder = oPath & "\" & oAsmName & " PDF Files"

		'Check for the PDF folder and create it if it does not exist
		If Not System.IO.Directory.Exists(oFolder) Then
			System.IO.Directory.CreateDirectory(oFolder)
		End If

		'- - - - - - - - - - - - -Component Drawings - - - - - - - - - - - -
		'look at the files referenced by the assembly
		Dim oRefDocs As DocumentsEnumerator
		oRefDocs = oAsmDoc.AllReferencedDocuments
		Dim oRefDoc As Document

		'work the the drawing files for the referenced models
		'this expects that the model has a drawing of the same path and name
		For Each oRefDoc In oRefDocs
			drawingPathName = Nothing
			'check to see that the model has a drawing of the same path and name
			drawingPathName = Left(oRefDoc.FullFileName, Len(oRefDoc.FullFileName) -3) & "idw"
			If (System.IO.File.Exists(drawingPathName)) = False Then
				drawingPathName = Left(oRefDoc.FullFileName, Len(oRefDoc.FullFileName) -3) & "dwg"
				If (System.IO.File.Exists(drawingPathName)) = False Then
					Continue For
				End If
			End If

			Logger.info(oRefDoc.FullFileName)

			Dim oDrawDoc As DrawingDocument
			oDrawDoc = ThisApplication.Documents.Open(drawingPathName, False)
			oFileName = Left(oRefDoc.DisplayName, Len(oRefDoc.DisplayName) -3)

			'Set the PDF target file name
			oDataMedium.FileName = _Folder_Path & "\" & oFileName & "pdf"
			'Write out the PDF
			PDFAddIn.SaveCopyAs(oDrawDoc, oContext, oOptions, oDataMedium)
			'close the file
			oDrawDoc.Close

		Next

		drawingPathName = Nothing
		'- - - - - - - - - - - - -Top Level Drawing - - - - - - - - - - - -
		'check to see that the model has a drawing of the same path and name
		drawingPathName = ThisDoc.ChangeExtension(".idw")
		If (System.IO.File.Exists(drawingPathName)) = False Then
			drawingPathName = ThisDoc.ChangeExtension(".dwg")
			If (System.IO.File.Exists(drawingPathName)) = False Then
				drawingPathName = Nothing
			End If
		End If
				
		If Not drawingPathName = Nothing
			oAsmDrawingDoc = ThisApplication.Documents.Open(drawingPathName, False)
			
			PDFName = IO.Path.GetFileNameWithoutExtension(thisdoc.document.fullfilename)

			'Set the PDF target file name
			oDataMedium.FileName = _Folder_Path & "\" & PDFName & ".pdf"
			'Write out the PDF
			PDFAddIn.SaveCopyAs(oAsmDrawingDoc, oContext, oOptions, oDataMedium)
			'Close the top level drawing
			oAsmDrawingDoc.Close
		Else
			Logger.info("Could not find top level drawing")
			Logger.info(drawingPathName)
		End If
	End Sub




	Private Function CreatePDF(_Folder_Path As String)

		Dim bOutputfileAlreadyExists As Boolean = False
		Dim sOutFilePath As String = IO.Path.Combine(_Folder_Path, _PDF_Name & ".pdf")

		'sdet up return for a successful pdf. ret changes to FALSE if any errors occur for qualifying purposes
		Dim ret As String = sOutFilePath

		If IO.File.Exists(sOutFilePath) Then
			Try
				IO.File.Delete(sOutFilePath)
			Catch ex As Exception
				bOutputfileAlreadyExists = True
			End Try
		End If

		Dim iPageCount As Integer = GetPageCount(_Folder_Path)
		If iPageCount > 0 And bOutputfileAlreadyExists = False Then

			Dim oFiles As String() = IO.Directory.GetFiles(_Folder_Path)
			Dim oPdfDoc As New iTextSharp.text.Document()
			Dim oPdfWriter As iTextSharp.text.pdf.PdfWriter = _
			iTextSharp.text.pdf.PdfWriter.GetInstance(oPdfDoc, New IO.FileStream(sOutFilePath, IO.FileMode.Create))

			oPdfDoc.Open()

			System.Array.Sort(Of String)(oFiles)

			For i As Integer = 0 To oFiles.Length - 1
				Dim sFromFilePath As String = oFiles(i)
				Dim oFileInfo As New IO.FileInfo(sFromFilePath)
				Dim sFileType As String = "PDF"
				Dim sExt As String = PadExt(oFileInfo.Extension)

				Try
					AddPdf(sFromFilePath, oPdfDoc, oPdfWriter)
				Catch ex As Exception
					ret = "FALSE"
				End Try
			Next

			Try
				oPdfDoc.Close()
				oPdfWriter.Close()
			Catch ex As Exception

				Try
					IO.File.Delete(sOutFilePath)
				Catch ex2 As Exception
				End Try
			End Try
		End If

		Dim oFolders As String() = IO.Directory.GetDirectories(_Folder_Path)
		For i As Integer = 0 To oFolders.Length - 1
			Dim sChildFolder As String = oFolders(i)
			Dim iPos As Integer = sChildFolder.LastIndexOf("\")
			Dim sFolderName As String = sChildFolder.Substring(iPos + 1)
			CreatePDF(sChildFolder)
		Next

		Return ret

	End Function

	Private Sub AddPdf(ByVal sInFilePath As String, ByRef oPdfDoc As iTextSharp.text.Document, ByRef oPdfWriter As iTextSharp.text.pdf.PdfWriter)

		Dim oDirectContent As iTextSharp.text.pdf.PdfContentByte = oPdfWriter.DirectContent
		Dim oPdfReader As iTextSharp.text.pdf.PdfReader = New iTextSharp.text.pdf.PdfReader(sInFilePath)
		Dim iNumberOfPages As Integer = oPdfReader.NumberOfPages
		Dim iPage As Integer = 0

		Do While (iPage < iNumberOfPages)
			iPage += 1
			oPdfDoc.SetPageSize(oPdfReader.GetPageSizeWithRotation(iPage))
			oPdfDoc.NewPage()

			Dim oPdfImportedPage As iTextSharp.text.pdf.PdfImportedPage = oPdfWriter.GetImportedPage(oPdfReader, iPage)
			Dim iRotation As Integer = oPdfReader.GetPageRotation(iPage)
			If (iRotation = 90) Or (iRotation = 270) Then
				oDirectContent.AddTemplate(oPdfImportedPage, 0, -1.0F, 1.0F, 0, 0, oPdfReader.GetPageSizeWithRotation(iPage).Height)
			Else
				oDirectContent.AddTemplate(oPdfImportedPage, 1.0F, 0, 0, 1.0F, 0, 0)
			End If
		Loop

	End Sub

	Private Function PadExt(ByVal s As String) As String
		s = UCase(s)
		If s.Length > 3 Then
			s = s.Substring(1, 3)
		End If
		Return s
	End Function

	Private Function GetPageCount(ByVal _Folder_Path As String) As Integer
		Dim iRet As Integer = 0
		Dim oFiles As String() = IO.Directory.GetFiles(_Folder_Path)

		For i As Integer = 0 To oFiles.Length - 1
			Dim sFromFilePath As String = oFiles(i)
			Dim oFileInfo As New IO.FileInfo(sFromFilePath)
			Dim sFileType As String = "PDF"
			Dim sExt As String = PadExt(oFileInfo.Extension)

			iRet += 1
		Next

		Return iRet
	End Function

End Class
```

---

### 23. Batch Updated Drawing Number

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/batch-updated-drawing-number/td-p/13772995](https://forums.autodesk.com/t5/inventor-programming-forum/batch-updated-drawing-number/td-p/13772995)

**Author:** Daniel.buzinari

**Date:** ‎08-18-2025
	
		
		05:08 PM

**Description:** Hi, two questions here Is there a way to use the Sheet Name as the drawing number, or the other way around? - So I don't need to rename both? Is there a way to update multiple drawing numbers in one go? - My title blocks use a Field Text driven by parameters, and the parameters are updated using a F...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim oDrawDoc As DrawingDocument
Dim oSheet As Sheet
Dim tb As Inventor.TextBox
Dim oBorder As Border
Dim borderDef As BorderDefinition
Dim oTB1'oTB1 references to Titleblocks
Dim sValue As String
Dim oDrwNo 
Dim oPromptEnt As String

oDrawDoc = ThisApplication.ActiveDocument
oSheet = oDrawDoc.ActiveSheet
oBorder = oSheet.Border
borderDef = oBorder.Definition
oTB1 = oSheet.TitleBlock

On Error Resume Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "DRAWING NO." Then
						sValue = oTB1.GetResultText(tb)
						oDrwNo = DRAWING_NO
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oDrwNo, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oDrwNo) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "<TITLE 3>" Then
						sValue = oTB1.GetResultText(tb)
						oTitle3 = TITLE_LINE_3
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oTitle3, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oTitle3) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "<REVISION NUMBER>" Then
						sValue = oTB1.GetResultText(tb)
						oShtRevNo = SHEET_REVISION_NO
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oShtRevNo, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oShtRevNo) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1" Then
						sValue = oTB1.GetResultText(tb)
						oRev1 = FIRST_REV_NO
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oRev1, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 DESCRIPTION" Then
						sValue = oTB1.GetResultText(tb)
						oRevDesc = FIRST_REV_DESCRIPTION
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oRevDesc, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRevDesc) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 BY" Then
						sValue = oTB1.GetResultText(tb)
						oRev1By = FIRST_REV_BY
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oRev1By, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1By) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 APPROVED BY" Then
						sValue = oTB1.GetResultText(tb)
						oRev1AppBy = FIRST_REV_APPROVED_BY
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oRev1AppBy, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1AppBy) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 DATE" Then
						sValue = oTB1.GetResultText(tb)
						oRev1Date = FIRST_REV_DATE
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oRev1Date, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1Date) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next
```

#### Code Block 2

```vb
Dim oDrawDoc As DrawingDocument
Dim oSheet As Sheet
Dim tb As Inventor.TextBox
Dim oBorder As Border
Dim borderDef As BorderDefinition
Dim oTB1'oTB1 references to Titleblocks
Dim sValue As String
Dim oDrwNo 
Dim oPromptEnt As String

oDrawDoc = ThisApplication.ActiveDocument
oSheet = oDrawDoc.ActiveSheet
oBorder = oSheet.Border
borderDef = oBorder.Definition
oTB1 = oSheet.TitleBlock

On Error Resume Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "DRAWING NO." Then
						sValue = oTB1.GetResultText(tb)
						oDrwNo = DRAWING_NO
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oDrwNo, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oDrwNo) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "<TITLE 3>" Then
						sValue = oTB1.GetResultText(tb)
						oTitle3 = TITLE_LINE_3
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oTitle3, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oTitle3) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "<REVISION NUMBER>" Then
						sValue = oTB1.GetResultText(tb)
						oShtRevNo = SHEET_REVISION_NO
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oShtRevNo, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oShtRevNo) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1" Then
						sValue = oTB1.GetResultText(tb)
						oRev1 = FIRST_REV_NO
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oRev1, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 DESCRIPTION" Then
						sValue = oTB1.GetResultText(tb)
						oRevDesc = FIRST_REV_DESCRIPTION
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oRevDesc, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRevDesc) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 BY" Then
						sValue = oTB1.GetResultText(tb)
						oRev1By = FIRST_REV_BY
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oRev1By, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1By) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 APPROVED BY" Then
						sValue = oTB1.GetResultText(tb)
						oRev1AppBy = FIRST_REV_APPROVED_BY
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oRev1AppBy, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1AppBy) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 DATE" Then
						sValue = oTB1.GetResultText(tb)
						oRev1Date = FIRST_REV_DATE
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oRev1Date, "Title")
			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1Date) 
						oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next
```

#### Code Block 3

```vb
Dim oDrawDoc As DrawingDocument
Dim oSheet As Sheet
Dim tb As Inventor.TextBox
Dim oBorder As Border
Dim borderDef As BorderDefinition
Dim oTB1'oTB1 references to Titleblocks
Dim sValue As String
Dim oDrwNo 
Dim oPromptEnt As String

oDrawDoc = ThisApplication.ActiveDocument
oSheet = oDrawDoc.ActiveSheet
oBorder = oSheet.Border
borderDef = oBorder.Definition
oTB1 = oSheet.TitleBlock

On Error Resume Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "DRAWING NO." Then
						sValue = oTB1.GetResultText(tb)
					DRAWING_NO = sValue
'					MessageBox.Show("DWG NO " & DRAWING_NO, "Title")

						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oDrwNo, "Title")
			'Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oDrwNo) 
						'oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "<TITLE 3>" Then
						sValue = oTB1.GetResultText(tb)
						TITLE_LINE_3 = sValue 
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oTitle3, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oTitle3) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "<REVISION NUMBER>" Then
						sValue = oTB1.GetResultText(tb)
						SHEET_REVISION_NO = sValue
'						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oShtRevNo, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oShtRevNo) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1" Then
						sValue = oTB1.GetResultText(tb)
						FIRST_REV_NO = sValue
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oRev1, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 DESCRIPTION" Then
						sValue = oTB1.GetResultText(tb)
						FIRST_REV_DESCRIPTION = sValue
'						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oRevDesc, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRevDesc) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 BY" Then
						sValue = oTB1.GetResultText(tb)
						FIRST_REV_BY = sValue
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oRev1By, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1By) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 APPROVED BY" Then
						sValue = oTB1.GetResultText(tb)
						FIRST_REV_APPROVED_BY = sValue
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oRev1AppBy, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1AppBy) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 DATE" Then
						sValue = oTB1.GetResultText(tb)
						FIRST_REV_DATE = sValue
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oRev1Date, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1Date) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next
```

#### Code Block 4

```vb
Dim oDrawDoc As DrawingDocument
Dim oSheet As Sheet
Dim tb As Inventor.TextBox
Dim oBorder As Border
Dim borderDef As BorderDefinition
Dim oTB1'oTB1 references to Titleblocks
Dim sValue As String
Dim oDrwNo 
Dim oPromptEnt As String

oDrawDoc = ThisApplication.ActiveDocument
oSheet = oDrawDoc.ActiveSheet
oBorder = oSheet.Border
borderDef = oBorder.Definition
oTB1 = oSheet.TitleBlock

On Error Resume Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "DRAWING NO." Then
						sValue = oTB1.GetResultText(tb)
					DRAWING_NO = sValue
'					MessageBox.Show("DWG NO " & DRAWING_NO, "Title")

						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
						'MessageBox.Show("Param drw no  " & oDrwNo, "Title")
			'Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oDrwNo) 
						'oPromptEnt = oTB1.GetResultText(tb)
						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
		

	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "<TITLE 3>" Then
						sValue = oTB1.GetResultText(tb)
						TITLE_LINE_3 = sValue 
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oTitle3, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oTitle3) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "<REVISION NUMBER>" Then
						sValue = oTB1.GetResultText(tb)
						SHEET_REVISION_NO = sValue
'						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oShtRevNo, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oShtRevNo) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1" Then
						sValue = oTB1.GetResultText(tb)
						FIRST_REV_NO = sValue
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oRev1, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 DESCRIPTION" Then
						sValue = oTB1.GetResultText(tb)
						FIRST_REV_DESCRIPTION = sValue
'						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oRevDesc, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRevDesc) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 BY" Then
						sValue = oTB1.GetResultText(tb)
						FIRST_REV_BY = sValue
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oRev1By, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1By) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 APPROVED BY" Then
						sValue = oTB1.GetResultText(tb)
						FIRST_REV_APPROVED_BY = sValue
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oRev1AppBy, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1AppBy) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next

For Each tb In oDrawDoc.ActiveSheet.TitleBlock.Definition.Sketch.TextBoxes 
If tb.Text = "REV 1 DATE" Then
						sValue = oTB1.GetResultText(tb)
						FIRST_REV_DATE = sValue
						'MessageBox.Show("Property Field: " & tb.Text & vbCrLf & "Value: " & sValue & vbCrLf & "Prompted Entry: " & tb.FormattedText, "Prompted entry")        
'						'MessageBox.Show("Param drw no  " & oRev1Date, "Title")
'			Call oDrawDoc.ActiveSheet.TitleBlock.SetPromptResultText(tb, oRev1Date) 
'						oPromptEnt = oTB1.GetResultText(tb)
'						'MessageBox.Show("Prompted value " & oPromptEnt, "Title")
'		
'
	End If
Next
```

---

### 24. Boolean switch of loft features

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/boolean-switch-of-loft-features/td-p/13787202#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/boolean-switch-of-loft-features/td-p/13787202#messageview_0)

**Author:** Willem1

**Date:** ‎08-28-2025
	
		
		07:57 AM

**Description:** Hi Guys！ I want to know how to switch the boolean operation of an existing loft feature using iLogic. The problem I'm encountering is that the 'Operation' property is read-only. Below is the ilogic code I have now： Dim oDoc As PartDocument = ThisDoc.Document Dim oLofts As LoftFeatures = oDoc.Compone...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim oDoc As PartDocument = ThisDoc.Document 
 Dim oLofts As LoftFeatures = oDoc.ComponentDefinition.Features.LoftFeatures
 For Each oLoft As LoftFeature In oLofts
 
 If oLoft.Operation = PartFeatureOperationEnum.kJoinOperation Then 
		
	Dim LoftDefinition As LoftDefinition = oLoft.Definition
	
	LoftDefinition.Operation = PartFeatureOperationEnum.kCutOperation
	
	 oLoft.EnableAssociation = True 
	 oLoft.Suppressed = False
	End If

Next
```

#### Code Block 2

```vb
Dim oDoc As PartDocument = ThisDoc.Document 
 Dim oLofts As LoftFeatures = oDoc.ComponentDefinition.Features.LoftFeatures
 For Each oLoft As LoftFeature In oLofts
 
 If oLoft.Operation = PartFeatureOperationEnum.kJoinOperation Then 
		
	Dim LoftDefinition As LoftDefinition = oLoft.Definition
	
	LoftDefinition.Operation = PartFeatureOperationEnum.kCutOperation
	
	 oLoft.EnableAssociation = True 
	 oLoft.Suppressed = False
	End If

Next
```

#### Code Block 3

```vb
Dim oDoc As PartDocument = ThisDoc.Document 
 Dim oLofts As LoftFeatures = oDoc.ComponentDefinition.Features.LoftFeatures
 For Each oLoft As LoftFeature In oLofts
 
 If oLoft.Operation = PartFeatureOperationEnum.kJoinOperation Then 
		
	Dim LoftDefinition As LoftDefinition = oLoft.Definition
	
	LoftDefinition.Operation = PartFeatureOperationEnum.kCutOperation
	
	 oLoft.EnableAssociation = True 
	 oLoft.Suppressed = False
	End If

Next
```

#### Code Block 4

```vb
Dim oDoc As PartDocument = ThisDoc.Document 
 Dim oLofts As LoftFeatures = oDoc.ComponentDefinition.Features.LoftFeatures
 For Each oLoft As LoftFeature In oLofts
 
 If oLoft.Operation = PartFeatureOperationEnum.kJoinOperation Then 
		
	Dim LoftDefinition As LoftDefinition = oLoft.Definition
	
	LoftDefinition.Operation = PartFeatureOperationEnum.kCutOperation
	
	 oLoft.EnableAssociation = True 
	 oLoft.Suppressed = False
	End If

Next
```

---

### 25. Browser/Tree doesn't update to reflect visibility tag when changed by rule

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/browser-tree-doesn-t-update-to-reflect-visibility-tag-when/td-p/13744987](https://forums.autodesk.com/t5/inventor-programming-forum/browser-tree-doesn-t-update-to-reflect-visibility-tag-when/td-p/13744987)

**Author:** Nicholas_SmithF4ZUA

**Date:** ‎07-29-2025
	
		
		10:19 AM

**Description:** A few weeks ago I set up an external rule that simply ensure all objects in an assembly are set to visible all the same as what the 'All Visible' button in Representations does but able to be thrown on toolbar for quicker access.While it makes everything visible just fine, the browser doesnt update ...

**Code Snippets (9):**

#### Code Block 1

```vb
Dim oDoc As Document
Dim Occ As ComponentOccurrence
Dim comp As ComponentOccurrencesEnumerator
Dim invApp As Inventor.Application
invApp = ThisApplication
oDoc = ThisDoc.Document 'local variable to shorthand to current document
comp =oDoc.ComponentDefinition.Occurrences.AllleafOccurrences '"AllLeafOccurrences" make rule read the lowest level components making hidden parts within subassemblies visible (unclear of top-level equivalent)
For Each Occ In comp 'Applies following to all components encompased
   Occ.Visible = True 'Sets visible boolean to True
Next
```

#### Code Block 2

```vb
Dim oDoc As Document
Dim Occ As ComponentOccurrence
Dim comp As ComponentOccurrencesEnumerator
Dim invApp As Inventor.Application
invApp = ThisApplication
oDoc = ThisDoc.Document 'local variable to shorthand to current document
comp =oDoc.ComponentDefinition.Occurrences.AllleafOccurrences '"AllLeafOccurrences" make rule read the lowest level components making hidden parts within subassemblies visible (unclear of top-level equivalent)
For Each Occ In comp 'Applies following to all components encompased
   Occ.Visible = True 'Sets visible boolean to True
Next
```

#### Code Block 3

```vb
Dim oDoc As Document
Dim Occ As ComponentOccurrence
Dim comp As ComponentOccurrencesEnumerator
Dim invApp As Inventor.Application
invApp = ThisApplication
oDoc = ThisDoc.Document 'local variable to shorthand to current document
comp =oDoc.ComponentDefinition.Occurrences.AllleafOccurrences '"AllLeafOccurrences" make rule read the lowest level components making hidden parts within subassemblies visible (unclear of top-level equivalent)
For Each Occ In comp 'Applies following to all components encompased
   Occ.Visible = True 'Sets visible boolean to True
Next
```

#### Code Block 4

```vb
Dim oDoc As Document
Dim Occ As ComponentOccurrence
Dim comp As ComponentOccurrencesEnumerator
Dim invApp As Inventor.Application
invApp = ThisApplication
oDoc = ThisDoc.Document 'local variable to shorthand to current document
comp =oDoc.ComponentDefinition.Occurrences.AllleafOccurrences '"AllLeafOccurrences" make rule read the lowest level components making hidden parts within subassemblies visible (unclear of top-level equivalent)
For Each Occ In comp 'Applies following to all components encompased
   Occ.Visible = True 'Sets visible boolean to True
Next
```

#### Code Block 5

```vb
If Not ThisApplication.ScreenUpdating Then ThisApplication.ScreenUpdating = True
```

#### Code Block 6

```vb
If Not ThisApplication.ScreenUpdating Then ThisApplication.ScreenUpdating = True
```

#### Code Block 7

```vb
If Not ThisApplication.ScreenUpdating Then ThisApplication.ScreenUpdating = True
```

#### Code Block 8

```vb
If Not ThisApplication.ScreenUpdating Then ThisApplication.ScreenUpdating = True
```

#### Code Block 9

```vb
ThisApplication.ActiveDocument.ComponentDefinition.RepresentationsManager.ActiveDesignViewRepresentation.ShowAll

'ThisApplication.ActiveDocument.ComponentDefinition.RepresentationsManager.ActiveDesignViewRepresentation.HideAll
```

#### Code Block 10

```vb
ThisApplication.ActiveDocument.ComponentDefinition.RepresentationsManager.ActiveDesignViewRepresentation.ShowAll

'ThisApplication.ActiveDocument.ComponentDefinition.RepresentationsManager.ActiveDesignViewRepresentation.HideAll
```

#### Code Block 11

```vb
ThisApplication.ActiveView.Update()
```

#### Code Block 12

```vb
ThisApplication.ActiveView.Update()
```

#### Code Block 13

```vb
ThisApplication.ActiveView.Update()
```

#### Code Block 14

```vb
ThisApplication.ActiveView.Update()
```

#### Code Block 15

```vb
oActiveDoc.BrowserPanes.ActivePane.Update()
```

#### Code Block 16

```vb
oActiveDoc.BrowserPanes.ActivePane.Update()
```

#### Code Block 17

```vb
oActiveDoc.BrowserPanes.ActivePane.Update()
```

#### Code Block 18

```vb
oActiveDoc.BrowserPanes.ActivePane.Update()
```

---

### 26. CUSTOM VIEW ORIENTATION ALTERNATIVE

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/custom-view-orientation-alternative/td-p/13393159#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/custom-view-orientation-alternative/td-p/13393159#messageview_0)

**Author:** NOEL_GETTINGBYCZTUC

**Date:** ‎03-26-2025
	
		
		08:26 PM

**Description:** Hi all, hopefully I'm not asking something that has been answered dozens of time before  It quite obvious that using Custom View Orientation for parametrically modelled parts is a massive productivity killer. I.E. whenever the geometry changes and the face (or work plane) used for the custom view "L...

**Code Snippets (20):**

#### Code Block 1

```vb
.UpVector = oPosVectorX
```

#### Code Block 2

```vb
.UpVector = oPosVectorX
```

#### Code Block 3

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oDDoc As DrawingDocument = oInvApp.ActiveDocument
	If oDDoc Is Nothing Then Exit Sub
	Dim oView As DrawingView
	oView = oInvApp.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select View...")
	If oView Is Nothing Then Exit Sub
	If Not oView.ViewStyle = kShadedDrawingViewStyle Then
		Call oDDoc.SelectSet.Select(oView)
		call oInvApp.CommandManager.ControlDefinitions("DrawingUpdateViewComponentCmd").Execute
	End If
	Dim oDoc As Document = oView.ReferencedDocumentDescriptor.ReferencedDocument
	Dim oPlane As WorkPlane = TryCast(oDoc.ComponentDefinition.WorkPlanes("FRONT_VIEW_PLANE"), WorkPlane)
	If oPlane Is Nothing Then Exit Sub
    Dim oNormalEye As Inventor.Vector = oPlane.Plane.Normal.AsVector
    Dim oPosPoint As Point = Nothing
    Dim oPosVectorX As UnitVector = Nothing
    Dim oPosVectorY As UnitVector = Nothing
	oPlane.GetPosition(oPosPoint, oPosVectorX, oPosVectorY)	
	With oView.Camera
		.Target = oPosPoint
		oPosPoint.TranslateBy(oNormalEye)
	    .Eye = oPosPoint
	    .UpVector = oPosVectorY
		.ApplyWithoutTransition()
	End With	
End Sub
```

#### Code Block 4

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oDDoc As DrawingDocument = oInvApp.ActiveDocument
	If oDDoc Is Nothing Then Exit Sub
	Dim oView As DrawingView
	oView = oInvApp.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select View...")
	If oView Is Nothing Then Exit Sub
	If Not oView.ViewStyle = kShadedDrawingViewStyle Then
		Call oDDoc.SelectSet.Select(oView)
		call oInvApp.CommandManager.ControlDefinitions("DrawingUpdateViewComponentCmd").Execute
	End If
	Dim oDoc As Document = oView.ReferencedDocumentDescriptor.ReferencedDocument
	Dim oPlane As WorkPlane = TryCast(oDoc.ComponentDefinition.WorkPlanes("FRONT_VIEW_PLANE"), WorkPlane)
	If oPlane Is Nothing Then Exit Sub
    Dim oNormalEye As Inventor.Vector = oPlane.Plane.Normal.AsVector
    Dim oPosPoint As Point = Nothing
    Dim oPosVectorX As UnitVector = Nothing
    Dim oPosVectorY As UnitVector = Nothing
	oPlane.GetPosition(oPosPoint, oPosVectorX, oPosVectorY)	
	With oView.Camera
		.Target = oPosPoint
		oPosPoint.TranslateBy(oNormalEye)
	    .Eye = oPosPoint
	    .UpVector = oPosVectorY
		.ApplyWithoutTransition()
	End With	
End Sub
```

#### Code Block 5

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
	If oPDoc Is Nothing Then Exit Sub
	Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
	Dim oPlane As WorkPlane = TryCast(oPDef.WorkPlanes(sNamePlane), WorkPlane)
	If oPlane Is Nothing Then Exit Sub
	If oPDoc.Dirty Then oPDoc.Update()
	Dim oTG As Transaction = oInvApp.TransactionManager.StartTransaction(oPDoc, "Set Camera...")
	Dim oNewView As DesignViewRepresentation
	Dim oActView As DesignViewRepresentation
	With oPDef.RepresentationsManager
		oActView = .ActiveDesignViewRepresentation
		If oActView.Name = sNameView Then
			oNewView = oActView
		Else
			Try : oNewView = .DesignViewRepresentations(sNameView)
			Catch : oNewView = .DesignViewRepresentations.Add(sNameView)
			End Try
		End If
	End With
	oNewView.Activate()
	Call SetCamera(oNewView.Camera, oPlane)
	Try : oActView.Activate() : Catch : End Try
	oTG.End()
End Sub

Property sNamePlane As String = "FRONT_VIEW_PLANE"
Property sNameView As String = "DWG_FRONT"

Private Function SetCamera(ByVal oCamera As Camera, ByVal oPlane As WorkPlane)
	Dim oNormalEye As Inventor.Vector = oPlane.Plane.Normal.AsVector()
    Dim oPosPoint As Point = Nothing
    Dim oPosVectorX As UnitVector = Nothing
    Dim oPosVectorY As UnitVector = Nothing
	oPlane.GetPosition(oPosPoint, oPosVectorX, oPosVectorY)
	oCamera.Target = oPosPoint
	oPosPoint.TranslateBy(oNormalEye)
    oCamera.Eye = oPosPoint
'	With oPosVectorY
'		Dim dCoors() As Double = {-.X, -.Y, -.Z }
'		.PutUnitVectorData(dCoors)	
'	End With
	oCamera.UpVector = oPosVectorY
	oCamera.ApplyWithoutTransition()
End Function
```

#### Code Block 6

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
	If oPDoc Is Nothing Then Exit Sub
	Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
	Dim oPlane As WorkPlane = TryCast(oPDef.WorkPlanes(sNamePlane), WorkPlane)
	If oPlane Is Nothing Then Exit Sub
	If oPDoc.Dirty Then oPDoc.Update()
	Dim oTG As Transaction = oInvApp.TransactionManager.StartTransaction(oPDoc, "Set Camera...")
	Dim oNewView As DesignViewRepresentation
	Dim oActView As DesignViewRepresentation
	With oPDef.RepresentationsManager
		oActView = .ActiveDesignViewRepresentation
		If oActView.Name = sNameView Then
			oNewView = oActView
		Else
			Try : oNewView = .DesignViewRepresentations(sNameView)
			Catch : oNewView = .DesignViewRepresentations.Add(sNameView)
			End Try
		End If
	End With
	oNewView.Activate()
	Call SetCamera(oNewView.Camera, oPlane)
	Try : oActView.Activate() : Catch : End Try
	oTG.End()
End Sub

Property sNamePlane As String = "FRONT_VIEW_PLANE"
Property sNameView As String = "DWG_FRONT"

Private Function SetCamera(ByVal oCamera As Camera, ByVal oPlane As WorkPlane)
	Dim oNormalEye As Inventor.Vector = oPlane.Plane.Normal.AsVector()
    Dim oPosPoint As Point = Nothing
    Dim oPosVectorX As UnitVector = Nothing
    Dim oPosVectorY As UnitVector = Nothing
	oPlane.GetPosition(oPosPoint, oPosVectorX, oPosVectorY)
	oCamera.Target = oPosPoint
	oPosPoint.TranslateBy(oNormalEye)
    oCamera.Eye = oPosPoint
'	With oPosVectorY
'		Dim dCoors() As Double = {-.X, -.Y, -.Z }
'		.PutUnitVectorData(dCoors)	
'	End With
	oCamera.UpVector = oPosVectorY
	oCamera.ApplyWithoutTransition()
End Function
```

#### Code Block 7

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
	If oPDoc Is Nothing Then Exit Sub
	Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
	Dim oPlane As WorkPlane = TryCast(oPDef.WorkPlanes(sNamePlane), WorkPlane)
	If oPlane Is Nothing Then Exit Sub
	If oPDoc.Dirty Then oPDoc.Update()
	Dim oTG As Transaction = oInvApp.TransactionManager.StartTransaction(oPDoc, "Set Camera...")
	Dim oNewView As DesignViewRepresentation
	Dim oActView As DesignViewRepresentation
	With oPDef.RepresentationsManager
		oActView = .ActiveDesignViewRepresentation
		If oActView.Name = sNameView Then
			oNewView = oActView
		Else
			Try : oNewView = .DesignViewRepresentations(sNameView)
			Catch : oNewView = .DesignViewRepresentations.Add(sNameView)
			End Try
		End If
	End With
	oNewView.Activate()
	Call SetCamera(oNewView.Camera, oPlane)
	Try : oActView.Activate() : Catch : End Try
	oTG.End()
End Sub

Property sNamePlane As String = "FRONT_VIEW_PLANE"
Property sNameView As String = "DWG_FRONT"

Private Function SetCamera(ByVal oCamera As Camera, ByVal oPlane As WorkPlane)
	Dim oNormalEye As Inventor.Vector = oPlane.Plane.Normal.AsVector()
    Dim oPosPoint As Point = Nothing
    Dim oPosVectorX As UnitVector = Nothing
    Dim oPosVectorY As UnitVector = Nothing
	oPlane.GetPosition(oPosPoint, oPosVectorX, oPosVectorY)
	oCamera.Target = oPosPoint
	oPosPoint.TranslateBy(oNormalEye)
    oCamera.Eye = oPosPoint
'-----------------------------------
''	Comment out 3 of the following 4 to achieve the desired camera view orientation
'-----------------------------------
''Y Positive
'		oCamera.UpVector = oPosVectorY
'-----------------------------------
''Y Negative
'		With oPosVectorY
'			Dim dCoors() As Double = {-.X, -.Y, -.Z }
'			.PutUnitVectorData(dCoors)	
'		End With
'		oCamera.UpVector = oPosVectorY
'-----------------------------------
''X Positive
'		oCamera.UpVector = oPosVectorX
'-----------------------------------
'X Negative
		With oPosVectorX
			Dim dCoors() As Double = {-.X, -.Y, -.Z }
			.PutUnitVectorData(dCoors)	
		End With
		oCamera.UpVector = oPosVectorX
'-----------------------------------
	oCamera.ApplyWithoutTransition()
End Function
```

#### Code Block 8

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
	If oPDoc Is Nothing Then Exit Sub
	Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
	Dim oPlane As WorkPlane = TryCast(oPDef.WorkPlanes(sNamePlane), WorkPlane)
	If oPlane Is Nothing Then Exit Sub
	If oPDoc.Dirty Then oPDoc.Update()
	Dim oTG As Transaction = oInvApp.TransactionManager.StartTransaction(oPDoc, "Set Camera...")
	Dim oNewView As DesignViewRepresentation
	Dim oActView As DesignViewRepresentation
	With oPDef.RepresentationsManager
		oActView = .ActiveDesignViewRepresentation
		If oActView.Name = sNameView Then
			oNewView = oActView
		Else
			Try : oNewView = .DesignViewRepresentations(sNameView)
			Catch : oNewView = .DesignViewRepresentations.Add(sNameView)
			End Try
		End If
	End With
	oNewView.Activate()
	Call SetCamera(oNewView.Camera, oPlane)
	Try : oActView.Activate() : Catch : End Try
	oTG.End()
End Sub

Property sNamePlane As String = "FRONT_VIEW_PLANE"
Property sNameView As String = "DWG_FRONT"

Private Function SetCamera(ByVal oCamera As Camera, ByVal oPlane As WorkPlane)
	Dim oNormalEye As Inventor.Vector = oPlane.Plane.Normal.AsVector()
    Dim oPosPoint As Point = Nothing
    Dim oPosVectorX As UnitVector = Nothing
    Dim oPosVectorY As UnitVector = Nothing
	oPlane.GetPosition(oPosPoint, oPosVectorX, oPosVectorY)
	oCamera.Target = oPosPoint
	oPosPoint.TranslateBy(oNormalEye)
    oCamera.Eye = oPosPoint
'-----------------------------------
''	Comment out 3 of the following 4 to achieve the desired camera view orientation
'-----------------------------------
''Y Positive
'		oCamera.UpVector = oPosVectorY
'-----------------------------------
'Y Negative
		With oPosVectorY
			Dim dCoors() As Double = {-.X, -.Y, -.Z }
			.PutUnitVectorData(dCoors)	
		End With
		oCamera.UpVector = oPosVectorY
'-----------------------------------
''X Positive
'		oCamera.UpVector = oPosVectorX
'-----------------------------------
''X Negative
'		With oPosVectorX
'			Dim dCoors() As Double = {-.X, -.Y, -.Z }
'			.PutUnitVectorData(dCoors)	
'		End With
'		oCamera.UpVector = oPosVectorX
'-----------------------------------
	oCamera.ApplyWithoutTransition()
End Function
```

#### Code Block 9

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
	If oPDoc Is Nothing Then Exit Sub
	Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
	Dim oPlane As WorkPlane = TryCast(oPDef.WorkPlanes(sNamePlane), WorkPlane)
	If oPlane Is Nothing Then Exit Sub
	If oPDoc.Dirty Then oPDoc.Update()
	Dim oTG As Transaction = oInvApp.TransactionManager.StartTransaction(oPDoc, "Set Camera...")
	Dim oNewView As DesignViewRepresentation
	Dim oActView As DesignViewRepresentation
	With oPDef.RepresentationsManager
		oActView = .ActiveDesignViewRepresentation
		Try : oNewView = .DesignViewRepresentations(sNameView)
		Catch : oNewView = .DesignViewRepresentations.Add(sNameView)
		End Try
	End With
	oNewView.Activate()
	Dim oNormalEye As Inventor.Vector = oPlane.Plane.Normal.AsVector()
    Dim oPosPoint As Point = Nothing
    Dim oPosVectorX As UnitVector = Nothing
    Dim oPosVectorY As UnitVector = Nothing
	oPlane.GetPosition(oPosPoint, oPosVectorX, oPosVectorY)
	With oNewView.Camera
		.Target = oPosPoint
		oPosPoint.TranslateBy(oNormalEye)
	    .Eye = oPosPoint
	    .UpVector = oPosVectorX
		.ApplyWithoutTransition()
	End With
	Try : oActView.Activate() : Catch : End Try
	oTG.End()
End Sub

Property sNamePlane As String = "FRONT_VIEW_PLANE"
Property sNameView As String = "DWG_FRONT"
```

#### Code Block 10

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
	If oPDoc Is Nothing Then Exit Sub
	Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
	Dim oPlane As WorkPlane = TryCast(oPDef.WorkPlanes(sNamePlane), WorkPlane)
	If oPlane Is Nothing Then Exit Sub
	If oPDoc.Dirty Then oPDoc.Update()
	Dim oTG As Transaction = oInvApp.TransactionManager.StartTransaction(oPDoc, "Set Camera...")
	Dim oNewView As DesignViewRepresentation
	Dim oActView As DesignViewRepresentation
	With oPDef.RepresentationsManager
		oActView = .ActiveDesignViewRepresentation
		Try : oNewView = .DesignViewRepresentations(sNameView)
		Catch : oNewView = .DesignViewRepresentations.Add(sNameView)
		End Try
	End With
	oNewView.Activate()
	Dim oNormalEye As Inventor.Vector = oPlane.Plane.Normal.AsVector()
    Dim oPosPoint As Point = Nothing
    Dim oPosVectorX As UnitVector = Nothing
    Dim oPosVectorY As UnitVector = Nothing
	oPlane.GetPosition(oPosPoint, oPosVectorX, oPosVectorY)
	With oNewView.Camera
		.Target = oPosPoint
		oPosPoint.TranslateBy(oNormalEye)
	    .Eye = oPosPoint
	    .UpVector = oPosVectorX
		.ApplyWithoutTransition()
	End With
	Try : oActView.Activate() : Catch : End Try
	oTG.End()
End Sub

Property sNamePlane As String = "FRONT_VIEW_PLANE"
Property sNameView As String = "DWG_FRONT"
```

#### Code Block 11

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
	If oPDoc Is Nothing Then Exit Sub
	Dim oPlane As WorkPlane = TryCast(oPDoc.ComponentDefinition.WorkPlanes("FRONT_VIEW_PLANE"), WorkPlane)
	If oPlane Is Nothing Then Exit Sub
	Dim oTG As Transaction = oInvApp.TransactionManager.StartTransaction(oPDoc, "Set Camera...")
	Dim oNormalEye As Inventor.Vector = oPlane.Plane.Normal.AsVector()
    Dim oPosPoint As Point = Nothing
    Dim oPosVectorX As UnitVector = Nothing
    Dim oPosVectorY As UnitVector = Nothing
	oPlane.GetPosition(oPosPoint, oPosVectorX, oPosVectorY)
	With oInvApp.ActiveView.Camera
		.Target = oPosPoint
		oPosPoint.TranslateBy(oNormalEye)
	    .Eye = oPosPoint
	    .UpVector = oPosVectorY
		.ApplyWithoutTransition()
		.Parent.SetCurrentAsFront()
	End With
	oTG.End()
End Sub
```

#### Code Block 12

```vb
Public Sub Main()
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
	If oPDoc Is Nothing Then Exit Sub
	Dim oPlane As WorkPlane = TryCast(oPDoc.ComponentDefinition.WorkPlanes("FRONT_VIEW_PLANE"), WorkPlane)
	If oPlane Is Nothing Then Exit Sub
	Dim oTG As Transaction = oInvApp.TransactionManager.StartTransaction(oPDoc, "Set Camera...")
	Dim oNormalEye As Inventor.Vector = oPlane.Plane.Normal.AsVector()
    Dim oPosPoint As Point = Nothing
    Dim oPosVectorX As UnitVector = Nothing
    Dim oPosVectorY As UnitVector = Nothing
	oPlane.GetPosition(oPosPoint, oPosVectorX, oPosVectorY)
	With oInvApp.ActiveView.Camera
		.Target = oPosPoint
		oPosPoint.TranslateBy(oNormalEye)
	    .Eye = oPosPoint
	    .UpVector = oPosVectorY
		.ApplyWithoutTransition()
		.Parent.SetCurrentAsFront()
	End With
	oTG.End()
End Sub
```

#### Code Block 13

```vb
With oPosVectorX
	Dim dCoors() As Double = {-.X, -.Y, -.Z }
	.PutUnitVectorData(dCoors)	
End With
oCamera.UpVector = oPosVectorX
```

#### Code Block 14

```vb
With oPosVectorX
	Dim dCoors() As Double = {-.X, -.Y, -.Z }
	.PutUnitVectorData(dCoors)	
End With
oCamera.UpVector = oPosVectorX
```

#### Code Block 15

```vb
With oPosVectorY
	Dim dCoors() As Double = {-.X, -.Y, -.Z }
	.PutUnitVectorData(dCoors)	
End With
oCamera.UpVector = oPosVectorY
```

#### Code Block 16

```vb
With oPosVectorY
	Dim dCoors() As Double = {-.X, -.Y, -.Z }
	.PutUnitVectorData(dCoors)	
End With
oCamera.UpVector = oPosVectorY
```

#### Code Block 17

```vb
oCamera.UpVector = oPosVectorX
```

#### Code Block 18

```vb
oCamera.UpVector = oPosVectorX
```

#### Code Block 19

```vb
oCamera.UpVector = oPosVectorY
```

#### Code Block 20

```vb
oCamera.UpVector = oPosVectorY
```

---

### 27. Can I rotate radius general dimension in drawing

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/can-i-rotate-radius-general-dimension-in-drawing/td-p/13757148](https://forums.autodesk.com/t5/inventor-programming-forum/can-i-rotate-radius-general-dimension-in-drawing/td-p/13757148)

**Author:** tim11_manhhieu

**Date:** ‎08-06-2025
	
		
		06:33 PM

**Description:** Hi experts, I want to rotate  radius general dimension like a below image by picking.

**Code Snippets (4):**

#### Code Block 1

```vb
GeneralDimensions.AddRadius( TextOrigin As Point2d, Intent As GeometryIntent, [ArrowheadsInside] As Boolean, [LeaderFromCenter] As Boolean, [Jogged] As Boolean, [DimensionStyle] As Variant, [Layer] As Variant ) As RadiusGeneralDimension
```

#### Code Block 2

```vb
GeneralDimensions.AddRadius( TextOrigin As Point2d, Intent As GeometryIntent, [ArrowheadsInside] As Boolean, [LeaderFromCenter] As Boolean, [Jogged] As Boolean, [DimensionStyle] As Variant, [Layer] As Variant ) As RadiusGeneralDimension
```

#### Code Block 3

```vb
GeneralDimensions.AddRadius( TextOrigin As Point2d, Intent As GeometryIntent, [ArrowheadsInside] As Boolean, [LeaderFromCenter] As Boolean, [Jogged] As Boolean, [DimensionStyle] As Variant, [Layer] As Variant ) As RadiusGeneralDimension
```

#### Code Block 4

```vb
GeneralDimensions.AddRadius( TextOrigin As Point2d, Intent As GeometryIntent, [ArrowheadsInside] As Boolean, [LeaderFromCenter] As Boolean, [Jogged] As Boolean, [DimensionStyle] As Variant, [Layer] As Variant ) As RadiusGeneralDimension
```

#### Code Block 5

```vb
Sub zzz()

Dim doc As DrawingDocument
Set doc = ThisApplication.ActiveDocument

Dim oSheet As sheet
Set oSheet = doc.activeSheet

Dim oDim As RadiusGeneralDimension
Set oDim = ThisApplication.CommandManager.Pick(kDrawingDimensionFilter, "Pick dimension")

Dim newDim As RadiusGeneralDimension

Dim oTG As TransientGeometry
Set oTG = ThisApplication.TransientGeometry

Dim newGeometryIntent As GeometryIntent
Set newGeometryIntent = oDim.Intent '<--- stuck here

End sub
```

#### Code Block 6

```vb
Sub zzz()

Dim doc As DrawingDocument
Set doc = ThisApplication.ActiveDocument

Dim oSheet As sheet
Set oSheet = doc.activeSheet

Dim oDim As RadiusGeneralDimension
Set oDim = ThisApplication.CommandManager.Pick(kDrawingDimensionFilter, "Pick dimension")

Dim newDim As RadiusGeneralDimension

Dim oTG As TransientGeometry
Set oTG = ThisApplication.TransientGeometry

Dim newGeometryIntent As GeometryIntent
Set newGeometryIntent = oDim.Intent '<--- stuck here

End sub
```

#### Code Block 7

```vb
Sub zzz()

Dim doc As DrawingDocument
Set doc = ThisApplication.ActiveDocument

Dim oSheet As sheet
Set oSheet = doc.activeSheet

Dim oDim As RadiusGeneralDimension
Set oDim = ThisApplication.CommandManager.Pick(kDrawingDimensionFilter, "Pick dimension")

Dim newDim As RadiusGeneralDimension

Dim oTG As TransientGeometry
Set oTG = ThisApplication.TransientGeometry

Dim newGeometryIntent As GeometryIntent
Set newGeometryIntent = oDim.Intent '<--- stuck here

End sub
```

#### Code Block 8

```vb
Sub zzz()

Dim doc As DrawingDocument
Set doc = ThisApplication.ActiveDocument

Dim oSheet As sheet
Set oSheet = doc.activeSheet

Dim oDim As RadiusGeneralDimension
Set oDim = ThisApplication.CommandManager.Pick(kDrawingDimensionFilter, "Pick dimension")

Dim newDim As RadiusGeneralDimension

Dim oTG As TransientGeometry
Set oTG = ThisApplication.TransientGeometry

Dim newGeometryIntent As GeometryIntent
Set newGeometryIntent = oDim.Intent '<--- stuck here

End sub
```

---

### 28. Can we access textbox objects on the sheet object?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/can-we-access-textbox-objects-on-the-sheet-object/td-p/13795397](https://forums.autodesk.com/t5/inventor-programming-forum/can-we-access-textbox-objects-on-the-sheet-object/td-p/13795397)

**Author:** J_Pfeifer_

**Date:** ‎09-03-2025
	
		
		12:40 PM

**Description:** Having trouble, I want to replicate the ability to create a textbox on the drawing sheet itself. Not a sketch object on the sheet. I'm not seeing anything like Sheet.Textboxes? What am I missing? 					 				 			 			 				 			 			 				 	 			 				 					 						Solved! 					 					Go to Solution.

**Code Snippets (2):**

#### Code Block 1

```vb
Sub main

	Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
	Dim OTG As TransientGeometry = ThisApplication.TransientGeometry
	
	Dim oSheet As Sheet = oDoc.Sheets(4)
	
	Dim InputText As String = "Testing textboxes"
	Dim TextPoint As Point2d = OTG.CreatePoint2d(5, 5)
		
	Dim iNote As DrawingNote = oSheet.DrawingNotes.GeneralNotes.AddFitted(TextPoint, InputText)
	
	 



	
End Sub
```

#### Code Block 2

```vb
Sub main

	Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
	Dim OTG As TransientGeometry = ThisApplication.TransientGeometry
	
	Dim oSheet As Sheet = oDoc.Sheets(4)
	
	Dim InputText As String = "Testing textboxes"
	Dim TextPoint As Point2d = OTG.CreatePoint2d(5, 5)
		
	Dim iNote As DrawingNote = oSheet.DrawingNotes.GeneralNotes.AddFitted(TextPoint, InputText)
	
	 



	
End Sub
```

#### Code Block 3

```vb
Sub main

	Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
	Dim OTG As TransientGeometry = ThisApplication.TransientGeometry
	
	Dim oSheet As Sheet = oDoc.Sheets(4)
	
	Dim InputText As String = "Testing textboxes"
	Dim TextPoint As Point2d = OTG.CreatePoint2d(5, 5)
		
	Dim iNote As DrawingNote = oSheet.DrawingNotes.GeneralNotes.AddFitted(TextPoint, InputText)
	
	 



	
End Sub
```

#### Code Block 4

```vb
Sub main

	Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
	Dim OTG As TransientGeometry = ThisApplication.TransientGeometry
	
	Dim oSheet As Sheet = oDoc.Sheets(4)
	
	Dim InputText As String = "Testing textboxes"
	Dim TextPoint As Point2d = OTG.CreatePoint2d(5, 5)
		
	Dim iNote As DrawingNote = oSheet.DrawingNotes.GeneralNotes.AddFitted(TextPoint, InputText)
	
	 



	
End Sub
```

---

### 29. Can't make Plane.IntersectWithPlane work

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/can-t-make-plane-intersectwithplane-work/td-p/13838421](https://forums.autodesk.com/t5/inventor-programming-forum/can-t-make-plane-intersectwithplane-work/td-p/13838421)

**Author:** DonStauffer99

**Date:** ‎10-05-2025
	
		
		10:24 PM

**Description:** I can't figure this out, mainly because of the nonspecific error message "the parameter is incorrect". That happens on the last line in this code, but I did find out that the line returned by IntersectWithPlane apparently has a direction of (0, 0, 0). That shouldn't necessarily cause an error when u...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim P As Plane
	P = TG.CreatePlaneByThreePoints(P1, P2, P3)
	
	If P1.X = P2.X And P2.X = P3.X Then
		P.Normal = TG.CreateUnitVector(1, 0, 0)
	ElseIf P1.Y = P2.Y And P2.Y = P3.Y Then
		P.Normal = TG.CreateUnitVector(0, 1, 0)
	ElseIf P1.Z = P2.Z And P2.Z = P3.Z Then
		P.Normal = TG.CreateUnitVector(0, 0, 1)
	End If
```

#### Code Block 2

```vb
Dim P As Plane
	P = TG.CreatePlaneByThreePoints(P1, P2, P3)
	
	If P1.X = P2.X And P2.X = P3.X Then
		P.Normal = TG.CreateUnitVector(1, 0, 0)
	ElseIf P1.Y = P2.Y And P2.Y = P3.Y Then
		P.Normal = TG.CreateUnitVector(0, 1, 0)
	ElseIf P1.Z = P2.Z And P2.Z = P3.Z Then
		P.Normal = TG.CreateUnitVector(0, 0, 1)
	End If
```

#### Code Block 3

```vb
Dim TG As Inv.TransientGeometry = ThisApplication.TransientGeometry
	
	Dim TargPoint As Point
	TargPoint = TG.CreatePoint(1, 1, 1)
	
	Dim StartPoint As Point
	StartPoint = TG.CreatePoint(2, 2, 1)
	
	Dim EndPoint As Point
	EndPoint = TG.CreatePoint(-1, -1, 1)

        '   Create the X-Axis vector

        Dim XYScanPlane As Inv.Plane
        XYScanPlane = TG.CreatePlaneByThreePoints(TargPoint, StartPoint, EndPoint)

        Dim X As Double
        Dim Y As Double
        Dim Z As Double
        X = StartPoint.X - TargPoint.X
        Y = StartPoint.Y - TargPoint.Y
        Z = StartPoint.Z - TargPoint.Z
        Dim XAxisVect As Inv.Vector = TG.CreateVector(X, Y, Z)
		
        Dim YZScanPlane As Inv.Plane
        YZScanPlane = TG.CreatePlane(TargPoint, XAxisVect)

        Dim YAxisLine As Inv.Line
        YAxisLine = XYScanPlane.IntersectWithPlane(YZScanPlane) ' This is likely the problem
		
		Dim RootPoint As Point = YAxisLine.RootPoint
		
		Logger.Debug("Root Point: " & RootPoint.X & ", " & RootPoint.Y & ", " & RootPoint.Z & ")")
		
		Dim YAxisUnit As Inv.UnitVector = TG.CreateUnitVector
		YAxisUnit= YAxisLine.Direction()
		Logger.Debug("Unit: " & YAxisUnit.X & ", " & YAxisUnit.Y & ", " & YAxisUnit.Z)
		
        Dim YAxisVect As Inv.Vector = TG.CreateVector(0, 0, 0)
		YAxisVect = YAxisUnit.AsVector()
		
		Logger.Debug("Vect: " & YAxisVect.X & ", " & YAxisVect.Y & ", " & YAxisVect.Z)

        Dim XZScanPlane As Inv.Plane
        XZScanPlane = TG.CreatePlane(TargPoint, YAxisVect)
```

#### Code Block 4

```vb
Dim TG As Inv.TransientGeometry = ThisApplication.TransientGeometry
	
	Dim TargPoint As Point
	TargPoint = TG.CreatePoint(1, 1, 1)
	
	Dim StartPoint As Point
	StartPoint = TG.CreatePoint(2, 2, 1)
	
	Dim EndPoint As Point
	EndPoint = TG.CreatePoint(-1, -1, 1)

        '   Create the X-Axis vector

        Dim XYScanPlane As Inv.Plane
        XYScanPlane = TG.CreatePlaneByThreePoints(TargPoint, StartPoint, EndPoint)

        Dim X As Double
        Dim Y As Double
        Dim Z As Double
        X = StartPoint.X - TargPoint.X
        Y = StartPoint.Y - TargPoint.Y
        Z = StartPoint.Z - TargPoint.Z
        Dim XAxisVect As Inv.Vector = TG.CreateVector(X, Y, Z)
		
        Dim YZScanPlane As Inv.Plane
        YZScanPlane = TG.CreatePlane(TargPoint, XAxisVect)

        Dim YAxisLine As Inv.Line
        YAxisLine = XYScanPlane.IntersectWithPlane(YZScanPlane) ' This is likely the problem
		
		Dim RootPoint As Point = YAxisLine.RootPoint
		
		Logger.Debug("Root Point: " & RootPoint.X & ", " & RootPoint.Y & ", " & RootPoint.Z & ")")
		
		Dim YAxisUnit As Inv.UnitVector = TG.CreateUnitVector
		YAxisUnit= YAxisLine.Direction()
		Logger.Debug("Unit: " & YAxisUnit.X & ", " & YAxisUnit.Y & ", " & YAxisUnit.Z)
		
        Dim YAxisVect As Inv.Vector = TG.CreateVector(0, 0, 0)
		YAxisVect = YAxisUnit.AsVector()
		
		Logger.Debug("Vect: " & YAxisVect.X & ", " & YAxisVect.Y & ", " & YAxisVect.Z)

        Dim XZScanPlane As Inv.Plane
        XZScanPlane = TG.CreatePlane(TargPoint, YAxisVect)
```

---

### 30. Change ModelState in assembly/subassembly

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/change-modelstate-in-assembly-subassembly/td-p/13775448#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/change-modelstate-in-assembly-subassembly/td-p/13775448#messageview_0)

**Author:** mateusz_baczewski

**Date:** ‎08-20-2025
	
		
		04:57 AM

**Description:** Hi, I’m developing an add-in for Vault that uses InventorServer to edit the model by adding a new model state with simplifications for welded components and assigning an ERP ID to surface bodies for parts (including simplified parts) or in the name for assemblies. My goal is simply to switch the mod...

**Code Snippets (8):**

#### Code Block 1

```vb
else if (oOcc.DefinitionDocumentType == DocumentTypeEnum.kAssemblyDocumentObject && !string.IsNullOrEmpty(oOcc.Name) && !oOcc.Name.Contains("Weldbead"))
  {
      AssemblyDocument assemblyDocumentOcc = oOcc.ReferencedFileDescriptor.ReferencedDocument as AssemblyDocument;

      string assemblyName = System.IO.Path.GetFileName(assemblyDocumentOcc.FullDocumentName);
      string folder = System.IO.Path.GetDirectoryName(assemblyDocumentOcc.FullDocumentName);
      var modelName = System.IO.Path.GetFileNameWithoutExtension(assemblyDocumentOcc.FullFileName);
      var simplyfyModelPath = System.IO.Path.Combine("C:\\Vault\\Projekty\\URZĄDZENIA STAL POWIETRZE\\OGRZEWACZE POM. STAL KOZY\\BJORN", "Uproszczenia", modelName + ".ipt");

      if (assemblyDocumentOcc.SubType == DocumentSubTypeIds.Weldment)
      {

          if (System.IO.File.Exists(simplyfyModelPath))
          {
              continue;
          }

          simplyfyModelPath = CreateSimplifyModel(assemblyDocumentOcc, folder);
          itemErpId = GetErpID(assemblyName);

          ComponentDefinition oOccCompDef = oOcc.Definition;
          ModelState modelState = null;

          if (oOccCompDef.Type == ObjectTypeEnum.kWeldmentComponentDefinitionObject)
          {
              WeldmentComponentDefinition oOccWeldCompDef = (WeldmentComponentDefinition)oOccCompDef;
              modelState = oOccWeldCompDef.ModelStates.AddSubstitute(simplyfyModelPath, $"{itemErpId.ToString()}", true);
          }
          else
          {
              AssemblyComponentDefinition oOccAssemblyCompDef = (AssemblyComponentDefinition)oOccCompDef;
              modelState = oOccAssemblyCompDef.ModelStates.AddSubstitute(simplyfyModelPath, $"{itemErpId.ToString()}", true);
          }

          oOcc.ActiveModelState = modelState.Name; // exception apear
          modelState.Activate(); 

          Debug.WriteLine(oOcc.ActiveModelState);
      }
      else
      {
          itemErpId = GetErpID(System.IO.Path.GetFileName(oOcc.ReferencedFileDescriptor.FullFileName));
          oOcc.Name = $"{itemErpId}:{nameCountDict[splittedoOccName]}";

          if (oOcc.BOMStructure != Inventor.BOMStructureEnum.kPurchasedBOMStructure)
          {
              TraverseAssembly(oOcc.Definition.Occurrences, level + 1);
          }
      }
  }
```

#### Code Block 2

```vb
else if (oOcc.DefinitionDocumentType == DocumentTypeEnum.kAssemblyDocumentObject && !string.IsNullOrEmpty(oOcc.Name) && !oOcc.Name.Contains("Weldbead"))
  {
      AssemblyDocument assemblyDocumentOcc = oOcc.ReferencedFileDescriptor.ReferencedDocument as AssemblyDocument;

      string assemblyName = System.IO.Path.GetFileName(assemblyDocumentOcc.FullDocumentName);
      string folder = System.IO.Path.GetDirectoryName(assemblyDocumentOcc.FullDocumentName);
      var modelName = System.IO.Path.GetFileNameWithoutExtension(assemblyDocumentOcc.FullFileName);
      var simplyfyModelPath = System.IO.Path.Combine("C:\\Vault\\Projekty\\URZĄDZENIA STAL POWIETRZE\\OGRZEWACZE POM. STAL KOZY\\BJORN", "Uproszczenia", modelName + ".ipt");

      if (assemblyDocumentOcc.SubType == DocumentSubTypeIds.Weldment)
      {

          if (System.IO.File.Exists(simplyfyModelPath))
          {
              continue;
          }

          simplyfyModelPath = CreateSimplifyModel(assemblyDocumentOcc, folder);
          itemErpId = GetErpID(assemblyName);

          ComponentDefinition oOccCompDef = oOcc.Definition;
          ModelState modelState = null;

          if (oOccCompDef.Type == ObjectTypeEnum.kWeldmentComponentDefinitionObject)
          {
              WeldmentComponentDefinition oOccWeldCompDef = (WeldmentComponentDefinition)oOccCompDef;
              modelState = oOccWeldCompDef.ModelStates.AddSubstitute(simplyfyModelPath, $"{itemErpId.ToString()}", true);
          }
          else
          {
              AssemblyComponentDefinition oOccAssemblyCompDef = (AssemblyComponentDefinition)oOccCompDef;
              modelState = oOccAssemblyCompDef.ModelStates.AddSubstitute(simplyfyModelPath, $"{itemErpId.ToString()}", true);
          }

          oOcc.ActiveModelState = modelState.Name; // exception apear
          modelState.Activate(); 

          Debug.WriteLine(oOcc.ActiveModelState);
      }
      else
      {
          itemErpId = GetErpID(System.IO.Path.GetFileName(oOcc.ReferencedFileDescriptor.FullFileName));
          oOcc.Name = $"{itemErpId}:{nameCountDict[splittedoOccName]}";

          if (oOcc.BOMStructure != Inventor.BOMStructureEnum.kPurchasedBOMStructure)
          {
              TraverseAssembly(oOcc.Definition.Occurrences, level + 1);
          }
      }
  }
```

#### Code Block 3

```vb
oOcc.ActiveModelState = $"{itemErpId.ToString()}";
```

#### Code Block 4

```vb
oOcc.ActiveModelState = $"{itemErpId.ToString()}";
```

#### Code Block 5

```vb
oOcc.IsAssociativeToDesignViewRepresentation = false;
```

#### Code Block 6

```vb
oOcc.IsAssociativeToDesignViewRepresentation = false;
```

#### Code Block 7

```vb
public string CreateSimplifyModel(AssemblyDocument assemblyDocument, string folder)
{
    try
    {
        var modelName = System.IO.Path.GetFileNameWithoutExtension(assemblyDocument.FullFileName);
        var simplifyPartPath = System.IO.Path.Combine("C:\\Vault\\Projekty\\URZĄDZENIA STAL POWIETRZE\\OGRZEWACZE POM. STAL KOZY\\BJORN", "Uproszczenia", modelName + ".ipt");

        PartDocument oPartDoc = (PartDocument)_mInv.Documents.Add(DocumentTypeEnum.kPartDocumentObject, "", false);
        PartComponentDefinition oPartDef = oPartDoc.ComponentDefinition;

        DerivedAssemblyDefinition oDerivedAssemblyDef =
            oPartDef.ReferenceComponents.DerivedAssemblyComponents.CreateDefinition(assemblyDocument.FullDocumentName);

   
        oDerivedAssemblyDef.DeriveStyle = DerivedComponentStyleEnum.kDeriveAsSingleBodyNoSeams;

        oPartDef.ReferenceComponents.DerivedAssemblyComponents.Add(oDerivedAssemblyDef);

        object itemErpId = GetErpID(System.IO.Path.GetFileName(assemblyDocument.FullFileName));

        oPartDef.SurfaceBodies[1].Name = $"{itemErpId}";
        oPartDoc.SaveAs(simplifyPartPath, false);
        oPartDoc.Close(true);

        return simplifyPartPath;

    }
    catch (Exception ex)
    {
        throw new Exception("Błąd podczas generowania uproszczonego modelu.", ex);
    }
}

public void TraverseAssembly(ComponentOccurrences occurrences, int level)
{
    ComponentOccurrence occ = null;
    string oOccName = null;
    string splittedoOccName = null;
    try
    {
        foreach (ComponentOccurrence oOcc in occurrences)
        {
           
            oOccName = oOcc.Name;
            splittedoOccName = oOccName.Split(':')[0];
            if (nameCountDict.ContainsKey(splittedoOccName))
            {
                nameCountDict[splittedoOccName]++;
            }
            else
            {
                nameCountDict.Add(splittedoOccName, 1);
            }

            if (oOcc.DefinitionDocumentType == DocumentTypeEnum.kPartDocumentObject)
            {

                string partName = System.IO.Path.GetFileName(oOcc.ReferencedDocumentDescriptor.FullDocumentName);

                object itemErpId = GetErpID(partName);

                oOcc.SurfaceBodies[1].Name = (string)itemErpId;
            }

            else if (oOcc.DefinitionDocumentType == DocumentTypeEnum.kAssemblyDocumentObject && !string.IsNullOrEmpty(oOcc.Name) && !oOcc.Name.Contains("Weldbead"))
            {
                AssemblyDocument assemblyDocumentOcc = oOcc.ReferencedFileDescriptor.ReferencedDocument as AssemblyDocument;

                string assemblyName = System.IO.Path.GetFileName(assemblyDocumentOcc.FullDocumentName);
                string folder = System.IO.Path.GetDirectoryName(assemblyDocumentOcc.FullDocumentName);
                var modelName = System.IO.Path.GetFileNameWithoutExtension(assemblyDocumentOcc.FullFileName);
                var simplyfyModelPath = System.IO.Path.Combine("C:\\Vault\\Projekty\\URZĄDZENIA STAL POWIETRZE\\OGRZEWACZE POM. STAL KOZY\\BJORN", "Uproszczenia", modelName + ".ipt");

                if (assemblyDocumentOcc.SubType == DocumentSubTypeIds.Weldment)
                {

                    if (System.IO.File.Exists(simplyfyModelPath))
                    {
                        continue;
                    }

                    simplyfyModelPath = CreateSimplifyModel(assemblyDocumentOcc, folder);
                    object itemErpId = GetErpID(assemblyName);

                    ComponentDefinition oOccCompDef = oOcc.Definition;
                    LevelOfDetailRepresentation levelOfDetail = null;

                    if (oOccCompDef.Type == ObjectTypeEnum.kWeldmentComponentDefinitionObject)
                    {
                        WeldmentComponentDefinition oOccWeldCompDef = (WeldmentComponentDefinition)oOccCompDef;
                        levelOfDetail = oOccWeldCompDef.RepresentationsManager.LevelOfDetailRepresentations.AddSubstitute(simplyfyModelPath, $"{itemErpId.ToString()}", false);
                    }
                    else
                    {
                        AssemblyComponentDefinition oOccAssemblyCompDef = (AssemblyComponentDefinition)oOccCompDef;
                        levelOfDetail = oOccAssemblyCompDef.RepresentationsManager.LevelOfDetailRepresentations.AddSubstitute(simplyfyModelPath, $"{itemErpId.ToString()}", false);
                    }


                    oOcc.ActiveModelState = $"{itemErpId.ToString()}";

                    Debug.WriteLine(oOcc.ActiveModelState);
                }
                else
                {
                    object itemErpId = GetErpID(System.IO.Path.GetFileName(oOcc.ReferencedFileDescriptor.FullFileName));
                    oOcc.Name = $"{itemErpId}:{nameCountDict[splittedoOccName]}";

                    if (oOcc.BOMStructure != Inventor.BOMStructureEnum.kPurchasedBOMStructure)
                    {
                        TraverseAssembly(oOcc.Definition.Occurrences, level + 1);
                    }
                }
            }
        }
    }
    catch(Exception ex)
    {
        throw new Exception("Wystapił błąd podczas przeszukiwania modelu.");
    }
}
```

#### Code Block 8

```vb
public string CreateSimplifyModel(AssemblyDocument assemblyDocument, string folder)
{
    try
    {
        var modelName = System.IO.Path.GetFileNameWithoutExtension(assemblyDocument.FullFileName);
        var simplifyPartPath = System.IO.Path.Combine("C:\\Vault\\Projekty\\URZĄDZENIA STAL POWIETRZE\\OGRZEWACZE POM. STAL KOZY\\BJORN", "Uproszczenia", modelName + ".ipt");

        PartDocument oPartDoc = (PartDocument)_mInv.Documents.Add(DocumentTypeEnum.kPartDocumentObject, "", false);
        PartComponentDefinition oPartDef = oPartDoc.ComponentDefinition;

        DerivedAssemblyDefinition oDerivedAssemblyDef =
            oPartDef.ReferenceComponents.DerivedAssemblyComponents.CreateDefinition(assemblyDocument.FullDocumentName);

   
        oDerivedAssemblyDef.DeriveStyle = DerivedComponentStyleEnum.kDeriveAsSingleBodyNoSeams;

        oPartDef.ReferenceComponents.DerivedAssemblyComponents.Add(oDerivedAssemblyDef);

        object itemErpId = GetErpID(System.IO.Path.GetFileName(assemblyDocument.FullFileName));

        oPartDef.SurfaceBodies[1].Name = $"{itemErpId}";
        oPartDoc.SaveAs(simplifyPartPath, false);
        oPartDoc.Close(true);

        return simplifyPartPath;

    }
    catch (Exception ex)
    {
        throw new Exception("Błąd podczas generowania uproszczonego modelu.", ex);
    }
}

public void TraverseAssembly(ComponentOccurrences occurrences, int level)
{
    ComponentOccurrence occ = null;
    string oOccName = null;
    string splittedoOccName = null;
    try
    {
        foreach (ComponentOccurrence oOcc in occurrences)
        {
           
            oOccName = oOcc.Name;
            splittedoOccName = oOccName.Split(':')[0];
            if (nameCountDict.ContainsKey(splittedoOccName))
            {
                nameCountDict[splittedoOccName]++;
            }
            else
            {
                nameCountDict.Add(splittedoOccName, 1);
            }

            if (oOcc.DefinitionDocumentType == DocumentTypeEnum.kPartDocumentObject)
            {

                string partName = System.IO.Path.GetFileName(oOcc.ReferencedDocumentDescriptor.FullDocumentName);

                object itemErpId = GetErpID(partName);

                oOcc.SurfaceBodies[1].Name = (string)itemErpId;
            }

            else if (oOcc.DefinitionDocumentType == DocumentTypeEnum.kAssemblyDocumentObject && !string.IsNullOrEmpty(oOcc.Name) && !oOcc.Name.Contains("Weldbead"))
            {
                AssemblyDocument assemblyDocumentOcc = oOcc.ReferencedFileDescriptor.ReferencedDocument as AssemblyDocument;

                string assemblyName = System.IO.Path.GetFileName(assemblyDocumentOcc.FullDocumentName);
                string folder = System.IO.Path.GetDirectoryName(assemblyDocumentOcc.FullDocumentName);
                var modelName = System.IO.Path.GetFileNameWithoutExtension(assemblyDocumentOcc.FullFileName);
                var simplyfyModelPath = System.IO.Path.Combine("C:\\Vault\\Projekty\\URZĄDZENIA STAL POWIETRZE\\OGRZEWACZE POM. STAL KOZY\\BJORN", "Uproszczenia", modelName + ".ipt");

                if (assemblyDocumentOcc.SubType == DocumentSubTypeIds.Weldment)
                {

                    if (System.IO.File.Exists(simplyfyModelPath))
                    {
                        continue;
                    }

                    simplyfyModelPath = CreateSimplifyModel(assemblyDocumentOcc, folder);
                    object itemErpId = GetErpID(assemblyName);

                    ComponentDefinition oOccCompDef = oOcc.Definition;
                    LevelOfDetailRepresentation levelOfDetail = null;

                    if (oOccCompDef.Type == ObjectTypeEnum.kWeldmentComponentDefinitionObject)
                    {
                        WeldmentComponentDefinition oOccWeldCompDef = (WeldmentComponentDefinition)oOccCompDef;
                        levelOfDetail = oOccWeldCompDef.RepresentationsManager.LevelOfDetailRepresentations.AddSubstitute(simplyfyModelPath, $"{itemErpId.ToString()}", false);
                    }
                    else
                    {
                        AssemblyComponentDefinition oOccAssemblyCompDef = (AssemblyComponentDefinition)oOccCompDef;
                        levelOfDetail = oOccAssemblyCompDef.RepresentationsManager.LevelOfDetailRepresentations.AddSubstitute(simplyfyModelPath, $"{itemErpId.ToString()}", false);
                    }


                    oOcc.ActiveModelState = $"{itemErpId.ToString()}";

                    Debug.WriteLine(oOcc.ActiveModelState);
                }
                else
                {
                    object itemErpId = GetErpID(System.IO.Path.GetFileName(oOcc.ReferencedFileDescriptor.FullFileName));
                    oOcc.Name = $"{itemErpId}:{nameCountDict[splittedoOccName]}";

                    if (oOcc.BOMStructure != Inventor.BOMStructureEnum.kPurchasedBOMStructure)
                    {
                        TraverseAssembly(oOcc.Definition.Occurrences, level + 1);
                    }
                }
            }
        }
    }
    catch(Exception ex)
    {
        throw new Exception("Wystapił błąd podczas przeszukiwania modelu.");
    }
}
```

---

### 31. Changing sheetmetal style of a Lofted Flange using iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/changing-sheetmetal-style-of-a-lofted-flange-using-ilogic/td-p/13824763](https://forums.autodesk.com/t5/inventor-programming-forum/changing-sheetmetal-style-of-a-lofted-flange-using-ilogic/td-p/13824763)

**Author:** RogerdeSmidt

**Date:** ‎09-25-2025
	
		
		12:03 AM

**Description:** Hi All, I have a multi-body sheetmetal part with multiple lofted flanges, each created as a new body and each has a different sheetmetal rule assigned to it. I would like to be able to change the sheetmetal rule using iLogic.I have only managed the code below and could probably add bed radii and kfa...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim oPartDoc As PartDocument = ThisDoc.ModelDocument
Dim oFeatures As PartFeatures = oPartDoc.ComponentDefinition.Features

For Each oFeature As PartFeature In oFeatures
	If oFeature.Name() = "Loft 1" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule.Thickness = LOFT_1_THICKNESS
	Else If oFeature.Name() = "Loft 2" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule.Thickness = LOFT_2_THICKNESS
	End If
Next
```

#### Code Block 2

```vb
Dim oPartDoc As PartDocument = ThisDoc.ModelDocument
Dim oFeatures As PartFeatures = oPartDoc.ComponentDefinition.Features

For Each oFeature As PartFeature In oFeatures
	If oFeature.Name() = "Loft 1" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule.Thickness = LOFT_1_THICKNESS
	Else If oFeature.Name() = "Loft 2" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule.Thickness = LOFT_2_THICKNESS
	End If
Next
```

#### Code Block 3

```vb
Dim oPartDoc As PartDocument = ThisDoc.ModelDocument
Dim oSmDef As SheetMetalComponentDefinition=oPartDoc.ComponentDefinition
Dim oFeatures As PartFeatures = oSmDef.Features

For Each oFeature As PartFeature In oFeatures
	If oFeature.Name() ="Loft 1" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule=oSmDef.SheetMetalStyles("1,0")
	Else If oFeature.Name() = "Loft 2" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule=oSmDef.SheetMetalStyles("2,0")
	End If
Next
```

#### Code Block 4

```vb
Dim oPartDoc As PartDocument = ThisDoc.ModelDocument
Dim oSmDef As SheetMetalComponentDefinition=oPartDoc.ComponentDefinition
Dim oFeatures As PartFeatures = oSmDef.Features

For Each oFeature As PartFeature In oFeatures
	If oFeature.Name() ="Loft 1" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule=oSmDef.SheetMetalStyles("1,0")
	Else If oFeature.Name() = "Loft 2" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule=oSmDef.SheetMetalStyles("2,0")
	End If
Next
```

#### Code Block 5

```vb
Dim oPartDoc As PartDocument = ThisDoc.ModelDocument
Dim oSmDef As SheetMetalComponentDefinition=oPartDoc.ComponentDefinition
Dim oFeatures As PartFeatures = oSmDef.Features

For Each oFeature As PartFeature In oFeatures
	If oFeature.Name() ="Loft 1" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule=oSmDef.SheetMetalStyles("1,0")
	Else If oFeature.Name() = "Loft 2" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule=oSmDef.SheetMetalStyles("2,0")
	End If
Next
```

#### Code Block 6

```vb
Dim oPartDoc As PartDocument = ThisDoc.ModelDocument
Dim oSmDef As SheetMetalComponentDefinition=oPartDoc.ComponentDefinition
Dim oFeatures As PartFeatures = oSmDef.Features

For Each oFeature As PartFeature In oFeatures
	If oFeature.Name() ="Loft 1" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule=oSmDef.SheetMetalStyles("1,0")
	Else If oFeature.Name() = "Loft 2" Then
		Dim oLoftedFlangeDef As LoftedFlangeDefinition = oFeature.Definition()
		oLoftedFlangeDef.SheetMetalRule=oSmDef.SheetMetalStyles("2,0")
	End If
Next
```

---

### 32. CircularPatternOccurrence

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/circularpatternoccurrence/td-p/13835553](https://forums.autodesk.com/t5/inventor-programming-forum/circularpatternoccurrence/td-p/13835553)

**Author:** WIRMNS

**Date:** ‎10-03-2025
	
		
		12:24 AM

**Description:** Hi,How can I control a CircularPatternOccurrence with iLogic?Can anyone help me with this? Or does anyone have an example of how to do this?Thx. 					 				 			 			 				 			 			 				 	 			 				 					 						Solved! 					 					Go to Solution.

**Code Snippets (2):**

#### Code Block 1

```vb
'get the current document, then try to Cast its Type to the AssemblyDocument Type
Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
'if that did not work, then we did not get a value, so exit the rule
If oADoc Is Nothing Then Return
'get the assembly's component definition (where all geometry and coordinate system are)
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
'get just the occurrence patterns collection
'thic can contain rectangular, circular, and feature-based patterns
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
'if there are none, then exit the eule
If oOccPatts.Count = 0 Then Return
'start iterating through each OccurrencePattern
For Each oOccPatt As OccurrencePattern In oOccPatts
	'if it is suppressed, then skip over it (because we can't do anything with it)
	If oOccPatt.Suppressed Then Continue For
	'if it is not a 'circular' type, then skip over it
	If (Not TypeOf oOccPatt Is CircularOccurrencePattern) Then Continue For
	'declare a variable to hold the CircularOccurrencePattern Type object
	Dim oCircOccPatt As CircularOccurrencePattern = oOccPatt
	'check if its name matches what we want to get
	'<<< CHANGE THIS AS NEEDED >>>
	If oCircOccPatt.Name = "My Circular Occurrence Pattern" Then
		Dim oOccPattElmts As OccurrencePatternElements = oCircOccPatt.OccurrencePatternElements
		'get the 'Last' element in the pattern
		Dim oOccPattElmt As OccurrencePatternElement = oOccPattElmts.Item(oOccPattElmts.Count)
		'get first component occurrence in this element
		Dim oPattElmtOcc As ComponentOccurrence = oOccPattElmt.Occurrences.Item(1)
		'<<< CHANGE THIS AS NEEDED >>>
		Dim sDVR_Name As String = "Specific Design View Representation Name"
		Try
			'try so set the DVR of this component occurrence to a specific one available in its referenced document
			oPattElmtOcc.SetDesignViewRepresentation(sDVR_Name, , True)
		Catch
			Logger.Error("Failed to set View Representation of circular pattern element component occurrence!")
		End Try
	End If
Next 'oOccPatt
'update the main assembly document
oADoc.Update2(True)
```

#### Code Block 2

```vb
'get the current document, then try to Cast its Type to the AssemblyDocument Type
Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
'if that did not work, then we did not get a value, so exit the rule
If oADoc Is Nothing Then Return
'get the assembly's component definition (where all geometry and coordinate system are)
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
'get just the occurrence patterns collection
'thic can contain rectangular, circular, and feature-based patterns
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
'if there are none, then exit the eule
If oOccPatts.Count = 0 Then Return
'start iterating through each OccurrencePattern
For Each oOccPatt As OccurrencePattern In oOccPatts
	'if it is suppressed, then skip over it (because we can't do anything with it)
	If oOccPatt.Suppressed Then Continue For
	'if it is not a 'circular' type, then skip over it
	If (Not TypeOf oOccPatt Is CircularOccurrencePattern) Then Continue For
	'declare a variable to hold the CircularOccurrencePattern Type object
	Dim oCircOccPatt As CircularOccurrencePattern = oOccPatt
	'check if its name matches what we want to get
	'<<< CHANGE THIS AS NEEDED >>>
	If oCircOccPatt.Name = "My Circular Occurrence Pattern" Then
		Dim oOccPattElmts As OccurrencePatternElements = oCircOccPatt.OccurrencePatternElements
		'get the 'Last' element in the pattern
		Dim oOccPattElmt As OccurrencePatternElement = oOccPattElmts.Item(oOccPattElmts.Count)
		'get first component occurrence in this element
		Dim oPattElmtOcc As ComponentOccurrence = oOccPattElmt.Occurrences.Item(1)
		'<<< CHANGE THIS AS NEEDED >>>
		Dim sDVR_Name As String = "Specific Design View Representation Name"
		Try
			'try so set the DVR of this component occurrence to a specific one available in its referenced document
			oPattElmtOcc.SetDesignViewRepresentation(sDVR_Name, , True)
		Catch
			Logger.Error("Failed to set View Representation of circular pattern element component occurrence!")
		End Try
	End If
Next 'oOccPatt
'update the main assembly document
oADoc.Update2(True)
```

#### Code Block 3

```vb
'get the current document, then try to Cast its Type to the AssemblyDocument Type
Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
'if that did not work, then we did not get a value, so exit the rule
If oADoc Is Nothing Then Return
'get the assembly's component definition (where all geometry and coordinate system are)
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
'get just the occurrence patterns collection
'thic can contain rectangular, circular, and feature-based patterns
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
'if there are none, then exit the eule
If oOccPatts.Count = 0 Then Return
'start iterating through each OccurrencePattern
For Each oOccPatt As OccurrencePattern In oOccPatts
	'if it is suppressed, then skip over it (because we can't do anything with it)
	If oOccPatt.Suppressed Then Continue For
	'if it is not a 'circular' type, then skip over it
	If (Not TypeOf oOccPatt Is CircularOccurrencePattern) Then Continue For
	'declare a variable to hold the CircularOccurrencePattern Type object
	Dim oCircOccPatt As CircularOccurrencePattern = oOccPatt
	'check if its name matches what we want to get
	'<<< CHANGE THIS AS NEEDED >>>
	If oCircOccPatt.Name = "My Circular Occurrence Pattern" Then
		Dim oOccPattElmts As OccurrencePatternElements = oCircOccPatt.OccurrencePatternElements
		'get the 'Last' element in the pattern
		Dim oOccPattElmt As OccurrencePatternElement = oOccPattElmts.Item(oOccPattElmts.Count)
		'get first component occurrence in this element
		Dim oPattElmtOcc As ComponentOccurrence = oOccPattElmt.Occurrences.Item(1)
		'<<< CHANGE THIS AS NEEDED >>>
		Dim sDVR_Name As String = "Specific Design View Representation Name"
		Try
			'try so set the DVR of this component occurrence to a specific one available in its referenced document
			oPattElmtOcc.SetDesignViewRepresentation(sDVR_Name, , True)
		Catch
			Logger.Error("Failed to set View Representation of circular pattern element component occurrence!")
		End Try
	End If
Next 'oOccPatt
'update the main assembly document
oADoc.Update2(True)
```

#### Code Block 4

```vb
'get the current document, then try to Cast its Type to the AssemblyDocument Type
Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
'if that did not work, then we did not get a value, so exit the rule
If oADoc Is Nothing Then Return
'get the assembly's component definition (where all geometry and coordinate system are)
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
'get just the occurrence patterns collection
'thic can contain rectangular, circular, and feature-based patterns
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
'if there are none, then exit the eule
If oOccPatts.Count = 0 Then Return
'start iterating through each OccurrencePattern
For Each oOccPatt As OccurrencePattern In oOccPatts
	'if it is suppressed, then skip over it (because we can't do anything with it)
	If oOccPatt.Suppressed Then Continue For
	'if it is not a 'circular' type, then skip over it
	If (Not TypeOf oOccPatt Is CircularOccurrencePattern) Then Continue For
	'declare a variable to hold the CircularOccurrencePattern Type object
	Dim oCircOccPatt As CircularOccurrencePattern = oOccPatt
	'check if its name matches what we want to get
	'<<< CHANGE THIS AS NEEDED >>>
	If oCircOccPatt.Name = "My Circular Occurrence Pattern" Then
		Dim oOccPattElmts As OccurrencePatternElements = oCircOccPatt.OccurrencePatternElements
		'get the 'Last' element in the pattern
		Dim oOccPattElmt As OccurrencePatternElement = oOccPattElmts.Item(oOccPattElmts.Count)
		'get first component occurrence in this element
		Dim oPattElmtOcc As ComponentOccurrence = oOccPattElmt.Occurrences.Item(1)
		'<<< CHANGE THIS AS NEEDED >>>
		Dim sDVR_Name As String = "Specific Design View Representation Name"
		Try
			'try so set the DVR of this component occurrence to a specific one available in its referenced document
			oPattElmtOcc.SetDesignViewRepresentation(sDVR_Name, , True)
		Catch
			Logger.Error("Failed to set View Representation of circular pattern element component occurrence!")
		End Try
	End If
Next 'oOccPatt
'update the main assembly document
oADoc.Update2(True)
```

---

### 33. Code doesn't work anymore for dxf

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/code-doesn-t-work-anymore-for-dxf/td-p/13763668#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/code-doesn-t-work-anymore-for-dxf/td-p/13763668#messageview_0)

**Author:** berry.lejeune

**Date:** ‎08-12-2025
	
		
		12:13 AM

**Description:** Hello all, I've been using a code to make dxf's but since yesterday the code doens't work anymoreThe workflow is as follow:Select a faceRun the codeCode makes a subfolder in the folder where the part is in (folder called "dxf")Code makes a dxf with the partnumber of the partCode automatically opens ...

**Code Snippets (3):**

#### Code Block 1

```vb
'Export face to pre-defined folder

If ThisApplication.ActiveDocument.SelectSet.Count = 0 Then
	MsgBox("Face not selected. Aborting Rule!")
	Exit Sub
End If

oPath = ThisDoc.Path
'get DXF target folder path
oFolder = oPath & "\" & "DXF"
'Check for the dxf folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
System.IO.Directory.CreateDirectory(oFolder)
End If
oFileName = oFolder & "\" & ThisDoc.FileName & ".dxf"

Dim oCmdMgr As CommandManager
oCmdMgr = ThisApplication.CommandManager

Call oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, oFileName)
Call oCmdMgr.ControlDefinitions.Item("GeomToDXFCommand").Execute

'open the folder where the new files are saved
Shell("explorer.exe " & oFolder,vbNormalFocus)
```

#### Code Block 2

```vb
'Export face to pre-defined folder

If ThisApplication.ActiveDocument.SelectSet.Count = 0 Then
	MsgBox("Face not selected. Aborting Rule!")
	Exit Sub
End If

oPath = ThisDoc.Path
'get DXF target folder path
oFolder = oPath & "\" & "DXF"
'Check for the dxf folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
System.IO.Directory.CreateDirectory(oFolder)
End If
oFileName = oFolder & "\" & ThisDoc.FileName & ".dxf"

Dim oCmdMgr As CommandManager
oCmdMgr = ThisApplication.CommandManager

Call oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, oFileName)
Call oCmdMgr.ControlDefinitions.Item("GeomToDXFCommand").Execute

'open the folder where the new files are saved
Shell("explorer.exe " & oFolder,vbNormalFocus)
```

#### Code Block 3

```vb
'Export face to pre-defined folder

If ThisApplication.ActiveDocument.SelectSet.Count = 0 Then
	MsgBox("Face not selected. Aborting Rule!")
	Exit Sub
End If

oPath = ThisDoc.Path
'get DXF target folder path
oFolder = oPath & "\" & "DXF"
'Check for the dxf folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
System.IO.Directory.CreateDirectory(oFolder)
End If
oFileName = oFolder & "\" & ThisDoc.FileName & ".dxf"

Dim oCmdMgr As CommandManager
oCmdMgr = ThisApplication.CommandManager

Call oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, oFileName)
Call oCmdMgr.ControlDefinitions.Item("GeomToDXFCommand").Execute

'open the folder where the new files are saved
Shell("explorer.exe " & oFolder,vbNormalFocus)
```

#### Code Block 4

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oDoc As Inventor.Document = oInvApp.ActiveDocument
If oDoc Is Nothing Then Return
If (Not TypeOf oDoc Is PartDocument) AndAlso (Not TypeOf oDoc Is AssemblyDocument) Then
	MsgBox("Active Document Is Not An Assembly or Part!", vbCritical, "")
	Return
End If
'<<< verify pre-selection >>>
Dim oSS As Inventor.SelectSet = oDoc.SelectSet
If oSS.Count = 0 Then
	MsgBox("Nothing Pre-Selected!", vbCritical, "")
	Return
ElseIf oSS.Count > 1 Then
	MsgBox("Multiple Objects Pre-Selected!", vbCritical, "")
	Return
End If
'try to Cast the first generic Object to a Face type (no error on failure)
Dim oFace As Inventor.Face = TryCast(oSS.Item(1), Inventor.Face)
'make sure the variable got assigned a value
If oFace Is Nothing Then
	MsgBox("No Face Pre-Selected!", vbCritical, "")
	Return
End If
'<<< now formulate the full path and file name of the new DXF file >>>
If oDoc.FileSaveCounter = 0 Then
	MsgBox("This Document has not been saved yet, so it has no 'Path' or 'FileName'!", vbCritical, "")
	Return
End If
Dim sFFN As String = oDoc.FullFileName
'gets the full path, without file name
Dim sPath As String = System.IO.Path.GetDirectoryName(sFFN)
'combine that path with sub folder name
sPath = System.IO.Path.Combine(sPath, "DXF")
'if that folder does not exist, create it
If Not System.IO.Directory.Exists(sPath) Then
	System.IO.Directory.CreateDirectory(sPath)
End If
'get just the file name, without path, and without file extension
Dim sFileName As String = System.IO.Path.GetFileNameWithoutExtension(sFFN)
'combine path and new file name for full file name of new DXF
sFFN = System.IO.Path.Combine(sPath, sFileName & ".dxf")
Logger.Info("Proposed FullFileName of new DXF:" & vbCrLf & sFFN)

Dim oCmdMgr As Inventor.CommandManager = oInvApp.CommandManager
'send data to Inventor's memory
oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, sFFN)
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'capture Face Edges, and create DXF from them (normally shows SaveAs dialog)
oCmdMgr.ControlDefinitions.Item("GeomToDXFCommand").Execute()
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'open folder where file was created
Shell("explorer.exe " & sPath, vbNormalFocus)
```

#### Code Block 5

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oDoc As Inventor.Document = oInvApp.ActiveDocument
If oDoc Is Nothing Then Return
If (Not TypeOf oDoc Is PartDocument) AndAlso (Not TypeOf oDoc Is AssemblyDocument) Then
	MsgBox("Active Document Is Not An Assembly or Part!", vbCritical, "")
	Return
End If
'<<< verify pre-selection >>>
Dim oSS As Inventor.SelectSet = oDoc.SelectSet
If oSS.Count = 0 Then
	MsgBox("Nothing Pre-Selected!", vbCritical, "")
	Return
ElseIf oSS.Count > 1 Then
	MsgBox("Multiple Objects Pre-Selected!", vbCritical, "")
	Return
End If
'try to Cast the first generic Object to a Face type (no error on failure)
Dim oFace As Inventor.Face = TryCast(oSS.Item(1), Inventor.Face)
'make sure the variable got assigned a value
If oFace Is Nothing Then
	MsgBox("No Face Pre-Selected!", vbCritical, "")
	Return
End If
'<<< now formulate the full path and file name of the new DXF file >>>
If oDoc.FileSaveCounter = 0 Then
	MsgBox("This Document has not been saved yet, so it has no 'Path' or 'FileName'!", vbCritical, "")
	Return
End If
Dim sFFN As String = oDoc.FullFileName
'gets the full path, without file name
Dim sPath As String = System.IO.Path.GetDirectoryName(sFFN)
'combine that path with sub folder name
sPath = System.IO.Path.Combine(sPath, "DXF")
'if that folder does not exist, create it
If Not System.IO.Directory.Exists(sPath) Then
	System.IO.Directory.CreateDirectory(sPath)
End If
'get just the file name, without path, and without file extension
Dim sFileName As String = System.IO.Path.GetFileNameWithoutExtension(sFFN)
'combine path and new file name for full file name of new DXF
sFFN = System.IO.Path.Combine(sPath, sFileName & ".dxf")
Logger.Info("Proposed FullFileName of new DXF:" & vbCrLf & sFFN)

Dim oCmdMgr As Inventor.CommandManager = oInvApp.CommandManager
'send data to Inventor's memory
oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, sFFN)
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'capture Face Edges, and create DXF from them (normally shows SaveAs dialog)
oCmdMgr.ControlDefinitions.Item("GeomToDXFCommand").Execute()
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'open folder where file was created
Shell("explorer.exe " & sPath, vbNormalFocus)
```

#### Code Block 6

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oDoc As Inventor.Document = oInvApp.ActiveDocument
If oDoc Is Nothing Then Return
If (Not TypeOf oDoc Is PartDocument) AndAlso (Not TypeOf oDoc Is AssemblyDocument) Then
	MsgBox("Active Document Is Not An Assembly or Part!", vbCritical, "")
	Return
End If
'<<< verify pre-selection >>>
Dim oSS As Inventor.SelectSet = oDoc.SelectSet
If oSS.Count = 0 Then
	MsgBox("Nothing Pre-Selected!", vbCritical, "")
	Return
ElseIf oSS.Count > 1 Then
	MsgBox("Multiple Objects Pre-Selected!", vbCritical, "")
	Return
End If
'try to Cast the first generic Object to a Face type (no error on failure)
Dim oFace As Inventor.Face = TryCast(oSS.Item(1), Inventor.Face)
'make sure the variable got assigned a value
If oFace Is Nothing Then
	MsgBox("No Face Pre-Selected!", vbCritical, "")
	Return
End If
'<<< now formulate the full path and file name of the new DXF file >>>
If oDoc.FileSaveCounter = 0 Then
	MsgBox("This Document has not been saved yet, so it has no 'Path' or 'FileName'!", vbCritical, "")
	Return
End If
Dim sFFN As String = oDoc.FullFileName
'gets the full path, without file name
Dim sPath As String = System.IO.Path.GetDirectoryName(sFFN)
'combine that path with sub folder name
sPath = System.IO.Path.Combine(sPath, "DXF")
'if that folder does not exist, create it
If Not System.IO.Directory.Exists(sPath) Then
	System.IO.Directory.CreateDirectory(sPath)
End If
'get just the file name, without path, and without file extension
Dim sFileName As String = System.IO.Path.GetFileNameWithoutExtension(sFFN)
'combine path and new file name for full file name of new DXF
sFFN = System.IO.Path.Combine(sPath, sFileName & ".dxf")
Logger.Info("Proposed FullFileName of new DXF:" & vbCrLf & sFFN)

Dim oCmdMgr As Inventor.CommandManager = oInvApp.CommandManager
'send data to Inventor's memory
oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, sFFN)
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'capture Face Edges, and create DXF from them (normally shows SaveAs dialog)
oCmdMgr.ControlDefinitions.Item("GeomToDXFCommand").Execute()
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'open folder where file was created
Shell("explorer.exe " & sPath, vbNormalFocus)
```

#### Code Block 7

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oDoc As Inventor.Document = oInvApp.ActiveDocument
If oDoc Is Nothing Then Return
If (Not TypeOf oDoc Is PartDocument) AndAlso (Not TypeOf oDoc Is AssemblyDocument) Then
	MsgBox("Active Document Is Not An Assembly or Part!", vbCritical, "")
	Return
End If
'<<< verify pre-selection >>>
Dim oSS As Inventor.SelectSet = oDoc.SelectSet
If oSS.Count = 0 Then
	MsgBox("Nothing Pre-Selected!", vbCritical, "")
	Return
ElseIf oSS.Count > 1 Then
	MsgBox("Multiple Objects Pre-Selected!", vbCritical, "")
	Return
End If
'try to Cast the first generic Object to a Face type (no error on failure)
Dim oFace As Inventor.Face = TryCast(oSS.Item(1), Inventor.Face)
'make sure the variable got assigned a value
If oFace Is Nothing Then
	MsgBox("No Face Pre-Selected!", vbCritical, "")
	Return
End If
'<<< now formulate the full path and file name of the new DXF file >>>
If oDoc.FileSaveCounter = 0 Then
	MsgBox("This Document has not been saved yet, so it has no 'Path' or 'FileName'!", vbCritical, "")
	Return
End If
Dim sFFN As String = oDoc.FullFileName
'gets the full path, without file name
Dim sPath As String = System.IO.Path.GetDirectoryName(sFFN)
'combine that path with sub folder name
sPath = System.IO.Path.Combine(sPath, "DXF")
'if that folder does not exist, create it
If Not System.IO.Directory.Exists(sPath) Then
	System.IO.Directory.CreateDirectory(sPath)
End If
'get just the file name, without path, and without file extension
Dim sFileName As String = System.IO.Path.GetFileNameWithoutExtension(sFFN)
'combine path and new file name for full file name of new DXF
sFFN = System.IO.Path.Combine(sPath, sFileName & ".dxf")
Logger.Info("Proposed FullFileName of new DXF:" & vbCrLf & sFFN)

Dim oCmdMgr As Inventor.CommandManager = oInvApp.CommandManager
'send data to Inventor's memory
oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, sFFN)
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'capture Face Edges, and create DXF from them (normally shows SaveAs dialog)
oCmdMgr.ControlDefinitions.Item("GeomToDXFCommand").Execute()
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'open folder where file was created
Shell("explorer.exe " & sPath, vbNormalFocus)
```

#### Code Block 8

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oDoc As Inventor.Document = oInvApp.ActiveDocument
If oDoc Is Nothing Then Return
If (Not TypeOf oDoc Is PartDocument) AndAlso (Not TypeOf oDoc Is AssemblyDocument) Then
	MsgBox("Active Document Is Not An Assembly or Part!", vbCritical, "")
	Return
End If
'<<< verify pre-selection >>>
Dim oSS As Inventor.SelectSet = oDoc.SelectSet
If oSS.Count = 0 Then
	MsgBox("Nothing Pre-Selected!", vbCritical, "")
	Return
ElseIf oSS.Count > 1 Then
	MsgBox("Multiple Objects Pre-Selected!", vbCritical, "")
	Return
End If
'try to Cast the first generic Object to a Face type (no error on failure)
Dim oFace As Inventor.Face = TryCast(oSS.Item(1), Inventor.Face)
'make sure the variable got assigned a value
If oFace Is Nothing Then
	MsgBox("No Face Pre-Selected!", vbCritical, "")
	Return
End If
'<<< now formulate the full path and file name of the new DXF file >>>
If oDoc.FileSaveCounter = 0 Then
	MsgBox("This Document has not been saved yet, so it has no 'Path' or 'FileName'!", vbCritical, "")
	Return
End If
Dim sFFN As String = oDoc.FullFileName
'gets the full path, without file name
Dim sPath As String = System.IO.Path.GetDirectoryName(sFFN)
'combine that path with sub folder name
sPath = System.IO.Path.Combine(sPath, "DXF")
'if that folder does not exist, create it
If Not System.IO.Directory.Exists(sPath) Then
	System.IO.Directory.CreateDirectory(sPath)
End If
'get just the file name, without path, and without file extension
Dim sFileName As String = System.IO.Path.GetFileNameWithoutExtension(sFFN)
'combine path and new file name for full file name of new DXF
sFFN = System.IO.Path.Combine(sPath, sFileName & ".dxf")
Logger.Info("Proposed FullFileName of new DXF:" & vbCrLf & sFFN)

Dim oCmdMgr As Inventor.CommandManager = oInvApp.CommandManager
'send data to Inventor's memory
oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, sFFN)
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'capture Face Edges, and create DXF from them (normally shows SaveAs dialog)
oCmdMgr.ControlDefinitions.Item("GeomToDXFCommand").Execute()
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'open folder where file was created
Shell("explorer.exe " & sPath, vbNormalFocus)
```

#### Code Block 9

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oDoc As Inventor.Document = oInvApp.ActiveDocument
If oDoc Is Nothing Then Return
If (Not TypeOf oDoc Is PartDocument) AndAlso (Not TypeOf oDoc Is AssemblyDocument) Then
	MsgBox("Active Document Is Not An Assembly or Part!", vbCritical, "")
	Return
End If
'<<< verify pre-selection >>>
Dim oSS As Inventor.SelectSet = oDoc.SelectSet
If oSS.Count = 0 Then
	MsgBox("Nothing Pre-Selected!", vbCritical, "")
	Return
ElseIf oSS.Count > 1 Then
	MsgBox("Multiple Objects Pre-Selected!", vbCritical, "")
	Return
End If
'try to Cast the first generic Object to a Face type (no error on failure)
Dim oFace As Inventor.Face = TryCast(oSS.Item(1), Inventor.Face)
'make sure the variable got assigned a value
If oFace Is Nothing Then
	MsgBox("No Face Pre-Selected!", vbCritical, "")
	Return
End If
'<<< now formulate the full path and file name of the new DXF file >>>
If oDoc.FileSaveCounter = 0 Then
	MsgBox("This Document has not been saved yet, so it has no 'Path' or 'FileName'!", vbCritical, "")
	Return
End If
Dim sFFN As String = oDoc.FullFileName
'gets the full path, without file name
Dim sPath As String = System.IO.Path.GetDirectoryName(sFFN)
'combine that path with sub folder name
sPath = System.IO.Path.Combine(sPath, "DXF")
'if that folder does not exist, create it
If Not System.IO.Directory.Exists(sPath) Then
	System.IO.Directory.CreateDirectory(sPath)
End If
'get just the file name, without path, and without file extension
Dim sFileName As String = System.IO.Path.GetFileNameWithoutExtension(sFFN)
'combine path and new file name for full file name of new DXF
sFFN = System.IO.Path.Combine(sPath, sFileName & ".dxf")
Logger.Info("Proposed FullFileName of new DXF:" & vbCrLf & sFFN)

Dim oCmdMgr As Inventor.CommandManager = oInvApp.CommandManager
'send data to Inventor's memory
oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, sFFN)
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'capture Face Edges, and create DXF from them (normally shows SaveAs dialog)
oCmdMgr.ControlDefinitions.Item("GeomToDXFCommand").Execute()
'give Inventor time to process that task
oInvApp.UserInterfaceManager.DoEvents()
'open folder where file was created
Shell("explorer.exe " & sPath, vbNormalFocus)
```

---

### 34. Colour Coding Parts by Length in Drawings

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/colour-coding-parts-by-length-in-drawings/td-p/13802556](https://forums.autodesk.com/t5/inventor-programming-forum/colour-coding-parts-by-length-in-drawings/td-p/13802556)

**Author:** BasVermeer

**Date:** ‎09-09-2025
	
		
		02:20 AM

**Description:** Hi everyone,I have a large number of drawings that include standard-sized tubes and profiles. The team on the shop floor has asked if it's possible to apply colour coding based on the length of each part — for example:1200mm = blue1100mm = red1000mm = yellow...and so on.I know that in assemblies, it...

**Code Snippets (3):**

#### Code Block 1

```vb
' iLogic: Color each LEAF PART occurrence by its Part Number (drills into subassemblies)
Public Class ThisRule

  Sub Main()
    Dim doc As AssemblyDocument = ThisDoc.Document
    Dim trans As Transaction = ThisApplication.TransactionManager.StartTransaction(doc, "Unique Colors by Leaf Part Number")

    SetDesignViewRepresentation(doc)

    Dim colorByPartNr As New Dictionary(Of String, Asset)
    Dim rng As New System.Random()

    ' Iterate only real parts (leaf occurrences), not subassemblies
    For Each leaf As ComponentOccurrence In doc.ComponentDefinition.Occurrences.AllLeafOccurrences
      If leaf Is Nothing Then Continue For

      Dim pn As String = GetPartNumber(leaf)
      If String.IsNullOrWhiteSpace(pn) Then Continue For

      Dim a As Asset = Nothing
      If colorByPartNr.ContainsKey(pn) Then
        a = colorByPartNr(pn)
      Else
        a = CreateRandomColorAsset(doc, rng)
        colorByPartNr.Add(pn, a)
      End If

      ' Apply appearance to the occurrence (does not modify the source IPT)
      leaf.Appearance = a
    Next

    trans.End()
  End Sub

  Private Function CreateRandomColorAsset(doc As AssemblyDocument, rng As System.Random) As Asset
    ' Create a document-level Appearance based on "Generic"
    Dim asset As Asset = doc.Assets.Add(AssetTypeEnum.kAssetTypeAppearance, "Generic", "appearances")

    ' Random diffuse color
    Dim r As Integer = rng.Next(0, 256)
    Dim g As Integer = rng.Next(0, 256)
    Dim b As Integer = rng.Next(0, 256)

    ' Set color (handle common key names)
    Dim diffuse As ColorAssetValue = Nothing
    Try
      diffuse = TryCast(asset.Item("generic_diffuse"), ColorAssetValue)
    Catch
    End Try
    If diffuse Is Nothing Then
      Try
        diffuse = TryCast(asset.Item("DiffuseColor"), ColorAssetValue)
      Catch
      End Try
    End If
    If diffuse IsNot Nothing Then
      diffuse.Value = ThisApplication.TransientObjects.CreateColor(r, g, b)
    End If

    Return asset
  End Function

  Private Function GetPartNumber(occ As ComponentOccurrence) As String
    ' Use the referenced document’s Part Number so identical parts share a color
    Dim refDoc As Document = occ.Definition.Document
    Try
      Dim ps As PropertySet = refDoc.PropertySets.Item("Design Tracking Properties")
      Dim p As [Property] = ps.Item("Part Number")
      Return CStr(p.Value)
    Catch
      ' Fallback to occurrence name if property missing (e.g., virtual components)
      Return occ.Name
    End Try
  End Function

  Private Sub SetDesignViewRepresentation(doc As AssemblyDocument)
    Dim mgr As RepresentationsManager = doc.ComponentDefinition.RepresentationsManager
    Dim rep As DesignViewRepresentation = Nothing
    Try
      rep = mgr.DesignViewRepresentations("Unique Colors")
    Catch
      rep = mgr.DesignViewRepresentations.Add("Unique Colors")
    End Try
    rep.Activate()
  End Sub

End Class
```

#### Code Block 2

```vb
' iLogic: Color each LEAF PART occurrence by its Part Number (drills into subassemblies)
Public Class ThisRule

  Sub Main()
    Dim doc As AssemblyDocument = ThisDoc.Document
    Dim trans As Transaction = ThisApplication.TransactionManager.StartTransaction(doc, "Unique Colors by Leaf Part Number")

    SetDesignViewRepresentation(doc)

    Dim colorByPartNr As New Dictionary(Of String, Asset)
    Dim rng As New System.Random()

    ' Iterate only real parts (leaf occurrences), not subassemblies
    For Each leaf As ComponentOccurrence In doc.ComponentDefinition.Occurrences.AllLeafOccurrences
      If leaf Is Nothing Then Continue For

      Dim pn As String = GetPartNumber(leaf)
      If String.IsNullOrWhiteSpace(pn) Then Continue For

      Dim a As Asset = Nothing
      If colorByPartNr.ContainsKey(pn) Then
        a = colorByPartNr(pn)
      Else
        a = CreateRandomColorAsset(doc, rng)
        colorByPartNr.Add(pn, a)
      End If

      ' Apply appearance to the occurrence (does not modify the source IPT)
      leaf.Appearance = a
    Next

    trans.End()
  End Sub

  Private Function CreateRandomColorAsset(doc As AssemblyDocument, rng As System.Random) As Asset
    ' Create a document-level Appearance based on "Generic"
    Dim asset As Asset = doc.Assets.Add(AssetTypeEnum.kAssetTypeAppearance, "Generic", "appearances")

    ' Random diffuse color
    Dim r As Integer = rng.Next(0, 256)
    Dim g As Integer = rng.Next(0, 256)
    Dim b As Integer = rng.Next(0, 256)

    ' Set color (handle common key names)
    Dim diffuse As ColorAssetValue = Nothing
    Try
      diffuse = TryCast(asset.Item("generic_diffuse"), ColorAssetValue)
    Catch
    End Try
    If diffuse Is Nothing Then
      Try
        diffuse = TryCast(asset.Item("DiffuseColor"), ColorAssetValue)
      Catch
      End Try
    End If
    If diffuse IsNot Nothing Then
      diffuse.Value = ThisApplication.TransientObjects.CreateColor(r, g, b)
    End If

    Return asset
  End Function

  Private Function GetPartNumber(occ As ComponentOccurrence) As String
    ' Use the referenced document’s Part Number so identical parts share a color
    Dim refDoc As Document = occ.Definition.Document
    Try
      Dim ps As PropertySet = refDoc.PropertySets.Item("Design Tracking Properties")
      Dim p As [Property] = ps.Item("Part Number")
      Return CStr(p.Value)
    Catch
      ' Fallback to occurrence name if property missing (e.g., virtual components)
      Return occ.Name
    End Try
  End Function

  Private Sub SetDesignViewRepresentation(doc As AssemblyDocument)
    Dim mgr As RepresentationsManager = doc.ComponentDefinition.RepresentationsManager
    Dim rep As DesignViewRepresentation = Nothing
    Try
      rep = mgr.DesignViewRepresentations("Unique Colors")
    Catch
      rep = mgr.DesignViewRepresentations.Add("Unique Colors")
    End Try
    rep.Activate()
  End Sub

End Class
```

#### Code Block 3

```vb
Sub main
	On Error Resume Next
	Dim view_repr_name = "color_coding"
	Dim  custom_iproperty_name As String ="s_length"
	Dim color_dictionary As New Dictionary(Of String, String) From {
 {"1000 mm",  "xYellow;255;255;0"},
 {"1100 mm",  "xRed;255;0;0"},
 {"1200 mm", "xBlue;0;0;255" }}
 If ThisApplication.ActiveDocumentType =DocumentTypeEnum.kPartDocumentObject Then
	Dim pdoc As PartDocument = ThisDoc.Document
	If color_dictionary.ContainsKey(pdoc.PropertySets(4)(custom_iproperty_name).Value) Then
		Dim name As String=""
		Dim  R, G, B  As Integer
		name = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(0)
		R = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(1)
		G = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(2)
		B = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value),";")(3)
		Call GetColorAsset(pdoc,view_repr_name, name, R, G, B)
	End If
ElseIf ThisApplication.ActiveDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
	Dim ass As AssemblyDocument =ThisApplication.ActiveDocument
	Dim check As String = ""
		check=ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Name 
		If check = view_repr_name Then
			ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Activate 
		Else
			ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations.Add(view_repr_name).Activate 
		End If
		For Each occ As ComponentOccurrence In ass.ComponentDefinition.Occurrences
			If occ.DefinitionDocumentType<>DocumentTypeEnum.kPartDocumentObject Then Continue For
			Dim pdoc As PartDocument = occ.Definition.Document
			If color_dictionary.ContainsKey(pdoc.PropertySets(4)(custom_iproperty_name).Value) Then
				Dim name As String
				Dim  R, G, B  As Integer
				name = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(0)
				R = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(1)
				G = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(2)
				B = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value),";")(3)
				Call GetColorAsset(pdoc,view_repr_name, name, R, G, B)
				occ.SetDesignViewRepresentation(view_repr_name,, True)
			End If
			
		Next
End If

End Sub
 Function GetColorAsset(doc As PartDocument,view_repr_name As String, name As String, R As Integer, G As Integer, B As Integer) As Asset
Dim Asset As Asset=Nothing
	Try
		Asset = doc.Assets.Add(AssetTypeEnum.kAssetTypeAppearance, "Generic", , name)

	Catch ex As Exception
		Try
			Asset = doc.Assets.Item(name)
		Catch ex1 As Exception
			doc.Rebuild()
			doc.Update()
			Try
				Asset = doc.Assets.Add(AssetTypeEnum.kAssetTypeAppearance, "Generic", , name)
			Catch ex2 As Exception
			End Try
		End Try
	End Try
Dim uColor As ColorAssetValue = Asset.Item("generic_diffuse")
Dim clr As Inventor.Color = ThisApplication.TransientObjects.CreateColor(R, G, B)
uColor.Value = clr
check  = ""
Try
check = doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Name 
Catch ex As Exception
End Try
If check = view_repr_name Then
	doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Activate 
Else
	doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations.Add(view_repr_name).Activate 
End If
Try
doc.ActiveAppearance = Asset
Catch ex As Exception
End Try
doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(1).Activate
doc.Save		
End Function
```

#### Code Block 4

```vb
Sub main
	On Error Resume Next
	Dim view_repr_name = "color_coding"
	Dim  custom_iproperty_name As String ="s_length"
	Dim color_dictionary As New Dictionary(Of String, String) From {
 {"1000 mm",  "xYellow;255;255;0"},
 {"1100 mm",  "xRed;255;0;0"},
 {"1200 mm", "xBlue;0;0;255" }}
 If ThisApplication.ActiveDocumentType =DocumentTypeEnum.kPartDocumentObject Then
	Dim pdoc As PartDocument = ThisDoc.Document
	If color_dictionary.ContainsKey(pdoc.PropertySets(4)(custom_iproperty_name).Value) Then
		Dim name As String=""
		Dim  R, G, B  As Integer
		name = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(0)
		R = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(1)
		G = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(2)
		B = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value),";")(3)
		Call GetColorAsset(pdoc,view_repr_name, name, R, G, B)
	End If
ElseIf ThisApplication.ActiveDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
	Dim ass As AssemblyDocument =ThisApplication.ActiveDocument
	Dim check As String = ""
		check=ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Name 
		If check = view_repr_name Then
			ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Activate 
		Else
			ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations.Add(view_repr_name).Activate 
		End If
		For Each occ As ComponentOccurrence In ass.ComponentDefinition.Occurrences
			If occ.DefinitionDocumentType<>DocumentTypeEnum.kPartDocumentObject Then Continue For
			Dim pdoc As PartDocument = occ.Definition.Document
			If color_dictionary.ContainsKey(pdoc.PropertySets(4)(custom_iproperty_name).Value) Then
				Dim name As String
				Dim  R, G, B  As Integer
				name = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(0)
				R = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(1)
				G = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(2)
				B = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value),";")(3)
				Call GetColorAsset(pdoc,view_repr_name, name, R, G, B)
				occ.SetDesignViewRepresentation(view_repr_name,, True)
			End If
			
		Next
End If

End Sub
 Function GetColorAsset(doc As PartDocument,view_repr_name As String, name As String, R As Integer, G As Integer, B As Integer) As Asset
Dim Asset As Asset=Nothing
	Try
		Asset = doc.Assets.Add(AssetTypeEnum.kAssetTypeAppearance, "Generic", , name)

	Catch ex As Exception
		Try
			Asset = doc.Assets.Item(name)
		Catch ex1 As Exception
			doc.Rebuild()
			doc.Update()
			Try
				Asset = doc.Assets.Add(AssetTypeEnum.kAssetTypeAppearance, "Generic", , name)
			Catch ex2 As Exception
			End Try
		End Try
	End Try
Dim uColor As ColorAssetValue = Asset.Item("generic_diffuse")
Dim clr As Inventor.Color = ThisApplication.TransientObjects.CreateColor(R, G, B)
uColor.Value = clr
check  = ""
Try
check = doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Name 
Catch ex As Exception
End Try
If check = view_repr_name Then
	doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Activate 
Else
	doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations.Add(view_repr_name).Activate 
End If
Try
doc.ActiveAppearance = Asset
Catch ex As Exception
End Try
doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(1).Activate
doc.Save		
End Function
```

#### Code Block 5

```vb
Sub main
	On Error Resume Next
	Dim view_repr_name = "color_coding"
	Dim  custom_iproperty_name As String ="s_length"
	Dim color_dictionary As New Dictionary(Of String, String) From {
 {"1000 mm",  "xYellow;255;255;0"},
 {"1100 mm",  "xRed;255;0;0"},
 {"1200 mm", "xBlue;0;0;255" }}
 If ThisApplication.ActiveDocumentType =DocumentTypeEnum.kPartDocumentObject Then
	Dim pdoc As PartDocument = ThisDoc.Document
	If color_dictionary.ContainsKey(pdoc.PropertySets(4)(custom_iproperty_name).Value) Then
		Dim name As String=""
		Dim  R, G, B  As Integer
		name = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(0)
		R = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(1)
		G = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(2)
		B = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value),";")(3)
		Call GetColorAsset(pdoc,view_repr_name, name, R, G, B)
	End If
ElseIf ThisApplication.ActiveDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
	Dim ass As AssemblyDocument =ThisApplication.ActiveDocument
	Dim check As String = ""
		check=ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Name 
		If check = view_repr_name Then
			ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Activate 
		Else
			ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations.Add(view_repr_name).Activate 
		End If
		For Each occ As ComponentOccurrence In ass.ComponentDefinition.Occurrences
			If occ.DefinitionDocumentType<>DocumentTypeEnum.kPartDocumentObject Then Continue For
			Dim pdoc As PartDocument = occ.Definition.Document
			If color_dictionary.ContainsKey(pdoc.PropertySets(4)(custom_iproperty_name).Value) Then
				Dim name As String
				Dim  R, G, B  As Integer
				name = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(0)
				R = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(1)
				G = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(2)
				B = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value),";")(3)
				Call GetColorAsset(pdoc,view_repr_name, name, R, G, B)
				occ.SetDesignViewRepresentation(view_repr_name,, True)
			End If
			
		Next
End If

End Sub
 Function GetColorAsset(doc As PartDocument,view_repr_name As String, name As String, R As Integer, G As Integer, B As Integer) As Asset
Dim Asset As Asset=Nothing
	Try
		Asset = doc.Assets.Add(AssetTypeEnum.kAssetTypeAppearance, "Generic", , name)

	Catch ex As Exception
		Try
			Asset = doc.Assets.Item(name)
		Catch ex1 As Exception
			doc.Rebuild()
			doc.Update()
			Try
				Asset = doc.Assets.Add(AssetTypeEnum.kAssetTypeAppearance, "Generic", , name)
			Catch ex2 As Exception
			End Try
		End Try
	End Try
Dim uColor As ColorAssetValue = Asset.Item("generic_diffuse")
Dim clr As Inventor.Color = ThisApplication.TransientObjects.CreateColor(R, G, B)
uColor.Value = clr
check  = ""
Try
check = doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Name 
Catch ex As Exception
End Try
If check = view_repr_name Then
	doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Activate 
Else
	doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations.Add(view_repr_name).Activate 
End If
Try
doc.ActiveAppearance = Asset
Catch ex As Exception
End Try
doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(1).Activate
doc.Save		
End Function
```

#### Code Block 6

```vb
Sub main
	On Error Resume Next
	Dim view_repr_name = "color_coding"
	Dim  custom_iproperty_name As String ="s_length"
	Dim color_dictionary As New Dictionary(Of String, String) From {
 {"1000 mm",  "xYellow;255;255;0"},
 {"1100 mm",  "xRed;255;0;0"},
 {"1200 mm", "xBlue;0;0;255" }}
 If ThisApplication.ActiveDocumentType =DocumentTypeEnum.kPartDocumentObject Then
	Dim pdoc As PartDocument = ThisDoc.Document
	If color_dictionary.ContainsKey(pdoc.PropertySets(4)(custom_iproperty_name).Value) Then
		Dim name As String=""
		Dim  R, G, B  As Integer
		name = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(0)
		R = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(1)
		G = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(2)
		B = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value),";")(3)
		Call GetColorAsset(pdoc,view_repr_name, name, R, G, B)
	End If
ElseIf ThisApplication.ActiveDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
	Dim ass As AssemblyDocument =ThisApplication.ActiveDocument
	Dim check As String = ""
		check=ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Name 
		If check = view_repr_name Then
			ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Activate 
		Else
			ass.ComponentDefinition.RepresentationsManager.DesignViewRepresentations.Add(view_repr_name).Activate 
		End If
		For Each occ As ComponentOccurrence In ass.ComponentDefinition.Occurrences
			If occ.DefinitionDocumentType<>DocumentTypeEnum.kPartDocumentObject Then Continue For
			Dim pdoc As PartDocument = occ.Definition.Document
			If color_dictionary.ContainsKey(pdoc.PropertySets(4)(custom_iproperty_name).Value) Then
				Dim name As String
				Dim  R, G, B  As Integer
				name = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(0)
				R = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(1)
				G = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value), ";")(2)
				B = Split(color_dictionary(pdoc.PropertySets(4)(custom_iproperty_name).Value),";")(3)
				Call GetColorAsset(pdoc,view_repr_name, name, R, G, B)
				occ.SetDesignViewRepresentation(view_repr_name,, True)
			End If
			
		Next
End If

End Sub
 Function GetColorAsset(doc As PartDocument,view_repr_name As String, name As String, R As Integer, G As Integer, B As Integer) As Asset
Dim Asset As Asset=Nothing
	Try
		Asset = doc.Assets.Add(AssetTypeEnum.kAssetTypeAppearance, "Generic", , name)

	Catch ex As Exception
		Try
			Asset = doc.Assets.Item(name)
		Catch ex1 As Exception
			doc.Rebuild()
			doc.Update()
			Try
				Asset = doc.Assets.Add(AssetTypeEnum.kAssetTypeAppearance, "Generic", , name)
			Catch ex2 As Exception
			End Try
		End Try
	End Try
Dim uColor As ColorAssetValue = Asset.Item("generic_diffuse")
Dim clr As Inventor.Color = ThisApplication.TransientObjects.CreateColor(R, G, B)
uColor.Value = clr
check  = ""
Try
check = doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Name 
Catch ex As Exception
End Try
If check = view_repr_name Then
	doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(view_repr_name).Activate 
Else
	doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations.Add(view_repr_name).Activate 
End If
Try
doc.ActiveAppearance = Asset
Catch ex As Exception
End Try
doc.ComponentDefinition.RepresentationsManager.DesignViewRepresentations(1).Activate
doc.Save		
End Function
```

---

### 35. Combine steps in one feature

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/combine-steps-in-one-feature/td-p/13799124#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/combine-steps-in-one-feature/td-p/13799124#messageview_0)

**Author:** Mustafa.Salaheldin

**Date:** ‎09-05-2025
	
		
		09:24 PM

**Description:** HelloI am new to Inventor, and I want to combine multiple features in one node in the model browser.I have created a clientfeature called DuPod Feature1, and I want all the following steps (from Work Point 2 until Split 1) to be merged under this node.I am using Inventor 2026 and C# .Net 8.    					...

**Code Snippets (2):**

#### Code Block 1

```vb
void Main()
{
    var part = ThisApplication.ActiveDocument as PartDocument;

    var compDef = part.ComponentDefinition;

    //Assumes there are at least two surface bodies in the part
    var body1 = compDef.SurfaceBodies[1];
    var body2 = compDef.SurfaceBodies[2];

    //Crate model features which should be combined in ClientFeature
    var workPoint1 = compDef.WorkPoints.AddFixed(
        ThisApplication.TransientGeometry.CreatePoint(0, 0, 0)
    );
    var workPoint2 = compDef.WorkPoints.AddFixed(
        ThisApplication.TransientGeometry.CreatePoint(0, 0, 0.5)
    );

    var workAxis1 = compDef.WorkAxes.AddByTwoPoints(workPoint1, workPoint2);

    //Keep input work points at the root of the model tree.
    workAxis1.ConsumeInputs = false;

    var workPlane1 = compDef.WorkPlanes.AddByLineAndPoint(workAxis1, workPoint2);

    var toolBodies = ThisApplication.TransientObjects.CreateObjectCollection();
    toolBodies.Add(body2);
    var combineFeature1 = compDef.Features.CombineFeatures.Add(body1, toolBodies, PartFeatureOperationEnum.kJoinOperation);

    var body3 = combineFeature1.SurfaceBody;
    var splitFeature1 = compDef.Features.SplitFeatures.SplitBody(workPlane1, body3);

    //Create ClientFeature
    var clientFeatureDefinition = compDef.Features.ClientFeatures.CreateDefinition(
        "SampleFeature",
        workPoint1,
        splitFeature1,
        null
    );
    compDef.Features.ClientFeatures.Add(clientFeatureDefinition, "YOUR-ADDIN-CLSID-GUID-HERE");
}
```

#### Code Block 2

```vb
void Main()
{
    var part = ThisApplication.ActiveDocument as PartDocument;

    var compDef = part.ComponentDefinition;

    //Assumes there are at least two surface bodies in the part
    var body1 = compDef.SurfaceBodies[1];
    var body2 = compDef.SurfaceBodies[2];

    //Crate model features which should be combined in ClientFeature
    var workPoint1 = compDef.WorkPoints.AddFixed(
        ThisApplication.TransientGeometry.CreatePoint(0, 0, 0)
    );
    var workPoint2 = compDef.WorkPoints.AddFixed(
        ThisApplication.TransientGeometry.CreatePoint(0, 0, 0.5)
    );

    var workAxis1 = compDef.WorkAxes.AddByTwoPoints(workPoint1, workPoint2);

    //Keep input work points at the root of the model tree.
    workAxis1.ConsumeInputs = false;

    var workPlane1 = compDef.WorkPlanes.AddByLineAndPoint(workAxis1, workPoint2);

    var toolBodies = ThisApplication.TransientObjects.CreateObjectCollection();
    toolBodies.Add(body2);
    var combineFeature1 = compDef.Features.CombineFeatures.Add(body1, toolBodies, PartFeatureOperationEnum.kJoinOperation);

    var body3 = combineFeature1.SurfaceBody;
    var splitFeature1 = compDef.Features.SplitFeatures.SplitBody(workPlane1, body3);

    //Create ClientFeature
    var clientFeatureDefinition = compDef.Features.ClientFeatures.CreateDefinition(
        "SampleFeature",
        workPoint1,
        splitFeature1,
        null
    );
    compDef.Features.ClientFeatures.Add(clientFeatureDefinition, "YOUR-ADDIN-CLSID-GUID-HERE");
}
```

#### Code Block 3

```vb
void Main()
{
    var part = ThisApplication.ActiveDocument as PartDocument;

    var compDef = part.ComponentDefinition;

    //Assumes there are at least two surface bodies in the part
    var body1 = compDef.SurfaceBodies[1];
    var body2 = compDef.SurfaceBodies[2];

    //Crate model features which should be combined in ClientFeature
    var workPoint1 = compDef.WorkPoints.AddFixed(
        ThisApplication.TransientGeometry.CreatePoint(0, 0, 0)
    );
    var workPoint2 = compDef.WorkPoints.AddFixed(
        ThisApplication.TransientGeometry.CreatePoint(0, 0, 0.5)
    );

    var workAxis1 = compDef.WorkAxes.AddByTwoPoints(workPoint1, workPoint2);

    //Keep input work points at the root of the model tree.
    workAxis1.ConsumeInputs = false;

    var workPlane1 = compDef.WorkPlanes.AddByLineAndPoint(workAxis1, workPoint2);

    var toolBodies = ThisApplication.TransientObjects.CreateObjectCollection();
    toolBodies.Add(body2);
    var combineFeature1 = compDef.Features.CombineFeatures.Add(body1, toolBodies, PartFeatureOperationEnum.kJoinOperation);

    var body3 = combineFeature1.SurfaceBody;
    var splitFeature1 = compDef.Features.SplitFeatures.SplitBody(workPlane1, body3);

    //Create ClientFeature
    var clientFeatureDefinition = compDef.Features.ClientFeatures.CreateDefinition(
        "SampleFeature",
        workPoint1,
        splitFeature1,
        null
    );
    compDef.Features.ClientFeatures.Add(clientFeatureDefinition, "YOUR-ADDIN-CLSID-GUID-HERE");
}
```

#### Code Block 4

```vb
void Main()
{
    var part = ThisApplication.ActiveDocument as PartDocument;

    var compDef = part.ComponentDefinition;

    //Assumes there are at least two surface bodies in the part
    var body1 = compDef.SurfaceBodies[1];
    var body2 = compDef.SurfaceBodies[2];

    //Crate model features which should be combined in ClientFeature
    var workPoint1 = compDef.WorkPoints.AddFixed(
        ThisApplication.TransientGeometry.CreatePoint(0, 0, 0)
    );
    var workPoint2 = compDef.WorkPoints.AddFixed(
        ThisApplication.TransientGeometry.CreatePoint(0, 0, 0.5)
    );

    var workAxis1 = compDef.WorkAxes.AddByTwoPoints(workPoint1, workPoint2);

    //Keep input work points at the root of the model tree.
    workAxis1.ConsumeInputs = false;

    var workPlane1 = compDef.WorkPlanes.AddByLineAndPoint(workAxis1, workPoint2);

    var toolBodies = ThisApplication.TransientObjects.CreateObjectCollection();
    toolBodies.Add(body2);
    var combineFeature1 = compDef.Features.CombineFeatures.Add(body1, toolBodies, PartFeatureOperationEnum.kJoinOperation);

    var body3 = combineFeature1.SurfaceBody;
    var splitFeature1 = compDef.Features.SplitFeatures.SplitBody(workPlane1, body3);

    //Create ClientFeature
    var clientFeatureDefinition = compDef.Features.ClientFeatures.CreateDefinition(
        "SampleFeature",
        workPoint1,
        splitFeature1,
        null
    );
    compDef.Features.ClientFeatures.Add(clientFeatureDefinition, "YOUR-ADDIN-CLSID-GUID-HERE");
}
```

---

### 36. Converting an Inventor .ipt model into Ghost / Reference Geometry using ClientGraphics.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/converting-an-inventor-ipt-model-into-ghost-reference-geometry/td-p/13842968#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/converting-an-inventor-ipt-model-into-ghost-reference-geometry/td-p/13842968#messageview_0)

**Author:** anil_dangi

**Date:** ‎10-08-2025
	
		
		12:52 AM

**Description:** Create a purely graphical clone of the model’s shape that looks identical, but does not exist as B-Rep or features, and has no interaction in the modeling environment.SO how should I do it? 					 				 			 			 				 			 			 				 	 			 				 					 						Solved! 					 					Go to Solution.

**Code Snippets (4):**

#### Code Block 1

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(oInvApp.ActiveDocument, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	Dim oGDSC As Inventor.GraphicsDataSetsCollection
	Try : oGDSC = oPDoc.GraphicsDataSetsCollection : Catch : End Try
	If oGDSC IsNot Nothing AndAlso oGDSC.Count > 0 Then
		For Each oGDS As Inventor.GraphicsDataSets In oGDSC
			Try
				oGDS.Delete()
			Catch ex As Exception
				Logger.Error(ex.ToString())
			End Try
		Next
	End If
	Dim oNTCGColl As ClientGraphicsCollection = oPDoc.NonTransactingClientGraphicsCollection
	For Each oCG As Inventor.ClientGraphics In oNTCGColl
		Try
			oCG.Delete()
		Catch ex As Exception
			Logger.Error(ex.ToString())
		End Try
	Next
	Dim oCGColl As Inventor.ClientGraphicsCollection = oPDoc.ComponentDefinition.ClientGraphicsCollection
	If oCGColl IsNot Nothing AndAlso oCGColl.Count > 0 Then
		For Each oCG As Inventor.ClientGraphics In oCGColl
			Try
				oCG.Delete()
			Catch ex As Exception
				Logger.Error(ex.ToString())
			End Try
		Next
	End If
	oInvApp.ActiveView.Update()
End Sub
```

#### Code Block 2

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(oInvApp.ActiveDocument, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	Dim oGDSC As Inventor.GraphicsDataSetsCollection
	Try : oGDSC = oPDoc.GraphicsDataSetsCollection : Catch : End Try
	If oGDSC IsNot Nothing AndAlso oGDSC.Count > 0 Then
		For Each oGDS As Inventor.GraphicsDataSets In oGDSC
			Try
				oGDS.Delete()
			Catch ex As Exception
				Logger.Error(ex.ToString())
			End Try
		Next
	End If
	Dim oNTCGColl As ClientGraphicsCollection = oPDoc.NonTransactingClientGraphicsCollection
	For Each oCG As Inventor.ClientGraphics In oNTCGColl
		Try
			oCG.Delete()
		Catch ex As Exception
			Logger.Error(ex.ToString())
		End Try
	Next
	Dim oCGColl As Inventor.ClientGraphicsCollection = oPDoc.ComponentDefinition.ClientGraphicsCollection
	If oCGColl IsNot Nothing AndAlso oCGColl.Count > 0 Then
		For Each oCG As Inventor.ClientGraphics In oCGColl
			Try
				oCG.Delete()
			Catch ex As Exception
				Logger.Error(ex.ToString())
			End Try
		Next
	End If
	oInvApp.ActiveView.Update()
End Sub
```

#### Code Block 3

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(oInvApp.ActiveDocument, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	Dim oGDSC As Inventor.GraphicsDataSetsCollection
	Try : oGDSC = oPDoc.GraphicsDataSetsCollection : Catch : End Try
	If oGDSC IsNot Nothing AndAlso oGDSC.Count > 0 Then
		For Each oGDS As Inventor.GraphicsDataSets In oGDSC
			Try
				oGDS.Delete()
			Catch ex As Exception
				Logger.Error(ex.ToString())
			End Try
		Next
	End If
	Dim oNTCGColl As ClientGraphicsCollection = oPDoc.NonTransactingClientGraphicsCollection
	For Each oCG As Inventor.ClientGraphics In oNTCGColl
		Try
			oCG.Delete()
		Catch ex As Exception
			Logger.Error(ex.ToString())
		End Try
	Next
	Dim oCGColl As Inventor.ClientGraphicsCollection = oPDoc.ComponentDefinition.ClientGraphicsCollection
	If oCGColl IsNot Nothing AndAlso oCGColl.Count > 0 Then
		For Each oCG As Inventor.ClientGraphics In oCGColl
			Try
				oCG.Delete()
			Catch ex As Exception
				Logger.Error(ex.ToString())
			End Try
		Next
	End If
	oInvApp.ActiveView.Update()
End Sub
```

#### Code Block 4

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(oInvApp.ActiveDocument, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	Dim oGDSC As Inventor.GraphicsDataSetsCollection
	Try : oGDSC = oPDoc.GraphicsDataSetsCollection : Catch : End Try
	If oGDSC IsNot Nothing AndAlso oGDSC.Count > 0 Then
		For Each oGDS As Inventor.GraphicsDataSets In oGDSC
			Try
				oGDS.Delete()
			Catch ex As Exception
				Logger.Error(ex.ToString())
			End Try
		Next
	End If
	Dim oNTCGColl As ClientGraphicsCollection = oPDoc.NonTransactingClientGraphicsCollection
	For Each oCG As Inventor.ClientGraphics In oNTCGColl
		Try
			oCG.Delete()
		Catch ex As Exception
			Logger.Error(ex.ToString())
		End Try
	Next
	Dim oCGColl As Inventor.ClientGraphicsCollection = oPDoc.ComponentDefinition.ClientGraphicsCollection
	If oCGColl IsNot Nothing AndAlso oCGColl.Count > 0 Then
		For Each oCG As Inventor.ClientGraphics In oCGColl
			Try
				oCG.Delete()
			Catch ex As Exception
				Logger.Error(ex.ToString())
			End Try
		Next
	End If
	oInvApp.ActiveView.Update()
End Sub
```

#### Code Block 5

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(oInvApp.ActiveDocument, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	If oPDoc.RequiresUpdate Then oPDoc.Update2(True)
	'get first regular body in this part
	Dim oFirstSBody As SurfaceBody = oPDoc.ComponentDefinition.SurfaceBodies.Item(1)
	'copy it to a 'transient' body (not visible, just mathematical data)
	Dim oCopiedSBody As SurfaceBody = oInvApp.TransientBRep.Copy(oFirstSBody)
	'create a visible, but non-interactive, representation of the cloned body
	Dim oCG As ClientGraphics = oPDoc.NonTransactingClientGraphicsCollection.Add("MySurfaceBodyClone")
	oCG.Visible = True
	Dim oGNode As GraphicsNode = oCG.AddNode(1)
	oGNode.Visible = True
	Dim oSG As SurfaceGraphics = oGNode.AddSurfaceGraphics(oCopiedSBody)
	oInvApp.ActiveView.Update()
End Sub
```

#### Code Block 6

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(oInvApp.ActiveDocument, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	If oPDoc.RequiresUpdate Then oPDoc.Update2(True)
	'get first regular body in this part
	Dim oFirstSBody As SurfaceBody = oPDoc.ComponentDefinition.SurfaceBodies.Item(1)
	'copy it to a 'transient' body (not visible, just mathematical data)
	Dim oCopiedSBody As SurfaceBody = oInvApp.TransientBRep.Copy(oFirstSBody)
	'create a visible, but non-interactive, representation of the cloned body
	Dim oCG As ClientGraphics = oPDoc.NonTransactingClientGraphicsCollection.Add("MySurfaceBodyClone")
	oCG.Visible = True
	Dim oGNode As GraphicsNode = oCG.AddNode(1)
	oGNode.Visible = True
	Dim oSG As SurfaceGraphics = oGNode.AddSurfaceGraphics(oCopiedSBody)
	oInvApp.ActiveView.Update()
End Sub
```

#### Code Block 7

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(oInvApp.ActiveDocument, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	If oPDoc.RequiresUpdate Then oPDoc.Update2(True)
	'get first regular body in this part
	Dim oFirstSBody As SurfaceBody = oPDoc.ComponentDefinition.SurfaceBodies.Item(1)
	'copy it to a 'transient' body (not visible, just mathematical data)
	Dim oCopiedSBody As SurfaceBody = oInvApp.TransientBRep.Copy(oFirstSBody)
	'create a visible, but non-interactive, representation of the cloned body
	Dim oCG As ClientGraphics = oPDoc.NonTransactingClientGraphicsCollection.Add("MySurfaceBodyClone")
	oCG.Visible = True
	Dim oGNode As GraphicsNode = oCG.AddNode(1)
	oGNode.Visible = True
	Dim oSG As SurfaceGraphics = oGNode.AddSurfaceGraphics(oCopiedSBody)
	oInvApp.ActiveView.Update()
End Sub
```

#### Code Block 8

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oPDoc As PartDocument = TryCast(oInvApp.ActiveDocument, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	If oPDoc.RequiresUpdate Then oPDoc.Update2(True)
	'get first regular body in this part
	Dim oFirstSBody As SurfaceBody = oPDoc.ComponentDefinition.SurfaceBodies.Item(1)
	'copy it to a 'transient' body (not visible, just mathematical data)
	Dim oCopiedSBody As SurfaceBody = oInvApp.TransientBRep.Copy(oFirstSBody)
	'create a visible, but non-interactive, representation of the cloned body
	Dim oCG As ClientGraphics = oPDoc.NonTransactingClientGraphicsCollection.Add("MySurfaceBodyClone")
	oCG.Visible = True
	Dim oGNode As GraphicsNode = oCG.AddNode(1)
	oGNode.Visible = True
	Dim oSG As SurfaceGraphics = oGNode.AddSurfaceGraphics(oCopiedSBody)
	oInvApp.ActiveView.Update()
End Sub
```

---

### 37. Could not load System.Data.OleDb (9.0.0.8) in .NET 8 Add-In for Inventor 2025

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/could-not-load-system-data-oledb-9-0-0-8-in-net-8-add-in-for/td-p/13786826](https://forums.autodesk.com/t5/inventor-programming-forum/could-not-load-system-data-oledb-9-0-0-8-in-net-8-add-in-for/td-p/13786826)

**Author:** marlondiego

**Date:** ‎08-28-2025
	
		
		04:48 AM

**Description:** Hello Autodesk community,I’m developing an Inventor 2025 Add-In using .NET 8. My add-in needs to access an Access database (.accdb), and I’m using the System.Data.OleDb NuGet package version 9.0.8: <PackageReference Include="System.Data.OleDb" Version="9.0.8" />After building the project, my post-bu...

**Code Snippets (4):**

#### Code Block 1

```vb
<!-- Copy compiled DLL -->
<Copy SourceFiles="$(TargetPath)" DestinationFolder="C:\ProgramData\Autodesk\Inventor 2025\Addins\" SkipUnchangedFiles="true" />
<!-- Copy .addin file -->
<Copy SourceFiles="$(ProjectDir)Autodesk.MD_PowerTools.Inventor.addin" DestinationFolder="C:\ProgramData\Autodesk\Inventor 2025\Addins\" SkipUnchangedFiles="true" />
```

#### Code Block 2

```vb
<PackageReference Include="System.Data.OleDb" Version="9.0.8" />
```

#### Code Block 3

```vb
Could not load file or assembly 'System.Data.OleDB, Version=9.0.0.8, Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51'.
System could not find the specified file.
```

#### Code Block 4

```vb
using System;
using System.Data.OleDb;

namespace MD_PowerTools.Helpers
{
    public class ProvisionalCodeGenerator
    {
        private static readonly char[] Base36Chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".ToCharArray();
        private static readonly char[] Base26Chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".ToCharArray();

        public int GetUserId(string username) => GetUserIdFromAccess(username);

        public string GenerateCode(int userId)
        {
            string userCode = ToBaseN(userId - 1, Base36Chars, 2);
            DateTime startDate = new DateTime(2025, 1, 1);
            int dayNumber = (DateTime.Now.Date - startDate).Days + 1;
            string dayCode = ToBaseN(dayNumber, Base36Chars, 3);
            int msOfDay = (int)(DateTime.Now - DateTime.Now.Date).TotalMilliseconds;
            string msCode = ToBaseN(msOfDay, Base26Chars, 6);
            return userCode + dayCode + msCode;
        }

        private int GetUserIdFromAccess(string username)
        {
            string connectionString = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=M:\NewPath\tgt_tic_tac.accdb;";
            string query = "SELECT id_usuario FROM t_usuario WHERE username = ?";

            using var connection = new OleDbConnection(connectionString);
            using var command = new OleDbCommand(query, connection);
            command.Parameters.AddWithValue("username", username);

            connection.Open();
            object result = command.ExecuteScalar();
            if (result != null && int.TryParse(result.ToString(), out int id))
                return id;
            else
                throw new Exception("User not found in t_usuario.");
        }

        private static string ToBaseN(long value, char[] alphabet, int length)
        {
            int n = alphabet.Length;
            char[] result = new char[length];
            for (int i = length - 1; i >= 0; i--)
            {
                result[i] = alphabet[(int)(value % n)];
                value /= n;
            }
            return new string(result);
        }
    }
}
```

---

### 38. Create Finish in Assembly with multiple Occurrence of one part - ERROR

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/create-finish-in-assembly-with-multiple-occurrence-of-one-part/td-p/13676200#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/create-finish-in-assembly-with-multiple-occurrence-of-one-part/td-p/13676200#messageview_0)

**Author:** pezidek

**Date:** ‎06-11-2025
	
		
		12:38 AM

**Description:** I'm trying to use the API to create a Finish in a report with multiple occurrences of one part. When I use the IncludeEntities collection with only the first occurrence in the FinishFeatures.CreateDefinition(...) method, everything is fine. If I insert all occurrence into this collection, it ends wi...

**Code Snippets (2):**

#### Code Block 1

```vb
private void CreateFinish()
 {
     Asset oAppearance = null;
     try
     {
         string appearanceName = "Orange"; 
         AssemblyDocument assembly = iApp.ActiveDocument as AssemblyDocument;

         AssetLibrary assetLib = iApp.AssetLibraries["314DE259-5443-4621-BFBD-1730C6CC9AE9"];
         try
         {
             oAppearance = assembly.AppearanceAssets[appearanceName];
         }
         catch
         {
             oAppearance = assetLib.AppearanceAssets[appearanceName].CopyTo(assembly, true);
         }


         ObjectCollection oSurfaceBodyCollection = iApp.TransientObjects.CreateObjectCollection();
         foreach (ComponentOccurrence occ in assembly.ComponentDefinition.Occurrences)
         {
             foreach (SurfaceBodyProxy body in occ.SurfaceBodies)
             {
                 oSurfaceBodyCollection.Add(body);
             }
             //break; // For testing only the first occurrence
         }

         FinishFeatures oFinishFeatures = assembly.ComponentDefinition.Features.FinishFeatures;
         ObjectCollection oExcludedEntities = iApp.TransientObjects.CreateObjectCollection();

         FinishDefinition oFinishDef = oFinishFeatures.CreateDefinition(
             oSurfaceBodyCollection,
             oExcludedEntities,
             FinishTypeEnum.kAppearanceFinishType,
             "Prime/Paint RAL 2008",
             oAppearance);

         // Create finish feature.
         FinishFeature oFinish = oFinishFeatures.Add(oFinishDef);
         oFinish.Name = "Prime/Paint RAL 2008";
         oFinish.Suppressed = true;         
     }
     catch (Exception e)
     {
         MessageBox.Show("Create Finish faild" + System.Environment.NewLine + e.Message,
             "Error",
             MessageBoxButtons.OK,
             MessageBoxIcon.Error);
         return;
     }
 }
```

#### Code Block 2

```vb
private void CreateFinish()
 {
     Asset oAppearance = null;
     try
     {
         string appearanceName = "Orange"; 
         AssemblyDocument assembly = iApp.ActiveDocument as AssemblyDocument;

         AssetLibrary assetLib = iApp.AssetLibraries["314DE259-5443-4621-BFBD-1730C6CC9AE9"];
         try
         {
             oAppearance = assembly.AppearanceAssets[appearanceName];
         }
         catch
         {
             oAppearance = assetLib.AppearanceAssets[appearanceName].CopyTo(assembly, true);
         }


         ObjectCollection oSurfaceBodyCollection = iApp.TransientObjects.CreateObjectCollection();
         foreach (ComponentOccurrence occ in assembly.ComponentDefinition.Occurrences)
         {
             foreach (SurfaceBodyProxy body in occ.SurfaceBodies)
             {
                 oSurfaceBodyCollection.Add(body);
             }
             //break; // For testing only the first occurrence
         }

         FinishFeatures oFinishFeatures = assembly.ComponentDefinition.Features.FinishFeatures;
         ObjectCollection oExcludedEntities = iApp.TransientObjects.CreateObjectCollection();

         FinishDefinition oFinishDef = oFinishFeatures.CreateDefinition(
             oSurfaceBodyCollection,
             oExcludedEntities,
             FinishTypeEnum.kAppearanceFinishType,
             "Prime/Paint RAL 2008",
             oAppearance);

         // Create finish feature.
         FinishFeature oFinish = oFinishFeatures.Add(oFinishDef);
         oFinish.Name = "Prime/Paint RAL 2008";
         oFinish.Suppressed = true;         
     }
     catch (Exception e)
     {
         MessageBox.Show("Create Finish faild" + System.Environment.NewLine + e.Message,
             "Error",
             MessageBoxButtons.OK,
             MessageBoxIcon.Error);
         return;
     }
 }
```

#### Code Block 3

```vb
private void CreateFinish()
 {
     Asset oAppearance = null;
     try
     {
         string appearanceName = "Orange"; 
         AssemblyDocument assembly = iApp.ActiveDocument as AssemblyDocument;

         AssetLibrary assetLib = iApp.AssetLibraries["314DE259-5443-4621-BFBD-1730C6CC9AE9"];
         try
         {
             oAppearance = assembly.AppearanceAssets[appearanceName];
         }
         catch
         {
             oAppearance = assetLib.AppearanceAssets[appearanceName].CopyTo(assembly, true);
         }


         ObjectCollection oSurfaceBodyCollection = iApp.TransientObjects.CreateObjectCollection();
         foreach (ComponentOccurrence occ in assembly.ComponentDefinition.Occurrences)
         {
             foreach (SurfaceBodyProxy body in occ.SurfaceBodies)
             {
                 oSurfaceBodyCollection.Add(body);
             }
             //break; // For testing only the first occurrence
         }

         FinishFeatures oFinishFeatures = assembly.ComponentDefinition.Features.FinishFeatures;
         ObjectCollection oExcludedEntities = iApp.TransientObjects.CreateObjectCollection();

         FinishDefinition oFinishDef = oFinishFeatures.CreateDefinition(
             oSurfaceBodyCollection,
             oExcludedEntities,
             FinishTypeEnum.kAppearanceFinishType,
             "Prime/Paint RAL 2008",
             oAppearance);

         // Create finish feature.
         FinishFeature oFinish = oFinishFeatures.Add(oFinishDef);
         oFinish.Name = "Prime/Paint RAL 2008";
         oFinish.Suppressed = true;         
     }
     catch (Exception e)
     {
         MessageBox.Show("Create Finish faild" + System.Environment.NewLine + e.Message,
             "Error",
             MessageBoxButtons.OK,
             MessageBoxIcon.Error);
         return;
     }
 }
```

#### Code Block 4

```vb
private void CreateFinish()
 {
     Asset oAppearance = null;
     try
     {
         string appearanceName = "Orange"; 
         AssemblyDocument assembly = iApp.ActiveDocument as AssemblyDocument;

         AssetLibrary assetLib = iApp.AssetLibraries["314DE259-5443-4621-BFBD-1730C6CC9AE9"];
         try
         {
             oAppearance = assembly.AppearanceAssets[appearanceName];
         }
         catch
         {
             oAppearance = assetLib.AppearanceAssets[appearanceName].CopyTo(assembly, true);
         }


         ObjectCollection oSurfaceBodyCollection = iApp.TransientObjects.CreateObjectCollection();
         foreach (ComponentOccurrence occ in assembly.ComponentDefinition.Occurrences)
         {
             foreach (SurfaceBodyProxy body in occ.SurfaceBodies)
             {
                 oSurfaceBodyCollection.Add(body);
             }
             //break; // For testing only the first occurrence
         }

         FinishFeatures oFinishFeatures = assembly.ComponentDefinition.Features.FinishFeatures;
         ObjectCollection oExcludedEntities = iApp.TransientObjects.CreateObjectCollection();

         FinishDefinition oFinishDef = oFinishFeatures.CreateDefinition(
             oSurfaceBodyCollection,
             oExcludedEntities,
             FinishTypeEnum.kAppearanceFinishType,
             "Prime/Paint RAL 2008",
             oAppearance);

         // Create finish feature.
         FinishFeature oFinish = oFinishFeatures.Add(oFinishDef);
         oFinish.Name = "Prime/Paint RAL 2008";
         oFinish.Suppressed = true;         
     }
     catch (Exception e)
     {
         MessageBox.Show("Create Finish faild" + System.Environment.NewLine + e.Message,
             "Error",
             MessageBoxButtons.OK,
             MessageBoxIcon.Error);
         return;
     }
 }
```

---

### 39. Create Model States using iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/create-model-states-using-ilogic/td-p/10714694](https://forums.autodesk.com/t5/inventor-programming-forum/create-model-states-using-ilogic/td-p/10714694)

**Author:** zoe.baker-bushby

**Date:** ‎10-26-2021
	
		
		07:41 AM

**Description:** I have an assembly that has a duplication of the same part. The part has only the master model state, but I want to be able to add model states to this part via ilogic. This line creates model states at the assembly level (which I don't need).oModelState = oDoc.ComponentDefinition.ModelStates.Add(oN...

**Code Snippets (28):**

#### Code Block 1

```vb
'just using a dummy variable here,
'to preserve automation/triggering behavior of unquoted local parameter
oDV = ManwayType

'get the 'local' part document object (the document this rule is saved within)
Dim oPDoc As PartDocument = ThisDoc.Document
oPDef = oPDoc.ComponentDefinition

'if the parameter is numerical, and not unit-less,
'this will return 'database units' version of the parameter's Value,
'not the 'document units' version of it
'oManwayType = oPDef.Parameters.Item("ManwayType").Value

oDocName = ThisDoc.FileName(True)

'these two will get the 'document units' version of the parameter's Value
'oManwayType = ManwayType 'unquoted parameter name
oManwayType = Parameter(oDocName, "ManwayType")

oFeats = oPDef.Features

If oManwayType = 600 Then
	oFeats.Item("MWAY600 Centre").Suppressed = False
	oFeats.Item("MWAY600 Holes").Suppressed = False
	oFeats.Item("MWAY600 PCD").Suppressed = False
	oFeats.Item("MWAY800 Centre").Suppressed = True
	oFeats.Item("MWAY800 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
	oFeats.Item("MWAY900 Centre").Suppressed = True
	oFeats.Item("MWAY900 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
ElseIf oManwayType = 800 Then
	oFeats.Item("MWAY800 Centre").Suppressed = False
	oFeats.Item("MWAY800 Holes").Suppressed = False
	oFeats.Item("MWAY800 PCD").Suppressed = False
	oFeats.Item("MWAY600 Centre").Suppressed = True
	oFeats.Item("MWAY600 Holes").Suppressed = True
	oFeats.Item("MWAY600 PCD").Suppressed = True
	oFeats.Item("MWAY900 Centre").Suppressed = True
	oFeats.Item("MWAY900 Holes").Suppressed = True
	oFeats.Item("MWAY900 PCD").Suppressed = True
ElseIf oManwayType = 900 Then
	oFeats.Item("MWAY900 Centre").Suppressed = False
	oFeats.Item("MWAY900 Holes").Suppressed = False
	oFeats.Item("MWAY900 PCD").Suppressed = False
	oFeats.Item("MWAY800 Centre").Suppressed = True
	oFeats.Item("MWAY800 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
	oFeats.Item("MWAY600 Centre").Suppressed = True
	oFeats.Item("MWAY600 Holes").Suppressed = True
	oFeats.Item("MWAY600 PCD").Suppressed = True
End If

oPDoc.Update
```

#### Code Block 2

```vb
'just using a dummy variable here,
'to preserve automation/triggering behavior of unquoted local parameter
oDV = ManwayType

'get the 'local' part document object (the document this rule is saved within)
Dim oPDoc As PartDocument = ThisDoc.Document
oPDef = oPDoc.ComponentDefinition

'if the parameter is numerical, and not unit-less,
'this will return 'database units' version of the parameter's Value,
'not the 'document units' version of it
'oManwayType = oPDef.Parameters.Item("ManwayType").Value

oDocName = ThisDoc.FileName(True)

'these two will get the 'document units' version of the parameter's Value
'oManwayType = ManwayType 'unquoted parameter name
oManwayType = Parameter(oDocName, "ManwayType")

oFeats = oPDef.Features

If oManwayType = 600 Then
	oFeats.Item("MWAY600 Centre").Suppressed = False
	oFeats.Item("MWAY600 Holes").Suppressed = False
	oFeats.Item("MWAY600 PCD").Suppressed = False
	oFeats.Item("MWAY800 Centre").Suppressed = True
	oFeats.Item("MWAY800 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
	oFeats.Item("MWAY900 Centre").Suppressed = True
	oFeats.Item("MWAY900 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
ElseIf oManwayType = 800 Then
	oFeats.Item("MWAY800 Centre").Suppressed = False
	oFeats.Item("MWAY800 Holes").Suppressed = False
	oFeats.Item("MWAY800 PCD").Suppressed = False
	oFeats.Item("MWAY600 Centre").Suppressed = True
	oFeats.Item("MWAY600 Holes").Suppressed = True
	oFeats.Item("MWAY600 PCD").Suppressed = True
	oFeats.Item("MWAY900 Centre").Suppressed = True
	oFeats.Item("MWAY900 Holes").Suppressed = True
	oFeats.Item("MWAY900 PCD").Suppressed = True
ElseIf oManwayType = 900 Then
	oFeats.Item("MWAY900 Centre").Suppressed = False
	oFeats.Item("MWAY900 Holes").Suppressed = False
	oFeats.Item("MWAY900 PCD").Suppressed = False
	oFeats.Item("MWAY800 Centre").Suppressed = True
	oFeats.Item("MWAY800 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
	oFeats.Item("MWAY600 Centre").Suppressed = True
	oFeats.Item("MWAY600 Holes").Suppressed = True
	oFeats.Item("MWAY600 PCD").Suppressed = True
End If

oPDoc.Update
```

#### Code Block 3

```vb
'just using a dummy variable here,
'to preserve automation/triggering behavior of unquoted local parameter
oDV = ManwayType

'get the 'local' part document object (the document this rule is saved within)
Dim oPDoc As PartDocument = ThisDoc.Document
oPDef = oPDoc.ComponentDefinition

'if the parameter is numerical, and not unit-less,
'this will return 'database units' version of the parameter's Value,
'not the 'document units' version of it
'oManwayType = oPDef.Parameters.Item("ManwayType").Value

oDocName = ThisDoc.FileName(True)

'these two will get the 'document units' version of the parameter's Value
'oManwayType = ManwayType 'unquoted parameter name
oManwayType = Parameter(oDocName, "ManwayType")

oFeats = oPDef.Features

If oManwayType = 600 Then
	oFeats.Item("MWAY600 Centre").Suppressed = False
	oFeats.Item("MWAY600 Holes").Suppressed = False
	oFeats.Item("MWAY600 PCD").Suppressed = False
	oFeats.Item("MWAY800 Centre").Suppressed = True
	oFeats.Item("MWAY800 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
	oFeats.Item("MWAY900 Centre").Suppressed = True
	oFeats.Item("MWAY900 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
ElseIf oManwayType = 800 Then
	oFeats.Item("MWAY800 Centre").Suppressed = False
	oFeats.Item("MWAY800 Holes").Suppressed = False
	oFeats.Item("MWAY800 PCD").Suppressed = False
	oFeats.Item("MWAY600 Centre").Suppressed = True
	oFeats.Item("MWAY600 Holes").Suppressed = True
	oFeats.Item("MWAY600 PCD").Suppressed = True
	oFeats.Item("MWAY900 Centre").Suppressed = True
	oFeats.Item("MWAY900 Holes").Suppressed = True
	oFeats.Item("MWAY900 PCD").Suppressed = True
ElseIf oManwayType = 900 Then
	oFeats.Item("MWAY900 Centre").Suppressed = False
	oFeats.Item("MWAY900 Holes").Suppressed = False
	oFeats.Item("MWAY900 PCD").Suppressed = False
	oFeats.Item("MWAY800 Centre").Suppressed = True
	oFeats.Item("MWAY800 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
	oFeats.Item("MWAY600 Centre").Suppressed = True
	oFeats.Item("MWAY600 Holes").Suppressed = True
	oFeats.Item("MWAY600 PCD").Suppressed = True
End If

oPDoc.Update
```

#### Code Block 4

```vb
'just using a dummy variable here,
'to preserve automation/triggering behavior of unquoted local parameter
oDV = ManwayType

'get the 'local' part document object (the document this rule is saved within)
Dim oPDoc As PartDocument = ThisDoc.Document
oPDef = oPDoc.ComponentDefinition

'if the parameter is numerical, and not unit-less,
'this will return 'database units' version of the parameter's Value,
'not the 'document units' version of it
'oManwayType = oPDef.Parameters.Item("ManwayType").Value

oDocName = ThisDoc.FileName(True)

'these two will get the 'document units' version of the parameter's Value
'oManwayType = ManwayType 'unquoted parameter name
oManwayType = Parameter(oDocName, "ManwayType")

oFeats = oPDef.Features

If oManwayType = 600 Then
	oFeats.Item("MWAY600 Centre").Suppressed = False
	oFeats.Item("MWAY600 Holes").Suppressed = False
	oFeats.Item("MWAY600 PCD").Suppressed = False
	oFeats.Item("MWAY800 Centre").Suppressed = True
	oFeats.Item("MWAY800 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
	oFeats.Item("MWAY900 Centre").Suppressed = True
	oFeats.Item("MWAY900 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
ElseIf oManwayType = 800 Then
	oFeats.Item("MWAY800 Centre").Suppressed = False
	oFeats.Item("MWAY800 Holes").Suppressed = False
	oFeats.Item("MWAY800 PCD").Suppressed = False
	oFeats.Item("MWAY600 Centre").Suppressed = True
	oFeats.Item("MWAY600 Holes").Suppressed = True
	oFeats.Item("MWAY600 PCD").Suppressed = True
	oFeats.Item("MWAY900 Centre").Suppressed = True
	oFeats.Item("MWAY900 Holes").Suppressed = True
	oFeats.Item("MWAY900 PCD").Suppressed = True
ElseIf oManwayType = 900 Then
	oFeats.Item("MWAY900 Centre").Suppressed = False
	oFeats.Item("MWAY900 Holes").Suppressed = False
	oFeats.Item("MWAY900 PCD").Suppressed = False
	oFeats.Item("MWAY800 Centre").Suppressed = True
	oFeats.Item("MWAY800 Holes").Suppressed = True
	oFeats.Item("MWAY800 PCD").Suppressed = True
	oFeats.Item("MWAY600 Centre").Suppressed = True
	oFeats.Item("MWAY600 Holes").Suppressed = True
	oFeats.Item("MWAY600 PCD").Suppressed = True
End If

oPDoc.Update
```

#### Code Block 5

```vb
Dim Doc As PartDocument = ThisDoc.Document
oPCD = Doc.ComponentDefinition
If oPCD.IsModelStateMember Then
	Doc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = HEIGHT
oMState = oMStates.Add(newModelStateName)
```

#### Code Block 6

```vb
Dim Doc As PartDocument = ThisDoc.Document
oPCD = Doc.ComponentDefinition
If oPCD.IsModelStateMember Then
	Doc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = HEIGHT
oMState = oMStates.Add(newModelStateName)
```

#### Code Block 7

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
Dim occ As ComponentOccurrence '= doc.ComponentDefinition.Occurrences.Item(1)

Dim oName = "COURSE 1 STEEL TANK SHEET:8"

For Each occ In doc.ComponentDefinition.Occurrences
	If occ.Name = oName Then
		Dim facDoc As PartDocument = occ.Definition.Document
		If (facDoc.ComponentDefinition.IsModelStateMember) Then
		    facDoc = facDoc.ComponentDefinition.FactoryDocument
		End If
		Dim modelStates As ModelStates = facDoc.ComponentDefinition.ModelStates
		Dim newModelStateName = "N1"
		Dim modelState As ModelState = modelStates.Add()
		modelState.Name = newModelStateName
		modelState.Activate()
		occ.ActiveModelState = newModelStateName
	End If
Next

ilogicVb.RunRule("COURSE 1 STEEL TANK SHEET:8", "ManwayCutOut")
```

#### Code Block 8

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
Dim occ As ComponentOccurrence '= doc.ComponentDefinition.Occurrences.Item(1)

Dim oName = "COURSE 1 STEEL TANK SHEET:8"

For Each occ In doc.ComponentDefinition.Occurrences
	If occ.Name = oName Then
		Dim facDoc As PartDocument = occ.Definition.Document
		If (facDoc.ComponentDefinition.IsModelStateMember) Then
		    facDoc = facDoc.ComponentDefinition.FactoryDocument
		End If
		Dim modelStates As ModelStates = facDoc.ComponentDefinition.ModelStates
		Dim newModelStateName = "N1"
		Dim modelState As ModelState = modelStates.Add()
		modelState.Name = newModelStateName
		modelState.Activate()
		occ.ActiveModelState = newModelStateName
	End If
Next

ilogicVb.RunRule("COURSE 1 STEEL TANK SHEET:8", "ManwayCutOut")
```

#### Code Block 9

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
Dim occ As ComponentOccurrence = doc.ComponentDefinition.Occurrences.Item(1)

Dim facDoc As PartDocument = occ.Definition.Document
If (facDoc.ComponentDefinition.IsModelStateMember) Then
    facDoc = facDoc.ComponentDefinition.FactoryDocument
End If
Dim modelStates As ModelStates = facDoc.ComponentDefinition.ModelStates
Dim newModelStateName = "YourNameHere"
Dim modelState As ModelState = modelStates.Add()
modelState.Name = newModelStateName
modelState.Activate()

occ.ActiveModelState = newModelStateName
```

#### Code Block 10

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
Dim occ As ComponentOccurrence = doc.ComponentDefinition.Occurrences.Item(1)

Dim facDoc As PartDocument = occ.Definition.Document
If (facDoc.ComponentDefinition.IsModelStateMember) Then
    facDoc = facDoc.ComponentDefinition.FactoryDocument
End If
Dim modelStates As ModelStates = facDoc.ComponentDefinition.ModelStates
Dim newModelStateName = "YourNameHere"
Dim modelState As ModelState = modelStates.Add()
modelState.Name = newModelStateName
modelState.Activate()

occ.ActiveModelState = newModelStateName
```

#### Code Block 11

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
```

#### Code Block 12

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
```

#### Code Block 13

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
```

#### Code Block 14

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
```

#### Code Block 15

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName

oMState.FactoryDocument.ComponentDefinition.Features.Item("MWAY900 Centre").Suppressed = False
oMState.FactoryDocument.ComponentDefinition.Features.Item("MWAY900 Holes").Suppressed = False
oMState.FactoryDocument.ComponentDefinition.Features.Item("MWAY900 PCD").Suppressed = False
```

#### Code Block 16

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName

oMState.FactoryDocument.ComponentDefinition.Features.Item("MWAY900 Centre").Suppressed = False
oMState.FactoryDocument.ComponentDefinition.Features.Item("MWAY900 Holes").Suppressed = False
oMState.FactoryDocument.ComponentDefinition.Features.Item("MWAY900 PCD").Suppressed = False
```

#### Code Block 17

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
facDoc.Activate
iLogicVb.RunRule(oName, "ManwayCutOut")
're-activate the main assembly afterwards, if needed
'but test both ways, in case more time is needed for the rule to do its thing
'doc.Activate
```

#### Code Block 18

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
facDoc.Activate
iLogicVb.RunRule(oName, "ManwayCutOut")
're-activate the main assembly afterwards, if needed
'but test both ways, in case more time is needed for the rule to do its thing
'doc.Activate
```

#### Code Block 19

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
facDoc.Activate
iLogicVb.RunRule(oName, "ManwayCutOut")
're-activate the main assembly afterwards, if needed
'but test both ways, in case more time is needed for the rule to do its thing
'doc.Activate
```

#### Code Block 20

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
facDoc.Activate
iLogicVb.RunRule(oName, "ManwayCutOut")
're-activate the main assembly afterwards, if needed
'but test both ways, in case more time is needed for the rule to do its thing
'doc.Activate
```

#### Code Block 21

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
facDoc.Activate
iLogicVb.RunRule(oName, "ManwayCutOut")
're-activate the main assembly afterwards, if needed
'but test both ways, in case more time is needed for the rule to do its thing
'doc.Activate
```

#### Code Block 22

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
facDoc.Activate
iLogicVb.RunRule(oName, "ManwayCutOut")
're-activate the main assembly afterwards, if needed
'but test both ways, in case more time is needed for the rule to do its thing
'doc.Activate
```

#### Code Block 23

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
facDoc.Activate
iLogicVb.RunRule(oName, "ManwayCutOut")
're-activate the main assembly afterwards, if needed
'but test both ways, in case more time is needed for the rule to do its thing
'doc.Activate
```

#### Code Block 24

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
facDoc.Activate
iLogicVb.RunRule(oName, "ManwayCutOut")
're-activate the main assembly afterwards, if needed
'but test both ways, in case more time is needed for the rule to do its thing
'doc.Activate
```

#### Code Block 25

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 26

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 27

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 28

```vb
Dim doc As AssemblyDocument = ThisDoc.Document
oName = "COURSE 1 STEEL TANK SHEET:8"
occ = doc.ComponentDefinition.Occurrences.ItemByName(oName)
Dim facDoc As PartDocument = occ.Definition.Document
oPCD = facDoc.ComponentDefinition
If oPCD.IsModelStateMember Then
	facDoc = oPCD.FactoryDocument
End If
oMStates = oPCD.ModelStates
newModelStateName = "N1"
oMState = oMStates.Add(newModelStateName)
oMState.Activate()
occ.ActiveModelState = newModelStateName
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 29

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
'define the variable "oName"
oName = "ModelState1"
For Each oOcc As ComponentOccurrence  In oADoc.ComponentDefinition.Occurrences
    If TypeOf oOcc.Definition Is PartComponentDefinition Then
		Dim oPDef As PartComponentDefinition = oOcc.Definition
		Dim oFound As Boolean  = False
		For Each oMS As ModelState In oPDef.ModelStates
			If oMS.Name = oName Then
				oFound = True
				Exit For 'found it, so don't create it
			End If
		Next
		If oFound = False Then
			'did not find it, so create it
			oPDef.ModelStates.Add(oName)
		End If
		oOcc.ActiveModelState = oName
	End If
Next
```

#### Code Block 30

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
'define the variable "oName"
oName = "ModelState1"
For Each oOcc As ComponentOccurrence  In oADoc.ComponentDefinition.Occurrences
    If TypeOf oOcc.Definition Is PartComponentDefinition Then
		Dim oPDef As PartComponentDefinition = oOcc.Definition
		Dim oFound As Boolean  = False
		For Each oMS As ModelState In oPDef.ModelStates
			If oMS.Name = oName Then
				oFound = True
				Exit For 'found it, so don't create it
			End If
		Next
		If oFound = False Then
			'did not find it, so create it
			oPDef.ModelStates.Add(oName)
		End If
		oOcc.ActiveModelState = oName
	End If
Next
```

#### Code Block 31

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
'define the variable "oName"
oName = "ModelState1"
For Each oOcc As ComponentOccurrence  In oADoc.ComponentDefinition.Occurrences
    If TypeOf oOcc.Definition Is PartComponentDefinition Then
		Dim oPDef As PartComponentDefinition = oOcc.Definition
		Dim oFound As Boolean  = False
		For Each oMS As ModelState In oPDef.ModelStates
			If oMS.Name = oName Then
				oFound = True
				Exit For 'found it, so don't create it
			End If
		Next
		If oFound = False Then
			'did not find it, so create it
			oPDef.ModelStates.Add(oName)
		End If
		oOcc.ActiveModelState = oName
	End If
Next
```

#### Code Block 32

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
'define the variable "oName"
oName = "ModelState1"
For Each oOcc As ComponentOccurrence  In oADoc.ComponentDefinition.Occurrences
    If TypeOf oOcc.Definition Is PartComponentDefinition Then
		Dim oPDef As PartComponentDefinition = oOcc.Definition
		Dim oFound As Boolean  = False
		For Each oMS As ModelState In oPDef.ModelStates
			If oMS.Name = oName Then
				oFound = True
				Exit For 'found it, so don't create it
			End If
		Next
		If oFound = False Then
			'did not find it, so create it
			oPDef.ModelStates.Add(oName)
		End If
		oOcc.ActiveModelState = oName
	End If
Next
```

#### Code Block 33

```vb
Dim oDoc As AssemblyDocument
	
Dim oOcc As ComponentOccurrence 	For Each oOcc In Occurrences    'The below line does not work, what is the correct syntax????    oOcc.ComponentDefinition.ModelStates.Add(oName)next
```

#### Code Block 34

```vb
Dim oDoc As AssemblyDocument
	
Dim oOcc As ComponentOccurrence 	For Each oOcc In Occurrences    'The below line does not work, what is the correct syntax????    oOcc.ComponentDefinition.ModelStates.Add(oName)next
```

#### Code Block 35

```vb
If ManwayType = 600 Then
Feature.IsActive("MWAY600 Centre") = True
Feature.IsActive("MWAY600 Holes") = True
Feature.IsActive("MWAY600 PCD") = True
Feature.IsActive("MWAY800 Centre") = False
Feature.IsActive("MWAY800 Holes") = False
Feature.IsActive("MWAY800 PCD") = False
Feature.IsActive("MWAY900 Centre") = False
Feature.IsActive("MWAY900 Holes") = False
Feature.IsActive("MWAY800 PCD") = False

Else If ManwayType = 800 Then
Feature.IsActive("MWAY800 Centre") = True
Feature.IsActive("MWAY800 Holes") = True
Feature.IsActive("MWAY800 PCD") = True
Feature.IsActive("MWAY600 Centre") = False
Feature.IsActive("MWAY600 Holes") = False
Feature.IsActive("MWAY600 PCD") = False
Feature.IsActive("MWAY900 Centre") = False
Feature.IsActive("MWAY900 Holes") = False
Feature.IsActive("MWAY900 PCD") = False

Else If ManwayType = 900 Then
Feature.IsActive("MWAY900 Centre") = True
Feature.IsActive("MWAY900 Holes") = True
Feature.IsActive("MWAY900 PCD") = True
Feature.IsActive("MWAY800 Centre") = False
Feature.IsActive("MWAY800 Holes") = False
Feature.IsActive("MWAY800 PCD") = False
Feature.IsActive("MWAY600 Centre") = False
Feature.IsActive("MWAY600 Holes") = False
Feature.IsActive("MWAY600 PCD") = False

End If


iLogicVb.UpdateWhenDone = True
```

#### Code Block 36

```vb
If ManwayType = 600 Then
Feature.IsActive("MWAY600 Centre") = True
Feature.IsActive("MWAY600 Holes") = True
Feature.IsActive("MWAY600 PCD") = True
Feature.IsActive("MWAY800 Centre") = False
Feature.IsActive("MWAY800 Holes") = False
Feature.IsActive("MWAY800 PCD") = False
Feature.IsActive("MWAY900 Centre") = False
Feature.IsActive("MWAY900 Holes") = False
Feature.IsActive("MWAY800 PCD") = False

Else If ManwayType = 800 Then
Feature.IsActive("MWAY800 Centre") = True
Feature.IsActive("MWAY800 Holes") = True
Feature.IsActive("MWAY800 PCD") = True
Feature.IsActive("MWAY600 Centre") = False
Feature.IsActive("MWAY600 Holes") = False
Feature.IsActive("MWAY600 PCD") = False
Feature.IsActive("MWAY900 Centre") = False
Feature.IsActive("MWAY900 Holes") = False
Feature.IsActive("MWAY900 PCD") = False

Else If ManwayType = 900 Then
Feature.IsActive("MWAY900 Centre") = True
Feature.IsActive("MWAY900 Holes") = True
Feature.IsActive("MWAY900 PCD") = True
Feature.IsActive("MWAY800 Centre") = False
Feature.IsActive("MWAY800 Holes") = False
Feature.IsActive("MWAY800 PCD") = False
Feature.IsActive("MWAY600 Centre") = False
Feature.IsActive("MWAY600 Holes") = False
Feature.IsActive("MWAY600 PCD") = False

End If


iLogicVb.UpdateWhenDone = True
```

#### Code Block 37

```vb
MessageBox.Show("WORKING")
```

#### Code Block 38

```vb
MessageBox.Show("WORKING")
```

#### Code Block 39

```vb
Parameter("COURSE 1 STEEL TANK SHEET:" & BespokeSheet, "ManwayType") = MWAY_TYPE
```

#### Code Block 40

```vb
Parameter("COURSE 1 STEEL TANK SHEET:" & BespokeSheet, "ManwayType") = MWAY_TYPE
```

#### Code Block 41

```vb
Parameter.Param().Value
```

#### Code Block 42

```vb
Parameter.Param().Value
```

#### Code Block 43

```vb
facDoc.Activate
```

#### Code Block 44

```vb
facDoc.Activate
```

#### Code Block 45

```vb
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 46

```vb
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 47

```vb
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 48

```vb
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 49

```vb
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 50

```vb
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 51

```vb
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 52

```vb
iLogicVb.RunRule(oName, "ManwayCutOut")
```

#### Code Block 53

```vb
iLogicVb.RunRule(oName, "TEST")
```

#### Code Block 54

```vb
iLogicVb.RunRule(oName, "TEST")
```

#### Code Block 55

```vb
oModelState = oDoc.ComponentDefinition.ModelStates.Add(oName)
		oDoc.ActiveModelState = oName
```

#### Code Block 56

```vb
oModelState = oDoc.ComponentDefinition.ModelStates.Add(oName)
		oDoc.ActiveModelState = oName
```

---

### 40. Create iProperties for all parts in Content Center

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/create-iproperties-for-all-parts-in-content-center/td-p/8750403#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/create-iproperties-for-all-parts-in-content-center/td-p/8750403#messageview_0)

**Author:** dusan.naus.trz

**Date:** ‎04-24-2019
	
		
		07:37 AM

**Description:** Hi, How can I create iProperties on all Components in Content Center automatically? Is there any code? VBA or iLogic?  I've been working in Inventor since version 6 (2002), now I have Inventor 2020. I need to change all of the components in Content Center. Do you want to tell me it's not going to ha...

**Code Snippets (1):**

#### Code Block 1

```vb
trigger = iTrigger0
' Get the active assembly. 
    Dim oAsmDoc As AssemblyDocument
    oAsmDoc = ThisApplication.ActiveDocument

    ' Get the assembly component definition.
    Dim oAsmDef As AssemblyComponentDefinition
    oAsmDef = oAsmDoc.ComponentDefinition

    ' Get all of the leaf occurrences of the assembly.
    Dim oLeafOccs As ComponentOccurrencesEnumerator
    oLeafOccs = oAsmDef.Occurrences.AllLeafOccurrences

    ' Iterate through the occurrences and print the name.
    Dim oOcc As ComponentOccurrence
    For Each oOcc In oLeafOccs
     MsgBox(oOcc.ReferencedDocumentDescriptor.FullDocumentName)
     iProperties.Value(oOcc.Name,"Custom", "MojeHmotnost") = Round(oOcc.MassProperties.Mass,2) & " [kg]"
    Next
```

#### Code Block 2

```vb
trigger = iTrigger0
' Get the active assembly. 
    Dim oAsmDoc As AssemblyDocument
    oAsmDoc = ThisApplication.ActiveDocument

    ' Get the assembly component definition.
    Dim oAsmDef As AssemblyComponentDefinition
    oAsmDef = oAsmDoc.ComponentDefinition

    ' Get all of the leaf occurrences of the assembly.
    Dim oLeafOccs As ComponentOccurrencesEnumerator
    oLeafOccs = oAsmDef.Occurrences.AllLeafOccurrences

    ' Iterate through the occurrences and print the name.
    Dim oOcc As ComponentOccurrence
    For Each oOcc In oLeafOccs
     MsgBox(oOcc.ReferencedDocumentDescriptor.FullDocumentName)
     iProperties.Value(oOcc.Name,"Custom", "MojeHmotnost") = Round(oOcc.MassProperties.Mass,2) & " [kg]"
    Next
```

---

### 41. Create work point from axis and plane

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/create-work-point-from-axis-and-plane/td-p/11667060](https://forums.autodesk.com/t5/inventor-programming-forum/create-work-point-from-axis-and-plane/td-p/11667060)

**Author:** hieut1392

**Date:** ‎01-09-2023
	
		
		09:54 AM

**Description:** I want to create work point from intersection of axis and plane. Can you give me some hint?  Sub CreateWorkPoint()  Dim oPartDoc As PartDocument Set oPartDoc = ThisApplication.ActiveDocument  Dim oCompDef As ComponentDefinition Set oCompDef = oPartDoc.ComponentDefinition  Dim face As Object Set face...

**Code Snippets (6):**

#### Code Block 1

```vb
Sub CreateWorkPoint()

Dim oPartDoc As PartDocument
Set oPartDoc = ThisApplication.ActiveDocument

Dim oCompDef As ComponentDefinition
Set oCompDef = oPartDoc.ComponentDefinition

Dim face As Object
Set face = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAllPlanarEntities, "Select Face")
Dim axis As Object
Set axis = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAllPlanarEntities, "Select Axis")

Call oCompDef.WorkPoints.Addby <---- I'm stuck here

End Sub
```

#### Code Block 2

```vb
Sub CreateWorkPoint()

Dim oPartDoc As PartDocument
Set oPartDoc = ThisApplication.ActiveDocument

Dim oCompDef As ComponentDefinition
Set oCompDef = oPartDoc.ComponentDefinition

Dim face As Object
Set face = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAllPlanarEntities, "Select Face")
Dim axis As Object
Set axis = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAllPlanarEntities, "Select Axis")

Call oCompDef.WorkPoints.Addby <---- I'm stuck here

End Sub
```

#### Code Block 3

```vb
Sub CreateWorkPoint()

Dim oPartDoc As PartDocument
Set oPartDoc = ThisApplication.ActiveDocument

Dim oCompDef As ComponentDefinition
Set oCompDef = oPartDoc.ComponentDefinition

Dim face As Object
Set face = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAllPlanarEntities, "Select Face")
Dim axis As Object
Set axis = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAllPlanarEntities, "Select Axis")

Call oCompDef.WorkPoints.Addby <---- I'm stuck here

End Sub
```

#### Code Block 4

```vb
Sub CreateWorkPoint()

Dim oPartDoc As PartDocument
Set oPartDoc = ThisApplication.ActiveDocument

Dim oCompDef As ComponentDefinition
Set oCompDef = oPartDoc.ComponentDefinition

Dim face As Object
Set face = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAllPlanarEntities, "Select Face")
Dim axis As Object
Set axis = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAllPlanarEntities, "Select Axis")

Call oCompDef.WorkPoints.Addby <---- I'm stuck here

End Sub
```

#### Code Block 5

```vb
Sub Main
	'pick face
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kPartFacePlanarFilter, "Pick Flat Face.")
	If oObj Is Nothing OrElse (TypeOf oObj Is Face = False) Then Return
	Dim oFace As Face = oObj
	Dim oPlane As Plane = oFace.Geometry
	
	'pick work axis
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter, "Pick Work Axis.")
	If oObj Is Nothing OrElse (TypeOf oObj Is WorkAxis = False) Then Return
	Dim oAxis As WorkAxis = oObj
	
	Dim oPoint As Point = oPlane.IntersectWithLine(oAxis.Line)

	Dim oPDef As PartComponentDefinition = oFace.Parent.ComponentDefinition
	oPDef.WorkPoints.AddByPoint(oPoint)
End Sub
```

#### Code Block 6

```vb
Sub Main
	'pick face
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kPartFacePlanarFilter, "Pick Flat Face.")
	If oObj Is Nothing OrElse (TypeOf oObj Is Face = False) Then Return
	Dim oFace As Face = oObj
	Dim oPlane As Plane = oFace.Geometry
	
	'pick work axis
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter, "Pick Work Axis.")
	If oObj Is Nothing OrElse (TypeOf oObj Is WorkAxis = False) Then Return
	Dim oAxis As WorkAxis = oObj
	
	Dim oPoint As Point = oPlane.IntersectWithLine(oAxis.Line)

	Dim oPDef As PartComponentDefinition = oFace.Parent.ComponentDefinition
	oPDef.WorkPoints.AddByPoint(oPoint)
End Sub
```

#### Code Block 7

```vb
Sub Main
	'pick face
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kPartFacePlanarFilter, "Pick Flat Face.")
	If oObj Is Nothing OrElse (TypeOf oObj Is Face = False) Then Return
	Dim oFace As Face = oObj
	Dim oPlane As Plane = oFace.Geometry
	
	'pick work axis
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter, "Pick Work Axis.")
	If oObj Is Nothing OrElse (TypeOf oObj Is WorkAxis = False) Then Return
	Dim oAxis As WorkAxis = oObj
	
	Dim oPoint As Point = oPlane.IntersectWithLine(oAxis.Line)

	Dim oPDef As PartComponentDefinition = oFace.Parent.ComponentDefinition
	oPDef.WorkPoints.AddByPoint(oPoint)
End Sub
```

#### Code Block 8

```vb
Sub Main
	'pick face
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kPartFacePlanarFilter, "Pick Flat Face.")
	If oObj Is Nothing OrElse (TypeOf oObj Is Face = False) Then Return
	Dim oFace As Face = oObj
	Dim oPlane As Plane = oFace.Geometry
	
	'pick work axis
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter, "Pick Work Axis.")
	If oObj Is Nothing OrElse (TypeOf oObj Is WorkAxis = False) Then Return
	Dim oAxis As WorkAxis = oObj
	
	Dim oPoint As Point = oPlane.IntersectWithLine(oAxis.Line)

	Dim oPDef As PartComponentDefinition = oFace.Parent.ComponentDefinition
	oPDef.WorkPoints.AddByPoint(oPoint)
End Sub
```

#### Code Block 9

```vb
Sub Main
	'pick face
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kPartFacePlanarFilter, "Pick Flat Face.")
	If oObj Is Nothing OrElse (TypeOf oObj Is Face = False) Then Return
	Dim oFace As Face = oObj
	Dim oPlane As Plane = oFace.Geometry
	
	'pick work axis
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter, "Pick Work Axis.")
	If oObj Is Nothing OrElse (TypeOf oObj Is WorkAxis = False) Then Return
	Dim oAxis As WorkAxis = oObj
	
	Dim oPoint As Point = oPlane.IntersectWithLine(oAxis.Line)

	Dim oPDef As PartComponentDefinition = oFace.Parent.ComponentDefinition
	oPDef.WorkPoints.AddFixed(oPoint) 'Creates fixed workpoint
	oPDef.WorkPoints.AddByCurveAndEntity(oAxis, oFace) 'Creates WorkPoint constrained to workAxis and Face
End Sub
```

#### Code Block 10

```vb
Sub Main
	'pick face
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kPartFacePlanarFilter, "Pick Flat Face.")
	If oObj Is Nothing OrElse (TypeOf oObj Is Face = False) Then Return
	Dim oFace As Face = oObj
	Dim oPlane As Plane = oFace.Geometry
	
	'pick work axis
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter, "Pick Work Axis.")
	If oObj Is Nothing OrElse (TypeOf oObj Is WorkAxis = False) Then Return
	Dim oAxis As WorkAxis = oObj
	
	Dim oPoint As Point = oPlane.IntersectWithLine(oAxis.Line)

	Dim oPDef As PartComponentDefinition = oFace.Parent.ComponentDefinition
	oPDef.WorkPoints.AddFixed(oPoint) 'Creates fixed workpoint
	oPDef.WorkPoints.AddByCurveAndEntity(oAxis, oFace) 'Creates WorkPoint constrained to workAxis and Face
End Sub
```

#### Code Block 11

```vb
Sub Main
	'pick face
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kPartFacePlanarFilter, "Pick Flat Face.")
	If oObj Is Nothing OrElse (TypeOf oObj Is Face = False) Then Return
	Dim oFace As Face = oObj
	Dim oPlane As Plane = oFace.Geometry
	
	'pick work axis
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter, "Pick Work Axis.")
	If oObj Is Nothing OrElse (TypeOf oObj Is WorkAxis = False) Then Return
	Dim oAxis As WorkAxis = oObj
	
	Dim oPoint As Point = oPlane.IntersectWithLine(oAxis.Line)

	Dim oPDef As PartComponentDefinition = oFace.Parent.ComponentDefinition
	oPDef.WorkPoints.AddFixed(oPoint) 'Creates fixed workpoint
	oPDef.WorkPoints.AddByCurveAndEntity(oAxis, oFace) 'Creates WorkPoint constrained to workAxis and Face
End Sub
```

#### Code Block 12

```vb
Sub Main
	'pick face
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kPartFacePlanarFilter, "Pick Flat Face.")
	If oObj Is Nothing OrElse (TypeOf oObj Is Face = False) Then Return
	Dim oFace As Face = oObj
	Dim oPlane As Plane = oFace.Geometry
	
	'pick work axis
	oObj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter, "Pick Work Axis.")
	If oObj Is Nothing OrElse (TypeOf oObj Is WorkAxis = False) Then Return
	Dim oAxis As WorkAxis = oObj
	
	Dim oPoint As Point = oPlane.IntersectWithLine(oAxis.Line)

	Dim oPDef As PartComponentDefinition = oFace.Parent.ComponentDefinition
	oPDef.WorkPoints.AddFixed(oPoint) 'Creates fixed workpoint
	oPDef.WorkPoints.AddByCurveAndEntity(oAxis, oFace) 'Creates WorkPoint constrained to workAxis and Face
End Sub
```

---

### 42. CreateGeometryIntent creates kNoPointIntent type

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/creategeometryintent-creates-knopointintent-type/td-p/13835878](https://forums.autodesk.com/t5/inventor-programming-forum/creategeometryintent-creates-knopointintent-type/td-p/13835878)

**Author:** Mehmet_Fatih_Turker

**Date:** ‎10-03-2025
	
		
		05:11 AM

**Description:** Hi all, the function that Im sharing below is to get GeometryIntent from SetIncludeStatus but didnt satisfy me so far. It creates kNoPointIntent and it doesnt work for creating LinearGeneralDimension. is there any way to make it return meaningful geometry İntent from that operation ?    Public Funct...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim v1_CenterLine2_GI As GeometryIntent = IncludeWorkFeatureAndGetIntent(v1,
                                                                                     partName:="aaa",
                                                                                     featureName:="X Axis",
                                                                                     include:=True,
                                                                                     containsMatch:=True,
                                                                                     searchAxes:=True)
```

#### Code Block 2

```vb
Dim v1_CenterLine2_GI As GeometryIntent = IncludeWorkFeatureAndGetIntent(v1,
                                                                                     partName:="aaa",
                                                                                     featureName:="X Axis",
                                                                                     include:=True,
                                                                                     containsMatch:=True,
                                                                                     searchAxes:=True)
```

#### Code Block 3

```vb
Public Function IncludeWorkFeatureAndGetIntent(view As DrawingView,
                                                   partName As String,
                                                   featureName As String,
                                          Optional include As Boolean = True,
                                          Optional containsMatch As Boolean = True,
                                          Optional searchAxes As Boolean = False,
                                          Optional searchPlanes As Boolean = False,
                                          Optional searchPoints As Boolean = False,
                                          Optional search2DSketches As Boolean = False,
                                          Optional search3DSketches As Boolean = False,
                                          Optional searchModelAnnotations As Boolean = False,
                                          Optional caseInsensitive As Boolean = True,
                                          Optional onlyFromVisibleOccurrences As Boolean = False
                ) As GeometryIntent

        If view Is Nothing OrElse view.ReferencedDocumentDescriptor Is Nothing Then Return Nothing

        Dim refDoc As Document = view.ReferencedDocumentDescriptor.ReferencedDocument
        Dim sheet As Sheet = view.Parent
        Dim cmp = If(caseInsensitive, StringComparison.OrdinalIgnoreCase, StringComparison.Ordinal)

        Dim matchStr As Func(Of String, String, Boolean) = Function(src As String, pat As String) As Boolean
                                                               If String.IsNullOrEmpty(pat) Then Return True
                                                               If containsMatch Then
                                                                   Return src?.IndexOf(pat, cmp) >= 0
                                                               Else
                                                                   Return String.Equals(src, pat, cmp)
                                                               End If
                                                           End Function

        Dim baseOf As Func(Of String, String) = Function(nm As String) As String
                                                    If String.IsNullOrEmpty(nm) Then Return nm
                                                    Dim p = nm.IndexOf(":"c)
                                                    Return If(p >= 0, nm.Substring(0, p), nm)
                                                End Function

        ' ---- PART VIEW ----
        Dim prt = TryCast(refDoc, PartDocument)
        If prt IsNot Nothing Then
            If Not matchStr(IO.Path.GetFileNameWithoutExtension(prt.DisplayName), partName) AndAlso
           Not matchStr(prt.DisplayName, partName) Then Return Nothing

            Dim pDef = prt.ComponentDefinition

            If searchAxes Then
                For Each ax In pDef.WorkAxes
                    If matchStr(ax.Name, featureName) Then
                        Try
                            view.SetIncludeStatus(ax, include)
                            Return sheet.CreateGeometryIntent(ax)
                        Catch : End Try
                    End If
                Next
            End If

            If searchPlanes Then
                For Each pl In pDef.WorkPlanes
                    If matchStr(pl.Name, featureName) Then
                        Try
                            view.SetIncludeStatus(pl, include)
                            Return sheet.CreateGeometryIntent(pl)
                        Catch
                        End Try
                    End If
                Next
            End If

            If searchPoints Then
                For Each wp In pDef.WorkPoints
                    If matchStr(wp.Name, featureName) Then
                        Try
                            view.SetIncludeStatus(wp, include)
                            Return sheet.CreateGeometryIntent(wp)
                        Catch
                        End Try
                    End If
                Next
            End If

            If search2DSketches Then
                For Each sk In pDef.Sketches
                    If matchStr(sk.Name, featureName) Then
                        Try
                            view.SetIncludeStatus(sk, include)
                            Return sheet.CreateGeometryIntent(sk)
                        Catch
                        End Try
                    End If
                Next
            End If

            If search3DSketches Then
                For Each sk3 In pDef.Sketches3D
                    If matchStr(sk3.Name, featureName) Then
                        Try
                            view.SetIncludeStatus(sk3, include)
                            Return sheet.CreateGeometryIntent(sk3)
                        Catch
                        End Try
                    End If
                Next
            End If

            Return Nothing
        End If
        ' ---- ASSEMBLY VIEW ----
        Dim asm = TryCast(refDoc, AssemblyDocument)
        If asm Is Nothing Then Return Nothing

        Dim occsEnum As ComponentOccurrencesEnumerator = asm.ComponentDefinition.Occurrences.AllReferencedOccurrences(asm.ComponentDefinition)

        For Each occ As ComponentOccurrence In occsEnum
            If occ Is Nothing OrElse occ.Suppressed Then Continue For

            Dim occDoc As Document = TryCast(occ.Definition.Document, Document)
            Dim occDocBase As String = ""
            If occDoc IsNot Nothing Then
                occDocBase = IO.Path.GetFileNameWithoutExtension(occDoc.DisplayName)
            End If
            If Not matchStr(occDocBase, partName) Then Continue For

            If onlyFromVisibleOccurrences Then
                Dim hasCurves As Boolean = False
                Try
                    hasCurves = (view.DrawingCurves(occ)?.Count > 0)
                Catch
                    hasCurves = False
                End Try
                If Not hasCurves Then
                    Continue For
                End If
            End If
            Dim pDef = Nothing
            pDef = TryCast(occ.Definition, PartComponentDefinition)
            If pDef Is Nothing Then
                pDef = TryCast(occ.Definition, AssemblyComponentDefinition)
            End If
            If pDef Is Nothing Then Continue For

            ' --- AXES ---
            If searchAxes Then
                For Each ax In pDef.WorkAxes
                    If Not matchStr(ax.Name, featureName) Then Continue For
                    Dim px As WorkAxisProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(ax, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch
                    End Try
                Next
            End If

            ' --- PLANES ---
            If searchPlanes Then
                For Each pl In pDef.WorkPlanes
                    If Not matchStr(pl.Name, featureName) Then Continue For
                    Dim px As WorkPlaneProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(pl, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch
                    End Try
                Next
            End If

            ' --- POINTS ---
            If searchPoints Then
                For Each wp In pDef.WorkPoints
                    If Not matchStr(wp.Name, featureName) Then Continue For
                    Dim px As WorkPointProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(wp, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch
                    End Try
                Next
            End If

            ' --- 2D SKETCHES ---
            If search2DSketches Then
                For Each sk As PlanarSketch In pDef.Sketches
                    If Not matchStr(sk.Name, featureName) Then Continue For
                    Dim px As PlanarSketchProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(sk, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch
                    End Try
                Next
            End If
            ' --- 3D SKETCHES ---
            If search3DSketches Then
                For Each sk3 In pDef.Sketches3D
                    If Not matchStr(sk3.Name, featureName) Then Continue For
                    Dim px As Sketch3DProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(sk3, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch
                    End Try
                Next
            End If

        Next

        Return Nothing
    End Function
```

#### Code Block 4

```vb
Public Function IncludeWorkFeatureAndGetIntent(view As DrawingView,
                                                   partName As String,
                                                   featureName As String,
                                          Optional include As Boolean = True,
                                          Optional containsMatch As Boolean = True,
                                          Optional searchAxes As Boolean = False,
                                          Optional searchPlanes As Boolean = False,
                                          Optional searchPoints As Boolean = False,
                                          Optional search2DSketches As Boolean = False,
                                          Optional search3DSketches As Boolean = False,
                                          Optional searchModelAnnotations As Boolean = False,
                                          Optional caseInsensitive As Boolean = True,
                                          Optional onlyFromVisibleOccurrences As Boolean = False
                ) As GeometryIntent

        If view Is Nothing OrElse view.ReferencedDocumentDescriptor Is Nothing Then Return Nothing

        Dim refDoc As Document = view.ReferencedDocumentDescriptor.ReferencedDocument
        Dim sheet As Sheet = view.Parent
        Dim cmp = If(caseInsensitive, StringComparison.OrdinalIgnoreCase, StringComparison.Ordinal)

        Dim matchStr As Func(Of String, String, Boolean) = Function(src As String, pat As String) As Boolean
                                                               If String.IsNullOrEmpty(pat) Then Return True
                                                               If containsMatch Then
                                                                   Return src?.IndexOf(pat, cmp) >= 0
                                                               Else
                                                                   Return String.Equals(src, pat, cmp)
                                                               End If
                                                           End Function

        Dim baseOf As Func(Of String, String) = Function(nm As String) As String
                                                    If String.IsNullOrEmpty(nm) Then Return nm
                                                    Dim p = nm.IndexOf(":"c)
                                                    Return If(p >= 0, nm.Substring(0, p), nm)
                                                End Function

        ' ---- PART VIEW ----
        Dim prt = TryCast(refDoc, PartDocument)
        If prt IsNot Nothing Then
            If Not matchStr(IO.Path.GetFileNameWithoutExtension(prt.DisplayName), partName) AndAlso
           Not matchStr(prt.DisplayName, partName) Then Return Nothing

            Dim pDef = prt.ComponentDefinition

            If searchAxes Then
                For Each ax In pDef.WorkAxes
                    If matchStr(ax.Name, featureName) Then
                        Try
                            view.SetIncludeStatus(ax, include)
                            Return sheet.CreateGeometryIntent(ax)
                        Catch : End Try
                    End If
                Next
            End If

            If searchPlanes Then
                For Each pl In pDef.WorkPlanes
                    If matchStr(pl.Name, featureName) Then
                        Try
                            view.SetIncludeStatus(pl, include)
                            Return sheet.CreateGeometryIntent(pl)
                        Catch
                        End Try
                    End If
                Next
            End If

            If searchPoints Then
                For Each wp In pDef.WorkPoints
                    If matchStr(wp.Name, featureName) Then
                        Try
                            view.SetIncludeStatus(wp, include)
                            Return sheet.CreateGeometryIntent(wp)
                        Catch
                        End Try
                    End If
                Next
            End If

            If search2DSketches Then
                For Each sk In pDef.Sketches
                    If matchStr(sk.Name, featureName) Then
                        Try
                            view.SetIncludeStatus(sk, include)
                            Return sheet.CreateGeometryIntent(sk)
                        Catch
                        End Try
                    End If
                Next
            End If

            If search3DSketches Then
                For Each sk3 In pDef.Sketches3D
                    If matchStr(sk3.Name, featureName) Then
                        Try
                            view.SetIncludeStatus(sk3, include)
                            Return sheet.CreateGeometryIntent(sk3)
                        Catch
                        End Try
                    End If
                Next
            End If

            Return Nothing
        End If
        ' ---- ASSEMBLY VIEW ----
        Dim asm = TryCast(refDoc, AssemblyDocument)
        If asm Is Nothing Then Return Nothing

        Dim occsEnum As ComponentOccurrencesEnumerator = asm.ComponentDefinition.Occurrences.AllReferencedOccurrences(asm.ComponentDefinition)

        For Each occ As ComponentOccurrence In occsEnum
            If occ Is Nothing OrElse occ.Suppressed Then Continue For

            Dim occDoc As Document = TryCast(occ.Definition.Document, Document)
            Dim occDocBase As String = ""
            If occDoc IsNot Nothing Then
                occDocBase = IO.Path.GetFileNameWithoutExtension(occDoc.DisplayName)
            End If
            If Not matchStr(occDocBase, partName) Then Continue For

            If onlyFromVisibleOccurrences Then
                Dim hasCurves As Boolean = False
                Try
                    hasCurves = (view.DrawingCurves(occ)?.Count > 0)
                Catch
                    hasCurves = False
                End Try
                If Not hasCurves Then
                    Continue For
                End If
            End If
            Dim pDef = Nothing
            pDef = TryCast(occ.Definition, PartComponentDefinition)
            If pDef Is Nothing Then
                pDef = TryCast(occ.Definition, AssemblyComponentDefinition)
            End If
            If pDef Is Nothing Then Continue For

            ' --- AXES ---
            If searchAxes Then
                For Each ax In pDef.WorkAxes
                    If Not matchStr(ax.Name, featureName) Then Continue For
                    Dim px As WorkAxisProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(ax, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch
                    End Try
                Next
            End If

            ' --- PLANES ---
            If searchPlanes Then
                For Each pl In pDef.WorkPlanes
                    If Not matchStr(pl.Name, featureName) Then Continue For
                    Dim px As WorkPlaneProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(pl, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch
                    End Try
                Next
            End If

            ' --- POINTS ---
            If searchPoints Then
                For Each wp In pDef.WorkPoints
                    If Not matchStr(wp.Name, featureName) Then Continue For
                    Dim px As WorkPointProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(wp, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch
                    End Try
                Next
            End If

            ' --- 2D SKETCHES ---
            If search2DSketches Then
                For Each sk As PlanarSketch In pDef.Sketches
                    If Not matchStr(sk.Name, featureName) Then Continue For
                    Dim px As PlanarSketchProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(sk, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch
                    End Try
                Next
            End If
            ' --- 3D SKETCHES ---
            If search3DSketches Then
                For Each sk3 In pDef.Sketches3D
                    If Not matchStr(sk3.Name, featureName) Then Continue For
                    Dim px As Sketch3DProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(sk3, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch
                    End Try
                Next
            End If

        Next

        Return Nothing
    End Function
```

---

### 43. Custom Ribbon Tabs

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/custom-ribbon-tabs/td-p/13831088](https://forums.autodesk.com/t5/inventor-programming-forum/custom-ribbon-tabs/td-p/13831088)

**Author:** HogueOne

**Date:** ‎09-30-2025
	
		
		05:18 AM

**Description:** The Goal: Create a custom ribbon tab in the zero document environment labeled "OP".The Problem: The tab is being created, but the UI is being reset shortly after - removing the new tab.The Twist: I've disabled every other addin just to make sure nothing external could be affecting it. I also added d...

**Code Snippets (8):**

#### Code Block 1

```vb
<?xml version="1.0" encoding="utf-8"?>
<Addin Type="Standard">
	<!-- The Assembly name is the name of your output DLL. -->
	<Assembly>NewTab.dll</Assembly>
	<!-- The ClientId must match the GUID in your StandardAddInServer class. -->
	<ClientId>{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}</ClientId>
	<!-- The ClassId must also match the GUID in your StandardAddInServer class. -->
	<ClassId>{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}</ClassId>
	<DisplayName>New Tab Add-in</DisplayName>
	<Description>A simple add-in that creates a new ribbon tab.</Description>
	<LoadOnStartup>1</LoadOnStartup>
	<UserUnloadable>1</UserUnloadable>
	<Hidden>0</Hidden>
	<SupportedSoftwareVersionGreaterThan>28</SupportedSoftwareVersionGreaterThan>
</Addin>
```

#### Code Block 2

```vb
<?xml version="1.0" encoding="utf-8"?>
<Addin Type="Standard">
	<!-- The Assembly name is the name of your output DLL. -->
	<Assembly>NewTab.dll</Assembly>
	<!-- The ClientId must match the GUID in your StandardAddInServer class. -->
	<ClientId>{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}</ClientId>
	<!-- The ClassId must also match the GUID in your StandardAddInServer class. -->
	<ClassId>{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}</ClassId>
	<DisplayName>New Tab Add-in</DisplayName>
	<Description>A simple add-in that creates a new ribbon tab.</Description>
	<LoadOnStartup>1</LoadOnStartup>
	<UserUnloadable>1</UserUnloadable>
	<Hidden>0</Hidden>
	<SupportedSoftwareVersionGreaterThan>28</SupportedSoftwareVersionGreaterThan>
</Addin>
```

#### Code Block 3

```vb
<?xml version="1.0" encoding="utf-8"?>
<Addin Type="Standard">
	<!-- The Assembly name is the name of your output DLL. -->
	<Assembly>NewTab.dll</Assembly>
	<!-- The ClientId must match the GUID in your StandardAddInServer class. -->
	<ClientId>{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}</ClientId>
	<!-- The ClassId must also match the GUID in your StandardAddInServer class. -->
	<ClassId>{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}</ClassId>
	<DisplayName>New Tab Add-in</DisplayName>
	<Description>A simple add-in that creates a new ribbon tab.</Description>
	<LoadOnStartup>1</LoadOnStartup>
	<UserUnloadable>1</UserUnloadable>
	<Hidden>0</Hidden>
	<SupportedSoftwareVersionGreaterThan>28</SupportedSoftwareVersionGreaterThan>
</Addin>
```

#### Code Block 4

```vb
<?xml version="1.0" encoding="utf-8"?>
<Addin Type="Standard">
	<!-- The Assembly name is the name of your output DLL. -->
	<Assembly>NewTab.dll</Assembly>
	<!-- The ClientId must match the GUID in your StandardAddInServer class. -->
	<ClientId>{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}</ClientId>
	<!-- The ClassId must also match the GUID in your StandardAddInServer class. -->
	<ClassId>{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}</ClassId>
	<DisplayName>New Tab Add-in</DisplayName>
	<Description>A simple add-in that creates a new ribbon tab.</Description>
	<LoadOnStartup>1</LoadOnStartup>
	<UserUnloadable>1</UserUnloadable>
	<Hidden>0</Hidden>
	<SupportedSoftwareVersionGreaterThan>28</SupportedSoftwareVersionGreaterThan>
</Addin>
```

#### Code Block 5

```vb
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net8.0-windows</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <EnableComHosting>true</EnableComHosting>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
  </PropertyGroup>

  <ItemGroup>
    <COMReference Include="Inventor">
      <WrapperTool>tlbimp</WrapperTool>
      <VersionMinor>0</VersionMinor>
      <VersionMajor>1</VersionMajor>
      <Guid>d98a091d-3a0f-4c3e-b36e-61f62068d488</Guid>
      <Lcid>0</Lcid>
      <Isolated>false</Isolated>
      <EmbedInteropTypes>False</EmbedInteropTypes>
    </COMReference>
  </ItemGroup>

  <ItemGroup>
    <Reference Include="AdWindows">
      <HintPath>C:\Program Files\Autodesk\Inventor 2026\Bin\AdWindows.dll</HintPath>
      <Private>False</Private>
    </Reference>
  </ItemGroup>

  <ItemGroup>
    <None Update="NewTab.addin">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>

  <Target Name="PostBuild" AfterTargets="PostBuildEvent">
    <Exec Command="xcopy /y /d &quot;$(TargetDir)*.*&quot; &quot;%APPDATA%\Autodesk\Inventor 2026\Addins\&quot;" />
  </Target>

</Project>
```

#### Code Block 6

```vb
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net8.0-windows</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <EnableComHosting>true</EnableComHosting>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
  </PropertyGroup>

  <ItemGroup>
    <COMReference Include="Inventor">
      <WrapperTool>tlbimp</WrapperTool>
      <VersionMinor>0</VersionMinor>
      <VersionMajor>1</VersionMajor>
      <Guid>d98a091d-3a0f-4c3e-b36e-61f62068d488</Guid>
      <Lcid>0</Lcid>
      <Isolated>false</Isolated>
      <EmbedInteropTypes>False</EmbedInteropTypes>
    </COMReference>
  </ItemGroup>

  <ItemGroup>
    <Reference Include="AdWindows">
      <HintPath>C:\Program Files\Autodesk\Inventor 2026\Bin\AdWindows.dll</HintPath>
      <Private>False</Private>
    </Reference>
  </ItemGroup>

  <ItemGroup>
    <None Update="NewTab.addin">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>

  <Target Name="PostBuild" AfterTargets="PostBuildEvent">
    <Exec Command="xcopy /y /d &quot;$(TargetDir)*.*&quot; &quot;%APPDATA%\Autodesk\Inventor 2026\Addins\&quot;" />
  </Target>

</Project>
```

#### Code Block 7

```vb
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net8.0-windows</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <EnableComHosting>true</EnableComHosting>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
  </PropertyGroup>

  <ItemGroup>
    <COMReference Include="Inventor">
      <WrapperTool>tlbimp</WrapperTool>
      <VersionMinor>0</VersionMinor>
      <VersionMajor>1</VersionMajor>
      <Guid>d98a091d-3a0f-4c3e-b36e-61f62068d488</Guid>
      <Lcid>0</Lcid>
      <Isolated>false</Isolated>
      <EmbedInteropTypes>False</EmbedInteropTypes>
    </COMReference>
  </ItemGroup>

  <ItemGroup>
    <Reference Include="AdWindows">
      <HintPath>C:\Program Files\Autodesk\Inventor 2026\Bin\AdWindows.dll</HintPath>
      <Private>False</Private>
    </Reference>
  </ItemGroup>

  <ItemGroup>
    <None Update="NewTab.addin">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>

  <Target Name="PostBuild" AfterTargets="PostBuildEvent">
    <Exec Command="xcopy /y /d &quot;$(TargetDir)*.*&quot; &quot;%APPDATA%\Autodesk\Inventor 2026\Addins\&quot;" />
  </Target>

</Project>
```

#### Code Block 8

```vb
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net8.0-windows</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <EnableComHosting>true</EnableComHosting>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
  </PropertyGroup>

  <ItemGroup>
    <COMReference Include="Inventor">
      <WrapperTool>tlbimp</WrapperTool>
      <VersionMinor>0</VersionMinor>
      <VersionMajor>1</VersionMajor>
      <Guid>d98a091d-3a0f-4c3e-b36e-61f62068d488</Guid>
      <Lcid>0</Lcid>
      <Isolated>false</Isolated>
      <EmbedInteropTypes>False</EmbedInteropTypes>
    </COMReference>
  </ItemGroup>

  <ItemGroup>
    <Reference Include="AdWindows">
      <HintPath>C:\Program Files\Autodesk\Inventor 2026\Bin\AdWindows.dll</HintPath>
      <Private>False</Private>
    </Reference>
  </ItemGroup>

  <ItemGroup>
    <None Update="NewTab.addin">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>

  <Target Name="PostBuild" AfterTargets="PostBuildEvent">
    <Exec Command="xcopy /y /d &quot;$(TargetDir)*.*&quot; &quot;%APPDATA%\Autodesk\Inventor 2026\Addins\&quot;" />
  </Target>

</Project>
```

#### Code Block 9

```vb
Imports System.Runtime.InteropServices
Imports Inventor

' This GUID must match the ClassId and ClientId in your .addin file.
' The ComVisible(True) attribute makes this class visible to COM, which is how Inventor finds it.
<GuidAttribute("33B4722C-392E-4E34-9EA3-2E73DD0F1C13"), ComVisible(True)>
Public Class StandardAddInServer
    Implements ApplicationAddInServer

    Private m_inventorApplication As Application
    Private WithEvents m_appEvents As ApplicationEvents
    Private m_uiCreated As Boolean = False

    ' Store references to all created tabs to prevent garbage collection.
    Private m_tabs As New List(Of Inventor.RibbonTab)

    ' Use the user's local app data folder for the log file to avoid permissions issues.
    Private ReadOnly m_logFile As String = System.IO.Path.Combine(
        System.Environment.GetFolderPath(System.Environment.SpecialFolder.LocalApplicationData), "NewTabAddin", "log.txt")

    Private Sub Log(message As String)
        ' This function will write a timestamped message to our log file.
        Try
            Dim logDirectory As String = System.IO.Path.GetDirectoryName(m_logFile)
            If Not System.IO.Directory.Exists(logDirectory) Then
                System.IO.Directory.CreateDirectory(logDirectory)
            End If

            Dim logMessage = $"{DateTime.Now:yyyy-MM-dd HH:mm:ss.fff} - {message}{vbCrLf}"
            System.IO.File.AppendAllText(m_logFile, logMessage)
        Catch ex As Exception
            ' If logging fails, we can't do much, but this prevents a crash.
        End Try
    End Sub

    Public Sub Activate(ByVal addInSiteObject As ApplicationAddInSite, ByVal firstTime As Boolean) Implements ApplicationAddInServer.Activate
        Log("--- Add-in Activate Started ---")

        m_inventorApplication = addInSiteObject.Application
        Log("Successfully acquired Inventor Application object.")

        ' Hook into the OnReady event. This event fires once Inventor is fully loaded and idle.
        ' This is the most reliable time to create UI elements.
        m_appEvents = m_inventorApplication.ApplicationEvents
        Log("ApplicationEvents handler set up. Waiting for OnReady event.")

        Log("--- Add-in Activate Finished ---")
    End Sub

    Private Sub AppEvents_OnReady() Handles m_appEvents.OnReady
        Log("--- Inventor OnReady event fired. ---")
        ' The OnReady event can sometimes fire more than once. The flag ensures we only create the UI once.
        If Not m_uiCreated Then
            Log("UI not yet created. Proceeding to create UI.")
            CreateUserInterface()
            m_uiCreated = True
        End If
    End Sub

    Private Sub CreateUserInterface()
        Try
            Log("CreateUserInterface method started.")
            Dim uiMan As UserInterfaceManager = m_inventorApplication.UserInterfaceManager
            Log("Successfully acquired UserInterfaceManager.")

            If uiMan.InterfaceStyle = InterfaceStyleEnum.kRibbonInterface Then
                Log("Ribbon interface is active. Proceeding to create tabs.")

                ' Define the list of ribbons where the tab should appear.
                Dim ribbonNames As String() = {"ZeroDoc", "Part", "Assembly", "Drawing"}

                For Each ribbonName In ribbonNames
                    Try
                        Dim ribbon As Ribbon = uiMan.Ribbons.Item(ribbonName)
                        Log($"Successfully acquired '{ribbonName}' ribbon.")

                        ' Use a helper function to create the tab to avoid code duplication.
                        AddTabToRibbon(ribbon)

                    Catch ex As Exception
                        Log($"!!! WARNING: Could not access or modify the '{ribbonName}' ribbon. {ex.Message}")
                    End Try
                Next
            Else
                Log("Ribbon interface is not active. Aborting UI creation.")
            End If
            Log("--- UI Creation Finished ---")
        Catch ex As Exception
            Log($"!!! FATAL ERROR during UI Creation: {ex.ToString()} !!!")
        End Try
    End Sub

    Private Sub AddTabToRibbon(ByVal targetRibbon As Ribbon)
        Try
            ' Check if the tab already exists on this specific ribbon.
            Dim existingTab As Inventor.RibbonTab = Nothing
            Try
                existingTab = targetRibbon.RibbonTabs.Item("id_Tab_OP")
            Catch
                ' Item throws an error if not found, so we catch it and proceed.
            End Try

            If existingTab IsNot Nothing Then
                Log($"Found existing 'OP' tab on ribbon '{targetRibbon.DisplayName}'. No action needed.")
            Else
                Log($"'OP' tab not found on ribbon '{targetRibbon.DisplayName}', attempting to create it now.")
                Dim newTab As Inventor.RibbonTab = targetRibbon.RibbonTabs.Add(
                    DisplayName:="OP",
                    InternalName:="id_Tab_OP",
                    ClientId:="{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}")

                ' IMPORTANT: Add the new tab to our class-level list to keep it alive.
                m_tabs.Add(newTab)
                Log($"Successfully created 'OP' tab on ribbon '{targetRibbon.DisplayName}'.")
            End If
        Catch ex As Exception
            Log($"!!! ERROR adding tab to ribbon '{targetRibbon.DisplayName}': {ex.Message}")
        End Try
    End Sub

    Public Sub Deactivate() Implements ApplicationAddInServer.Deactivate
        Log("--- Add-in Deactivate ---")

        ' Clean up all created tab objects.
        For Each tab As Inventor.RibbonTab In m_tabs
            If tab IsNot Nothing Then
                Try
                    tab.Delete()
                    Marshal.ReleaseComObject(tab)
                Catch ex As Exception
                    Log($"Error during tab cleanup: {ex.Message}")
                End Try
            End If
        Next
        m_tabs.Clear()

        If m_inventorApplication IsNot Nothing Then
            Marshal.ReleaseComObject(m_inventorApplication)
            m_appEvents = Nothing
            m_inventorApplication = Nothing
        End If

        GC.Collect()
        GC.WaitForPendingFinalizers()
    End Sub

    Public ReadOnly Property Automation As Object Implements ApplicationAddInServer.Automation
        Get
            Return Nothing
        End Get
    End Property

    Public Sub ExecuteCommand(ByVal commandID As Integer) Implements ApplicationAddInServer.ExecuteCommand
        ' This method is obsolete.
    End Sub
End Class
```

#### Code Block 10

```vb
Imports System.Runtime.InteropServices
Imports Inventor

' This GUID must match the ClassId and ClientId in your .addin file.
' The ComVisible(True) attribute makes this class visible to COM, which is how Inventor finds it.
<GuidAttribute("33B4722C-392E-4E34-9EA3-2E73DD0F1C13"), ComVisible(True)>
Public Class StandardAddInServer
    Implements ApplicationAddInServer

    Private m_inventorApplication As Application
    Private WithEvents m_appEvents As ApplicationEvents
    Private m_uiCreated As Boolean = False

    ' Store references to all created tabs to prevent garbage collection.
    Private m_tabs As New List(Of Inventor.RibbonTab)

    ' Use the user's local app data folder for the log file to avoid permissions issues.
    Private ReadOnly m_logFile As String = System.IO.Path.Combine(
        System.Environment.GetFolderPath(System.Environment.SpecialFolder.LocalApplicationData), "NewTabAddin", "log.txt")

    Private Sub Log(message As String)
        ' This function will write a timestamped message to our log file.
        Try
            Dim logDirectory As String = System.IO.Path.GetDirectoryName(m_logFile)
            If Not System.IO.Directory.Exists(logDirectory) Then
                System.IO.Directory.CreateDirectory(logDirectory)
            End If

            Dim logMessage = $"{DateTime.Now:yyyy-MM-dd HH:mm:ss.fff} - {message}{vbCrLf}"
            System.IO.File.AppendAllText(m_logFile, logMessage)
        Catch ex As Exception
            ' If logging fails, we can't do much, but this prevents a crash.
        End Try
    End Sub

    Public Sub Activate(ByVal addInSiteObject As ApplicationAddInSite, ByVal firstTime As Boolean) Implements ApplicationAddInServer.Activate
        Log("--- Add-in Activate Started ---")

        m_inventorApplication = addInSiteObject.Application
        Log("Successfully acquired Inventor Application object.")

        ' Hook into the OnReady event. This event fires once Inventor is fully loaded and idle.
        ' This is the most reliable time to create UI elements.
        m_appEvents = m_inventorApplication.ApplicationEvents
        Log("ApplicationEvents handler set up. Waiting for OnReady event.")

        Log("--- Add-in Activate Finished ---")
    End Sub

    Private Sub AppEvents_OnReady() Handles m_appEvents.OnReady
        Log("--- Inventor OnReady event fired. ---")
        ' The OnReady event can sometimes fire more than once. The flag ensures we only create the UI once.
        If Not m_uiCreated Then
            Log("UI not yet created. Proceeding to create UI.")
            CreateUserInterface()
            m_uiCreated = True
        End If
    End Sub

    Private Sub CreateUserInterface()
        Try
            Log("CreateUserInterface method started.")
            Dim uiMan As UserInterfaceManager = m_inventorApplication.UserInterfaceManager
            Log("Successfully acquired UserInterfaceManager.")

            If uiMan.InterfaceStyle = InterfaceStyleEnum.kRibbonInterface Then
                Log("Ribbon interface is active. Proceeding to create tabs.")

                ' Define the list of ribbons where the tab should appear.
                Dim ribbonNames As String() = {"ZeroDoc", "Part", "Assembly", "Drawing"}

                For Each ribbonName In ribbonNames
                    Try
                        Dim ribbon As Ribbon = uiMan.Ribbons.Item(ribbonName)
                        Log($"Successfully acquired '{ribbonName}' ribbon.")

                        ' Use a helper function to create the tab to avoid code duplication.
                        AddTabToRibbon(ribbon)

                    Catch ex As Exception
                        Log($"!!! WARNING: Could not access or modify the '{ribbonName}' ribbon. {ex.Message}")
                    End Try
                Next
            Else
                Log("Ribbon interface is not active. Aborting UI creation.")
            End If
            Log("--- UI Creation Finished ---")
        Catch ex As Exception
            Log($"!!! FATAL ERROR during UI Creation: {ex.ToString()} !!!")
        End Try
    End Sub

    Private Sub AddTabToRibbon(ByVal targetRibbon As Ribbon)
        Try
            ' Check if the tab already exists on this specific ribbon.
            Dim existingTab As Inventor.RibbonTab = Nothing
            Try
                existingTab = targetRibbon.RibbonTabs.Item("id_Tab_OP")
            Catch
                ' Item throws an error if not found, so we catch it and proceed.
            End Try

            If existingTab IsNot Nothing Then
                Log($"Found existing 'OP' tab on ribbon '{targetRibbon.DisplayName}'. No action needed.")
            Else
                Log($"'OP' tab not found on ribbon '{targetRibbon.DisplayName}', attempting to create it now.")
                Dim newTab As Inventor.RibbonTab = targetRibbon.RibbonTabs.Add(
                    DisplayName:="OP",
                    InternalName:="id_Tab_OP",
                    ClientId:="{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}")

                ' IMPORTANT: Add the new tab to our class-level list to keep it alive.
                m_tabs.Add(newTab)
                Log($"Successfully created 'OP' tab on ribbon '{targetRibbon.DisplayName}'.")
            End If
        Catch ex As Exception
            Log($"!!! ERROR adding tab to ribbon '{targetRibbon.DisplayName}': {ex.Message}")
        End Try
    End Sub

    Public Sub Deactivate() Implements ApplicationAddInServer.Deactivate
        Log("--- Add-in Deactivate ---")

        ' Clean up all created tab objects.
        For Each tab As Inventor.RibbonTab In m_tabs
            If tab IsNot Nothing Then
                Try
                    tab.Delete()
                    Marshal.ReleaseComObject(tab)
                Catch ex As Exception
                    Log($"Error during tab cleanup: {ex.Message}")
                End Try
            End If
        Next
        m_tabs.Clear()

        If m_inventorApplication IsNot Nothing Then
            Marshal.ReleaseComObject(m_inventorApplication)
            m_appEvents = Nothing
            m_inventorApplication = Nothing
        End If

        GC.Collect()
        GC.WaitForPendingFinalizers()
    End Sub

    Public ReadOnly Property Automation As Object Implements ApplicationAddInServer.Automation
        Get
            Return Nothing
        End Get
    End Property

    Public Sub ExecuteCommand(ByVal commandID As Integer) Implements ApplicationAddInServer.ExecuteCommand
        ' This method is obsolete.
    End Sub
End Class
```

#### Code Block 11

```vb
Imports System.Runtime.InteropServices
Imports Inventor

' This GUID must match the ClassId and ClientId in your .addin file.
' The ComVisible(True) attribute makes this class visible to COM, which is how Inventor finds it.
<GuidAttribute("33B4722C-392E-4E34-9EA3-2E73DD0F1C13"), ComVisible(True)>
Public Class StandardAddInServer
    Implements ApplicationAddInServer

    Private m_inventorApplication As Application
    Private WithEvents m_appEvents As ApplicationEvents
    Private m_uiCreated As Boolean = False

    ' Store references to all created tabs to prevent garbage collection.
    Private m_tabs As New List(Of Inventor.RibbonTab)

    ' Use the user's local app data folder for the log file to avoid permissions issues.
    Private ReadOnly m_logFile As String = System.IO.Path.Combine(
        System.Environment.GetFolderPath(System.Environment.SpecialFolder.LocalApplicationData), "NewTabAddin", "log.txt")

    Private Sub Log(message As String)
        ' This function will write a timestamped message to our log file.
        Try
            Dim logDirectory As String = System.IO.Path.GetDirectoryName(m_logFile)
            If Not System.IO.Directory.Exists(logDirectory) Then
                System.IO.Directory.CreateDirectory(logDirectory)
            End If

            Dim logMessage = $"{DateTime.Now:yyyy-MM-dd HH:mm:ss.fff} - {message}{vbCrLf}"
            System.IO.File.AppendAllText(m_logFile, logMessage)
        Catch ex As Exception
            ' If logging fails, we can't do much, but this prevents a crash.
        End Try
    End Sub

    Public Sub Activate(ByVal addInSiteObject As ApplicationAddInSite, ByVal firstTime As Boolean) Implements ApplicationAddInServer.Activate
        Log("--- Add-in Activate Started ---")

        m_inventorApplication = addInSiteObject.Application
        Log("Successfully acquired Inventor Application object.")

        ' Hook into the OnReady event. This event fires once Inventor is fully loaded and idle.
        ' This is the most reliable time to create UI elements.
        m_appEvents = m_inventorApplication.ApplicationEvents
        Log("ApplicationEvents handler set up. Waiting for OnReady event.")

        Log("--- Add-in Activate Finished ---")
    End Sub

    Private Sub AppEvents_OnReady() Handles m_appEvents.OnReady
        Log("--- Inventor OnReady event fired. ---")
        ' The OnReady event can sometimes fire more than once. The flag ensures we only create the UI once.
        If Not m_uiCreated Then
            Log("UI not yet created. Proceeding to create UI.")
            CreateUserInterface()
            m_uiCreated = True
        End If
    End Sub

    Private Sub CreateUserInterface()
        Try
            Log("CreateUserInterface method started.")
            Dim uiMan As UserInterfaceManager = m_inventorApplication.UserInterfaceManager
            Log("Successfully acquired UserInterfaceManager.")

            If uiMan.InterfaceStyle = InterfaceStyleEnum.kRibbonInterface Then
                Log("Ribbon interface is active. Proceeding to create tabs.")

                ' Define the list of ribbons where the tab should appear.
                Dim ribbonNames As String() = {"ZeroDoc", "Part", "Assembly", "Drawing"}

                For Each ribbonName In ribbonNames
                    Try
                        Dim ribbon As Ribbon = uiMan.Ribbons.Item(ribbonName)
                        Log($"Successfully acquired '{ribbonName}' ribbon.")

                        ' Use a helper function to create the tab to avoid code duplication.
                        AddTabToRibbon(ribbon)

                    Catch ex As Exception
                        Log($"!!! WARNING: Could not access or modify the '{ribbonName}' ribbon. {ex.Message}")
                    End Try
                Next
            Else
                Log("Ribbon interface is not active. Aborting UI creation.")
            End If
            Log("--- UI Creation Finished ---")
        Catch ex As Exception
            Log($"!!! FATAL ERROR during UI Creation: {ex.ToString()} !!!")
        End Try
    End Sub

    Private Sub AddTabToRibbon(ByVal targetRibbon As Ribbon)
        Try
            ' Check if the tab already exists on this specific ribbon.
            Dim existingTab As Inventor.RibbonTab = Nothing
            Try
                existingTab = targetRibbon.RibbonTabs.Item("id_Tab_OP")
            Catch
                ' Item throws an error if not found, so we catch it and proceed.
            End Try

            If existingTab IsNot Nothing Then
                Log($"Found existing 'OP' tab on ribbon '{targetRibbon.DisplayName}'. No action needed.")
            Else
                Log($"'OP' tab not found on ribbon '{targetRibbon.DisplayName}', attempting to create it now.")
                Dim newTab As Inventor.RibbonTab = targetRibbon.RibbonTabs.Add(
                    DisplayName:="OP",
                    InternalName:="id_Tab_OP",
                    ClientId:="{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}")

                ' IMPORTANT: Add the new tab to our class-level list to keep it alive.
                m_tabs.Add(newTab)
                Log($"Successfully created 'OP' tab on ribbon '{targetRibbon.DisplayName}'.")
            End If
        Catch ex As Exception
            Log($"!!! ERROR adding tab to ribbon '{targetRibbon.DisplayName}': {ex.Message}")
        End Try
    End Sub

    Public Sub Deactivate() Implements ApplicationAddInServer.Deactivate
        Log("--- Add-in Deactivate ---")

        ' Clean up all created tab objects.
        For Each tab As Inventor.RibbonTab In m_tabs
            If tab IsNot Nothing Then
                Try
                    tab.Delete()
                    Marshal.ReleaseComObject(tab)
                Catch ex As Exception
                    Log($"Error during tab cleanup: {ex.Message}")
                End Try
            End If
        Next
        m_tabs.Clear()

        If m_inventorApplication IsNot Nothing Then
            Marshal.ReleaseComObject(m_inventorApplication)
            m_appEvents = Nothing
            m_inventorApplication = Nothing
        End If

        GC.Collect()
        GC.WaitForPendingFinalizers()
    End Sub

    Public ReadOnly Property Automation As Object Implements ApplicationAddInServer.Automation
        Get
            Return Nothing
        End Get
    End Property

    Public Sub ExecuteCommand(ByVal commandID As Integer) Implements ApplicationAddInServer.ExecuteCommand
        ' This method is obsolete.
    End Sub
End Class
```

#### Code Block 12

```vb
Imports System.Runtime.InteropServices
Imports Inventor

' This GUID must match the ClassId and ClientId in your .addin file.
' The ComVisible(True) attribute makes this class visible to COM, which is how Inventor finds it.
<GuidAttribute("33B4722C-392E-4E34-9EA3-2E73DD0F1C13"), ComVisible(True)>
Public Class StandardAddInServer
    Implements ApplicationAddInServer

    Private m_inventorApplication As Application
    Private WithEvents m_appEvents As ApplicationEvents
    Private m_uiCreated As Boolean = False

    ' Store references to all created tabs to prevent garbage collection.
    Private m_tabs As New List(Of Inventor.RibbonTab)

    ' Use the user's local app data folder for the log file to avoid permissions issues.
    Private ReadOnly m_logFile As String = System.IO.Path.Combine(
        System.Environment.GetFolderPath(System.Environment.SpecialFolder.LocalApplicationData), "NewTabAddin", "log.txt")

    Private Sub Log(message As String)
        ' This function will write a timestamped message to our log file.
        Try
            Dim logDirectory As String = System.IO.Path.GetDirectoryName(m_logFile)
            If Not System.IO.Directory.Exists(logDirectory) Then
                System.IO.Directory.CreateDirectory(logDirectory)
            End If

            Dim logMessage = $"{DateTime.Now:yyyy-MM-dd HH:mm:ss.fff} - {message}{vbCrLf}"
            System.IO.File.AppendAllText(m_logFile, logMessage)
        Catch ex As Exception
            ' If logging fails, we can't do much, but this prevents a crash.
        End Try
    End Sub

    Public Sub Activate(ByVal addInSiteObject As ApplicationAddInSite, ByVal firstTime As Boolean) Implements ApplicationAddInServer.Activate
        Log("--- Add-in Activate Started ---")

        m_inventorApplication = addInSiteObject.Application
        Log("Successfully acquired Inventor Application object.")

        ' Hook into the OnReady event. This event fires once Inventor is fully loaded and idle.
        ' This is the most reliable time to create UI elements.
        m_appEvents = m_inventorApplication.ApplicationEvents
        Log("ApplicationEvents handler set up. Waiting for OnReady event.")

        Log("--- Add-in Activate Finished ---")
    End Sub

    Private Sub AppEvents_OnReady() Handles m_appEvents.OnReady
        Log("--- Inventor OnReady event fired. ---")
        ' The OnReady event can sometimes fire more than once. The flag ensures we only create the UI once.
        If Not m_uiCreated Then
            Log("UI not yet created. Proceeding to create UI.")
            CreateUserInterface()
            m_uiCreated = True
        End If
    End Sub

    Private Sub CreateUserInterface()
        Try
            Log("CreateUserInterface method started.")
            Dim uiMan As UserInterfaceManager = m_inventorApplication.UserInterfaceManager
            Log("Successfully acquired UserInterfaceManager.")

            If uiMan.InterfaceStyle = InterfaceStyleEnum.kRibbonInterface Then
                Log("Ribbon interface is active. Proceeding to create tabs.")

                ' Define the list of ribbons where the tab should appear.
                Dim ribbonNames As String() = {"ZeroDoc", "Part", "Assembly", "Drawing"}

                For Each ribbonName In ribbonNames
                    Try
                        Dim ribbon As Ribbon = uiMan.Ribbons.Item(ribbonName)
                        Log($"Successfully acquired '{ribbonName}' ribbon.")

                        ' Use a helper function to create the tab to avoid code duplication.
                        AddTabToRibbon(ribbon)

                    Catch ex As Exception
                        Log($"!!! WARNING: Could not access or modify the '{ribbonName}' ribbon. {ex.Message}")
                    End Try
                Next
            Else
                Log("Ribbon interface is not active. Aborting UI creation.")
            End If
            Log("--- UI Creation Finished ---")
        Catch ex As Exception
            Log($"!!! FATAL ERROR during UI Creation: {ex.ToString()} !!!")
        End Try
    End Sub

    Private Sub AddTabToRibbon(ByVal targetRibbon As Ribbon)
        Try
            ' Check if the tab already exists on this specific ribbon.
            Dim existingTab As Inventor.RibbonTab = Nothing
            Try
                existingTab = targetRibbon.RibbonTabs.Item("id_Tab_OP")
            Catch
                ' Item throws an error if not found, so we catch it and proceed.
            End Try

            If existingTab IsNot Nothing Then
                Log($"Found existing 'OP' tab on ribbon '{targetRibbon.DisplayName}'. No action needed.")
            Else
                Log($"'OP' tab not found on ribbon '{targetRibbon.DisplayName}', attempting to create it now.")
                Dim newTab As Inventor.RibbonTab = targetRibbon.RibbonTabs.Add(
                    DisplayName:="OP",
                    InternalName:="id_Tab_OP",
                    ClientId:="{33B4722C-392E-4E34-9EA3-2E73DD0F1C13}")

                ' IMPORTANT: Add the new tab to our class-level list to keep it alive.
                m_tabs.Add(newTab)
                Log($"Successfully created 'OP' tab on ribbon '{targetRibbon.DisplayName}'.")
            End If
        Catch ex As Exception
            Log($"!!! ERROR adding tab to ribbon '{targetRibbon.DisplayName}': {ex.Message}")
        End Try
    End Sub

    Public Sub Deactivate() Implements ApplicationAddInServer.Deactivate
        Log("--- Add-in Deactivate ---")

        ' Clean up all created tab objects.
        For Each tab As Inventor.RibbonTab In m_tabs
            If tab IsNot Nothing Then
                Try
                    tab.Delete()
                    Marshal.ReleaseComObject(tab)
                Catch ex As Exception
                    Log($"Error during tab cleanup: {ex.Message}")
                End Try
            End If
        Next
        m_tabs.Clear()

        If m_inventorApplication IsNot Nothing Then
            Marshal.ReleaseComObject(m_inventorApplication)
            m_appEvents = Nothing
            m_inventorApplication = Nothing
        End If

        GC.Collect()
        GC.WaitForPendingFinalizers()
    End Sub

    Public ReadOnly Property Automation As Object Implements ApplicationAddInServer.Automation
        Get
            Return Nothing
        End Get
    End Property

    Public Sub ExecuteCommand(ByVal commandID As Integer) Implements ApplicationAddInServer.ExecuteCommand
        ' This method is obsolete.
    End Sub
End Class
```

#### Code Block 13

```vb
Private WithEvents m_buttonDef As ButtonDefinition
        Private Sub AddTabToRibbon(ByVal targetRibbon As Ribbon)

            Try
                ' Check if the tab already exists on this specific ribbon.
                Dim existingTab As Inventor.RibbonTab = Nothing
                Try
                    existingTab = targetRibbon.RibbonTabs.Item("id_Tab_OP_" & targetRibbon.InternalName)
                Catch
                    ' Item throws an error if not found, so we catch it and proceed.
                End Try

                If existingTab IsNot Nothing Then
                    Log($"Found existing 'OP' tab on ribbon '{targetRibbon.InternalName}'. No action needed.")
                Else
                    Log($"'OP' tab not found on ribbon '{targetRibbon.InternalName}', attempting to create it now.")
                    Dim newTab As Inventor.RibbonTab = Nothing
                    newTab = targetRibbon.RibbonTabs.Add(
                    DisplayName:="OP",
                    InternalName:="id_Tab_OP_" & targetRibbon.InternalName,
                    ClientId:=AddInClientID)

                    Dim opan As RibbonPanel = newTab.RibbonPanels.Add("OP", "id_Panel_OP_" & targetRibbon.InternalName, AddInClientID)
                    opan.Visible = True
                    newTab.Visible = True
                    Dim controlDefs As ControlDefinitions = m_inventorApplication.CommandManager.ControlDefinitions
                    m_buttonDef = controlDefs.AddButtonDefinition("One", "One_" & targetRibbon.InternalName, CommandTypesEnum.kNonShapeEditCmdType, AddInClientID)
                    opan.CommandControls.AddButton(m_buttonDef)
                    ' IMPORTANT: Add the new tab to our class-level list to keep it alive.
                    m_tabs.Add(newTab)
                    Log($"Successfully created 'OP' tab on ribbon '{targetRibbon.InternalName}'.")
                End If
            Catch ex As Exception
                Log($"!!! ERROR adding tab to ribbon '{targetRibbon.InternalName}': {ex.Message}")
            End Try
        End Sub
```

#### Code Block 14

```vb
Private WithEvents m_buttonDef As ButtonDefinition
        Private Sub AddTabToRibbon(ByVal targetRibbon As Ribbon)

            Try
                ' Check if the tab already exists on this specific ribbon.
                Dim existingTab As Inventor.RibbonTab = Nothing
                Try
                    existingTab = targetRibbon.RibbonTabs.Item("id_Tab_OP_" & targetRibbon.InternalName)
                Catch
                    ' Item throws an error if not found, so we catch it and proceed.
                End Try

                If existingTab IsNot Nothing Then
                    Log($"Found existing 'OP' tab on ribbon '{targetRibbon.InternalName}'. No action needed.")
                Else
                    Log($"'OP' tab not found on ribbon '{targetRibbon.InternalName}', attempting to create it now.")
                    Dim newTab As Inventor.RibbonTab = Nothing
                    newTab = targetRibbon.RibbonTabs.Add(
                    DisplayName:="OP",
                    InternalName:="id_Tab_OP_" & targetRibbon.InternalName,
                    ClientId:=AddInClientID)

                    Dim opan As RibbonPanel = newTab.RibbonPanels.Add("OP", "id_Panel_OP_" & targetRibbon.InternalName, AddInClientID)
                    opan.Visible = True
                    newTab.Visible = True
                    Dim controlDefs As ControlDefinitions = m_inventorApplication.CommandManager.ControlDefinitions
                    m_buttonDef = controlDefs.AddButtonDefinition("One", "One_" & targetRibbon.InternalName, CommandTypesEnum.kNonShapeEditCmdType, AddInClientID)
                    opan.CommandControls.AddButton(m_buttonDef)
                    ' IMPORTANT: Add the new tab to our class-level list to keep it alive.
                    m_tabs.Add(newTab)
                    Log($"Successfully created 'OP' tab on ribbon '{targetRibbon.InternalName}'.")
                End If
            Catch ex As Exception
                Log($"!!! ERROR adding tab to ribbon '{targetRibbon.InternalName}': {ex.Message}")
            End Try
        End Sub
```

#### Code Block 15

```vb
Private WithEvents m_buttonDef As ButtonDefinition
        Private Sub AddTabToRibbon(ByVal targetRibbon As Ribbon)

            Try
                ' Check if the tab already exists on this specific ribbon.
                Dim existingTab As Inventor.RibbonTab = Nothing
                Try
                    existingTab = targetRibbon.RibbonTabs.Item("id_Tab_OP_" & targetRibbon.InternalName)
                Catch
                    ' Item throws an error if not found, so we catch it and proceed.
                End Try

                If existingTab IsNot Nothing Then
                    Log($"Found existing 'OP' tab on ribbon '{targetRibbon.InternalName}'. No action needed.")
                Else
                    Log($"'OP' tab not found on ribbon '{targetRibbon.InternalName}', attempting to create it now.")
                    Dim newTab As Inventor.RibbonTab = Nothing
                    newTab = targetRibbon.RibbonTabs.Add(
                    DisplayName:="OP",
                    InternalName:="id_Tab_OP_" & targetRibbon.InternalName,
                    ClientId:=AddInClientID)

                    Dim opan As RibbonPanel = newTab.RibbonPanels.Add("OP", "id_Panel_OP_" & targetRibbon.InternalName, AddInClientID)
                    opan.Visible = True
                    newTab.Visible = True
                    Dim controlDefs As ControlDefinitions = m_inventorApplication.CommandManager.ControlDefinitions
                    m_buttonDef = controlDefs.AddButtonDefinition("One", "One_" & targetRibbon.InternalName, CommandTypesEnum.kNonShapeEditCmdType, AddInClientID)
                    opan.CommandControls.AddButton(m_buttonDef)
                    ' IMPORTANT: Add the new tab to our class-level list to keep it alive.
                    m_tabs.Add(newTab)
                    Log($"Successfully created 'OP' tab on ribbon '{targetRibbon.InternalName}'.")
                End If
            Catch ex As Exception
                Log($"!!! ERROR adding tab to ribbon '{targetRibbon.InternalName}': {ex.Message}")
            End Try
        End Sub
```

#### Code Block 16

```vb
Private WithEvents m_buttonDef As ButtonDefinition
        Private Sub AddTabToRibbon(ByVal targetRibbon As Ribbon)

            Try
                ' Check if the tab already exists on this specific ribbon.
                Dim existingTab As Inventor.RibbonTab = Nothing
                Try
                    existingTab = targetRibbon.RibbonTabs.Item("id_Tab_OP_" & targetRibbon.InternalName)
                Catch
                    ' Item throws an error if not found, so we catch it and proceed.
                End Try

                If existingTab IsNot Nothing Then
                    Log($"Found existing 'OP' tab on ribbon '{targetRibbon.InternalName}'. No action needed.")
                Else
                    Log($"'OP' tab not found on ribbon '{targetRibbon.InternalName}', attempting to create it now.")
                    Dim newTab As Inventor.RibbonTab = Nothing
                    newTab = targetRibbon.RibbonTabs.Add(
                    DisplayName:="OP",
                    InternalName:="id_Tab_OP_" & targetRibbon.InternalName,
                    ClientId:=AddInClientID)

                    Dim opan As RibbonPanel = newTab.RibbonPanels.Add("OP", "id_Panel_OP_" & targetRibbon.InternalName, AddInClientID)
                    opan.Visible = True
                    newTab.Visible = True
                    Dim controlDefs As ControlDefinitions = m_inventorApplication.CommandManager.ControlDefinitions
                    m_buttonDef = controlDefs.AddButtonDefinition("One", "One_" & targetRibbon.InternalName, CommandTypesEnum.kNonShapeEditCmdType, AddInClientID)
                    opan.CommandControls.AddButton(m_buttonDef)
                    ' IMPORTANT: Add the new tab to our class-level list to keep it alive.
                    m_tabs.Add(newTab)
                    Log($"Successfully created 'OP' tab on ribbon '{targetRibbon.InternalName}'.")
                End If
            Catch ex As Exception
                Log($"!!! ERROR adding tab to ribbon '{targetRibbon.InternalName}': {ex.Message}")
            End Try
        End Sub
```

---

### 44. Customized Event Triggers

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/customized-event-triggers/td-p/12275217](https://forums.autodesk.com/t5/inventor-programming-forum/customized-event-triggers/td-p/12275217)

**Author:** sultan_mustun

**Date:** ‎09-29-2023
	
		
		06:54 AM

**Description:** Hello,I wanted to know if there is a way to customize the Event Triggers. Or are there some codes that can do that, rather than using the Event triggers? For example in my case, I want to trigger an event when the Item number in the Parts List in my drawing changes. The goal is that if I change the ...

**Code Snippets (2):**

#### Code Block 1

```vb
If BeforeOrAfter = kBefore Then 'MessageBox.Show("Before changing parameter : " & Parameter.Value) ElseIf BeforeOrAfter = kAfter Then 'MessageBox.Show("After changing parameter : " & Parameter.Value) End If
```

#### Code Block 2

```vb
If BeforeOrAfter = kBefore Then 'MessageBox.Show("Before changing parameter : " & Parameter.Value) ElseIf BeforeOrAfter = kAfter Then 'MessageBox.Show("After changing parameter : " & Parameter.Value) End If
```

#### Code Block 3

```vb
If BeforeOrAfter = kBefore Then 'MessageBox.Show("Before changing parameter : " & Parameter.Value) ElseIf BeforeOrAfter = kAfter Then 'MessageBox.Show("After changing parameter : " & Parameter.Value) End If
```

#### Code Block 4

```vb
Sub Main() Dim oModelEvent As ModelingEvents  oModelEvent = ThisApplication.ModelingEvents   AddHandler oModelEvent.OnParameterChange, AddressOf oModelEvent_ParameterChangeEnd Sub Sub oModelEvent_ParameterChange(DocumentObject As _Document, Parameter As Parameter, BeforeOrAfter As EventTimingEnum, Context As NameValueMap, ByRef HandlingCode As HandlingCodeEnum)  If BeforeOrAfter = kBefore Then MessageBox.Show("Before changing parameter : " & Parameter.Value) ElseIf BeforeOrAfter = kAfter Then MessageBox.Show("After changing parameter : " & Parameter.Value) End If   End Sub
```

#### Code Block 5

```vb
Sub Main() Dim oModelEvent As ModelingEvents  oModelEvent = ThisApplication.ModelingEvents   AddHandler oModelEvent.OnParameterChange, AddressOf oModelEvent_ParameterChangeEnd Sub Sub oModelEvent_ParameterChange(DocumentObject As _Document, Parameter As Parameter, BeforeOrAfter As EventTimingEnum, Context As NameValueMap, ByRef HandlingCode As HandlingCodeEnum)  If BeforeOrAfter = kBefore Then MessageBox.Show("Before changing parameter : " & Parameter.Value) ElseIf BeforeOrAfter = kAfter Then MessageBox.Show("After changing parameter : " & Parameter.Value) End If   End Sub
```

#### Code Block 6

```vb
Sub Main() Dim oModelEvent As ModelingEvents  oModelEvent = ThisApplication.ModelingEvents   AddHandler oModelEvent.OnParameterChange, AddressOf oModelEvent_ParameterChangeEnd Sub Sub oModelEvent_ParameterChange(DocumentObject As _Document, Parameter As Parameter, BeforeOrAfter As EventTimingEnum, Context As NameValueMap, ByRef HandlingCode As HandlingCodeEnum)  If BeforeOrAfter = kBefore Then MessageBox.Show("Before changing parameter : " & Parameter.Value) ElseIf BeforeOrAfter = kAfter Then MessageBox.Show("After changing parameter : " & Parameter.Value) End If   End Sub
```

---

### 45. Cut a solid by RevolveFeature

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/cut-a-solid-by-revolvefeature/td-p/13837083](https://forums.autodesk.com/t5/inventor-programming-forum/cut-a-solid-by-revolvefeature/td-p/13837083)

**Author:** bruscaginmatteo

**Date:** ‎10-04-2025
	
		
		06:58 AM

**Description:** Hi, how can I choose the solid to cut with RevolveFeature?This is my code: Dim revolveFeatRemove As RevolveFeature = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01, oWorkAx, oElbowAngle, PartFeatureExtentDirectionEnum.kNegativeExtentDirection, PartFeatureOperationEnum.kCutOperation)...

**Code Snippets (11):**

#### Code Block 1

```vb
Dim BackTrimCol As ObjectCollection = oTO.CreateObjectCollection
			
			Dim BackTrimSketch As PlanarSketch 
			
			Dim BackProfile As Profile
			
			Dim BackStartPoint As SketchPoint, BackRectPoint As SketchPoint, Rect2StartPoint As SketchPoint, Rect2EndPoint As SketchPoint
			
			Dim Rectangle2 As SketchEntitiesEnumerator
			
			Dim Rect2Line1 As SketchLine, Rect2Line3 As SketchLine
			
			Dim BackStartDis As DimensionConstraint, Rect2Line1Con As DimensionConstraint, CenterControlA As DimensionConstraint, Rect2Line3con As DimensionConstraint, CenterControlB As DimensionConstraint
			
			Dim BackRevolveTrim as RevolveFeature
				
					
					BackTrimSketch = oCompDef.Sketches.Add(oUCS.YZPlane)
						BackTrimSketch.Name = FittingNameInput & " upper trim sketch "
					
					BackStartPoint = BackTrimSketch.AddByProjectingEntity(Proj_Point)
					
					BackRectPoint  = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackStartPoint.Geometry.X, BackStartPoint.Geometry.Y - 1)) 
						BackTrimSketch.GeometricConstraints.AddVerticalAlign(BackStartPoint, BackRectPoint)
						
						BackStartDis = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, BackStartPoint, Inventor.DimensionOrientationEnum.kAlignedDim, oTG.CreatePoint2d(10, 10))
							BackStartDis.Parameter.Expression = FittingNameInput & "_Fitting_Proj" & "*2 " & "+tank_id+sidewall_th*2"
							
						oDoc.Update	
							
						Rect2StartPoint = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackRectPoint.Geometry.X - 5, BackRectPoint.Geometry.Y - 5))
						Rect2EndPoint = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackRectPoint.Geometry.X + 5, BackRectPoint.Geometry.Y + 5))
							
						Rectangle2 = BackTrimSketch.SketchLines.AddAsTwoPointRectangle(Rect2StartPoint, Rect2EndPoint)	
							
							Rect2Line1 = Rectangle2.Item(2)
							Rect2Line3 = Rectangle2.Item(3)
							
							Rect2Line1Con = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(Rect2Line1.StartSketchPoint, Rect2Line1.EndSketchPoint, Inventor.DimensionOrientationEnum.kVerticalDim, oTG.CreatePoint2d(3, 3))
								Rect2Line1Con.Parameter.Expression = "(6+sidewall_th+3)*2+12"
									
							CenterControlA = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, Rect2EndPoint, Inventor.DimensionOrientationEnum.kVerticalDim, oTG.CreatePoint2d(-6, -6))
								CenterControlA.Parameter.Expression = "(6+sidewall_th)+3"
								
							Rect2Line3con= BackTrimSketch.DimensionConstraints.AddTwoPointDistance(Rect2Line3.StartSketchPoint, Rect2Line3.EndSketchPoint, Inventor.DimensionOrientationEnum.kHorizontalDim, oTG.CreatePoint2d(-3, -3))
								Rect2Line3Con.Parameter.Value = 48 * 2.54
								
							CenterControlB = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, Rect2StartPoint, Inventor.DimensionOrientationEnum.kHorizontalDim, oTG.CreatePoint2d(6, 6))
								CenterControlB.Parameter.Value = 24 * 2.54 
									
						BackProfile = BackTrimSketch.Profiles.AddForSolid
						
							oDoc.Update
						
								'The below is calculating the area to cut away from the outside
								Dim Ratio As Double =  (oUserParams.Item(FittingNameInput & "_Flange_Size").Value / 2) / (tank_id / 2) 
								Dim ThetaRad As Double = 2 * Math.Asin(Ratio)
								Dim ThetaDeg As Double = ThetaRad * (180 / Math.PI)
								
								Dim AdjustedAngle As Double = 360 - ThetaDeg 
								Dim AdjustedRad As Double = AdjustedAngle * Math.PI /180
								
					
						BackRevolveTrim = oCompDef.Features.RevolveFeatures.AddByAngle(BackProfile, oUCS.YAxis, AdjustedRad, Inventor.PartFeatureExtentDirectionEnum.kSymmetricExtentDirection, Inventor.PartFeatureOperationEnum.kCutOperation)
							BackRevolveTrim.Name = FittingNameInput & " Upper trim revolution "
							BackRevolveTrim.SetAffectedBodies(TrimCol)
						
						
						If InputAngle = 0 Then 
						
							BackRevolveTrim.Suppressed = True
							RevolveTrim.Suppressed = False
						Else 	
							'Logger.Info("Inside the revolve trim suppression")
							RevolveTrim.Suppressed = False 'This should be turning on based on the input we have entered. 
							BackRevolveTrim.Suppressed = False
						End If
```

#### Code Block 2

```vb
Dim BackTrimCol As ObjectCollection = oTO.CreateObjectCollection
			
			Dim BackTrimSketch As PlanarSketch 
			
			Dim BackProfile As Profile
			
			Dim BackStartPoint As SketchPoint, BackRectPoint As SketchPoint, Rect2StartPoint As SketchPoint, Rect2EndPoint As SketchPoint
			
			Dim Rectangle2 As SketchEntitiesEnumerator
			
			Dim Rect2Line1 As SketchLine, Rect2Line3 As SketchLine
			
			Dim BackStartDis As DimensionConstraint, Rect2Line1Con As DimensionConstraint, CenterControlA As DimensionConstraint, Rect2Line3con As DimensionConstraint, CenterControlB As DimensionConstraint
			
			Dim BackRevolveTrim as RevolveFeature
				
					
					BackTrimSketch = oCompDef.Sketches.Add(oUCS.YZPlane)
						BackTrimSketch.Name = FittingNameInput & " upper trim sketch "
					
					BackStartPoint = BackTrimSketch.AddByProjectingEntity(Proj_Point)
					
					BackRectPoint  = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackStartPoint.Geometry.X, BackStartPoint.Geometry.Y - 1)) 
						BackTrimSketch.GeometricConstraints.AddVerticalAlign(BackStartPoint, BackRectPoint)
						
						BackStartDis = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, BackStartPoint, Inventor.DimensionOrientationEnum.kAlignedDim, oTG.CreatePoint2d(10, 10))
							BackStartDis.Parameter.Expression = FittingNameInput & "_Fitting_Proj" & "*2 " & "+tank_id+sidewall_th*2"
							
						oDoc.Update	
							
						Rect2StartPoint = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackRectPoint.Geometry.X - 5, BackRectPoint.Geometry.Y - 5))
						Rect2EndPoint = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackRectPoint.Geometry.X + 5, BackRectPoint.Geometry.Y + 5))
							
						Rectangle2 = BackTrimSketch.SketchLines.AddAsTwoPointRectangle(Rect2StartPoint, Rect2EndPoint)	
							
							Rect2Line1 = Rectangle2.Item(2)
							Rect2Line3 = Rectangle2.Item(3)
							
							Rect2Line1Con = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(Rect2Line1.StartSketchPoint, Rect2Line1.EndSketchPoint, Inventor.DimensionOrientationEnum.kVerticalDim, oTG.CreatePoint2d(3, 3))
								Rect2Line1Con.Parameter.Expression = "(6+sidewall_th+3)*2+12"
									
							CenterControlA = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, Rect2EndPoint, Inventor.DimensionOrientationEnum.kVerticalDim, oTG.CreatePoint2d(-6, -6))
								CenterControlA.Parameter.Expression = "(6+sidewall_th)+3"
								
							Rect2Line3con= BackTrimSketch.DimensionConstraints.AddTwoPointDistance(Rect2Line3.StartSketchPoint, Rect2Line3.EndSketchPoint, Inventor.DimensionOrientationEnum.kHorizontalDim, oTG.CreatePoint2d(-3, -3))
								Rect2Line3Con.Parameter.Value = 48 * 2.54
								
							CenterControlB = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, Rect2StartPoint, Inventor.DimensionOrientationEnum.kHorizontalDim, oTG.CreatePoint2d(6, 6))
								CenterControlB.Parameter.Value = 24 * 2.54 
									
						BackProfile = BackTrimSketch.Profiles.AddForSolid
						
							oDoc.Update
						
								'The below is calculating the area to cut away from the outside
								Dim Ratio As Double =  (oUserParams.Item(FittingNameInput & "_Flange_Size").Value / 2) / (tank_id / 2) 
								Dim ThetaRad As Double = 2 * Math.Asin(Ratio)
								Dim ThetaDeg As Double = ThetaRad * (180 / Math.PI)
								
								Dim AdjustedAngle As Double = 360 - ThetaDeg 
								Dim AdjustedRad As Double = AdjustedAngle * Math.PI /180
								
					
						BackRevolveTrim = oCompDef.Features.RevolveFeatures.AddByAngle(BackProfile, oUCS.YAxis, AdjustedRad, Inventor.PartFeatureExtentDirectionEnum.kSymmetricExtentDirection, Inventor.PartFeatureOperationEnum.kCutOperation)
							BackRevolveTrim.Name = FittingNameInput & " Upper trim revolution "
							BackRevolveTrim.SetAffectedBodies(TrimCol)
						
						
						If InputAngle = 0 Then 
						
							BackRevolveTrim.Suppressed = True
							RevolveTrim.Suppressed = False
						Else 	
							'Logger.Info("Inside the revolve trim suppression")
							RevolveTrim.Suppressed = False 'This should be turning on based on the input we have entered. 
							BackRevolveTrim.Suppressed = False
						End If
```

#### Code Block 3

```vb
Dim BackTrimCol As ObjectCollection = oTO.CreateObjectCollection
			
			Dim BackTrimSketch As PlanarSketch 
			
			Dim BackProfile As Profile
			
			Dim BackStartPoint As SketchPoint, BackRectPoint As SketchPoint, Rect2StartPoint As SketchPoint, Rect2EndPoint As SketchPoint
			
			Dim Rectangle2 As SketchEntitiesEnumerator
			
			Dim Rect2Line1 As SketchLine, Rect2Line3 As SketchLine
			
			Dim BackStartDis As DimensionConstraint, Rect2Line1Con As DimensionConstraint, CenterControlA As DimensionConstraint, Rect2Line3con As DimensionConstraint, CenterControlB As DimensionConstraint
			
			Dim BackRevolveTrim as RevolveFeature
				
					
					BackTrimSketch = oCompDef.Sketches.Add(oUCS.YZPlane)
						BackTrimSketch.Name = FittingNameInput & " upper trim sketch "
					
					BackStartPoint = BackTrimSketch.AddByProjectingEntity(Proj_Point)
					
					BackRectPoint  = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackStartPoint.Geometry.X, BackStartPoint.Geometry.Y - 1)) 
						BackTrimSketch.GeometricConstraints.AddVerticalAlign(BackStartPoint, BackRectPoint)
						
						BackStartDis = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, BackStartPoint, Inventor.DimensionOrientationEnum.kAlignedDim, oTG.CreatePoint2d(10, 10))
							BackStartDis.Parameter.Expression = FittingNameInput & "_Fitting_Proj" & "*2 " & "+tank_id+sidewall_th*2"
							
						oDoc.Update	
							
						Rect2StartPoint = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackRectPoint.Geometry.X - 5, BackRectPoint.Geometry.Y - 5))
						Rect2EndPoint = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackRectPoint.Geometry.X + 5, BackRectPoint.Geometry.Y + 5))
							
						Rectangle2 = BackTrimSketch.SketchLines.AddAsTwoPointRectangle(Rect2StartPoint, Rect2EndPoint)	
							
							Rect2Line1 = Rectangle2.Item(2)
							Rect2Line3 = Rectangle2.Item(3)
							
							Rect2Line1Con = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(Rect2Line1.StartSketchPoint, Rect2Line1.EndSketchPoint, Inventor.DimensionOrientationEnum.kVerticalDim, oTG.CreatePoint2d(3, 3))
								Rect2Line1Con.Parameter.Expression = "(6+sidewall_th+3)*2+12"
									
							CenterControlA = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, Rect2EndPoint, Inventor.DimensionOrientationEnum.kVerticalDim, oTG.CreatePoint2d(-6, -6))
								CenterControlA.Parameter.Expression = "(6+sidewall_th)+3"
								
							Rect2Line3con= BackTrimSketch.DimensionConstraints.AddTwoPointDistance(Rect2Line3.StartSketchPoint, Rect2Line3.EndSketchPoint, Inventor.DimensionOrientationEnum.kHorizontalDim, oTG.CreatePoint2d(-3, -3))
								Rect2Line3Con.Parameter.Value = 48 * 2.54
								
							CenterControlB = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, Rect2StartPoint, Inventor.DimensionOrientationEnum.kHorizontalDim, oTG.CreatePoint2d(6, 6))
								CenterControlB.Parameter.Value = 24 * 2.54 
									
						BackProfile = BackTrimSketch.Profiles.AddForSolid
						
							oDoc.Update
						
								'The below is calculating the area to cut away from the outside
								Dim Ratio As Double =  (oUserParams.Item(FittingNameInput & "_Flange_Size").Value / 2) / (tank_id / 2) 
								Dim ThetaRad As Double = 2 * Math.Asin(Ratio)
								Dim ThetaDeg As Double = ThetaRad * (180 / Math.PI)
								
								Dim AdjustedAngle As Double = 360 - ThetaDeg 
								Dim AdjustedRad As Double = AdjustedAngle * Math.PI /180
								
					
						BackRevolveTrim = oCompDef.Features.RevolveFeatures.AddByAngle(BackProfile, oUCS.YAxis, AdjustedRad, Inventor.PartFeatureExtentDirectionEnum.kSymmetricExtentDirection, Inventor.PartFeatureOperationEnum.kCutOperation)
							BackRevolveTrim.Name = FittingNameInput & " Upper trim revolution "
							BackRevolveTrim.SetAffectedBodies(TrimCol)
						
						
						If InputAngle = 0 Then 
						
							BackRevolveTrim.Suppressed = True
							RevolveTrim.Suppressed = False
						Else 	
							'Logger.Info("Inside the revolve trim suppression")
							RevolveTrim.Suppressed = False 'This should be turning on based on the input we have entered. 
							BackRevolveTrim.Suppressed = False
						End If
```

#### Code Block 4

```vb
Dim BackTrimCol As ObjectCollection = oTO.CreateObjectCollection
			
			Dim BackTrimSketch As PlanarSketch 
			
			Dim BackProfile As Profile
			
			Dim BackStartPoint As SketchPoint, BackRectPoint As SketchPoint, Rect2StartPoint As SketchPoint, Rect2EndPoint As SketchPoint
			
			Dim Rectangle2 As SketchEntitiesEnumerator
			
			Dim Rect2Line1 As SketchLine, Rect2Line3 As SketchLine
			
			Dim BackStartDis As DimensionConstraint, Rect2Line1Con As DimensionConstraint, CenterControlA As DimensionConstraint, Rect2Line3con As DimensionConstraint, CenterControlB As DimensionConstraint
			
			Dim BackRevolveTrim as RevolveFeature
				
					
					BackTrimSketch = oCompDef.Sketches.Add(oUCS.YZPlane)
						BackTrimSketch.Name = FittingNameInput & " upper trim sketch "
					
					BackStartPoint = BackTrimSketch.AddByProjectingEntity(Proj_Point)
					
					BackRectPoint  = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackStartPoint.Geometry.X, BackStartPoint.Geometry.Y - 1)) 
						BackTrimSketch.GeometricConstraints.AddVerticalAlign(BackStartPoint, BackRectPoint)
						
						BackStartDis = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, BackStartPoint, Inventor.DimensionOrientationEnum.kAlignedDim, oTG.CreatePoint2d(10, 10))
							BackStartDis.Parameter.Expression = FittingNameInput & "_Fitting_Proj" & "*2 " & "+tank_id+sidewall_th*2"
							
						oDoc.Update	
							
						Rect2StartPoint = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackRectPoint.Geometry.X - 5, BackRectPoint.Geometry.Y - 5))
						Rect2EndPoint = BackTrimSketch.SketchPoints.Add(oTG.CreatePoint2d(BackRectPoint.Geometry.X + 5, BackRectPoint.Geometry.Y + 5))
							
						Rectangle2 = BackTrimSketch.SketchLines.AddAsTwoPointRectangle(Rect2StartPoint, Rect2EndPoint)	
							
							Rect2Line1 = Rectangle2.Item(2)
							Rect2Line3 = Rectangle2.Item(3)
							
							Rect2Line1Con = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(Rect2Line1.StartSketchPoint, Rect2Line1.EndSketchPoint, Inventor.DimensionOrientationEnum.kVerticalDim, oTG.CreatePoint2d(3, 3))
								Rect2Line1Con.Parameter.Expression = "(6+sidewall_th+3)*2+12"
									
							CenterControlA = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, Rect2EndPoint, Inventor.DimensionOrientationEnum.kVerticalDim, oTG.CreatePoint2d(-6, -6))
								CenterControlA.Parameter.Expression = "(6+sidewall_th)+3"
								
							Rect2Line3con= BackTrimSketch.DimensionConstraints.AddTwoPointDistance(Rect2Line3.StartSketchPoint, Rect2Line3.EndSketchPoint, Inventor.DimensionOrientationEnum.kHorizontalDim, oTG.CreatePoint2d(-3, -3))
								Rect2Line3Con.Parameter.Value = 48 * 2.54
								
							CenterControlB = BackTrimSketch.DimensionConstraints.AddTwoPointDistance(BackRectPoint, Rect2StartPoint, Inventor.DimensionOrientationEnum.kHorizontalDim, oTG.CreatePoint2d(6, 6))
								CenterControlB.Parameter.Value = 24 * 2.54 
									
						BackProfile = BackTrimSketch.Profiles.AddForSolid
						
							oDoc.Update
						
								'The below is calculating the area to cut away from the outside
								Dim Ratio As Double =  (oUserParams.Item(FittingNameInput & "_Flange_Size").Value / 2) / (tank_id / 2) 
								Dim ThetaRad As Double = 2 * Math.Asin(Ratio)
								Dim ThetaDeg As Double = ThetaRad * (180 / Math.PI)
								
								Dim AdjustedAngle As Double = 360 - ThetaDeg 
								Dim AdjustedRad As Double = AdjustedAngle * Math.PI /180
								
					
						BackRevolveTrim = oCompDef.Features.RevolveFeatures.AddByAngle(BackProfile, oUCS.YAxis, AdjustedRad, Inventor.PartFeatureExtentDirectionEnum.kSymmetricExtentDirection, Inventor.PartFeatureOperationEnum.kCutOperation)
							BackRevolveTrim.Name = FittingNameInput & " Upper trim revolution "
							BackRevolveTrim.SetAffectedBodies(TrimCol)
						
						
						If InputAngle = 0 Then 
						
							BackRevolveTrim.Suppressed = True
							RevolveTrim.Suppressed = False
						Else 	
							'Logger.Info("Inside the revolve trim suppression")
							RevolveTrim.Suppressed = False 'This should be turning on based on the input we have entered. 
							BackRevolveTrim.Suppressed = False
						End If
```

#### Code Block 5

```vb
Dim oInvApp As Inventor.Application=ThisApplication
Dim Parte As PartDocument = ThisDoc.Document
Dim DefinizioneParte As PartComponentDefinition=Parte.ComponentDefinition
Dim oFeatures As PartFeatures
oFeatures = DefinizioneParte.Features
Dim objects As ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection

For Each body As SurfaceBody  In DefinizioneParte.SurfaceBodies
objects.Add(body)
Next

 Dim oProfile01 As Profile = oInvApp.CommandManager.Pick(SelectionFilterEnum.kSketchProfileFilter,"pick profile to revolve")
 Dim oWorkAx As WorkAxis = oInvApp.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter,"pick axis to revolve")
 Dim oElbowAngle As Double =1

Dim revolveFeatRemove2 As RevolveFeature
revolveFeatRemove2 = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01,oWorkAx,oElbowAngle,PartFeatureExtentDirectionEnum.kNegativeExtentDirection,PartFeatureOperationEnum.kCutOperation)
revolveFeatRemove2.SetAffectedBodies(objects )
```

#### Code Block 6

```vb
Dim oInvApp As Inventor.Application=ThisApplication
Dim Parte As PartDocument = ThisDoc.Document
Dim DefinizioneParte As PartComponentDefinition=Parte.ComponentDefinition
Dim oFeatures As PartFeatures
oFeatures = DefinizioneParte.Features
Dim objects As ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection

For Each body As SurfaceBody  In DefinizioneParte.SurfaceBodies
objects.Add(body)
Next

 Dim oProfile01 As Profile = oInvApp.CommandManager.Pick(SelectionFilterEnum.kSketchProfileFilter,"pick profile to revolve")
 Dim oWorkAx As WorkAxis = oInvApp.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter,"pick axis to revolve")
 Dim oElbowAngle As Double =1

Dim revolveFeatRemove2 As RevolveFeature
revolveFeatRemove2 = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01,oWorkAx,oElbowAngle,PartFeatureExtentDirectionEnum.kNegativeExtentDirection,PartFeatureOperationEnum.kCutOperation)
revolveFeatRemove2.SetAffectedBodies(objects )
```

#### Code Block 7

```vb
Dim oInvApp As Inventor.Application=ThisApplication
Dim Parte As PartDocument = ThisDoc.Document
Dim DefinizioneParte As PartComponentDefinition=Parte.ComponentDefinition
Dim oFeatures As PartFeatures
oFeatures = DefinizioneParte.Features
Dim objects As ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection

For Each body As SurfaceBody  In DefinizioneParte.SurfaceBodies
objects.Add(body)
Next

 Dim oProfile01 As Profile = oInvApp.CommandManager.Pick(SelectionFilterEnum.kSketchProfileFilter,"pick profile to revolve")
 Dim oWorkAx As WorkAxis = oInvApp.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter,"pick axis to revolve")
 Dim oElbowAngle As Double =1

Dim revolveFeatRemove2 As RevolveFeature
revolveFeatRemove2 = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01,oWorkAx,oElbowAngle,PartFeatureExtentDirectionEnum.kNegativeExtentDirection,PartFeatureOperationEnum.kCutOperation)
revolveFeatRemove2.SetAffectedBodies(objects )
```

#### Code Block 8

```vb
Dim oInvApp As Inventor.Application=ThisApplication
Dim Parte As PartDocument = ThisDoc.Document
Dim DefinizioneParte As PartComponentDefinition=Parte.ComponentDefinition
Dim oFeatures As PartFeatures
oFeatures = DefinizioneParte.Features
Dim objects As ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection

For Each body As SurfaceBody  In DefinizioneParte.SurfaceBodies
objects.Add(body)
Next

 Dim oProfile01 As Profile = oInvApp.CommandManager.Pick(SelectionFilterEnum.kSketchProfileFilter,"pick profile to revolve")
 Dim oWorkAx As WorkAxis = oInvApp.CommandManager.Pick(SelectionFilterEnum.kWorkAxisFilter,"pick axis to revolve")
 Dim oElbowAngle As Double =1

Dim revolveFeatRemove2 As RevolveFeature
revolveFeatRemove2 = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01,oWorkAx,oElbowAngle,PartFeatureExtentDirectionEnum.kNegativeExtentDirection,PartFeatureOperationEnum.kCutOperation)
revolveFeatRemove2.SetAffectedBodies(objects )
```

#### Code Block 9

```vb
Dim objects As ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection
Dim revolveFeatRemove2 As RevolveFeature
revolveFeatRemove2 = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01, oWorkAx, oElbowAngle, PartFeatureExtentDirectionEnum.kNegativeExtentDirection, PartFeatureOperationEnum.kCutOperation)

objects.Clear

For Each body As SurfaceBody In DefinizioneParte.SurfaceBodies
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then  objects.Add(body)
Next
revolveFeatRemove2.SetAffectedBodies(objects)
```

#### Code Block 10

```vb
Dim objects As ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection
Dim revolveFeatRemove2 As RevolveFeature
revolveFeatRemove2 = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01, oWorkAx, oElbowAngle, PartFeatureExtentDirectionEnum.kNegativeExtentDirection, PartFeatureOperationEnum.kCutOperation)

objects.Clear

For Each body As SurfaceBody In DefinizioneParte.SurfaceBodies
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then  objects.Add(body)
Next
revolveFeatRemove2.SetAffectedBodies(objects)
```

#### Code Block 11

```vb
Dim objects As ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection
Dim revolveFeatRemove2 As RevolveFeature
revolveFeatRemove2 = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01, oWorkAx, oElbowAngle, PartFeatureExtentDirectionEnum.kNegativeExtentDirection, PartFeatureOperationEnum.kCutOperation)

objects.Clear

For Each body As SurfaceBody In DefinizioneParte.SurfaceBodies
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then  objects.Add(body)
Next
revolveFeatRemove2.SetAffectedBodies(objects)
```

#### Code Block 12

```vb
Dim objects As ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection
Dim revolveFeatRemove2 As RevolveFeature
revolveFeatRemove2 = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01, oWorkAx, oElbowAngle, PartFeatureExtentDirectionEnum.kNegativeExtentDirection, PartFeatureOperationEnum.kCutOperation)

objects.Clear

For Each body As SurfaceBody In DefinizioneParte.SurfaceBodies
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then  objects.Add(body)
Next
revolveFeatRemove2.SetAffectedBodies(objects)
```

#### Code Block 13

```vb
For Each body As SurfaceBody In DefinizioneParte.SurfaceBodies
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then  objects.Add(body)
Next
```

#### Code Block 14

```vb
For Each body As SurfaceBody In DefinizioneParte.SurfaceBodies
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then  objects.Add(body)
Next
```

#### Code Block 15

```vb
For Each body As SurfaceBody In DefinizioneParte.SurfaceBodies
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then  objects.Add(body)
Next
```

#### Code Block 16

```vb
For Each body As SurfaceBody In DefinizioneParte.SurfaceBodies
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then  objects.Add(body)
Next
```

#### Code Block 17

```vb
Hi, how can I choose the solid to cut with RevolveFeature?This is my code: Dim revolveFeatRemove As RevolveFeature = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01, oWorkAx, oElbowAngle, PartFeatureExtentDirectionEnum.kNegativeExtentDirection, PartFeatureOperationEnum.kCutOperation)Thanks in advance
```

#### Code Block 18

```vb
Hi, how can I choose the solid to cut with RevolveFeature?This is my code: Dim revolveFeatRemove As RevolveFeature = DefinizioneParte.Features.RevolveFeatures.AddByAngle(oProfile01, oWorkAx, oElbowAngle, PartFeatureExtentDirectionEnum.kNegativeExtentDirection, PartFeatureOperationEnum.kCutOperation)Thanks in advance
```

#### Code Block 19

```vb
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then objects.Add(Estrusione.SurfaceBodies(1))
```

#### Code Block 20

```vb
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then objects.Add(Estrusione.SurfaceBodies(1))
```

#### Code Block 21

```vb
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then objects.Add(Estrusione.SurfaceBodies(1))
```

#### Code Block 22

```vb
If body IsNot revolveFeatRemove2.SurfaceBodies(1) Then objects.Add(Estrusione.SurfaceBodies(1))
```

---

### 46. DXF method with INI not working, sOut version works

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/dxf-method-with-ini-not-working-sout-version-works/td-p/13844011](https://forums.autodesk.com/t5/inventor-programming-forum/dxf-method-with-ini-not-working-sout-version-works/td-p/13844011)

**Author:** Curtis_Waguespack

**Date:** ‎10-08-2025
	
		
		12:59 PM

**Description:** I have a rule to write out a DXF from a part, using SaveCopyAs and an *.ini file that I can not get to work. It writes out an invalid DXF file.If I use WriteDataToFile with sOut string, all works.see attached 2025 file and the *.ini file I'm using ( which works manually)Can someone let me know what ...

**Code Snippets (2):**

#### Code Block 1

```vb
Sub Main

	DXFFolder = "C:\Temp\DXF\"
	oModelDocName = ThisDoc.Document.FullFileName
	DXFName = IO.Path.GetFileNameWithoutExtension(oModelDocName) & "-INI"

	Dim oInv As Application = ThisApplication
	Dim oDoc As Document = oInv.Documents.Open(oModelDocName, True)

	Dim oSheetDef As SheetMetalComponentDefinition = oDoc.ComponentDefinition

	If oSheetDef.HasFlatPattern = False Then
		oSheetDef.Unfold
	Else
		oSheetDef.FlatPattern.Edit
	End If

	'Set the DXF target file name
	If Not IO.Directory.Exists(DXFFolder) Then IO.Directory.CreateDirectory(DXFFolder)

	'Get the DXF translator Add-In.
	Dim DXFAddIn As TranslatorAddIn
	DXFAddIn = oInv.ApplicationAddIns.ItemById("{C24E3AC4-122E-11D5-8E91-0010B541CD80}")

	'Create a DataMedium object
	Dim oDataMedium As DataMedium
	oDataMedium = oInv.TransientObjects.CreateDataMedium

	'Create a TranslationContext object
	Dim oContext As TranslationContext
	oContext = ThisApplication.TransientObjects.CreateTranslationContext
	oContext.Type = IOMechanismEnum.kFileBrowseIOMechanism

	'Get the Design Data Path
	Dim INI_Folder As String
	INI_Folder = "C:\Temp\DXF\DXF configs\"

	'Create a NameValueMap object
	Dim oOptions As NameValueMap
	oOptions = oInv.TransientObjects.CreateNameValueMap

	'Specify the INI file path for exporting
	Dim iniFilePath As String = INI_Folder & "PC_flatpatterns.ini"
	oOptions.Value("Export_Acad_IniFile") = iniFilePath

	'MsgBox(INI_Folder & "PC_flatpatterns.ini")

	'Define the file name
	oDataMedium.FileName = DXFFolder & DXFName & ".dxf"
	
		MsgBox(	oDataMedium.FileName )


	'	'Specify the AutoCAD version to export to (AutoCAD 2004)
	'	oOptions.Value("Export_AcadVersion") = 16

	'Publish document.
	DXFAddIn.SaveCopyAs(oDoc, oContext, oOptions, oDataMedium)



End Sub
```

#### Code Block 2

```vb
Sub Main 

DXFFolder = "C:\Temp\DXF\"
oModelDocName = ThisDoc.Document.FullFileName
DXFName = IO.Path.GetFileNameWithoutExtension(oModelDocName) & "-sOUT"

	Dim oInv As Application = ThisApplication
	Dim oDoc As Document = oInv.Documents.Open(oModelDocName, False)


	Dim oSheetDef As SheetMetalComponentDefinition = oDoc.ComponentDefinition

	If oSheetDef.HasFlatPattern = False Then
		oSheetDef.Unfold
	End If

	oDataMedium = oInv.TransientObjects.CreateDataMedium

	If Not IO.Directory.Exists(DXFFolder) Then IO.Directory.CreateDirectory(DXFFolder)

	'Set the DXF target file name
	oDataMedium.FileName = DXFFolder & DXFName & ".dxf"
	
	MsgBox(	oDataMedium.FileName )

	Dim sOut As String = GetFormatString

	oSheetDef.DataIO.WriteDataToFile(sOut, oDataMedium.FileName)



End Sub

'set up the output string
Function GetFormatString() As String
	
	'https://help.autodesk.com/view/INVNTOR/2026/ENU/?guid=GUID-DataIO

	Dim FormatedString As String
	FormatedString = "FLAT PATTERN DXF?AcadVersion=2007" & _
	"&TangentLayer=IV_TANGENT " & _
	"&BendLayer=IV_BEND" & _
	"&BendDownLayer=IV_BEND_DOWN" & _
	"&ToolCenterLayer=IV_TOOL_CENTER" & _
	"&ToolCenterDownLayer=IV_TOOL_CENTER_DOWN" & _
	"&ArcCentersLayer=IV_ARC_CENTERS" & _
	"&OuterProfileLayer=IV_OUTER_PROFILE" & _
	"&InteriorProfilesLayer=IV_INTERIOR_PROFILES" & _
	"&FeatureProfilesLayer=IV_FEATURE_PROFILES" & _
	"&FeatureProfilesDownLayer=IV_FEATURE_PROFILES_DOWN" & _
	"&AltRepFrontLayer=IV_ALTREP_FRONT" & _
	"&AltRepBackLayer=IV_ALTREP_BACK" & _
	"&UnconsumedSketchesLayer=IV_UNCONSUMED_SKETCHES" & _
	"&TangentRollLinesLayer=IV_ROLL_TANGENT" & _
	"&RollLinesLayer=IV_ROLL" & _
	"&InvisibleLayers=IV_TANGENT;IV_ROLL_TANGENT" & _
	"&TangentLayerColor=0;0;0 " & _
	"&endLayerColor=255;0;0" & _
	"&BendDownLayerColor=0;255;0" & _
	"&ToolCenterLayerColor=0;0;0" & _
	"&ToolCenterDownLayerColor=0;0;0" & _
	"&ArcCentersLayerColor=0;0;0" & _
	"&OuterProfileLayerColor=0;0;0" & _
	"&InteriorProfilesLayerColor=0;0;0" & _
	"&FeatureProfilesLayerColor=0;0;0" & _
	"&FeatureProfilesDownLayerColor=0;0;0" & _
	"&AltRepFrontLayerColor=0;0;0" & _
	"&AltRepBackLayerColor=0;0;0" & _
	"&UnconsumedSketchesLayerColor=-255;-255;-255" & _
	"&TangentRollLinesLayerColor=0;0;0" & _
	"&RollLinesLayerColor=0;0;0" & _
	"&MergeProfilesIntoPolyline=True"
	Return FormatedString

End Function
```

---

### 47. Defining A-Side for sheet metal part using Entitys

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/defining-a-side-for-sheet-metal-part-using-entitys/td-p/13759776](https://forums.autodesk.com/t5/inventor-programming-forum/defining-a-side-for-sheet-metal-part-using-entitys/td-p/13759776)

**Author:** ashSPTSS

**Date:** ‎08-08-2025
	
		
		05:25 AM

**Description:** Hi I were wondering if anyone know if it is possible to use iLogic to change which side is the A-Side.I have named the 2 faces that i have the posibilities of using as my a side using the "Assign Entity Name" feature and would like to be able to change between the 2 sides being the A-side determined...

**Code Snippets (8):**

#### Code Block 1

```vb
Dim oMyNamedEntity = ThisDoc.NamedEntities.TryGetEntities("entity name")
```

#### Code Block 2

```vb
Dim oMyNamedEntity = ThisDoc.NamedEntities.TryGetEntities("entity name")
```

#### Code Block 3

```vb
Dim oNEs As NamedEntities = iLogicVb.Automation.GetNamedEntities(oDoc)
Dim oMyNamedEntity = oNEs.TryGetEntity("entity name")
```

#### Code Block 4

```vb
Dim oNEs As NamedEntities = iLogicVb.Automation.GetNamedEntities(oDoc)
Dim oMyNamedEntity = oNEs.TryGetEntity("entity name")
```

#### Code Block 5

```vb
Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument
Dim oPartCompDef As SheetMetalComponentDefinition = oPartDoc.ComponentDefinition

Dim bHasFlatPattern As Boolean = oPartCompDef.HasFlatPattern
If bHasFlatPattern = True Then oPartCompDef.FlatPattern.Delete

Dim oASideDefinitions As ASideDefinitions = oPartCompDef.ASideDefinitions

If oASideDefinitions.Count <> 0 Then
	For i As Integer = 1 To oASideDefinitions.Count
		oASideDefinitions.Item(i).Delete
	Next
End If

Dim sNamedEntityName As String = A_Side
Dim oFace As Face = ThisDoc.NamedEntities.TryGetEntity(sNamedEntityName)

If oFace IsNot Nothing Then oASideDefinitions.Add(oFace)

If bHasFlatPattern = True Then oPartCompDef.Unfold
```

#### Code Block 6

```vb
Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument
Dim oPartCompDef As SheetMetalComponentDefinition = oPartDoc.ComponentDefinition

Dim bHasFlatPattern As Boolean = oPartCompDef.HasFlatPattern
If bHasFlatPattern = True Then oPartCompDef.FlatPattern.Delete

Dim oASideDefinitions As ASideDefinitions = oPartCompDef.ASideDefinitions

If oASideDefinitions.Count <> 0 Then
	For i As Integer = 1 To oASideDefinitions.Count
		oASideDefinitions.Item(i).Delete
	Next
End If

Dim sNamedEntityName As String = A_Side
Dim oFace As Face = ThisDoc.NamedEntities.TryGetEntity(sNamedEntityName)

If oFace IsNot Nothing Then oASideDefinitions.Add(oFace)

If bHasFlatPattern = True Then oPartCompDef.Unfold
```

#### Code Block 7

```vb
Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument
Dim oPartCompDef As SheetMetalComponentDefinition = oPartDoc.ComponentDefinition

Dim bHasFlatPattern As Boolean = oPartCompDef.HasFlatPattern
If bHasFlatPattern = True Then oPartCompDef.FlatPattern.Delete

Dim oASideDefinitions As ASideDefinitions = oPartCompDef.ASideDefinitions

If oASideDefinitions.Count <> 0 Then
	For i As Integer = 1 To oASideDefinitions.Count
		oASideDefinitions.Item(i).Delete
	Next
End If
Dim A_Side
If Orientation = "RD"
	A_Side = "RD_Back"
Else 
	A_Side = "LG_Back"
End If


Dim sNamedEntityName As String = A_Side
Dim oFace As Face = ThisDoc.NamedEntities.TryGetEntity(sNamedEntityName)

If oFace IsNot Nothing Then oASideDefinitions.Add(oFace)

If bHasFlatPattern = True Then oPartCompDef.Unfold
```

#### Code Block 8

```vb
Dim partDoc As PartDocument = ThisDoc.Document
Dim compDef As SheetMetalComponentDefinition = partDoc.ComponentDefinition

If (compDef.HasFlatPattern) Then
	compDef.FlatPattern.Delete
End If

If Orientation = "RD"
	'compDef.ASideDefinitions.Add(RD Back) '<-- Not Working
Else If Orientation = "LG"
	'compDef.ASideDefinitions.Add(LG Back) '<-- Not Working
End If
```

---

### 48. Dimension Visibility

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/dimension-visibility/td-p/13758740](https://forums.autodesk.com/t5/inventor-programming-forum/dimension-visibility/td-p/13758740)

**Author:** layochim

**Date:** ‎08-07-2025
	
		
		12:46 PM

**Description:** Hello,  I'm trying to hide dimensions on my drawing.  I found a rule that worked the first go around but now it's throwing an error.  I'm suppressing a feature and then turning the feature back on for certain conditions.Is there a better alternative to turning dimensions off or is the code getting c...

**Code Snippets (3):**

#### Code Block 1

```vb
If Parameter("STRAIGHT CONVEYOR.iam.Legs") = "No" Then
oHideOption = True
		oDoc = ThisDoc.Document

		Try
			'try to create the layer
			oOrphanLayer = oDoc.StylesManager.Layers.Item(1).Copy("Orphan Dims")
		Catch
			'assume error means layer already exists and
			'assign layer to variable
			oOrphanLayer = oDoc.StylesManager.Layers.Item("Orphan Dims")
			oLayer = oDoc.StylesManager.Layers.Item("Dimension(ISO)")
		End Try

		If oHideOption = True Then
			'Loop through all dimensions
			Dim oDrawingDim As DrawingDimension
			For Each oDrawingDim In oDoc.ActiveSheet.DrawingDimensions
				'look at only unattached dims
				If oDrawingDim.Attached = False Then
					' set the layer to the dummy layer 
					oDrawingDim.Layer = oOrphanLayer
				Else
					oDrawingDim.Layer = oLayer 
				End If
			Next
			'hide the layer 
			oOrphanLayer.Visible = False
		Else
			'show the layer 
			oOrphanLayer.Visible = True
		End If
		oDoc.Update
	End If
```

#### Code Block 2

```vb
If Parameter("STRAIGHT CONVEYOR.iam.Legs") = "No" Then
oHideOption = True
		oDoc = ThisDoc.Document

		Try
			'try to create the layer
			oOrphanLayer = oDoc.StylesManager.Layers.Item(1).Copy("Orphan Dims")
		Catch
			'assume error means layer already exists and
			'assign layer to variable
			oOrphanLayer = oDoc.StylesManager.Layers.Item("Orphan Dims")
			oLayer = oDoc.StylesManager.Layers.Item("Dimension(ISO)")
		End Try

		If oHideOption = True Then
			'Loop through all dimensions
			Dim oDrawingDim As DrawingDimension
			For Each oDrawingDim In oDoc.ActiveSheet.DrawingDimensions
				'look at only unattached dims
				If oDrawingDim.Attached = False Then
					' set the layer to the dummy layer 
					oDrawingDim.Layer = oOrphanLayer
				Else
					oDrawingDim.Layer = oLayer 
				End If
			Next
			'hide the layer 
			oOrphanLayer.Visible = False
		Else
			'show the layer 
			oOrphanLayer.Visible = True
		End If
		oDoc.Update
	End If
```

#### Code Block 3

```vb
oLayer = oDoc.StylesManager.Layers.Item("Dimension(ISO)")
```

#### Code Block 4

```vb
oLayer = oDoc.StylesManager.Layers.Item("Dimension(ISO)")
```

#### Code Block 5

```vb
oLayer = oDoc.StylesManager.Layers.Item("Dimension(ISO)")
```

#### Code Block 6

```vb
oLayer = oDoc.StylesManager.Layers.Item("Dimension(ISO)")
```

---

### 49. Drawing HoleThreadNote Formatted Text Bug Precision and Tolerance when not set.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/drawing-holethreadnote-formatted-text-bug-precision-and/td-p/13222899](https://forums.autodesk.com/t5/inventor-programming-forum/drawing-holethreadnote-formatted-text-bug-precision-and/td-p/13222899)

**Author:** g.georgiades

**Date:** ‎12-20-2024
	
		
		10:49 AM

**Description:** I have found myself delving into processing HoleTheadNotes. However it is proving quite frustrating due to an inherit bug in the way the API is returning the FormattedHoleThreadNote text. (And the way inventor processes xml, but that is anothe story) There have been a few posts over the years about ...

**Code Snippets (18):**

#### Code Block 1

```vb
<HoleProperty HolePropertyID='kCBoreDiameterHoleProperty'
				  SetTolerances='False'/>
```

#### Code Block 2

```vb
<HoleProperty HolePropertyID='kCBoreDiameterHoleProperty'
				  SetTolerances='False'/>
```

#### Code Block 3

```vb
<HoleProperty HolePropertyID='kCBoreDiameterHoleProperty'
				  SetTolerances='False'/>
```

#### Code Block 4

```vb
<HoleProperty HolePropertyID='kCBoreDiameterHoleProperty'
				  SetTolerances='False'/>
```

#### Code Block 5

```vb
<HoleProperty HolePropertyID='kCBoreDiameterHoleProperty'
	              Precision='2'
	              AlternatePrecision='2'
	              UpperTolerance='0.000000'
	              LowerTolerance='0.000000'
	              ToleranceType='kSymmetricTolerance'
	              TolerancePrecision='2'
	              ToleranceAlternatePrecision='3'/>
```

#### Code Block 6

```vb
<HoleProperty HolePropertyID='kCBoreDiameterHoleProperty'
	              Precision='2'
	              AlternatePrecision='2'
	              UpperTolerance='0.000000'
	              LowerTolerance='0.000000'
	              ToleranceType='kSymmetricTolerance'
	              TolerancePrecision='2'
	              ToleranceAlternatePrecision='3'/>
```

#### Code Block 7

```vb
<HoleProperty HolePropertyID='kCBoreDiameterHoleProperty'
	              Precision='2'
	              AlternatePrecision='2'
	              UpperTolerance='0.000000'
	              LowerTolerance='0.000000'
	              ToleranceType='kSymmetricTolerance'
	              TolerancePrecision='2'
	              ToleranceAlternatePrecision='3'/>
```

#### Code Block 8

```vb
<HoleProperty HolePropertyID='kCBoreDiameterHoleProperty'
	              Precision='2'
	              AlternatePrecision='2'
	              UpperTolerance='0.000000'
	              LowerTolerance='0.000000'
	              ToleranceType='kSymmetricTolerance'
	              TolerancePrecision='2'
	              ToleranceAlternatePrecision='3'/>
```

#### Code Block 9

```vb
<HoleProperty HolePropertyID='kCSinkDiameterHoleProperty'
	              SetTolerances='False'/>
```

#### Code Block 10

```vb
<HoleProperty HolePropertyID='kCSinkDiameterHoleProperty'
	              SetTolerances='False'/>
```

#### Code Block 11

```vb
<HoleProperty HolePropertyID='kCSinkDiameterHoleProperty'
	              SetTolerances='False'/>
```

#### Code Block 12

```vb
<HoleProperty HolePropertyID='kCSinkDiameterHoleProperty'
	              SetTolerances='False'/>
```

#### Code Block 13

```vb
<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' UpperTolerance='0.000000' LowerTolerance='0.000000' ToleranceType='kSymmetricTolerance' TolerancePrecision='2' ToleranceAlternatePrecision='3'></HoleProperty></StyleOverride>
```

#### Code Block 14

```vb
<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' UpperTolerance='0.000000' LowerTolerance='0.000000' ToleranceType='kSymmetricTolerance' TolerancePrecision='2' ToleranceAlternatePrecision='3'></HoleProperty></StyleOverride>
```

#### Code Block 15

```vb
<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' UpperTolerance='0.000000' LowerTolerance='0.000000' ToleranceType='kSymmetricTolerance' TolerancePrecision='2' ToleranceAlternatePrecision='3'></HoleProperty></StyleOverride>
```

#### Code Block 16

```vb
<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' UpperTolerance='0.000000' LowerTolerance='0.000000' ToleranceType='kSymmetricTolerance' TolerancePrecision='2' ToleranceAlternatePrecision='3'></HoleProperty></StyleOverride>
```

#### Code Block 17

```vb
Precision='3' AlternatePrecision='3'
```

#### Code Block 18

```vb
Precision='3' AlternatePrecision='3'
```

#### Code Block 19

```vb
Precision='3' AlternatePrecision='3'
```

#### Code Block 20

```vb
Precision='3' AlternatePrecision='3'
```

#### Code Block 21

```vb
Sub Main

	Dim sel As SelectSet = Thisdoc.Document.SelectSet

	If sel.Count = 0 OrElse typeof sel.Item(1) IsNot HoleThreadNote
		MsgBox("Please select a HoleThreadNote and only a HoleThreadNote!")
		Exit Sub
	End If

	Dim note As HoleThreadNote = ThisDoc.Document.SelectSet.Item(1)
	Dim noteText = note.FormattedHoleThreadNote

	System.Windows.Forms.Clipboard.SetText(note.FormattedHoleThreadNote)

	If note.FormattedHoleThreadNote.Contains("CBoreDiameter")

		noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"

	Else

		noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kHoleDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"

	End If

	note.FormattedHoleThreadNote = noteText

End Sub
```

#### Code Block 22

```vb
Sub Main

	Dim sel As SelectSet = Thisdoc.Document.SelectSet

	If sel.Count = 0 OrElse typeof sel.Item(1) IsNot HoleThreadNote
		MsgBox("Please select a HoleThreadNote and only a HoleThreadNote!")
		Exit Sub
	End If

	Dim note As HoleThreadNote = ThisDoc.Document.SelectSet.Item(1)
	Dim noteText = note.FormattedHoleThreadNote

	System.Windows.Forms.Clipboard.SetText(note.FormattedHoleThreadNote)

	If note.FormattedHoleThreadNote.Contains("CBoreDiameter")

		noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"

	Else

		noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kHoleDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"

	End If

	note.FormattedHoleThreadNote = noteText

End Sub
```

#### Code Block 23

```vb
Sub Main

	Dim sel As SelectSet = Thisdoc.Document.SelectSet

	If sel.Count = 0 OrElse typeof sel.Item(1) IsNot HoleThreadNote
		MsgBox("Please select a HoleThreadNote and only a HoleThreadNote!")
		Exit Sub
	End If

	Dim note As HoleThreadNote = ThisDoc.Document.SelectSet.Item(1)
	Dim noteText = note.FormattedHoleThreadNote

	System.Windows.Forms.Clipboard.SetText(note.FormattedHoleThreadNote)

	If note.FormattedHoleThreadNote.Contains("CBoreDiameter")

		noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"

	Else

		noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kHoleDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"

	End If

	note.FormattedHoleThreadNote = noteText

End Sub
```

#### Code Block 24

```vb
Sub Main

	Dim sel As SelectSet = Thisdoc.Document.SelectSet

	If sel.Count = 0 OrElse typeof sel.Item(1) IsNot HoleThreadNote
		MsgBox("Please select a HoleThreadNote and only a HoleThreadNote!")
		Exit Sub
	End If

	Dim note As HoleThreadNote = ThisDoc.Document.SelectSet.Item(1)
	Dim noteText = note.FormattedHoleThreadNote

	System.Windows.Forms.Clipboard.SetText(note.FormattedHoleThreadNote)

	If note.FormattedHoleThreadNote.Contains("CBoreDiameter")

		noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"

	Else

		noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kHoleDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"

	End If

	note.FormattedHoleThreadNote = noteText

End Sub
```

#### Code Block 25

```vb
Text Value: n1 1/4`1/2 x 15/16\Z0;v n\Z1; x 5/16`0

<StyleOverride Font='AIGDT' FontSize='0.254'>n</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77581&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>x</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77580&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<Br/>
<StyleOverride Font='AIGDT' FontSize='0.254'>v</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'> </StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>n</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77570&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>x</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77569&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
```

#### Code Block 26

```vb
Text Value: n1 1/4`1/2 x 15/16\Z0;v n\Z1; x 5/16`0

<StyleOverride Font='AIGDT' FontSize='0.254'>n</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77581&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>x</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77580&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<Br/>
<StyleOverride Font='AIGDT' FontSize='0.254'>v</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'> </StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>n</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77570&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>x</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77569&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
```

#### Code Block 27

```vb
Text Value: n1 1/4`1/2 x 15/16\Z0;v n\Z1; x 5/16`0

<StyleOverride Font='AIGDT' FontSize='0.254'>n</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77581&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>x</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77580&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<Br/>
<StyleOverride Font='AIGDT' FontSize='0.254'>v</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'> </StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>n</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77570&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>x</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77569&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
```

#### Code Block 28

```vb
Text Value: n1 1/4`1/2 x 15/16\Z0;v n\Z1; x 5/16`0

<StyleOverride Font='AIGDT' FontSize='0.254'>n</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77581&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>x</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77580&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<Br/>
<StyleOverride Font='AIGDT' FontSize='0.254'>v</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'> </StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>n</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77570&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
<StyleOverride Font='AIGDT' FontSize='0.254'>x</StyleOverride>
<StyleOverride Font='RomanD' FontSize='0.254'>
	<HoleProperty HolePropertyID=&apos;77569&apos; Precision=&apos;2&apos;></HoleProperty>
</StyleOverride>
```

#### Code Block 29

```vb
noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"
```

#### Code Block 30

```vb
noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"
```

#### Code Block 31

```vb
noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"
```

#### Code Block 32

```vb
noteText = "<StyleOverride Font='RomanD' FontSize='0.254'><HoleProperty HolePropertyID='kCBoreDiameterHoleProperty' Precision='3' AlternatePrecision='3' SetTolerances='False'></HoleProperty></StyleOverride>"
```

#### Code Block 33

```vb
Ø1.25 +.0625|-.0013 [32 +1.588|-.034] ↧ .95±.01 [24±.152] TO FLAT BOTTOM ⌴ Ø 2.82 - 2.63 [71.526 - 66.751] ↧ .30±.000 [8±.000]
Ø15/16±0 [24±.254] ↧ 15/16 +17/128|+1/128 [24 +3.302|+.198] TO FLAT BOTTOM ⌴ Ø 3 13/64 - -2 1/2 [81.305 - -63.475] ↧ 5/16 +1|-1/2 [8 +27.940|-10.160]
```

#### Code Block 34

```vb
Ø1.25 +.0625|-.0013 [32 +1.588|-.034] ↧ .95±.01 [24±.152] TO FLAT BOTTOM ⌴ Ø 2.82 - 2.63 [71.526 - 66.751] ↧ .30±.000 [8±.000]
Ø15/16±0 [24±.254] ↧ 15/16 +17/128|+1/128 [24 +3.302|+.198] TO FLAT BOTTOM ⌴ Ø 3 13/64 - -2 1/2 [81.305 - -63.475] ↧ 5/16 +1|-1/2 [8 +27.940|-10.160]
```

#### Code Block 35

```vb
Ø1.25 +.0625|-.0013 [32 +1.588|-.034] ↧ .95±.01 [24±.152] TO FLAT BOTTOM ⌴ Ø 2.82 - 2.63 [71.526 - 66.751] ↧ .30±.000 [8±.000]
Ø15/16±0 [24±.254] ↧ 15/16 +17/128|+1/128 [24 +3.302|+.198] TO FLAT BOTTOM ⌴ Ø 3 13/64 - -2 1/2 [81.305 - -63.475] ↧ 5/16 +1|-1/2 [8 +27.940|-10.160]
```

#### Code Block 36

```vb
Ø1.25 +.0625|-.0013 [32 +1.588|-.034] ↧ .95±.01 [24±.152] TO FLAT BOTTOM ⌴ Ø 2.82 - 2.63 [71.526 - 66.751] ↧ .30±.000 [8±.000]
Ø15/16±0 [24±.254] ↧ 15/16 +17/128|+1/128 [24 +3.302|+.198] TO FLAT BOTTOM ⌴ Ø 3 13/64 - -2 1/2 [81.305 - -63.475] ↧ 5/16 +1|-1/2 [8 +27.940|-10.160]
```

---

### 50. Drawing View Labels

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/drawing-view-labels/td-p/10094985](https://forums.autodesk.com/t5/inventor-programming-forum/drawing-view-labels/td-p/10094985)

**Author:** Anonymous

**Date:** ‎02-18-2021
	
		
		06:31 PM

**Description:** Hi, I am using Inventor 2021 and using the ilogic rule below to populate the View Labels on my Drawings as per the View Cube and it works well.Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet Dim tmpView As DrawingView For Each tmpView In tmpSheet.DrawingViews     Dim myDrawingViewName As Strin...

**Code Snippets (12):**

#### Code Block 1

```vb
Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, DrawingDocument)
If oDDoc Is Nothing Then Return
For Each oSheet As Inventor.Sheet In oDDoc.Sheets
	For Each oDView As DrawingView In oSheet.DrawingViews
		If (TypeOf oDView Is DetailDrawingView) Then Continue For
		If (TypeOf oDView Is SectionDrawingView) Then Continue For
		Dim sViewOrientType As String = oDView.Camera.ViewOrientationType.ToString()
		oDView.ShowLabel = True
		oDView.Name = Mid(sViewOrientType, 2, Len(sViewOrientType) -16).ToUpper()
	Next
Next
```

#### Code Block 2

```vb
Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, DrawingDocument)
If oDDoc Is Nothing Then Return
For Each oSheet As Inventor.Sheet In oDDoc.Sheets
	For Each oDView As DrawingView In oSheet.DrawingViews
		If (TypeOf oDView Is DetailDrawingView) Then Continue For
		If (TypeOf oDView Is SectionDrawingView) Then Continue For
		Dim sViewOrientType As String = oDView.Camera.ViewOrientationType.ToString()
		oDView.ShowLabel = True
		oDView.Name = Mid(sViewOrientType, 2, Len(sViewOrientType) -16).ToUpper()
	Next
Next
```

#### Code Block 3

```vb
Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, DrawingDocument)
If oDDoc Is Nothing Then Return
For Each oSheet As Inventor.Sheet In oDDoc.Sheets
	For Each oDView As DrawingView In oSheet.DrawingViews
		If (TypeOf oDView Is DetailDrawingView) Then Continue For
		If (TypeOf oDView Is SectionDrawingView) Then Continue For
		Dim sViewOrientType As String = oDView.Camera.ViewOrientationType.ToString()
		oDView.ShowLabel = True
		oDView.Name = Mid(sViewOrientType, 2, Len(sViewOrientType) -16).ToUpper()
	Next
Next
```

#### Code Block 4

```vb
Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, DrawingDocument)
If oDDoc Is Nothing Then Return
For Each oSheet As Inventor.Sheet In oDDoc.Sheets
	For Each oDView As DrawingView In oSheet.DrawingViews
		If (TypeOf oDView Is DetailDrawingView) Then Continue For
		If (TypeOf oDView Is SectionDrawingView) Then Continue For
		Dim sViewOrientType As String = oDView.Camera.ViewOrientationType.ToString()
		oDView.ShowLabel = True
		oDView.Name = Mid(sViewOrientType, 2, Len(sViewOrientType) -16).ToUpper()
	Next
Next
```

#### Code Block 5

```vb
Dim oDoc As DrawingDocument = ThisDrawing.Document
Dim oViews As DrawingViews
Dim oOrientType As ViewOrientationTypeEnum
Dim oOrigViewName As String
Dim oNewViewName As String
For Each oSheet As Sheet In oDoc.Sheets
	oViews = oSheet.DrawingViews
	For Each oView As DrawingView In oViews
		oOrientType = oView.Camera.ViewOrientationType
		oOrigViewName = oView.Name
		oNewViewName = Mid(oOrientType.ToString, 2, Len(oOrientType.ToString) -16)
		oView.ShowLabel = True
		oView.Name = oNewViewName.ToUpper
	Next
Next
```

#### Code Block 6

```vb
Dim oDoc As DrawingDocument = ThisDrawing.Document
Dim oViews As DrawingViews
Dim oOrientType As ViewOrientationTypeEnum
Dim oOrigViewName As String
Dim oNewViewName As String
For Each oSheet As Sheet In oDoc.Sheets
	oViews = oSheet.DrawingViews
	For Each oView As DrawingView In oViews
		oOrientType = oView.Camera.ViewOrientationType
		oOrigViewName = oView.Name
		oNewViewName = Mid(oOrientType.ToString, 2, Len(oOrientType.ToString) -16)
		oView.ShowLabel = True
		oView.Name = oNewViewName.ToUpper
	Next
Next
```

#### Code Block 7

```vb
Dim oDoc As DrawingDocument = ThisDrawing.Document
Dim oViews As DrawingViews
Dim oOrientType As ViewOrientationTypeEnum
Dim oOrigViewName As String
Dim oNewViewName As String
For Each oSheet As Sheet In oDoc.Sheets
	oViews = oSheet.DrawingViews
	For Each oView As DrawingView In oViews
		oOrientType = oView.Camera.ViewOrientationType
		oOrigViewName = oView.Name
		oNewViewName = Mid(oOrientType.ToString, 2, Len(oOrientType.ToString) -16)
		oView.ShowLabel = True
		oView.Name = oNewViewName.ToUpper
	Next
Next
```

#### Code Block 8

```vb
Dim oDoc As DrawingDocument = ThisDrawing.Document
Dim oViews As DrawingViews
Dim oOrientType As ViewOrientationTypeEnum
Dim oOrigViewName As String
Dim oNewViewName As String
For Each oSheet As Sheet In oDoc.Sheets
	oViews = oSheet.DrawingViews
	For Each oView As DrawingView In oViews
		oOrientType = oView.Camera.ViewOrientationType
		oOrigViewName = oView.Name
		oNewViewName = Mid(oOrientType.ToString, 2, Len(oOrientType.ToString) -16)
		oView.ShowLabel = True
		oView.Name = oNewViewName.ToUpper
	Next
Next
```

#### Code Block 9

```vb
Dim oDoc As DrawingDocument = ThisDrawing.Document
Dim oViews As DrawingViews
Dim oOrientType As ViewOrientationTypeEnum
Dim oOrigViewName As String
Dim oNewViewName As String
For Each oSheet As Sheet In oDoc.Sheets
	oViews = oSheet.DrawingViews
	For Each oView As DrawingView In oViews
		oOrientType = oView.Camera.ViewOrientationType
		oOrigViewName = oView.Name
		oNewViewName = Mid(oOrientType.ToString, 2, Len(oOrientType.ToString) -16)
		oView.ShowLabel = True
		oView.Name = oNewViewName.ToUpper
	Next
Next
```

#### Code Block 10

```vb
Dim oDoc As DrawingDocument = ThisDrawing.Document
Dim oViews As DrawingViews
Dim oOrientType As ViewOrientationTypeEnum
Dim oOrigViewName As String
Dim oNewViewName As String
For Each oSheet As Sheet In oDoc.Sheets
	oViews = oSheet.DrawingViews
	For Each oView As DrawingView In oViews
		oOrientType = oView.Camera.ViewOrientationType
		oOrigViewName = oView.Name
		oNewViewName = Mid(oOrientType.ToString, 2, Len(oOrientType.ToString) -16)
		oView.ShowLabel = True
		oView.Name = oNewViewName.ToUpper
	Next
Next
```

#### Code Block 11

```vb
Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet
Dim tmpView As DrawingView
For Each tmpView In tmpSheet.DrawingViews
		Dim myDrawingViewName As String = ""
		If tmpView.Type = ObjectTypeEnum.kDrawingViewObject Then
			'Encapsulat the rotation of drawing view in a transaction
			Dim oTrans As Transaction
			oTrans = ThisApplication.TransactionManager.StartTransaction(ThisDrawing.Document, "Rotate Drawing View temp")
			
			' Set rotation to 0
			If tmpView.Camera.ViewOrientationType = ViewOrientationTypeEnum.kArbitraryViewOrientation Then
				If tmpView.Rotation<>0 Then
					tmpView.Rotation = 0
				End If
	    	End If
			
	        Select Case tmpView.Camera.ViewOrientationType
	            Case ViewOrientationTypeEnum.kBackViewOrientation
	                myDrawingViewName = "BACK VIEW"
	            Case ViewOrientationTypeEnum.kBottomViewOrientation
	                myDrawingViewName = "BOTTOM VIEW"
	            Case ViewOrientationTypeEnum.kFrontViewOrientation
	                myDrawingViewName = "FRONT VIEW"
	            Case ViewOrientationTypeEnum.kIsoBottomLeftViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoBottomRightViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoTopLeftViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoTopRightViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kLeftViewOrientation
	                myDrawingViewName = "SIDE VIEW"
	            Case ViewOrientationTypeEnum.kRightViewOrientation
	                myDrawingViewName = "SIDE VIEW"
	            Case ViewOrientationTypeEnum.kTopViewOrientation
	                myDrawingViewName = "TOP VIEW"
	            Case Else
	                myDrawingViewName = ""
	            End Select
				
			' Abort the transaction so everything is rolled back like before the transaction starts
			oTrans.Abort 
			
	        If Not myDrawingViewName = "" Then
	            tmpView.Name = myDrawingViewName
	        End If		
			If tmpView.IsFlatPatternView =True Then
	           tmpView.Name = "FLAT PATTERN"
	        End If
	    End If
	    myDrawingViewName = ""
Next
```

#### Code Block 12

```vb
Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet
Dim tmpView As DrawingView
For Each tmpView In tmpSheet.DrawingViews
		Dim myDrawingViewName As String = ""
		If tmpView.Type = ObjectTypeEnum.kDrawingViewObject Then
			'Encapsulat the rotation of drawing view in a transaction
			Dim oTrans As Transaction
			oTrans = ThisApplication.TransactionManager.StartTransaction(ThisDrawing.Document, "Rotate Drawing View temp")
			
			' Set rotation to 0
			If tmpView.Camera.ViewOrientationType = ViewOrientationTypeEnum.kArbitraryViewOrientation Then
				If tmpView.Rotation<>0 Then
					tmpView.Rotation = 0
				End If
	    	End If
			
	        Select Case tmpView.Camera.ViewOrientationType
	            Case ViewOrientationTypeEnum.kBackViewOrientation
	                myDrawingViewName = "BACK VIEW"
	            Case ViewOrientationTypeEnum.kBottomViewOrientation
	                myDrawingViewName = "BOTTOM VIEW"
	            Case ViewOrientationTypeEnum.kFrontViewOrientation
	                myDrawingViewName = "FRONT VIEW"
	            Case ViewOrientationTypeEnum.kIsoBottomLeftViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoBottomRightViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoTopLeftViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoTopRightViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kLeftViewOrientation
	                myDrawingViewName = "SIDE VIEW"
	            Case ViewOrientationTypeEnum.kRightViewOrientation
	                myDrawingViewName = "SIDE VIEW"
	            Case ViewOrientationTypeEnum.kTopViewOrientation
	                myDrawingViewName = "TOP VIEW"
	            Case Else
	                myDrawingViewName = ""
	            End Select
				
			' Abort the transaction so everything is rolled back like before the transaction starts
			oTrans.Abort 
			
	        If Not myDrawingViewName = "" Then
	            tmpView.Name = myDrawingViewName
	        End If		
			If tmpView.IsFlatPatternView =True Then
	           tmpView.Name = "FLAT PATTERN"
	        End If
	    End If
	    myDrawingViewName = ""
Next
```

#### Code Block 13

```vb
Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet
Dim tmpView As DrawingView
For Each tmpView In tmpSheet.DrawingViews
		Dim myDrawingViewName As String = ""
		If tmpView.Type = ObjectTypeEnum.kDrawingViewObject Then
			'Encapsulat the rotation of drawing view in a transaction
			Dim oTrans As Transaction
			oTrans = ThisApplication.TransactionManager.StartTransaction(ThisDrawing.Document, "Rotate Drawing View temp")
			
			' Set rotation to 0
			If tmpView.Camera.ViewOrientationType = ViewOrientationTypeEnum.kArbitraryViewOrientation Then
				If tmpView.Rotation<>0 Then
					tmpView.Rotation = 0
				End If
	    	End If
			
	        Select Case tmpView.Camera.ViewOrientationType
	            Case ViewOrientationTypeEnum.kBackViewOrientation
	                myDrawingViewName = "BACK VIEW"
	            Case ViewOrientationTypeEnum.kBottomViewOrientation
	                myDrawingViewName = "BOTTOM VIEW"
	            Case ViewOrientationTypeEnum.kFrontViewOrientation
	                myDrawingViewName = "FRONT VIEW"
	            Case ViewOrientationTypeEnum.kIsoBottomLeftViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoBottomRightViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoTopLeftViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoTopRightViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kLeftViewOrientation
	                myDrawingViewName = "SIDE VIEW"
	            Case ViewOrientationTypeEnum.kRightViewOrientation
	                myDrawingViewName = "SIDE VIEW"
	            Case ViewOrientationTypeEnum.kTopViewOrientation
	                myDrawingViewName = "TOP VIEW"
	            Case Else
	                myDrawingViewName = ""
	            End Select
				
			' Abort the transaction so everything is rolled back like before the transaction starts
			oTrans.Abort 
			
	        If Not myDrawingViewName = "" Then
	            tmpView.Name = myDrawingViewName
	        End If		
			If tmpView.IsFlatPatternView =True Then
	           tmpView.Name = "FLAT PATTERN"
	        End If
	    End If
	    myDrawingViewName = ""
Next
```

#### Code Block 14

```vb
Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet
Dim tmpView As DrawingView
For Each tmpView In tmpSheet.DrawingViews
		Dim myDrawingViewName As String = ""
		If tmpView.Type = ObjectTypeEnum.kDrawingViewObject Then
			'Encapsulat the rotation of drawing view in a transaction
			Dim oTrans As Transaction
			oTrans = ThisApplication.TransactionManager.StartTransaction(ThisDrawing.Document, "Rotate Drawing View temp")
			
			' Set rotation to 0
			If tmpView.Camera.ViewOrientationType = ViewOrientationTypeEnum.kArbitraryViewOrientation Then
				If tmpView.Rotation<>0 Then
					tmpView.Rotation = 0
				End If
	    	End If
			
	        Select Case tmpView.Camera.ViewOrientationType
	            Case ViewOrientationTypeEnum.kBackViewOrientation
	                myDrawingViewName = "BACK VIEW"
	            Case ViewOrientationTypeEnum.kBottomViewOrientation
	                myDrawingViewName = "BOTTOM VIEW"
	            Case ViewOrientationTypeEnum.kFrontViewOrientation
	                myDrawingViewName = "FRONT VIEW"
	            Case ViewOrientationTypeEnum.kIsoBottomLeftViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoBottomRightViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoTopLeftViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kIsoTopRightViewOrientation
	                myDrawingViewName = "ISOMETRIC VIEW"
	            Case ViewOrientationTypeEnum.kLeftViewOrientation
	                myDrawingViewName = "SIDE VIEW"
	            Case ViewOrientationTypeEnum.kRightViewOrientation
	                myDrawingViewName = "SIDE VIEW"
	            Case ViewOrientationTypeEnum.kTopViewOrientation
	                myDrawingViewName = "TOP VIEW"
	            Case Else
	                myDrawingViewName = ""
	            End Select
				
			' Abort the transaction so everything is rolled back like before the transaction starts
			oTrans.Abort 
			
	        If Not myDrawingViewName = "" Then
	            tmpView.Name = myDrawingViewName
	        End If		
			If tmpView.IsFlatPatternView =True Then
	           tmpView.Name = "FLAT PATTERN"
	        End If
	    End If
	    myDrawingViewName = ""
Next
```

#### Code Block 15

```vb
Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet
Dim tmpView As DrawingView
For Each tmpView In tmpSheet.DrawingViews
    Dim myDrawingViewName As String = ""
	If tmpView.Type = ObjectTypeEnum.kDrawingViewObject Then
		'Encapsulat the rotation of drawing view in a transaction
		Dim oTrans As Transaction
		oTrans = ThisApplication.TransactionManager.StartTransaction(ThisDrawing.Document, "Rotate Drawing View temp")
		
		' Set rotation to 0
		If tmpView.Camera.ViewOrientationType = ViewOrientationTypeEnum.kArbitraryViewOrientation Then
			tmpView.Rotation = 0
    	End If
		
        Select Case tmpView.Camera.ViewOrientationType
            Case ViewOrientationTypeEnum.kBackViewOrientation
                myDrawingViewName = "BACK VIEW"
            Case ViewOrientationTypeEnum.kBottomViewOrientation
                myDrawingViewName = "BOTTOM VIEW"
            Case ViewOrientationTypeEnum.kFrontViewOrientation
                myDrawingViewName = "FRONT VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kLeftViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kRightViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kTopViewOrientation
                myDrawingViewName = "TOP VIEW"
            Case Else
                myDrawingViewName = ""
            End Select
			
		' Abort the transaction so everything is rolled back like before the transaction starts
		oTrans.Abort 
		
        If Not myDrawingViewName = "" Then
            tmpView.Name = myDrawingViewName
        End If		
		If tmpView.IsFlatPatternView =True Then
           tmpView.Name = "FLAT PATTERN"
        End If
    End If
    myDrawingViewName = ""
Next
```

#### Code Block 16

```vb
Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet
Dim tmpView As DrawingView
For Each tmpView In tmpSheet.DrawingViews
    Dim myDrawingViewName As String = ""
	If tmpView.Type = ObjectTypeEnum.kDrawingViewObject Then
		'Encapsulat the rotation of drawing view in a transaction
		Dim oTrans As Transaction
		oTrans = ThisApplication.TransactionManager.StartTransaction(ThisDrawing.Document, "Rotate Drawing View temp")
		
		' Set rotation to 0
		If tmpView.Camera.ViewOrientationType = ViewOrientationTypeEnum.kArbitraryViewOrientation Then
			tmpView.Rotation = 0
    	End If
		
        Select Case tmpView.Camera.ViewOrientationType
            Case ViewOrientationTypeEnum.kBackViewOrientation
                myDrawingViewName = "BACK VIEW"
            Case ViewOrientationTypeEnum.kBottomViewOrientation
                myDrawingViewName = "BOTTOM VIEW"
            Case ViewOrientationTypeEnum.kFrontViewOrientation
                myDrawingViewName = "FRONT VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kLeftViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kRightViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kTopViewOrientation
                myDrawingViewName = "TOP VIEW"
            Case Else
                myDrawingViewName = ""
            End Select
			
		' Abort the transaction so everything is rolled back like before the transaction starts
		oTrans.Abort 
		
        If Not myDrawingViewName = "" Then
            tmpView.Name = myDrawingViewName
        End If		
		If tmpView.IsFlatPatternView =True Then
           tmpView.Name = "FLAT PATTERN"
        End If
    End If
    myDrawingViewName = ""
Next
```

#### Code Block 17

```vb
Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet
Dim tmpView As DrawingView
For Each tmpView In tmpSheet.DrawingViews
    Dim myDrawingViewName As String = ""
	If tmpView.Type = ObjectTypeEnum.kDrawingViewObject Then
		'Encapsulat the rotation of drawing view in a transaction
		Dim oTrans As Transaction
		oTrans = ThisApplication.TransactionManager.StartTransaction(ThisDrawing.Document, "Rotate Drawing View temp")
		
		' Set rotation to 0
		If tmpView.Camera.ViewOrientationType = ViewOrientationTypeEnum.kArbitraryViewOrientation Then
			tmpView.Rotation = 0
    	End If
		
        Select Case tmpView.Camera.ViewOrientationType
            Case ViewOrientationTypeEnum.kBackViewOrientation
                myDrawingViewName = "BACK VIEW"
            Case ViewOrientationTypeEnum.kBottomViewOrientation
                myDrawingViewName = "BOTTOM VIEW"
            Case ViewOrientationTypeEnum.kFrontViewOrientation
                myDrawingViewName = "FRONT VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kLeftViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kRightViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kTopViewOrientation
                myDrawingViewName = "TOP VIEW"
            Case Else
                myDrawingViewName = ""
            End Select
			
		' Abort the transaction so everything is rolled back like before the transaction starts
		oTrans.Abort 
		
        If Not myDrawingViewName = "" Then
            tmpView.Name = myDrawingViewName
        End If		
		If tmpView.IsFlatPatternView =True Then
           tmpView.Name = "FLAT PATTERN"
        End If
    End If
    myDrawingViewName = ""
Next
```

#### Code Block 18

```vb
Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet
Dim tmpView As DrawingView
For Each tmpView In tmpSheet.DrawingViews
    Dim myDrawingViewName As String = ""
	If tmpView.Type = ObjectTypeEnum.kDrawingViewObject Then
		'Encapsulat the rotation of drawing view in a transaction
		Dim oTrans As Transaction
		oTrans = ThisApplication.TransactionManager.StartTransaction(ThisDrawing.Document, "Rotate Drawing View temp")
		
		' Set rotation to 0
		If tmpView.Camera.ViewOrientationType = ViewOrientationTypeEnum.kArbitraryViewOrientation Then
			tmpView.Rotation = 0
    	End If
		
        Select Case tmpView.Camera.ViewOrientationType
            Case ViewOrientationTypeEnum.kBackViewOrientation
                myDrawingViewName = "BACK VIEW"
            Case ViewOrientationTypeEnum.kBottomViewOrientation
                myDrawingViewName = "BOTTOM VIEW"
            Case ViewOrientationTypeEnum.kFrontViewOrientation
                myDrawingViewName = "FRONT VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kLeftViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kRightViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kTopViewOrientation
                myDrawingViewName = "TOP VIEW"
            Case Else
                myDrawingViewName = ""
            End Select
			
		' Abort the transaction so everything is rolled back like before the transaction starts
		oTrans.Abort 
		
        If Not myDrawingViewName = "" Then
            tmpView.Name = myDrawingViewName
        End If		
		If tmpView.IsFlatPatternView =True Then
           tmpView.Name = "FLAT PATTERN"
        End If
    End If
    myDrawingViewName = ""
Next
```

#### Code Block 19

```vb
Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet
Dim tmpView As DrawingView
For Each tmpView In tmpSheet.DrawingViews
    Dim myDrawingViewName As String = ""
	If tmpView.Type = ObjectTypeEnum.kDrawingViewObject Then
    
        Select Case tmpView.Camera.ViewOrientationType
            Case ViewOrientationTypeEnum.kBackViewOrientation
                myDrawingViewName = "BACK VIEW"
            Case ViewOrientationTypeEnum.kBottomViewOrientation
                myDrawingViewName = "BOTTOM VIEW"
            Case ViewOrientationTypeEnum.kFrontViewOrientation
                myDrawingViewName = "FRONT VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kLeftViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kRightViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kTopViewOrientation
                myDrawingViewName = "TOP VIEW"
            Case Else
                myDrawingViewName = ""
            End Select        
        If Not myDrawingViewName = "" Then
            tmpView.Name = myDrawingViewName
        End If		
		If tmpView.IsFlatPatternView =True Then
           tmpView.Name = "FLAT PATTERN"
        End If
    End If
    myDrawingViewName = ""

Next
```

#### Code Block 20

```vb
Dim tmpSheet As Sheet = ThisDrawing.ActiveSheet.Sheet
Dim tmpView As DrawingView
For Each tmpView In tmpSheet.DrawingViews
    Dim myDrawingViewName As String = ""
	If tmpView.Type = ObjectTypeEnum.kDrawingViewObject Then
    
        Select Case tmpView.Camera.ViewOrientationType
            Case ViewOrientationTypeEnum.kBackViewOrientation
                myDrawingViewName = "BACK VIEW"
            Case ViewOrientationTypeEnum.kBottomViewOrientation
                myDrawingViewName = "BOTTOM VIEW"
            Case ViewOrientationTypeEnum.kFrontViewOrientation
                myDrawingViewName = "FRONT VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoBottomRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopLeftViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kIsoTopRightViewOrientation
                myDrawingViewName = "ISOMETRIC VIEW"
            Case ViewOrientationTypeEnum.kLeftViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kRightViewOrientation
                myDrawingViewName = "SIDE VIEW"
            Case ViewOrientationTypeEnum.kTopViewOrientation
                myDrawingViewName = "TOP VIEW"
            Case Else
                myDrawingViewName = ""
            End Select        
        If Not myDrawingViewName = "" Then
            tmpView.Name = myDrawingViewName
        End If		
		If tmpView.IsFlatPatternView =True Then
           tmpView.Name = "FLAT PATTERN"
        End If
    End If
    myDrawingViewName = ""

Next
```

#### Code Block 21

```vb
If (TypeOf oDView Is DetailDrawingView) Then Continue For
If (TypeOf oDView Is SectionDrawingView) Then Continue For
```

#### Code Block 22

```vb
If (TypeOf oDView Is DetailDrawingView) Then Continue For
If (TypeOf oDView Is SectionDrawingView) Then Continue For
```

#### Code Block 23

```vb
If (TypeOf oDView Is DetailDrawingView) Then Continue For
If (TypeOf oDView Is SectionDrawingView) Then Continue For
```

#### Code Block 24

```vb
If (TypeOf oDView Is DetailDrawingView) Then Continue For
If (TypeOf oDView Is SectionDrawingView) Then Continue For
```

---

### 51. Dynamically execute/add a Macro

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/dynamically-execute-add-a-macro/td-p/13796762](https://forums.autodesk.com/t5/inventor-programming-forum/dynamically-execute-add-a-macro/td-p/13796762)

**Author:** fleischmannHVTJ3

**Date:** ‎09-04-2025
	
		
		06:45 AM

**Description:** Hello, I am writing an Inventor AddIn in C#.I want to dynamically execute a VBA script/a Macro in Inventor.For example this simple Macro:Sub My_Macro()MsgBox "My First Macro"End SubI know how to execute existing Macros. Therefore, my idea was to first add a macro (dynamically) and then execute it. H...

**Code Snippets (4):**

#### Code Block 1

```vb
public override void Main()
{
    // Get iLogic Automation Object
    var iLogicAuto = ThisApplication.ApplicationAddIns.ItemById["{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}"].Automation;

    // Create new rule
    string ruleName = "C:\\Temp\\DynamicRule.iLogicVb";
    string ruleText = $"Sub Main()\nMsgBox(\"Dynamically created rule\")\nEnd Sub";

    System.IO.File.WriteAllText(ruleName, ruleText);
   
    var doc = ThisApplication.ActiveEditDocument;

    // Execute rule
    iLogicAuto.GetType().InvokeMember("RunExternalRule", BindingFlags.Public | BindingFlags.InvokeMethod, null, iLogicAuto, [doc, ruleName]);
}
```

#### Code Block 2

```vb
public override void Main()
{
    // Get iLogic Automation Object
    var iLogicAuto = ThisApplication.ApplicationAddIns.ItemById["{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}"].Automation;

    // Create new rule
    string ruleName = "C:\\Temp\\DynamicRule.iLogicVb";
    string ruleText = $"Sub Main()\nMsgBox(\"Dynamically created rule\")\nEnd Sub";

    System.IO.File.WriteAllText(ruleName, ruleText);
   
    var doc = ThisApplication.ActiveEditDocument;

    // Execute rule
    iLogicAuto.GetType().InvokeMember("RunExternalRule", BindingFlags.Public | BindingFlags.InvokeMethod, null, iLogicAuto, [doc, ruleName]);
}
```

#### Code Block 3

```vb
public override void Main()
{
    // Get iLogic Automation Object
    var iLogicAuto = ThisApplication.ApplicationAddIns.ItemById["{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}"].Automation;

    // Create new rule
    string ruleName = "C:\\Temp\\DynamicRule.iLogicVb";
    string ruleText = $"Sub Main()\nMsgBox(\"Dynamically created rule\")\nEnd Sub";

    System.IO.File.WriteAllText(ruleName, ruleText);
   
    var doc = ThisApplication.ActiveEditDocument;

    // Execute rule
    iLogicAuto.GetType().InvokeMember("RunExternalRule", BindingFlags.Public | BindingFlags.InvokeMethod, null, iLogicAuto, [doc, ruleName]);
}
```

#### Code Block 4

```vb
public override void Main()
{
    // Get iLogic Automation Object
    var iLogicAuto = ThisApplication.ApplicationAddIns.ItemById["{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}"].Automation;

    // Create new rule
    string ruleName = "C:\\Temp\\DynamicRule.iLogicVb";
    string ruleText = $"Sub Main()\nMsgBox(\"Dynamically created rule\")\nEnd Sub";

    System.IO.File.WriteAllText(ruleName, ruleText);
   
    var doc = ThisApplication.ActiveEditDocument;

    // Execute rule
    iLogicAuto.GetType().InvokeMember("RunExternalRule", BindingFlags.Public | BindingFlags.InvokeMethod, null, iLogicAuto, [doc, ruleName]);
}
```

#### Code Block 5

```vb
public override void Main()
{
    //Get iLogic Automation object

    //var iLogicAuto = iLogicVb.Automation; //Strongly typed version of the line bellow
    dynamic iLogicAuto = ThisApplication.ApplicationAddIns.ItemById["{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}"].Automation;

    //Create new rule
    string ruleName = "C:\\Temp\\DynamicRule.iLogicVb";
    var ruleText = @"       
Sub Main()
   MsgBox(""Dynamically created rule"")
End Sub
";
    System.IO.File.WriteAllText(ruleName, ruleText);

    //Execute rule
    var doc = ThisApplication.ActiveEditDocument;
    iLogicAuto.RunExternalRule(doc, ruleName);
}
```

#### Code Block 6

```vb
public override void Main()
{
    //Get iLogic Automation object

    //var iLogicAuto = iLogicVb.Automation; //Strongly typed version of the line bellow
    dynamic iLogicAuto = ThisApplication.ApplicationAddIns.ItemById["{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}"].Automation;

    //Create new rule
    string ruleName = "C:\\Temp\\DynamicRule.iLogicVb";
    var ruleText = @"       
Sub Main()
   MsgBox(""Dynamically created rule"")
End Sub
";
    System.IO.File.WriteAllText(ruleName, ruleText);

    //Execute rule
    var doc = ThisApplication.ActiveEditDocument;
    iLogicAuto.RunExternalRule(doc, ruleName);
}
```

#### Code Block 7

```vb
public override void Main()
{
    //Get iLogic Automation object

    //var iLogicAuto = iLogicVb.Automation; //Strongly typed version of the line bellow
    dynamic iLogicAuto = ThisApplication.ApplicationAddIns.ItemById["{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}"].Automation;

    //Create new rule
    string ruleName = "C:\\Temp\\DynamicRule.iLogicVb";
    var ruleText = @"       
Sub Main()
   MsgBox(""Dynamically created rule"")
End Sub
";
    System.IO.File.WriteAllText(ruleName, ruleText);

    //Execute rule
    var doc = ThisApplication.ActiveEditDocument;
    iLogicAuto.RunExternalRule(doc, ruleName);
}
```

#### Code Block 8

```vb
public override void Main()
{
    //Get iLogic Automation object

    //var iLogicAuto = iLogicVb.Automation; //Strongly typed version of the line bellow
    dynamic iLogicAuto = ThisApplication.ApplicationAddIns.ItemById["{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}"].Automation;

    //Create new rule
    string ruleName = "C:\\Temp\\DynamicRule.iLogicVb";
    var ruleText = @"       
Sub Main()
   MsgBox(""Dynamically created rule"")
End Sub
";
    System.IO.File.WriteAllText(ruleName, ruleText);

    //Execute rule
    var doc = ThisApplication.ActiveEditDocument;
    iLogicAuto.RunExternalRule(doc, ruleName);
}
```

---

### 52. Easy way to align view/scale label?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/easy-way-to-align-view-scale-label/td-p/5607961#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/easy-way-to-align-view-scale-label/td-p/5607961#messageview_0)

**Author:** Anonymous

**Date:** ‎04-25-2015
	
		
		05:02 AM

**Description:** Good Morning All,Looking for an easy way to align View/Scale labels without having to sketch. Would think there would be an align option like you can align the actual views? Thanks in advance, have a good weekend. -Josh ApplegateInventor User for 6 weeks and counting!Inventor 2013 					 				 			 			...

**Code Snippets (4):**

#### Code Block 1

```vb
'27.11.2019
'No frills code to align the views along the bottom edge.

Sub Main()
Dim oSSet As SelectSet = ThisDoc.Document.SelectSet
Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection
Dim oDoc As Document = ThisDoc.Document
Dim oSelection As SelectSet = oDoc.SelectSet
'If oSelection Is Nothing Then
If oSSet.Count <2 Then
	MessageBox.Show("Nothing selected", "iLogic", MessageBoxButtons.OK)
	Exit Sub
End If
' Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection ' Removed for 2.1 as it is now declared earlier
For Each Item As Object In oSelection
	If Not TypeOf(Item) Is DrawingView Then Continue For 'DrawingViews only
	oItems.Add(Item)
Next

oDoc.SelectSet.SelectMultiple(oItems)
oHor_Bott(oItems)
End Sub

'=========================================================================================================
Sub oHor_Bott(oItems)
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisDoc.Document
Dim oView As DrawingView
Dim oSheet As Sheet
oSheet = oDrawDoc.ActiveSheet
Dim trans As Transaction
trans = ThisApplication.TransactionManager.StartTransaction(oDrawDoc, "Align Views")
'Dim oSSet As SelectSet = oDrawDoc.SelectSet
'For Each oView In oSSet
		Dim oFirstView As DrawingView = TryCast(oItems.item(1), DrawingView)
		Dim YPos As Double
		YPos = oFirstView.Position.Y - (oFirstView.Height/2)
        Dim oPoint2D As Inventor.Point2d
 
		 For Each oView In oItems
            oPoint2D = ThisApplication.TransientGeometry.CreatePoint2d(oView.Position.X,YPos + (oView.Height/2))
           oView.Position = oPoint2D
        Next
trans.End
Dim oDoc As Document = ThisDoc.Document
oDoc.SelectSet.SelectMultiple(oItems)
End Sub
```

#### Code Block 2

```vb
'27.11.2019
'No frills code to align the views along the bottom edge.

Sub Main()
Dim oSSet As SelectSet = ThisDoc.Document.SelectSet
Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection
Dim oDoc As Document = ThisDoc.Document
Dim oSelection As SelectSet = oDoc.SelectSet
'If oSelection Is Nothing Then
If oSSet.Count <2 Then
	MessageBox.Show("Nothing selected", "iLogic", MessageBoxButtons.OK)
	Exit Sub
End If
' Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection ' Removed for 2.1 as it is now declared earlier
For Each Item As Object In oSelection
	If Not TypeOf(Item) Is DrawingView Then Continue For 'DrawingViews only
	oItems.Add(Item)
Next

oDoc.SelectSet.SelectMultiple(oItems)
oHor_Bott(oItems)
End Sub

'=========================================================================================================
Sub oHor_Bott(oItems)
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisDoc.Document
Dim oView As DrawingView
Dim oSheet As Sheet
oSheet = oDrawDoc.ActiveSheet
Dim trans As Transaction
trans = ThisApplication.TransactionManager.StartTransaction(oDrawDoc, "Align Views")
'Dim oSSet As SelectSet = oDrawDoc.SelectSet
'For Each oView In oSSet
		Dim oFirstView As DrawingView = TryCast(oItems.item(1), DrawingView)
		Dim YPos As Double
		YPos = oFirstView.Position.Y - (oFirstView.Height/2)
        Dim oPoint2D As Inventor.Point2d
 
		 For Each oView In oItems
            oPoint2D = ThisApplication.TransientGeometry.CreatePoint2d(oView.Position.X,YPos + (oView.Height/2))
           oView.Position = oPoint2D
        Next
trans.End
Dim oDoc As Document = ThisDoc.Document
oDoc.SelectSet.SelectMultiple(oItems)
End Sub
```

#### Code Block 3

```vb
'27.11.2019
'No frills code to align the views along the bottom edge.

Sub Main()
Dim oSSet As SelectSet = ThisDoc.Document.SelectSet
Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection
Dim oDoc As Document = ThisDoc.Document
Dim oSelection As SelectSet = oDoc.SelectSet
'If oSelection Is Nothing Then
If oSSet.Count <2 Then
	MessageBox.Show("Nothing selected", "iLogic", MessageBoxButtons.OK)
	Exit Sub
End If
' Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection ' Removed for 2.1 as it is now declared earlier
For Each Item As Object In oSelection
	If Not TypeOf(Item) Is DrawingView Then Continue For 'DrawingViews only
	oItems.Add(Item)
Next

oDoc.SelectSet.SelectMultiple(oItems)
oHor_Bott(oItems)
End Sub

'=========================================================================================================
Sub oHor_Bott(oItems)
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisDoc.Document
Dim oView As DrawingView
Dim oSheet As Sheet
oSheet = oDrawDoc.ActiveSheet
Dim trans As Transaction
trans = ThisApplication.TransactionManager.StartTransaction(oDrawDoc, "Align Views")
'Dim oSSet As SelectSet = oDrawDoc.SelectSet
'For Each oView In oSSet
		Dim oFirstView As DrawingView = TryCast(oItems.item(1), DrawingView)
		Dim YPos As Double
		YPos = oFirstView.Position.Y - (oFirstView.Height/2)
        Dim oPoint2D As Inventor.Point2d
 
		 For Each oView In oItems
            oPoint2D = ThisApplication.TransientGeometry.CreatePoint2d(oView.Position.X,YPos + (oView.Height/2))
           oView.Position = oPoint2D
        Next
trans.End
Dim oDoc As Document = ThisDoc.Document
oDoc.SelectSet.SelectMultiple(oItems)
End Sub
```

#### Code Block 4

```vb
'27.11.2019
'No frills code to align the views along the bottom edge.

Sub Main()
Dim oSSet As SelectSet = ThisDoc.Document.SelectSet
Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection
Dim oDoc As Document = ThisDoc.Document
Dim oSelection As SelectSet = oDoc.SelectSet
'If oSelection Is Nothing Then
If oSSet.Count <2 Then
	MessageBox.Show("Nothing selected", "iLogic", MessageBoxButtons.OK)
	Exit Sub
End If
' Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection ' Removed for 2.1 as it is now declared earlier
For Each Item As Object In oSelection
	If Not TypeOf(Item) Is DrawingView Then Continue For 'DrawingViews only
	oItems.Add(Item)
Next

oDoc.SelectSet.SelectMultiple(oItems)
oHor_Bott(oItems)
End Sub

'=========================================================================================================
Sub oHor_Bott(oItems)
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisDoc.Document
Dim oView As DrawingView
Dim oSheet As Sheet
oSheet = oDrawDoc.ActiveSheet
Dim trans As Transaction
trans = ThisApplication.TransactionManager.StartTransaction(oDrawDoc, "Align Views")
'Dim oSSet As SelectSet = oDrawDoc.SelectSet
'For Each oView In oSSet
		Dim oFirstView As DrawingView = TryCast(oItems.item(1), DrawingView)
		Dim YPos As Double
		YPos = oFirstView.Position.Y - (oFirstView.Height/2)
        Dim oPoint2D As Inventor.Point2d
 
		 For Each oView In oItems
            oPoint2D = ThisApplication.TransientGeometry.CreatePoint2d(oView.Position.X,YPos + (oView.Height/2))
           oView.Position = oPoint2D
        Next
trans.End
Dim oDoc As Document = ThisDoc.Document
oDoc.SelectSet.SelectMultiple(oItems)
End Sub
```

#### Code Block 5

```vb
'27.11.2019
'No frills code to align the views along the bottom selected Line.
'This is just for a quicker method, as this is the most used command.


Sub Main()
Dim oSSet As SelectSet = ThisDoc.Document.SelectSet
Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection
Dim oDoc As Document = ThisDoc.Document
Dim oSelection As SelectSet = oDoc.SelectSet
'If oSelection Is Nothing Then
If oSSet.Count <1 Then
	MessageBox.Show("Nothing selected", "iLogic", MessageBoxButtons.OK)
	Exit Sub
End If
For Each Item As Object In oSelection
	If Not TypeOf(Item) Is DrawingView Then Continue For 'DrawingViews only
	oItems.Add(Item)
Next
oDoc.SelectSet.SelectMultiple(oItems)
Align_Labels(oItems)
End Sub

'=========================================================================================================
Sub Align_Labels(oItems)
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisDoc.Document
Dim oView As DrawingView
Dim oSheet As Sheet
oSheet = oDrawDoc.ActiveSheet
Dim trans As Transaction
trans = ThisApplication.TransactionManager.StartTransaction(oDrawDoc, "Align Views")
'Dim oSSet As SelectSet = oDrawDoc.SelectSet
'
		Dim oNewPosition As Point2d
		oNewPOS = InputBox("Add Offset?", "Title", 1)
		oNewPOS /= 10
 
For Each oView In oItems
		  oNewPosition = ThisApplication.TransientGeometry.CreatePoint2d(oView.Center.X, oView.Center.Y - (oView.Height / 2)-( 1+oNewPOS))
		   oView.Label.Position = oNewPosition
		Next
        
trans.End
Dim oDoc As Document = ThisDoc.Document
oDoc.SelectSet.SelectMultiple(oItems)
End Sub
```

#### Code Block 6

```vb
'27.11.2019
'No frills code to align the views along the bottom selected Line.
'This is just for a quicker method, as this is the most used command.


Sub Main()
Dim oSSet As SelectSet = ThisDoc.Document.SelectSet
Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection
Dim oDoc As Document = ThisDoc.Document
Dim oSelection As SelectSet = oDoc.SelectSet
'If oSelection Is Nothing Then
If oSSet.Count <1 Then
	MessageBox.Show("Nothing selected", "iLogic", MessageBoxButtons.OK)
	Exit Sub
End If
For Each Item As Object In oSelection
	If Not TypeOf(Item) Is DrawingView Then Continue For 'DrawingViews only
	oItems.Add(Item)
Next
oDoc.SelectSet.SelectMultiple(oItems)
Align_Labels(oItems)
End Sub

'=========================================================================================================
Sub Align_Labels(oItems)
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisDoc.Document
Dim oView As DrawingView
Dim oSheet As Sheet
oSheet = oDrawDoc.ActiveSheet
Dim trans As Transaction
trans = ThisApplication.TransactionManager.StartTransaction(oDrawDoc, "Align Views")
'Dim oSSet As SelectSet = oDrawDoc.SelectSet
'
		Dim oNewPosition As Point2d
		oNewPOS = InputBox("Add Offset?", "Title", 1)
		oNewPOS /= 10
 
For Each oView In oItems
		  oNewPosition = ThisApplication.TransientGeometry.CreatePoint2d(oView.Center.X, oView.Center.Y - (oView.Height / 2)-( 1+oNewPOS))
		   oView.Label.Position = oNewPosition
		Next
        
trans.End
Dim oDoc As Document = ThisDoc.Document
oDoc.SelectSet.SelectMultiple(oItems)
End Sub
```

#### Code Block 7

```vb
'27.11.2019
'No frills code to align the views along the bottom selected Line.
'This is just for a quicker method, as this is the most used command.


Sub Main()
Dim oSSet As SelectSet = ThisDoc.Document.SelectSet
Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection
Dim oDoc As Document = ThisDoc.Document
Dim oSelection As SelectSet = oDoc.SelectSet
'If oSelection Is Nothing Then
If oSSet.Count <1 Then
	MessageBox.Show("Nothing selected", "iLogic", MessageBoxButtons.OK)
	Exit Sub
End If
For Each Item As Object In oSelection
	If Not TypeOf(Item) Is DrawingView Then Continue For 'DrawingViews only
	oItems.Add(Item)
Next
oDoc.SelectSet.SelectMultiple(oItems)
Align_Labels(oItems)
End Sub

'=========================================================================================================
Sub Align_Labels(oItems)
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisDoc.Document
Dim oView As DrawingView
Dim oSheet As Sheet
oSheet = oDrawDoc.ActiveSheet
Dim trans As Transaction
trans = ThisApplication.TransactionManager.StartTransaction(oDrawDoc, "Align Views")
'Dim oSSet As SelectSet = oDrawDoc.SelectSet
'
		Dim oNewPosition As Point2d
		oNewPOS = InputBox("Add Offset?", "Title", 1)
		oNewPOS /= 10
 
For Each oView In oItems
		  oNewPosition = ThisApplication.TransientGeometry.CreatePoint2d(oView.Center.X, oView.Center.Y - (oView.Height / 2)-( 1+oNewPOS))
		   oView.Label.Position = oNewPosition
		Next
        
trans.End
Dim oDoc As Document = ThisDoc.Document
oDoc.SelectSet.SelectMultiple(oItems)
End Sub
```

#### Code Block 8

```vb
'27.11.2019
'No frills code to align the views along the bottom selected Line.
'This is just for a quicker method, as this is the most used command.


Sub Main()
Dim oSSet As SelectSet = ThisDoc.Document.SelectSet
Dim oItems As ObjectsEnumerator = ThisApplication.TransientObjects.CreateObjectCollection
Dim oDoc As Document = ThisDoc.Document
Dim oSelection As SelectSet = oDoc.SelectSet
'If oSelection Is Nothing Then
If oSSet.Count <1 Then
	MessageBox.Show("Nothing selected", "iLogic", MessageBoxButtons.OK)
	Exit Sub
End If
For Each Item As Object In oSelection
	If Not TypeOf(Item) Is DrawingView Then Continue For 'DrawingViews only
	oItems.Add(Item)
Next
oDoc.SelectSet.SelectMultiple(oItems)
Align_Labels(oItems)
End Sub

'=========================================================================================================
Sub Align_Labels(oItems)
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisDoc.Document
Dim oView As DrawingView
Dim oSheet As Sheet
oSheet = oDrawDoc.ActiveSheet
Dim trans As Transaction
trans = ThisApplication.TransactionManager.StartTransaction(oDrawDoc, "Align Views")
'Dim oSSet As SelectSet = oDrawDoc.SelectSet
'
		Dim oNewPosition As Point2d
		oNewPOS = InputBox("Add Offset?", "Title", 1)
		oNewPOS /= 10
 
For Each oView In oItems
		  oNewPosition = ThisApplication.TransientGeometry.CreatePoint2d(oView.Center.X, oView.Center.Y - (oView.Height / 2)-( 1+oNewPOS))
		   oView.Label.Position = oNewPosition
		Next
        
trans.End
Dim oDoc As Document = ThisDoc.Document
oDoc.SelectSet.SelectMultiple(oItems)
End Sub
```

---

### 53. Editing feature definitions after creation?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/editing-feature-definitions-after-creation/td-p/13817929](https://forums.autodesk.com/t5/inventor-programming-forum/editing-feature-definitions-after-creation/td-p/13817929)

**Author:** J_Pfeifer_

**Date:** ‎09-19-2025
	
		
		07:08 AM

**Description:** Good morning friends, I'm running into a situation where the Topological Naming is messing up my flange editor. The first thing of note there are only 3 variations of this type to be applied and modified from the model. A 2", 3" and 4" option. The 2" and 3" are both tapered while the 4" is not. All ...

**Code Snippets (5):**

#### Code Block 1

```vb
Dim oDoc As PartDocument = ThisDoc.Document
Dim oPDef As PartComponentDefinition = oDoc.ComponentDefinition
Dim oFaces As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
Dim oBody As SurfaceBody
Dim oFace As Inventor.Face
Dim oShellFeats As ShellFeatures
Dim oShellDef As ShellDefinition
Dim oShelllFeat As ShellFeature
Dim oThickness As Double = .1

oShellFeats = oPDef.Features.ShellFeatures

' just for testing
Try
oShelllFeat = oShellFeats.Item("MyShell")
oShelllFeat.Delete 
Catch
End Try

oBody = oPDef.SurfaceBodies.Item(1)
'oFace = oBody.Faces.Item(2)
'oFaces.Add(oFace)
oShellFeats = oPDef.Features.ShellFeatures
oShellDef = oShellFeats.CreateShellDefinition(oFaces, oThickness, ShellDirectionEnum.kInsideShellDirection)
oShelllFeat = oShellFeats.Add(oShellDef)
oShelllFeat.Name = "MyShell"
```

#### Code Block 2

```vb
Dim oDoc As PartDocument = ThisDoc.Document
Dim oPDef As PartComponentDefinition = oDoc.ComponentDefinition
Dim oFaces As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
Dim oBody As SurfaceBody
Dim oFace As Inventor.Face
Dim oShellFeats As ShellFeatures
Dim oShellDef As ShellDefinition
Dim oShelllFeat As ShellFeature
Dim oThickness As Double = .1

oShellFeats = oPDef.Features.ShellFeatures

' just for testing
Try
oShelllFeat = oShellFeats.Item("MyShell")
oShelllFeat.Delete 
Catch
End Try

oBody = oPDef.SurfaceBodies.Item(1)
'oFace = oBody.Faces.Item(2)
'oFaces.Add(oFace)
oShellFeats = oPDef.Features.ShellFeatures
oShellDef = oShellFeats.CreateShellDefinition(oFaces, oThickness, ShellDirectionEnum.kInsideShellDirection)
oShelllFeat = oShellFeats.Add(oShellDef)
oShelllFeat.Name = "MyShell"
```

#### Code Block 3

```vb
Dim oDoc As PartDocument = ThisDoc.Document
Dim oPDef As PartComponentDefinition = oDoc.ComponentDefinition
Dim oFaces As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
Dim oBody As SurfaceBody
Dim oFace As Inventor.Face
Dim oShellFeats As ShellFeatures
Dim oShellDef As ShellDefinition
Dim oShelllFeat As ShellFeature
Dim oThickness As Double = .1

oShellFeats = oPDef.Features.ShellFeatures

' just for testing
Try
oShelllFeat = oShellFeats.Item("MyShell")
oShelllFeat.Delete 
Catch
End Try

oBody = oPDef.SurfaceBodies.Item(1)
oFace = oBody.Faces.Item(2)
oFaces.Add(oFace)
oShellFeats = oPDef.Features.ShellFeatures
oShellDef = oShellFeats.CreateShellDefinition(oFaces, oThickness, ShellDirectionEnum.kInsideShellDirection)
oShelllFeat = oShellFeats.Add(oShellDef)
oShelllFeat.Name = "MyShell"
```

#### Code Block 4

```vb
Dim oDoc As PartDocument = ThisDoc.Document
Dim oPDef As PartComponentDefinition = oDoc.ComponentDefinition
Dim oFaces As FaceCollection = ThisApplication.TransientObjects.CreateFaceCollection
Dim oBody As SurfaceBody
Dim oFace As Inventor.Face
Dim oShellFeats As ShellFeatures
Dim oShellDef As ShellDefinition
Dim oShelllFeat As ShellFeature
Dim oThickness As Double = .1

oShellFeats = oPDef.Features.ShellFeatures

' just for testing
Try
oShelllFeat = oShellFeats.Item("MyShell")
oShelllFeat.Delete 
Catch
End Try

oBody = oPDef.SurfaceBodies.Item(1)
oFace = oBody.Faces.Item(2)
oFaces.Add(oFace)
oShellFeats = oPDef.Features.ShellFeatures
oShellDef = oShellFeats.CreateShellDefinition(oFaces, oThickness, ShellDirectionEnum.kInsideShellDirection)
oShelllFeat = oShellFeats.Add(oShellDef)
oShelllFeat.Name = "MyShell"
```

#### Code Block 5

```vb
If iFace.Evaluator.Area < 1 Then 
			FaceCol.Add(iFace)
		End If
```

#### Code Block 6

```vb
If iFace.Evaluator.Area < 1 Then 
			FaceCol.Add(iFace)
		End If
```

#### Code Block 7

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As PartDocument = App.ActiveDocument
	Dim CompDef As PartComponentDefinition = oDoc.ComponentDefinition
	Dim oTO As TransientObjects = App.TransientObjects
	
	Dim oParams As Inventor.UserParameters = CompDef.Parameters.UserParameters
	
	Dim oShell As ShellFeature = CompDef.Features.ShellFeatures.Item("F2 Shell feature")
	Dim oShellDef As ShellDefinition = oShell.Definition
	
	Dim oCombine As CombineFeature = CompDef.Features.CombineFeatures.Item("F2 combine")

	Dim FaceCol As FaceCollection = oTO.CreateFaceCollection
	
	For Each iFace As Face In oCombine.Faces
		If iFace.Evaluator.Area < 1 Then 
			FaceCol.Add(iFace)
		End If 
	Next
	
	oShell.SetEndOfPart(True)
	
	For Each iFace As Face In FaceCol
		oShellDef.InputFaces.Add(iFace)
	Next
	
	CompDef.SetEndOfPartToTopOrBottom(False)


	

End Sub
```

#### Code Block 8

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As PartDocument = App.ActiveDocument
	Dim CompDef As PartComponentDefinition = oDoc.ComponentDefinition
	Dim oTO As TransientObjects = App.TransientObjects
	
	Dim oParams As Inventor.UserParameters = CompDef.Parameters.UserParameters
	
	Dim oShell As ShellFeature = CompDef.Features.ShellFeatures.Item("F2 Shell feature")
	Dim oShellDef As ShellDefinition = oShell.Definition
	
	Dim oCombine As CombineFeature = CompDef.Features.CombineFeatures.Item("F2 combine")

	Dim FaceCol As FaceCollection = oTO.CreateFaceCollection
	
	For Each iFace As Face In oCombine.Faces
		If iFace.Evaluator.Area < 1 Then 
			FaceCol.Add(iFace)
		End If 
	Next
	
	oShell.SetEndOfPart(True)
	
	For Each iFace As Face In FaceCol
		oShellDef.InputFaces.Add(iFace)
	Next
	
	CompDef.SetEndOfPartToTopOrBottom(False)


	

End Sub
```

#### Code Block 9

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As PartDocument = App.ActiveDocument
	Dim CompDef As PartComponentDefinition = oDoc.ComponentDefinition
	Dim oTO As TransientObjects = App.TransientObjects
	
	Dim oParams As Inventor.UserParameters = CompDef.Parameters.UserParameters
	
	Dim oShell As ShellFeature = CompDef.Features.ShellFeatures.Item("F2 Shell feature")
	Dim oShellDef As ShellDefinition = oShell.Definition
	
	Dim oCombine As CombineFeature = CompDef.Features.CombineFeatures.Item("F2 combine")

	Dim FaceCol As FaceCollection = oTO.CreateFaceCollection
	
	For Each iFace As Face In oCombine.Faces
		If iFace.Evaluator.Area < 1 Then 
			FaceCol.Add(iFace)
		End If 
	Next
	
	oShell.SetEndOfPart(True)
	
	For Each iFace As Face In FaceCol
		oShellDef.InputFaces.Add(iFace)
	Next
	
	CompDef.SetEndOfPartToTopOrBottom(False)


	

End Sub
```

#### Code Block 10

```vb
Sub main()
	
	Dim App As Inventor.Application = ThisApplication
	Dim oDoc As PartDocument = App.ActiveDocument
	Dim CompDef As PartComponentDefinition = oDoc.ComponentDefinition
	Dim oTO As TransientObjects = App.TransientObjects
	
	Dim oParams As Inventor.UserParameters = CompDef.Parameters.UserParameters
	
	Dim oShell As ShellFeature = CompDef.Features.ShellFeatures.Item("F2 Shell feature")
	Dim oShellDef As ShellDefinition = oShell.Definition
	
	Dim oCombine As CombineFeature = CompDef.Features.CombineFeatures.Item("F2 combine")

	Dim FaceCol As FaceCollection = oTO.CreateFaceCollection
	
	For Each iFace As Face In oCombine.Faces
		If iFace.Evaluator.Area < 1 Then 
			FaceCol.Add(iFace)
		End If 
	Next
	
	oShell.SetEndOfPart(True)
	
	For Each iFace As Face In FaceCol
		oShellDef.InputFaces.Add(iFace)
	Next
	
	CompDef.SetEndOfPartToTopOrBottom(False)


	

End Sub
```

---

### 54. Enable Add-in in Inventor Nesting

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/enable-add-in-in-inventor-nesting/td-p/13759956](https://forums.autodesk.com/t5/inventor-programming-forum/enable-add-in-in-inventor-nesting/td-p/13759956)

**Author:** Mustafa.Salaheldin

**Date:** ‎08-08-2025
	
		
		07:15 AM

**Description:** Hello Folks I'm just taking my baby steps in the Inventor Automation thing. What I want to do is to build an Add-in that works in "Nesting Environment". This is the code I wrote: using Autodesk.InventorAddins.Common; using Inventor; using System; using System.Drawing; using System.Runtime.InteropSer...

**Code Snippets (6):**

#### Code Block 1

```vb
// Example: enable button only in Nesting environment
bool inNesting = environment.DisplayName.Equals("Nesting", StringComparison.OrdinalIgnoreCase);
bool isAssemblyDocument = m_inventorApplication.ActiveDocument?.DocumentType == DocumentTypeEnum.kAssemblyDocumentObject;
```

#### Code Block 2

```vb
// Example: enable button only in Nesting environment
bool inNesting = environment.DisplayName.Equals("Nesting", StringComparison.OrdinalIgnoreCase);
bool isAssemblyDocument = m_inventorApplication.ActiveDocument?.DocumentType == DocumentTypeEnum.kAssemblyDocumentObject;
```

#### Code Block 3

```vb
// Example: enable button only in Nesting environment
bool inNesting = environment.DisplayName.Equals("Nesting", StringComparison.OrdinalIgnoreCase);
bool isAssemblyDocument = m_inventorApplication.ActiveDocument?.DocumentType == DocumentTypeEnum.kAssemblyDocumentObject;
```

#### Code Block 4

```vb
// Example: enable button only in Nesting environment
bool inNesting = environment.DisplayName.Equals("Nesting", StringComparison.OrdinalIgnoreCase);
bool isAssemblyDocument = m_inventorApplication.ActiveDocument?.DocumentType == DocumentTypeEnum.kAssemblyDocumentObject;
```

#### Code Block 5

```vb
Ribbon ribbon = m_inventorApplication.UserInterfaceManager.Ribbons["Assembly"];
```

#### Code Block 6

```vb
Ribbon ribbon = m_inventorApplication.UserInterfaceManager.Ribbons["Assembly"];
```

#### Code Block 7

```vb
Ribbon ribbon = m_inventorApplication.UserInterfaceManager.Ribbons["Assembly"];
```

#### Code Block 8

```vb
Ribbon ribbon = m_inventorApplication.UserInterfaceManager.Ribbons["Assembly"];
```

#### Code Block 9

```vb
using Autodesk.InventorAddins.Common;
using Inventor;
using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using static System.Net.Mime.MediaTypeNames;

namespace NestingStudyRenamer
{
    /// <summary>
    /// This is the primary AddIn Server class that implements the ApplicationAddInServer interface
    /// that all Inventor AddIns are required to implement. The communication between Inventor and
    /// the AddIn is via the methods on this interface.
    /// </summary>
    [GuidAttribute("72571078-0228-45ef-9f4a-8dda3af5f612")]
    public class StandardAddInServer : Inventor.ApplicationAddInServer
    {

        // Inventor application object.
        private Inventor.Application m_inventorApplication;
        private Inventor.ButtonDefinition m_helloButton;
        public StandardAddInServer()
        {

        }

        #region ApplicationAddInServer Members

        public void Activate(Inventor.ApplicationAddInSite addInSiteObject, bool firstTime)
        {
            try
            {
                // This method is called by Inventor when it loads the addin.
                // The AddInSiteObject provides access to the Inventor Application object.
                // The FirstTime flag indicates if the addin is loaded for the first time.

                // Initialize AddIn members.
                m_inventorApplication = addInSiteObject.Application;
                m_inventorApplication.UserInterfaceManager.UserInterfaceEvents.OnEnvironmentChange += new Inventor.UserInterfaceEventsSink_OnEnvironmentChangeEventHandler(OnEnvChange);

                // TODO: Add ApplicationAddInServer.Activate implementation.
                // e.g. event initialization, command creation etc.
                // Create icon (optional, using built-in icon for now)
                // Create UI Button
                var controlDefs = m_inventorApplication.CommandManager.ControlDefinitions;

                // Load icons from embedded resource or disk
                System.Drawing.Image icon16 = PictureDispConverter.LoadResourcesImage(InvAddIn.Properties.Resources.autocad_2017_badge_16x16);
                System.Drawing.Image icon32 = PictureDispConverter.LoadResourcesImage(InvAddIn.Properties.Resources.autocad_2017_badge_32x32);

                // Convert to IPictureDisp
                stdole.IPictureDisp icon16Disp = PictureDispConverter.ToIPictureDisp(icon16);
                stdole.IPictureDisp icon32Disp = PictureDispConverter.ToIPictureDisp(icon32);

                m_helloButton = controlDefs.AddButtonDefinition(
                    "Say Hello", "SayHelloBtn",
                    CommandTypesEnum.kNonShapeEditCmdType | CommandTypesEnum.kEditMaskCmdType, "{72571078-0228-45ef-9f4a-8dda3af5f612}",
                    "Displays Hello World",
                    "Click to show message",
                    icon16Disp,  // 16x16 icon
                    icon32Disp  // 32x32 icon

                );

                //Use proper event delegate
                m_helloButton.OnExecute += new ButtonDefinitionSink_OnExecuteEventHandler(HelloButton_OnExecute);
                m_helloButton.Enabled = true;

                // Add button to UI (Part Ribbon Tab)
                Ribbon ribbon = m_inventorApplication.UserInterfaceManager.Ribbons["Assembly"];
                RibbonTab tab = ribbon.RibbonTabs["id_TabTools"];
                RibbonPanel panel = tab.RibbonPanels.Add("Hello Panel",
                    "HelloPanel",
                    "{72571078-0228-45ef-9f4a-8dda3af5f612}",
                    "", false);

                panel.CommandControls.AddButton(m_helloButton, true);

            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }

        private void OnEnvChange(Inventor.Environment environment,
                                    EnvironmentStateEnum environmentState,
                                    EventTimingEnum beforeOrAfter,
                                    NameValueMap context,
                                    out HandlingCodeEnum handlingCode)
        {

            // Only proceed after environment change
            if (beforeOrAfter == Inventor.EventTimingEnum.kAfter)
            {

                // Example: enable button only in Nesting environment
                bool inNesting = environment.DisplayName.Equals("Nesting", StringComparison.OrdinalIgnoreCase);
                bool isAssemblyDocument = m_inventorApplication.ActiveDocument?.DocumentType == DocumentTypeEnum.kAssemblyDocumentObject;

                if (inNesting && isAssemblyDocument)
                {
                    m_helloButton.OnExecute += new ButtonDefinitionSink_OnExecuteEventHandler(HelloButton_OnExecute);
                    m_helloButton.Enabled = inNesting;
                }

                //MessageBox.Show(m_helloButton.Enabled.ToString());

                handlingCode = HandlingCodeEnum.kEventHandled;
            }
            else
            {
                handlingCode = HandlingCodeEnum.kEventNotHandled;
            }

        }

        //Define the handler method
        virtual protected void HelloButton_OnExecute(NameValueMap Context)
        {
            InvAddIn.frmMain frm = new InvAddIn.frmMain(m_inventorApplication);

            if (frm != null)
            {
                frm.Activate();
                frm.TopMost = true;
                frm.ShowInTaskbar = false;
                frm.Show();
            }
        }

        public void Deactivate()
        {
            // This method is called by Inventor when the AddIn is unloaded.
            // The AddIn will be unloaded either manually by the user or
            // when the Inventor session is terminated

            // TODO: Add ApplicationAddInServer.Deactivate implementation
            Marshal.ReleaseComObject(m_inventorApplication);
            // Release objects.
            m_inventorApplication = null;

            GC.Collect();
            GC.WaitForPendingFinalizers();
        }

        public void ExecuteCommand(int commandID)
        {
            // Note:this method is now obsolete, you should use the 
            // ControlDefinition functionality for implementing commands.
        }

        public object Automation
        {
            // This property is provided to allow the AddIn to expose an API 
            // of its own to other programs. Typically, this  would be done by
            // implementing the AddIn's API interface in a class and returning 
            // that class object through this property.

            get
            {
                // TODO: Add ApplicationAddInServer.Automation getter implementation
                return null;
            }
        }

        #endregion

    }
}
```

#### Code Block 10

```vb
using Autodesk.InventorAddins.Common;
using Inventor;
using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using static System.Net.Mime.MediaTypeNames;

namespace NestingStudyRenamer
{
    /// <summary>
    /// This is the primary AddIn Server class that implements the ApplicationAddInServer interface
    /// that all Inventor AddIns are required to implement. The communication between Inventor and
    /// the AddIn is via the methods on this interface.
    /// </summary>
    [GuidAttribute("72571078-0228-45ef-9f4a-8dda3af5f612")]
    public class StandardAddInServer : Inventor.ApplicationAddInServer
    {

        // Inventor application object.
        private Inventor.Application m_inventorApplication;
        private Inventor.ButtonDefinition m_helloButton;
        public StandardAddInServer()
        {

        }

        #region ApplicationAddInServer Members

        public void Activate(Inventor.ApplicationAddInSite addInSiteObject, bool firstTime)
        {
            try
            {
                // This method is called by Inventor when it loads the addin.
                // The AddInSiteObject provides access to the Inventor Application object.
                // The FirstTime flag indicates if the addin is loaded for the first time.

                // Initialize AddIn members.
                m_inventorApplication = addInSiteObject.Application;
                m_inventorApplication.UserInterfaceManager.UserInterfaceEvents.OnEnvironmentChange += new Inventor.UserInterfaceEventsSink_OnEnvironmentChangeEventHandler(OnEnvChange);

                // TODO: Add ApplicationAddInServer.Activate implementation.
                // e.g. event initialization, command creation etc.
                // Create icon (optional, using built-in icon for now)
                // Create UI Button
                var controlDefs = m_inventorApplication.CommandManager.ControlDefinitions;

                // Load icons from embedded resource or disk
                System.Drawing.Image icon16 = PictureDispConverter.LoadResourcesImage(InvAddIn.Properties.Resources.autocad_2017_badge_16x16);
                System.Drawing.Image icon32 = PictureDispConverter.LoadResourcesImage(InvAddIn.Properties.Resources.autocad_2017_badge_32x32);

                // Convert to IPictureDisp
                stdole.IPictureDisp icon16Disp = PictureDispConverter.ToIPictureDisp(icon16);
                stdole.IPictureDisp icon32Disp = PictureDispConverter.ToIPictureDisp(icon32);

                m_helloButton = controlDefs.AddButtonDefinition(
                    "Say Hello", "SayHelloBtn",
                    CommandTypesEnum.kNonShapeEditCmdType | CommandTypesEnum.kEditMaskCmdType, "{72571078-0228-45ef-9f4a-8dda3af5f612}",
                    "Displays Hello World",
                    "Click to show message",
                    icon16Disp,  // 16x16 icon
                    icon32Disp  // 32x32 icon

                );

                //Use proper event delegate
                m_helloButton.OnExecute += new ButtonDefinitionSink_OnExecuteEventHandler(HelloButton_OnExecute);
                m_helloButton.Enabled = true;

                // Add button to UI (Part Ribbon Tab)
                Ribbon ribbon = m_inventorApplication.UserInterfaceManager.Ribbons["Assembly"];
                RibbonTab tab = ribbon.RibbonTabs["id_TabTools"];
                RibbonPanel panel = tab.RibbonPanels.Add("Hello Panel",
                    "HelloPanel",
                    "{72571078-0228-45ef-9f4a-8dda3af5f612}",
                    "", false);

                panel.CommandControls.AddButton(m_helloButton, true);

            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }

        private void OnEnvChange(Inventor.Environment environment,
                                    EnvironmentStateEnum environmentState,
                                    EventTimingEnum beforeOrAfter,
                                    NameValueMap context,
                                    out HandlingCodeEnum handlingCode)
        {

            // Only proceed after environment change
            if (beforeOrAfter == Inventor.EventTimingEnum.kAfter)
            {

                // Example: enable button only in Nesting environment
                bool inNesting = environment.DisplayName.Equals("Nesting", StringComparison.OrdinalIgnoreCase);
                bool isAssemblyDocument = m_inventorApplication.ActiveDocument?.DocumentType == DocumentTypeEnum.kAssemblyDocumentObject;

                if (inNesting && isAssemblyDocument)
                {
                    m_helloButton.OnExecute += new ButtonDefinitionSink_OnExecuteEventHandler(HelloButton_OnExecute);
                    m_helloButton.Enabled = inNesting;
                }

                //MessageBox.Show(m_helloButton.Enabled.ToString());

                handlingCode = HandlingCodeEnum.kEventHandled;
            }
            else
            {
                handlingCode = HandlingCodeEnum.kEventNotHandled;
            }

        }

        //Define the handler method
        virtual protected void HelloButton_OnExecute(NameValueMap Context)
        {
            InvAddIn.frmMain frm = new InvAddIn.frmMain(m_inventorApplication);

            if (frm != null)
            {
                frm.Activate();
                frm.TopMost = true;
                frm.ShowInTaskbar = false;
                frm.Show();
            }
        }

        public void Deactivate()
        {
            // This method is called by Inventor when the AddIn is unloaded.
            // The AddIn will be unloaded either manually by the user or
            // when the Inventor session is terminated

            // TODO: Add ApplicationAddInServer.Deactivate implementation
            Marshal.ReleaseComObject(m_inventorApplication);
            // Release objects.
            m_inventorApplication = null;

            GC.Collect();
            GC.WaitForPendingFinalizers();
        }

        public void ExecuteCommand(int commandID)
        {
            // Note:this method is now obsolete, you should use the 
            // ControlDefinition functionality for implementing commands.
        }

        public object Automation
        {
            // This property is provided to allow the AddIn to expose an API 
            // of its own to other programs. Typically, this  would be done by
            // implementing the AddIn's API interface in a class and returning 
            // that class object through this property.

            get
            {
                // TODO: Add ApplicationAddInServer.Automation getter implementation
                return null;
            }
        }

        #endregion

    }
}
```

#### Code Block 11

```vb
using Autodesk.InventorAddins.Common;
using Inventor;
using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using static System.Net.Mime.MediaTypeNames;

namespace NestingStudyRenamer
{
    /// <summary>
    /// This is the primary AddIn Server class that implements the ApplicationAddInServer interface
    /// that all Inventor AddIns are required to implement. The communication between Inventor and
    /// the AddIn is via the methods on this interface.
    /// </summary>
    [GuidAttribute("72571078-0228-45ef-9f4a-8dda3af5f612")]
    public class StandardAddInServer : Inventor.ApplicationAddInServer
    {

        // Inventor application object.
        private Inventor.Application m_inventorApplication;
        private Inventor.ButtonDefinition m_helloButton;
        public StandardAddInServer()
        {

        }

        #region ApplicationAddInServer Members

        public void Activate(Inventor.ApplicationAddInSite addInSiteObject, bool firstTime)
        {
            try
            {
                // This method is called by Inventor when it loads the addin.
                // The AddInSiteObject provides access to the Inventor Application object.
                // The FirstTime flag indicates if the addin is loaded for the first time.

                // Initialize AddIn members.
                m_inventorApplication = addInSiteObject.Application;
                m_inventorApplication.UserInterfaceManager.UserInterfaceEvents.OnEnvironmentChange += new Inventor.UserInterfaceEventsSink_OnEnvironmentChangeEventHandler(OnEnvChange);

                // TODO: Add ApplicationAddInServer.Activate implementation.
                // e.g. event initialization, command creation etc.
                // Create icon (optional, using built-in icon for now)
                // Create UI Button
                var controlDefs = m_inventorApplication.CommandManager.ControlDefinitions;

                // Load icons from embedded resource or disk
                System.Drawing.Image icon16 = PictureDispConverter.LoadResourcesImage(InvAddIn.Properties.Resources.autocad_2017_badge_16x16);
                System.Drawing.Image icon32 = PictureDispConverter.LoadResourcesImage(InvAddIn.Properties.Resources.autocad_2017_badge_32x32);

                // Convert to IPictureDisp
                stdole.IPictureDisp icon16Disp = PictureDispConverter.ToIPictureDisp(icon16);
                stdole.IPictureDisp icon32Disp = PictureDispConverter.ToIPictureDisp(icon32);

                m_helloButton = controlDefs.AddButtonDefinition(
                    "Say Hello", "SayHelloBtn",
                    CommandTypesEnum.kNonShapeEditCmdType | CommandTypesEnum.kEditMaskCmdType, "{72571078-0228-45ef-9f4a-8dda3af5f612}",
                    "Displays Hello World",
                    "Click to show message",
                    icon16Disp,  // 16x16 icon
                    icon32Disp  // 32x32 icon

                );

                //Use proper event delegate
                m_helloButton.OnExecute += new ButtonDefinitionSink_OnExecuteEventHandler(HelloButton_OnExecute);
                m_helloButton.Enabled = true;

                // Add button to UI (Part Ribbon Tab)
                Ribbon ribbon = m_inventorApplication.UserInterfaceManager.Ribbons["Assembly"];
                RibbonTab tab = ribbon.RibbonTabs["id_TabTools"];
                RibbonPanel panel = tab.RibbonPanels.Add("Hello Panel",
                    "HelloPanel",
                    "{72571078-0228-45ef-9f4a-8dda3af5f612}",
                    "", false);

                panel.CommandControls.AddButton(m_helloButton, true);

            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }

        private void OnEnvChange(Inventor.Environment environment,
                                    EnvironmentStateEnum environmentState,
                                    EventTimingEnum beforeOrAfter,
                                    NameValueMap context,
                                    out HandlingCodeEnum handlingCode)
        {

            // Only proceed after environment change
            if (beforeOrAfter == Inventor.EventTimingEnum.kAfter)
            {

                // Example: enable button only in Nesting environment
                bool inNesting = environment.DisplayName.Equals("Nesting", StringComparison.OrdinalIgnoreCase);
                bool isAssemblyDocument = m_inventorApplication.ActiveDocument?.DocumentType == DocumentTypeEnum.kAssemblyDocumentObject;

                if (inNesting && isAssemblyDocument)
                {
                    m_helloButton.OnExecute += new ButtonDefinitionSink_OnExecuteEventHandler(HelloButton_OnExecute);
                    m_helloButton.Enabled = inNesting;
                }

                //MessageBox.Show(m_helloButton.Enabled.ToString());

                handlingCode = HandlingCodeEnum.kEventHandled;
            }
            else
            {
                handlingCode = HandlingCodeEnum.kEventNotHandled;
            }

        }

        //Define the handler method
        virtual protected void HelloButton_OnExecute(NameValueMap Context)
        {
            InvAddIn.frmMain frm = new InvAddIn.frmMain(m_inventorApplication);

            if (frm != null)
            {
                frm.Activate();
                frm.TopMost = true;
                frm.ShowInTaskbar = false;
                frm.Show();
            }
        }

        public void Deactivate()
        {
            // This method is called by Inventor when the AddIn is unloaded.
            // The AddIn will be unloaded either manually by the user or
            // when the Inventor session is terminated

            // TODO: Add ApplicationAddInServer.Deactivate implementation
            Marshal.ReleaseComObject(m_inventorApplication);
            // Release objects.
            m_inventorApplication = null;

            GC.Collect();
            GC.WaitForPendingFinalizers();
        }

        public void ExecuteCommand(int commandID)
        {
            // Note:this method is now obsolete, you should use the 
            // ControlDefinition functionality for implementing commands.
        }

        public object Automation
        {
            // This property is provided to allow the AddIn to expose an API 
            // of its own to other programs. Typically, this  would be done by
            // implementing the AddIn's API interface in a class and returning 
            // that class object through this property.

            get
            {
                // TODO: Add ApplicationAddInServer.Automation getter implementation
                return null;
            }
        }

        #endregion

    }
}
```

#### Code Block 12

```vb
using Autodesk.InventorAddins.Common;
using Inventor;
using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using static System.Net.Mime.MediaTypeNames;

namespace NestingStudyRenamer
{
    /// <summary>
    /// This is the primary AddIn Server class that implements the ApplicationAddInServer interface
    /// that all Inventor AddIns are required to implement. The communication between Inventor and
    /// the AddIn is via the methods on this interface.
    /// </summary>
    [GuidAttribute("72571078-0228-45ef-9f4a-8dda3af5f612")]
    public class StandardAddInServer : Inventor.ApplicationAddInServer
    {

        // Inventor application object.
        private Inventor.Application m_inventorApplication;
        private Inventor.ButtonDefinition m_helloButton;
        public StandardAddInServer()
        {

        }

        #region ApplicationAddInServer Members

        public void Activate(Inventor.ApplicationAddInSite addInSiteObject, bool firstTime)
        {
            try
            {
                // This method is called by Inventor when it loads the addin.
                // The AddInSiteObject provides access to the Inventor Application object.
                // The FirstTime flag indicates if the addin is loaded for the first time.

                // Initialize AddIn members.
                m_inventorApplication = addInSiteObject.Application;
                m_inventorApplication.UserInterfaceManager.UserInterfaceEvents.OnEnvironmentChange += new Inventor.UserInterfaceEventsSink_OnEnvironmentChangeEventHandler(OnEnvChange);

                // TODO: Add ApplicationAddInServer.Activate implementation.
                // e.g. event initialization, command creation etc.
                // Create icon (optional, using built-in icon for now)
                // Create UI Button
                var controlDefs = m_inventorApplication.CommandManager.ControlDefinitions;

                // Load icons from embedded resource or disk
                System.Drawing.Image icon16 = PictureDispConverter.LoadResourcesImage(InvAddIn.Properties.Resources.autocad_2017_badge_16x16);
                System.Drawing.Image icon32 = PictureDispConverter.LoadResourcesImage(InvAddIn.Properties.Resources.autocad_2017_badge_32x32);

                // Convert to IPictureDisp
                stdole.IPictureDisp icon16Disp = PictureDispConverter.ToIPictureDisp(icon16);
                stdole.IPictureDisp icon32Disp = PictureDispConverter.ToIPictureDisp(icon32);

                m_helloButton = controlDefs.AddButtonDefinition(
                    "Say Hello", "SayHelloBtn",
                    CommandTypesEnum.kNonShapeEditCmdType | CommandTypesEnum.kEditMaskCmdType, "{72571078-0228-45ef-9f4a-8dda3af5f612}",
                    "Displays Hello World",
                    "Click to show message",
                    icon16Disp,  // 16x16 icon
                    icon32Disp  // 32x32 icon

                );

                //Use proper event delegate
                m_helloButton.OnExecute += new ButtonDefinitionSink_OnExecuteEventHandler(HelloButton_OnExecute);
                m_helloButton.Enabled = true;

                // Add button to UI (Part Ribbon Tab)
                Ribbon ribbon = m_inventorApplication.UserInterfaceManager.Ribbons["Assembly"];
                RibbonTab tab = ribbon.RibbonTabs["id_TabTools"];
                RibbonPanel panel = tab.RibbonPanels.Add("Hello Panel",
                    "HelloPanel",
                    "{72571078-0228-45ef-9f4a-8dda3af5f612}",
                    "", false);

                panel.CommandControls.AddButton(m_helloButton, true);

            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }

        private void OnEnvChange(Inventor.Environment environment,
                                    EnvironmentStateEnum environmentState,
                                    EventTimingEnum beforeOrAfter,
                                    NameValueMap context,
                                    out HandlingCodeEnum handlingCode)
        {

            // Only proceed after environment change
            if (beforeOrAfter == Inventor.EventTimingEnum.kAfter)
            {

                // Example: enable button only in Nesting environment
                bool inNesting = environment.DisplayName.Equals("Nesting", StringComparison.OrdinalIgnoreCase);
                bool isAssemblyDocument = m_inventorApplication.ActiveDocument?.DocumentType == DocumentTypeEnum.kAssemblyDocumentObject;

                if (inNesting && isAssemblyDocument)
                {
                    m_helloButton.OnExecute += new ButtonDefinitionSink_OnExecuteEventHandler(HelloButton_OnExecute);
                    m_helloButton.Enabled = inNesting;
                }

                //MessageBox.Show(m_helloButton.Enabled.ToString());

                handlingCode = HandlingCodeEnum.kEventHandled;
            }
            else
            {
                handlingCode = HandlingCodeEnum.kEventNotHandled;
            }

        }

        //Define the handler method
        virtual protected void HelloButton_OnExecute(NameValueMap Context)
        {
            InvAddIn.frmMain frm = new InvAddIn.frmMain(m_inventorApplication);

            if (frm != null)
            {
                frm.Activate();
                frm.TopMost = true;
                frm.ShowInTaskbar = false;
                frm.Show();
            }
        }

        public void Deactivate()
        {
            // This method is called by Inventor when the AddIn is unloaded.
            // The AddIn will be unloaded either manually by the user or
            // when the Inventor session is terminated

            // TODO: Add ApplicationAddInServer.Deactivate implementation
            Marshal.ReleaseComObject(m_inventorApplication);
            // Release objects.
            m_inventorApplication = null;

            GC.Collect();
            GC.WaitForPendingFinalizers();
        }

        public void ExecuteCommand(int commandID)
        {
            // Note:this method is now obsolete, you should use the 
            // ControlDefinition functionality for implementing commands.
        }

        public object Automation
        {
            // This property is provided to allow the AddIn to expose an API 
            // of its own to other programs. Typically, this  would be done by
            // implementing the AddIn's API interface in a class and returning 
            // that class object through this property.

            get
            {
                // TODO: Add ApplicationAddInServer.Automation getter implementation
                return null;
            }
        }

        #endregion

    }
}
```

---

### 55. Export all Files of assembly to step files with part number as name

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/export-all-files-of-assembly-to-step-files-with-part-number-as/td-p/9941719#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/export-all-files-of-assembly-to-step-files-with-part-number-as/td-p/9941719#messageview_0)

**Author:** roelfoubert

**Date:** ‎12-15-2020
	
		
		08:08 AM

**Description:** I had a script to export all files of an assembly to seperate STEP-files.In this script I use the filename to name the STEP-files.I want to change it to the partnumber but it won't work. It always uses the partnumber of the assembly.Not the individual parts.'check that the active document is an asse...

**Code Snippets (17):**

#### Code Block 1

```vb
'check that the active document is an assembly file
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MessageBox.Show("This Rule " & iLogicVb.RuleName & " only works on Assembly Files.", "WRONG DOCUMENT TYPE",MessageBoxButtons.OK,MessageBoxIcon.Error)
	Return
End If

'define the active document as an assembly file
Dim oAsmDoc As AssemblyDocument
oAsmDoc = ThisApplication.ActiveDocument
oAsmName = ThisDoc.FileName(False) 'without extension

If ThisApplication.ActiveDocument.DocumentType <> kAssemblyDocumentObject Then
    MessageBox.Show("Please run this rule from the assembly file.", "iLogic")
    Exit Sub
End If

'get user input
RUsure = MessageBox.Show ( _
"This will create a STEP file for all components." _
& vbLf & " " _
& vbLf & "Are you sure you want to create STEP Drawings for all of the assembly components?" _
& vbLf & "This could take a while.", "iLogic - Batch Output STEPs ",MessageBoxButtons.YesNo)
If RUsure = vbNo Then
    Return
Else
End If

'- - - - - - - - - - - - -STEP setup - - - - - - - - - - - -
oPath = ThisDoc.Path
'get STEP target folder path
' original => oFolder = oPath & "\" & oAsmName & " STEP Files"
oFolder = oPath & "\STEP Files"
'Check for the step folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
System.IO.Directory.CreateDirectory(oFolder)
End If


'- - - - - - - - - - - - -Assembly - - - - - - - - - - - -
ThisDoc.Document.SaveAs(oFolder & "\" & oAsmName &(".stp") , True)

'- - - - - - - - - - - - -Components - - - - - - - - - - - -
'look at the files referenced by the assembly
Dim oRefDocs As DocumentsEnumerator
oRefDocs = oAsmDoc.AllReferencedDocuments
Dim oRefDoc As Document
'work the referenced models
For Each oRefDoc In oRefDocs
    Dim oCurFile As Document
    oCurFile = ThisApplication.Documents.Open(oRefDoc.FullFileName, True)
    oCurFileName = oCurFile.FullFileName
   
    'defines backslash As the subdirectory separator
    Dim strCharSep As String = System.IO.Path.DirectorySeparatorChar
   
    'find the postion of the last backslash in the path
    FNamePos = InStrRev(oCurFileName, "\", -1)  
    'get the file name with the file extension
    Name = Right(oCurFileName, Len(oCurFileName) - FNamePos)
    'get the file name (without extension)
    ShortName = Left(Name, Len(Name) - 4)

    Try
        oCurFile.SaveAs(oFolder & "\" & ShortName & (".stp") , True)
    Catch
        MessageBox.Show("Error processing " & oCurFileName, "ilogic")
    End Try
    oCurFile.Close
Next
'- - - - - - - - - - - - -
MessageBox.Show("New Files Created in: " & vbLf & oFolder, "iLogic")
)
```

#### Code Block 2

```vb
'check that the active document is an assembly file
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MessageBox.Show("This Rule " & iLogicVb.RuleName & " only works on Assembly Files.", "WRONG DOCUMENT TYPE",MessageBoxButtons.OK,MessageBoxIcon.Error)
	Return
End If

'define the active document as an assembly file
Dim oAsmDoc As AssemblyDocument
oAsmDoc = ThisApplication.ActiveDocument
oAsmName = ThisDoc.FileName(False) 'without extension

If ThisApplication.ActiveDocument.DocumentType <> kAssemblyDocumentObject Then
    MessageBox.Show("Please run this rule from the assembly file.", "iLogic")
    Exit Sub
End If

'get user input
RUsure = MessageBox.Show ( _
"This will create a STEP file for all components." _
& vbLf & " " _
& vbLf & "Are you sure you want to create STEP Drawings for all of the assembly components?" _
& vbLf & "This could take a while.", "iLogic - Batch Output STEPs ",MessageBoxButtons.YesNo)
If RUsure = vbNo Then
    Return
Else
End If

'- - - - - - - - - - - - -STEP setup - - - - - - - - - - - -
oPath = ThisDoc.Path
'get STEP target folder path
' original => oFolder = oPath & "\" & oAsmName & " STEP Files"
oFolder = oPath & "\STEP Files"
'Check for the step folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
System.IO.Directory.CreateDirectory(oFolder)
End If


'- - - - - - - - - - - - -Assembly - - - - - - - - - - - -
ThisDoc.Document.SaveAs(oFolder & "\" & oAsmName &(".stp") , True)

'- - - - - - - - - - - - -Components - - - - - - - - - - - -
'look at the files referenced by the assembly
Dim oRefDocs As DocumentsEnumerator
oRefDocs = oAsmDoc.AllReferencedDocuments
Dim oRefDoc As Document
'work the referenced models
For Each oRefDoc In oRefDocs
    Dim oCurFile As Document
    oCurFile = ThisApplication.Documents.Open(oRefDoc.FullFileName, True)
    oCurFileName = oCurFile.FullFileName
   
    'defines backslash As the subdirectory separator
    Dim strCharSep As String = System.IO.Path.DirectorySeparatorChar
   
    'find the postion of the last backslash in the path
    FNamePos = InStrRev(oCurFileName, "\", -1)  
    'get the file name with the file extension
    Name = Right(oCurFileName, Len(oCurFileName) - FNamePos)
    'get the file name (without extension)
    ShortName = Left(Name, Len(Name) - 4)

    Try
        oCurFile.SaveAs(oFolder & "\" & ShortName & (".stp") , True)
    Catch
        MessageBox.Show("Error processing " & oCurFileName, "ilogic")
    End Try
    oCurFile.Close
Next
'- - - - - - - - - - - - -
MessageBox.Show("New Files Created in: " & vbLf & oFolder, "iLogic")
)
```

#### Code Block 3

```vb
'check that the active document is an assembly file
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MessageBox.Show("This Rule " & iLogicVb.RuleName & " only works on Assembly Files.", "WRONG DOCUMENT TYPE",MessageBoxButtons.OK,MessageBoxIcon.Error)
	Return
End If

'define the active document as an assembly file
Dim oAsmDoc As AssemblyDocument
oAsmDoc = ThisApplication.ActiveDocument
oAsmName = ThisDoc.FileName(False) 'without extension

If ThisApplication.ActiveDocument.DocumentType <> kAssemblyDocumentObject Then
    MessageBox.Show("Please run this rule from the assembly file.", "iLogic")
    Exit Sub
End If

'get user input
RUsure = MessageBox.Show ( _
"This will create a STEP file for all components." _
& vbLf & " " _
& vbLf & "Are you sure you want to create STEP Drawings for all of the assembly components?" _
& vbLf & "This could take a while.", "iLogic - Batch Output STEPs ",MessageBoxButtons.YesNo)
If RUsure = vbNo Then
    Return
Else
End If

'- - - - - - - - - - - - -STEP setup - - - - - - - - - - - -
oPath = ThisDoc.Path
'get STEP target folder path
' original => oFolder = oPath & "\" & oAsmName & " STEP Files"
oFolder = oPath & "\STEP Files"
'Check for the step folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
System.IO.Directory.CreateDirectory(oFolder)
End If


'- - - - - - - - - - - - -Assembly - - - - - - - - - - - -
ThisDoc.Document.SaveAs(oFolder & "\" & oAsmName &(".stp") , True)

'- - - - - - - - - - - - -Components - - - - - - - - - - - -
'look at the files referenced by the assembly
Dim oRefDocs As DocumentsEnumerator
oRefDocs = oAsmDoc.AllReferencedDocuments
Dim oRefDoc As Document
'work the referenced models
For Each oRefDoc In oRefDocs
    Dim oCurFile As Document
    oCurFile = ThisApplication.Documents.Open(oRefDoc.FullFileName, True)
    oCurFileName = oCurFile.FullFileName
   
    'defines backslash As the subdirectory separator
    Dim strCharSep As String = System.IO.Path.DirectorySeparatorChar
   
    'find the postion of the last backslash in the path
    FNamePos = InStrRev(oCurFileName, "\", -1)  
    'get the file name with the file extension
    Name = Right(oCurFileName, Len(oCurFileName) - FNamePos)
    'get the file name (without extension)
    ShortName = Left(Name, Len(Name) - 4)

    Try
        oCurFile.SaveAs(oFolder & "\" & ShortName & (".stp") , True)
    Catch
        MessageBox.Show("Error processing " & oCurFileName, "ilogic")
    End Try
    oCurFile.Close
Next
'- - - - - - - - - - - - -
MessageBox.Show("New Files Created in: " & vbLf & oFolder, "iLogic")
)
```

#### Code Block 4

```vb
'check that the active document is an assembly file
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MessageBox.Show("This Rule " & iLogicVb.RuleName & " only works on Assembly Files.", "WRONG DOCUMENT TYPE",MessageBoxButtons.OK,MessageBoxIcon.Error)
	Return
End If

'define the active document as an assembly file
Dim oAsmDoc As AssemblyDocument
oAsmDoc = ThisApplication.ActiveDocument
oAsmName = ThisDoc.FileName(False) 'without extension

If ThisApplication.ActiveDocument.DocumentType <> kAssemblyDocumentObject Then
    MessageBox.Show("Please run this rule from the assembly file.", "iLogic")
    Exit Sub
End If

'get user input
RUsure = MessageBox.Show ( _
"This will create a STEP file for all components." _
& vbLf & " " _
& vbLf & "Are you sure you want to create STEP Drawings for all of the assembly components?" _
& vbLf & "This could take a while.", "iLogic - Batch Output STEPs ",MessageBoxButtons.YesNo)
If RUsure = vbNo Then
    Return
Else
End If

'- - - - - - - - - - - - -STEP setup - - - - - - - - - - - -
oPath = ThisDoc.Path
'get STEP target folder path
' original => oFolder = oPath & "\" & oAsmName & " STEP Files"
oFolder = oPath & "\STEP Files"
'Check for the step folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
System.IO.Directory.CreateDirectory(oFolder)
End If


'- - - - - - - - - - - - -Assembly - - - - - - - - - - - -
ThisDoc.Document.SaveAs(oFolder & "\" & oAsmName &(".stp") , True)

'- - - - - - - - - - - - -Components - - - - - - - - - - - -
'look at the files referenced by the assembly
Dim oRefDocs As DocumentsEnumerator
oRefDocs = oAsmDoc.AllReferencedDocuments
Dim oRefDoc As Document
'work the referenced models
For Each oRefDoc In oRefDocs
    Dim oCurFile As Document
    oCurFile = ThisApplication.Documents.Open(oRefDoc.FullFileName, True)
    oCurFileName = oCurFile.FullFileName
   
    'defines backslash As the subdirectory separator
    Dim strCharSep As String = System.IO.Path.DirectorySeparatorChar
   
    'find the postion of the last backslash in the path
    FNamePos = InStrRev(oCurFileName, "\", -1)  
    'get the file name with the file extension
    Name = Right(oCurFileName, Len(oCurFileName) - FNamePos)
    'get the file name (without extension)
    ShortName = Left(Name, Len(Name) - 4)

    Try
        oCurFile.SaveAs(oFolder & "\" & ShortName & (".stp") , True)
    Catch
        MessageBox.Show("Error processing " & oCurFileName, "ilogic")
    End Try
    oCurFile.Close
Next
'- - - - - - - - - - - - -
MessageBox.Show("New Files Created in: " & vbLf & oFolder, "iLogic")
)
```

#### Code Block 5

```vb
'check that the active document is an assembly file
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
    MessageBox.Show("This Rule " & iLogicVb.RuleName & " only works on Assembly Files.", "WRONG DOCUMENT TYPE", MessageBoxButtons.OK, MessageBoxIcon.Error)
    Return
End If

'define the active document as an assembly file
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oAsmName As String = ThisDoc.FileName(False) 'without extension


'get user input
Dim RUsure = MessageBox.Show(
"This will create a STEP file for all components." _
& vbLf & " " _
& vbLf & "Are you sure you want to create STEP Drawings for all of the assembly components?" _
& vbLf & "This could take a while.", "iLogic - Batch Output STEPs ", MessageBoxButtons.YesNo)
If RUsure = vbNo Then
    Return
Else
End If

'- - - - - - - - - - - - -STEP setup - - - - - - - - - - - -
Dim oPath = ThisDoc.Path
'get STEP target folder path
' original => oFolder = oPath & "\" & oAsmName & " STEP Files"
Dim oFolder = oPath & "\STEP Files"
'Check for the step folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
    System.IO.Directory.CreateDirectory(oFolder)
End If


'- - - - - - - - - - - - -Assembly - - - - - - - - - - - -
ThisDoc.Document.SaveAs(oFolder & "\" & oAsmName & (".stp"), True)

'- - - - - - - - - - - - -Components - - - - - - - - - - - -
'look at the files referenced by the assembly
Dim oRefDocs As DocumentsEnumerator = oAsmDoc.AllReferencedDocuments
'work the referenced models
For Each oRefDoc As Document In oRefDocs
    Dim oCurFile As Document = ThisApplication.Documents.Open(oRefDoc.FullFileName, True)
    Dim oCurFileName = oCurFile.FullFileName
    Dim ShortName = IO.Path.GetFileNameWithoutExtension(oCurFileName)

    Dim oPropSets As PropertySets = oCurFile.PropertySets
    Dim oPropSet As PropertySet = oPropSets.Item("Design Tracking Properties")
    Dim oPartNumiProp As [Property] = oPropSet.Item("Part Number")


    Try
        oCurFile.SaveAs(oFolder & "\" & oPartNumiProp.Value & (".stp"), True)
    Catch
        MessageBox.Show("Error processing " & oCurFileName, "ilogic")
    End Try
    oCurFile.Close()
Next
'- - - - - - - - - - - - -
MessageBox.Show("New Files Created in: " & vbLf & oFolder, "iLogic")
```

#### Code Block 6

```vb
'check that the active document is an assembly file
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
    MessageBox.Show("This Rule " & iLogicVb.RuleName & " only works on Assembly Files.", "WRONG DOCUMENT TYPE", MessageBoxButtons.OK, MessageBoxIcon.Error)
    Return
End If

'define the active document as an assembly file
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oAsmName As String = ThisDoc.FileName(False) 'without extension


'get user input
Dim RUsure = MessageBox.Show(
"This will create a STEP file for all components." _
& vbLf & " " _
& vbLf & "Are you sure you want to create STEP Drawings for all of the assembly components?" _
& vbLf & "This could take a while.", "iLogic - Batch Output STEPs ", MessageBoxButtons.YesNo)
If RUsure = vbNo Then
    Return
Else
End If

'- - - - - - - - - - - - -STEP setup - - - - - - - - - - - -
Dim oPath = ThisDoc.Path
'get STEP target folder path
' original => oFolder = oPath & "\" & oAsmName & " STEP Files"
Dim oFolder = oPath & "\STEP Files"
'Check for the step folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
    System.IO.Directory.CreateDirectory(oFolder)
End If


'- - - - - - - - - - - - -Assembly - - - - - - - - - - - -
ThisDoc.Document.SaveAs(oFolder & "\" & oAsmName & (".stp"), True)

'- - - - - - - - - - - - -Components - - - - - - - - - - - -
'look at the files referenced by the assembly
Dim oRefDocs As DocumentsEnumerator = oAsmDoc.AllReferencedDocuments
'work the referenced models
For Each oRefDoc As Document In oRefDocs
    Dim oCurFile As Document = ThisApplication.Documents.Open(oRefDoc.FullFileName, True)
    Dim oCurFileName = oCurFile.FullFileName
    Dim ShortName = IO.Path.GetFileNameWithoutExtension(oCurFileName)

    Dim oPropSets As PropertySets = oCurFile.PropertySets
    Dim oPropSet As PropertySet = oPropSets.Item("Design Tracking Properties")
    Dim oPartNumiProp As [Property] = oPropSet.Item("Part Number")


    Try
        oCurFile.SaveAs(oFolder & "\" & oPartNumiProp.Value & (".stp"), True)
    Catch
        MessageBox.Show("Error processing " & oCurFileName, "ilogic")
    End Try
    oCurFile.Close()
Next
'- - - - - - - - - - - - -
MessageBox.Show("New Files Created in: " & vbLf & oFolder, "iLogic")
```

#### Code Block 7

```vb
Dim oOccPDoc As PartDocument = oOcc.Definition.Document
```

#### Code Block 8

```vb
Dim oOccPDoc As PartDocument = oOcc.Definition.Document
```

#### Code Block 9

```vb
Dim oOccPDoc As PartDocument = oOcc.Definition.Document
```

#### Code Block 10

```vb
Dim oOccPDoc As PartDocument = oOcc.Definition.Document
```

#### Code Block 11

```vb
Dim oOccPDoc As PartDocument = oOcc.ReferencedDocumentDescriptor.ReferencedDocument
```

#### Code Block 12

```vb
Dim oOccPDoc As PartDocument = oOcc.ReferencedDocumentDescriptor.ReferencedDocument
```

#### Code Block 13

```vb
Dim oOccPDoc As PartDocument = oOcc.ReferencedDocumentDescriptor.ReferencedDocument
```

#### Code Block 14

```vb
Dim oOccPDoc As PartDocument = oOcc.ReferencedDocumentDescriptor.ReferencedDocument
```

#### Code Block 15

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MessageBox.Show("This rule only works on Assembly files.", "Wrong Document Type", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Return
End If
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument
```

#### Code Block 16

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MessageBox.Show("This rule only works on Assembly files.", "Wrong Document Type", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Return
End If
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument
```

#### Code Block 17

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MessageBox.Show("This rule only works on Assembly files.", "Wrong Document Type", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Return
End If
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument
```

#### Code Block 18

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MessageBox.Show("This rule only works on Assembly files.", "Wrong Document Type", MessageBoxButtons.OK, MessageBoxIcon.Error)
	Return
End If
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument
```

#### Code Block 19

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
	Exit Sub
End If
Dim oADoc As AssemblyDocument = ThisAssembly.Document
Dim oAsmName As String = System.IO.Path.GetFileNameWithoutExtension(oADoc.FullFileName)
'Dim oAsmPN As String = oADoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Dim oPath As String = System.IO.Path.GetDirectoryName(oADoc.FullFileName) & "\STEP Files\"
If Not System.IO.Directory.Exists(oPath) Then
	System.IO.Directory.CreateDirectory(oPath)
End If
oADoc.SaveAs(oPath & oAsmName & ".stp", True)
Dim oRefName, oRefPN As String
For Each oRefDoc As Document In oADoc.AllReferencedDocuments
	oRefDoc = ThisApplication.Documents.Open(oRefDoc.FullDocumentName, False)
	'oRefName = System.IO.Path.GetFileNameWithoutExtension(oRefDoc.FullFileName)
	oRefPN = oRefDoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
	Try
		'oRefDoc.SaveAs(oPath & oRefName & ".stp", True)
		oRefDoc.SaveAs(oPath & oRefPN & ".stp", True)
	Catch
		MsgBox("Failed to save '" & oRefDoc.FullFileName & " out as an STEP file.", vbOKOnly, " ")
	End Try
	oRefDoc.Close(True) 'True = Skip Save
Next
MsgBox("All new STEP files were saved to:" & vbCrLf & oPath, vbOKOnly,"FINISHED")
```

#### Code Block 20

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
	Exit Sub
End If
Dim oADoc As AssemblyDocument = ThisAssembly.Document
Dim oAsmName As String = System.IO.Path.GetFileNameWithoutExtension(oADoc.FullFileName)
'Dim oAsmPN As String = oADoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Dim oPath As String = System.IO.Path.GetDirectoryName(oADoc.FullFileName) & "\STEP Files\"
If Not System.IO.Directory.Exists(oPath) Then
	System.IO.Directory.CreateDirectory(oPath)
End If
oADoc.SaveAs(oPath & oAsmName & ".stp", True)
Dim oRefName, oRefPN As String
For Each oRefDoc As Document In oADoc.AllReferencedDocuments
	oRefDoc = ThisApplication.Documents.Open(oRefDoc.FullDocumentName, False)
	'oRefName = System.IO.Path.GetFileNameWithoutExtension(oRefDoc.FullFileName)
	oRefPN = oRefDoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
	Try
		'oRefDoc.SaveAs(oPath & oRefName & ".stp", True)
		oRefDoc.SaveAs(oPath & oRefPN & ".stp", True)
	Catch
		MsgBox("Failed to save '" & oRefDoc.FullFileName & " out as an STEP file.", vbOKOnly, " ")
	End Try
	oRefDoc.Close(True) 'True = Skip Save
Next
MsgBox("All new STEP files were saved to:" & vbCrLf & oPath, vbOKOnly,"FINISHED")
```

#### Code Block 21

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
	Exit Sub
End If
Dim oADoc As AssemblyDocument = ThisAssembly.Document
Dim oAsmName As String = System.IO.Path.GetFileNameWithoutExtension(oADoc.FullFileName)
'Dim oAsmPN As String = oADoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Dim oPath As String = System.IO.Path.GetDirectoryName(oADoc.FullFileName) & "\STEP Files\"
If Not System.IO.Directory.Exists(oPath) Then
	System.IO.Directory.CreateDirectory(oPath)
End If
oADoc.SaveAs(oPath & oAsmName & ".stp", True)
Dim oRefName, oRefPN As String
For Each oRefDoc As Document In oADoc.AllReferencedDocuments
	oRefDoc = ThisApplication.Documents.Open(oRefDoc.FullDocumentName, False)
	'oRefName = System.IO.Path.GetFileNameWithoutExtension(oRefDoc.FullFileName)
	oRefPN = oRefDoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
	Try
		'oRefDoc.SaveAs(oPath & oRefName & ".stp", True)
		oRefDoc.SaveAs(oPath & oRefPN & ".stp", True)
	Catch
		MsgBox("Failed to save '" & oRefDoc.FullFileName & " out as an STEP file.", vbOKOnly, " ")
	End Try
	oRefDoc.Close(True) 'True = Skip Save
Next
MsgBox("All new STEP files were saved to:" & vbCrLf & oPath, vbOKOnly,"FINISHED")
```

#### Code Block 22

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
	Exit Sub
End If
Dim oADoc As AssemblyDocument = ThisAssembly.Document
Dim oAsmName As String = System.IO.Path.GetFileNameWithoutExtension(oADoc.FullFileName)
'Dim oAsmPN As String = oADoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
Dim oPath As String = System.IO.Path.GetDirectoryName(oADoc.FullFileName) & "\STEP Files\"
If Not System.IO.Directory.Exists(oPath) Then
	System.IO.Directory.CreateDirectory(oPath)
End If
oADoc.SaveAs(oPath & oAsmName & ".stp", True)
Dim oRefName, oRefPN As String
For Each oRefDoc As Document In oADoc.AllReferencedDocuments
	oRefDoc = ThisApplication.Documents.Open(oRefDoc.FullDocumentName, False)
	'oRefName = System.IO.Path.GetFileNameWithoutExtension(oRefDoc.FullFileName)
	oRefPN = oRefDoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
	Try
		'oRefDoc.SaveAs(oPath & oRefName & ".stp", True)
		oRefDoc.SaveAs(oPath & oRefPN & ".stp", True)
	Catch
		MsgBox("Failed to save '" & oRefDoc.FullFileName & " out as an STEP file.", vbOKOnly, " ")
	End Try
	oRefDoc.Close(True) 'True = Skip Save
Next
MsgBox("All new STEP files were saved to:" & vbCrLf & oPath, vbOKOnly,"FINISHED")
```

#### Code Block 23

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("This rule only works on Assembly files.", vbCritical, "Wrong Document Type")
	Return
End If
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument
```

#### Code Block 24

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("This rule only works on Assembly files.", vbCritical, "Wrong Document Type")
	Return
End If
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument
```

#### Code Block 25

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("This rule only works on Assembly files.", vbCritical, "Wrong Document Type")
	Return
End If
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument
```

#### Code Block 26

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("This rule only works on Assembly files.", vbCritical, "Wrong Document Type")
	Return
End If
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument
```

#### Code Block 27

```vb
Sub Main
	If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
		MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
		Exit Sub
	End If
	Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
	oDirChar = System.IO.Path.DirectorySeparatorChar
	'define path to save STEP file to
	oPath = System.IO.Path.GetDirectoryName(oADoc.FullFileName) & oDirChar & "EXPORT_STEP" & oDirChar
	'make sure that path exists
	If Not System.IO.Directory.Exists(oPath) Then
		System.IO.Directory.CreateDirectory(oPath)
	End If
	'create a List to keep track of which ones we have already exported
	Dim oExportedDocs As List(Of String)
	'loop through the components in this assembly
	For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
		'if it's not a part, skip to next component
		If oOcc.DefinitionDocumentType <> DocumentTypeEnum.kPartDocumentObject Then Continue For
		'get the document this component is representing
		Dim oOccPDoc As PartDocument = oOcc.Definition.Document
		'if this document is already in our list, we've already saved it out, so skip to next component
		If oExportedDocs.Contains(oOccPDoc.FullFileName) Then Continue For
		'get the file name (without path or extension) 
		oName = System.IO.Path.GetFileNameWithoutExtension(oOccPDoc.FullFileName)
		'combine path, name, & new extension
		oNewName = oPath & oName & ".stp"
		'Check to see if the STEP file already exists, if it does, ask if you want to overwrite it or not.
		If System.IO.File.Exists(oNewName) Then
			oAns = MsgBox("A STEP file with this name already exists." & vbCrLf & _
			"Do you want to overwrite it with this new one?", vbYesNo + vbQuestion + vbDefaultButton2, "FILE ALREADY EXISTS")
			If oAns = vbNo Then Continue For
		End If
		Try
			'save it out as STEP file
			oOccPDoc.SaveAs(oNewName, True)
			'add this document's full file name to our list
			oExportedDocs.Add(oOccPDoc.FullFileName)
		Catch oEx As Exception
			MsgBox("Failed to save '" & oOccPDoc.FullFileName & " out as a STEP file." & vbCrLf & _
			oEx.Message & vbCrLf & oEx.StackTrace, vbExclamation, "iLogic")
		End Try
	Next
	MsgBox("Finished saving files to STEP format.", vbInformation, "iLogic")
End Sub
```

#### Code Block 28

```vb
Sub Main
	If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
		MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
		Exit Sub
	End If
	Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
	oDirChar = System.IO.Path.DirectorySeparatorChar
	'define path to save STEP file to
	oPath = System.IO.Path.GetDirectoryName(oADoc.FullFileName) & oDirChar & "EXPORT_STEP" & oDirChar
	'make sure that path exists
	If Not System.IO.Directory.Exists(oPath) Then
		System.IO.Directory.CreateDirectory(oPath)
	End If
	'create a List to keep track of which ones we have already exported
	Dim oExportedDocs As List(Of String)
	'loop through the components in this assembly
	For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
		'if it's not a part, skip to next component
		If oOcc.DefinitionDocumentType <> DocumentTypeEnum.kPartDocumentObject Then Continue For
		'get the document this component is representing
		Dim oOccPDoc As PartDocument = oOcc.Definition.Document
		'if this document is already in our list, we've already saved it out, so skip to next component
		If oExportedDocs.Contains(oOccPDoc.FullFileName) Then Continue For
		'get the file name (without path or extension) 
		oName = System.IO.Path.GetFileNameWithoutExtension(oOccPDoc.FullFileName)
		'combine path, name, & new extension
		oNewName = oPath & oName & ".stp"
		'Check to see if the STEP file already exists, if it does, ask if you want to overwrite it or not.
		If System.IO.File.Exists(oNewName) Then
			oAns = MsgBox("A STEP file with this name already exists." & vbCrLf & _
			"Do you want to overwrite it with this new one?", vbYesNo + vbQuestion + vbDefaultButton2, "FILE ALREADY EXISTS")
			If oAns = vbNo Then Continue For
		End If
		Try
			'save it out as STEP file
			oOccPDoc.SaveAs(oNewName, True)
			'add this document's full file name to our list
			oExportedDocs.Add(oOccPDoc.FullFileName)
		Catch oEx As Exception
			MsgBox("Failed to save '" & oOccPDoc.FullFileName & " out as a STEP file." & vbCrLf & _
			oEx.Message & vbCrLf & oEx.StackTrace, vbExclamation, "iLogic")
		End Try
	Next
	MsgBox("Finished saving files to STEP format.", vbInformation, "iLogic")
End Sub
```

#### Code Block 29

```vb
Sub Main
	If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
		MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
		Exit Sub
	End If
	Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
	oDirChar = System.IO.Path.DirectorySeparatorChar
	'define path to save STEP file to
	oPath = System.IO.Path.GetDirectoryName(oADoc.FullFileName) & oDirChar & "EXPORT_STEP" & oDirChar
	'make sure that path exists
	If Not System.IO.Directory.Exists(oPath) Then
		System.IO.Directory.CreateDirectory(oPath)
	End If
	'create a List to keep track of which ones we have already exported
	Dim oExportedDocs As List(Of String)
	'loop through the components in this assembly
	For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
		'if it's not a part, skip to next component
		If oOcc.DefinitionDocumentType <> DocumentTypeEnum.kPartDocumentObject Then Continue For
		'get the document this component is representing
		Dim oOccPDoc As PartDocument = oOcc.Definition.Document
		'if this document is already in our list, we've already saved it out, so skip to next component
		If oExportedDocs.Contains(oOccPDoc.FullFileName) Then Continue For
		'get the file name (without path or extension) 
		oName = System.IO.Path.GetFileNameWithoutExtension(oOccPDoc.FullFileName)
		'combine path, name, & new extension
		oNewName = oPath & oName & ".stp"
		'Check to see if the STEP file already exists, if it does, ask if you want to overwrite it or not.
		If System.IO.File.Exists(oNewName) Then
			oAns = MsgBox("A STEP file with this name already exists." & vbCrLf & _
			"Do you want to overwrite it with this new one?", vbYesNo + vbQuestion + vbDefaultButton2, "FILE ALREADY EXISTS")
			If oAns = vbNo Then Continue For
		End If
		Try
			'save it out as STEP file
			oOccPDoc.SaveAs(oNewName, True)
			'add this document's full file name to our list
			oExportedDocs.Add(oOccPDoc.FullFileName)
		Catch oEx As Exception
			MsgBox("Failed to save '" & oOccPDoc.FullFileName & " out as a STEP file." & vbCrLf & _
			oEx.Message & vbCrLf & oEx.StackTrace, vbExclamation, "iLogic")
		End Try
	Next
	MsgBox("Finished saving files to STEP format.", vbInformation, "iLogic")
End Sub
```

#### Code Block 30

```vb
Sub Main
	If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
		MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
		Exit Sub
	End If
	Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
	oDirChar = System.IO.Path.DirectorySeparatorChar
	'define path to save STEP file to
	oPath = System.IO.Path.GetDirectoryName(oADoc.FullFileName) & oDirChar & "EXPORT_STEP" & oDirChar
	'make sure that path exists
	If Not System.IO.Directory.Exists(oPath) Then
		System.IO.Directory.CreateDirectory(oPath)
	End If
	'create a List to keep track of which ones we have already exported
	Dim oExportedDocs As List(Of String)
	'loop through the components in this assembly
	For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
		'if it's not a part, skip to next component
		If oOcc.DefinitionDocumentType <> DocumentTypeEnum.kPartDocumentObject Then Continue For
		'get the document this component is representing
		Dim oOccPDoc As PartDocument = oOcc.Definition.Document
		'if this document is already in our list, we've already saved it out, so skip to next component
		If oExportedDocs.Contains(oOccPDoc.FullFileName) Then Continue For
		'get the file name (without path or extension) 
		oName = System.IO.Path.GetFileNameWithoutExtension(oOccPDoc.FullFileName)
		'combine path, name, & new extension
		oNewName = oPath & oName & ".stp"
		'Check to see if the STEP file already exists, if it does, ask if you want to overwrite it or not.
		If System.IO.File.Exists(oNewName) Then
			oAns = MsgBox("A STEP file with this name already exists." & vbCrLf & _
			"Do you want to overwrite it with this new one?", vbYesNo + vbQuestion + vbDefaultButton2, "FILE ALREADY EXISTS")
			If oAns = vbNo Then Continue For
		End If
		Try
			'save it out as STEP file
			oOccPDoc.SaveAs(oNewName, True)
			'add this document's full file name to our list
			oExportedDocs.Add(oOccPDoc.FullFileName)
		Catch oEx As Exception
			MsgBox("Failed to save '" & oOccPDoc.FullFileName & " out as a STEP file." & vbCrLf & _
			oEx.Message & vbCrLf & oEx.StackTrace, vbExclamation, "iLogic")
		End Try
	Next
	MsgBox("Finished saving files to STEP format.", vbInformation, "iLogic")
End Sub
```

#### Code Block 31

```vb
Sub Main
	If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
		MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
		Exit Sub
	End If
	Dim oADoc As AssemblyDocument = ThisAssembly.Document
	'save the 'active' assembly as a STEP file, using our Sub below
	SaveAsSTEP(oADoc)
	'create a List to keep track of which ones we have already exported
	'so we don't export the same document more than once
	Dim oExportedDocs As List(Of String)
	'this will process all parts & sub-assemlies in all levels of the main assembly
	StepDown(oADoc.ComponentDefinition.Occurrences, oExportedDocs)
	MsgBox("Finished saving files to STEP format.", vbInformation, "")
End Sub

Sub StepDown(oComps As ComponentOccurrences, oList As List(Of String))
	'this will process all parts & sub-assemlies in (top level only) of main assembly
	For Each oComp As ComponentOccurrence In oComps
		Dim oCompDoc As Document = oComp.Definition.Document
		If Not oList.Contains(oCompDoc.FullFileName) Then
			'save this component document as a STEP file, using our Sub below
			SaveAsSTEP(oCompDoc)
			'add the full file name of that document to the list
			oList.Add(oCompDoc.FullFileName)
		End If
		If TypeOf oComp.Definition Is AssemblyComponentDefinition Then
			StepDown(oComp.Definition.Occurrences, oList)
		End If
	Next
End Sub

Sub SaveAsSTEP(oDoc As Document)
	oDirChar = System.IO.Path.DirectorySeparatorChar
	oPath = System.IO.Path.GetDirectoryName(oDoc.FullFileName) & oDirChar & "STEP Files" & oDirChar
	If Not System.IO.Directory.Exists(oPath) Then System.IO.Directory.CreateDirectory(oPath)
	Dim oPN As String = oDoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
	oNewName = oPath & oPN & ".stp"
	'Check to see if the STEP file already exists, if it does, ask if you want to overwrite it or not.
	If System.IO.File.Exists(oNewName) Then
		oAns = MsgBox("A STEP file with this name already exists." & vbCrLf & _
		"Do you want to overwrite it with this new one?",vbYesNo + vbQuestion + vbDefaultButton2, "FILE ALREADY EXISTS")
		If oAns = vbNo Then Exit Sub
	End If
	Try
		oDoc.SaveAs(oNewName, True)
	Catch
		MsgBox("Failed to save '" & oDoc.FullFileName & " out as a STEP file.", , "")
	End Try
End Sub
```

#### Code Block 32

```vb
Sub Main
	If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
		MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
		Exit Sub
	End If
	Dim oADoc As AssemblyDocument = ThisAssembly.Document
	'save the 'active' assembly as a STEP file, using our Sub below
	SaveAsSTEP(oADoc)
	'create a List to keep track of which ones we have already exported
	'so we don't export the same document more than once
	Dim oExportedDocs As List(Of String)
	'this will process all parts & sub-assemlies in all levels of the main assembly
	StepDown(oADoc.ComponentDefinition.Occurrences, oExportedDocs)
	MsgBox("Finished saving files to STEP format.", vbInformation, "")
End Sub

Sub StepDown(oComps As ComponentOccurrences, oList As List(Of String))
	'this will process all parts & sub-assemlies in (top level only) of main assembly
	For Each oComp As ComponentOccurrence In oComps
		Dim oCompDoc As Document = oComp.Definition.Document
		If Not oList.Contains(oCompDoc.FullFileName) Then
			'save this component document as a STEP file, using our Sub below
			SaveAsSTEP(oCompDoc)
			'add the full file name of that document to the list
			oList.Add(oCompDoc.FullFileName)
		End If
		If TypeOf oComp.Definition Is AssemblyComponentDefinition Then
			StepDown(oComp.Definition.Occurrences, oList)
		End If
	Next
End Sub

Sub SaveAsSTEP(oDoc As Document)
	oDirChar = System.IO.Path.DirectorySeparatorChar
	oPath = System.IO.Path.GetDirectoryName(oDoc.FullFileName) & oDirChar & "STEP Files" & oDirChar
	If Not System.IO.Directory.Exists(oPath) Then System.IO.Directory.CreateDirectory(oPath)
	Dim oPN As String = oDoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
	oNewName = oPath & oPN & ".stp"
	'Check to see if the STEP file already exists, if it does, ask if you want to overwrite it or not.
	If System.IO.File.Exists(oNewName) Then
		oAns = MsgBox("A STEP file with this name already exists." & vbCrLf & _
		"Do you want to overwrite it with this new one?",vbYesNo + vbQuestion + vbDefaultButton2, "FILE ALREADY EXISTS")
		If oAns = vbNo Then Exit Sub
	End If
	Try
		oDoc.SaveAs(oNewName, True)
	Catch
		MsgBox("Failed to save '" & oDoc.FullFileName & " out as a STEP file.", , "")
	End Try
End Sub
```

#### Code Block 33

```vb
Sub Main
	If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
		MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
		Exit Sub
	End If
	Dim oADoc As AssemblyDocument = ThisAssembly.Document
	'save the 'active' assembly as a STEP file, using our Sub below
	SaveAsSTEP(oADoc)
	'create a List to keep track of which ones we have already exported
	'so we don't export the same document more than once
	Dim oExportedDocs As List(Of String)
	'this will process all parts & sub-assemlies in all levels of the main assembly
	StepDown(oADoc.ComponentDefinition.Occurrences, oExportedDocs)
	MsgBox("Finished saving files to STEP format.", vbInformation, "")
End Sub

Sub StepDown(oComps As ComponentOccurrences, oList As List(Of String))
	'this will process all parts & sub-assemlies in (top level only) of main assembly
	For Each oComp As ComponentOccurrence In oComps
		Dim oCompDoc As Document = oComp.Definition.Document
		If Not oList.Contains(oCompDoc.FullFileName) Then
			'save this component document as a STEP file, using our Sub below
			SaveAsSTEP(oCompDoc)
			'add the full file name of that document to the list
			oList.Add(oCompDoc.FullFileName)
		End If
		If TypeOf oComp.Definition Is AssemblyComponentDefinition Then
			StepDown(oComp.Definition.Occurrences, oList)
		End If
	Next
End Sub

Sub SaveAsSTEP(oDoc As Document)
	oDirChar = System.IO.Path.DirectorySeparatorChar
	oPath = System.IO.Path.GetDirectoryName(oDoc.FullFileName) & oDirChar & "STEP Files" & oDirChar
	If Not System.IO.Directory.Exists(oPath) Then System.IO.Directory.CreateDirectory(oPath)
	Dim oPN As String = oDoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
	oNewName = oPath & oPN & ".stp"
	'Check to see if the STEP file already exists, if it does, ask if you want to overwrite it or not.
	If System.IO.File.Exists(oNewName) Then
		oAns = MsgBox("A STEP file with this name already exists." & vbCrLf & _
		"Do you want to overwrite it with this new one?",vbYesNo + vbQuestion + vbDefaultButton2, "FILE ALREADY EXISTS")
		If oAns = vbNo Then Exit Sub
	End If
	Try
		oDoc.SaveAs(oNewName, True)
	Catch
		MsgBox("Failed to save '" & oDoc.FullFileName & " out as a STEP file.", , "")
	End Try
End Sub
```

#### Code Block 34

```vb
Sub Main
	If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
		MsgBox("An Assembly Document must be active for this rule to work. Exiting.",vbOKOnly+vbCritical, "WRONG DOCUMENT TYPE")
		Exit Sub
	End If
	Dim oADoc As AssemblyDocument = ThisAssembly.Document
	'save the 'active' assembly as a STEP file, using our Sub below
	SaveAsSTEP(oADoc)
	'create a List to keep track of which ones we have already exported
	'so we don't export the same document more than once
	Dim oExportedDocs As List(Of String)
	'this will process all parts & sub-assemlies in all levels of the main assembly
	StepDown(oADoc.ComponentDefinition.Occurrences, oExportedDocs)
	MsgBox("Finished saving files to STEP format.", vbInformation, "")
End Sub

Sub StepDown(oComps As ComponentOccurrences, oList As List(Of String))
	'this will process all parts & sub-assemlies in (top level only) of main assembly
	For Each oComp As ComponentOccurrence In oComps
		Dim oCompDoc As Document = oComp.Definition.Document
		If Not oList.Contains(oCompDoc.FullFileName) Then
			'save this component document as a STEP file, using our Sub below
			SaveAsSTEP(oCompDoc)
			'add the full file name of that document to the list
			oList.Add(oCompDoc.FullFileName)
		End If
		If TypeOf oComp.Definition Is AssemblyComponentDefinition Then
			StepDown(oComp.Definition.Occurrences, oList)
		End If
	Next
End Sub

Sub SaveAsSTEP(oDoc As Document)
	oDirChar = System.IO.Path.DirectorySeparatorChar
	oPath = System.IO.Path.GetDirectoryName(oDoc.FullFileName) & oDirChar & "STEP Files" & oDirChar
	If Not System.IO.Directory.Exists(oPath) Then System.IO.Directory.CreateDirectory(oPath)
	Dim oPN As String = oDoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value
	oNewName = oPath & oPN & ".stp"
	'Check to see if the STEP file already exists, if it does, ask if you want to overwrite it or not.
	If System.IO.File.Exists(oNewName) Then
		oAns = MsgBox("A STEP file with this name already exists." & vbCrLf & _
		"Do you want to overwrite it with this new one?",vbYesNo + vbQuestion + vbDefaultButton2, "FILE ALREADY EXISTS")
		If oAns = vbNo Then Exit Sub
	End If
	Try
		oDoc.SaveAs(oNewName, True)
	Catch
		MsgBox("Failed to save '" & oDoc.FullFileName & " out as a STEP file.", , "")
	End Try
End Sub
```

---

### 56. Export an Assembly using ilogic to designated excel template tabs

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/export-an-assembly-using-ilogic-to-designated-excel-template/td-p/13745058](https://forums.autodesk.com/t5/inventor-programming-forum/export-an-assembly-using-ilogic-to-designated-excel-template/td-p/13745058)

**Author:** mtoddHBKNF

**Date:** ‎07-29-2025
	
		
		11:09 AM

**Description:** Hi There,Once again I need some help. So I been trying to export a BOM from an assembly. I found quiet a few very helpful codes, but I need some extra tweaks.  I am attaching a file that explains the final look if possible, of course. (item 3 is a plus, but I can work around it) Requirements:1) Thum...

**Code Snippets (3):**

#### Code Block 1

```vb
'BOM Publisher
oDoc = ThisDoc.ModelDocument
If oDoc.DocumentType = kPartDocumentObject Then
MessageBox.Show("You need to be in an Assembly to Export a BOM", "Databar: iLogic - BOM Publisher")
Return
End If
oDoc = ThisApplication.ActiveDocument
Dim oBOM As BOM
oBOM = oDoc.ComponentDefinition.BOM
'Options.Value("Author") = iProperties.Value("Summary", "Author")
'==========================================================================================
'You can change the output path by editing oPATH below
oPATH = ("c:\temp\") 'If you change this, remember to keep a \ at the end
'==========================================================================================
'STRUCTURED BoM ===========================================================================
' the structured view to 'all levels'
'oBOM.StructuredViewFirstLevelOnly = False

'
'==========================================================================================
'PARTS ONLY BoM ===========================================================================
' Make sure that the parts only view Is enabled.
oBOM.PartsOnlyViewEnabled = True
Dim oPartsOnlyBOMView As BOMView
oPartsOnlyBOMView = oBOM.BOMViews.Item("Parts Only")
' Export the BOM view to an Excel file
'oPartsOnlyBOMView.Export (oPATH + "BOM3.xls", kMicrosoftExcelFormat)
oPartsOnlyBOMView.Export (oPATH + ThisDoc.FileName(False) + " BOM" + ".xls", kMicrosoftExcelFormat, "PARTS ONLY")
'==========================================================================================
i = MessageBox.Show("Preview the BOM?", "Databar: iLogic - BOM Publisher",MessageBoxButtons.YesNo)
If i = vbYes Then : launchviewer = 1 : Else : launchviewer = 0 : End If
If launchviewer = 1 Then ThisDoc.Launch(oPATH + ThisDoc.FileName(False) + " BOM" + ".xls")
```

#### Code Block 2

```vb
'BOM Publisher
oDoc = ThisDoc.ModelDocument
If oDoc.DocumentType = kPartDocumentObject Then
MessageBox.Show("You need to be in an Assembly to Export a BOM", "Databar: iLogic - BOM Publisher")
Return
End If
oDoc = ThisApplication.ActiveDocument
Dim oBOM As BOM
oBOM = oDoc.ComponentDefinition.BOM
'Options.Value("Author") = iProperties.Value("Summary", "Author")
'==========================================================================================
'You can change the output path by editing oPATH below
oPATH = ("c:\temp\") 'If you change this, remember to keep a \ at the end
'==========================================================================================
'STRUCTURED BoM ===========================================================================
' the structured view to 'all levels'
'oBOM.StructuredViewFirstLevelOnly = False

'
'==========================================================================================
'PARTS ONLY BoM ===========================================================================
' Make sure that the parts only view Is enabled.
oBOM.PartsOnlyViewEnabled = True
Dim oPartsOnlyBOMView As BOMView
oPartsOnlyBOMView = oBOM.BOMViews.Item("Parts Only")
' Export the BOM view to an Excel file
'oPartsOnlyBOMView.Export (oPATH + "BOM3.xls", kMicrosoftExcelFormat)
oPartsOnlyBOMView.Export (oPATH + ThisDoc.FileName(False) + " BOM" + ".xls", kMicrosoftExcelFormat, "PARTS ONLY")
'==========================================================================================
i = MessageBox.Show("Preview the BOM?", "Databar: iLogic - BOM Publisher",MessageBoxButtons.YesNo)
If i = vbYes Then : launchviewer = 1 : Else : launchviewer = 0 : End If
If launchviewer = 1 Then ThisDoc.Launch(oPATH + ThisDoc.FileName(False) + " BOM" + ".xls")
```

#### Code Block 3

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports Microsoft.Office.Interop
Imports Microsoft.Office.Interop.Excel
```

#### Code Block 4

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports Microsoft.Office.Interop
Imports Microsoft.Office.Interop.Excel
```

#### Code Block 5

```vb
oPartsOnlyBOMView.Export(oPATH + ThisDoc.FileName(False) + " BOM" + ".xlsx", kMicrosoftExcelFormat, "PARTS ONLY")
oBOM.BOMViews.Item("Structured").Export(oPATH + ThisDoc.FileName(False) + " BOM Structured" + ".xlsx", kMicrosoftExcelFormat, "PARTS ONLY")
'==========================================================================================
'i = MessageBox.Show("Preview the BOM?", "Databar: iLogic - BOM Publisher",MessageBoxButtons.YesNo)
'If i = vbYes Then : launchviewer = 1 : Else : launchviewer = 0 : End If
'If launchviewer = 1 Then ThisDoc.Launch(oPATH + ThisDoc.FileName(False) + " BOM" + ".xls")

'excel
Dim excelApp As Excel.Application = Nothing
Dim excelWorkbook As Excel.Workbook = Nothing
Dim excelWorkbook2 As Excel.Workbook = Nothing
Dim excelWorksheet As Excel.Worksheet = Nothing
Dim excelWorksheet2 As Excel.Worksheet = Nothing

excelApp = New Excel.Application()
excelApp.Visible = False
excelWorkbook = excelApp.Workbooks.Add("C:\Temp\template.xlsx")

'parts only
excelWorkbook2 = excelApp.Workbooks.Open(oPATH + ThisDoc.FileName(False) + " BOM" + ".xlsx")
excelWorksheet2 = excelWorkbook2.Worksheets(1)
For Each oShape As Excel.Shape In excelWorksheet2.Shapes
	oShape.Select
	oShape.PlacePictureInCell
Next
excelWorksheet2.UsedRange.Copy

excelWorkbook.Worksheets("PARTS ONLY").Range("A3").PasteSpecial
excelApp.CutCopyMode = False
excelWorkbook2.Close(False)
'structured
excelWorkbook2 = excelApp.Workbooks.Open(oPATH + ThisDoc.FileName(False) + " BOM Structured" + ".xlsx")
excelWorksheet2 = excelWorkbook2.Worksheets(1)
For Each oShape As Excel.Shape In excelWorksheet2.Shapes
	oShape.Select
	oShape.PlacePictureInCell
Next
excelWorksheet2.UsedRange.Copy

excelWorkbook.Worksheets("Structured").Range("A3").PasteSpecial
excelApp.CutCopyMode = False
excelWorkbook2.Close(False)

excelApp.Visible = True
excelWorkbook.SaveAs(oPATH & oDoc.PropertySets(3)("Part Number").Value & " " & Strings.Replace(System.DateTime.Now.ToString("d"), "/", "-") & ".xlsx")
```

#### Code Block 6

```vb
oPartsOnlyBOMView.Export(oPATH + ThisDoc.FileName(False) + " BOM" + ".xlsx", kMicrosoftExcelFormat, "PARTS ONLY")
oBOM.BOMViews.Item("Structured").Export(oPATH + ThisDoc.FileName(False) + " BOM Structured" + ".xlsx", kMicrosoftExcelFormat, "PARTS ONLY")
'==========================================================================================
'i = MessageBox.Show("Preview the BOM?", "Databar: iLogic - BOM Publisher",MessageBoxButtons.YesNo)
'If i = vbYes Then : launchviewer = 1 : Else : launchviewer = 0 : End If
'If launchviewer = 1 Then ThisDoc.Launch(oPATH + ThisDoc.FileName(False) + " BOM" + ".xls")

'excel
Dim excelApp As Excel.Application = Nothing
Dim excelWorkbook As Excel.Workbook = Nothing
Dim excelWorkbook2 As Excel.Workbook = Nothing
Dim excelWorksheet As Excel.Worksheet = Nothing
Dim excelWorksheet2 As Excel.Worksheet = Nothing

excelApp = New Excel.Application()
excelApp.Visible = False
excelWorkbook = excelApp.Workbooks.Add("C:\Temp\template.xlsx")

'parts only
excelWorkbook2 = excelApp.Workbooks.Open(oPATH + ThisDoc.FileName(False) + " BOM" + ".xlsx")
excelWorksheet2 = excelWorkbook2.Worksheets(1)
For Each oShape As Excel.Shape In excelWorksheet2.Shapes
	oShape.Select
	oShape.PlacePictureInCell
Next
excelWorksheet2.UsedRange.Copy

excelWorkbook.Worksheets("PARTS ONLY").Range("A3").PasteSpecial
excelApp.CutCopyMode = False
excelWorkbook2.Close(False)
'structured
excelWorkbook2 = excelApp.Workbooks.Open(oPATH + ThisDoc.FileName(False) + " BOM Structured" + ".xlsx")
excelWorksheet2 = excelWorkbook2.Worksheets(1)
For Each oShape As Excel.Shape In excelWorksheet2.Shapes
	oShape.Select
	oShape.PlacePictureInCell
Next
excelWorksheet2.UsedRange.Copy

excelWorkbook.Worksheets("Structured").Range("A3").PasteSpecial
excelApp.CutCopyMode = False
excelWorkbook2.Close(False)

excelApp.Visible = True
excelWorkbook.SaveAs(oPATH & oDoc.PropertySets(3)("Part Number").Value & " " & Strings.Replace(System.DateTime.Now.ToString("d"), "/", "-") & ".xlsx")
```

---

### 57. External rule to run first local form of a part / assembly / drawing

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/external-rule-to-run-first-local-form-of-a-part-assembly-drawing/td-p/13767020#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/external-rule-to-run-first-local-form-of-a-part-assembly-drawing/td-p/13767020#messageview_0)

**Author:** Kay_Rethmeier

**Date:** ‎08-14-2025
	
		
		12:45 AM

**Description:** Hi, I would love to have an external rule, which would start the first local form of an opened document independent of it's naming. If there is no form nothing should happen or maybe a hint, that the current document does not provide a local form.  So far I created this external rule with a list of ...

**Code Snippets (12):**

#### Code Block 1

```vb
Dim PossibleFormNames As New ArrayList				' list with all possible names
PossibleFormNames.Add("GO")
PossibleFormNames.Add("Values")
PossibleFormNames.Add("WebInput")					' Customer 1
PossibleFormNames.Add("Formular 1")					' Customer 2
PossibleFormNames.Add("FactoryDesignProperties")	' Factory 
PossibleFormNames.Add("DrawingControl")
PossibleFormNames.Add("nn")

Check = 0														' for debugging

For Each FormName In PossibleFormNames							' running through list
	Try
		If Check > 0 Then MsgBox("Try show form " & FormName)	' debugging
		iLogicForm.Show(FormName)								' try opening the form
		Exit Sub 												' if successful, leaving this rule
	Catch : End Try
Next

' feedback, in case of no form
MessageBox.Show("Document doesn't provide a local form.", "No Form available")
```

#### Code Block 2

```vb
Dim PossibleFormNames As New ArrayList				' list with all possible names
PossibleFormNames.Add("GO")
PossibleFormNames.Add("Values")
PossibleFormNames.Add("WebInput")					' Customer 1
PossibleFormNames.Add("Formular 1")					' Customer 2
PossibleFormNames.Add("FactoryDesignProperties")	' Factory 
PossibleFormNames.Add("DrawingControl")
PossibleFormNames.Add("nn")

Check = 0														' for debugging

For Each FormName In PossibleFormNames							' running through list
	Try
		If Check > 0 Then MsgBox("Try show form " & FormName)	' debugging
		iLogicForm.Show(FormName)								' try opening the form
		Exit Sub 												' if successful, leaving this rule
	Catch : End Try
Next

' feedback, in case of no form
MessageBox.Show("Document doesn't provide a local form.", "No Form available")
```

#### Code Block 3

```vb
Dim PossibleFormNames As New ArrayList				' list with all possible names
PossibleFormNames.Add("GO")
PossibleFormNames.Add("Values")
PossibleFormNames.Add("WebInput")					' Customer 1
PossibleFormNames.Add("Formular 1")					' Customer 2
PossibleFormNames.Add("FactoryDesignProperties")	' Factory 
PossibleFormNames.Add("DrawingControl")
PossibleFormNames.Add("nn")

Check = 0														' for debugging

For Each FormName In PossibleFormNames							' running through list
	Try
		If Check > 0 Then MsgBox("Try show form " & FormName)	' debugging
		iLogicForm.Show(FormName)								' try opening the form
		Exit Sub 												' if successful, leaving this rule
	Catch : End Try
Next

' feedback, in case of no form
MessageBox.Show("Document doesn't provide a local form.", "No Form available")
```

#### Code Block 4

```vb
Dim PossibleFormNames As New ArrayList				' list with all possible names
PossibleFormNames.Add("GO")
PossibleFormNames.Add("Values")
PossibleFormNames.Add("WebInput")					' Customer 1
PossibleFormNames.Add("Formular 1")					' Customer 2
PossibleFormNames.Add("FactoryDesignProperties")	' Factory 
PossibleFormNames.Add("DrawingControl")
PossibleFormNames.Add("nn")

Check = 0														' for debugging

For Each FormName In PossibleFormNames							' running through list
	Try
		If Check > 0 Then MsgBox("Try show form " & FormName)	' debugging
		iLogicForm.Show(FormName)								' try opening the form
		Exit Sub 												' if successful, leaving this rule
	Catch : End Try
Next

' feedback, in case of no form
MessageBox.Show("Document doesn't provide a local form.", "No Form available")
```

#### Code Block 5

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
Dim oDoc As Document = ThisApplication.ActiveDocument
If oLocalFormNames.Count = 0 Then MessageBox.Show("'" & oDoc.DisplayName & "' doesn't provide a local form.", "No form available")
If oLocalFormNames.Count = 1 Then iLogicForm.Show(oLocalFormNames.First())
If oLocalFormNames.Count > 1 Then
	sSel = InputListBox("if nothing is selected the first form will be selected", iLogicForm.FormNames, iLogicForm.FormNames.First, "Choose Form", "Available Forms")
	iLogicForm.Show(sSel)
End If
```

#### Code Block 6

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
Dim oDoc As Document = ThisApplication.ActiveDocument
If oLocalFormNames.Count = 0 Then MessageBox.Show("'" & oDoc.DisplayName & "' doesn't provide a local form.", "No form available")
If oLocalFormNames.Count = 1 Then iLogicForm.Show(oLocalFormNames.First())
If oLocalFormNames.Count > 1 Then
	sSel = InputListBox("if nothing is selected the first form will be selected", iLogicForm.FormNames, iLogicForm.FormNames.First, "Choose Form", "Available Forms")
	iLogicForm.Show(sSel)
End If
```

#### Code Block 7

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
Dim oDoc As Document = ThisApplication.ActiveDocument
If oLocalFormNames.Count = 0 Then MessageBox.Show("'" & oDoc.DisplayName & "' doesn't provide a local form.", "No form available")
If oLocalFormNames.Count = 1 Then iLogicForm.Show(oLocalFormNames.First())
If oLocalFormNames.Count > 1 Then
	sSel = InputListBox("if nothing is selected the first form will be selected", iLogicForm.FormNames, iLogicForm.FormNames.First, "Choose Form", "Available Forms")
	iLogicForm.Show(sSel)
End If
```

#### Code Block 8

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
Dim oDoc As Document = ThisApplication.ActiveDocument
If oLocalFormNames.Count = 0 Then MessageBox.Show("'" & oDoc.DisplayName & "' doesn't provide a local form.", "No form available")
If oLocalFormNames.Count = 1 Then iLogicForm.Show(oLocalFormNames.First())
If oLocalFormNames.Count > 1 Then
	sSel = InputListBox("if nothing is selected the first form will be selected", iLogicForm.FormNames, iLogicForm.FormNames.First, "Choose Form", "Available Forms")
	iLogicForm.Show(sSel)
End If
```

#### Code Block 9

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
If oLocalFormNames IsNot Nothing AndAlso oLocalFormNames.Any() Then
	iLogicForm.Show(oLocalFormNames.First())
End If
```

#### Code Block 10

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
If oLocalFormNames IsNot Nothing AndAlso oLocalFormNames.Any() Then
	iLogicForm.Show(oLocalFormNames.First())
End If
```

#### Code Block 11

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
If oLocalFormNames IsNot Nothing AndAlso oLocalFormNames.Any() Then
	iLogicForm.Show(oLocalFormNames.First())
End If
```

#### Code Block 12

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
If oLocalFormNames IsNot Nothing AndAlso oLocalFormNames.Any() Then
	iLogicForm.Show(oLocalFormNames.First())
End If
```

#### Code Block 13

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
If oLocalFormNames.Count = 0 Then MessageBox.Show("Document doesn't provide a local form.", "No form available")
If oLocalFormNames.Count = 1 Then iLogicForm.Show(oLocalFormNames.First())
If oLocalFormNames.Count > 1 Then
	Dim oAllFormNames As New ArrayList
	For Each Name In iLogicForm.FormNames
		oAllFormNames.Add(Name)
	Next
	sSel = InputListBox("if nothing is selected the first form will be selected", oAllFormNames, (1), "Choose Form", "Available Forms")
	If sSel = "" Then
		iLogicForm.Show(oLocalFormNames.First())
	Else
		iLogicForm.Show(sSel)
	End If
End If
```

#### Code Block 14

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
If oLocalFormNames.Count = 0 Then MessageBox.Show("Document doesn't provide a local form.", "No form available")
If oLocalFormNames.Count = 1 Then iLogicForm.Show(oLocalFormNames.First())
If oLocalFormNames.Count > 1 Then
	Dim oAllFormNames As New ArrayList
	For Each Name In iLogicForm.FormNames
		oAllFormNames.Add(Name)
	Next
	sSel = InputListBox("if nothing is selected the first form will be selected", oAllFormNames, (1), "Choose Form", "Available Forms")
	If sSel = "" Then
		iLogicForm.Show(oLocalFormNames.First())
	Else
		iLogicForm.Show(sSel)
	End If
End If
```

#### Code Block 15

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
If oLocalFormNames.Count = 0 Then MessageBox.Show("Document doesn't provide a local form.", "No form available")
If oLocalFormNames.Count = 1 Then iLogicForm.Show(oLocalFormNames.First())
If oLocalFormNames.Count > 1 Then
	Dim oAllFormNames As New ArrayList
	For Each Name In iLogicForm.FormNames
		oAllFormNames.Add(Name)
	Next
	sSel = InputListBox("if nothing is selected the first form will be selected", oAllFormNames, (1), "Choose Form", "Available Forms")
	If sSel = "" Then
		iLogicForm.Show(oLocalFormNames.First())
	Else
		iLogicForm.Show(sSel)
	End If
End If
```

#### Code Block 16

```vb
Dim oLocalFormNames As IEnumerable(Of String) = iLogicForm.FormNames
If oLocalFormNames.Count = 0 Then MessageBox.Show("Document doesn't provide a local form.", "No form available")
If oLocalFormNames.Count = 1 Then iLogicForm.Show(oLocalFormNames.First())
If oLocalFormNames.Count > 1 Then
	Dim oAllFormNames As New ArrayList
	For Each Name In iLogicForm.FormNames
		oAllFormNames.Add(Name)
	Next
	sSel = InputListBox("if nothing is selected the first form will be selected", oAllFormNames, (1), "Choose Form", "Available Forms")
	If sSel = "" Then
		iLogicForm.Show(oLocalFormNames.First())
	Else
		iLogicForm.Show(sSel)
	End If
End If
```

#### Code Block 17

```vb
For Each name As String In iLogicForm.FormNames
	Logger.Info("Found rule: " & name)
Next name
```

#### Code Block 18

```vb
For Each name As String In iLogicForm.FormNames
	Logger.Info("Found rule: " & name)
Next name
```

#### Code Block 19

```vb
For Each name As String In iLogicForm.FormNames
	Logger.Info("Found rule: " & name)
Next name
```

#### Code Block 20

```vb
For Each name As String In iLogicForm.FormNames
	Logger.Info("Found rule: " & name)
Next name
```

#### Code Block 21

```vb
If iLogicForm.FormNames.Count() > 0 Then iLogicForm.Show(iLogicForm.FormNames(0))
```

#### Code Block 22

```vb
If iLogicForm.FormNames.Count() > 0 Then iLogicForm.Show(iLogicForm.FormNames(0))
```

#### Code Block 23

```vb
If iLogicForm.FormNames.Count() > 0 Then iLogicForm.Show(iLogicForm.FormNames(0))
```

#### Code Block 24

```vb
If iLogicForm.FormNames.Count() > 0 Then iLogicForm.Show(iLogicForm.FormNames(0))
```

---

### 58. Feature Rectangular Pattern creation in assembly using iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/feature-rectangular-pattern-creation-in-assembly-using-ilogic/td-p/13756319#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/feature-rectangular-pattern-creation-in-assembly-using-ilogic/td-p/13756319#messageview_0)

**Author:** jakub_piaseczny

**Date:** ‎08-06-2025
	
		
		07:12 AM

**Description:** Hi guys, I tried to look everywhere (even used AI to help me but it failed totally), but found no information on how to create pattern of a feature in assembly using iLogic. Best to show it on example: I created assembly and in 3D Model tab using Extrude feature I removed some material from fin (par...

**Code Snippets (1):**

#### Code Block 1

```vb
Dim oAsm As AssemblyDocument = ThisApplication.ActiveDocument
Dim oDef As AssemblyComponentDefinition = oAsm.ComponentDefinition

Dim oExtFeat As ExtrudeFeature = oDef.Features.Item("slot_top_cut")

Dim patt As RectangularPatternFeature

Dim oColl As ObjectCollection
oColl = ThisApplication.TransientObjects.CreateObjectCollection()
oColl.Add(oExtFeat)

Dim oAxis As WorkAxis
oAxis = oDef.WorkAxes.Item("X Axis")

Dim rectDef As RectangularPatternFeatureDefinition
rectDef = oDef.Features.RectangularPatternFeatures.CreateDefinition(oColl, oAxis, True, tube_qty_tube - 1, pitch / 10)

patt = oDef.Features.RectangularPatternFeatures.AddByDefinition(rectDef)

patt.Name = "slot_top_pattern"
```

#### Code Block 2

```vb
Dim oAsm As AssemblyDocument = ThisApplication.ActiveDocument
Dim oDef As AssemblyComponentDefinition = oAsm.ComponentDefinition

Dim oExtFeat As ExtrudeFeature = oDef.Features.Item("slot_top_cut")

Dim patt As RectangularPatternFeature

Dim oColl As ObjectCollection
oColl = ThisApplication.TransientObjects.CreateObjectCollection()
oColl.Add(oExtFeat)

Dim oAxis As WorkAxis
oAxis = oDef.WorkAxes.Item("X Axis")

Dim rectDef As RectangularPatternFeatureDefinition
rectDef = oDef.Features.RectangularPatternFeatures.CreateDefinition(oColl, oAxis, True, tube_qty_tube - 1, pitch / 10)

patt = oDef.Features.RectangularPatternFeatures.AddByDefinition(rectDef)

patt.Name = "slot_top_pattern"
```

---

### 59. GLB export - Inventor server

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/glb-export-inventor-server/td-p/13801542](https://forums.autodesk.com/t5/inventor-programming-forum/glb-export-inventor-server/td-p/13801542)

**Author:** mateusz_baczewski

**Date:** ‎09-08-2025
	
		
		10:47 AM

**Description:** Hi,I’m having an issue with generating a correct .glb file for assemblies. The problem is that sometimes, in the exported .glb file, the mesh of a part/assembly is missing. I’m developing an add-in for Vault that works in such a way that for released items, it generates a GLB model, ensuring that th...

**Code Snippets (2):**

#### Code Block 1

```vb
public void TraverseAssembly(ComponentOccurrences occurrences)
        {
            List<ComponentOccurrences> nextLevel = new List<ComponentOccurrences>();

            foreach (ComponentOccurrence oOcc in occurrences)
            {
                string oOccName = oOcc.Name;
                oOcc.Visible = true;
                if (oOcc.Suppressed) { continue; }
                oOcc.IsAssociativeToDesignViewRepresentation = false;

                Document oOccDoc = (Document)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;

                string oOccDocName = oOccDoc.DisplayName.Split('.').FirstOrDefault();
                string oOccDocSubType = oOccDoc.SubType;

                string modelName = System.IO.Path.GetFileNameWithoutExtension(oOcc.ReferencedFileDescriptor.FullFileName);
                string simplifyPath = System.IO.Path.Combine(_simplyfyFolder, modelName + ".ipt");
                string asmName = System.IO.Path.GetFileName(oOcc.ReferencedFileDescriptor.FullFileName);

                object erpId = VaultMethods.GetErpIdByPartName(asmName, _connection);
                if (erpId == null) continue;

                if (!nameCountDict.ContainsKey(erpId.ToString()))
                    nameCountDict[erpId.ToString()] = 0;

                nameCountDict[erpId.ToString()]++;
                int partCount = nameCountDict[erpId.ToString()];

                string material = GetComponentMaterial(oOccDoc);

                if (!string.IsNullOrEmpty(oOcc.Name) &&
                    !oOcc.Name.Contains("Weldbead"))
                {
                    if (oOccDocSubType == DocumentSubTypeIds.Assembly)
                    {
                        var oOccAseCompDef = oOcc.Definition as AssemblyComponentDefinition;
                        oOcc.Name = $"{erpId}:{partCount}";

                        if (oOcc.BOMStructure != Inventor.BOMStructureEnum.kPurchasedBOMStructure)
                        {
                            if (oOccAseCompDef.IsModelStateMember)
                            {
                                var factoryDocument = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                                factoryDocument.ComponentDefinition.ModelStates.MemberEditScope = MemberEditScopeEnum.kEditAllMembers;
                                nextLevel.Add(factoryDocument.ComponentDefinition.Occurrences);
                            }
                            else
                            {
                                nextLevel.Add(oOcc.Definition.Occurrences);
                            }
                        }
                        else if (oOcc.BOMStructure == Inventor.BOMStructureEnum.kPurchasedBOMStructure)
                        {
                            AssemblyDocument asmDoc = null;
                            AssemblyComponentDefinition oOccAsmCompDef = null;
                            if (oOccAseCompDef.IsModelStateMember)
                            {
                                asmDoc = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                            }
                            else
                            {
                                asmDoc = (AssemblyDocument)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;
                            }
                            oOccAsmCompDef = asmDoc.ComponentDefinition;
                            string folder = System.IO.Path.GetDirectoryName(asmDoc.FullFileName);

                            if (!System.IO.File.Exists(simplifyPath))
                            {
                                simplifyPath = CreateSimplifyModel(asmDoc, folder);
                                ModelState newState = oOccAsmCompDef.ModelStates.AddSubstitute(simplifyPath, $"{erpId}", false);
                            }
                            oOcc.Name = $"{erpId}:{partCount}";
                            oOcc.ActiveModelState = $"{erpId}";
                        }
                    }
                    else if (oOccDocSubType == DocumentSubTypeIds.Weldment)
                    {
                        var oOccAseCompDef = oOcc.Definition as AssemblyComponentDefinition;
                        AssemblyDocument asmDoc = null;
                        AssemblyComponentDefinition oOccAsmCompDef = null;
                        if (oOccAseCompDef.IsModelStateMember)
                        {
                            asmDoc = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                        }
                        else
                        {
                            asmDoc = (AssemblyDocument)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;
                        }
                        oOccAsmCompDef = asmDoc.ComponentDefinition;
                        string folder = System.IO.Path.GetDirectoryName(asmDoc.FullFileName);


                        if (!System.IO.File.Exists(simplifyPath))
                        {
                            simplifyPath = CreateSimplifyModel(asmDoc, folder);
                            ModelState newState = oOccAsmCompDef.ModelStates.AddSubstitute(simplifyPath, $"{erpId}", false);
                        }
                        oOcc.Name = $"{erpId}:{partCount}";
                        oOcc.ActiveModelState = $"{erpId}";
                    }
                    else
                    {
                        oOcc.Name = $"{erpId}:{partCount}";
                       
                    }
                }
            }

            foreach (var occs in nextLevel)
            {
                TraverseAssembly(occs);
            }

        }
```

#### Code Block 2

```vb
public void TraverseAssembly(ComponentOccurrences occurrences)
        {
            List<ComponentOccurrences> nextLevel = new List<ComponentOccurrences>();

            foreach (ComponentOccurrence oOcc in occurrences)
            {
                string oOccName = oOcc.Name;
                oOcc.Visible = true;
                if (oOcc.Suppressed) { continue; }
                oOcc.IsAssociativeToDesignViewRepresentation = false;

                Document oOccDoc = (Document)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;

                string oOccDocName = oOccDoc.DisplayName.Split('.').FirstOrDefault();
                string oOccDocSubType = oOccDoc.SubType;

                string modelName = System.IO.Path.GetFileNameWithoutExtension(oOcc.ReferencedFileDescriptor.FullFileName);
                string simplifyPath = System.IO.Path.Combine(_simplyfyFolder, modelName + ".ipt");
                string asmName = System.IO.Path.GetFileName(oOcc.ReferencedFileDescriptor.FullFileName);

                object erpId = VaultMethods.GetErpIdByPartName(asmName, _connection);
                if (erpId == null) continue;

                if (!nameCountDict.ContainsKey(erpId.ToString()))
                    nameCountDict[erpId.ToString()] = 0;

                nameCountDict[erpId.ToString()]++;
                int partCount = nameCountDict[erpId.ToString()];

                string material = GetComponentMaterial(oOccDoc);

                if (!string.IsNullOrEmpty(oOcc.Name) &&
                    !oOcc.Name.Contains("Weldbead"))
                {
                    if (oOccDocSubType == DocumentSubTypeIds.Assembly)
                    {
                        var oOccAseCompDef = oOcc.Definition as AssemblyComponentDefinition;
                        oOcc.Name = $"{erpId}:{partCount}";

                        if (oOcc.BOMStructure != Inventor.BOMStructureEnum.kPurchasedBOMStructure)
                        {
                            if (oOccAseCompDef.IsModelStateMember)
                            {
                                var factoryDocument = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                                factoryDocument.ComponentDefinition.ModelStates.MemberEditScope = MemberEditScopeEnum.kEditAllMembers;
                                nextLevel.Add(factoryDocument.ComponentDefinition.Occurrences);
                            }
                            else
                            {
                                nextLevel.Add(oOcc.Definition.Occurrences);
                            }
                        }
                        else if (oOcc.BOMStructure == Inventor.BOMStructureEnum.kPurchasedBOMStructure)
                        {
                            AssemblyDocument asmDoc = null;
                            AssemblyComponentDefinition oOccAsmCompDef = null;
                            if (oOccAseCompDef.IsModelStateMember)
                            {
                                asmDoc = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                            }
                            else
                            {
                                asmDoc = (AssemblyDocument)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;
                            }
                            oOccAsmCompDef = asmDoc.ComponentDefinition;
                            string folder = System.IO.Path.GetDirectoryName(asmDoc.FullFileName);

                            if (!System.IO.File.Exists(simplifyPath))
                            {
                                simplifyPath = CreateSimplifyModel(asmDoc, folder);
                                ModelState newState = oOccAsmCompDef.ModelStates.AddSubstitute(simplifyPath, $"{erpId}", false);
                            }
                            oOcc.Name = $"{erpId}:{partCount}";
                            oOcc.ActiveModelState = $"{erpId}";
                        }
                    }
                    else if (oOccDocSubType == DocumentSubTypeIds.Weldment)
                    {
                        var oOccAseCompDef = oOcc.Definition as AssemblyComponentDefinition;
                        AssemblyDocument asmDoc = null;
                        AssemblyComponentDefinition oOccAsmCompDef = null;
                        if (oOccAseCompDef.IsModelStateMember)
                        {
                            asmDoc = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                        }
                        else
                        {
                            asmDoc = (AssemblyDocument)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;
                        }
                        oOccAsmCompDef = asmDoc.ComponentDefinition;
                        string folder = System.IO.Path.GetDirectoryName(asmDoc.FullFileName);


                        if (!System.IO.File.Exists(simplifyPath))
                        {
                            simplifyPath = CreateSimplifyModel(asmDoc, folder);
                            ModelState newState = oOccAsmCompDef.ModelStates.AddSubstitute(simplifyPath, $"{erpId}", false);
                        }
                        oOcc.Name = $"{erpId}:{partCount}";
                        oOcc.ActiveModelState = $"{erpId}";
                    }
                    else
                    {
                        oOcc.Name = $"{erpId}:{partCount}";
                       
                    }
                }
            }

            foreach (var occs in nextLevel)
            {
                TraverseAssembly(occs);
            }

        }
```

#### Code Block 3

```vb
public void TraverseAssembly(ComponentOccurrences occurrences)
        {
            List<ComponentOccurrences> nextLevel = new List<ComponentOccurrences>();

            foreach (ComponentOccurrence oOcc in occurrences)
            {
                string oOccName = oOcc.Name;
                oOcc.Visible = true;
                if (oOcc.Suppressed) { continue; }
                oOcc.IsAssociativeToDesignViewRepresentation = false;

                Document oOccDoc = (Document)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;

                string oOccDocName = oOccDoc.DisplayName.Split('.').FirstOrDefault();
                string oOccDocSubType = oOccDoc.SubType;

                string modelName = System.IO.Path.GetFileNameWithoutExtension(oOcc.ReferencedFileDescriptor.FullFileName);
                string simplifyPath = System.IO.Path.Combine(_simplyfyFolder, modelName + ".ipt");
                string asmName = System.IO.Path.GetFileName(oOcc.ReferencedFileDescriptor.FullFileName);

                object erpId = VaultMethods.GetErpIdByPartName(asmName, _connection);
                if (erpId == null) continue;

                if (!nameCountDict.ContainsKey(erpId.ToString()))
                    nameCountDict[erpId.ToString()] = 0;

                nameCountDict[erpId.ToString()]++;
                int partCount = nameCountDict[erpId.ToString()];

                string material = GetComponentMaterial(oOccDoc);

                if (!string.IsNullOrEmpty(oOcc.Name) &&
                    !oOcc.Name.Contains("Weldbead"))
                {
                    if (oOccDocSubType == DocumentSubTypeIds.Assembly)
                    {
                        var oOccAseCompDef = oOcc.Definition as AssemblyComponentDefinition;
                        oOcc.Name = $"{erpId}:{partCount}";

                        if (oOcc.BOMStructure != Inventor.BOMStructureEnum.kPurchasedBOMStructure)
                        {
                            if (oOccAseCompDef.IsModelStateMember)
                            {
                                var factoryDocument = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                                factoryDocument.ComponentDefinition.ModelStates.MemberEditScope = MemberEditScopeEnum.kEditAllMembers;
                                nextLevel.Add(factoryDocument.ComponentDefinition.Occurrences);
                            }
                            else
                            {
                                nextLevel.Add(oOcc.Definition.Occurrences);
                            }
                        }
                        else if (oOcc.BOMStructure == Inventor.BOMStructureEnum.kPurchasedBOMStructure)
                        {
                            AssemblyDocument asmDoc = null;
                            AssemblyComponentDefinition oOccAsmCompDef = null;
                            if (oOccAseCompDef.IsModelStateMember)
                            {
                                asmDoc = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                            }
                            else
                            {
                                asmDoc = (AssemblyDocument)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;
                            }
                            oOccAsmCompDef = asmDoc.ComponentDefinition;
                            string folder = System.IO.Path.GetDirectoryName(asmDoc.FullFileName);

                            if (!System.IO.File.Exists(simplifyPath))
                            {
                                simplifyPath = CreateSimplifyModel(asmDoc, folder);
                                ModelState newState = oOccAsmCompDef.ModelStates.AddSubstitute(simplifyPath, $"{erpId}", false);
                            }
                            oOcc.Name = $"{erpId}:{partCount}";
                            oOcc.ActiveModelState = $"{erpId}";
                        }
                    }
                    else if (oOccDocSubType == DocumentSubTypeIds.Weldment)
                    {
                        var oOccAseCompDef = oOcc.Definition as AssemblyComponentDefinition;
                        AssemblyDocument asmDoc = null;
                        AssemblyComponentDefinition oOccAsmCompDef = null;
                        if (oOccAseCompDef.IsModelStateMember)
                        {
                            asmDoc = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                        }
                        else
                        {
                            asmDoc = (AssemblyDocument)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;
                        }
                        oOccAsmCompDef = asmDoc.ComponentDefinition;
                        string folder = System.IO.Path.GetDirectoryName(asmDoc.FullFileName);


                        if (!System.IO.File.Exists(simplifyPath))
                        {
                            simplifyPath = CreateSimplifyModel(asmDoc, folder);
                            ModelState newState = oOccAsmCompDef.ModelStates.AddSubstitute(simplifyPath, $"{erpId}", false);
                        }
                        oOcc.Name = $"{erpId}:{partCount}";
                        oOcc.ActiveModelState = $"{erpId}";
                    }
                    else
                    {
                        oOcc.Name = $"{erpId}:{partCount}";
                       
                    }
                }
            }

            foreach (var occs in nextLevel)
            {
                TraverseAssembly(occs);
            }

        }
```

#### Code Block 4

```vb
public void TraverseAssembly(ComponentOccurrences occurrences)
        {
            List<ComponentOccurrences> nextLevel = new List<ComponentOccurrences>();

            foreach (ComponentOccurrence oOcc in occurrences)
            {
                string oOccName = oOcc.Name;
                oOcc.Visible = true;
                if (oOcc.Suppressed) { continue; }
                oOcc.IsAssociativeToDesignViewRepresentation = false;

                Document oOccDoc = (Document)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;

                string oOccDocName = oOccDoc.DisplayName.Split('.').FirstOrDefault();
                string oOccDocSubType = oOccDoc.SubType;

                string modelName = System.IO.Path.GetFileNameWithoutExtension(oOcc.ReferencedFileDescriptor.FullFileName);
                string simplifyPath = System.IO.Path.Combine(_simplyfyFolder, modelName + ".ipt");
                string asmName = System.IO.Path.GetFileName(oOcc.ReferencedFileDescriptor.FullFileName);

                object erpId = VaultMethods.GetErpIdByPartName(asmName, _connection);
                if (erpId == null) continue;

                if (!nameCountDict.ContainsKey(erpId.ToString()))
                    nameCountDict[erpId.ToString()] = 0;

                nameCountDict[erpId.ToString()]++;
                int partCount = nameCountDict[erpId.ToString()];

                string material = GetComponentMaterial(oOccDoc);

                if (!string.IsNullOrEmpty(oOcc.Name) &&
                    !oOcc.Name.Contains("Weldbead"))
                {
                    if (oOccDocSubType == DocumentSubTypeIds.Assembly)
                    {
                        var oOccAseCompDef = oOcc.Definition as AssemblyComponentDefinition;
                        oOcc.Name = $"{erpId}:{partCount}";

                        if (oOcc.BOMStructure != Inventor.BOMStructureEnum.kPurchasedBOMStructure)
                        {
                            if (oOccAseCompDef.IsModelStateMember)
                            {
                                var factoryDocument = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                                factoryDocument.ComponentDefinition.ModelStates.MemberEditScope = MemberEditScopeEnum.kEditAllMembers;
                                nextLevel.Add(factoryDocument.ComponentDefinition.Occurrences);
                            }
                            else
                            {
                                nextLevel.Add(oOcc.Definition.Occurrences);
                            }
                        }
                        else if (oOcc.BOMStructure == Inventor.BOMStructureEnum.kPurchasedBOMStructure)
                        {
                            AssemblyDocument asmDoc = null;
                            AssemblyComponentDefinition oOccAsmCompDef = null;
                            if (oOccAseCompDef.IsModelStateMember)
                            {
                                asmDoc = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                            }
                            else
                            {
                                asmDoc = (AssemblyDocument)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;
                            }
                            oOccAsmCompDef = asmDoc.ComponentDefinition;
                            string folder = System.IO.Path.GetDirectoryName(asmDoc.FullFileName);

                            if (!System.IO.File.Exists(simplifyPath))
                            {
                                simplifyPath = CreateSimplifyModel(asmDoc, folder);
                                ModelState newState = oOccAsmCompDef.ModelStates.AddSubstitute(simplifyPath, $"{erpId}", false);
                            }
                            oOcc.Name = $"{erpId}:{partCount}";
                            oOcc.ActiveModelState = $"{erpId}";
                        }
                    }
                    else if (oOccDocSubType == DocumentSubTypeIds.Weldment)
                    {
                        var oOccAseCompDef = oOcc.Definition as AssemblyComponentDefinition;
                        AssemblyDocument asmDoc = null;
                        AssemblyComponentDefinition oOccAsmCompDef = null;
                        if (oOccAseCompDef.IsModelStateMember)
                        {
                            asmDoc = (AssemblyDocument)oOccAseCompDef.FactoryDocument;
                        }
                        else
                        {
                            asmDoc = (AssemblyDocument)oOcc.ReferencedDocumentDescriptor.ReferencedDocument;
                        }
                        oOccAsmCompDef = asmDoc.ComponentDefinition;
                        string folder = System.IO.Path.GetDirectoryName(asmDoc.FullFileName);


                        if (!System.IO.File.Exists(simplifyPath))
                        {
                            simplifyPath = CreateSimplifyModel(asmDoc, folder);
                            ModelState newState = oOccAsmCompDef.ModelStates.AddSubstitute(simplifyPath, $"{erpId}", false);
                        }
                        oOcc.Name = $"{erpId}:{partCount}";
                        oOcc.ActiveModelState = $"{erpId}";
                    }
                    else
                    {
                        oOcc.Name = $"{erpId}:{partCount}";
                       
                    }
                }
            }

            foreach (var occs in nextLevel)
            {
                TraverseAssembly(occs);
            }

        }
```

---

### 60. Get overall dimensions  of all views of a drawing by iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/get-overall-dimensions-of-all-views-of-a-drawing-by-ilogic/td-p/12672101](https://forums.autodesk.com/t5/inventor-programming-forum/get-overall-dimensions-of-all-views-of-a-drawing-by-ilogic/td-p/12672101)

**Author:** Jakob_Hamburg

**Date:** ‎03-28-2024
	
		
		06:38 AM

**Description:** Hello. I have a drawing with many different single parts on. I want to get the overall dimensions (height and width) automatically on all base views.There is a rule written by "Jelte de Jong" which generates the overall dimensions (height and width) on a view that you as a user have to pick. (http:/...

**Code Snippets (6):**

#### Code Block 1

```vb
Public Class ThisRule
    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

    Sub Main()
        _doc = ThisDoc.Document
		
		For Each sheet As Sheet In _doc.Sheets
            For Each view As DrawingView In Sheet.DrawingViews
                If (View.ViewType <> DrawingViewTypeEnum.kStandardDrawingViewType) Then Continue For
				_intents = New List(Of GeometryIntent)()
				_sheet = Sheet
				_view = View
				CreateIntentList()
		        createHorizontalOuterDimension()
		        createVerticalOuterDimension()
            Next
        Next
    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y + _view.Height / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X - _view.Width / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

    ' Copyright 2021
    ' 
    ' This code was written by Jelte de Jong, and published on www.hjalte.nl
    '
    ' Permission Is hereby granted, free of charge, to any person obtaining a copy of this 
    ' software And associated documentation files (the "Software"), to deal in the Software 
    ' without restriction, including without limitation the rights to use, copy, modify, merge, 
    ' publish, distribute, sublicense, And/Or sell copies of the Software, And to permit persons 
    ' to whom the Software Is furnished to do so, subject to the following conditions:
    '
    ' The above copyright notice And this permission notice shall be included In all copies Or
    ' substantial portions Of the Software.
    ' 
    ' THE SOFTWARE Is PROVIDED "AS IS", WITHOUT WARRANTY Of ANY KIND, EXPRESS Or IMPLIED, 
    ' INCLUDING BUT Not LIMITED To THE WARRANTIES Of MERCHANTABILITY, FITNESS For A PARTICULAR 
    ' PURPOSE And NONINFRINGEMENT. In NO Event SHALL THE AUTHORS Or COPYRIGHT HOLDERS BE LIABLE 
    ' For ANY CLAIM, DAMAGES Or OTHER LIABILITY, WHETHER In AN ACTION Of CONTRACT, TORT Or 
    ' OTHERWISE, ARISING FROM, OUT Of Or In CONNECTION With THE SOFTWARE Or THE USE Or OTHER 
    ' DEALINGS In THE SOFTWARE.
End Class
```

#### Code Block 2

```vb
Public Class ThisRule
    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

    Sub Main()
        _doc = ThisDoc.Document
		
		For Each sheet As Sheet In _doc.Sheets
            For Each view As DrawingView In Sheet.DrawingViews
                If (View.ViewType <> DrawingViewTypeEnum.kStandardDrawingViewType) Then Continue For
				_intents = New List(Of GeometryIntent)()
				_sheet = Sheet
				_view = View
				CreateIntentList()
		        createHorizontalOuterDimension()
		        createVerticalOuterDimension()
            Next
        Next
    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y + _view.Height / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X - _view.Width / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

    ' Copyright 2021
    ' 
    ' This code was written by Jelte de Jong, and published on www.hjalte.nl
    '
    ' Permission Is hereby granted, free of charge, to any person obtaining a copy of this 
    ' software And associated documentation files (the "Software"), to deal in the Software 
    ' without restriction, including without limitation the rights to use, copy, modify, merge, 
    ' publish, distribute, sublicense, And/Or sell copies of the Software, And to permit persons 
    ' to whom the Software Is furnished to do so, subject to the following conditions:
    '
    ' The above copyright notice And this permission notice shall be included In all copies Or
    ' substantial portions Of the Software.
    ' 
    ' THE SOFTWARE Is PROVIDED "AS IS", WITHOUT WARRANTY Of ANY KIND, EXPRESS Or IMPLIED, 
    ' INCLUDING BUT Not LIMITED To THE WARRANTIES Of MERCHANTABILITY, FITNESS For A PARTICULAR 
    ' PURPOSE And NONINFRINGEMENT. In NO Event SHALL THE AUTHORS Or COPYRIGHT HOLDERS BE LIABLE 
    ' For ANY CLAIM, DAMAGES Or OTHER LIABILITY, WHETHER In AN ACTION Of CONTRACT, TORT Or 
    ' OTHERWISE, ARISING FROM, OUT Of Or In CONNECTION With THE SOFTWARE Or THE USE Or OTHER 
    ' DEALINGS In THE SOFTWARE.
End Class
```

#### Code Block 3

```vb
Public Class ThisRule
    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

    Sub Main()
        _doc = ThisDoc.Document
		
		For Each sheet As Sheet In _doc.Sheets
            For Each view As DrawingView In Sheet.DrawingViews
                If (View.ViewType <> DrawingViewTypeEnum.kStandardDrawingViewType) Then Continue For
				_intents = New List(Of GeometryIntent)()
				_sheet = Sheet
				_view = View
				CreateIntentList()
		        createHorizontalOuterDimension()
		        createVerticalOuterDimension()
            Next
        Next
    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y + _view.Height / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X - _view.Width / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

    ' Copyright 2021
    ' 
    ' This code was written by Jelte de Jong, and published on www.hjalte.nl
    '
    ' Permission Is hereby granted, free of charge, to any person obtaining a copy of this 
    ' software And associated documentation files (the "Software"), to deal in the Software 
    ' without restriction, including without limitation the rights to use, copy, modify, merge, 
    ' publish, distribute, sublicense, And/Or sell copies of the Software, And to permit persons 
    ' to whom the Software Is furnished to do so, subject to the following conditions:
    '
    ' The above copyright notice And this permission notice shall be included In all copies Or
    ' substantial portions Of the Software.
    ' 
    ' THE SOFTWARE Is PROVIDED "AS IS", WITHOUT WARRANTY Of ANY KIND, EXPRESS Or IMPLIED, 
    ' INCLUDING BUT Not LIMITED To THE WARRANTIES Of MERCHANTABILITY, FITNESS For A PARTICULAR 
    ' PURPOSE And NONINFRINGEMENT. In NO Event SHALL THE AUTHORS Or COPYRIGHT HOLDERS BE LIABLE 
    ' For ANY CLAIM, DAMAGES Or OTHER LIABILITY, WHETHER In AN ACTION Of CONTRACT, TORT Or 
    ' OTHERWISE, ARISING FROM, OUT Of Or In CONNECTION With THE SOFTWARE Or THE USE Or OTHER 
    ' DEALINGS In THE SOFTWARE.
End Class
```

#### Code Block 4

```vb
Public Class ThisRule
    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

    Sub Main()
        _doc = ThisDoc.Document
		
		For Each sheet As Sheet In _doc.Sheets
            For Each view As DrawingView In Sheet.DrawingViews
                If (View.ViewType <> DrawingViewTypeEnum.kStandardDrawingViewType) Then Continue For
				_intents = New List(Of GeometryIntent)()
				_sheet = Sheet
				_view = View
				CreateIntentList()
		        createHorizontalOuterDimension()
		        createVerticalOuterDimension()
            Next
        Next
    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y + _view.Height / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X - _view.Width / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

    ' Copyright 2021
    ' 
    ' This code was written by Jelte de Jong, and published on www.hjalte.nl
    '
    ' Permission Is hereby granted, free of charge, to any person obtaining a copy of this 
    ' software And associated documentation files (the "Software"), to deal in the Software 
    ' without restriction, including without limitation the rights to use, copy, modify, merge, 
    ' publish, distribute, sublicense, And/Or sell copies of the Software, And to permit persons 
    ' to whom the Software Is furnished to do so, subject to the following conditions:
    '
    ' The above copyright notice And this permission notice shall be included In all copies Or
    ' substantial portions Of the Software.
    ' 
    ' THE SOFTWARE Is PROVIDED "AS IS", WITHOUT WARRANTY Of ANY KIND, EXPRESS Or IMPLIED, 
    ' INCLUDING BUT Not LIMITED To THE WARRANTIES Of MERCHANTABILITY, FITNESS For A PARTICULAR 
    ' PURPOSE And NONINFRINGEMENT. In NO Event SHALL THE AUTHORS Or COPYRIGHT HOLDERS BE LIABLE 
    ' For ANY CLAIM, DAMAGES Or OTHER LIABILITY, WHETHER In AN ACTION Of CONTRACT, TORT Or 
    ' OTHERWISE, ARISING FROM, OUT Of Or In CONNECTION With THE SOFTWARE Or THE USE Or OTHER 
    ' DEALINGS In THE SOFTWARE.
End Class
```

#### Code Block 5

```vb
Public Class ThisRule
    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

    Sub Main()
        _doc = ThisDoc.Document
		
		For Each sheet As Sheet In _doc.Sheets
            For Each view As DrawingView In Sheet.DrawingViews
                If (view.ViewType <> DrawingViewTypeEnum.kStandardDrawingViewType) Then Continue For

				_sheet = Sheet
				_view = View
				CreateIntentList()
		        createHorizontalOuterDimension()
		        createVerticalOuterDimension()
            Next
        Next
    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y + _view.Height / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X - _view.Width / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

    ' Copyright 2021
    ' 
    ' This code was written by Jelte de Jong, and published on www.hjalte.nl
    '
    ' Permission Is hereby granted, free of charge, to any person obtaining a copy of this 
    ' software And associated documentation files (the "Software"), to deal in the Software 
    ' without restriction, including without limitation the rights to use, copy, modify, merge, 
    ' publish, distribute, sublicense, And/Or sell copies of the Software, And to permit persons 
    ' to whom the Software Is furnished to do so, subject to the following conditions:
    '
    ' The above copyright notice And this permission notice shall be included In all copies Or
    ' substantial portions Of the Software.
    ' 
    ' THE SOFTWARE Is PROVIDED "AS IS", WITHOUT WARRANTY Of ANY KIND, EXPRESS Or IMPLIED, 
    ' INCLUDING BUT Not LIMITED To THE WARRANTIES Of MERCHANTABILITY, FITNESS For A PARTICULAR 
    ' PURPOSE And NONINFRINGEMENT. In NO Event SHALL THE AUTHORS Or COPYRIGHT HOLDERS BE LIABLE 
    ' For ANY CLAIM, DAMAGES Or OTHER LIABILITY, WHETHER In AN ACTION Of CONTRACT, TORT Or 
    ' OTHERWISE, ARISING FROM, OUT Of Or In CONNECTION With THE SOFTWARE Or THE USE Or OTHER 
    ' DEALINGS In THE SOFTWARE.
End Class
```

#### Code Block 6

```vb
Public Class ThisRule
    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

    Sub Main()
        _doc = ThisDoc.Document
		
		For Each sheet As Sheet In _doc.Sheets
            For Each view As DrawingView In Sheet.DrawingViews
                If (view.ViewType <> DrawingViewTypeEnum.kStandardDrawingViewType) Then Continue For

				_sheet = Sheet
				_view = View
				CreateIntentList()
		        createHorizontalOuterDimension()
		        createVerticalOuterDimension()
            Next
        Next
    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y + _view.Height / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X - _view.Width / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

    ' Copyright 2021
    ' 
    ' This code was written by Jelte de Jong, and published on www.hjalte.nl
    '
    ' Permission Is hereby granted, free of charge, to any person obtaining a copy of this 
    ' software And associated documentation files (the "Software"), to deal in the Software 
    ' without restriction, including without limitation the rights to use, copy, modify, merge, 
    ' publish, distribute, sublicense, And/Or sell copies of the Software, And to permit persons 
    ' to whom the Software Is furnished to do so, subject to the following conditions:
    '
    ' The above copyright notice And this permission notice shall be included In all copies Or
    ' substantial portions Of the Software.
    ' 
    ' THE SOFTWARE Is PROVIDED "AS IS", WITHOUT WARRANTY Of ANY KIND, EXPRESS Or IMPLIED, 
    ' INCLUDING BUT Not LIMITED To THE WARRANTIES Of MERCHANTABILITY, FITNESS For A PARTICULAR 
    ' PURPOSE And NONINFRINGEMENT. In NO Event SHALL THE AUTHORS Or COPYRIGHT HOLDERS BE LIABLE 
    ' For ANY CLAIM, DAMAGES Or OTHER LIABILITY, WHETHER In AN ACTION Of CONTRACT, TORT Or 
    ' OTHERWISE, ARISING FROM, OUT Of Or In CONNECTION With THE SOFTWARE Or THE USE Or OTHER 
    ' DEALINGS In THE SOFTWARE.
End Class
```

#### Code Block 7

```vb
Public Class ThisRule
    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

    Sub Main()
        _doc = ThisDoc.Document
		
		For Each sheet As Sheet In _doc.Sheets
            For Each view As DrawingView In Sheet.DrawingViews
                If (view.ViewType <> DrawingViewTypeEnum.kStandardDrawingViewType) Then Continue For

				_sheet = Sheet
				_view = View
				CreateIntentList()
		        createHorizontalOuterDimension()
		        createVerticalOuterDimension()
            Next
        Next
    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y + _view.Height / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X - _view.Width / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

    ' Copyright 2021
    ' 
    ' This code was written by Jelte de Jong, and published on www.hjalte.nl
    '
    ' Permission Is hereby granted, free of charge, to any person obtaining a copy of this 
    ' software And associated documentation files (the "Software"), to deal in the Software 
    ' without restriction, including without limitation the rights to use, copy, modify, merge, 
    ' publish, distribute, sublicense, And/Or sell copies of the Software, And to permit persons 
    ' to whom the Software Is furnished to do so, subject to the following conditions:
    '
    ' The above copyright notice And this permission notice shall be included In all copies Or
    ' substantial portions Of the Software.
    ' 
    ' THE SOFTWARE Is PROVIDED "AS IS", WITHOUT WARRANTY Of ANY KIND, EXPRESS Or IMPLIED, 
    ' INCLUDING BUT Not LIMITED To THE WARRANTIES Of MERCHANTABILITY, FITNESS For A PARTICULAR 
    ' PURPOSE And NONINFRINGEMENT. In NO Event SHALL THE AUTHORS Or COPYRIGHT HOLDERS BE LIABLE 
    ' For ANY CLAIM, DAMAGES Or OTHER LIABILITY, WHETHER In AN ACTION Of CONTRACT, TORT Or 
    ' OTHERWISE, ARISING FROM, OUT Of Or In CONNECTION With THE SOFTWARE Or THE USE Or OTHER 
    ' DEALINGS In THE SOFTWARE.
End Class
```

#### Code Block 8

```vb
Public Class ThisRule
    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

    Sub Main()
        _doc = ThisDoc.Document
		
		For Each sheet As Sheet In _doc.Sheets
            For Each view As DrawingView In Sheet.DrawingViews
                If (view.ViewType <> DrawingViewTypeEnum.kStandardDrawingViewType) Then Continue For

				_sheet = Sheet
				_view = View
				CreateIntentList()
		        createHorizontalOuterDimension()
		        createVerticalOuterDimension()
            Next
        Next
    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y + _view.Height / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X - _view.Width / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

    ' Copyright 2021
    ' 
    ' This code was written by Jelte de Jong, and published on www.hjalte.nl
    '
    ' Permission Is hereby granted, free of charge, to any person obtaining a copy of this 
    ' software And associated documentation files (the "Software"), to deal in the Software 
    ' without restriction, including without limitation the rights to use, copy, modify, merge, 
    ' publish, distribute, sublicense, And/Or sell copies of the Software, And to permit persons 
    ' to whom the Software Is furnished to do so, subject to the following conditions:
    '
    ' The above copyright notice And this permission notice shall be included In all copies Or
    ' substantial portions Of the Software.
    ' 
    ' THE SOFTWARE Is PROVIDED "AS IS", WITHOUT WARRANTY Of ANY KIND, EXPRESS Or IMPLIED, 
    ' INCLUDING BUT Not LIMITED To THE WARRANTIES Of MERCHANTABILITY, FITNESS For A PARTICULAR 
    ' PURPOSE And NONINFRINGEMENT. In NO Event SHALL THE AUTHORS Or COPYRIGHT HOLDERS BE LIABLE 
    ' For ANY CLAIM, DAMAGES Or OTHER LIABILITY, WHETHER In AN ACTION Of CONTRACT, TORT Or 
    ' OTHERWISE, ARISING FROM, OUT Of Or In CONNECTION With THE SOFTWARE Or THE USE Or OTHER 
    ' DEALINGS In THE SOFTWARE.
End Class
```

#### Code Block 9

```vb
Public Class ThisRule
' This code was inspired and uses much of a code by Jelte de Jong

    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

Sub main
' Check a document is open
If ThisApplication.Documents.VisibleDocuments.Count = 0 Then
	MessageBox.Show("A Drawing Document needs to be open")
	Exit Sub
End If

' Check active document
If ThisApplication.ActiveDocumentType <> Inventor.DocumentTypeEnum.kDrawingDocumentObject Then
	MessageBox.Show("A Drawing Document needs to be open")
	Exit Sub
End If

' Get the active document
'Dim oDoc As Inventor.DrawingDocument = ThisApplication.ActiveDocument
_doc = ThisDoc.Document


' Iterate through all sheets
For Each _sheet As Inventor.Sheet In _doc.Sheets
	
	' Iterate through all views
	For Each _view As Inventor.DrawingView In _sheet.DrawingViews
		
		' Check view is a base view, skip if not
		If _view.ViewType <> Inventor.DrawingViewTypeEnum.kStandardDrawingViewType Then Continue For
		
		    CreateIntentList()
      		createHorizontalOuterDimension()
        	createVerticalOuterDimension()
		
		
	Next ' Next view
Next ' Next sheet
End Sub

'Public Class ThisRule
'	' This code was written by Jelte de Jong
'	' and published on www.hjalte.nl
'    Private _doc As DrawingDocument
'    Private _sheet As Sheet
'    Private _view As DrawingView
'    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

'    Sub Main()
'        _doc = ThisDoc.Document
'        _sheet = _doc.ActiveSheet
'        _view = ThisApplication.CommandManager.Pick(
'                       SelectionFilterEnum.kDrawingViewFilter, 
'                       "Select a drawing view")

'        CreateIntentList()
'        createHorizontalOuterDimension()
'        createVerticalOuterDimension()
'    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y - _view.Height / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X + _view.Width / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

End Class
```

#### Code Block 10

```vb
Public Class ThisRule
' This code was inspired and uses much of a code by Jelte de Jong

    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

Sub main
' Check a document is open
If ThisApplication.Documents.VisibleDocuments.Count = 0 Then
	MessageBox.Show("A Drawing Document needs to be open")
	Exit Sub
End If

' Check active document
If ThisApplication.ActiveDocumentType <> Inventor.DocumentTypeEnum.kDrawingDocumentObject Then
	MessageBox.Show("A Drawing Document needs to be open")
	Exit Sub
End If

' Get the active document
'Dim oDoc As Inventor.DrawingDocument = ThisApplication.ActiveDocument
_doc = ThisDoc.Document


' Iterate through all sheets
For Each _sheet As Inventor.Sheet In _doc.Sheets
	
	' Iterate through all views
	For Each _view As Inventor.DrawingView In _sheet.DrawingViews
		
		' Check view is a base view, skip if not
		If _view.ViewType <> Inventor.DrawingViewTypeEnum.kStandardDrawingViewType Then Continue For
		
		    CreateIntentList()
      		createHorizontalOuterDimension()
        	createVerticalOuterDimension()
		
		
	Next ' Next view
Next ' Next sheet
End Sub

'Public Class ThisRule
'	' This code was written by Jelte de Jong
'	' and published on www.hjalte.nl
'    Private _doc As DrawingDocument
'    Private _sheet As Sheet
'    Private _view As DrawingView
'    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

'    Sub Main()
'        _doc = ThisDoc.Document
'        _sheet = _doc.ActiveSheet
'        _view = ThisApplication.CommandManager.Pick(
'                       SelectionFilterEnum.kDrawingViewFilter, 
'                       "Select a drawing view")

'        CreateIntentList()
'        createHorizontalOuterDimension()
'        createVerticalOuterDimension()
'    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y - _view.Height / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X + _view.Width / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

End Class
```

#### Code Block 11

```vb
Public Class ThisRule
' This code was inspired and uses much of a code by Jelte de Jong

    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

Sub main
' Check a document is open
If ThisApplication.Documents.VisibleDocuments.Count = 0 Then
	MessageBox.Show("A Drawing Document needs to be open")
	Exit Sub
End If

' Check active document
If ThisApplication.ActiveDocumentType <> Inventor.DocumentTypeEnum.kDrawingDocumentObject Then
	MessageBox.Show("A Drawing Document needs to be open")
	Exit Sub
End If

' Get the active document
'Dim oDoc As Inventor.DrawingDocument = ThisApplication.ActiveDocument
_doc = ThisDoc.Document


' Iterate through all sheets
For Each _sheet As Inventor.Sheet In _doc.Sheets
	
	' Iterate through all views
	For Each _view As Inventor.DrawingView In _sheet.DrawingViews
		
		' Check view is a base view, skip if not
		If _view.ViewType <> Inventor.DrawingViewTypeEnum.kStandardDrawingViewType Then Continue For
		
		    CreateIntentList()
      		createHorizontalOuterDimension()
        	createVerticalOuterDimension()
		
		
	Next ' Next view
Next ' Next sheet
End Sub

'Public Class ThisRule
'	' This code was written by Jelte de Jong
'	' and published on www.hjalte.nl
'    Private _doc As DrawingDocument
'    Private _sheet As Sheet
'    Private _view As DrawingView
'    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

'    Sub Main()
'        _doc = ThisDoc.Document
'        _sheet = _doc.ActiveSheet
'        _view = ThisApplication.CommandManager.Pick(
'                       SelectionFilterEnum.kDrawingViewFilter, 
'                       "Select a drawing view")

'        CreateIntentList()
'        createHorizontalOuterDimension()
'        createVerticalOuterDimension()
'    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y - _view.Height / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X + _view.Width / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

End Class
```

#### Code Block 12

```vb
Public Class ThisRule
' This code was inspired and uses much of a code by Jelte de Jong

    Private _doc As DrawingDocument
    Private _sheet As Sheet
    Private _view As DrawingView
Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

Sub main
' Check a document is open
If ThisApplication.Documents.VisibleDocuments.Count = 0 Then
	MessageBox.Show("A Drawing Document needs to be open")
	Exit Sub
End If

' Check active document
If ThisApplication.ActiveDocumentType <> Inventor.DocumentTypeEnum.kDrawingDocumentObject Then
	MessageBox.Show("A Drawing Document needs to be open")
	Exit Sub
End If

' Get the active document
'Dim oDoc As Inventor.DrawingDocument = ThisApplication.ActiveDocument
_doc = ThisDoc.Document


' Iterate through all sheets
For Each _sheet As Inventor.Sheet In _doc.Sheets
	
	' Iterate through all views
	For Each _view As Inventor.DrawingView In _sheet.DrawingViews
		
		' Check view is a base view, skip if not
		If _view.ViewType <> Inventor.DrawingViewTypeEnum.kStandardDrawingViewType Then Continue For
		
		    CreateIntentList()
      		createHorizontalOuterDimension()
        	createVerticalOuterDimension()
		
		
	Next ' Next view
Next ' Next sheet
End Sub

'Public Class ThisRule
'	' This code was written by Jelte de Jong
'	' and published on www.hjalte.nl
'    Private _doc As DrawingDocument
'    Private _sheet As Sheet
'    Private _view As DrawingView
'    Private _intents As List(Of GeometryIntent) = New List(Of GeometryIntent)()

'    Sub Main()
'        _doc = ThisDoc.Document
'        _sheet = _doc.ActiveSheet
'        _view = ThisApplication.CommandManager.Pick(
'                       SelectionFilterEnum.kDrawingViewFilter, 
'                       "Select a drawing view")

'        CreateIntentList()
'        createHorizontalOuterDimension()
'        createVerticalOuterDimension()
'    End Sub

    Private Sub createHorizontalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.X)

        Dim pointLeft = orderedIntents.First
        Dim pointRight = orderedIntents.Last

        Dim textX = pointLeft.PointOnSheet.X +
                (pointRight.PointOnSheet.X - pointLeft.PointOnSheet.X) / 2
        Dim textY = _view.Position.Y - _view.Height / 2 - 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kHorizontalDimensionType)
    End Sub
    Private Sub createVerticalOuterDimension()
        Dim orderedIntents = _intents.OrderByDescending(Function(s) s.PointOnSheet.Y)

        Dim pointLeft = orderedIntents.Last
        Dim pointRight = orderedIntents.First

        Dim textY = pointLeft.PointOnSheet.Y +
                (pointRight.PointOnSheet.Y - pointLeft.PointOnSheet.Y) / 2
        Dim textX = _view.Position.X + _view.Width / 2 + 2

        Dim pointText = ThisApplication.TransientGeometry.CreatePoint2d(textX, textY)
        _sheet.DrawingDimensions.GeneralDimensions.AddLinear(
            pointText, pointLeft, pointRight, DimensionTypeEnum.kVerticalDimensionType)
    End Sub

    Private Sub addIntent(Geometry As DrawingCurve, IntentPlace As Object, onLineCheck As Boolean)
        Dim intent As GeometryIntent = _sheet.CreateGeometryIntent(Geometry, IntentPlace)
        If intent.PointOnSheet Is Nothing Then Return

        If onLineCheck Then
            If (IntentIsOnCurve(intent)) Then
                _intents.Add(intent)
            End If
        Else
            _intents.Add(intent)
        End If
    End Sub

    Private Function IntentIsOnCurve(intent As GeometryIntent) As Boolean
        Dim Geometry As DrawingCurve = intent.Geometry
        Dim sp = intent.PointOnSheet

        Dim pts(1) As Double
        Dim gp() As Double = {}
        Dim md() As Double = {}
        Dim pm() As Double = {}
        Dim st() As SolutionNatureEnum = {}
        pts(0) = sp.X
        pts(1) = sp.Y

        Try
            Geometry.Evaluator2D.GetParamAtPoint(pts, gp, md, pm, st)
        Catch ex As Exception
            Return False
        End Try
        Return True
    End Function

    Private Sub CreateIntentList()

        For Each oDrawingCurve As DrawingCurve In _view.DrawingCurves
            Select Case oDrawingCurve.ProjectedCurveType
                Case _
                        Curve2dTypeEnum.kCircleCurve2d,
                        Curve2dTypeEnum.kCircularArcCurve2d,
                        Curve2dTypeEnum.kEllipseFullCurve2d,
                        Curve2dTypeEnum.kEllipticalArcCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kCircularTopPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularBottomPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularLeftPointIntent, True)
                    addIntent(oDrawingCurve, PointIntentEnum.kCircularRightPointIntent, True)

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                        Curve2dTypeEnum.kLineCurve2d,
                        Curve2dTypeEnum.kLineSegmentCurve2d

                    addIntent(oDrawingCurve, PointIntentEnum.kEndPointIntent, False)
                    addIntent(oDrawingCurve, PointIntentEnum.kStartPointIntent, False)

                Case _
                    Curve2dTypeEnum.kPolylineCurve2d,
                    Curve2dTypeEnum.kBSplineCurve2d,
                    Curve2dTypeEnum.kUnknownCurve2d

                    ' Unhandled curves types
                Case Else
            End Select
        Next
    End Sub

End Class
```

---

### 61. Help on API AddByiMateAndEntity

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/help-on-api-addbyimateandentity/td-p/13822199](https://forums.autodesk.com/t5/inventor-programming-forum/help-on-api-addbyimateandentity/td-p/13822199)

**Author:** cavallerin

**Date:** ‎09-23-2025
	
		
		07:46 AM

**Description:** Hi, I'm not able to call the following method:Dim oImate As Object  Dim oMateName As iMateDefinition  Dim oFace As face  ....  Set oImate = oCompDef.iMateResults.AddByiMateAndEntity(oMateName.Name, oFace)  as it returns not a valid type.Can someone provide me an example?thx    					 				 			 			 			...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim imdp as object
occ.CreateGeometryProxy(oImate , imdp) ' proxy form occurrence containing imatedefinition
Dim oiMateResult As iMateResult = ass.ComponentDefinition.iMateResults.AddByiMateAndEntity(imdp , oface)
```

#### Code Block 2

```vb
Dim imdp as object
occ.CreateGeometryProxy(oImate , imdp) ' proxy form occurrence containing imatedefinition
Dim oiMateResult As iMateResult = ass.ComponentDefinition.iMateResults.AddByiMateAndEntity(imdp , oface)
```

#### Code Block 3

```vb
Dim imdp as object
occ.CreateGeometryProxy(oImate , imdp) ' proxy form occurrence containing imatedefinition
Dim oiMateResult As iMateResult = ass.ComponentDefinition.iMateResults.AddByiMateAndEntity(imdp , oface)
```

#### Code Block 4

```vb
Dim imdp as object
occ.CreateGeometryProxy(oImate , imdp) ' proxy form occurrence containing imatedefinition
Dim oiMateResult As iMateResult = ass.ComponentDefinition.iMateResults.AddByiMateAndEntity(imdp , oface)
```

#### Code Block 5

```vb
Dim imdp as object
occ.CreateGeometryProxy(oImate , imdp) ' proxy form occurrence containing imatedefinition
Dim oiMateResult As iMateResult = ass.ComponentDefinition.iMateResults.AddByiMateAndEntity(imdp , oface)
```

#### Code Block 6

```vb
Dim imdp as object
occ.CreateGeometryProxy(oImate , imdp) ' proxy form occurrence containing imatedefinition
Dim oiMateResult As iMateResult = ass.ComponentDefinition.iMateResults.AddByiMateAndEntity(imdp , oface)
```

#### Code Block 7

```vb
Dim oImate As Object

Dim oMateName As iMateDefinition

Dim oFace As face

....

Set oImate = oCompDef.iMateResults.AddByiMateAndEntity(oMateName.Name, oFace)
```

#### Code Block 8

```vb
Dim oImate As Object

Dim oMateName As iMateDefinition

Dim oFace As face

....

Set oImate = oCompDef.iMateResults.AddByiMateAndEntity(oMateName.Name, oFace)
```

#### Code Block 9

```vb
Dim oImate As Object

Dim oMateName As iMateDefinition

Dim oFace As face

....

Set oImate = oCompDef.iMateResults.AddByiMateAndEntity(oMateName.Name, oFace)
```

#### Code Block 10

```vb
Dim oImate As Object

Dim oMateName As iMateDefinition

Dim oFace As face

....

Set oImate = oCompDef.iMateResults.AddByiMateAndEntity(oMateName.Name, oFace)
```

#### Code Block 11

```vb
Dim oImate As Object

Dim oMateName As iMateDefinition

Dim oFace As face

....

Set oImate = oCompDef.iMateResults.AddByiMateAndEntity(oMateName.Name, oFace)
```

#### Code Block 12

```vb
Dim oImate As Object

Dim oMateName As iMateDefinition

Dim oFace As face

....

Set oImate = oCompDef.iMateResults.AddByiMateAndEntity(oMateName.Name, oFace)
```

---

### 62. Help with iLogic: Projecting Bend Lines from Unfolded Sheet Metal

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/help-with-ilogic-projecting-bend-lines-from-unfolded-sheet-metal/td-p/13736222#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/help-with-ilogic-projecting-bend-lines-from-unfolded-sheet-metal/td-p/13736222#messageview_0)

**Author:** vijay_balakrishnanEA333

**Date:** ‎07-22-2025
	
		
		11:09 PM

**Description:** Hi everyone,I'm working with a folded sheet metal part in Autodesk Inventor.My Need:I manually unfold the model and then run an iLogic rule that automatically creates a sketch on the top surface of the unfolded face.The goal is to identify the bend lines (i.e., the internal fold regions between two ...

**Code Snippets (1):**

#### Code Block 1

```vb
Sub Main()

    ' Setup
    Dim oDoc As PartDocument = ThisApplication.ActiveDocument
    Dim oCompDef As SheetMetalComponentDefinition = oDoc.ComponentDefinition
    Dim oTG As TransientGeometry = ThisApplication.TransientGeometry

    ' === STEP 1: Find the top unfolded flat face ===
    Dim topFace As Face = Nothing
    Dim maxArea As Double = 0

    For Each oFace As Face In oCompDef.SurfaceBodies(1).Faces
        If oFace.SurfaceType = SurfaceTypeEnum.kPlaneSurface Then
            Dim area As Double = oFace.Evaluator.Area
            If area > maxArea Then
                maxArea = area
                topFace = oFace
            End If
        End If
    Next

    If topFace Is Nothing Then
        MessageBox.Show("No flat top face found. Please unfold the part first.")
        Return
    End If

    ' === STEP 2: Create sketch on top face ===
    Dim oSketch As PlanarSketch = oCompDef.Sketches.Add(topFace)

    ' === STEP 3: Loop through edges and detect true bend lines ===
    For Each oEdge As Edge In oCompDef.SurfaceBodies(1).Edges

        If oEdge.GeometryType = CurveTypeEnum.kLineSegmentCurve Then

            If oEdge.Faces.Count = 2 Then

                Dim face1 As Face = oEdge.Faces(1)
                Dim face2 As Face = oEdge.Faces(2)

                ' Both must be planar
                If face1.SurfaceType = SurfaceTypeEnum.kPlaneSurface And face2.SurfaceType = SurfaceTypeEnum.kPlaneSurface Then

                    ' Exclude edge if it lies between top face and another (outer edge)
                    If face1.Equals(topFace) Or face2.Equals(topFace) Then
                        Continue For
                    End If

                    ' Check angle between faces
                    Dim normal1 As UnitVector = GetFaceNormal(face1)
                    Dim normal2 As UnitVector = GetFaceNormal(face2)

                    Dim dot As Double = normal1.DotProduct(normal2)

                    If Math.Abs(dot) < 0.98 Then
                        ' True bend line — project it
                        oSketch.AddByProjectingEntity(oEdge)
                    End If

                End If
            End If
        End If
    Next

    oSketch.Name = "TrueBendLines"
    MessageBox.Show("Bend lines (excluding outer edges) projected to sketch.")

End Sub

' === Helper: Safe face normal evaluator ===
Function GetFaceNormal(oFace As Face) As UnitVector
    Dim pt As Point = oFace.PointOnFace
    Dim oPointArr(2) As Double
    oPointArr(0) = pt.X
    oPointArr(1) = pt.Y
    oPointArr(2) = pt.Z

    Dim oNormalArr(2) As Double
    oFace.Evaluator.GetNormalAtPoint(oPointArr, oNormalArr)

    Dim oVec As Vector = ThisApplication.TransientGeometry.CreateVector(oNormalArr(0), oNormalArr(1), oNormalArr(2))
    Return oVec.AsUnitVector
End Function
```

#### Code Block 2

```vb
Sub Main()

    ' Setup
    Dim oDoc As PartDocument = ThisApplication.ActiveDocument
    Dim oCompDef As SheetMetalComponentDefinition = oDoc.ComponentDefinition
    Dim oTG As TransientGeometry = ThisApplication.TransientGeometry

    ' === STEP 1: Find the top unfolded flat face ===
    Dim topFace As Face = Nothing
    Dim maxArea As Double = 0

    For Each oFace As Face In oCompDef.SurfaceBodies(1).Faces
        If oFace.SurfaceType = SurfaceTypeEnum.kPlaneSurface Then
            Dim area As Double = oFace.Evaluator.Area
            If area > maxArea Then
                maxArea = area
                topFace = oFace
            End If
        End If
    Next

    If topFace Is Nothing Then
        MessageBox.Show("No flat top face found. Please unfold the part first.")
        Return
    End If

    ' === STEP 2: Create sketch on top face ===
    Dim oSketch As PlanarSketch = oCompDef.Sketches.Add(topFace)

    ' === STEP 3: Loop through edges and detect true bend lines ===
    For Each oEdge As Edge In oCompDef.SurfaceBodies(1).Edges

        If oEdge.GeometryType = CurveTypeEnum.kLineSegmentCurve Then

            If oEdge.Faces.Count = 2 Then

                Dim face1 As Face = oEdge.Faces(1)
                Dim face2 As Face = oEdge.Faces(2)

                ' Both must be planar
                If face1.SurfaceType = SurfaceTypeEnum.kPlaneSurface And face2.SurfaceType = SurfaceTypeEnum.kPlaneSurface Then

                    ' Exclude edge if it lies between top face and another (outer edge)
                    If face1.Equals(topFace) Or face2.Equals(topFace) Then
                        Continue For
                    End If

                    ' Check angle between faces
                    Dim normal1 As UnitVector = GetFaceNormal(face1)
                    Dim normal2 As UnitVector = GetFaceNormal(face2)

                    Dim dot As Double = normal1.DotProduct(normal2)

                    If Math.Abs(dot) < 0.98 Then
                        ' True bend line — project it
                        oSketch.AddByProjectingEntity(oEdge)
                    End If

                End If
            End If
        End If
    Next

    oSketch.Name = "TrueBendLines"
    MessageBox.Show("Bend lines (excluding outer edges) projected to sketch.")

End Sub

' === Helper: Safe face normal evaluator ===
Function GetFaceNormal(oFace As Face) As UnitVector
    Dim pt As Point = oFace.PointOnFace
    Dim oPointArr(2) As Double
    oPointArr(0) = pt.X
    oPointArr(1) = pt.Y
    oPointArr(2) = pt.Z

    Dim oNormalArr(2) As Double
    oFace.Evaluator.GetNormalAtPoint(oPointArr, oNormalArr)

    Dim oVec As Vector = ThisApplication.TransientGeometry.CreateVector(oNormalArr(0), oNormalArr(1), oNormalArr(2))
    Return oVec.AsUnitVector
End Function
```

---

### 63. How To Delete Occurrence Pattern Element

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-delete-occurrence-pattern-element/td-p/13797574](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-delete-occurrence-pattern-element/td-p/13797574)

**Author:** tim11_manhhieu

**Date:** ‎09-04-2025
	
		
		07:15 PM

**Description:** I want to delete the OIL OUTLET object as shown in the picture but when running the code, it gives an error at the line occPatternElem.occurrences.item(i).Delete2 (False)Need expert help or is there another way, iLogic or VBA is fine.  Option Explicit  Sub SuppressPatternOccurrencesByName()      Dim...

**Code Snippets (4):**

#### Code Block 1

```vb
Option Explicit

Sub SuppressPatternOccurrencesByName()

    Dim asmDoc As AssemblyDocument
    Dim asmDef As AssemblyComponentDefinition
    Dim occPattern As OccurrencePattern
    Dim targetName As String
    Dim i As Integer
    
    Dim rectPattern As RectangularOccurrencePattern
    Dim circPattern As CircularOccurrencePattern
    Dim compOcc As ComponentOccurrence
    Dim occPatternElem As OccurrencePatternElement
    
    targetName = "OIL OUTLET"
    
    Set asmDoc = ThisApplication.ActiveDocument
    If asmDoc.DocumentType <> kAssemblyDocumentObject Then
        MsgBox "Please open an Assembly file before running this macro!", vbExclamation
        Exit Sub
    End If
    
    Set asmDef = asmDoc.ComponentDefinition
    
    For Each occPattern In asmDef.OccurrencePatterns
        
        If TypeOf occPattern Is RectangularOccurrencePattern Then
            Set rectPattern = occPattern
            
            For Each occPatternElem In rectPattern.OccurrencePatternElements
                For i = occPatternElem.occurrences.count To 1 Step -1
                    If InStr(1, occPatternElem.occurrences.item(i).name, targetName, vbTextCompare) <> 0 Then
                        occPatternElem.occurrences.item(i).Delete2 (False)
                    End If
                Next i
            Next occPatternElem

        End If
        
    Next occPattern

End Sub
```

#### Code Block 2

```vb
Option Explicit

Sub SuppressPatternOccurrencesByName()

    Dim asmDoc As AssemblyDocument
    Dim asmDef As AssemblyComponentDefinition
    Dim occPattern As OccurrencePattern
    Dim targetName As String
    Dim i As Integer
    
    Dim rectPattern As RectangularOccurrencePattern
    Dim circPattern As CircularOccurrencePattern
    Dim compOcc As ComponentOccurrence
    Dim occPatternElem As OccurrencePatternElement
    
    targetName = "OIL OUTLET"
    
    Set asmDoc = ThisApplication.ActiveDocument
    If asmDoc.DocumentType <> kAssemblyDocumentObject Then
        MsgBox "Please open an Assembly file before running this macro!", vbExclamation
        Exit Sub
    End If
    
    Set asmDef = asmDoc.ComponentDefinition
    
    For Each occPattern In asmDef.OccurrencePatterns
        
        If TypeOf occPattern Is RectangularOccurrencePattern Then
            Set rectPattern = occPattern
            
            For Each occPatternElem In rectPattern.OccurrencePatternElements
                For i = occPatternElem.occurrences.count To 1 Step -1
                    If InStr(1, occPatternElem.occurrences.item(i).name, targetName, vbTextCompare) <> 0 Then
                        occPatternElem.occurrences.item(i).Delete2 (False)
                    End If
                Next i
            Next occPatternElem

        End If
        
    Next occPattern

End Sub
```

#### Code Block 3

```vb
Option Explicit

Sub SuppressPatternOccurrencesByName()

    Dim asmDoc As AssemblyDocument
    Dim asmDef As AssemblyComponentDefinition
    Dim occPattern As OccurrencePattern
    Dim targetName As String
    Dim i As Integer
    
    Dim rectPattern As RectangularOccurrencePattern
    Dim circPattern As CircularOccurrencePattern
    Dim compOcc As ComponentOccurrence
    Dim occPatternElem As OccurrencePatternElement
    
    targetName = "OIL OUTLET"
    
    Set asmDoc = ThisApplication.ActiveDocument
    If asmDoc.DocumentType <> kAssemblyDocumentObject Then
        MsgBox "Please open an Assembly file before running this macro!", vbExclamation
        Exit Sub
    End If
    
    Set asmDef = asmDoc.ComponentDefinition
    
    For Each occPattern In asmDef.OccurrencePatterns
        
        If TypeOf occPattern Is RectangularOccurrencePattern Then
            Set rectPattern = occPattern
            
            For Each occPatternElem In rectPattern.OccurrencePatternElements
                For i = occPatternElem.occurrences.count To 1 Step -1
                    If InStr(1, occPatternElem.occurrences.item(i).name, targetName, vbTextCompare) <> 0 Then
                        occPatternElem.occurrences.item(i).Delete2 (False)
                    End If
                Next i
            Next occPatternElem

        End If
        
    Next occPattern

End Sub
```

#### Code Block 4

```vb
Option Explicit

Sub SuppressPatternOccurrencesByName()

    Dim asmDoc As AssemblyDocument
    Dim asmDef As AssemblyComponentDefinition
    Dim occPattern As OccurrencePattern
    Dim targetName As String
    Dim i As Integer
    
    Dim rectPattern As RectangularOccurrencePattern
    Dim circPattern As CircularOccurrencePattern
    Dim compOcc As ComponentOccurrence
    Dim occPatternElem As OccurrencePatternElement
    
    targetName = "OIL OUTLET"
    
    Set asmDoc = ThisApplication.ActiveDocument
    If asmDoc.DocumentType <> kAssemblyDocumentObject Then
        MsgBox "Please open an Assembly file before running this macro!", vbExclamation
        Exit Sub
    End If
    
    Set asmDef = asmDoc.ComponentDefinition
    
    For Each occPattern In asmDef.OccurrencePatterns
        
        If TypeOf occPattern Is RectangularOccurrencePattern Then
            Set rectPattern = occPattern
            
            For Each occPatternElem In rectPattern.OccurrencePatternElements
                For i = occPatternElem.occurrences.count To 1 Step -1
                    If InStr(1, occPatternElem.occurrences.item(i).name, targetName, vbTextCompare) <> 0 Then
                        occPatternElem.occurrences.item(i).Delete2 (False)
                    End If
                Next i
            Next occPatternElem

        End If
        
    Next occPattern

End Sub
```

#### Code Block 5

```vb
Sub main()

    Dim asmDoc As AssemblyDocument = ThisApplication.ActiveDocument
    Dim asmDef As AssemblyComponentDefinition = asmDoc.ComponentDefinition
    Dim occPattern As OccurrencePattern
    Dim targetName As String
    
    Dim rectPattern As RectangularOccurrencePattern
    Dim circPattern As CircularOccurrencePattern
    Dim compOcc As ComponentOccurrence
    Dim occPatternElem As OccurrencePatternElement
    
    targetName = "OIL OUTLET"
    
    If asmDoc.DocumentType <> kAssemblyDocumentObject Then
        MsgBox("Please open an Assembly file before running this macro!", vbExclamation)
        Exit Sub
    End If
	
    For Each occPattern In asmDef.OccurrencePatterns
        
        If TypeOf occPattern Is RectangularOccurrencePattern Then
            rectPattern = occPattern
			Dim i As Integer = 0
			For k As Integer = 1 To rectPattern.ParentComponents.Count
				If rectPattern.ParentComponents(k).Name.Contains(targetName) Then
					i = k
					Exit For
				End If
			Next k
			If i = 0 Then Continue For
			Dim oObjs As ObjectCollection
			oObjs = ThisApplication.TransientObjects.CreateObjectCollection(rectPattern.ParentComponents)
            oObjs.Remove(i)
			rectPattern.ParentComponents = oObjs

        End If
        
    Next occPattern

End Sub
```

#### Code Block 6

```vb
Sub main()

    Dim asmDoc As AssemblyDocument = ThisApplication.ActiveDocument
    Dim asmDef As AssemblyComponentDefinition = asmDoc.ComponentDefinition
    Dim occPattern As OccurrencePattern
    Dim targetName As String
    
    Dim rectPattern As RectangularOccurrencePattern
    Dim circPattern As CircularOccurrencePattern
    Dim compOcc As ComponentOccurrence
    Dim occPatternElem As OccurrencePatternElement
    
    targetName = "OIL OUTLET"
    
    If asmDoc.DocumentType <> kAssemblyDocumentObject Then
        MsgBox("Please open an Assembly file before running this macro!", vbExclamation)
        Exit Sub
    End If
	
    For Each occPattern In asmDef.OccurrencePatterns
        
        If TypeOf occPattern Is RectangularOccurrencePattern Then
            rectPattern = occPattern
			Dim i As Integer = 0
			For k As Integer = 1 To rectPattern.ParentComponents.Count
				If rectPattern.ParentComponents(k).Name.Contains(targetName) Then
					i = k
					Exit For
				End If
			Next k
			If i = 0 Then Continue For
			Dim oObjs As ObjectCollection
			oObjs = ThisApplication.TransientObjects.CreateObjectCollection(rectPattern.ParentComponents)
            oObjs.Remove(i)
			rectPattern.ParentComponents = oObjs

        End If
        
    Next occPattern

End Sub
```

#### Code Block 7

```vb
Sub main()

    Dim asmDoc As AssemblyDocument = ThisApplication.ActiveDocument
    Dim asmDef As AssemblyComponentDefinition = asmDoc.ComponentDefinition
    Dim occPattern As OccurrencePattern
    Dim targetName As String
    
    Dim rectPattern As RectangularOccurrencePattern
    Dim circPattern As CircularOccurrencePattern
    Dim compOcc As ComponentOccurrence
    Dim occPatternElem As OccurrencePatternElement
    
    targetName = "OIL OUTLET"
    
    If asmDoc.DocumentType <> kAssemblyDocumentObject Then
        MsgBox("Please open an Assembly file before running this macro!", vbExclamation)
        Exit Sub
    End If
	
    For Each occPattern In asmDef.OccurrencePatterns
        
        If TypeOf occPattern Is RectangularOccurrencePattern Then
            rectPattern = occPattern
			Dim i As Integer = 0
			For k As Integer = 1 To rectPattern.ParentComponents.Count
				If rectPattern.ParentComponents(k).Name.Contains(targetName) Then
					i = k
					Exit For
				End If
			Next k
			If i = 0 Then Continue For
			Dim oObjs As ObjectCollection
			oObjs = ThisApplication.TransientObjects.CreateObjectCollection(rectPattern.ParentComponents)
            oObjs.Remove(i)
			rectPattern.ParentComponents = oObjs

        End If
        
    Next occPattern

End Sub
```

#### Code Block 8

```vb
Sub main()

    Dim asmDoc As AssemblyDocument = ThisApplication.ActiveDocument
    Dim asmDef As AssemblyComponentDefinition = asmDoc.ComponentDefinition
    Dim occPattern As OccurrencePattern
    Dim targetName As String
    
    Dim rectPattern As RectangularOccurrencePattern
    Dim circPattern As CircularOccurrencePattern
    Dim compOcc As ComponentOccurrence
    Dim occPatternElem As OccurrencePatternElement
    
    targetName = "OIL OUTLET"
    
    If asmDoc.DocumentType <> kAssemblyDocumentObject Then
        MsgBox("Please open an Assembly file before running this macro!", vbExclamation)
        Exit Sub
    End If
	
    For Each occPattern In asmDef.OccurrencePatterns
        
        If TypeOf occPattern Is RectangularOccurrencePattern Then
            rectPattern = occPattern
			Dim i As Integer = 0
			For k As Integer = 1 To rectPattern.ParentComponents.Count
				If rectPattern.ParentComponents(k).Name.Contains(targetName) Then
					i = k
					Exit For
				End If
			Next k
			If i = 0 Then Continue For
			Dim oObjs As ObjectCollection
			oObjs = ThisApplication.TransientObjects.CreateObjectCollection(rectPattern.ParentComponents)
            oObjs.Remove(i)
			rectPattern.ParentComponents = oObjs

        End If
        
    Next occPattern

End Sub
```

---

### 64. How can I annotate these dimensions in a drawing, using iLogic?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-can-i-annotate-these-dimensions-in-a-drawing-using-ilogic/td-p/13738809#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/how-can-i-annotate-these-dimensions-in-a-drawing-using-ilogic/td-p/13738809#messageview_0)

**Author:** ricardo_cano2

**Date:** ‎07-24-2025
	
		
		10:01 AM

**Description:** Hi all, hopefully I'm not asking something that has been answered dozens of time before I'm trying to create an iLogic rule for drawings.Where annotations are automatically added in an organized manner, and where holes exist, the annotation is added to the dimension.  Public Sub Main()   Dim oDrawDo...

**Code Snippets (1):**

#### Code Block 1

```vb
Public Sub Main()
  Dim oDrawDoc As DrawingDocument
  oDrawDoc = ThisApplication.ActiveDocument

  Dim oActiveSheet As Sheet
  oActiveSheet = oDrawDoc.ActiveSheet

  Dim oDrawingCurveSegment As DrawingCurveSegment
  oDrawingCurveSegment = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Seleccionar la línea del origen")

  Dim oDrawingCurve As DrawingCurve
  oDrawingCurve = oDrawingCurveSegment.Parent

  If Not oDrawingCurve.CurveType = kLineSegmentCurve Then
    MsgBox("Esta no es una línea Ingeniero")
    Exit Sub
  End If

  Dim oDimIntent As GeometryIntent
  oDimIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kEndPointIntent)

  Dim oDrawingView As DrawingView
  oDrawingView = oDrawingCurve.Parent

  If Not oDrawingView.HasOriginIndicator Then
    oDrawingView.CreateOriginIndicator(oDimIntent)
  End If

  Dim oOrdinateDimensions As OrdinateDimensions
  oOrdinateDimensions = oActiveSheet.DrawingDimensions.OrdinateDimensions

  Dim oTextOrigin As Point2d
  Dim DimType As DimensionTypeEnum
  DimType = kHorizontalDimensionType

  Dim TG As TransientGeometry
  TG = ThisApplication.TransientGeometry

  oTextOrigin = TG.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.StartPoint.Y)
  Call oOrdinateDimensions.Add(oDimIntent, oTextOrigin, DimType)

  Dim oIntent As GeometryIntent
  Dim textPt As Point2d

  For Each oDrawingCurve In oDrawingView.DrawingCurves
    Select Case oDrawingCurve.CurveType
      Case kCircleCurve
        oIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kCenterPointIntent)
        textPt = TG.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.CenterPoint.Y)

      Case kLineSegmentCurve
        oIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kStartPointIntent)
        textPt = TG.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.StartPoint.Y)

      Case kCircularArcCurve
        oIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kEndPointIntent)
        textPt = TG.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.EndPoint.Y)

      Case Else
        oIntent = Nothing
    End Select

    If Not oIntent Is Nothing Then
      Call oOrdinateDimensions.Add(oIntent, textPt, DimType)
    End If
  Next

  oDrawingCurveSegment = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select end line to complete ordinate dimension")
  oDrawingCurve = oDrawingCurveSegment.Parent

  If Not oDrawingCurve.CurveType = kLineSegmentCurve Then
    MsgBox("A linear curve should be selected for this sample.")
    Exit Sub
  End If

  oDimIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kEndPointIntent)
  oTextOrigin = TG.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.StartPoint.Y)
  Call oOrdinateDimensions.Add(oDimIntent, oTextOrigin, DimType)

End Sub
```

#### Code Block 2

```vb
Public Sub Main()
  Dim oDrawDoc As DrawingDocument
  oDrawDoc = ThisApplication.ActiveDocument

  Dim oActiveSheet As Sheet
  oActiveSheet = oDrawDoc.ActiveSheet

  Dim oDrawingCurveSegment As DrawingCurveSegment
  oDrawingCurveSegment = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Seleccionar la línea del origen")

  Dim oDrawingCurve As DrawingCurve
  oDrawingCurve = oDrawingCurveSegment.Parent

  If Not oDrawingCurve.CurveType = kLineSegmentCurve Then
    MsgBox("Esta no es una línea Ingeniero")
    Exit Sub
  End If

  Dim oDimIntent As GeometryIntent
  oDimIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kEndPointIntent)

  Dim oDrawingView As DrawingView
  oDrawingView = oDrawingCurve.Parent

  If Not oDrawingView.HasOriginIndicator Then
    oDrawingView.CreateOriginIndicator(oDimIntent)
  End If

  Dim oOrdinateDimensions As OrdinateDimensions
  oOrdinateDimensions = oActiveSheet.DrawingDimensions.OrdinateDimensions

  Dim oTextOrigin As Point2d
  Dim DimType As DimensionTypeEnum
  DimType = kHorizontalDimensionType

  Dim TG As TransientGeometry
  TG = ThisApplication.TransientGeometry

  oTextOrigin = TG.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.StartPoint.Y)
  Call oOrdinateDimensions.Add(oDimIntent, oTextOrigin, DimType)

  Dim oIntent As GeometryIntent
  Dim textPt As Point2d

  For Each oDrawingCurve In oDrawingView.DrawingCurves
    Select Case oDrawingCurve.CurveType
      Case kCircleCurve
        oIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kCenterPointIntent)
        textPt = TG.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.CenterPoint.Y)

      Case kLineSegmentCurve
        oIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kStartPointIntent)
        textPt = TG.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.StartPoint.Y)

      Case kCircularArcCurve
        oIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kEndPointIntent)
        textPt = TG.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.EndPoint.Y)

      Case Else
        oIntent = Nothing
    End Select

    If Not oIntent Is Nothing Then
      Call oOrdinateDimensions.Add(oIntent, textPt, DimType)
    End If
  Next

  oDrawingCurveSegment = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select end line to complete ordinate dimension")
  oDrawingCurve = oDrawingCurveSegment.Parent

  If Not oDrawingCurve.CurveType = kLineSegmentCurve Then
    MsgBox("A linear curve should be selected for this sample.")
    Exit Sub
  End If

  oDimIntent = oActiveSheet.CreateGeometryIntent(oDrawingCurve, kEndPointIntent)
  oTextOrigin = TG.CreatePoint2d(oDrawingView.Left + 2, oDrawingCurve.StartPoint.Y)
  Call oOrdinateDimensions.Add(oDimIntent, oTextOrigin, DimType)

End Sub
```

---

### 65. How get Center point in iLogic sketch?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-get-center-point-in-ilogic-sketch/td-p/13759799#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/how-get-center-point-in-ilogic-sketch/td-p/13759799#messageview_0)

**Author:** frantisek_kochan

**Date:** ‎08-08-2025
	
		
		05:44 AM

**Description:** Hi,I want to make fully constraint sketch in ipart. So manualy there is predrawn Central point, but if I use "oCompDef.Sketches.Add(oCompDef.WorkPlanes(3))" there is none. So I trying to find way to get him or make him to fully constraint sketch. sub createSkeletonBox() 	'===============Parameters==...

**Code Snippets (6):**

#### Code Block 1

```vb
Dim CenterPoint = oSketch.AddByProjectingEntity(oCompDef.WorkPoints(1))
```

#### Code Block 2

```vb
Dim CenterPoint = oSketch.AddByProjectingEntity(oCompDef.WorkPoints(1))
```

#### Code Block 3

```vb
Dim CenterPoint = oSketch.AddByProjectingEntity(oCompDef.WorkPoints(1))
```

#### Code Block 4

```vb
Dim CenterPoint = oSketch.AddByProjectingEntity(oCompDef.WorkPoints(1))
```

#### Code Block 5

```vb
Dim CenterPoint = points.Add(oSketch.ModelToSketchSpace(oSketch.OriginPointGeometry), False) '??????????????
constr.AddGround(CenterPoint)
```

#### Code Block 6

```vb
Dim CenterPoint = points.Add(oSketch.ModelToSketchSpace(oSketch.OriginPointGeometry), False) '??????????????
constr.AddGround(CenterPoint)
```

#### Code Block 7

```vb
Dim CenterPoint = points.Add(oSketch.ModelToSketchSpace(oSketch.OriginPointGeometry), False) '??????????????
constr.AddGround(CenterPoint)
```

#### Code Block 8

```vb
Dim CenterPoint = points.Add(oSketch.ModelToSketchSpace(oSketch.OriginPointGeometry), False) '??????????????
constr.AddGround(CenterPoint)
```

#### Code Block 9

```vb
sub createSkeletonBox()
	'===============Parameters===============
	Dim Vyska = createUserParameter("Vyska", 600, "mm").Value
	Dim Sirka = createUserParameter("Sirka", 450, "mm").Value
	Dim Hloubka = createUserParameter("Hloubka", 400, "mm").Value

	Dim dX = Sirka/2
	Dim dY = Hloubka

	'===============Definitions===============
	Dim oCompDef as PartComponentDefinition
	oCompDef = ThisDoc.Document.ComponentDefinition

	Dim tg As TransientGeometry
	tg = ThisApplication.TransientGeometry

	'===============Work===============

	'===Create skeletonSketch===
	Dim oSketch As PlanarSketch
	oSketch = oCompDef.Sketches.Add(oCompDef.WorkPlanes(3))
	oSketch.name = "skeletonSketch"
	
	Dim lines As Inventor.SketchLines = oSketch.SketchLines
	Dim points As Inventor.SketchPoints = oSketch.SketchPoints
	Dim constr As Inventor.GeometricConstraints = oSketch.GeometricConstraints

	Dim CenterPoint = points.Add(tg.CreatePoint2d(0, 0), False) '??????????????
	'===Points===
	Dim point_array(3) As Inventor.SketchPoint
		point_array(0) = points.Add(tg.CreatePoint2d(0, 0), False)
		point_array(1) = points.Add(tg.CreatePoint2d(4, 0), False)
		point_array(2) = points.Add(tg.CreatePoint2d(4, 4), False)
		point_array(3) = points.Add(tg.CreatePoint2d(0, 4), False)

	'===Draw skeletonSketch===
		Dim line0 = lines.AddByTwoPoints(point_array(0), point_array(1))
		Dim line1 = lines.AddByTwoPoints(point_array(1), point_array(2))
		Dim line2 = lines.AddByTwoPoints(point_array(2), point_array(3))
		Dim line3 = lines.AddByTwoPoints(point_array(3), point_array(0))

	'===Constraints===
	constr.AddHorizontal(line0)
	constr.AddHorizontal(line2)
	constr.AddVertical(line1)
	constr.AddVertical(line3)

	'===Dimensions===
	oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), point_array(1), DimensionOrientationEnum.kHorizontalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = "Sirka"
	oSketch.DimensionConstraints.AddTwoPointDistance(point_array(1), point_array(2), DimensionOrientationEnum.kVerticalDim, tg.CreatePoint2d(-2, 0)).Parameter.Expression = "Hloubka"
	'oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), CenterPoint, DimensionOrientationEnum.kHorizontalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = dX
	'oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), CenterPoint, DimensionOrientationEnum.kVerticalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = dY
	
	'===Create a profile===
	Dim oProfile As Profile
    oProfile = oSketch.Profiles.AddForSolid

	'===Create a base extrusion===
	'Dim oExtrude As ExtrudeFeature
	'oExtrude = oCompDef.Features.ExtrudeFeatures.AddByDistanceExtent(oProfile, "Vyska", kPositiveExtentDirection, kNewBodyOperation)
	'oExtrude.SurfaceBodies(1).Name = "@Skeleton"
	'oExtrude.name = "skeletonExtrude"

end sub
```

#### Code Block 10

```vb
sub createSkeletonBox()
	'===============Parameters===============
	Dim Vyska = createUserParameter("Vyska", 600, "mm").Value
	Dim Sirka = createUserParameter("Sirka", 450, "mm").Value
	Dim Hloubka = createUserParameter("Hloubka", 400, "mm").Value

	Dim dX = Sirka/2
	Dim dY = Hloubka

	'===============Definitions===============
	Dim oCompDef as PartComponentDefinition
	oCompDef = ThisDoc.Document.ComponentDefinition

	Dim tg As TransientGeometry
	tg = ThisApplication.TransientGeometry

	'===============Work===============

	'===Create skeletonSketch===
	Dim oSketch As PlanarSketch
	oSketch = oCompDef.Sketches.Add(oCompDef.WorkPlanes(3))
	oSketch.name = "skeletonSketch"
	
	Dim lines As Inventor.SketchLines = oSketch.SketchLines
	Dim points As Inventor.SketchPoints = oSketch.SketchPoints
	Dim constr As Inventor.GeometricConstraints = oSketch.GeometricConstraints

	Dim CenterPoint = points.Add(tg.CreatePoint2d(0, 0), False) '??????????????
	'===Points===
	Dim point_array(3) As Inventor.SketchPoint
		point_array(0) = points.Add(tg.CreatePoint2d(0, 0), False)
		point_array(1) = points.Add(tg.CreatePoint2d(4, 0), False)
		point_array(2) = points.Add(tg.CreatePoint2d(4, 4), False)
		point_array(3) = points.Add(tg.CreatePoint2d(0, 4), False)

	'===Draw skeletonSketch===
		Dim line0 = lines.AddByTwoPoints(point_array(0), point_array(1))
		Dim line1 = lines.AddByTwoPoints(point_array(1), point_array(2))
		Dim line2 = lines.AddByTwoPoints(point_array(2), point_array(3))
		Dim line3 = lines.AddByTwoPoints(point_array(3), point_array(0))

	'===Constraints===
	constr.AddHorizontal(line0)
	constr.AddHorizontal(line2)
	constr.AddVertical(line1)
	constr.AddVertical(line3)

	'===Dimensions===
	oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), point_array(1), DimensionOrientationEnum.kHorizontalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = "Sirka"
	oSketch.DimensionConstraints.AddTwoPointDistance(point_array(1), point_array(2), DimensionOrientationEnum.kVerticalDim, tg.CreatePoint2d(-2, 0)).Parameter.Expression = "Hloubka"
	'oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), CenterPoint, DimensionOrientationEnum.kHorizontalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = dX
	'oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), CenterPoint, DimensionOrientationEnum.kVerticalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = dY
	
	'===Create a profile===
	Dim oProfile As Profile
    oProfile = oSketch.Profiles.AddForSolid

	'===Create a base extrusion===
	'Dim oExtrude As ExtrudeFeature
	'oExtrude = oCompDef.Features.ExtrudeFeatures.AddByDistanceExtent(oProfile, "Vyska", kPositiveExtentDirection, kNewBodyOperation)
	'oExtrude.SurfaceBodies(1).Name = "@Skeleton"
	'oExtrude.name = "skeletonExtrude"

end sub
```

#### Code Block 11

```vb
sub createSkeletonBox()
	'===============Parameters===============
	Dim Vyska = createUserParameter("Vyska", 600, "mm").Value
	Dim Sirka = createUserParameter("Sirka", 450, "mm").Value
	Dim Hloubka = createUserParameter("Hloubka", 400, "mm").Value

	Dim dX = Sirka/2
	Dim dY = Hloubka

	'===============Definitions===============
	Dim oCompDef as PartComponentDefinition
	oCompDef = ThisDoc.Document.ComponentDefinition

	Dim tg As TransientGeometry
	tg = ThisApplication.TransientGeometry

	'===============Work===============

	'===Create skeletonSketch===
	Dim oSketch As PlanarSketch
	oSketch = oCompDef.Sketches.Add(oCompDef.WorkPlanes(3))
	oSketch.name = "skeletonSketch"
	
	Dim lines As Inventor.SketchLines = oSketch.SketchLines
	Dim points As Inventor.SketchPoints = oSketch.SketchPoints
	Dim constr As Inventor.GeometricConstraints = oSketch.GeometricConstraints

	Dim CenterPoint = points.Add(tg.CreatePoint2d(0, 0), False) '??????????????
	'===Points===
	Dim point_array(3) As Inventor.SketchPoint
		point_array(0) = points.Add(tg.CreatePoint2d(0, 0), False)
		point_array(1) = points.Add(tg.CreatePoint2d(4, 0), False)
		point_array(2) = points.Add(tg.CreatePoint2d(4, 4), False)
		point_array(3) = points.Add(tg.CreatePoint2d(0, 4), False)

	'===Draw skeletonSketch===
		Dim line0 = lines.AddByTwoPoints(point_array(0), point_array(1))
		Dim line1 = lines.AddByTwoPoints(point_array(1), point_array(2))
		Dim line2 = lines.AddByTwoPoints(point_array(2), point_array(3))
		Dim line3 = lines.AddByTwoPoints(point_array(3), point_array(0))

	'===Constraints===
	constr.AddHorizontal(line0)
	constr.AddHorizontal(line2)
	constr.AddVertical(line1)
	constr.AddVertical(line3)

	'===Dimensions===
	oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), point_array(1), DimensionOrientationEnum.kHorizontalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = "Sirka"
	oSketch.DimensionConstraints.AddTwoPointDistance(point_array(1), point_array(2), DimensionOrientationEnum.kVerticalDim, tg.CreatePoint2d(-2, 0)).Parameter.Expression = "Hloubka"
	'oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), CenterPoint, DimensionOrientationEnum.kHorizontalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = dX
	'oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), CenterPoint, DimensionOrientationEnum.kVerticalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = dY
	
	'===Create a profile===
	Dim oProfile As Profile
    oProfile = oSketch.Profiles.AddForSolid

	'===Create a base extrusion===
	'Dim oExtrude As ExtrudeFeature
	'oExtrude = oCompDef.Features.ExtrudeFeatures.AddByDistanceExtent(oProfile, "Vyska", kPositiveExtentDirection, kNewBodyOperation)
	'oExtrude.SurfaceBodies(1).Name = "@Skeleton"
	'oExtrude.name = "skeletonExtrude"

end sub
```

#### Code Block 12

```vb
sub createSkeletonBox()
	'===============Parameters===============
	Dim Vyska = createUserParameter("Vyska", 600, "mm").Value
	Dim Sirka = createUserParameter("Sirka", 450, "mm").Value
	Dim Hloubka = createUserParameter("Hloubka", 400, "mm").Value

	Dim dX = Sirka/2
	Dim dY = Hloubka

	'===============Definitions===============
	Dim oCompDef as PartComponentDefinition
	oCompDef = ThisDoc.Document.ComponentDefinition

	Dim tg As TransientGeometry
	tg = ThisApplication.TransientGeometry

	'===============Work===============

	'===Create skeletonSketch===
	Dim oSketch As PlanarSketch
	oSketch = oCompDef.Sketches.Add(oCompDef.WorkPlanes(3))
	oSketch.name = "skeletonSketch"
	
	Dim lines As Inventor.SketchLines = oSketch.SketchLines
	Dim points As Inventor.SketchPoints = oSketch.SketchPoints
	Dim constr As Inventor.GeometricConstraints = oSketch.GeometricConstraints

	Dim CenterPoint = points.Add(tg.CreatePoint2d(0, 0), False) '??????????????
	'===Points===
	Dim point_array(3) As Inventor.SketchPoint
		point_array(0) = points.Add(tg.CreatePoint2d(0, 0), False)
		point_array(1) = points.Add(tg.CreatePoint2d(4, 0), False)
		point_array(2) = points.Add(tg.CreatePoint2d(4, 4), False)
		point_array(3) = points.Add(tg.CreatePoint2d(0, 4), False)

	'===Draw skeletonSketch===
		Dim line0 = lines.AddByTwoPoints(point_array(0), point_array(1))
		Dim line1 = lines.AddByTwoPoints(point_array(1), point_array(2))
		Dim line2 = lines.AddByTwoPoints(point_array(2), point_array(3))
		Dim line3 = lines.AddByTwoPoints(point_array(3), point_array(0))

	'===Constraints===
	constr.AddHorizontal(line0)
	constr.AddHorizontal(line2)
	constr.AddVertical(line1)
	constr.AddVertical(line3)

	'===Dimensions===
	oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), point_array(1), DimensionOrientationEnum.kHorizontalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = "Sirka"
	oSketch.DimensionConstraints.AddTwoPointDistance(point_array(1), point_array(2), DimensionOrientationEnum.kVerticalDim, tg.CreatePoint2d(-2, 0)).Parameter.Expression = "Hloubka"
	'oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), CenterPoint, DimensionOrientationEnum.kHorizontalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = dX
	'oSketch.DimensionConstraints.AddTwoPointDistance(point_array(0), CenterPoint, DimensionOrientationEnum.kVerticalDim, tg.CreatePoint2d(0, -2)).Parameter.Expression = dY
	
	'===Create a profile===
	Dim oProfile As Profile
    oProfile = oSketch.Profiles.AddForSolid

	'===Create a base extrusion===
	'Dim oExtrude As ExtrudeFeature
	'oExtrude = oCompDef.Features.ExtrudeFeatures.AddByDistanceExtent(oProfile, "Vyska", kPositiveExtentDirection, kNewBodyOperation)
	'oExtrude.SurfaceBodies(1).Name = "@Skeleton"
	'oExtrude.name = "skeletonExtrude"

end sub
```

---

### 66. How to &quot;Mark&quot; the part number and revision on a part using iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-quot-mark-quot-the-part-number-and-revision-on-a-part/td-p/13763490#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-quot-mark-quot-the-part-number-and-revision-on-a-part/td-p/13763490#messageview_0)

**Author:** roy7BB24

**Date:** ‎08-11-2025
	
		
		09:50 PM

**Description:** Hi All, I'm working on a script to try to mark a part I've drawn with both its part number and revision, ideally using the mark tool. The intended operation is I'll create a sketch on the face of the part I want to make, and create a point and line that is the center/orientation of the text. I'll th...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim markText = iProperties.Value("Project", "Part Number") & " - " & iProperties.Value("Project", "Revision Number")
```

#### Code Block 2

```vb
Dim markText = iProperties.Value("Project", "Part Number") & " - " & iProperties.Value("Project", "Revision Number")
```

#### Code Block 3

```vb
Dim markText = iProperties.Value("Project", "Part Number") & " - " & iProperties.Value("Project", "Revision Number")
```

#### Code Block 4

```vb
Dim markText = iProperties.Value("Project", "Part Number") & " - " & iProperties.Value("Project", "Revision Number")
```

---

### 67. How to Check if Model State Exists Before Setting It in iLogic?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-check-if-model-state-exists-before-setting-it-in-ilogic/td-p/13783575#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-check-if-model-state-exists-before-setting-it-in-ilogic/td-p/13783575#messageview_0)

**Author:** philippe_abellanosa

**Date:** ‎08-26-2025
	
		
		08:17 AM

**Description:** Hi everyone,I'm working with drawing views that reference assemblies with multiple model states. I'm working on an iLogic rule that sets different model states on drawing views based on user input. My current code attempts to set a model state like this: ModStateName = "4-5-1548-05" ActiveSheet.View...

**Code Snippets (6):**

#### Code Block 1

```vb
Function DoesModelStateExist() as boolean
Dim oDoc as partdocument = Thisapplication.activeDocument

Dim pComp as partcomponentDefinition = odoc.componentDefinition

Dim DocModelStates as modelstates = PartComp.Modelstates

For each iModelstate as modelstate in Docmodelstates
    If ImodelState.name.contains("Name") 
      Return true
    else if modelstate.Name.contains("Name2") 
      return true
    else
     Return false
    end if 
next
End function
```

#### Code Block 2

```vb
Function DoesModelStateExist() as boolean
Dim oDoc as partdocument = Thisapplication.activeDocument

Dim pComp as partcomponentDefinition = odoc.componentDefinition

Dim DocModelStates as modelstates = PartComp.Modelstates

For each iModelstate as modelstate in Docmodelstates
    If ImodelState.name.contains("Name") 
      Return true
    else if modelstate.Name.contains("Name2") 
      return true
    else
     Return false
    end if 
next
End function
```

#### Code Block 3

```vb
Function DoesModelStateExist() as boolean
Dim oDoc as partdocument = Thisapplication.activeDocument

Dim pComp as partcomponentDefinition = odoc.componentDefinition

Dim DocModelStates as modelstates = PartComp.Modelstates

For each iModelstate as modelstate in Docmodelstates
    If ImodelState.name.contains("Name") 
      Return true
    else if modelstate.Name.contains("Name2") 
      return true
    else
     Return false
    end if 
next
End function
```

#### Code Block 4

```vb
Function DoesModelStateExist() as boolean
Dim oDoc as partdocument = Thisapplication.activeDocument

Dim pComp as partcomponentDefinition = odoc.componentDefinition

Dim DocModelStates as modelstates = PartComp.Modelstates

For each iModelstate as modelstate in Docmodelstates
    If ImodelState.name.contains("Name") 
      Return true
    else if modelstate.Name.contains("Name2") 
      return true
    else
     Return false
    end if 
next
End function
```

#### Code Block 5

```vb
If ModelStateExists(ModStateName & "'") Then    ActiveSheet.View("VIEW15").View.Suppressed = False
    ActiveSheet.View("VIEW15").NativeEntity.SetActiveModelState(ModStateName & "'")
Else
 ActiveSheet.View("VIEW15").View.Suppressed = TrueEnd If
```

#### Code Block 6

```vb
If ModelStateExists(ModStateName & "'") Then    ActiveSheet.View("VIEW15").View.Suppressed = False
    ActiveSheet.View("VIEW15").NativeEntity.SetActiveModelState(ModStateName & "'")
Else
 ActiveSheet.View("VIEW15").View.Suppressed = TrueEnd If
```

#### Code Block 7

```vb
MSName = "4-5-1548-05"
oDrwView = ActiveSheet.View("VIEW10")
Dim oModelStates As ModelStates = oDrwView.ModelFactoryDocument.ComponentDefinition.ModelStates
Dim MSfound As Boolean = False
For Each oModelState As ModelState In oModelStates
	If oModelState.Name.ToUpper = MSName.ToUpper Then
		MSfound = True
		Exit For
	End If
Next
If MSfound Then
	oDrwView.NativeEntity.SetActiveModelState(MSName)
Else
	MsgBox("Modelstate not found: " & MSName,,"Error ModelState")
End If
```

#### Code Block 8

```vb
MSName = "4-5-1548-05"
oDrwView = ActiveSheet.View("VIEW10")
Dim oModelStates As ModelStates = oDrwView.ModelFactoryDocument.ComponentDefinition.ModelStates
Dim MSfound As Boolean = False
For Each oModelState As ModelState In oModelStates
	If oModelState.Name.ToUpper = MSName.ToUpper Then
		MSfound = True
		Exit For
	End If
Next
If MSfound Then
	oDrwView.NativeEntity.SetActiveModelState(MSName)
Else
	MsgBox("Modelstate not found: " & MSName,,"Error ModelState")
End If
```

#### Code Block 9

```vb
ModStateName = "4-5-1548-05"
ActiveSheet.View("VIEW15").NativeEntity.SetActiveModelState(ModStateName & "'")ActiveSheet.View("VIEW10").NativeEntity.SetActiveModelState(ModStateName)
```

#### Code Block 10

```vb
ModStateName = "4-5-1548-05"
ActiveSheet.View("VIEW15").NativeEntity.SetActiveModelState(ModStateName & "'")ActiveSheet.View("VIEW10").NativeEntity.SetActiveModelState(ModStateName)
```

#### Code Block 11

```vb
iLogicForm.Show("Form 1") '
ModStateName = DWG
ModStateName2 = DWG & "'"
oDrwView = ActiveSheet.View("VIEW15")
Dim oModelStates As ModelStates = oDrwView.ModelFactoryDocument.ComponentDefinition.ModelStates
Dim MSfound As Boolean = False
For Each oModelState As ModelState In oModelStates
	If oModelState.Name.ToUpper = ModStateName2.ToUpper Then
		MSfound = True
		Exit For
	End If
Next

If MSfound Then
	ActiveSheet.View("VIEW15").View.Suppressed = False
	ActiveSheet.View("VIEW15").NativeEntity.SetActiveModelState(ModStateName2)
Else
	ActiveSheet.View("VIEW15").View.Suppressed = True
	MsgBox("Modelstate not found: " & MSName,,"Error ModelState")
End If

ActiveSheet.View("VIEW10").NativeEntity.SetActiveModelState(ModStateName)
```

#### Code Block 12

```vb
iLogicForm.Show("Form 1") '
ModStateName = DWG
ModStateName2 = DWG & "'"
oDrwView = ActiveSheet.View("VIEW15")
Dim oModelStates As ModelStates = oDrwView.ModelFactoryDocument.ComponentDefinition.ModelStates
Dim MSfound As Boolean = False
For Each oModelState As ModelState In oModelStates
	If oModelState.Name.ToUpper = ModStateName2.ToUpper Then
		MSfound = True
		Exit For
	End If
Next

If MSfound Then
	ActiveSheet.View("VIEW15").View.Suppressed = False
	ActiveSheet.View("VIEW15").NativeEntity.SetActiveModelState(ModStateName2)
Else
	ActiveSheet.View("VIEW15").View.Suppressed = True
	MsgBox("Modelstate not found: " & MSName,,"Error ModelState")
End If

ActiveSheet.View("VIEW10").NativeEntity.SetActiveModelState(ModStateName)
```

---

### 68. How to Stop Dialog Box From Popping Up

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-stop-dialog-box-from-popping-up/td-p/13834921](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-stop-dialog-box-from-popping-up/td-p/13834921)

**Author:** Lauren_healey

**Date:** ‎10-02-2025
	
		
		01:03 PM

**Description:** I am writing a program in Excel VBA that automatically opens a drawing, pulls information from that drawing,  then closes that drawing. It does this for over 4,000 drawings before finishing. While running this program, I have found that a certain dialog box (see attached or bottom of post) sometimes...

**Code Snippets (6):**

#### Code Block 1

```vb
Dim drawdoc As DrawingDocument = ThisApplication.ActiveDocument
If drawdoc.ReferencedDocuments.Item(1).documenttype=DocumentTypeEnum.kAssemblyDocumentObject Then
Dim oDoc As AssemblyDocument = drawdoc.ReferencedDocuments.Item(1)
Dim oBOM As BOM = oDoc.ComponentDefinition.BOM
oBOM.StructuredViewEnabled = True
oBOM.PartsOnlyViewEnabled = True
End If
```

#### Code Block 2

```vb
Dim oDoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oBOM As BOM = oDoc.ComponentDefinition.BOM
oBOM.StructuredViewEnabled = True
oBOM.PartsOnlyViewEnabled = True
```

#### Code Block 3

```vb
ThisApplication.SilentOperation = False
ThisApplication.UserInterfaceManager.UserInteractionDisabled = False
```

#### Code Block 4

```vb
ThisApplication.SilentOperation = False
ThisApplication.UserInterfaceManager.UserInteractionDisabled = False
```

#### Code Block 5

```vb
ThisApplication.SilentOperation = True
ThisApplication.UserInterfaceManager.UserInteractionDisabled = True
```

#### Code Block 6

```vb
ThisApplication.SilentOperation = True
ThisApplication.UserInterfaceManager.UserInteractionDisabled = True
```

---

### 69. How to check if a file has been saved in Inventor 2022?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-check-if-a-file-has-been-saved-in-inventor-2022/td-p/10738478](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-check-if-a-file-has-been-saved-in-inventor-2022/td-p/10738478)

**Author:** CattabianiI

**Date:** ‎11-05-2021
	
		
		09:40 AM

**Description:** This one is a well known code snippet to check if a file has been saved in Inventor 2021 and previous versions:if Document.FileSaveCounter > 0 thenSince the document and file now are different elements that property could not be the one we were looking for.Fortunately it's already there the proper o...

**Code Snippets (6):**

#### Code Block 1

```vb
Document.File.FileSaveCounter
```

#### Code Block 2

```vb
Document.File.FileSaveCounter
```

#### Code Block 3

```vb
Document.File.FileSaveCounter
```

#### Code Block 4

```vb
Document.File.FileSaveCounter
```

#### Code Block 5

```vb
Sub Main()
	
	Debugger.Break
	
    ' Ensure we're in an assembly document
    If ThisDoc.Document.DocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
        MessageBox.Show("Please run this rule from an assembly document.", "iLogic")
        Return
    End If

    ' Get the active assembly document
    Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument

	' Report counter and dirty status
	MessageBox.Show( _
		"FileSaveCounter = " & oAsmDoc.FileSaveCounter & vbCr & _
		"Dirty: " & oAsmDoc.Dirty & vbCr & _
		" ",
		"REPORT",
		MessageBoxButtons.OK,
		MessageBoxIcon.Information
		)
	
End Sub
```

#### Code Block 6

```vb
Sub Main()
	
	Debugger.Break
	
    ' Ensure we're in an assembly document
    If ThisDoc.Document.DocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
        MessageBox.Show("Please run this rule from an assembly document.", "iLogic")
        Return
    End If

    ' Get the active assembly document
    Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument

	' Report counter and dirty status
	MessageBox.Show( _
		"FileSaveCounter = " & oAsmDoc.FileSaveCounter & vbCr & _
		"Dirty: " & oAsmDoc.Dirty & vbCr & _
		" ",
		"REPORT",
		MessageBoxButtons.OK,
		MessageBoxIcon.Information
		)
	
End Sub
```

#### Code Block 7

```vb
Sub Main()
	
	Debugger.Break
	
    ' Ensure we're in an assembly document
    If ThisDoc.Document.DocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
        MessageBox.Show("Please run this rule from an assembly document.", "iLogic")
        Return
    End If

    ' Get the active assembly document
    Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument

	' Report counter and dirty status
	MessageBox.Show( _
		"FileSaveCounter = " & oAsmDoc.FileSaveCounter & vbCr & _
		"Dirty: " & oAsmDoc.Dirty & vbCr & _
		" ",
		"REPORT",
		MessageBoxButtons.OK,
		MessageBoxIcon.Information
		)
	
End Sub
```

#### Code Block 8

```vb
Sub Main()
	
	Debugger.Break
	
    ' Ensure we're in an assembly document
    If ThisDoc.Document.DocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
        MessageBox.Show("Please run this rule from an assembly document.", "iLogic")
        Return
    End If

    ' Get the active assembly document
    Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument

	' Report counter and dirty status
	MessageBox.Show( _
		"FileSaveCounter = " & oAsmDoc.FileSaveCounter & vbCr & _
		"Dirty: " & oAsmDoc.Dirty & vbCr & _
		" ",
		"REPORT",
		MessageBoxButtons.OK,
		MessageBoxIcon.Information
		)
	
End Sub
```

#### Code Block 9

```vb
if Document.FileSaveCounter > 0 then
```

#### Code Block 10

```vb
if Document.FileSaveCounter > 0 then
```

#### Code Block 11

```vb
if Document.FileSaveCounter > 0 then
```

#### Code Block 12

```vb
if Document.FileSaveCounter > 0 then
```

---

### 70. How to count specific hole features in an assembly environment

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-count-specific-hole-features-in-an-assembly-environment/td-p/13739520](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-count-specific-hole-features-in-an-assembly-environment/td-p/13739520)

**Author:** HYOSEOK-KIM

**Date:** ‎07-24-2025
	
		
		11:53 PM

**Description:** I am using Inventor 2024.The logic to check the number of hole features used in a part in an assembly environment is structured as follows -----------------------------------------------------------------------------------------------------Sub Main()    Dim oAsmDoc As AssemblyDocument = ThisDoc.Docu...

**Code Snippets (2):**

#### Code Block 1

```vb
Public Class ThisRule

    Private holes As Dictionary(Of String, Integer) = New Dictionary(Of String, Integer)()

    Sub Main()
        Dim oAsmDoc As AssemblyDocument = ThisDoc.Document
        Dim oAsmDef As AssemblyComponentDefinition = oAsmDoc.ComponentDefinition


        For Each oOcc As ComponentOccurrence In oAsmDef.Occurrences.AllLeafOccurrences
            If Not oOcc.Suppressed Then
                If oOcc.DefinitionDocumentType = DocumentTypeEnum.kPartDocumentObject Then
                    Dim oDef As PartComponentDefinition = oOcc.Definition
                    GetHolesQty(oDef)
                End If
            End If
        Next

        Beep()

        Dim msg As String = ""
        For Each item As KeyValuePair(Of String, Integer) In holes

            Dim cell = String.Format("{0,-20}", item.Key)

            msg += String.Format("{0} : {1}{2}", cell, item.Value, System.Environment.NewLine)
        Next

        MsgBox(msg)
    End Sub


    '''Calculates holes in the part document
    '''Be careful: nested patterns are not analyzed !
    Sub GetHolesQty(ByVal oDef As PartComponentDefinition)

        Dim N As Integer = 0  'counter   
        Dim oHoles As HoleFeatures = oDef.Features.HoleFeatures
        For Each oH As HoleFeature In oHoles
            If Not oH.Suppressed Then
                AddHoleInfo(oH, 1)
            End If
        Next

        'have we any rectangular patterns ?
        Dim oRectPatterns As RectangularPatternFeatures = oDef.Features.RectangularPatternFeatures

        For Each oRPF As RectangularPatternFeature In oRectPatterns
            If oRPF.Suppressed Then Continue For

            Dim holes = oRPF.ParentFeatures.Cast(Of PartFeature).
                Where(Function(f) Not f.Suppressed And TypeOf f Is HoleFeature).ToList()

            If (holes.Count = 0) Then Continue For

            Dim elements = oRPF.PatternElements.Cast(Of FeaturePatternElement).
                Where(Function(fpe) Not fpe.Suppressed).ToList()

            For Each hole As PartFeature In holes
                AddHoleInfo(hole, elements.Count - 1)
            Next
        Next

        'have we any circular patterns ?
        Dim oCircPatterns As CircularPatternFeatures
        oCircPatterns = oDef.Features.CircularPatternFeatures

        For Each oCPF As CircularPatternFeature In oCircPatterns
            If oCPF.Suppressed Then Continue For

            Dim holes = oCPF.ParentFeatures.Cast(Of PartFeature).
                Where(Function(f) Not f.Suppressed And TypeOf f Is HoleFeature).ToList()

            If (holes.Count = 0) Then Continue For

            Dim elements = oCPF.PatternElements.Cast(Of FeaturePatternElement).
                Where(Function(fpe) Not fpe.Suppressed).ToList()

            For Each hole As PartFeature In holes
                AddHoleInfo(hole, elements.Count - 1)
            Next

        Next
    End Sub


    Private Sub AddHoleInfo(hole As HoleFeature, numberOfHoles As Integer)

        Dim name As String = "Unknown"

        If (hole.Tapped) Then
            If (TypeOf hole.TapInfo Is HoleTapInfo) Then
                Dim info As HoleTapInfo = hole.TapInfo
                name = info.ThreadDesignation
            Else
                Dim info As TaperedThreadInfo = hole.TapInfo
                name = info.ThreadDesignation
            End If

        Else
            name = String.Format("Hole: {0}", hole.HoleDiameter.Expression)
        End If

        If holes.ContainsKey(name) Then
            holes(name) += numberOfHoles
        Else
            holes.Add(name, numberOfHoles)
        End If

    End Sub
End Class
```

#### Code Block 2

```vb
Public Class ThisRule

    Private holes As Dictionary(Of String, Integer) = New Dictionary(Of String, Integer)()

    Sub Main()
        Dim oAsmDoc As AssemblyDocument = ThisDoc.Document
        Dim oAsmDef As AssemblyComponentDefinition = oAsmDoc.ComponentDefinition


        For Each oOcc As ComponentOccurrence In oAsmDef.Occurrences.AllLeafOccurrences
            If Not oOcc.Suppressed Then
                If oOcc.DefinitionDocumentType = DocumentTypeEnum.kPartDocumentObject Then
                    Dim oDef As PartComponentDefinition = oOcc.Definition
                    GetHolesQty(oDef)
                End If
            End If
        Next

        Beep()

        Dim msg As String = ""
        For Each item As KeyValuePair(Of String, Integer) In holes

            Dim cell = String.Format("{0,-20}", item.Key)

            msg += String.Format("{0} : {1}{2}", cell, item.Value, System.Environment.NewLine)
        Next

        MsgBox(msg)
    End Sub


    '''Calculates holes in the part document
    '''Be careful: nested patterns are not analyzed !
    Sub GetHolesQty(ByVal oDef As PartComponentDefinition)

        Dim N As Integer = 0  'counter   
        Dim oHoles As HoleFeatures = oDef.Features.HoleFeatures
        For Each oH As HoleFeature In oHoles
            If Not oH.Suppressed Then
                AddHoleInfo(oH, 1)
            End If
        Next

        'have we any rectangular patterns ?
        Dim oRectPatterns As RectangularPatternFeatures = oDef.Features.RectangularPatternFeatures

        For Each oRPF As RectangularPatternFeature In oRectPatterns
            If oRPF.Suppressed Then Continue For

            Dim holes = oRPF.ParentFeatures.Cast(Of PartFeature).
                Where(Function(f) Not f.Suppressed And TypeOf f Is HoleFeature).ToList()

            If (holes.Count = 0) Then Continue For

            Dim elements = oRPF.PatternElements.Cast(Of FeaturePatternElement).
                Where(Function(fpe) Not fpe.Suppressed).ToList()

            For Each hole As PartFeature In holes
                AddHoleInfo(hole, elements.Count - 1)
            Next
        Next

        'have we any circular patterns ?
        Dim oCircPatterns As CircularPatternFeatures
        oCircPatterns = oDef.Features.CircularPatternFeatures

        For Each oCPF As CircularPatternFeature In oCircPatterns
            If oCPF.Suppressed Then Continue For

            Dim holes = oCPF.ParentFeatures.Cast(Of PartFeature).
                Where(Function(f) Not f.Suppressed And TypeOf f Is HoleFeature).ToList()

            If (holes.Count = 0) Then Continue For

            Dim elements = oCPF.PatternElements.Cast(Of FeaturePatternElement).
                Where(Function(fpe) Not fpe.Suppressed).ToList()

            For Each hole As PartFeature In holes
                AddHoleInfo(hole, elements.Count - 1)
            Next

        Next
    End Sub


    Private Sub AddHoleInfo(hole As HoleFeature, numberOfHoles As Integer)

        Dim name As String = "Unknown"

        If (hole.Tapped) Then
            If (TypeOf hole.TapInfo Is HoleTapInfo) Then
                Dim info As HoleTapInfo = hole.TapInfo
                name = info.ThreadDesignation
            Else
                Dim info As TaperedThreadInfo = hole.TapInfo
                name = info.ThreadDesignation
            End If

        Else
            name = String.Format("Hole: {0}", hole.HoleDiameter.Expression)
        End If

        If holes.ContainsKey(name) Then
            holes(name) += numberOfHoles
        Else
            holes.Add(name, numberOfHoles)
        End If

    End Sub
End Class
```

#### Code Block 3

```vb
Public Class ThisRule

    Private holes As Dictionary(Of String, Integer) = New Dictionary(Of String, Integer)()

    Sub Main()
        Dim oAsmDoc As AssemblyDocument = ThisDoc.Document
        Dim oAsmDef As AssemblyComponentDefinition = oAsmDoc.ComponentDefinition


        For Each oOcc As ComponentOccurrence In oAsmDef.Occurrences.AllLeafOccurrences
            If Not oOcc.Suppressed Then
                If oOcc.DefinitionDocumentType = DocumentTypeEnum.kPartDocumentObject Then
                    Dim oDef As PartComponentDefinition = oOcc.Definition
                    GetHolesQty(oDef)
                End If
            End If
        Next

        Beep()

        Dim msg As String = ""
        For Each item As KeyValuePair(Of String, Integer) In holes

            Dim cell = String.Format("{0,-20}", item.Key)

            msg += String.Format("{0} : {1}{2}", cell, item.Value, System.Environment.NewLine)
        Next

        MsgBox(msg)
    End Sub


    '''Calculates holes in the part document
    '''Be careful: nested patterns are not analyzed !
    Sub GetHolesQty(ByVal oDef As PartComponentDefinition)

        Dim N As Integer = 0  'counter   
        Dim oHoles As HoleFeatures = oDef.Features.HoleFeatures
        For Each oH As HoleFeature In oHoles
            If Not oH.Suppressed Then
                AddHoleInfo(oH, 1)
            End If
        Next

        'have we any rectangular patterns ?
        Dim oRectPatterns As RectangularPatternFeatures = oDef.Features.RectangularPatternFeatures

        For Each oRPF As RectangularPatternFeature In oRectPatterns
            If oRPF.Suppressed Then Continue For

            Dim holes = oRPF.ParentFeatures.Cast(Of PartFeature).
                Where(Function(f) Not f.Suppressed And TypeOf f Is HoleFeature).ToList()

            If (holes.Count = 0) Then Continue For

            Dim elements = oRPF.PatternElements.Cast(Of FeaturePatternElement).
                Where(Function(fpe) Not fpe.Suppressed).ToList()

            For Each hole As PartFeature In holes
                AddHoleInfo(hole, elements.Count - 1)
            Next
        Next

        'have we any circular patterns ?
        Dim oCircPatterns As CircularPatternFeatures
        oCircPatterns = oDef.Features.CircularPatternFeatures

        For Each oCPF As CircularPatternFeature In oCircPatterns
            If oCPF.Suppressed Then Continue For

            Dim holes = oCPF.ParentFeatures.Cast(Of PartFeature).
                Where(Function(f) Not f.Suppressed And TypeOf f Is HoleFeature).ToList()

            If (holes.Count = 0) Then Continue For

            Dim elements = oCPF.PatternElements.Cast(Of FeaturePatternElement).
                Where(Function(fpe) Not fpe.Suppressed).ToList()

            For Each hole As PartFeature In holes
                AddHoleInfo(hole, elements.Count - 1)
            Next

        Next
    End Sub


    Private Sub AddHoleInfo(hole As HoleFeature, numberOfHoles As Integer)

        Dim name As String = "Unknown"

        If (hole.Tapped) Then
            If (TypeOf hole.TapInfo Is HoleTapInfo) Then
                Dim info As HoleTapInfo = hole.TapInfo
                name = info.ThreadDesignation
            Else
                Dim info As TaperedThreadInfo = hole.TapInfo
                name = info.ThreadDesignation
            End If

        Else
            name = String.Format("Hole: {0}", hole.HoleDiameter.Expression)
        End If

        If holes.ContainsKey(name) Then
            holes(name) += numberOfHoles
        Else
            holes.Add(name, numberOfHoles)
        End If

    End Sub
End Class
```

#### Code Block 4

```vb
Public Class ThisRule

    Private holes As Dictionary(Of String, Integer) = New Dictionary(Of String, Integer)()

    Sub Main()
        Dim oAsmDoc As AssemblyDocument = ThisDoc.Document
        Dim oAsmDef As AssemblyComponentDefinition = oAsmDoc.ComponentDefinition


        For Each oOcc As ComponentOccurrence In oAsmDef.Occurrences.AllLeafOccurrences
            If Not oOcc.Suppressed Then
                If oOcc.DefinitionDocumentType = DocumentTypeEnum.kPartDocumentObject Then
                    Dim oDef As PartComponentDefinition = oOcc.Definition
                    GetHolesQty(oDef)
                End If
            End If
        Next

        Beep()

        Dim msg As String = ""
        For Each item As KeyValuePair(Of String, Integer) In holes

            Dim cell = String.Format("{0,-20}", item.Key)

            msg += String.Format("{0} : {1}{2}", cell, item.Value, System.Environment.NewLine)
        Next

        MsgBox(msg)
    End Sub


    '''Calculates holes in the part document
    '''Be careful: nested patterns are not analyzed !
    Sub GetHolesQty(ByVal oDef As PartComponentDefinition)

        Dim N As Integer = 0  'counter   
        Dim oHoles As HoleFeatures = oDef.Features.HoleFeatures
        For Each oH As HoleFeature In oHoles
            If Not oH.Suppressed Then
                AddHoleInfo(oH, 1)
            End If
        Next

        'have we any rectangular patterns ?
        Dim oRectPatterns As RectangularPatternFeatures = oDef.Features.RectangularPatternFeatures

        For Each oRPF As RectangularPatternFeature In oRectPatterns
            If oRPF.Suppressed Then Continue For

            Dim holes = oRPF.ParentFeatures.Cast(Of PartFeature).
                Where(Function(f) Not f.Suppressed And TypeOf f Is HoleFeature).ToList()

            If (holes.Count = 0) Then Continue For

            Dim elements = oRPF.PatternElements.Cast(Of FeaturePatternElement).
                Where(Function(fpe) Not fpe.Suppressed).ToList()

            For Each hole As PartFeature In holes
                AddHoleInfo(hole, elements.Count - 1)
            Next
        Next

        'have we any circular patterns ?
        Dim oCircPatterns As CircularPatternFeatures
        oCircPatterns = oDef.Features.CircularPatternFeatures

        For Each oCPF As CircularPatternFeature In oCircPatterns
            If oCPF.Suppressed Then Continue For

            Dim holes = oCPF.ParentFeatures.Cast(Of PartFeature).
                Where(Function(f) Not f.Suppressed And TypeOf f Is HoleFeature).ToList()

            If (holes.Count = 0) Then Continue For

            Dim elements = oCPF.PatternElements.Cast(Of FeaturePatternElement).
                Where(Function(fpe) Not fpe.Suppressed).ToList()

            For Each hole As PartFeature In holes
                AddHoleInfo(hole, elements.Count - 1)
            Next

        Next
    End Sub


    Private Sub AddHoleInfo(hole As HoleFeature, numberOfHoles As Integer)

        Dim name As String = "Unknown"

        If (hole.Tapped) Then
            If (TypeOf hole.TapInfo Is HoleTapInfo) Then
                Dim info As HoleTapInfo = hole.TapInfo
                name = info.ThreadDesignation
            Else
                Dim info As TaperedThreadInfo = hole.TapInfo
                name = info.ThreadDesignation
            End If

        Else
            name = String.Format("Hole: {0}", hole.HoleDiameter.Expression)
        End If

        If holes.ContainsKey(name) Then
            holes(name) += numberOfHoles
        Else
            holes.Add(name, numberOfHoles)
        End If

    End Sub
End Class
```

---

### 71. How to create a constraint with a part and the assembly's origin planes using the API?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-create-a-constraint-with-a-part-and-the-assembly-s-origin/td-p/13840352](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-create-a-constraint-with-a-part-and-the-assembly-s-origin/td-p/13840352)

**Author:** kristian_oa

**Date:** ‎10-06-2025
	
		
		03:07 PM

**Description:** Hi, I am trying to add a constraint from a part to the active assembly's origin XY workplane using the Inventor API, but I have not had any luck doing so. Currently, I have managed to create a gemoetry proxy for the workplane in my part, but attempting to create a gemoerty proxy for the assembly's X...

**Code Snippets (4):**

#### Code Block 1

```vb
// Get active assembly document
AssemblyDocument asmDoc = (AssemblyDocument)Globals.InventorApp.ActiveDocument;
AssemblyComponentDefinition oAsmCompDef = asmDoc.ComponentDefinition;

// Adds a component (in this case a part) to the assembly.
ComponentOccurrence compOcc = AddComponent(PartPath);
// Get the part's definition
PartComponentDefinition compDef = (PartComponentDefinition)compOcc.Definition;

// Create proxies for the workplanes
object wpx1, wpx2;
compOcc.CreateGeometryProxy(compDef.WorkPlanes["XY Plane"], out wpx1);

// Creating the proxy for the assembly's origin XY Plane causes a COMException.
// "System.Runtime.InteropServices.COMException: 'Exception has been thrown by the target of an invocation.'"
compOcc.CreateGeometryProxy(oAsmCompDef.WorkPlanes["XY Plane"], out wpx2);

// Add the constraint to the assembly. This is never reached as an exception is thrown when creating the proxy.
AssemblyConstraints AssCons = oAsmCompDef.Constraints;
AssCons.AddFlushConstraint((WorkPlaneProxy)wpx1, (WorkPlaneProxy)wpx2, 0);
```

#### Code Block 2

```vb
// Get active assembly document
AssemblyDocument asmDoc = (AssemblyDocument)Globals.InventorApp.ActiveDocument;
AssemblyComponentDefinition oAsmCompDef = asmDoc.ComponentDefinition;

// Adds a component (in this case a part) to the assembly.
ComponentOccurrence compOcc = AddComponent(PartPath);
// Get the part's definition
PartComponentDefinition compDef = (PartComponentDefinition)compOcc.Definition;

// Create proxies for the workplanes
object wpx1, wpx2;
compOcc.CreateGeometryProxy(compDef.WorkPlanes["XY Plane"], out wpx1);

// Creating the proxy for the assembly's origin XY Plane causes a COMException.
// "System.Runtime.InteropServices.COMException: 'Exception has been thrown by the target of an invocation.'"
compOcc.CreateGeometryProxy(oAsmCompDef.WorkPlanes["XY Plane"], out wpx2);

// Add the constraint to the assembly. This is never reached as an exception is thrown when creating the proxy.
AssemblyConstraints AssCons = oAsmCompDef.Constraints;
AssCons.AddFlushConstraint((WorkPlaneProxy)wpx1, (WorkPlaneProxy)wpx2, 0);
```

#### Code Block 3

```vb
// Get active assembly document
AssemblyDocument asmDoc = (AssemblyDocument)Globals.InventorApp.ActiveDocument;
AssemblyComponentDefinition oAsmCompDef = asmDoc.ComponentDefinition;

// Adds a component (in this case a part) to the assembly.
ComponentOccurrence compOcc = AddComponent(PartPath);
// Get the part's definition
PartComponentDefinition compDef = (PartComponentDefinition)compOcc.Definition;

// Create proxies for the workplanes
object wpx1, wpx2;
compOcc.CreateGeometryProxy(compDef.WorkPlanes["XY Plane"], out wpx1);

// Creating the proxy for the assembly's origin XY Plane causes a COMException.
// "System.Runtime.InteropServices.COMException: 'Exception has been thrown by the target of an invocation.'"
compOcc.CreateGeometryProxy(oAsmCompDef.WorkPlanes["XY Plane"], out wpx2);

// Add the constraint to the assembly. This is never reached as an exception is thrown when creating the proxy.
AssemblyConstraints AssCons = oAsmCompDef.Constraints;
AssCons.AddFlushConstraint((WorkPlaneProxy)wpx1, (WorkPlaneProxy)wpx2, 0);
```

#### Code Block 4

```vb
// Get active assembly document
AssemblyDocument asmDoc = (AssemblyDocument)Globals.InventorApp.ActiveDocument;
AssemblyComponentDefinition oAsmCompDef = asmDoc.ComponentDefinition;

// Adds a component (in this case a part) to the assembly.
ComponentOccurrence compOcc = AddComponent(PartPath);
// Get the part's definition
PartComponentDefinition compDef = (PartComponentDefinition)compOcc.Definition;

// Create proxies for the workplanes
object wpx1, wpx2;
compOcc.CreateGeometryProxy(compDef.WorkPlanes["XY Plane"], out wpx1);

// Creating the proxy for the assembly's origin XY Plane causes a COMException.
// "System.Runtime.InteropServices.COMException: 'Exception has been thrown by the target of an invocation.'"
compOcc.CreateGeometryProxy(oAsmCompDef.WorkPlanes["XY Plane"], out wpx2);

// Add the constraint to the assembly. This is never reached as an exception is thrown when creating the proxy.
AssemblyConstraints AssCons = oAsmCompDef.Constraints;
AssCons.AddFlushConstraint((WorkPlaneProxy)wpx1, (WorkPlaneProxy)wpx2, 0);
```

#### Code Block 5

```vb
AssCons.AddFlushConstraint((WorkPlaneProxy)wpx1,(WorkPlane)oAsmCompDef.WorkPlanes["XY Plane"], 0);
```

#### Code Block 6

```vb
AssCons.AddFlushConstraint((WorkPlaneProxy)wpx1,(WorkPlane)oAsmCompDef.WorkPlanes["XY Plane"], 0);
```

#### Code Block 7

```vb
AssCons.AddFlushConstraint((WorkPlaneProxy)wpx1,(WorkPlane)oAsmCompDef.WorkPlanes["XY Plane"], 0);
```

#### Code Block 8

```vb
AssCons.AddFlushConstraint((WorkPlaneProxy)wpx1,(WorkPlane)oAsmCompDef.WorkPlanes["XY Plane"], 0);
```

---

### 72. How to create a new assembly from ZeroDoc environment

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-create-a-new-assembly-from-zerodoc-environment/td-p/13746786](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-create-a-new-assembly-from-zerodoc-environment/td-p/13746786)

**Author:** JBerns

**Date:** ‎07-30-2025
	
		
		09:14 AM

**Description:** Community, I am trying to create a new assembly from the ZeroDoc environment by means of an add-in. With the help of @Curtis_Waguespack , @JelteDeJong , @chandra , @ryan.rittenhouse , and others on the forum, I have a working add-in that adds the ribbon tab, panel, and button to the ZeroDoc ribbon. ...

**Code Snippets (8):**

#### Code Block 1

```vb
'Public g_Inventor As Inventor.Application = GetObject(, "Inventor.Application")
'Public Property g_Inventor As Inventor.Application
'Public g_Inventor As Inventor.Application = 'System.Runtime.InteropServices.Marshal.GetActiveObject("Inventor.Application")
```

#### Code Block 2

```vb
'Public g_Inventor As Inventor.Application = GetObject(, "Inventor.Application")
'Public Property g_Inventor As Inventor.Application
'Public g_Inventor As Inventor.Application = 'System.Runtime.InteropServices.Marshal.GetActiveObject("Inventor.Application")
```

#### Code Block 3

```vb
'This is the code that does the real work when your command is executed.
    Sub Run_CommandCode()

        Debugger.Break()
        MsgBox("This command creates a new assembly from the ZeroDoc environment.")

        ' Get the Inventor Application object
        Dim oApp As Inventor.Application
        oApp = ThisApplication ' If running within Inventor (VBA macro)

        Dim invApp As Inventor.Application
        Try
           invApp = GetObject(, "Inventor.Application")
           '            invApp = ThisApplication ' If running within Inventor (VBA macro)
        Catch ex As Exception
           invApp = CreateObject("Inventor.Application")
           invApp.Visible = True
        End Try

        If invApp Is Nothing Then
           System.Windows.Forms.MessageBox.Show("Inventor is not running or could not be launched.", CStr(vbCritical))
           Exit Sub
        End If

        ' Define the document type as an Assembly Document
        Dim oDocType As Inventor.DocumentTypeEnum
        oDocType = Inventor.DocumentTypeEnum.kAssemblyDocumentObject

        ' Get the default template file for an assembly
        ' This will use the default template set in Inventor's options.
        Dim sTemplateFile As String
        sTemplateFile = invApp.FileManager.GetTemplateFile(oDocType)

        ' Create a new assembly document
        Dim oAsmDoc As Inventor.AssemblyDocument
        oAsmDoc = invApp.Documents.Add(oDocType, sTemplateFile, True) ' True makes it visible and active

    End Sub
```

#### Code Block 4

```vb
'This is the code that does the real work when your command is executed.
    Sub Run_CommandCode()

        Debugger.Break()
        MsgBox("This command creates a new assembly from the ZeroDoc environment.")

        ' Get the Inventor Application object
        Dim oApp As Inventor.Application
        oApp = ThisApplication ' If running within Inventor (VBA macro)

        Dim invApp As Inventor.Application
        Try
           invApp = GetObject(, "Inventor.Application")
           '            invApp = ThisApplication ' If running within Inventor (VBA macro)
        Catch ex As Exception
           invApp = CreateObject("Inventor.Application")
           invApp.Visible = True
        End Try

        If invApp Is Nothing Then
           System.Windows.Forms.MessageBox.Show("Inventor is not running or could not be launched.", CStr(vbCritical))
           Exit Sub
        End If

        ' Define the document type as an Assembly Document
        Dim oDocType As Inventor.DocumentTypeEnum
        oDocType = Inventor.DocumentTypeEnum.kAssemblyDocumentObject

        ' Get the default template file for an assembly
        ' This will use the default template set in Inventor's options.
        Dim sTemplateFile As String
        sTemplateFile = invApp.FileManager.GetTemplateFile(oDocType)

        ' Create a new assembly document
        Dim oAsmDoc As Inventor.AssemblyDocument
        oAsmDoc = invApp.Documents.Add(oDocType, sTemplateFile, True) ' True makes it visible and active

    End Sub
```

#### Code Block 5

```vb
If Globals.g_inventorApplication Is Nothing Then
            System.Windows.Forms.MessageBox.Show("Inventor is not running or could not be launched.", CStr(vbCritical))
            Exit Sub
        End If

        ' Define the document type as an Assembly Document
        Dim oDocType As Inventor.DocumentTypeEnum
        oDocType = Inventor.DocumentTypeEnum.kAssemblyDocumentObject

        ' Get the default template file for an assembly
        ' This will use the default template set in Inventor's options.
        Dim sTemplateFile As String
        sTemplateFile = Globals.g_inventorApplication.FileManager.GetTemplateFile(oDocType)

        ' Create a new assembly document
        Dim oAsmDoc As Inventor.AssemblyDocument
        oAsmDoc = Globals.g_inventorApplication.Documents.Add(oDocType, sTemplateFile, True) ' True makes it visible and active
```

#### Code Block 6

```vb
If Globals.g_inventorApplication Is Nothing Then
            System.Windows.Forms.MessageBox.Show("Inventor is not running or could not be launched.", CStr(vbCritical))
            Exit Sub
        End If

        ' Define the document type as an Assembly Document
        Dim oDocType As Inventor.DocumentTypeEnum
        oDocType = Inventor.DocumentTypeEnum.kAssemblyDocumentObject

        ' Get the default template file for an assembly
        ' This will use the default template set in Inventor's options.
        Dim sTemplateFile As String
        sTemplateFile = Globals.g_inventorApplication.FileManager.GetTemplateFile(oDocType)

        ' Create a new assembly document
        Dim oAsmDoc As Inventor.AssemblyDocument
        oAsmDoc = Globals.g_inventorApplication.Documents.Add(oDocType, sTemplateFile, True) ' True makes it visible and active
```

#### Code Block 7

```vb
Public Module Globals

    ' Inventor application object.
    Public g_inventorApplication As Inventor.Application

    'Unique ID for this add-in.  
    Public Const g_simpleAddInClientID As String = "d49b875a-c5e2-46af-8a59-a071d61d5b72"
    Public Const g_addInClientID As String = "{" & g_simpleAddInClientID & "}"
```

#### Code Block 8

```vb
Public Module Globals

    ' Inventor application object.
    Public g_inventorApplication As Inventor.Application

    'Unique ID for this add-in.  
    Public Const g_simpleAddInClientID As String = "d49b875a-c5e2-46af-8a59-a071d61d5b72"
    Public Const g_addInClientID As String = "{" & g_simpleAddInClientID & "}"
```

---

### 73. How to link the material description directly from the library to the BOM in the drawing.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-link-the-material-description-directly-from-the-library/td-p/13836336](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-link-the-material-description-directly-from-the-library/td-p/13836336)

**Author:** asawantPPSNQ

**Date:** ‎10-03-2025
	
		
		10:37 AM

**Description:** Hi Community, I wanted to know how to link the material description directly from the library to the BOM in the drawing.Suppose I create one material in the Inventor Library, by the name WD-07009, with the description WOOD, RED OAK, 4/4" x 10'-12' x 13/16" S2S1E, S&B. As you can see in the image bel...

**Code Snippets (2):**

#### Code Block 1

```vb
On Error Resume Next 
Dim mat As MaterialAsset = ThisDoc.Document.activematerial
Dim value As AssetValue
			For Each value In mat
				Logger.Info(value.DisplayName & "  " & value.Name)
				iProperties.Value("Custom", "material_" & value.DisplayName)=value.value
			Next
```

#### Code Block 2

```vb
On Error Resume Next 
Dim mat As MaterialAsset = ThisDoc.Document.activematerial
Dim value As AssetValue
			For Each value In mat
				Logger.Info(value.DisplayName & "  " & value.Name)
				iProperties.Value("Custom", "material_" & value.DisplayName)=value.value
			Next
```

#### Code Block 3

```vb
iProperties.Value("Custom", "material_physmat_Comments")=mat("physmat_Comments").value
```

#### Code Block 4

```vb
iProperties.Value("Custom", "material_physmat_Comments")=mat("physmat_Comments").value
```

---

### 74. I need with a rule that will look for the closed profiles in a sketch array and select them all

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/i-need-with-a-rule-that-will-look-for-the-closed-profiles-in-a/td-p/13750027](https://forums.autodesk.com/t5/inventor-programming-forum/i-need-with-a-rule-that-will-look-for-the-closed-profiles-in-a/td-p/13750027)

**Author:** chris

**Date:** ‎08-01-2025
	
		
		07:10 AM

**Description:** I'm trying to set up a rule that will automatically look at a sketch array, in this case it's a group of circles, and it will automatically select all of the circles, "closed profiles". The issue I am having is that Inventor keeps telling me that it doesn't see any closed profiles, even though once ...

**Code Snippets (3):**

#### Code Block 1

```vb
' Get the active part document
Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument

' Get the part component definition
Dim oPartDef As PartComponentDefinition = oPartDoc.ComponentDefinition

' Find the specific sketch by name
Dim oSketch As PlanarSketch = Nothing
For i = 1 To oPartDef.Sketches.Count
    If oPartDef.Sketches.Item(i).Name = "Bottom Hoop Profiles" Then
        oSketch = oPartDef.Sketches.Item(i)
        Exit For
    End If
Next

' Check if sketch was found
If oSketch Is Nothing Then
    MessageBox.Show("Sketch 'Bottom Hoop Profiles' not found!", "Error")
    Exit Sub
End If

' For sketch arrays, we need to look at the sketch entities and patterns
MessageBox.Show("Found sketch: " & oSketch.Name & vbCrLf & "Profile count: " & oSketch.Profiles.Count, "Debug Info")

' Method 1: Try to work with all profiles (including arrayed ones)
If oSketch.Profiles.Count > 0 Then
    
    ' Loop through each profile in the sketch
    For i = 1 To oSketch.Profiles.Count
        Dim oProfile As Profile = oSketch.Profiles.Item(i)
        
        Try
            ' For arrayed profiles, we might need to check differently
            Dim profilePaths As Integer = oProfile.Count
            MessageBox.Show("Profile " & i & " has " & profilePaths & " path(s)", "Debug")
            
            ' Try to revolve each profile
            Try
                ' Create revolve definition around Y-axis (WorkAxis 2)
                Dim oRevolveDef = oPartDef.Features.RevolveFeatures.CreateRevolveDefinition(oProfile, oPartDef.WorkAxes.Item(2))
                
                ' Set revolve to full 360 degrees
                oRevolveDef.SetToFullSweep()
                
                ' Create the revolve feature
                Dim oRevolveFeature = oPartDef.Features.RevolveFeatures.Add(oRevolveDef)
                
                MessageBox.Show("Successfully revolved profile " & i, "Success")
                
            Catch ex As Exception
                ' Handle any errors (e.g., profile can't be revolved)
                MessageBox.Show("Could not revolve profile " & i & ": " & ex.Message, "Revolve Error")
            End Try
            
        Catch ex As Exception
            MessageBox.Show("Error processing profile " & i & ": " & ex.Message, "Error")
        End Try
        
    Next
    
Else
    MessageBox.Show("No profiles found. This might be due to how sketch arrays are handled.", "Info")
End If

' Alternative Method 2: Look for sketch patterns and work with them
Try
    If oSketch.SketchPatterns.Count > 0 Then
        MessageBox.Show("Found " & oSketch.SketchPatterns.Count & " sketch patterns", "Pattern Info")
        
        ' You might need to suppress the pattern temporarily and work with individual profiles
        ' Or create a separate approach for patterned geometry
    End If
Catch
    ' SketchPatterns might not be available in this context
End Try

' Update the part
oPartDoc.Update()

MessageBox.Show("Operation completed!", "Final")
```

#### Code Block 2

```vb
' Get the active part document
Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument

' Get the part component definition
Dim oPartDef As PartComponentDefinition = oPartDoc.ComponentDefinition

' Find the specific sketch by name
Dim oSketch As PlanarSketch = Nothing
For i = 1 To oPartDef.Sketches.Count
    If oPartDef.Sketches.Item(i).Name = "Bottom Hoop Profiles" Then
        oSketch = oPartDef.Sketches.Item(i)
        Exit For
    End If
Next

' Check if sketch was found
If oSketch Is Nothing Then
    MessageBox.Show("Sketch 'Bottom Hoop Profiles' not found!", "Error")
    Exit Sub
End If

' For sketch arrays, we need to look at the sketch entities and patterns
MessageBox.Show("Found sketch: " & oSketch.Name & vbCrLf & "Profile count: " & oSketch.Profiles.Count, "Debug Info")

' Method 1: Try to work with all profiles (including arrayed ones)
If oSketch.Profiles.Count > 0 Then
    
    ' Loop through each profile in the sketch
    For i = 1 To oSketch.Profiles.Count
        Dim oProfile As Profile = oSketch.Profiles.Item(i)
        
        Try
            ' For arrayed profiles, we might need to check differently
            Dim profilePaths As Integer = oProfile.Count
            MessageBox.Show("Profile " & i & " has " & profilePaths & " path(s)", "Debug")
            
            ' Try to revolve each profile
            Try
                ' Create revolve definition around Y-axis (WorkAxis 2)
                Dim oRevolveDef = oPartDef.Features.RevolveFeatures.CreateRevolveDefinition(oProfile, oPartDef.WorkAxes.Item(2))
                
                ' Set revolve to full 360 degrees
                oRevolveDef.SetToFullSweep()
                
                ' Create the revolve feature
                Dim oRevolveFeature = oPartDef.Features.RevolveFeatures.Add(oRevolveDef)
                
                MessageBox.Show("Successfully revolved profile " & i, "Success")
                
            Catch ex As Exception
                ' Handle any errors (e.g., profile can't be revolved)
                MessageBox.Show("Could not revolve profile " & i & ": " & ex.Message, "Revolve Error")
            End Try
            
        Catch ex As Exception
            MessageBox.Show("Error processing profile " & i & ": " & ex.Message, "Error")
        End Try
        
    Next
    
Else
    MessageBox.Show("No profiles found. This might be due to how sketch arrays are handled.", "Info")
End If

' Alternative Method 2: Look for sketch patterns and work with them
Try
    If oSketch.SketchPatterns.Count > 0 Then
        MessageBox.Show("Found " & oSketch.SketchPatterns.Count & " sketch patterns", "Pattern Info")
        
        ' You might need to suppress the pattern temporarily and work with individual profiles
        ' Or create a separate approach for patterned geometry
    End If
Catch
    ' SketchPatterns might not be available in this context
End Try

' Update the part
oPartDoc.Update()

MessageBox.Show("Operation completed!", "Final")
```

#### Code Block 3

```vb
' Get the active part document
Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument

' Get the part component definition
Dim oPartDef As PartComponentDefinition = oPartDoc.ComponentDefinition

' Find the specific sketch by name
Dim oSketch As PlanarSketch = Nothing
For i = 1 To oPartDef.Sketches.Count
    If oPartDef.Sketches.Item(i).Name = "Bottom Hoop Profiles" Then
        oSketch = oPartDef.Sketches.Item(i)
        Exit For
    End If
Next

' Check if sketch was found
If oSketch Is Nothing Then
    MessageBox.Show("Sketch 'Bottom Hoop Profiles' not found!", "Error")
    Exit Sub
End If

Try
	Dim newProfile As Profile
	newProfile = oSketch.Profiles.AddForSolid
    Try
        ' Create revolve definition around Y-axis (WorkAxis 2)
        Dim oRevolveDef = oPartDef.Features.RevolveFeatures.AddFull(newProfile, oPartDef.WorkAxes.Item(2), PartFeatureOperationEnum.kNewBodyOperation)    
    Catch ex As Exception
        ' Handle any errors (e.g., profile can't be revolved)
        MessageBox.Show("Could not revolve profile: "  & ex.Message, "Revolve Error")
    End Try
Catch
    MessageBox.Show("Could not extract profiles", "Info")
End Try
```

#### Code Block 4

```vb
' Get the active part document
Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument

' Get the part component definition
Dim oPartDef As PartComponentDefinition = oPartDoc.ComponentDefinition

' Find the specific sketch by name
Dim oSketch As PlanarSketch = Nothing
For i = 1 To oPartDef.Sketches.Count
    If oPartDef.Sketches.Item(i).Name = "Bottom Hoop Profiles" Then
        oSketch = oPartDef.Sketches.Item(i)
        Exit For
    End If
Next

' Check if sketch was found
If oSketch Is Nothing Then
    MessageBox.Show("Sketch 'Bottom Hoop Profiles' not found!", "Error")
    Exit Sub
End If

Try
	Dim newProfile As Profile
	newProfile = oSketch.Profiles.AddForSolid
    Try
        ' Create revolve definition around Y-axis (WorkAxis 2)
        Dim oRevolveDef = oPartDef.Features.RevolveFeatures.AddFull(newProfile, oPartDef.WorkAxes.Item(2), PartFeatureOperationEnum.kNewBodyOperation)    
    Catch ex As Exception
        ' Handle any errors (e.g., profile can't be revolved)
        MessageBox.Show("Could not revolve profile: "  & ex.Message, "Revolve Error")
    End Try
Catch
    MessageBox.Show("Could not extract profiles", "Info")
End Try
```

#### Code Block 5

```vb
' Get the active part document
Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument

' Get the part component definition
Dim oPartDef As PartComponentDefinition = oPartDoc.ComponentDefinition

' Find the specific sketch by name
Dim oSketch As PlanarSketch = Nothing
For i = 1 To oPartDef.Sketches.Count
    If oPartDef.Sketches.Item(i).Name = "Bottom Hoop Profiles" Then
        oSketch = oPartDef.Sketches.Item(i)
        Exit For
    End If
Next

' Check if sketch was found
If oSketch Is Nothing Then
    MessageBox.Show("Sketch 'Bottom Hoop Profiles' not found!", "Error")
    Exit Sub
End If

Try
	Dim newProfile As Profile
	newProfile = oSketch.Profiles.AddForSolid
    Try
        ' Create revolve definition around Y-axis (WorkAxis 2)
        Dim oRevolveDef = oPartDef.Features.RevolveFeatures.AddFull(newProfile, oPartDef.WorkAxes.Item(2), PartFeatureOperationEnum.kNewBodyOperation)    
    Catch ex As Exception
        ' Handle any errors (e.g., profile can't be revolved)
        MessageBox.Show("Could not revolve profile: "  & ex.Message, "Revolve Error")
    End Try
Catch
    MessageBox.Show("Could not extract profiles", "Info")
End Try
```

#### Code Block 6

```vb
' Get the active part document
Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument

' Get the part component definition
Dim oPartDef As PartComponentDefinition = oPartDoc.ComponentDefinition

' Find the specific sketch by name
Dim oSketch As PlanarSketch = Nothing
For i = 1 To oPartDef.Sketches.Count
    If oPartDef.Sketches.Item(i).Name = "Bottom Hoop Profiles" Then
        oSketch = oPartDef.Sketches.Item(i)
        Exit For
    End If
Next

' Check if sketch was found
If oSketch Is Nothing Then
    MessageBox.Show("Sketch 'Bottom Hoop Profiles' not found!", "Error")
    Exit Sub
End If

Try
	Dim newProfile As Profile
	newProfile = oSketch.Profiles.AddForSolid
    Try
        ' Create revolve definition around Y-axis (WorkAxis 2)
        Dim oRevolveDef = oPartDef.Features.RevolveFeatures.AddFull(newProfile, oPartDef.WorkAxes.Item(2), PartFeatureOperationEnum.kNewBodyOperation)    
    Catch ex As Exception
        ' Handle any errors (e.g., profile can't be revolved)
        MessageBox.Show("Could not revolve profile: "  & ex.Message, "Revolve Error")
    End Try
Catch
    MessageBox.Show("Could not extract profiles", "Info")
End Try
```

---

### 75. ID of occurrence in a pattern

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/id-of-occurrence-in-a-pattern/td-p/13351035#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/id-of-occurrence-in-a-pattern/td-p/13351035#messageview_0)

**Author:** DanfysikClaus

**Date:** ‎03-04-2025
	
		
		02:02 AM

**Description:** Hi Forum,Is there a way to identify an occurence in a pattern by its ID ?This feature is important as I like to automate the selection with iLogic e.g. ID8

**Code Snippets (2):**

#### Code Block 1

```vb
Sub Main
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	Dim oRPFs As RectangularPatternFeatures = oPDoc.ComponentDefinition.Features.RectangularPatternFeatures
	Dim oMyRPF As RectangularPatternFeature = Nothing
	For Each oRPF As RectangularPatternFeature In oRPFs
		If oRPF.Name = "Rectangular Pattern1" Then
			oMyRPF = oRPF
			Exit For 'exit iteration once found
		End If
	Next
	If oMyRPF Is Nothing Then
		MsgBox("Pattern Not Found!", vbCritical, "iLogic")
		Return
	End If
	Dim oMyFPE As FeaturePatternElement = Nothing
	For Each oFPE As FeaturePatternElement In oMyRPF.PatternElements
		If oFPE.Index = 8 Then
			oMyFPE = oFPE
			Exit For 'exit iteration once found
		End If
	Next
	If oMyFPE Is Nothing Then
		MsgBox("Pattern Element At That Index Not Found!", vbCritical, "iLogic")
		Return
	End If
	'Toggle its suppressed status
	oMyFPE.Suppressed = Not oMyFPE.Suppressed
	oPDoc.Update()
End Sub
```

#### Code Block 2

```vb
Sub Main
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	Dim oRPFs As RectangularPatternFeatures = oPDoc.ComponentDefinition.Features.RectangularPatternFeatures
	Dim oMyRPF As RectangularPatternFeature = Nothing
	For Each oRPF As RectangularPatternFeature In oRPFs
		If oRPF.Name = "Rectangular Pattern1" Then
			oMyRPF = oRPF
			Exit For 'exit iteration once found
		End If
	Next
	If oMyRPF Is Nothing Then
		MsgBox("Pattern Not Found!", vbCritical, "iLogic")
		Return
	End If
	Dim oMyFPE As FeaturePatternElement = Nothing
	For Each oFPE As FeaturePatternElement In oMyRPF.PatternElements
		If oFPE.Index = 8 Then
			oMyFPE = oFPE
			Exit For 'exit iteration once found
		End If
	Next
	If oMyFPE Is Nothing Then
		MsgBox("Pattern Element At That Index Not Found!", vbCritical, "iLogic")
		Return
	End If
	'Toggle its suppressed status
	oMyFPE.Suppressed = Not oMyFPE.Suppressed
	oPDoc.Update()
End Sub
```

#### Code Block 3

```vb
Sub Main
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	Dim oRPFs As RectangularPatternFeatures = oPDoc.ComponentDefinition.Features.RectangularPatternFeatures
	Dim oMyRPF As RectangularPatternFeature = Nothing
	For Each oRPF As RectangularPatternFeature In oRPFs
		If oRPF.Name = "Rectangular Pattern1" Then
			oMyRPF = oRPF
			Exit For 'exit iteration once found
		End If
	Next
	If oMyRPF Is Nothing Then
		MsgBox("Pattern Not Found!", vbCritical, "iLogic")
		Return
	End If
	Dim oMyFPE As FeaturePatternElement = Nothing
	For Each oFPE As FeaturePatternElement In oMyRPF.PatternElements
		If oFPE.Index = 8 Then
			oMyFPE = oFPE
			Exit For 'exit iteration once found
		End If
	Next
	If oMyFPE Is Nothing Then
		MsgBox("Pattern Element At That Index Not Found!", vbCritical, "iLogic")
		Return
	End If
	'Toggle its suppressed status
	oMyFPE.Suppressed = Not oMyFPE.Suppressed
	oPDoc.Update()
End Sub
```

#### Code Block 4

```vb
Sub Main
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	Dim oRPFs As RectangularPatternFeatures = oPDoc.ComponentDefinition.Features.RectangularPatternFeatures
	Dim oMyRPF As RectangularPatternFeature = Nothing
	For Each oRPF As RectangularPatternFeature In oRPFs
		If oRPF.Name = "Rectangular Pattern1" Then
			oMyRPF = oRPF
			Exit For 'exit iteration once found
		End If
	Next
	If oMyRPF Is Nothing Then
		MsgBox("Pattern Not Found!", vbCritical, "iLogic")
		Return
	End If
	Dim oMyFPE As FeaturePatternElement = Nothing
	For Each oFPE As FeaturePatternElement In oMyRPF.PatternElements
		If oFPE.Index = 8 Then
			oMyFPE = oFPE
			Exit For 'exit iteration once found
		End If
	Next
	If oMyFPE Is Nothing Then
		MsgBox("Pattern Element At That Index Not Found!", vbCritical, "iLogic")
		Return
	End If
	'Toggle its suppressed status
	oMyFPE.Suppressed = Not oMyFPE.Suppressed
	oPDoc.Update()
End Sub
```

#### Code Block 5

```vb
Sub Main
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	Dim oRPFs As RectangularPatternFeatures = oPDoc.ComponentDefinition.Features.RectangularPatternFeatures
	Dim oMyRPF As RectangularPatternFeature = Nothing
	For Each oRPF As RectangularPatternFeature In oRPFs
		If oRPF.Name = "Rectangular Pattern1" Then
			oMyRPF = oRPF
			Exit For 'exit iteration once found
		End If
	Next
	If oMyRPF Is Nothing Then
		MsgBox("Pattern Not Found!", vbCritical, "iLogic")
		Return
	End If
	Dim oMyFPE As FeaturePatternElement = Nothing
	For Each oFPE As FeaturePatternElement In oMyRPF.PatternElements
		If oFPE.Index = 8 Then
			oMyFPE = oFPE
			Exit For 'exit iteration once found
		End If
	Next
	If oMyFPE Is Nothing Then
		MsgBox("Pattern Element At That Index Not Found!", vbCritical, "iLogic")
		Return
	End If
	'Toggle its suppressed status
	oMyFPE.Suppressed = Not oMyFPE.Suppressed
	oPDoc.Update()
End Sub
```

#### Code Block 6

```vb
Sub Main
	Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, Inventor.PartDocument)
	If oPDoc Is Nothing Then Return
	Dim oRPFs As RectangularPatternFeatures = oPDoc.ComponentDefinition.Features.RectangularPatternFeatures
	Dim oMyRPF As RectangularPatternFeature = Nothing
	For Each oRPF As RectangularPatternFeature In oRPFs
		If oRPF.Name = "Rectangular Pattern1" Then
			oMyRPF = oRPF
			Exit For 'exit iteration once found
		End If
	Next
	If oMyRPF Is Nothing Then
		MsgBox("Pattern Not Found!", vbCritical, "iLogic")
		Return
	End If
	Dim oMyFPE As FeaturePatternElement = Nothing
	For Each oFPE As FeaturePatternElement In oMyRPF.PatternElements
		If oFPE.Index = 8 Then
			oMyFPE = oFPE
			Exit For 'exit iteration once found
		End If
	Next
	If oMyFPE Is Nothing Then
		MsgBox("Pattern Element At That Index Not Found!", vbCritical, "iLogic")
		Return
	End If
	'Toggle its suppressed status
	oMyFPE.Suppressed = Not oMyFPE.Suppressed
	oPDoc.Update()
End Sub
```

---

### 76. Ilogic rule created by someone who left the company not working. Help needed

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-created-by-someone-who-left-the-company-not-working/td-p/13816478](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-created-by-someone-who-left-the-company-not-working/td-p/13816478)

**Author:** arnaud.henry-lefort

**Date:** ‎09-18-2025
	
		
		08:54 AM

**Description:** Hello, Sadly the person who did our ilogic left and since the last update the rules are not working anymore.I am wondering if someone can help to make them work again ?'Activate current document oDocType = ThisApplication.ActiveDocument  'hide error ThisApplication.SilentOperation = True  'Exit if c...

**Code Snippets (10):**

#### Code Block 1

```vb
'Activate current document
Dim InvApp As Inventor.Application = ThisApplication
Dim oDoc As Document = ThisDoc.Document
Dim oDocType As Inventor.DocumentTypeEnum = oDoc.DocumentType

'Exit if current document is a not and assembly
If Not oDocType = DocumentTypeEnum.kAssemblyDocumentObject Then	
	Exit Sub
End If

Dim oDef As AssemblyComponentDefinition = oDoc.componentdefinition
Dim AppearanceLibraryName As String = "Rootwave Finish Library"
Dim AppLib As AssetLibrary = Nothing

Try
	AppLib = InvApp.AssetLibraries.Item(AppearanceLibraryName)
Catch
	MsgBox("Couldn't find a appearance library called '" & AppearanceLibraryName,, "Error")
	Exit Sub
End Try

Dim AppColours As AssetsEnumerator = AppLib.AppearanceAssets
Dim ColourArray As New ArrayList

'hide error
InvApp.SilentOperation = True

' Write all the appearance names to an arraylist
For Each A As Asset In AppColours
    ColourArray.Add(A.DisplayName)
Next

 'Sort the array alphabetically
ColourArray.Sort()

' Create 3 parameters with the list of appearances in......
 'Parameter 1
Try
MultiValue.List("RootwaveFinish") = ColourArray
Catch
 'Parameter doesn't exist - create it
Dim oParam As Parameter = oDef.Parameters.UserParameters.AddByValue("RootwaveFinish", ColourArray(0), UnitsTypeEnum.kTextUnits)
MultiValue.List("RootwaveFinish") = ColourArray
End Try
InvApp.SilentOperation = False
```

#### Code Block 2

```vb
'Activate current document
Dim InvApp As Inventor.Application = ThisApplication
Dim oDoc As Document = ThisDoc.Document
Dim oDocType As Inventor.DocumentTypeEnum = oDoc.DocumentType

'Exit if current document is a not and assembly
If Not oDocType = DocumentTypeEnum.kAssemblyDocumentObject Then	
	Exit Sub
End If

Dim oDef As AssemblyComponentDefinition = oDoc.componentdefinition
Dim AppearanceLibraryName As String = "Rootwave Finish Library"
Dim AppLib As AssetLibrary = Nothing

Try
	AppLib = InvApp.AssetLibraries.Item(AppearanceLibraryName)
Catch
	MsgBox("Couldn't find a appearance library called '" & AppearanceLibraryName,, "Error")
	Exit Sub
End Try

Dim AppColours As AssetsEnumerator = AppLib.AppearanceAssets
Dim ColourArray As New ArrayList

'hide error
InvApp.SilentOperation = True

' Write all the appearance names to an arraylist
For Each A As Asset In AppColours
    ColourArray.Add(A.DisplayName)
Next

 'Sort the array alphabetically
ColourArray.Sort()

' Create 3 parameters with the list of appearances in......
 'Parameter 1
Try
MultiValue.List("RootwaveFinish") = ColourArray
Catch
 'Parameter doesn't exist - create it
Dim oParam As Parameter = oDef.Parameters.UserParameters.AddByValue("RootwaveFinish", ColourArray(0), UnitsTypeEnum.kTextUnits)
MultiValue.List("RootwaveFinish") = ColourArray
End Try
InvApp.SilentOperation = False
```

#### Code Block 3

```vb
'Activate current document
oDocType = ThisApplication.ActiveDocument

'hide error
ThisApplication.SilentOperation = True

'Exit if current document is a drawing
If oDocType = kDrawingDocumentObject Then
	Return
End If

'Exit if current document is a not and assembly
If oDocType <> kAssemblyDocumentObject Then
	Return
End If

Dim oDoc As Document = ThisDoc.Document
Dim oDef As AssemblyDocument = oDoc
Dim AppearanceLibraryName As String = "Rootwave Finish Library"

' Get the appearance library
Dim AppLib As AssetLibrary = Nothing
Try
	AppLib = ThisApplication.AssetLibraries.Item(AppearanceLibraryName)
Catch
	MsgBox("Couldn't find a appearance library called '" & AppearanceLibraryName,, "Error")
	Exit Sub
End Try

Dim AppColours As AssetsEnumerator = AppLib.AppearanceAssets
Dim ColourArray As New ArrayList

' Write all the appearance names to an arraylist
For Each A As Asset In AppColours
    ColourArray.Add(A.DisplayName)
Next

 Sort the array alphabetically
ColourArray.Sort()

' Create 3 parameters with the list of appearances in......

 Parameter 1
Try
MultiValue.List("RootwaveFinish") = ColourArray
Catch
 Parameter doesn't exist - create it
Dim oParam As Parameter = oDef.Parameters.UserParameters.AddByValue("RootwaveFinish", ColourArray(0), UnitsTypeEnum.kTextUnits)
MultiValue.List("RootwaveFinish") = ColourArray
End Try
```

#### Code Block 4

```vb
'Activate current document
oDocType = ThisApplication.ActiveDocumentType

'hide error
ThisApplication.SilentOperation = True

'Exit if current document is a not and assembly
If oDocType <> kAssemblyDocumentObject Then
	Return
End If

Dim oDoc As Document = ThisDoc.Document
Dim oDef As AssemblyComponentDefinition = oDoc.componentdefinition
Dim AppearanceLibraryName As String = "Rootwave Finish Library"

' Get the appearance library
Dim AppLib As AssetLibrary = Nothing
Try
	AppLib = ThisApplication.AssetLibraries.Item(AppearanceLibraryName)
Catch
	MsgBox("Couldn't find a appearance library called '" & AppearanceLibraryName,, "Error")
	Exit Sub
End Try

Dim AppColours As AssetsEnumerator = AppLib.AppearanceAssets
Dim ColourArray As New ArrayList

' Write all the appearance names to an arraylist
For Each A As Asset In AppColours
    ColourArray.Add(A.DisplayName)
Next

 'Sort the array alphabetically
ColourArray.Sort()

' Create 3 parameters with the list of appearances in......

 'Parameter 1
Try
MultiValue.List("RootwaveFinish") = ColourArray
Catch
 'Parameter doesn't exist - create it
Dim oParam As Parameter = oDef.Parameters.UserParameters.AddByValue("RootwaveFinish", ColourArray(0), UnitsTypeEnum.kTextUnits)
MultiValue.List("RootwaveFinish") = ColourArray
End Try
ThisApplication.SilentOperation = False
```

#### Code Block 5

```vb
'Sort the array alphabetically
ColourArray.Sort()

' Create 3 parameters with the list of appearances in......

 'Parameter 1
```

#### Code Block 6

```vb
Dim oDef As AssemblyComponentDefinition = oDoc.componentdefinition
```

#### Code Block 7

```vb
Dim oDef As AssemblyDocument = oDoc
```

#### Code Block 8

```vb
Sort the array alphabetically
ColourArray.Sort()

' Create 3 parameters with the list of appearances in......

 Parameter 1
```

#### Code Block 9

```vb
oDocType = ThisApplication.ActiveDocument
```

#### Code Block 10

```vb
oDocType = ThisApplication.ActiveDocumentType
```

---

### 77. Ilogic select all views on a sheet and change iproperty of assembly

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-select-all-views-on-a-sheet-and-change-iproperty-of/td-p/13835965](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-select-all-views-on-a-sheet-and-change-iproperty-of/td-p/13835965)

**Author:** graham_smithYMAHX

**Date:** ‎10-03-2025
	
		
		06:19 AM

**Description:** I am working on some workflow automation but am very new to Ilogic, and would like to minimize the necessary steps to a single code execution.  At the moment my cobbled together code is reliant on commandmanager.pick, but I'd like to change it to execute the code and change every assembly's iprop va...

**Code Snippets (1):**

#### Code Block 1

```vb
Dim oDDoc As DrawingDocument = ThisDoc.Document
Dim oSheet As Inventor.Sheet = oDDoc.ActiveSheet
Dim sSheetNumber As String = oSheet.Name.Split(":").Last

Dim oView As DrawingView = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select a drawing view of part.")
If oView Is Nothing Then Return
Dim oViewDoc As Inventor.Document = oView.ReferencedDocumentDescriptor.ReferencedDocument
Dim oViewDocCProps As Inventor.PropertySet = oViewDoc.PropertySets.Item(4)
Dim oViewDocCProp As Inventor.Property = Nothing
For Each oView In oSheet.DrawingViews
Try
	oViewDocCProp = oViewDocCProps.Item("Sheet #")
	oViewDocCProp.Value = sSheetNumber
Catch
	oViewDocCProp = oViewDocCProps.Add(sSheetNumber, "Sheet #")
End Try
Next
```

---

### 78. Inventor 2025 &quot;The file was modified by a rule that ran on check-in.&quot;

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/inventor-2025-quot-the-file-was-modified-by-a-rule-that-ran-on/td-p/13787732](https://forums.autodesk.com/t5/inventor-programming-forum/inventor-2025-quot-the-file-was-modified-by-a-rule-that-ran-on/td-p/13787732)

**Author:** trohar

**Date:** ‎08-28-2025
	
		
		02:04 PM

**Description:** We run an iLogic code to tidy a bunch of things in files. Ideally it would be good to run this rule on Check-in but when doing so the error "The file was modified by a rule that ran on check-in." is thrown. Reading this article "The file was modified by a rule that ran on check-in." when check-in a ...

**Code Snippets (2):**

#### Code Block 1

```vb
Try
	Logger.Info(ThisApplication.CommandManager.ActiveCommand)
Catch
	Logger.Info("No active command")
	Exit Sub
End Try

If ThisApplication.CommandManager.ActiveCommand = "VaultCheckin" Then
	Dim doc As DrawingDocument = ThisDoc.Document
	Dim r As New Random
	Dim pt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(8*2.54*r.NextDouble(), 11*2.54*r.NextDouble())
	doc.Sheets.Item(1).DrawingNotes.GeneralNotes.AddFitted(pt, "Test")
	ThisDoc.Save
End If
```

#### Code Block 2

```vb
Try
	Logger.Info(ThisApplication.CommandManager.ActiveCommand)
Catch
	Logger.Info("No active command")
	Exit Sub
End Try

If ThisApplication.CommandManager.ActiveCommand = "VaultCheckin" Then
	Dim doc As DrawingDocument = ThisDoc.Document
	Dim r As New Random
	Dim pt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(8*2.54*r.NextDouble(), 11*2.54*r.NextDouble())
	doc.Sheets.Item(1).DrawingNotes.GeneralNotes.AddFitted(pt, "Test")
	ThisDoc.Save
End If
```

#### Code Block 3

```vb
Try
	Logger.Info(ThisApplication.CommandManager.ActiveCommand)
Catch
	Logger.Info("No active command")
	Exit Sub
End Try

If ThisApplication.CommandManager.ActiveCommand = "VaultCheckin" Then
	Dim doc As DrawingDocument = ThisDoc.Document
	Dim r As New Random
	Dim pt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(8*2.54*r.NextDouble(), 11*2.54*r.NextDouble())
	doc.Sheets.Item(1).DrawingNotes.GeneralNotes.AddFitted(pt, "Test")
	ThisDoc.Save
End If
```

#### Code Block 4

```vb
Try
	Logger.Info(ThisApplication.CommandManager.ActiveCommand)
Catch
	Logger.Info("No active command")
	Exit Sub
End Try

If ThisApplication.CommandManager.ActiveCommand = "VaultCheckin" Then
	Dim doc As DrawingDocument = ThisDoc.Document
	Dim r As New Random
	Dim pt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(8*2.54*r.NextDouble(), 11*2.54*r.NextDouble())
	doc.Sheets.Item(1).DrawingNotes.GeneralNotes.AddFitted(pt, "Test")
	ThisDoc.Save
End If
```

---

### 79. Is there a faster method than DataIO.WriteDataToFile for exporting DXF's?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/is-there-a-faster-method-than-dataio-writedatatofile-for/td-p/13746690](https://forums.autodesk.com/t5/inventor-programming-forum/is-there-a-faster-method-than-dataio-writedatatofile-for/td-p/13746690)

**Author:** jake_egley

**Date:** ‎07-30-2025
	
		
		08:25 AM

**Description:** I know I'm splitting hairs... I have a rule that iterates through an assembly and makes a DXF for each sheetmetal part. I noticed all of the code is fast except for the "DataIO.WriteDataToFile" line which takes about 0.3 seconds. On an assembly with 100 sheet metal parts, it may take a total of 30 s...

**Code Snippets (2):**

#### Code Block 1

```vb
Public Class ThisRule
	
Private vaultAddinID As String = "{48B682BC-42E6-4953-84C5-3D253B52E77B}"
Private vaultAddin As ApplicationAddIn

	Sub Main()
	
	vaultAddin = ThisApplication.ApplicationAddIns.ItemById(vaultAddinID)
	vaultAddin.Deactivate()
	
	On Error Resume Next
	
	'check that the active document is an assembly file
	If ThisApplication.ActiveDocument.DocumentType <> kAssemblyDocumentObject Then
	MessageBox.Show ("Please run this rule from an assembly containing sheet metal parts.", "Autodesk Inventor", MessageBoxButtons.OK, MessageBoxIcon.Error)
	vaultAddin.Activate()
	Exit Sub
	End If

	Dim oBOM As BOM
	Dim oDoc As Document
	Dim oAsmDoc As AssemblyDocument
	Dim oFileDir As String
	Dim PQty As String
	Dim oPartsOnlyBOMView As BOMView
	Dim oBomRow As BOMRow
	Dim oFace As Face
	Dim oFace1 As String
	Dim oEdge As Edge
	Dim oEvaluator As CurveEvaluator
	Dim minparam As Double
	Dim maxparam As Double
	Dim length As Double
	Dim Laser As Double
	Dim LaserInchs As Double
	Dim oLaser As String
	Dim oSelectSet As SelectSet
	Dim Area As Double
	Dim oArea As Double
	Dim oSumArea As Double
	Dim counter As Integer
	Dim Holes As Integer
	Dim oDTProps As PropertySet
	Dim oWidth As String
	Dim oLength As String
	Dim MSdata(10000, 10)
	Dim sFName As String
	Dim failcounter As Integer
	Dim newcounter As Integer
	Dim sOut As String
	Dim FailedPart(10000)
	Dim i As Integer
	Dim MsgString As String
	Dim oDataIO As DataIO
	Dim oMat As String
	Dim path As String
	Dim UserName As String
	Dim oSheetMetalCompDef As SheetMetalComponentDefinition
	Dim fp As FlatPattern
	Dim CivilianHour As String
	Dim AMorPM As String
	Dim oDocType As AssemblyDocument
	Dim asmTemplate As String
	Dim TempAsm As AssemblyDocument
	Dim position As Matrix
	Dim occ As ComponentOccurrence
	Dim DocPath As String
	Dim AName As String
	Dim oBends As FlatBendResults
	Dim Bends As Integer	
	Dim Formed As String
	Dim AnythingFormed As String

	'creates DXF_CABINET folder for outputting files if it doesn't already exist on the users C drive
	path = "C:\DXF_CABINET\"
	If Len(Dir(path, vbDirectory)) = 0 Then
	    MkDir (path)
	    Else 'do nothing
	End If

	Dim Date1 As String
	Dim Hour As String
	Dim Time As DateTime = DateTime.Now
	Dim Format As String = "MM-dd-yyyy"
	Date1 = Time.ToString(Format)
	Hour = Time.ToString("HH")
	Dim MinAndSec As String = Time.ToString("mm.ss")
	If Hour = "13" Then
	    CivilianHour = "1"
	    AMorPM = "PM"
	ElseIf Hour = "14" Then
		CivilianHour = "2"
		AMorPM = "PM"
	ElseIf Hour = "15" Then
		CivilianHour = "3"
		AMorPM = "PM"	
	ElseIf Hour = "16" Then
		CivilianHour = "4"
		AMorPM = "PM"	
	ElseIf Hour = "17" Then
		CivilianHour = "5"
		AMorPM = "PM"	
	ElseIf Hour = "18" Then
		CivilianHour = "6"
		AMorPM = "PM"	
	ElseIf Hour = "19" Then
		CivilianHour = "7"
		AMorPM = "PM"	
	ElseIf Hour = "20" Then
		CivilianHour = "8"
		AMorPM = "PM"	
	ElseIf Hour = "21" Then
		CivilianHour = "9"
		AMorPM = "PM"	
	ElseIf Hour = "22" Then
		CivilianHour = "10"
		AMorPM = "PM"	
	ElseIf Hour = "23" Then
		CivilianHour = "11"
		AMorPM = "PM"	
	Else
	    CivilianHour = Hour
	    AMorPM = "AM"
	End If
	
	'establish top level part number for the folder/file name
	FolderNumber = ThisApplication.ActiveDocument.PropertySets(3).Item("Part Number").Value


	path = "C:\DXF_CABINET\" & FolderNumber & "  " & Date1 & " at " & CivilianHour & "." & MinAndSec & " " & AMorPM
	MkDir (path)
	oFileDir = path & "\"

	oDoc = ThisApplication.ActiveDocument
	
	oAsmDoc = ThisApplication.ActiveDocument
		oDocType = ThisApplication.ActiveDocument
		
		oAsmNameProp = oAsmDoc.PropertySets(3).Item("Part Number")
		AName = oAsmNameProp.Value
		
		'check if its an iassembly and create a temporary assembly with the active member if so
		If oAsmDoc.ComponentDefinition.IsiAssemblyFactory = True Then
		    DocPath = oAsmDoc.FullFileName
		    asmTemplate = ThisApplication.FileManager.GetTemplateFile(kAssemblyDocumentObject) 'Your assembly template file here
		    TempAsm = ThisApplication.Documents.Add(DocumentTypeEnum.kAssemblyDocumentObject, asmTemplate, False)
		    position = ThisApplication.TransientGeometry.CreateMatrix()
		    occ = TempAsm.ComponentDefinition.Occurrences.AddiAssemblyMember(DocPath, position)
		    oAsmDoc = TempAsm
		End If
	
		oBOM = oAsmDoc.ComponentDefinition.BOM
		
		'Make sure that the parts only view is enabled.
		oBOM.PartsOnlyViewEnabled = True
		
		'Change Bom structure to Normal for all that are inseparable (doing this because weldments have an inseparable bom structure and we need to look at the bom)
		Dim ARD As Document
		For Each ARD In oAsmDoc.AllReferencedDocuments
		    If ARD.DocumentType = kAssemblyDocumentObject Or kPartDocumentObject Then
		        If ARD.ComponentDefinition.BOMStructure = Inventor.BOMStructureEnum.kInseparableBOMStructure Then
		            ARD.ComponentDefinition.BOMStructure = Inventor.BOMStructureEnum.kNormalBOMStructure
		        End If
		    End If
		Next ARD
		    
		' Set a reference to the "Parts Only" BOMView
		oPartsOnlyBOMView = oBOM.BOMViews.Item("Parts Only")
		
		For Each oBomRow In oPartsOnlyBOMView.BOMRows
		
		    oDoc = oBomRow.ComponentDefinitions(1).Document
		      
		    If oDoc.ComponentDefinition.Type = kSheetMetalComponentDefinitionObject Then
	        
	            oSheetMetalCompDef = oDoc.ComponentDefinition

	            If oSheetMetalCompDef.HasFlatPattern = False Then
	                oSheetMetalCompDef.Unfold
	                oSheetMetalCompDef.FlatPattern.ExitEdit
	            End If
	           
			    If oSheetMetalCompDef.HasFlatPattern = False Then  'after a fail checks if the part is a member of a factory which would be why it couldnt unbend
						If oDoc.ComponentDefinition.IsiPartMember Then
							
							Dim oPDoc As PartDocument
							oPDoc = oDoc
							Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
							Dim oPFactory As iPartFactory = Nothing
							
							oPFactory = oPDef.iPartMember.ParentFactory
							Dim oFactoryPDoc As PartDocument = oPFactory.Parent
							
							oSheetMetalCompDef = oFactoryPDoc.ComponentDefinition
							oSheetMetalCompDef.Unfold
		                	oSheetMetalCompDef.FlatPattern.ExitEdit
							
							Dim oRow As iPartTableRow
							For Each oRow In oFactoryPDoc.ComponentDefinition.iPartFactory.TableRows
							oFactoryPDoc.ComponentDefinition.iPartFactory.CreateMember(oRow)
							Next
							
							oDoc = oBomRow.ComponentDefinitions(1).Document

						End If
		        End If
			   
	            If oSheetMetalCompDef.HasFlatPattern = False Then  'records which parts failed to be displayed upon completion of ilogic if there are failed parts
	                oPartNameProp = oDoc.PropertySets(3).Item("Part Number")
	                sFName = oPartNameProp.Value
	                    If sFName = "" Then
	                        sFName = Replace(oDoc.DisplayName, ".ipt", "")
	                    End If
	               FailedPart(failcounter) = sFName
	               failcounter = failcounter + 1
	            Else
	            
	                fp = oSheetMetalCompDef.FlatPattern
	            
	                ' Get the DataIO object.
	                oDataIO = oDoc.ComponentDefinition.DataIO
	                
	                ' Set FileName
	                oPartNameProp = oDoc.PropertySets(3).Item("Part Number")
	                sFName = oPartNameProp.Value
	                    If sFName = "" Then
	                        sFName = Replace(oDoc.DisplayName, ".ipt", "")
	                    End If
	                
	                ' Build the string that defines the format of the DXF file.
	                sOut = "FLAT PATTERN DXF?AcadVersion=R12&SimplifySplines=true&FeatureProfilesUpLayerCOLOR=255;255;0&InvisibleLayers=IV_BEND;IV_BEND_DOWN;IV_TANGENT;IV_ARC_CENTERS;IV_FEATURE_PROFILES_DOWN;IV_TOOL_CENTER;IV_TOOL_CENTER_DOWN;IV_ROLL_TANGENT;IV_ALTREP_BACK;IV_ROLL;"
	                oMat = oDoc.PropertySets(3).Item("Material").Value
	                If InStr(oMat, "1/4 HSLA") > 0 Then
	                    oMat = Replace(oMat, "1/4", "1_4")
	                End If

'///////***************************************************************************//////////
'///////***************************************************************************//////////

 					oDataIO.WriteDataToFile( sOut, oFileDir & sFName & " - " & oMat & ".dxf")

'///////***************************************************************************//////////
'///////***************************************************************************//////////

	            End If
			End If
		Next
				
				If failcounter > 1 Then     'displays list of failed parts if there are any
		        While i < failcounter
		            MsgString = MsgString & FailedPart(i) & vbCr
		            i = i + 1
		        End While
			Dim Title As Object = "Attention"	
		    MessageBox.Show (MsgString,"Couldn't Unbend:  ", MessageBoxButtons.OK, MessageBoxIcon.Error)
		End If
		
		If oDocType.ComponentDefinition.IsiAssemblyFactory = True Then
		TempAsm.Close
		End If


	Shell("C:\WINDOWS\explorer.exe """ & oFileDir & "", vbNormalFocus) 'opens folder for user at finish

	vaultAddin.Activate()
	
	End Sub
End Class
```

#### Code Block 2

```vb
Public Class ThisRule
	
Private vaultAddinID As String = "{48B682BC-42E6-4953-84C5-3D253B52E77B}"
Private vaultAddin As ApplicationAddIn

	Sub Main()
	
	vaultAddin = ThisApplication.ApplicationAddIns.ItemById(vaultAddinID)
	vaultAddin.Deactivate()
	
	On Error Resume Next
	
	'check that the active document is an assembly file
	If ThisApplication.ActiveDocument.DocumentType <> kAssemblyDocumentObject Then
	MessageBox.Show ("Please run this rule from an assembly containing sheet metal parts.", "Autodesk Inventor", MessageBoxButtons.OK, MessageBoxIcon.Error)
	vaultAddin.Activate()
	Exit Sub
	End If

	Dim oBOM As BOM
	Dim oDoc As Document
	Dim oAsmDoc As AssemblyDocument
	Dim oFileDir As String
	Dim PQty As String
	Dim oPartsOnlyBOMView As BOMView
	Dim oBomRow As BOMRow
	Dim oFace As Face
	Dim oFace1 As String
	Dim oEdge As Edge
	Dim oEvaluator As CurveEvaluator
	Dim minparam As Double
	Dim maxparam As Double
	Dim length As Double
	Dim Laser As Double
	Dim LaserInchs As Double
	Dim oLaser As String
	Dim oSelectSet As SelectSet
	Dim Area As Double
	Dim oArea As Double
	Dim oSumArea As Double
	Dim counter As Integer
	Dim Holes As Integer
	Dim oDTProps As PropertySet
	Dim oWidth As String
	Dim oLength As String
	Dim MSdata(10000, 10)
	Dim sFName As String
	Dim failcounter As Integer
	Dim newcounter As Integer
	Dim sOut As String
	Dim FailedPart(10000)
	Dim i As Integer
	Dim MsgString As String
	Dim oDataIO As DataIO
	Dim oMat As String
	Dim path As String
	Dim UserName As String
	Dim oSheetMetalCompDef As SheetMetalComponentDefinition
	Dim fp As FlatPattern
	Dim CivilianHour As String
	Dim AMorPM As String
	Dim oDocType As AssemblyDocument
	Dim asmTemplate As String
	Dim TempAsm As AssemblyDocument
	Dim position As Matrix
	Dim occ As ComponentOccurrence
	Dim DocPath As String
	Dim AName As String
	Dim oBends As FlatBendResults
	Dim Bends As Integer	
	Dim Formed As String
	Dim AnythingFormed As String

	'creates DXF_CABINET folder for outputting files if it doesn't already exist on the users C drive
	path = "C:\DXF_CABINET\"
	If Len(Dir(path, vbDirectory)) = 0 Then
	    MkDir (path)
	    Else 'do nothing
	End If

	Dim Date1 As String
	Dim Hour As String
	Dim Time As DateTime = DateTime.Now
	Dim Format As String = "MM-dd-yyyy"
	Date1 = Time.ToString(Format)
	Hour = Time.ToString("HH")
	Dim MinAndSec As String = Time.ToString("mm.ss")
	If Hour = "13" Then
	    CivilianHour = "1"
	    AMorPM = "PM"
	ElseIf Hour = "14" Then
		CivilianHour = "2"
		AMorPM = "PM"
	ElseIf Hour = "15" Then
		CivilianHour = "3"
		AMorPM = "PM"	
	ElseIf Hour = "16" Then
		CivilianHour = "4"
		AMorPM = "PM"	
	ElseIf Hour = "17" Then
		CivilianHour = "5"
		AMorPM = "PM"	
	ElseIf Hour = "18" Then
		CivilianHour = "6"
		AMorPM = "PM"	
	ElseIf Hour = "19" Then
		CivilianHour = "7"
		AMorPM = "PM"	
	ElseIf Hour = "20" Then
		CivilianHour = "8"
		AMorPM = "PM"	
	ElseIf Hour = "21" Then
		CivilianHour = "9"
		AMorPM = "PM"	
	ElseIf Hour = "22" Then
		CivilianHour = "10"
		AMorPM = "PM"	
	ElseIf Hour = "23" Then
		CivilianHour = "11"
		AMorPM = "PM"	
	Else
	    CivilianHour = Hour
	    AMorPM = "AM"
	End If
	
	'establish top level part number for the folder/file name
	FolderNumber = ThisApplication.ActiveDocument.PropertySets(3).Item("Part Number").Value


	path = "C:\DXF_CABINET\" & FolderNumber & "  " & Date1 & " at " & CivilianHour & "." & MinAndSec & " " & AMorPM
	MkDir (path)
	oFileDir = path & "\"

	oDoc = ThisApplication.ActiveDocument
	
	oAsmDoc = ThisApplication.ActiveDocument
		oDocType = ThisApplication.ActiveDocument
		
		oAsmNameProp = oAsmDoc.PropertySets(3).Item("Part Number")
		AName = oAsmNameProp.Value
		
		'check if its an iassembly and create a temporary assembly with the active member if so
		If oAsmDoc.ComponentDefinition.IsiAssemblyFactory = True Then
		    DocPath = oAsmDoc.FullFileName
		    asmTemplate = ThisApplication.FileManager.GetTemplateFile(kAssemblyDocumentObject) 'Your assembly template file here
		    TempAsm = ThisApplication.Documents.Add(DocumentTypeEnum.kAssemblyDocumentObject, asmTemplate, False)
		    position = ThisApplication.TransientGeometry.CreateMatrix()
		    occ = TempAsm.ComponentDefinition.Occurrences.AddiAssemblyMember(DocPath, position)
		    oAsmDoc = TempAsm
		End If
	
		oBOM = oAsmDoc.ComponentDefinition.BOM
		
		'Make sure that the parts only view is enabled.
		oBOM.PartsOnlyViewEnabled = True
		
		'Change Bom structure to Normal for all that are inseparable (doing this because weldments have an inseparable bom structure and we need to look at the bom)
		Dim ARD As Document
		For Each ARD In oAsmDoc.AllReferencedDocuments
		    If ARD.DocumentType = kAssemblyDocumentObject Or kPartDocumentObject Then
		        If ARD.ComponentDefinition.BOMStructure = Inventor.BOMStructureEnum.kInseparableBOMStructure Then
		            ARD.ComponentDefinition.BOMStructure = Inventor.BOMStructureEnum.kNormalBOMStructure
		        End If
		    End If
		Next ARD
		    
		' Set a reference to the "Parts Only" BOMView
		oPartsOnlyBOMView = oBOM.BOMViews.Item("Parts Only")
		
		For Each oBomRow In oPartsOnlyBOMView.BOMRows
		
		    oDoc = oBomRow.ComponentDefinitions(1).Document
		      
		    If oDoc.ComponentDefinition.Type = kSheetMetalComponentDefinitionObject Then
	        
	            oSheetMetalCompDef = oDoc.ComponentDefinition

	            If oSheetMetalCompDef.HasFlatPattern = False Then
	                oSheetMetalCompDef.Unfold
	                oSheetMetalCompDef.FlatPattern.ExitEdit
	            End If
	           
			    If oSheetMetalCompDef.HasFlatPattern = False Then  'after a fail checks if the part is a member of a factory which would be why it couldnt unbend
						If oDoc.ComponentDefinition.IsiPartMember Then
							
							Dim oPDoc As PartDocument
							oPDoc = oDoc
							Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
							Dim oPFactory As iPartFactory = Nothing
							
							oPFactory = oPDef.iPartMember.ParentFactory
							Dim oFactoryPDoc As PartDocument = oPFactory.Parent
							
							oSheetMetalCompDef = oFactoryPDoc.ComponentDefinition
							oSheetMetalCompDef.Unfold
		                	oSheetMetalCompDef.FlatPattern.ExitEdit
							
							Dim oRow As iPartTableRow
							For Each oRow In oFactoryPDoc.ComponentDefinition.iPartFactory.TableRows
							oFactoryPDoc.ComponentDefinition.iPartFactory.CreateMember(oRow)
							Next
							
							oDoc = oBomRow.ComponentDefinitions(1).Document

						End If
		        End If
			   
	            If oSheetMetalCompDef.HasFlatPattern = False Then  'records which parts failed to be displayed upon completion of ilogic if there are failed parts
	                oPartNameProp = oDoc.PropertySets(3).Item("Part Number")
	                sFName = oPartNameProp.Value
	                    If sFName = "" Then
	                        sFName = Replace(oDoc.DisplayName, ".ipt", "")
	                    End If
	               FailedPart(failcounter) = sFName
	               failcounter = failcounter + 1
	            Else
	            
	                fp = oSheetMetalCompDef.FlatPattern
	            
	                ' Get the DataIO object.
	                oDataIO = oDoc.ComponentDefinition.DataIO
	                
	                ' Set FileName
	                oPartNameProp = oDoc.PropertySets(3).Item("Part Number")
	                sFName = oPartNameProp.Value
	                    If sFName = "" Then
	                        sFName = Replace(oDoc.DisplayName, ".ipt", "")
	                    End If
	                
	                ' Build the string that defines the format of the DXF file.
	                sOut = "FLAT PATTERN DXF?AcadVersion=R12&SimplifySplines=true&FeatureProfilesUpLayerCOLOR=255;255;0&InvisibleLayers=IV_BEND;IV_BEND_DOWN;IV_TANGENT;IV_ARC_CENTERS;IV_FEATURE_PROFILES_DOWN;IV_TOOL_CENTER;IV_TOOL_CENTER_DOWN;IV_ROLL_TANGENT;IV_ALTREP_BACK;IV_ROLL;"
	                oMat = oDoc.PropertySets(3).Item("Material").Value
	                If InStr(oMat, "1/4 HSLA") > 0 Then
	                    oMat = Replace(oMat, "1/4", "1_4")
	                End If

'///////***************************************************************************//////////
'///////***************************************************************************//////////

 					oDataIO.WriteDataToFile( sOut, oFileDir & sFName & " - " & oMat & ".dxf")

'///////***************************************************************************//////////
'///////***************************************************************************//////////

	            End If
			End If
		Next
				
				If failcounter > 1 Then     'displays list of failed parts if there are any
		        While i < failcounter
		            MsgString = MsgString & FailedPart(i) & vbCr
		            i = i + 1
		        End While
			Dim Title As Object = "Attention"	
		    MessageBox.Show (MsgString,"Couldn't Unbend:  ", MessageBoxButtons.OK, MessageBoxIcon.Error)
		End If
		
		If oDocType.ComponentDefinition.IsiAssemblyFactory = True Then
		TempAsm.Close
		End If


	Shell("C:\WINDOWS\explorer.exe """ & oFileDir & "", vbNormalFocus) 'opens folder for user at finish

	vaultAddin.Activate()
	
	End Sub
End Class
```

---

### 80. Issue with Vault revision table

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/issue-with-vault-revision-table/td-p/13767703#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/issue-with-vault-revision-table/td-p/13767703#messageview_0)

**Author:** mgrenier1

**Date:** ‎08-14-2025
	
		
		08:07 AM

**Description:** I'm having a very annoying issue with Vault and Job Processor. Whenever the Job Processor updates the revision table, the revision table gets moved around to a random(but maybe not so random) spot on my sheet. I came up with an iLogic rule to move the rev table to where i should go, however, when I ...

**Code Snippets (8):**

#### Code Block 1

```vb
Dim oDoc As DrawingDocument = TryCast(app.ActiveDocument, DrawingDocument )
    If oDoc Is Nothing Then Exit Sub
```

#### Code Block 2

```vb
Dim oDoc As DrawingDocument = TryCast(app.ActiveDocument, DrawingDocument )
    If oDoc Is Nothing Then Exit Sub
```

#### Code Block 3

```vb
Dim oDoc As DrawingDocument = TryCast(app.ActiveDocument, DrawingDocument )
    If oDoc Is Nothing Then Exit Sub
```

#### Code Block 4

```vb
Dim oDoc As DrawingDocument = TryCast(app.ActiveDocument, DrawingDocument )
    If oDoc Is Nothing Then Exit Sub
```

#### Code Block 5

```vb
Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub
```

#### Code Block 6

```vb
Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub
```

#### Code Block 7

```vb
Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub
```

#### Code Block 8

```vb
Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub
```

#### Code Block 9

```vb
Sub Main()
    Dim app As Application = ThisApplication
    Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub

    Dim oSheet As Sheet = oDoc.ActiveSheet
    If oSheet.RevisionTables.Count = 0 Then Exit Sub

    Dim oRevTable As RevisionTable = oSheet.RevisionTables.Item(1)

    ' Coin inférieur gauche du cartouche
    Dim cartouchePos As Point2d = oSheet.TitleBlock.Position

    ' Décalage depuis le coin inférieur gauche du cartouche (en cm)
    Dim offsetX As Double = 4*2.54   ' ex.: 2 cm depuis le bord gauche du cartouche
    Dim offsetY As Double = 4.75*2.54   ' ex.: 0.5 cm depuis le bord bas du cartouche

    ' Point cible bas-gauche du tableau sur la feuille
    Dim targetX As Double = cartouchePos.X + offsetX
    Dim targetY As Double = cartouchePos.Y + offsetY

    ' Boîte englobante actuelle du tableau
    Dim box As Box2d = oRevTable.RangeBox
    Dim anchor As Point2d = oRevTable.Position

    ' Vecteur du point d’ancrage actuel vers le bas-gauche réel
    Dim vX As Double = box.MinPoint.X - anchor.X
    Dim vY As Double = box.MinPoint.Y - anchor.Y

    ' Calculer le nouvel ancrage pour aligner le bas-gauche sur la cible
    Dim TG As TransientGeometry = app.TransientGeometry
    Dim newAnchor As Point2d = TG.CreatePoint2d(targetX - vX, targetY - vY)

    ' Positionner le tableau
    oRevTable.Position = newAnchor
End Sub
```

#### Code Block 10

```vb
Sub Main()
    Dim app As Application = ThisApplication
    Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub

    Dim oSheet As Sheet = oDoc.ActiveSheet
    If oSheet.RevisionTables.Count = 0 Then Exit Sub

    Dim oRevTable As RevisionTable = oSheet.RevisionTables.Item(1)

    ' Coin inférieur gauche du cartouche
    Dim cartouchePos As Point2d = oSheet.TitleBlock.Position

    ' Décalage depuis le coin inférieur gauche du cartouche (en cm)
    Dim offsetX As Double = 4*2.54   ' ex.: 2 cm depuis le bord gauche du cartouche
    Dim offsetY As Double = 4.75*2.54   ' ex.: 0.5 cm depuis le bord bas du cartouche

    ' Point cible bas-gauche du tableau sur la feuille
    Dim targetX As Double = cartouchePos.X + offsetX
    Dim targetY As Double = cartouchePos.Y + offsetY

    ' Boîte englobante actuelle du tableau
    Dim box As Box2d = oRevTable.RangeBox
    Dim anchor As Point2d = oRevTable.Position

    ' Vecteur du point d’ancrage actuel vers le bas-gauche réel
    Dim vX As Double = box.MinPoint.X - anchor.X
    Dim vY As Double = box.MinPoint.Y - anchor.Y

    ' Calculer le nouvel ancrage pour aligner le bas-gauche sur la cible
    Dim TG As TransientGeometry = app.TransientGeometry
    Dim newAnchor As Point2d = TG.CreatePoint2d(targetX - vX, targetY - vY)

    ' Positionner le tableau
    oRevTable.Position = newAnchor
End Sub
```

#### Code Block 11

```vb
Sub Main()
    Dim app As Application = ThisApplication
    Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub

    Dim oSheet As Sheet = oDoc.ActiveSheet
    If oSheet.RevisionTables.Count = 0 Then Exit Sub

    Dim oRevTable As RevisionTable = oSheet.RevisionTables.Item(1)

    ' Coin inférieur gauche du cartouche
    Dim cartouchePos As Point2d = oSheet.TitleBlock.Position

    ' Décalage depuis le coin inférieur gauche du cartouche (en cm)
    Dim offsetX As Double = 4*2.54   ' ex.: 2 cm depuis le bord gauche du cartouche
    Dim offsetY As Double = 4.75*2.54   ' ex.: 0.5 cm depuis le bord bas du cartouche

    ' Point cible bas-gauche du tableau sur la feuille
    Dim targetX As Double = cartouchePos.X + offsetX
    Dim targetY As Double = cartouchePos.Y + offsetY

    ' Boîte englobante actuelle du tableau
    Dim box As Box2d = oRevTable.RangeBox
    Dim anchor As Point2d = oRevTable.Position

    ' Vecteur du point d’ancrage actuel vers le bas-gauche réel
    Dim vX As Double = box.MinPoint.X - anchor.X
    Dim vY As Double = box.MinPoint.Y - anchor.Y

    ' Calculer le nouvel ancrage pour aligner le bas-gauche sur la cible
    Dim TG As TransientGeometry = app.TransientGeometry
    Dim newAnchor As Point2d = TG.CreatePoint2d(targetX - vX, targetY - vY)

    ' Positionner le tableau
    oRevTable.Position = newAnchor
End Sub
```

#### Code Block 12

```vb
Sub Main()
    Dim app As Application = ThisApplication
    Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub

    Dim oSheet As Sheet = oDoc.ActiveSheet
    If oSheet.RevisionTables.Count = 0 Then Exit Sub

    Dim oRevTable As RevisionTable = oSheet.RevisionTables.Item(1)

    ' Coin inférieur gauche du cartouche
    Dim cartouchePos As Point2d = oSheet.TitleBlock.Position

    ' Décalage depuis le coin inférieur gauche du cartouche (en cm)
    Dim offsetX As Double = 4*2.54   ' ex.: 2 cm depuis le bord gauche du cartouche
    Dim offsetY As Double = 4.75*2.54   ' ex.: 0.5 cm depuis le bord bas du cartouche

    ' Point cible bas-gauche du tableau sur la feuille
    Dim targetX As Double = cartouchePos.X + offsetX
    Dim targetY As Double = cartouchePos.Y + offsetY

    ' Boîte englobante actuelle du tableau
    Dim box As Box2d = oRevTable.RangeBox
    Dim anchor As Point2d = oRevTable.Position

    ' Vecteur du point d’ancrage actuel vers le bas-gauche réel
    Dim vX As Double = box.MinPoint.X - anchor.X
    Dim vY As Double = box.MinPoint.Y - anchor.Y

    ' Calculer le nouvel ancrage pour aligner le bas-gauche sur la cible
    Dim TG As TransientGeometry = app.TransientGeometry
    Dim newAnchor As Point2d = TG.CreatePoint2d(targetX - vX, targetY - vY)

    ' Positionner le tableau
    oRevTable.Position = newAnchor
End Sub
```

#### Code Block 13

```vb
Sub Main()
    Dim app As Application = ThisApplication
    Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub

    Dim offsetX As Double = 4*2.54
    Dim offsetY As Double = 4.75*2.54

    For Each oSheet As Sheet In oDoc.Sheets
        ' Vérifier qu'il y a au moins un tableau
        If oSheet.RevisionTables.Count = 0 Then Continue For

        Dim oRevTable As RevisionTable = oSheet.RevisionTables.Item(1)

        ' Vérification préalable : uniquement si la feuille est active
        If oSheet.Name <> oDoc.ActiveSheet.Name Then
            ' Skip ou copier les valeurs du tableau pour éviter le crash
            Continue For
        End If

        ' Coin inférieur gauche du cartouche
        Dim cartouchePos As Point2d = oSheet.TitleBlock.Position
        Dim targetX As Double = cartouchePos.X + offsetX
        Dim targetY As Double = cartouchePos.Y + offsetY

        ' Boîte englobante du tableau
        Dim box As Box2d = oRevTable.RangeBox
        Dim anchor As Point2d = oRevTable.Position

        Dim vX As Double = box.MinPoint.X - anchor.X
        Dim vY As Double = box.MinPoint.Y - anchor.Y

        Dim TG As TransientGeometry = app.TransientGeometry
        Dim newAnchor As Point2d = TG.CreatePoint2d(targetX - vX, targetY - vY)

        oRevTable.Position = newAnchor
    Next
End Sub
```

#### Code Block 14

```vb
Sub Main()
    Dim app As Application = ThisApplication
    Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub

    Dim offsetX As Double = 4*2.54
    Dim offsetY As Double = 4.75*2.54

    For Each oSheet As Sheet In oDoc.Sheets
        ' Vérifier qu'il y a au moins un tableau
        If oSheet.RevisionTables.Count = 0 Then Continue For

        Dim oRevTable As RevisionTable = oSheet.RevisionTables.Item(1)

        ' Vérification préalable : uniquement si la feuille est active
        If oSheet.Name <> oDoc.ActiveSheet.Name Then
            ' Skip ou copier les valeurs du tableau pour éviter le crash
            Continue For
        End If

        ' Coin inférieur gauche du cartouche
        Dim cartouchePos As Point2d = oSheet.TitleBlock.Position
        Dim targetX As Double = cartouchePos.X + offsetX
        Dim targetY As Double = cartouchePos.Y + offsetY

        ' Boîte englobante du tableau
        Dim box As Box2d = oRevTable.RangeBox
        Dim anchor As Point2d = oRevTable.Position

        Dim vX As Double = box.MinPoint.X - anchor.X
        Dim vY As Double = box.MinPoint.Y - anchor.Y

        Dim TG As TransientGeometry = app.TransientGeometry
        Dim newAnchor As Point2d = TG.CreatePoint2d(targetX - vX, targetY - vY)

        oRevTable.Position = newAnchor
    Next
End Sub
```

#### Code Block 15

```vb
Sub Main()
    Dim app As Application = ThisApplication
    Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub

    Dim offsetX As Double = 4*2.54
    Dim offsetY As Double = 4.75*2.54

    For Each oSheet As Sheet In oDoc.Sheets
        ' Vérifier qu'il y a au moins un tableau
        If oSheet.RevisionTables.Count = 0 Then Continue For

        Dim oRevTable As RevisionTable = oSheet.RevisionTables.Item(1)

        ' Vérification préalable : uniquement si la feuille est active
        If oSheet.Name <> oDoc.ActiveSheet.Name Then
            ' Skip ou copier les valeurs du tableau pour éviter le crash
            Continue For
        End If

        ' Coin inférieur gauche du cartouche
        Dim cartouchePos As Point2d = oSheet.TitleBlock.Position
        Dim targetX As Double = cartouchePos.X + offsetX
        Dim targetY As Double = cartouchePos.Y + offsetY

        ' Boîte englobante du tableau
        Dim box As Box2d = oRevTable.RangeBox
        Dim anchor As Point2d = oRevTable.Position

        Dim vX As Double = box.MinPoint.X - anchor.X
        Dim vY As Double = box.MinPoint.Y - anchor.Y

        Dim TG As TransientGeometry = app.TransientGeometry
        Dim newAnchor As Point2d = TG.CreatePoint2d(targetX - vX, targetY - vY)

        oRevTable.Position = newAnchor
    Next
End Sub
```

#### Code Block 16

```vb
Sub Main()
    Dim app As Application = ThisApplication
    Dim oDoc As DrawingDocument = app.ActiveDocument
    If oDoc Is Nothing Then Exit Sub
    If oDoc.DocumentType <> kDrawingDocumentObject Then Exit Sub

    Dim offsetX As Double = 4*2.54
    Dim offsetY As Double = 4.75*2.54

    For Each oSheet As Sheet In oDoc.Sheets
        ' Vérifier qu'il y a au moins un tableau
        If oSheet.RevisionTables.Count = 0 Then Continue For

        Dim oRevTable As RevisionTable = oSheet.RevisionTables.Item(1)

        ' Vérification préalable : uniquement si la feuille est active
        If oSheet.Name <> oDoc.ActiveSheet.Name Then
            ' Skip ou copier les valeurs du tableau pour éviter le crash
            Continue For
        End If

        ' Coin inférieur gauche du cartouche
        Dim cartouchePos As Point2d = oSheet.TitleBlock.Position
        Dim targetX As Double = cartouchePos.X + offsetX
        Dim targetY As Double = cartouchePos.Y + offsetY

        ' Boîte englobante du tableau
        Dim box As Box2d = oRevTable.RangeBox
        Dim anchor As Point2d = oRevTable.Position

        Dim vX As Double = box.MinPoint.X - anchor.X
        Dim vY As Double = box.MinPoint.Y - anchor.Y

        Dim TG As TransientGeometry = app.TransientGeometry
        Dim newAnchor As Point2d = TG.CreatePoint2d(targetX - vX, targetY - vY)

        oRevTable.Position = newAnchor
    Next
End Sub
```

---

### 81. Issues with SurfaceBody.CalculateFacets in Inventor 2025 Add-in (.NET 8 / x64)

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/issues-with-surfacebody-calculatefacets-in-inventor-2025-add-in/td-p/13736696](https://forums.autodesk.com/t5/inventor-programming-forum/issues-with-surfacebody-calculatefacets-in-inventor-2025-add-in/td-p/13736696)

**Author:** ewoudQDYF4

**Date:** ‎07-23-2025
	
		
		06:11 AM

**Description:** Hi everyone,I’m working on an Inventor 2025 add-in in C# (targeting .NET 8, x64) that fingerprints parts by falling back to a mesh-based hash via the SurfaceBody.CalculateFacets API. Although I can successfully compile against Autodesk.Inventor.Interop.dll, at runtime every call to CalculateFacets f...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim vertexCount As Long
Dim facetCount As Long
Dim vertexCoords() As Double
Dim normalVectors() As Double
Dim vertexIndices() As Long

Call oBody.CalculateFacets(tolerance, vertexCount, facetCount, vertexCoords, normalVectors, vertexIndices)
```

#### Code Block 2

```vb
Dim vertexCount As Long
Dim facetCount As Long
Dim vertexCoords() As Double
Dim normalVectors() As Double
Dim vertexIndices() As Long

Call oBody.CalculateFacets(tolerance, vertexCount, facetCount, vertexCoords, normalVectors, vertexIndices)
```

#### Code Block 3

```vb
Dim vertexCount As Long
Dim facetCount As Long
Dim vertexCoords() As Double
Dim normalVectors() As Double
Dim vertexIndices() As Long

Call oBody.CalculateFacets(tolerance, vertexCount, facetCount, vertexCoords, normalVectors, vertexIndices)
```

#### Code Block 4

```vb
Dim vertexCount As Long
Dim facetCount As Long
Dim vertexCoords() As Double
Dim normalVectors() As Double
Dim vertexIndices() As Long

Call oBody.CalculateFacets(tolerance, vertexCount, facetCount, vertexCoords, normalVectors, vertexIndices)
```

#### Code Block 5

```vb
int vertexCount = 0;
int facetCount = 0;
double[] vertexCoords = null;
double[] normalVectors = null;
int[] vertexIndices = null;

body.CalculateFacets(tolerance, out vertexCount, out facetCount, out vertexCoords, out normalVectors, out vertexIndices);
```

#### Code Block 6

```vb
int vertexCount = 0;
int facetCount = 0;
double[] vertexCoords = null;
double[] normalVectors = null;
int[] vertexIndices = null;

body.CalculateFacets(tolerance, out vertexCount, out facetCount, out vertexCoords, out normalVectors, out vertexIndices);
```

#### Code Block 7

```vb
int vertexCount = 0;
int facetCount = 0;
double[] vertexCoords = null;
double[] normalVectors = null;
int[] vertexIndices = null;

body.CalculateFacets(tolerance, out vertexCount, out facetCount, out vertexCoords, out normalVectors, out vertexIndices);
```

#### Code Block 8

```vb
int vertexCount = 0;
int facetCount = 0;
double[] vertexCoords = null;
double[] normalVectors = null;
int[] vertexIndices = null;

body.CalculateFacets(tolerance, out vertexCount, out facetCount, out vertexCoords, out normalVectors, out vertexIndices);
```

---

### 82. LEADER NOTE FILTER SETTINGS

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/leader-note-filter-settings/td-p/13786343](https://forums.autodesk.com/t5/inventor-programming-forum/leader-note-filter-settings/td-p/13786343)

**Author:** ragul_ravi_ext

**Date:** ‎08-28-2025
	
		
		12:27 AM

**Description:** HII try to access the leader note settings via i logics i cannot be able to achieve can anyone help me on this i need to select the type, source must default and parameter and need to add parameter in leader via i logic code.  					 				 			 			 				 			 			 				 	 			 				 					 						Solved! 					...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim oDNote As Inventor.DrawingNote = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingNoteFilter, "Select a drawing note to inspect.")
If (oDNote Is Nothing) Then Return
Logger.Info(vbCrLf & oDNote.FormattedText)
Dim sFText As String = InputBox("Here is the LeaderNote.FormattedText:", "LeaderNote.FormattedText", oDNote.FormattedText)
oDNote.FormattedText = sFText
```

#### Code Block 2

```vb
Dim oDNote As Inventor.DrawingNote = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingNoteFilter, "Select a drawing note to inspect.")
If (oDNote Is Nothing) Then Return
Logger.Info(vbCrLf & oDNote.FormattedText)
Dim sFText As String = InputBox("Here is the LeaderNote.FormattedText:", "LeaderNote.FormattedText", oDNote.FormattedText)
oDNote.FormattedText = sFText
```

#### Code Block 3

```vb
Dim oDNote As Inventor.DrawingNote = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingNoteFilter, "Select a drawing note to inspect.")
If (oDNote Is Nothing) Then Return
Logger.Info(vbCrLf & oDNote.FormattedText)
Dim sFText As String = InputBox("Here is the LeaderNote.FormattedText:", "LeaderNote.FormattedText", oDNote.FormattedText)
oDNote.FormattedText = sFText
```

#### Code Block 4

```vb
Dim oDNote As Inventor.DrawingNote = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingNoteFilter, "Select a drawing note to inspect.")
If (oDNote Is Nothing) Then Return
Logger.Info(vbCrLf & oDNote.FormattedText)
Dim sFText As String = InputBox("Here is the LeaderNote.FormattedText:", "LeaderNote.FormattedText", oDNote.FormattedText)
oDNote.FormattedText = sFText
```

#### Code Block 5

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oDDoc As Inventor.DrawingDocument = TryCast(oInvApp.ActiveDocument, Inventor.DrawingDocument)
	If oDDoc Is Nothing Then
		MsgBox("A Drawing must be 'active' for this rule to work!", vbCritical, "Wrong Document Type")
		Return
	End If
	Dim oSheet As Inventor.Sheet = oDDoc.ActiveSheet
	Dim oDView As Inventor.DrawingView = oSheet.DrawingViews.Item(1)
	'get the model document being detailed within this drawing's views
	Dim oModelDoc As Inventor.Document = Nothing
	Try
		oModelDoc = oDView.ReferencedDocumentDescriptor.ReferencedDocument
	Catch
	End Try
	If oModelDoc Is Nothing Then
		MsgBox("No Model Document Found In First View On Active Sheet!", , "")
		Return
	End If
	Dim oDCurve As Inventor.DrawingCurve = oDView.DrawingCurves.Item(1)
	'this defines the 'connection' between a piece of geometry an an annotation
	Dim oGIntent As Inventor.GeometryIntent = oSheet.CreateGeometryIntent(oDCurve)
	'specify where the text of the leader should be (2 units outside top left corner of view)
	Dim oTxtPt As Inventor.Point2d = oInvApp.TransientGeometry.CreatePoint2d()
	oTxtPt.X = oDView.Left - 2
	oTxtPt.Y = oDView.Top + 2
	'put collection of leader node locations into a collection
	Dim oLPts As Inventor.ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection()
	oLPts.Add(oGIntent)
	oLPts.Add(oTxtPt)
	Dim oLNotes As Inventor.LeaderNotes = oSheet.DrawingNotes.LeaderNotes
	'in order to specify which iProperty we want the note to be pointing to,
	'we need to be able to specify the 'internal name' of the PropertySet containing that Property
	'in your case, that will be the 'custom' PropertySet, which is always the fourth set
	Dim oCustomPropSet As Inventor.PropertySet = oModelDoc.PropertySets.Item(4)
	Dim sPropSetID As String = oCustomPropSet.InternalName
	'now try to get the custom Property
	Dim oCustomProp As Inventor.Property = Nothing
	Try
		oCustomProp = oCustomPropSet.Item("TAGG")
	Catch
	End Try
	If oCustomProp Is Nothing Then
		MsgBox("No custom Property named 'TAGG' found in model document!", , "")
		Return
	End If
	'get the ID of the custom Property, if it was found
	Dim sPropID As String = oCustomProp.PropId.ToString()
	'now define the FormattedText contents, incorporating those two pieces of information
	Dim sFText As String = "<Property Document='model' FormatID='" & sPropSetID & "' PropertyID='" & sPropID & "' />"
	'now create the LeaderNote, and specify that FormattedText
	Dim oLNote As Inventor.LeaderNote = oLNotes.Add(oLPts, sFText)
End Sub
```

#### Code Block 6

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oDDoc As Inventor.DrawingDocument = TryCast(oInvApp.ActiveDocument, Inventor.DrawingDocument)
	If oDDoc Is Nothing Then
		MsgBox("A Drawing must be 'active' for this rule to work!", vbCritical, "Wrong Document Type")
		Return
	End If
	Dim oSheet As Inventor.Sheet = oDDoc.ActiveSheet
	Dim oDView As Inventor.DrawingView = oSheet.DrawingViews.Item(1)
	'get the model document being detailed within this drawing's views
	Dim oModelDoc As Inventor.Document = Nothing
	Try
		oModelDoc = oDView.ReferencedDocumentDescriptor.ReferencedDocument
	Catch
	End Try
	If oModelDoc Is Nothing Then
		MsgBox("No Model Document Found In First View On Active Sheet!", , "")
		Return
	End If
	Dim oDCurve As Inventor.DrawingCurve = oDView.DrawingCurves.Item(1)
	'this defines the 'connection' between a piece of geometry an an annotation
	Dim oGIntent As Inventor.GeometryIntent = oSheet.CreateGeometryIntent(oDCurve)
	'specify where the text of the leader should be (2 units outside top left corner of view)
	Dim oTxtPt As Inventor.Point2d = oInvApp.TransientGeometry.CreatePoint2d()
	oTxtPt.X = oDView.Left - 2
	oTxtPt.Y = oDView.Top + 2
	'put collection of leader node locations into a collection
	Dim oLPts As Inventor.ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection()
	oLPts.Add(oGIntent)
	oLPts.Add(oTxtPt)
	Dim oLNotes As Inventor.LeaderNotes = oSheet.DrawingNotes.LeaderNotes
	'in order to specify which iProperty we want the note to be pointing to,
	'we need to be able to specify the 'internal name' of the PropertySet containing that Property
	'in your case, that will be the 'custom' PropertySet, which is always the fourth set
	Dim oCustomPropSet As Inventor.PropertySet = oModelDoc.PropertySets.Item(4)
	Dim sPropSetID As String = oCustomPropSet.InternalName
	'now try to get the custom Property
	Dim oCustomProp As Inventor.Property = Nothing
	Try
		oCustomProp = oCustomPropSet.Item("TAGG")
	Catch
	End Try
	If oCustomProp Is Nothing Then
		MsgBox("No custom Property named 'TAGG' found in model document!", , "")
		Return
	End If
	'get the ID of the custom Property, if it was found
	Dim sPropID As String = oCustomProp.PropId.ToString()
	'now define the FormattedText contents, incorporating those two pieces of information
	Dim sFText As String = "<Property Document='model' FormatID='" & sPropSetID & "' PropertyID='" & sPropID & "' />"
	'now create the LeaderNote, and specify that FormattedText
	Dim oLNote As Inventor.LeaderNote = oLNotes.Add(oLPts, sFText)
End Sub
```

#### Code Block 7

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oDDoc As Inventor.DrawingDocument = TryCast(oInvApp.ActiveDocument, Inventor.DrawingDocument)
	If oDDoc Is Nothing Then
		MsgBox("A Drawing must be 'active' for this rule to work!", vbCritical, "Wrong Document Type")
		Return
	End If
	Dim oSheet As Inventor.Sheet = oDDoc.ActiveSheet
	Dim oDView As Inventor.DrawingView = oSheet.DrawingViews.Item(1)
	'get the model document being detailed within this drawing's views
	Dim oModelDoc As Inventor.Document = Nothing
	Try
		oModelDoc = oDView.ReferencedDocumentDescriptor.ReferencedDocument
	Catch
	End Try
	If oModelDoc Is Nothing Then
		MsgBox("No Model Document Found In First View On Active Sheet!", , "")
		Return
	End If
	Dim oDCurve As Inventor.DrawingCurve = oDView.DrawingCurves.Item(1)
	'this defines the 'connection' between a piece of geometry an an annotation
	Dim oGIntent As Inventor.GeometryIntent = oSheet.CreateGeometryIntent(oDCurve)
	'specify where the text of the leader should be (2 units outside top left corner of view)
	Dim oTxtPt As Inventor.Point2d = oInvApp.TransientGeometry.CreatePoint2d()
	oTxtPt.X = oDView.Left - 2
	oTxtPt.Y = oDView.Top + 2
	'put collection of leader node locations into a collection
	Dim oLPts As Inventor.ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection()
	oLPts.Add(oGIntent)
	oLPts.Add(oTxtPt)
	Dim oLNotes As Inventor.LeaderNotes = oSheet.DrawingNotes.LeaderNotes
	'in order to specify which iProperty we want the note to be pointing to,
	'we need to be able to specify the 'internal name' of the PropertySet containing that Property
	'in your case, that will be the 'custom' PropertySet, which is always the fourth set
	Dim oCustomPropSet As Inventor.PropertySet = oModelDoc.PropertySets.Item(4)
	Dim sPropSetID As String = oCustomPropSet.InternalName
	'now try to get the custom Property
	Dim oCustomProp As Inventor.Property = Nothing
	Try
		oCustomProp = oCustomPropSet.Item("TAGG")
	Catch
	End Try
	If oCustomProp Is Nothing Then
		MsgBox("No custom Property named 'TAGG' found in model document!", , "")
		Return
	End If
	'get the ID of the custom Property, if it was found
	Dim sPropID As String = oCustomProp.PropId.ToString()
	'now define the FormattedText contents, incorporating those two pieces of information
	Dim sFText As String = "<Property Document='model' FormatID='" & sPropSetID & "' PropertyID='" & sPropID & "' />"
	'now create the LeaderNote, and specify that FormattedText
	Dim oLNote As Inventor.LeaderNote = oLNotes.Add(oLPts, sFText)
End Sub
```

#### Code Block 8

```vb
Sub Main
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oDDoc As Inventor.DrawingDocument = TryCast(oInvApp.ActiveDocument, Inventor.DrawingDocument)
	If oDDoc Is Nothing Then
		MsgBox("A Drawing must be 'active' for this rule to work!", vbCritical, "Wrong Document Type")
		Return
	End If
	Dim oSheet As Inventor.Sheet = oDDoc.ActiveSheet
	Dim oDView As Inventor.DrawingView = oSheet.DrawingViews.Item(1)
	'get the model document being detailed within this drawing's views
	Dim oModelDoc As Inventor.Document = Nothing
	Try
		oModelDoc = oDView.ReferencedDocumentDescriptor.ReferencedDocument
	Catch
	End Try
	If oModelDoc Is Nothing Then
		MsgBox("No Model Document Found In First View On Active Sheet!", , "")
		Return
	End If
	Dim oDCurve As Inventor.DrawingCurve = oDView.DrawingCurves.Item(1)
	'this defines the 'connection' between a piece of geometry an an annotation
	Dim oGIntent As Inventor.GeometryIntent = oSheet.CreateGeometryIntent(oDCurve)
	'specify where the text of the leader should be (2 units outside top left corner of view)
	Dim oTxtPt As Inventor.Point2d = oInvApp.TransientGeometry.CreatePoint2d()
	oTxtPt.X = oDView.Left - 2
	oTxtPt.Y = oDView.Top + 2
	'put collection of leader node locations into a collection
	Dim oLPts As Inventor.ObjectCollection = oInvApp.TransientObjects.CreateObjectCollection()
	oLPts.Add(oGIntent)
	oLPts.Add(oTxtPt)
	Dim oLNotes As Inventor.LeaderNotes = oSheet.DrawingNotes.LeaderNotes
	'in order to specify which iProperty we want the note to be pointing to,
	'we need to be able to specify the 'internal name' of the PropertySet containing that Property
	'in your case, that will be the 'custom' PropertySet, which is always the fourth set
	Dim oCustomPropSet As Inventor.PropertySet = oModelDoc.PropertySets.Item(4)
	Dim sPropSetID As String = oCustomPropSet.InternalName
	'now try to get the custom Property
	Dim oCustomProp As Inventor.Property = Nothing
	Try
		oCustomProp = oCustomPropSet.Item("TAGG")
	Catch
	End Try
	If oCustomProp Is Nothing Then
		MsgBox("No custom Property named 'TAGG' found in model document!", , "")
		Return
	End If
	'get the ID of the custom Property, if it was found
	Dim sPropID As String = oCustomProp.PropId.ToString()
	'now define the FormattedText contents, incorporating those two pieces of information
	Dim sFText As String = "<Property Document='model' FormatID='" & sPropSetID & "' PropertyID='" & sPropID & "' />"
	'now create the LeaderNote, and specify that FormattedText
	Dim oLNote As Inventor.LeaderNote = oLNotes.Add(oLPts, sFText)
End Sub
```

---

### 83. Local iLogic Rules in Mirrored Parts?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/local-ilogic-rules-in-mirrored-parts/td-p/12123316](https://forums.autodesk.com/t5/inventor-programming-forum/local-ilogic-rules-in-mirrored-parts/td-p/12123316)

**Author:** bbeilke

**Date:** ‎07-24-2023
	
		
		02:30 PM

**Description:** I wasn't sure if this question was best asked in this forum or the general forum.  Please feel free to move this thread if necessary. We have parts that contain local iLogic rules.  When making a mirror of these parts, we need the same iLogic rule(s) in the new mirrored parts.  We can obviously manu...

**Code Snippets (2):**

#### Code Block 1

```vb
Sub main()
	Dim oDoc As Document = ThisDoc.Document
	If Not TypeOf oDoc Is AssemblyDocument Then Exit Sub
	Dim oAsmDoc As AssemblyDocument = oDoc
	Dim oRefDocs As DocumentsEnumerator = oAsmDoc.AllReferencedDocuments
	If oRefDocs.Count = 0 Then Exit Sub
	Dim oDocs As Documents = ThisApplication.Documents
	Dim oST As Transaction = ThisApplication.TransactionManager.StartTransaction(oAsmDoc, "CopyRules")
	Dim oPBar As Inventor.ProgressBar = ThisApplication.CreateProgressBar(False, oRefDocs.Count, "Copy ryles...")
	Dim i As Integer = 1
	oPBar.Message = "Loading..."
	For Each oRefDoc As Document In oRefDocs
		oPBar.Message = "Copy ryles in document. Progress " & i & " of " & oAsmDoc.AllReferencedDocuments.Count & "."
		If TypeOf oRefDoc Is PartDocument AndAlso oRefDoc.IsModifiable Then
			Dim oPartDoc As PartDocument = oRefDoc
			Dim oDrcdComp As DerivedPartComponents = oPartDoc.ComponentDefinition.ReferenceComponents.DerivedPartComponents
			If oDrcdComp.Count = 0 Then Continue For
			If Not oDrcdComp.Item(1).Definition.Mirror Then Continue For
			Dim oDrcdDoc As Document = oDrcdComp.Item(1).ReferencedDocumentDescriptor.ReferencedDocument
			Call CopyRules(oDrcdDoc, oPartDoc)
			Call CopyEventsPropSet(oDrcdDoc, oPartDoc)
			oPartDoc.Save()
		End If
		oPBar.UpdateProgress()
		i += 1
	Next
	oPBar.Close()
	oST.End()
End Sub

Private Function CopyRules(CopyFrom As Document, CopyTo As Document)
	Try
		For Each oRule As iLogicRule In iLogicVb.Automation.Rules(CopyFrom)
			Dim oCopy As iLogicRule = iLogicVb.Automation.AddRule(CopyTo, oRule.Name, "")
			oCopy.Text = oRule.Text
		Next
	Catch : End Try
End Function

Private Function CopyEventsPropSet(CopyFrom As Document, CopyTo As Document)
	Dim oPropSet As Inventor.PropertySet = CopyFrom.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}")
	Try
		CopyTo.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}").Delete()
	Catch
	End Try
	Dim newPropSet As Inventor.PropertySet = CopyTo.PropertySets.Add("_iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	For Each prop As Inventor.Property In oPropSet
		newPropSet.Add(prop.Value, prop.Name, prop.PropId)
	Next
End Function
```

#### Code Block 2

```vb
Sub main()
	Dim oDoc As Document = ThisDoc.Document
	If Not TypeOf oDoc Is AssemblyDocument Then Exit Sub
	Dim oAsmDoc As AssemblyDocument = oDoc
	Dim oRefDocs As DocumentsEnumerator = oAsmDoc.AllReferencedDocuments
	If oRefDocs.Count = 0 Then Exit Sub
	Dim oDocs As Documents = ThisApplication.Documents
	Dim oST As Transaction = ThisApplication.TransactionManager.StartTransaction(oAsmDoc, "CopyRules")
	Dim oPBar As Inventor.ProgressBar = ThisApplication.CreateProgressBar(False, oRefDocs.Count, "Copy ryles...")
	Dim i As Integer = 1
	oPBar.Message = "Loading..."
	For Each oRefDoc As Document In oRefDocs
		oPBar.Message = "Copy ryles in document. Progress " & i & " of " & oAsmDoc.AllReferencedDocuments.Count & "."
		If TypeOf oRefDoc Is PartDocument AndAlso oRefDoc.IsModifiable Then
			Dim oPartDoc As PartDocument = oRefDoc
			Dim oDrcdComp As DerivedPartComponents = oPartDoc.ComponentDefinition.ReferenceComponents.DerivedPartComponents
			If oDrcdComp.Count = 0 Then Continue For
			If Not oDrcdComp.Item(1).Definition.Mirror Then Continue For
			Dim oDrcdDoc As Document = oDrcdComp.Item(1).ReferencedDocumentDescriptor.ReferencedDocument
			Call CopyRules(oDrcdDoc, oPartDoc)
			Call CopyEventsPropSet(oDrcdDoc, oPartDoc)
			oPartDoc.Save()
		End If
		oPBar.UpdateProgress()
		i += 1
	Next
	oPBar.Close()
	oST.End()
End Sub

Private Function CopyRules(CopyFrom As Document, CopyTo As Document)
	Try
		For Each oRule As iLogicRule In iLogicVb.Automation.Rules(CopyFrom)
			Dim oCopy As iLogicRule = iLogicVb.Automation.AddRule(CopyTo, oRule.Name, "")
			oCopy.Text = oRule.Text
		Next
	Catch : End Try
End Function

Private Function CopyEventsPropSet(CopyFrom As Document, CopyTo As Document)
	Dim oPropSet As Inventor.PropertySet = CopyFrom.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}")
	Try
		CopyTo.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}").Delete()
	Catch
	End Try
	Dim newPropSet As Inventor.PropertySet = CopyTo.PropertySets.Add("_iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	For Each prop As Inventor.Property In oPropSet
		newPropSet.Add(prop.Value, prop.Name, prop.PropId)
	Next
End Function
```

#### Code Block 3

```vb
Sub main()
	Dim oDoc As Document = ThisDoc.Document
	If Not TypeOf oDoc Is AssemblyDocument Then Exit Sub
	Dim oAsmDoc As AssemblyDocument = oDoc
	Dim oRefDocs As DocumentsEnumerator = oAsmDoc.AllReferencedDocuments
	If oRefDocs.Count = 0 Then Exit Sub
	Dim oDocs As Documents = ThisApplication.Documents
	Dim oST As Transaction = ThisApplication.TransactionManager.StartTransaction(oAsmDoc, "CopyRules")
	Dim oPBar As Inventor.ProgressBar = ThisApplication.CreateProgressBar(False, oRefDocs.Count, "Copy ryles...")
	Dim i As Integer = 1
	oPBar.Message = "Loading..."
	For Each oRefDoc As Document In oRefDocs
		oPBar.Message = "Copy ryles in document. Progress " & i & " of " & oAsmDoc.AllReferencedDocuments.Count & "."
		If TypeOf oRefDoc Is PartDocument AndAlso oRefDoc.IsModifiable Then
			Dim oPartDoc As PartDocument = oRefDoc
			Dim oDrcdComp As DerivedPartComponents = oPartDoc.ComponentDefinition.ReferenceComponents.DerivedPartComponents
			If oDrcdComp.Count = 0 Then Continue For
			If Not oDrcdComp.Item(1).Definition.Mirror Then Continue For
			Dim oDrcdDoc As Document = oDrcdComp.Item(1).ReferencedDocumentDescriptor.ReferencedDocument
			Call CopyRules(oDrcdDoc, oPartDoc)
			Call CopyEventsPropSet(oDrcdDoc, oPartDoc)
			oPartDoc.Save()
		End If
		oPBar.UpdateProgress()
		i += 1
	Next
	oPBar.Close()
	oST.End()
End Sub

Private Function CopyRules(CopyFrom As Document, CopyTo As Document)
	Try
		For Each oRule As iLogicRule In iLogicVb.Automation.Rules(CopyFrom)
			Dim oCopy As iLogicRule = iLogicVb.Automation.AddRule(CopyTo, oRule.Name, "")
			oCopy.Text = oRule.Text
		Next
	Catch : End Try
End Function

Private Function CopyEventsPropSet(CopyFrom As Document, CopyTo As Document)
	Dim oPropSet As Inventor.PropertySet = CopyFrom.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}")
	Try
		CopyTo.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}").Delete()
	Catch
	End Try
	Dim newPropSet As Inventor.PropertySet = CopyTo.PropertySets.Add("_iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	For Each prop As Inventor.Property In oPropSet
		newPropSet.Add(prop.Value, prop.Name, prop.PropId)
	Next
End Function
```

#### Code Block 4

```vb
Sub main()
	Dim oDoc As Document = ThisDoc.Document
	If Not TypeOf oDoc Is AssemblyDocument Then Exit Sub
	Dim oAsmDoc As AssemblyDocument = oDoc
	Dim oRefDocs As DocumentsEnumerator = oAsmDoc.AllReferencedDocuments
	If oRefDocs.Count = 0 Then Exit Sub
	Dim oDocs As Documents = ThisApplication.Documents
	Dim oST As Transaction = ThisApplication.TransactionManager.StartTransaction(oAsmDoc, "CopyRules")
	Dim oPBar As Inventor.ProgressBar = ThisApplication.CreateProgressBar(False, oRefDocs.Count, "Copy ryles...")
	Dim i As Integer = 1
	oPBar.Message = "Loading..."
	For Each oRefDoc As Document In oRefDocs
		oPBar.Message = "Copy ryles in document. Progress " & i & " of " & oAsmDoc.AllReferencedDocuments.Count & "."
		If TypeOf oRefDoc Is PartDocument AndAlso oRefDoc.IsModifiable Then
			Dim oPartDoc As PartDocument = oRefDoc
			Dim oDrcdComp As DerivedPartComponents = oPartDoc.ComponentDefinition.ReferenceComponents.DerivedPartComponents
			If oDrcdComp.Count = 0 Then Continue For
			If Not oDrcdComp.Item(1).Definition.Mirror Then Continue For
			Dim oDrcdDoc As Document = oDrcdComp.Item(1).ReferencedDocumentDescriptor.ReferencedDocument
			Call CopyRules(oDrcdDoc, oPartDoc)
			Call CopyEventsPropSet(oDrcdDoc, oPartDoc)
			oPartDoc.Save()
		End If
		oPBar.UpdateProgress()
		i += 1
	Next
	oPBar.Close()
	oST.End()
End Sub

Private Function CopyRules(CopyFrom As Document, CopyTo As Document)
	Try
		For Each oRule As iLogicRule In iLogicVb.Automation.Rules(CopyFrom)
			Dim oCopy As iLogicRule = iLogicVb.Automation.AddRule(CopyTo, oRule.Name, "")
			oCopy.Text = oRule.Text
		Next
	Catch : End Try
End Function

Private Function CopyEventsPropSet(CopyFrom As Document, CopyTo As Document)
	Dim oPropSet As Inventor.PropertySet = CopyFrom.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}")
	Try
		CopyTo.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}").Delete()
	Catch
	End Try
	Dim newPropSet As Inventor.PropertySet = CopyTo.PropertySets.Add("_iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	For Each prop As Inventor.Property In oPropSet
		newPropSet.Add(prop.Value, prop.Name, prop.PropId)
	Next
End Function
```

#### Code Block 5

```vb
Sub main()
	Dim oDoc As Document = ThisDoc.Document
	If Not TypeOf oDoc Is AssemblyDocument Then Exit Sub
	Dim oAsmDoc As AssemblyDocument = oDoc
	Dim oRefDocs As DocumentsEnumerator = oAsmDoc.AllReferencedDocuments
	If oRefDocs.Count = 0 Then Exit Sub
	Dim oDocs As Documents = ThisApplication.Documents
	Dim oST As Transaction = ThisApplication.TransactionManager.StartTransaction(oAsmDoc, "CopyRules")
	Dim oPBar As Inventor.ProgressBar = ThisApplication.CreateProgressBar(False, oRefDocs.Count, "Copy ryles...")
	Dim i As Integer = 1
	oPBar.Message = "Loading..."
	For Each oRefDoc As Document In oRefDocs
		oPBar.Message = "Copy ryles in document. Progress " & i & " of " & oAsmDoc.AllReferencedDocuments.Count & "."
		If TypeOf oRefDoc Is PartDocument AndAlso oRefDoc.IsModifiable Then
			Dim oPartDoc As PartDocument = oRefDoc
			Dim oDrcdComp As DerivedPartComponents = oPartDoc.ComponentDefinition.ReferenceComponents.DerivedPartComponents
			If oDrcdComp.Count = 0 Then Continue For
			If Not oDrcdComp.Item(1).Definition.Mirror Then Continue For
			Dim oDrcdDoc As Document = oDrcdComp.Item(1).ReferencedDocumentDescriptor.ReferencedDocument
			Call CopyRules(oDrcdDoc, oPartDoc)
			Call CopyEventsPropSet(oDrcdDoc, oPartDoc)
			oPartDoc.Save()
		End If
		oPBar.UpdateProgress()
		i += 1
	Next
	oPBar.Close()
	oST.End()
End Sub

Private Function CopyRules(CopyFrom As Document, CopyTo As Document)
	Try
		For Each oRule As iLogicRule In iLogicVb.Automation.Rules(CopyFrom)
			Dim oCopy As iLogicRule = iLogicVb.Automation.AddRule(CopyTo, oRule.Name, "")
			oCopy.Text = oRule.Text
		Next
	Catch : End Try
End Function

Private Function CopyEventsPropSet(CopyFrom As Document, CopyTo As Document)
	Dim oPropSet As Inventor.PropertySet = CopyFrom.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}")
	Try
		CopyTo.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}").Delete()
	Catch
	End Try
	Dim newPropSet As Inventor.PropertySet = CopyTo.PropertySets.Add("_iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	For Each prop As Inventor.Property In oPropSet
		newPropSet.Add(prop.Value, prop.Name, prop.PropId)
	Next
End Function
```

#### Code Block 6

```vb
Sub main()
	Dim oDoc As Document = ThisDoc.Document
	If Not TypeOf oDoc Is AssemblyDocument Then Exit Sub
	Dim oAsmDoc As AssemblyDocument = oDoc
	Dim oRefDocs As DocumentsEnumerator = oAsmDoc.AllReferencedDocuments
	If oRefDocs.Count = 0 Then Exit Sub
	Dim oDocs As Documents = ThisApplication.Documents
	Dim oST As Transaction = ThisApplication.TransactionManager.StartTransaction(oAsmDoc, "CopyRules")
	Dim oPBar As Inventor.ProgressBar = ThisApplication.CreateProgressBar(False, oRefDocs.Count, "Copy ryles...")
	Dim i As Integer = 1
	oPBar.Message = "Loading..."
	For Each oRefDoc As Document In oRefDocs
		oPBar.Message = "Copy ryles in document. Progress " & i & " of " & oAsmDoc.AllReferencedDocuments.Count & "."
		If TypeOf oRefDoc Is PartDocument AndAlso oRefDoc.IsModifiable Then
			Dim oPartDoc As PartDocument = oRefDoc
			Dim oDrcdComp As DerivedPartComponents = oPartDoc.ComponentDefinition.ReferenceComponents.DerivedPartComponents
			If oDrcdComp.Count = 0 Then Continue For
			If Not oDrcdComp.Item(1).Definition.Mirror Then Continue For
			Dim oDrcdDoc As Document = oDrcdComp.Item(1).ReferencedDocumentDescriptor.ReferencedDocument
			Call CopyRules(oDrcdDoc, oPartDoc)
			Call CopyEventsPropSet(oDrcdDoc, oPartDoc)
			oPartDoc.Save()
		End If
		oPBar.UpdateProgress()
		i += 1
	Next
	oPBar.Close()
	oST.End()
End Sub

Private Function CopyRules(CopyFrom As Document, CopyTo As Document)
	Try
		For Each oRule As iLogicRule In iLogicVb.Automation.Rules(CopyFrom)
			Dim oCopy As iLogicRule = iLogicVb.Automation.AddRule(CopyTo, oRule.Name, "")
			oCopy.Text = oRule.Text
		Next
	Catch : End Try
End Function

Private Function CopyEventsPropSet(CopyFrom As Document, CopyTo As Document)
	Dim oPropSet As Inventor.PropertySet = CopyFrom.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}")
	Try
		CopyTo.PropertySets("{2C540830-0723-455E-A8E2-891722EB4C3E}").Delete()
	Catch
	End Try
	Dim newPropSet As Inventor.PropertySet = CopyTo.PropertySets.Add("_iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	For Each prop As Inventor.Property In oPropSet
		newPropSet.Add(prop.Value, prop.Name, prop.PropId)
	Next
End Function
```

---

### 84. Logic to match Inventor file names to the search engine names

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/logic-to-match-inventor-file-names-to-the-search-engine-names/td-p/13824844](https://forums.autodesk.com/t5/inventor-programming-forum/logic-to-match-inventor-file-names-to-the-search-engine-names/td-p/13824844)

**Author:** 이스리

**Date:** ‎09-25-2025
	
		
		01:10 AM

**Description:** Hello.Is there an iLogic function that converts Inventor file names to the file names in the browser tree?There's logic to match part numbers to file names,but I don't see any logic to match file names to the file names in the browser tree.

**Code Snippets (2):**

#### Code Block 1

```vb
Dim ass As AssemblyDocument = ThisDoc.Document
For Each occ As ComponentOccurrence In ass.ComponentDefinition.Occurrences
	If occ.Suppressed Then Continue For
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Continue For
	Dim occ_name As String = ""
	occ_name = Split(occ.Name, ":")(0)
	Dim full_filename As String = ""
	full_filename=occ.Definition.Document.fullfilename
	Dim path As String = ""
	path=Microsoft.VisualBasic.left(full_filename, InStrRev(full_filename, "\", -1))
    Dim file_name As String = ""
	file_name=Microsoft.VisualBasic.Right(full_filename, Len(full_filename) -InStrRev(full_filename, "\", -1))
	Dim ext As String = ""
	ext = Microsoft.VisualBasic.Right(full_filename, 4)
	file_name = Split(file_name, ".")(0)
		
	If file_name.ToLower <> occ_name.ToLower Then
	
	Dim doc As Document = occ.Definition.Document
	Logger.Info(path & "  " & file_name & "  " & occ_name)
	If Dir(path & occ_name & ext) = "" Then
		Try
		doc.SaveAs(path & occ_name & ext, True)
		Catch ex As Exception
		End Try
	End If
		Try
		occ.Replace(path & occ_name & ext,True)
		Catch ex As Exception
		End Try
	
	
	End If
Next
```

#### Code Block 2

```vb
Dim ass As AssemblyDocument = ThisDoc.Document
For Each occ As ComponentOccurrence In ass.ComponentDefinition.Occurrences
	If occ.Suppressed Then Continue For
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Continue For
	Dim occ_name As String = ""
	occ_name = Split(occ.Name, ":")(0)
	Dim full_filename As String = ""
	full_filename=occ.Definition.Document.fullfilename
	Dim path As String = ""
	path=Microsoft.VisualBasic.left(full_filename, InStrRev(full_filename, "\", -1))
    Dim file_name As String = ""
	file_name=Microsoft.VisualBasic.Right(full_filename, Len(full_filename) -InStrRev(full_filename, "\", -1))
	Dim ext As String = ""
	ext = Microsoft.VisualBasic.Right(full_filename, 4)
	file_name = Split(file_name, ".")(0)
		
	If file_name.ToLower <> occ_name.ToLower Then
	
	Dim doc As Document = occ.Definition.Document
	Logger.Info(path & "  " & file_name & "  " & occ_name)
	If Dir(path & occ_name & ext) = "" Then
		Try
		doc.SaveAs(path & occ_name & ext, True)
		Catch ex As Exception
		End Try
	End If
		Try
		occ.Replace(path & occ_name & ext,True)
		Catch ex As Exception
		End Try
	
	
	End If
Next
```

---

### 85. Mark feature messes up loop count in iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/mark-feature-messes-up-loop-count-in-ilogic/td-p/13772938](https://forums.autodesk.com/t5/inventor-programming-forum/mark-feature-messes-up-loop-count-in-ilogic/td-p/13772938)

**Author:** ekaspar3JCGJ

**Date:** ‎08-18-2025
	
		
		03:20 PM

**Description:** Hi, I am trying to use the Mark feature for the first time. I use an iLogic rule that gets total laser cutting length and number of pierces among other info. When I run my iLogic rule, it gets the distance of one loop of the Mark feature and nothing else. I am not very good at iLogic and am unable t...

**Code Snippets (2):**

#### Code Block 1

```vb
Sub Main
	
	Dim isdoc As Document = ThisDoc.Document
	If isdoc.SubType <> "{9C464203-9BAE-11D3-8BAD-0060B0CE6BB4}" Then
		Exit Sub
	Else
		'Create custom iproperties
		customPropertySet = ThisDoc.Document.PropertySets.Item("Inventor User Defined Properties")
		
		Dim iprop(4) As String
		iprop(1) = "Cutting Length"
		iprop(2) = "Pierces"
		iprop(3) = "Bends"
		iprop(4) = "Weight"
		
		For k = 1 To 4
		Dim prop(k) As String
		    Try
		        prop(k) = iProperties.Value("Custom", iprop(k))
		    Catch
		        'Assume error means not found
		        customPropertySet.Add("", iprop(k))
		        iProperties.Value("Custom", iprop(k)) = "null"
		    End Try
		Next
		
		'Get cutting length
		Dim oSMDoc As PartDocument = ThisApplication.ActiveDocument
		Dim oSMDDef As SheetMetalComponentDefinition = oSMDoc.ComponentDefinition
		If oSMDDef.HasFlatPattern = False Then
			MsgBox("There is no Flat Pattern yet.", vbOKOnly, "NO FLAT PATTERN")
			Return
		End If
		Dim oTopFace As Face = oSMDDef.FlatPattern.TopFace
		Dim oMeasureTools As MeasureTools = ThisApplication.MeasureTools
		Dim oLoopLength As Double = 0
		For Each oEdgeLoop As EdgeLoop In oTopFace.EdgeLoops
			oLoopLength = oLoopLength + oMeasureTools.GetLoopLength(oEdgeLoop)
		Next
		oLoopLength = oLoopLength / 2.54
		oLoopLength = Round(oLoopLength, 2)

		'get bends
		Dim bendqty As Integer = oSMDDef.Bends.Count
		
		'get mass
		mass = Round(iProperties.Mass, 2)
	
		'get pierces
		TotalPierces = 1
		For Each oEdgeLoop In oSMDDef.FlatPattern.TopFace.EdgeLoops
		    If oEdgeLoop.IsOuterEdgeLoop = False Then
		        TotalPierces = TotalPierces + 1
		    End If
		Next
		
		'write data to iproperties
		iProperties.Value("Custom", "Pierces") = TotalPierces
		iProperties.Value("Custom", "Bends") = bendqty
		iProperties.Value("Custom", "Cutting Length") = oLoopLength
		iProperties.Value("Custom", "Weight") = mass & " LBS."
		
	End If
	End Sub
```

#### Code Block 2

```vb
Sub Main
	
	Dim isdoc As Document = ThisDoc.Document
	If isdoc.SubType <> "{9C464203-9BAE-11D3-8BAD-0060B0CE6BB4}" Then
		Exit Sub
	Else
		'Create custom iproperties
		customPropertySet = ThisDoc.Document.PropertySets.Item("Inventor User Defined Properties")
		
		Dim iprop(4) As String
		iprop(1) = "Cutting Length"
		iprop(2) = "Pierces"
		iprop(3) = "Bends"
		iprop(4) = "Weight"
		
		For k = 1 To 4
		Dim prop(k) As String
		    Try
		        prop(k) = iProperties.Value("Custom", iprop(k))
		    Catch
		        'Assume error means not found
		        customPropertySet.Add("", iprop(k))
		        iProperties.Value("Custom", iprop(k)) = "null"
		    End Try
		Next
		
		'Get cutting length
		Dim oSMDoc As PartDocument = ThisApplication.ActiveDocument
		Dim oSMDDef As SheetMetalComponentDefinition = oSMDoc.ComponentDefinition
		If oSMDDef.HasFlatPattern = False Then
			MsgBox("There is no Flat Pattern yet.", vbOKOnly, "NO FLAT PATTERN")
			Return
		End If
		Dim oTopFace As Face = oSMDDef.FlatPattern.TopFace
		Dim oMeasureTools As MeasureTools = ThisApplication.MeasureTools
		Dim oLoopLength As Double = 0
		For Each oEdgeLoop As EdgeLoop In oTopFace.EdgeLoops
			oLoopLength = oLoopLength + oMeasureTools.GetLoopLength(oEdgeLoop)
		Next
		oLoopLength = oLoopLength / 2.54
		oLoopLength = Round(oLoopLength, 2)

		'get bends
		Dim bendqty As Integer = oSMDDef.Bends.Count
		
		'get mass
		mass = Round(iProperties.Mass, 2)
	
		'get pierces
		TotalPierces = 1
		For Each oEdgeLoop In oSMDDef.FlatPattern.TopFace.EdgeLoops
		    If oEdgeLoop.IsOuterEdgeLoop = False Then
		        TotalPierces = TotalPierces + 1
		    End If
		Next
		
		'write data to iproperties
		iProperties.Value("Custom", "Pierces") = TotalPierces
		iProperties.Value("Custom", "Bends") = bendqty
		iProperties.Value("Custom", "Cutting Length") = oLoopLength
		iProperties.Value("Custom", "Weight") = mass & " LBS."
		
	End If
	End Sub
```

#### Code Block 3

```vb
Sub Main
	
	Dim isdoc As Document = ThisDoc.Document
	If isdoc.SubType <> "{9C464203-9BAE-11D3-8BAD-0060B0CE6BB4}" Then
		Exit Sub
	Else
		'Create custom iproperties
		customPropertySet = ThisDoc.Document.PropertySets.Item("Inventor User Defined Properties")
		
		Dim iprop(4) As String
		iprop(1) = "Cutting Length"
		iprop(2) = "Pierces"
		iprop(3) = "Bends"
		iprop(4) = "Weight"
		
		For k = 1 To 4
		Dim prop(k) As String
		    Try
		        prop(k) = iProperties.Value("Custom", iprop(k))
		    Catch
		        'Assume error means not found
		        customPropertySet.Add("", iprop(k))
		        iProperties.Value("Custom", iprop(k)) = "null"
		    End Try
		Next
		
		'Get cutting length
		Dim oSMDoc As PartDocument = ThisApplication.ActiveDocument
		Dim oSMDDef As SheetMetalComponentDefinition = oSMDoc.ComponentDefinition
		If oSMDDef.HasFlatPattern = False Then
			MsgBox("There is no Flat Pattern yet.", vbOKOnly, "NO FLAT PATTERN")
			Return
		End If
		Dim oTopFace As Face = oSMDDef.FlatPattern.TopFace
		Dim oMeasureTools As MeasureTools = ThisApplication.MeasureTools
		Dim oLoopLength As Double = 0
		For Each oEdgeLoop As EdgeLoop In oTopFace.EdgeLoops
			oLoopLength = oLoopLength + oMeasureTools.GetLoopLength(oEdgeLoop)
		Next
		oLoopLength = oLoopLength / 2.54
		oLoopLength = Round(oLoopLength, 2)

		'get bends
		Dim bendqty As Integer = oSMDDef.Bends.Count
		
		'get mass
		mass = Round(iProperties.Mass, 2)
	
		'get pierces
		TotalPierces = 1
		For Each oEdgeLoop In oSMDDef.FlatPattern.TopFace.EdgeLoops
		    If oEdgeLoop.IsOuterEdgeLoop = False Then
		        TotalPierces = TotalPierces + 1
		    End If
		Next
		
		'write data to iproperties
		iProperties.Value("Custom", "Pierces") = TotalPierces
		iProperties.Value("Custom", "Bends") = bendqty
		iProperties.Value("Custom", "Cutting Length") = oLoopLength
		iProperties.Value("Custom", "Weight") = mass & " LBS."
		
	End If
	End Sub
```

#### Code Block 4

```vb
Sub Main
	
	Dim isdoc As Document = ThisDoc.Document
	If isdoc.SubType <> "{9C464203-9BAE-11D3-8BAD-0060B0CE6BB4}" Then
		Exit Sub
	Else
		'Create custom iproperties
		customPropertySet = ThisDoc.Document.PropertySets.Item("Inventor User Defined Properties")
		
		Dim iprop(4) As String
		iprop(1) = "Cutting Length"
		iprop(2) = "Pierces"
		iprop(3) = "Bends"
		iprop(4) = "Weight"
		
		For k = 1 To 4
		Dim prop(k) As String
		    Try
		        prop(k) = iProperties.Value("Custom", iprop(k))
		    Catch
		        'Assume error means not found
		        customPropertySet.Add("", iprop(k))
		        iProperties.Value("Custom", iprop(k)) = "null"
		    End Try
		Next
		
		'Get cutting length
		Dim oSMDoc As PartDocument = ThisApplication.ActiveDocument
		Dim oSMDDef As SheetMetalComponentDefinition = oSMDoc.ComponentDefinition
		If oSMDDef.HasFlatPattern = False Then
			MsgBox("There is no Flat Pattern yet.", vbOKOnly, "NO FLAT PATTERN")
			Return
		End If
		Dim oTopFace As Face = oSMDDef.FlatPattern.TopFace
		Dim oMeasureTools As MeasureTools = ThisApplication.MeasureTools
		Dim oLoopLength As Double = 0
		For Each oEdgeLoop As EdgeLoop In oTopFace.EdgeLoops
			oLoopLength = oLoopLength + oMeasureTools.GetLoopLength(oEdgeLoop)
		Next
		oLoopLength = oLoopLength / 2.54
		oLoopLength = Round(oLoopLength, 2)

		'get bends
		Dim bendqty As Integer = oSMDDef.Bends.Count
		
		'get mass
		mass = Round(iProperties.Mass, 2)
	
		'get pierces
		TotalPierces = 1
		For Each oEdgeLoop In oSMDDef.FlatPattern.TopFace.EdgeLoops
		    If oEdgeLoop.IsOuterEdgeLoop = False Then
		        TotalPierces = TotalPierces + 1
		    End If
		Next
		
		'write data to iproperties
		iProperties.Value("Custom", "Pierces") = TotalPierces
		iProperties.Value("Custom", "Bends") = bendqty
		iProperties.Value("Custom", "Cutting Length") = oLoopLength
		iProperties.Value("Custom", "Weight") = mass & " LBS."
		
	End If
	End Sub
```

#### Code Block 5

```vb
Sub Main
	
	Dim isdoc As Document = ThisDoc.Document
	If isdoc.SubType <> "{9C464203-9BAE-11D3-8BAD-0060B0CE6BB4}" Then
		Exit Sub
	Else
		'Create custom iproperties
		customPropertySet = ThisDoc.Document.PropertySets.Item("Inventor User Defined Properties")
		
		Dim iprop(4) As String
		iprop(1) = "Cutting Length"
		iprop(2) = "Pierces"
		iprop(3) = "Bends"
		iprop(4) = "Weight"
		
		For k = 1 To 4
		Dim prop(k) As String
		    Try
		        prop(k) = iProperties.Value("Custom", iprop(k))
		    Catch
		        'Assume error means not found
		        customPropertySet.Add("", iprop(k))
		        iProperties.Value("Custom", iprop(k)) = "null"
		    End Try
		Next
		
		'Get cutting length
		Dim oSMDoc As PartDocument = ThisApplication.ActiveDocument
		Dim oSMDDef As SheetMetalComponentDefinition = oSMDoc.ComponentDefinition
		If oSMDDef.HasFlatPattern = False Then
			MsgBox("There is no Flat Pattern yet.", vbOKOnly, "NO FLAT PATTERN")
			Return
		End If
		Dim oTopFace As Face = oSMDDef.FlatPattern.TopFace
		Dim oMeasureTools As MeasureTools = ThisApplication.MeasureTools
		Dim oLoopLength As Double = 0
		For Each oEdgeLoop As EdgeLoop In oTopFace.EdgeLoops
			oLoopLength = oLoopLength + oMeasureTools.GetLoopLength(oEdgeLoop)
		Next
		oLoopLength = oLoopLength / 2.54
		oLoopLength = Round(oLoopLength, 2)

		'get bends
		Dim bendqty As Integer = oSMDDef.Bends.Count
		
		'get mass
		mass = Round(iProperties.Mass, 2)
	
		'get pierces
		TotalPierces = 1
		For Each oEdgeLoop In oSMDDef.FlatPattern.TopFace.EdgeLoops
		    If oEdgeLoop.IsOuterEdgeLoop = False Then
		        TotalPierces = TotalPierces + 1
		    End If
		Next
		
		'write data to iproperties
		iProperties.Value("Custom", "Pierces") = TotalPierces
		iProperties.Value("Custom", "Bends") = bendqty
		iProperties.Value("Custom", "Cutting Length") = oLoopLength
		iProperties.Value("Custom", "Weight") = mass & " LBS."
		
	End If
	End Sub
```

#### Code Block 6

```vb
Sub Main
	
	Dim isdoc As Document = ThisDoc.Document
	If isdoc.SubType <> "{9C464203-9BAE-11D3-8BAD-0060B0CE6BB4}" Then
		Exit Sub
	Else
		'Create custom iproperties
		customPropertySet = ThisDoc.Document.PropertySets.Item("Inventor User Defined Properties")
		
		Dim iprop(4) As String
		iprop(1) = "Cutting Length"
		iprop(2) = "Pierces"
		iprop(3) = "Bends"
		iprop(4) = "Weight"
		
		For k = 1 To 4
		Dim prop(k) As String
		    Try
		        prop(k) = iProperties.Value("Custom", iprop(k))
		    Catch
		        'Assume error means not found
		        customPropertySet.Add("", iprop(k))
		        iProperties.Value("Custom", iprop(k)) = "null"
		    End Try
		Next
		
		'Get cutting length
		Dim oSMDoc As PartDocument = ThisApplication.ActiveDocument
		Dim oSMDDef As SheetMetalComponentDefinition = oSMDoc.ComponentDefinition
		If oSMDDef.HasFlatPattern = False Then
			MsgBox("There is no Flat Pattern yet.", vbOKOnly, "NO FLAT PATTERN")
			Return
		End If
		Dim oTopFace As Face = oSMDDef.FlatPattern.TopFace
		Dim oMeasureTools As MeasureTools = ThisApplication.MeasureTools
		Dim oLoopLength As Double = 0
		For Each oEdgeLoop As EdgeLoop In oTopFace.EdgeLoops
			oLoopLength = oLoopLength + oMeasureTools.GetLoopLength(oEdgeLoop)
		Next
		oLoopLength = oLoopLength / 2.54
		oLoopLength = Round(oLoopLength, 2)

		'get bends
		Dim bendqty As Integer = oSMDDef.Bends.Count
		
		'get mass
		mass = Round(iProperties.Mass, 2)
	
		'get pierces
		TotalPierces = 1
		For Each oEdgeLoop In oSMDDef.FlatPattern.TopFace.EdgeLoops
		    If oEdgeLoop.IsOuterEdgeLoop = False Then
		        TotalPierces = TotalPierces + 1
		    End If
		Next
		
		'write data to iproperties
		iProperties.Value("Custom", "Pierces") = TotalPierces
		iProperties.Value("Custom", "Bends") = bendqty
		iProperties.Value("Custom", "Cutting Length") = oLoopLength
		iProperties.Value("Custom", "Weight") = mass & " LBS."
		
	End If
	End Sub
```

---

### 86. Model States and BOMstructure

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/model-states-and-bomstructure/td-p/13772152](https://forums.autodesk.com/t5/inventor-programming-forum/model-states-and-bomstructure/td-p/13772152)

**Author:** MD_

**Date:** ‎08-18-2025
	
		
		06:49 AM

**Description:** Hello,  Can the BOMstructure be changed of an assembly containing more than the default Model State?I can change this in the active document but not the child-assemblies like in the example belowFollowing code always throws errors in iLogic (Inventor 2024): Dim oAssyDoc As AssemblyDocument = ThisDoc...

**Code Snippets (4):**

#### Code Block 1

```vb
'make sure our rule is working with 'FactoryDocument' if it has multiple ModelStates
Dim oAssyDoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, AssemblyDocument)
'if current document was not an Assembly, it will be Nothing
If oAssyDoc Is Nothing Then Return
For Each oRefDoc As Document In oAssyDoc.AllReferencedDocuments
	If oRefDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then ' = .iam
		'creating the AssemblyDocument variable enables Intellisense recognition of later properties
		Dim oRefADoc As AssemblyDocument = oRefDoc
		'might need to check or record name of controlling ModelState (if any)
		Dim sMSName As String = oRefADoc.ModelStateName
		'get 'Factory' version, if there is one (only version we can edit)
		If oRefADoc.ComponentDefinition.IsModelStateMember Then
			oRefADoc = oRefADoc.ComponentDefinition.FactoryDocument
		End If
		'update the referenced document, if it is needed (sometimes necessary)
		If oRefADoc.RequiresUpdate Then oRefADoc.Update2(True)
		'get its ModelStates (if it has any - none in iPart/iAssembly)
		Dim oMSs As ModelStates = oRefADoc.ComponentDefinition.ModelStates
		If oMSs.Count > 1 Then
			'may want to set MemberEditScope, to control area of effect
			oMSs.MemberEditScope = MemberEditScopeEnum.kEditAllMembers
			'oMSs.MemberEditScope = MemberEditScopeEnum.kEditActiveMember
			oRefADoc.ComponentDefinition.BOMStructure = BOMStructureEnum.kPhantomBOMStructure
			'oRefADoc.Update2(True) this may not be necessary
		End If
	End If
Next 'oRefDoc
oAssyDoc.Update2(True)
```

#### Code Block 2

```vb
'make sure our rule is working with 'FactoryDocument' if it has multiple ModelStates
Dim oAssyDoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, AssemblyDocument)
'if current document was not an Assembly, it will be Nothing
If oAssyDoc Is Nothing Then Return
For Each oRefDoc As Document In oAssyDoc.AllReferencedDocuments
	If oRefDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then ' = .iam
		'creating the AssemblyDocument variable enables Intellisense recognition of later properties
		Dim oRefADoc As AssemblyDocument = oRefDoc
		'might need to check or record name of controlling ModelState (if any)
		Dim sMSName As String = oRefADoc.ModelStateName
		'get 'Factory' version, if there is one (only version we can edit)
		If oRefADoc.ComponentDefinition.IsModelStateMember Then
			oRefADoc = oRefADoc.ComponentDefinition.FactoryDocument
		End If
		'update the referenced document, if it is needed (sometimes necessary)
		If oRefADoc.RequiresUpdate Then oRefADoc.Update2(True)
		'get its ModelStates (if it has any - none in iPart/iAssembly)
		Dim oMSs As ModelStates = oRefADoc.ComponentDefinition.ModelStates
		If oMSs.Count > 1 Then
			'may want to set MemberEditScope, to control area of effect
			oMSs.MemberEditScope = MemberEditScopeEnum.kEditAllMembers
			'oMSs.MemberEditScope = MemberEditScopeEnum.kEditActiveMember
			oRefADoc.ComponentDefinition.BOMStructure = BOMStructureEnum.kPhantomBOMStructure
			'oRefADoc.Update2(True) this may not be necessary
		End If
	End If
Next 'oRefDoc
oAssyDoc.Update2(True)
```

#### Code Block 3

```vb
'make sure our rule is working with 'FactoryDocument' if it has multiple ModelStates
Dim oAssyDoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, AssemblyDocument)
'if current document was not an Assembly, it will be Nothing
If oAssyDoc Is Nothing Then Return
For Each oRefDoc As Document In oAssyDoc.AllReferencedDocuments
	If oRefDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then ' = .iam
		'creating the AssemblyDocument variable enables Intellisense recognition of later properties
		Dim oRefADoc As AssemblyDocument = oRefDoc
		'might need to check or record name of controlling ModelState (if any)
		Dim sMSName As String = oRefADoc.ModelStateName
		'get 'Factory' version, if there is one (only version we can edit)
		If oRefADoc.ComponentDefinition.IsModelStateMember Then
			oRefADoc = oRefADoc.ComponentDefinition.FactoryDocument
		End If
		'update the referenced document, if it is needed (sometimes necessary)
		If oRefADoc.RequiresUpdate Then oRefADoc.Update2(True)
		'get its ModelStates (if it has any - none in iPart/iAssembly)
		Dim oMSs As ModelStates = oRefADoc.ComponentDefinition.ModelStates
		If oMSs.Count > 1 Then
			'may want to set MemberEditScope, to control area of effect
			oMSs.MemberEditScope = MemberEditScopeEnum.kEditAllMembers
			'oMSs.MemberEditScope = MemberEditScopeEnum.kEditActiveMember
			oRefADoc.ComponentDefinition.BOMStructure = BOMStructureEnum.kPhantomBOMStructure
			'oRefADoc.Update2(True) this may not be necessary
		End If
	End If
Next 'oRefDoc
oAssyDoc.Update2(True)
```

#### Code Block 4

```vb
'make sure our rule is working with 'FactoryDocument' if it has multiple ModelStates
Dim oAssyDoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, AssemblyDocument)
'if current document was not an Assembly, it will be Nothing
If oAssyDoc Is Nothing Then Return
For Each oRefDoc As Document In oAssyDoc.AllReferencedDocuments
	If oRefDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then ' = .iam
		'creating the AssemblyDocument variable enables Intellisense recognition of later properties
		Dim oRefADoc As AssemblyDocument = oRefDoc
		'might need to check or record name of controlling ModelState (if any)
		Dim sMSName As String = oRefADoc.ModelStateName
		'get 'Factory' version, if there is one (only version we can edit)
		If oRefADoc.ComponentDefinition.IsModelStateMember Then
			oRefADoc = oRefADoc.ComponentDefinition.FactoryDocument
		End If
		'update the referenced document, if it is needed (sometimes necessary)
		If oRefADoc.RequiresUpdate Then oRefADoc.Update2(True)
		'get its ModelStates (if it has any - none in iPart/iAssembly)
		Dim oMSs As ModelStates = oRefADoc.ComponentDefinition.ModelStates
		If oMSs.Count > 1 Then
			'may want to set MemberEditScope, to control area of effect
			oMSs.MemberEditScope = MemberEditScopeEnum.kEditAllMembers
			'oMSs.MemberEditScope = MemberEditScopeEnum.kEditActiveMember
			oRefADoc.ComponentDefinition.BOMStructure = BOMStructureEnum.kPhantomBOMStructure
			'oRefADoc.Update2(True) this may not be necessary
		End If
	End If
Next 'oRefDoc
oAssyDoc.Update2(True)
```

#### Code Block 5

```vb
Dim oAssyDoc As AssemblyDocument = ThisDoc.Document
For Each oRefDoc As Document In oAssyDoc.AllReferencedDocuments
	If oRefDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then ' = .iam
		If oRefDoc.ComponentDefinition.ModelStates.Count > 1 Then
			oRefDoc.ComponentDefinition.BOMStructure = BOMStructureEnum.kPhantomBOMStructure
		End If
	End If
Next
```

#### Code Block 6

```vb
Dim oAssyDoc As AssemblyDocument = ThisDoc.Document
For Each oRefDoc As Document In oAssyDoc.AllReferencedDocuments
	If oRefDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then ' = .iam
		If oRefDoc.ComponentDefinition.ModelStates.Count > 1 Then
			oRefDoc.ComponentDefinition.BOMStructure = BOMStructureEnum.kPhantomBOMStructure
		End If
	End If
Next
```

#### Code Block 7

```vb
Dim oAssyDoc As AssemblyDocument = ThisDoc.Document
For Each oRefDoc As Document In oAssyDoc.AllReferencedDocuments
	If oRefDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then ' = .iam
		If oRefDoc.ComponentDefinition.ModelStates.Count > 1 Then
			oRefDoc.ComponentDefinition.BOMStructure = BOMStructureEnum.kPhantomBOMStructure
		End If
	End If
Next
```

#### Code Block 8

```vb
Dim oAssyDoc As AssemblyDocument = ThisDoc.Document
For Each oRefDoc As Document In oAssyDoc.AllReferencedDocuments
	If oRefDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then ' = .iam
		If oRefDoc.ComponentDefinition.ModelStates.Count > 1 Then
			oRefDoc.ComponentDefinition.BOMStructure = BOMStructureEnum.kPhantomBOMStructure
		End If
	End If
Next
```

---

### 87. Modify Bom Table Settings (add Custom iProperty Column)

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/modify-bom-table-settings-add-custom-iproperty-column/td-p/13792951#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/modify-bom-table-settings-add-custom-iproperty-column/td-p/13792951#messageview_0)

**Author:** Maxim-CADman77

**Date:** ‎09-02-2025
	
		
		06:57 AM

**Description:** Recently, I was asked to automate customization of BOM Table settings (add column of a custom iProperty)I don't see any easy way thus the plan is to export current  settings to XML file, modify the file in a necessary way, import settings back from the modified XML file.I manually exported xml twice...

**Code Snippets (2):**

#### Code Block 1

```vb
If Not TypeOf ThisDoc.Document Is AssemblyDocument Then MsgBox("Not Assy!") : Return

Dim aDoc As AssemblyDocument = ThisDoc.Document
Dim aDef As AssemblyComponentDefinition = aDoc.ComponentDefinition
Dim aBom As BOM = aDef.BOM
Logger.Info("aBom: " & If(aBom Is Nothing, "-", "+"))
Logger.Info("BOMViews Count: " & aBom.BOMViews.Count)

Dim aBomCstSetFilePath As String = "C:\Temp\BomCstSets.xml" ' aDoc.FullFilename & "_BomCstSets.xml" ' System.IO.Path.ChangeExtension(aDoc.FullFilename, "xml")
Logger.Info("aBomCstSetFilePath: " & aBomCstSetFilePath)

aBom.ExportBOMCustomization(aBomCstSetFilePath) ' Unspecified error (Exception from HRESULT: 0x80004005 (E_FAIL))
```

#### Code Block 2

```vb
If Not TypeOf ThisDoc.Document Is AssemblyDocument Then MsgBox("Not Assy!") : Return

Dim aDoc As AssemblyDocument = ThisDoc.Document
Dim aDef As AssemblyComponentDefinition = aDoc.ComponentDefinition
Dim aBom As BOM = aDef.BOM
Logger.Info("aBom: " & If(aBom Is Nothing, "-", "+"))
Logger.Info("BOMViews Count: " & aBom.BOMViews.Count)

Dim aBomCstSetFilePath As String = "C:\Temp\BomCstSets.xml" ' aDoc.FullFilename & "_BomCstSets.xml" ' System.IO.Path.ChangeExtension(aDoc.FullFilename, "xml")
Logger.Info("aBomCstSetFilePath: " & aBomCstSetFilePath)

aBom.ExportBOMCustomization(aBomCstSetFilePath) ' Unspecified error (Exception from HRESULT: 0x80004005 (E_FAIL))
```

#### Code Block 3

```vb
If Not TypeOf ThisDoc.Document Is AssemblyDocument Then MsgBox("Not Assy!") : Return

Dim aDoc As AssemblyDocument = ThisDoc.Document
Dim aDef As AssemblyComponentDefinition = aDoc.ComponentDefinition
Dim aBom As BOM = aDef.BOM
Logger.Info("aBom: " & If(aBom Is Nothing, "-", "+"))
Logger.Info("BOMViews Count: " & aBom.BOMViews.Count)

Dim aBomCstSetFilePath As String = "C:\Temp\BomCstSets.xml" ' aDoc.FullFilename & "_BomCstSets.xml" ' System.IO.Path.ChangeExtension(aDoc.FullFilename, "xml")
Logger.Info("aBomCstSetFilePath: " & aBomCstSetFilePath)

aBom.ExportBOMCustomization(aBomCstSetFilePath) ' Unspecified error (Exception from HRESULT: 0x80004005 (E_FAIL))
```

#### Code Block 4

```vb
If Not TypeOf ThisDoc.Document Is AssemblyDocument Then MsgBox("Not Assy!") : Return

Dim aDoc As AssemblyDocument = ThisDoc.Document
Dim aDef As AssemblyComponentDefinition = aDoc.ComponentDefinition
Dim aBom As BOM = aDef.BOM
Logger.Info("aBom: " & If(aBom Is Nothing, "-", "+"))
Logger.Info("BOMViews Count: " & aBom.BOMViews.Count)

Dim aBomCstSetFilePath As String = "C:\Temp\BomCstSets.xml" ' aDoc.FullFilename & "_BomCstSets.xml" ' System.IO.Path.ChangeExtension(aDoc.FullFilename, "xml")
Logger.Info("aBomCstSetFilePath: " & aBomCstSetFilePath)

aBom.ExportBOMCustomization(aBomCstSetFilePath) ' Unspecified error (Exception from HRESULT: 0x80004005 (E_FAIL))
```

---

### 88. Part rule with Ref parameters to top assembly

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/part-rule-with-ref-parameters-to-top-assembly/td-p/13844485](https://forums.autodesk.com/t5/inventor-programming-forum/part-rule-with-ref-parameters-to-top-assembly/td-p/13844485)

**Author:** A.K.CORTEL

**Date:** ‎10-08-2025
	
		
		10:53 PM

**Description:** Hi forum. I have a part-level iLogic rule that manipulates sketch dimensions. Dim oPDoc As PartDocument = ThisDoc.Document Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition Dim oSketch As PlanarSketch = oPDef.Sketches.Item("TANK SHELL") Dim oDims As DimensionConstraints = oSketch.Dime...

**Code Snippets (1):**

#### Code Block 1

```vb
Dim oPDoc As PartDocument = ThisDoc.Document
Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
Dim oSketch As PlanarSketch = oPDef.Sketches.Item("TANK SHELL")
Dim oDims As DimensionConstraints = oSketch.DimensionConstraints
Dim oHeightDim As DimensionConstraint
Dim oAngleDim As DimensionConstraint
For Each oDim As DimensionConstraint In oDims
	If oDim.Parameter.Name = "TANK_EXTERNAL_DIA" Then
		oHeightDim = oDim
	ElseIf oDim.Parameter.Name = "TANK_INTERNAL_DIA" Then
		oAngleDim = oDim
	End If
Next

TANK_EXTERNAL = Not TANK_INTERNAL

Try
	oAngleDim.Driven = Not oAngleDim.Driven
Catch
	oHeightDim.Driven = Not oHeightDim.Driven
	oAngleDim.Driven = Not oAngleDim.Driven
	Exit Sub
End Try
oHeightDim.Driven = Not oHeightDim.Driven
```

---

### 89. Placing iParts into an assembly with iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/placing-iparts-into-an-assembly-with-ilogic/td-p/13752858](https://forums.autodesk.com/t5/inventor-programming-forum/placing-iparts-into-an-assembly-with-ilogic/td-p/13752858)

**Author:** medwardsNKCFQ

**Date:** ‎08-04-2025
	
		
		07:48 AM

**Description:** Hi, I'm trying to automate nesting several hundred rectangular sheet metal plaques with sequential ID numbers.The parts are fairly simple just a rectangle, rounded corners, 2 mounting holes, and text such as "AA PRODU 999". I've successfully setup an iPart with all the required text variations being...

**Code Snippets (2):**

#### Code Block 1

```vb
'import parts folder as string EDIT ME!
Dim partsFolder As String = "R:\Industrial Engineering\A-ME\CAD\Dolly plaques v2"

'define number of plaques EDIT ME! (could be improved by reading this value from the selected part?)
Dim numOfPlaques As Integer = 500

'define size of plaque and spacing of laser EDIT ME!
Dim plaqueLength As Integer = 280
Dim plaqueWidth As Integer = 40
Dim laserClearance As Integer = 5

'define size of sheet for nesting EDIT ME!
Dim sheetLength As Integer = 2440
Dim sheetWidth As Integer = 1220


'define x y location variables
Dim xLocation As Integer = 0
Dim yLocation As Integer = 0
Dim sheetNum As Integer = 0

'main loop for number of plaques
Dim i As Integer = 0
While i < numOfPlaques
	i += 1
	
	'debugging window text
	'Dim txt As String = String.Format("X= {0}   Y= {1}",xLocation,yLocation)
	'MessageBox.Show(txt, "Part placed:")
	
	'set name and pos for adding component
	Dim name As String = String.Format("Plaque-{0}",i)
	Dim pos = ThisDoc.Geometry.Point(xLocation,0,yLocation)

	'add Component dolley plaques v2.ipt
	Dim componentPlaque = Components.AddiPart(name, partsFolder & "\Dolley plaques v2.ipt", row := i, position :=pos, grounded := True, visible := True, appearance := Nothing)
	
	'increment collumn
	xLocation += plaqueLength + laserClearance
	
	'increment row once collumns full
	If xLocation >= sheetLength - plaqueLength + ((sheetLength + plaqueLength) * sheetNum)
		'increment row
		yLocation += plaqueWidth + laserClearance
		'go back to bottom left corner of current sheet
		xLocation = 0 + ((sheetLength + plaqueLength) * sheetNum)
	End If
	
	If yLocation >= sheetWidth - plaqueWidth
		'this loop getting entered every collumn after first sheet
		'increment sheet number
		sheetNum += 1
		'go to bottom left corner of next sheet
		xLocation = 0 + ((sheetLength + plaqueLength) * sheetNum)
		yLocation = 0
	End If
	
End While
```

#### Code Block 2

```vb
'import parts folder as string EDIT ME!
Dim partsFolder As String = "R:\Industrial Engineering\A-ME\CAD\Dolly plaques v2"

'define number of plaques EDIT ME! (could be improved by reading this value from the selected part?)
Dim numOfPlaques As Integer = 500

'define size of plaque and spacing of laser EDIT ME!
Dim plaqueLength As Integer = 280
Dim plaqueWidth As Integer = 40
Dim laserClearance As Integer = 5

'define size of sheet for nesting EDIT ME!
Dim sheetLength As Integer = 2440
Dim sheetWidth As Integer = 1220


'define x y location variables
Dim xLocation As Integer = 0
Dim yLocation As Integer = 0
Dim sheetNum As Integer = 0

'main loop for number of plaques
Dim i As Integer = 0
While i < numOfPlaques
	i += 1
	
	'debugging window text
	'Dim txt As String = String.Format("X= {0}   Y= {1}",xLocation,yLocation)
	'MessageBox.Show(txt, "Part placed:")
	
	'set name and pos for adding component
	Dim name As String = String.Format("Plaque-{0}",i)
	Dim pos = ThisDoc.Geometry.Point(xLocation,0,yLocation)

	'add Component dolley plaques v2.ipt
	Dim componentPlaque = Components.AddiPart(name, partsFolder & "\Dolley plaques v2.ipt", row := i, position :=pos, grounded := True, visible := True, appearance := Nothing)
	
	'increment collumn
	xLocation += plaqueLength + laserClearance
	
	'increment row once collumns full
	If xLocation >= sheetLength - plaqueLength + ((sheetLength + plaqueLength) * sheetNum)
		'increment row
		yLocation += plaqueWidth + laserClearance
		'go back to bottom left corner of current sheet
		xLocation = 0 + ((sheetLength + plaqueLength) * sheetNum)
	End If
	
	If yLocation >= sheetWidth - plaqueWidth
		'this loop getting entered every collumn after first sheet
		'increment sheet number
		sheetNum += 1
		'go to bottom left corner of next sheet
		xLocation = 0 + ((sheetLength + plaqueLength) * sheetNum)
		yLocation = 0
	End If
	
End While
```

#### Code Block 3

```vb
'import parts folder as string EDIT ME!
Dim partsFolder As String = "R:\Industrial Engineering\A-ME\CAD\Dolly plaques v2"

'define number of plaques EDIT ME! (could be improved by reading this value from the selected part?)
Dim numOfPlaques As Integer = 500

'define size of plaque and spacing of laser EDIT ME!
Dim plaqueLength As Integer = 280
Dim plaqueWidth As Integer = 40
Dim laserClearance As Integer = 5

'define size of sheet for nesting EDIT ME!
Dim sheetLength As Integer = 2440
Dim sheetWidth As Integer = 1220


'define x y location variables
Dim xLocation As Integer = 0
Dim yLocation As Integer = 0
Dim sheetNum As Integer = 0

'main loop for number of plaques
Dim i As Integer = 0
While i < numOfPlaques
	i += 1
	
	'debugging window text
	'Dim txt As String = String.Format("X= {0}   Y= {1}",xLocation,yLocation)
	'MessageBox.Show(txt, "Part placed:")
	
	'set name and pos for adding component
	Dim name As String = String.Format("Plaque-{0}",i)
	Dim pos = ThisDoc.Geometry.Point(xLocation,0,yLocation)

	'add Component dolley plaques v2.ipt
	Dim componentPlaque = Components.AddiPart(name, partsFolder & "\Dolley plaques v2.ipt", row := i, position :=pos, grounded := True, visible := True, appearance := Nothing)
	
	'increment collumn
	xLocation += plaqueLength + laserClearance
	
	'increment row once collumns full
	If xLocation >= sheetLength - plaqueLength + ((sheetLength + plaqueLength) * sheetNum)
		'increment row
		yLocation += plaqueWidth + laserClearance
		'go back to bottom left corner of current sheet
		xLocation = 0 + ((sheetLength + plaqueLength) * sheetNum)
	End If
	
	If yLocation >= sheetWidth - plaqueWidth
		'this loop getting entered every collumn after first sheet
		'increment sheet number
		sheetNum += 1
		'go to bottom left corner of next sheet
		xLocation = 0 + ((sheetLength + plaqueLength) * sheetNum)
		yLocation = 0
	End If
	
End While
```

#### Code Block 4

```vb
'import parts folder as string EDIT ME!
Dim partsFolder As String = "R:\Industrial Engineering\A-ME\CAD\Dolly plaques v2"

'define number of plaques EDIT ME! (could be improved by reading this value from the selected part?)
Dim numOfPlaques As Integer = 500

'define size of plaque and spacing of laser EDIT ME!
Dim plaqueLength As Integer = 280
Dim plaqueWidth As Integer = 40
Dim laserClearance As Integer = 5

'define size of sheet for nesting EDIT ME!
Dim sheetLength As Integer = 2440
Dim sheetWidth As Integer = 1220


'define x y location variables
Dim xLocation As Integer = 0
Dim yLocation As Integer = 0
Dim sheetNum As Integer = 0

'main loop for number of plaques
Dim i As Integer = 0
While i < numOfPlaques
	i += 1
	
	'debugging window text
	'Dim txt As String = String.Format("X= {0}   Y= {1}",xLocation,yLocation)
	'MessageBox.Show(txt, "Part placed:")
	
	'set name and pos for adding component
	Dim name As String = String.Format("Plaque-{0}",i)
	Dim pos = ThisDoc.Geometry.Point(xLocation,0,yLocation)

	'add Component dolley plaques v2.ipt
	Dim componentPlaque = Components.AddiPart(name, partsFolder & "\Dolley plaques v2.ipt", row := i, position :=pos, grounded := True, visible := True, appearance := Nothing)
	
	'increment collumn
	xLocation += plaqueLength + laserClearance
	
	'increment row once collumns full
	If xLocation >= sheetLength - plaqueLength + ((sheetLength + plaqueLength) * sheetNum)
		'increment row
		yLocation += plaqueWidth + laserClearance
		'go back to bottom left corner of current sheet
		xLocation = 0 + ((sheetLength + plaqueLength) * sheetNum)
	End If
	
	If yLocation >= sheetWidth - plaqueWidth
		'this loop getting entered every collumn after first sheet
		'increment sheet number
		sheetNum += 1
		'go to bottom left corner of next sheet
		xLocation = 0 + ((sheetLength + plaqueLength) * sheetNum)
		yLocation = 0
	End If
	
End While
```

---

### 90. Problem to read open documents

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/problem-to-read-open-documents/td-p/13825440](https://forums.autodesk.com/t5/inventor-programming-forum/problem-to-read-open-documents/td-p/13825440)

**Author:** cavallerin

**Date:** ‎09-25-2025
	
		
		07:25 AM

**Description:** Hi all, i have the following code that looks for open inventor files, discard what it is not an assembly and prepare a list of selectable document, then data are retrieved from the model and written on an excel sheet.The purpose of this function is to give the user the ability to say from which asse...

**Code Snippets (8):**

#### Code Block 1

```vb
For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.Item(i)
```

#### Code Block 2

```vb
For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.Item(i)
```

#### Code Block 3

```vb
For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.Item(i)
```

#### Code Block 4

```vb
For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.Item(i)
```

#### Code Block 5

```vb
For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.VisibleDocuments.Item(i)
```

#### Code Block 6

```vb
For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.VisibleDocuments.Item(i)
```

#### Code Block 7

```vb
For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.VisibleDocuments.Item(i)
```

#### Code Block 8

```vb
For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.VisibleDocuments.Item(i)
```

#### Code Block 9

```vb
Option Explicit
Dim invApp As Inventor.Application
```

#### Code Block 10

```vb
Option Explicit
Dim invApp As Inventor.Application
```

#### Code Block 11

```vb
Option Explicit
Dim invApp As Inventor.Application
```

#### Code Block 12

```vb
Option Explicit
Dim invApp As Inventor.Application
```

#### Code Block 13

```vb
Private Function GetDocumentList(ByRef docs As Object) As Variant

    Dim assiemiCount As Integer
    Dim i As Integer
    Dim doc As Object
    Dim docNames, selectedDocName As String
    Dim isAssemblyDocument, selezioneValida, gestioneCiclo As Boolean
    
    For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.Item(i)
        isAssemblyDocument = TypeName(doc) = "AssemblyDocument"
           
        If InStr(doc.FullFileName, "iam") And isAssemblyDocument Then
            docNames = docNames & i & ": " & doc.DisplayName & vbCrLf
            assiemiCount = assiemiCount + 1
        End If

    Next i
    
    If assiemiCount ....
```

#### Code Block 14

```vb
Private Function GetDocumentList(ByRef docs As Object) As Variant

    Dim assiemiCount As Integer
    Dim i As Integer
    Dim doc As Object
    Dim docNames, selectedDocName As String
    Dim isAssemblyDocument, selezioneValida, gestioneCiclo As Boolean
    
    For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.Item(i)
        isAssemblyDocument = TypeName(doc) = "AssemblyDocument"
           
        If InStr(doc.FullFileName, "iam") And isAssemblyDocument Then
            docNames = docNames & i & ": " & doc.DisplayName & vbCrLf
            assiemiCount = assiemiCount + 1
        End If

    Next i
    
    If assiemiCount ....
```

#### Code Block 15

```vb
Private Function GetDocumentList(ByRef docs As Object) As Variant

    Dim assiemiCount As Integer
    Dim i As Integer
    Dim doc As Object
    Dim docNames, selectedDocName As String
    Dim isAssemblyDocument, selezioneValida, gestioneCiclo As Boolean
    
    For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.Item(i)
        isAssemblyDocument = TypeName(doc) = "AssemblyDocument"
           
        If InStr(doc.FullFileName, "iam") And isAssemblyDocument Then
            docNames = docNames & i & ": " & doc.DisplayName & vbCrLf
            assiemiCount = assiemiCount + 1
        End If

    Next i
    
    If assiemiCount ....
```

#### Code Block 16

```vb
Private Function GetDocumentList(ByRef docs As Object) As Variant

    Dim assiemiCount As Integer
    Dim i As Integer
    Dim doc As Object
    Dim docNames, selectedDocName As String
    Dim isAssemblyDocument, selezioneValida, gestioneCiclo As Boolean
    
    For i = 1 To docs.VisibleDocuments.Count
        Set doc = docs.Item(i)
        isAssemblyDocument = TypeName(doc) = "AssemblyDocument"
           
        If InStr(doc.FullFileName, "iam") And isAssemblyDocument Then
            docNames = docNames & i & ": " & doc.DisplayName & vbCrLf
            assiemiCount = assiemiCount + 1
        End If

    Next i
    
    If assiemiCount ....
```

---

### 91. Promote a model state to become the master state with iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/promote-a-model-state-to-become-the-master-state-with-ilogic/td-p/12208768](https://forums.autodesk.com/t5/inventor-programming-forum/promote-a-model-state-to-become-the-master-state-with-ilogic/td-p/12208768)

**Author:** JMGunnar

**Date:** ‎08-31-2023
	
		
		12:06 AM

**Description:** Is there Possible too promote  active modelstate too [primary] state    Sub Main   Dim oDoc As PartDocument  'Dim oDoc As AssemblyDocement oDoc = ThisApplication.ActiveDocument      Dim oDef As PartComponentDefinition oDef = oDoc.ComponentDefinition  'Dim oDef As AssemblyComponentDefinition 'oDef = ...

**Code Snippets (5):**

#### Code Block 1

```vb
AddReference  "Microsoft.Office.Interop.Excel.dll"
Imports Microsoft.Office.Interop
Imports oXL = Microsoft.Office.Interop.Excel
Imports System.Windows.Forms
Imports Inventor
Public Sub Main
	Dim oADoc As AssemblyDocument = ThisDoc.FactoryDocument
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
	Dim oRepsMgr As RepresentationsManager = oADef.RepresentationsManager
	Dim oPosReps As PositionalRepresentations = oRepsMgr.PositionalRepresentations
	Logger.Info("PosReps Count = " & oPosReps.Count.ToString)
	Dim oActivePosRep As PositionalRepresentation = oRepsMgr.ActivePositionalRepresentation
	Logger.Info("Active PosRep Name = " & oActivePosRep.Name)
	If oPosReps.ExcelWorkSheet Is Nothing Then Return
	Dim oWS As oXL.Worksheet = TryCast(oPosReps.ExcelWorkSheet, oXL.Worksheet)
	oWS.Application.Visible = True
	'oWS.Visible = oXL.XlSheetVisibility.xlSheetVisible
	ThisApplication.UserInterfaceManager.DoEvents()
	MessageBox.Show("Review Opened Excel Worksheet for PositionalRepresentation Settings.")
	oWS = Nothing
End Sub
```

#### Code Block 2

```vb
AddReference  "Microsoft.Office.Interop.Excel.dll"
Imports Microsoft.Office.Interop
Imports oXL = Microsoft.Office.Interop.Excel
Imports System.Windows.Forms
Imports Inventor
Public Sub Main
	Dim oADoc As AssemblyDocument = ThisDoc.FactoryDocument
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
	Dim oRepsMgr As RepresentationsManager = oADef.RepresentationsManager
	Dim oPosReps As PositionalRepresentations = oRepsMgr.PositionalRepresentations
	Logger.Info("PosReps Count = " & oPosReps.Count.ToString)
	Dim oActivePosRep As PositionalRepresentation = oRepsMgr.ActivePositionalRepresentation
	Logger.Info("Active PosRep Name = " & oActivePosRep.Name)
	If oPosReps.ExcelWorkSheet Is Nothing Then Return
	Dim oWS As oXL.Worksheet = TryCast(oPosReps.ExcelWorkSheet, oXL.Worksheet)
	oWS.Application.Visible = True
	'oWS.Visible = oXL.XlSheetVisibility.xlSheetVisible
	ThisApplication.UserInterfaceManager.DoEvents()
	MessageBox.Show("Review Opened Excel Worksheet for PositionalRepresentation Settings.")
	oWS = Nothing
End Sub
```

#### Code Block 3

```vb
AddReference  "Microsoft.Office.Interop.Excel.dll"
Imports Microsoft.Office.Interop
Imports oXL = Microsoft.Office.Interop.Excel
Imports System.Windows.Forms
Imports Inventor
Public Sub Main
	Dim oADoc As AssemblyDocument = ThisDoc.FactoryDocument
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
	Dim oRepsMgr As RepresentationsManager = oADef.RepresentationsManager
	Dim oPosReps As PositionalRepresentations = oRepsMgr.PositionalRepresentations
	Logger.Info("PosReps Count = " & oPosReps.Count.ToString)
	Dim oActivePosRep As PositionalRepresentation = oRepsMgr.ActivePositionalRepresentation
	Logger.Info("Active PosRep Name = " & oActivePosRep.Name)
	If oPosReps.ExcelWorkSheet Is Nothing Then Return
	Dim oWS As oXL.Worksheet = TryCast(oPosReps.ExcelWorkSheet, oXL.Worksheet)
	oWS.Application.Visible = True
	'oWS.Visible = oXL.XlSheetVisibility.xlSheetVisible
	ThisApplication.UserInterfaceManager.DoEvents()
	MessageBox.Show("Review Opened Excel Worksheet for PositionalRepresentation Settings.")
	oWS = Nothing
End Sub
```

#### Code Block 4

```vb
AddReference  "Microsoft.Office.Interop.Excel.dll"
Imports Microsoft.Office.Interop
Imports oXL = Microsoft.Office.Interop.Excel
Imports System.Windows.Forms
Imports Inventor
Public Sub Main
	Dim oADoc As AssemblyDocument = ThisDoc.FactoryDocument
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
	Dim oRepsMgr As RepresentationsManager = oADef.RepresentationsManager
	Dim oPosReps As PositionalRepresentations = oRepsMgr.PositionalRepresentations
	Logger.Info("PosReps Count = " & oPosReps.Count.ToString)
	Dim oActivePosRep As PositionalRepresentation = oRepsMgr.ActivePositionalRepresentation
	Logger.Info("Active PosRep Name = " & oActivePosRep.Name)
	If oPosReps.ExcelWorkSheet Is Nothing Then Return
	Dim oWS As oXL.Worksheet = TryCast(oPosReps.ExcelWorkSheet, oXL.Worksheet)
	oWS.Application.Visible = True
	'oWS.Visible = oXL.XlSheetVisibility.xlSheetVisible
	ThisApplication.UserInterfaceManager.DoEvents()
	MessageBox.Show("Review Opened Excel Worksheet for PositionalRepresentation Settings.")
	oWS = Nothing
End Sub
```

#### Code Block 5

```vb
Dim oDoc As Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Exit Sub
Dim oMSs As ModelStates
Try : oMSs = oDoc.ComponentDefinition.ModelStates : Catch : End Try
If oMSs Is Nothing OrElse oMSs.Count < 2 Then Exit Sub
Dim oPrimaryMS As ModelState = oMSs.Item(1) 'always the first one
Dim oActiveMS As ModelState = oMSs.ActiveModelState
If oActiveMS Is oPrimaryMS Then Exit Sub 'or could simply delete all custom ModelStates
Dim oPrimaryRow As ModelStateTableRow = Nothing
Dim oActiveRow As ModelStateTableRow = Nothing
Dim oMSTable As ModelStateTable = oMSs.ModelStateTable
Dim oRows As ModelStateTableRows = oMSTable.TableRows
For Each oRow As ModelStateTableRow In oRows
	If oRow.MemberName = oPrimaryMS.Name Then
		oPrimaryRow = oRow
	ElseIf oRow.MemberName = oActiveMS.Name Then
		oActiveRow = oRow
	Else
		Try : oRow.Delete : Catch : End Try
	End If
Next 'oRow
For i As Integer = 2 To oActiveRow.Count
	'Logger.Info(oActiveRow.Item(i).Value)
	Try : oPrimaryRow.Item(i).Value = oActiveRow.Item(i).Value : Catch : End Try
Next
oPrimaryMS.Activate
Try : oActiveMS.Delete : Catch : End Try
```

#### Code Block 6

```vb
Dim oDoc As Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Exit Sub
Dim oMSs As ModelStates
Try : oMSs = oDoc.ComponentDefinition.ModelStates : Catch : End Try
If oMSs Is Nothing OrElse oMSs.Count < 2 Then Exit Sub
Dim oPrimaryMS As ModelState = oMSs.Item(1) 'always the first one
Dim oActiveMS As ModelState = oMSs.ActiveModelState
If oActiveMS Is oPrimaryMS Then Exit Sub 'or could simply delete all custom ModelStates
Dim oPrimaryRow As ModelStateTableRow = Nothing
Dim oActiveRow As ModelStateTableRow = Nothing
Dim oMSTable As ModelStateTable = oMSs.ModelStateTable
Dim oRows As ModelStateTableRows = oMSTable.TableRows
For Each oRow As ModelStateTableRow In oRows
	If oRow.MemberName = oPrimaryMS.Name Then
		oPrimaryRow = oRow
	ElseIf oRow.MemberName = oActiveMS.Name Then
		oActiveRow = oRow
	Else
		Try : oRow.Delete : Catch : End Try
	End If
Next 'oRow
For i As Integer = 2 To oActiveRow.Count
	'Logger.Info(oActiveRow.Item(i).Value)
	Try : oPrimaryRow.Item(i).Value = oActiveRow.Item(i).Value : Catch : End Try
Next
oPrimaryMS.Activate
Try : oActiveMS.Delete : Catch : End Try
```

#### Code Block 7

```vb
Dim oDoc As Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Exit Sub
Dim oMSs As ModelStates
Try : oMSs = oDoc.ComponentDefinition.ModelStates : Catch : End Try
If oMSs Is Nothing OrElse oMSs.Count < 2 Then Exit Sub
Dim oPrimaryMS As ModelState = oMSs.Item(1) 'always the first one
Dim oActiveMS As ModelState = oMSs.ActiveModelState
If oActiveMS Is oPrimaryMS Then Exit Sub 'or could simply delete all custom ModelStates
Dim oPrimaryRow As ModelStateTableRow = Nothing
Dim oActiveRow As ModelStateTableRow = Nothing
Dim oMSTable As ModelStateTable = oMSs.ModelStateTable
Dim oRows As ModelStateTableRows = oMSTable.TableRows
For Each oRow As ModelStateTableRow In oRows
	If oRow.MemberName = oPrimaryMS.Name Then
		oPrimaryRow = oRow
	ElseIf oRow.MemberName = oActiveMS.Name Then
		oActiveRow = oRow
	Else
		Try : oRow.Delete : Catch : End Try
	End If
Next 'oRow
For i As Integer = 2 To oActiveRow.Count
	'Logger.Info(oActiveRow.Item(i).Value)
	Try : oPrimaryRow.Item(i).Value = oActiveRow.Item(i).Value : Catch : End Try
Next
oPrimaryMS.Activate
Try : oActiveMS.Delete : Catch : End Try
```

#### Code Block 8

```vb
Dim oDoc As Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Exit Sub
Dim oMSs As ModelStates
Try : oMSs = oDoc.ComponentDefinition.ModelStates : Catch : End Try
If oMSs Is Nothing OrElse oMSs.Count < 2 Then Exit Sub
Dim oPrimaryMS As ModelState = oMSs.Item(1) 'always the first one
Dim oActiveMS As ModelState = oMSs.ActiveModelState
If oActiveMS Is oPrimaryMS Then Exit Sub 'or could simply delete all custom ModelStates
Dim oPrimaryRow As ModelStateTableRow = Nothing
Dim oActiveRow As ModelStateTableRow = Nothing
Dim oMSTable As ModelStateTable = oMSs.ModelStateTable
Dim oRows As ModelStateTableRows = oMSTable.TableRows
For Each oRow As ModelStateTableRow In oRows
	If oRow.MemberName = oPrimaryMS.Name Then
		oPrimaryRow = oRow
	ElseIf oRow.MemberName = oActiveMS.Name Then
		oActiveRow = oRow
	Else
		Try : oRow.Delete : Catch : End Try
	End If
Next 'oRow
For i As Integer = 2 To oActiveRow.Count
	'Logger.Info(oActiveRow.Item(i).Value)
	Try : oPrimaryRow.Item(i).Value = oActiveRow.Item(i).Value : Catch : End Try
Next
oPrimaryMS.Activate
Try : oActiveMS.Delete : Catch : End Try
```

#### Code Block 9

```vb
Sub Main 

Dim oDoc As PartDocument

'Dim oDoc As AssemblyDocement
oDoc = ThisApplication.ActiveDocument
    
Dim oDef As PartComponentDefinition
oDef = oDoc.ComponentDefinition

'Dim oDef As AssemblyComponentDefinition
'oDef = oDoc.ComponentDefinition
    
Dim oStates As ModelStates 	
oStates = oDef.ModelStates

Dim oTable As ModelStateTable	
oTable = oStates.ModelStateTable

'get the current model state, so we can return to it when done
oCurrentState = ThisDoc.ActiveModelState

MessageBox.Show(oCurrentState, "Title")



' Iterate All Rows of model states
i = 2
Dim oRow As ModelStateTableRow 

Dim oRowMaster As ModelStateTableRow
For Each oRow In oTable.TableRows
	'this activates the row to make it the current state
	
	If oCurrentState = oStates.Item(i).Name Then 
		
		oRowMaster =  oTable.TableRows.Item(i)
		
		Exit For
	End If 
	
'	MessageBox.Show( , "Title")
	
'	oStates.Item(i).Activate
	

	
	
	
	
	i=i+1
Next

oTable.TableRows.Item(1) = oRowMaster
	


	'set original state active again
	oStates.Item(oCurrentState).Activate 



iLogicVb.UpdateWhenDone = True
End Sub
```

#### Code Block 10

```vb
Sub Main 

Dim oDoc As PartDocument

'Dim oDoc As AssemblyDocement
oDoc = ThisApplication.ActiveDocument
    
Dim oDef As PartComponentDefinition
oDef = oDoc.ComponentDefinition

'Dim oDef As AssemblyComponentDefinition
'oDef = oDoc.ComponentDefinition
    
Dim oStates As ModelStates 	
oStates = oDef.ModelStates

Dim oTable As ModelStateTable	
oTable = oStates.ModelStateTable

'get the current model state, so we can return to it when done
oCurrentState = ThisDoc.ActiveModelState

MessageBox.Show(oCurrentState, "Title")



' Iterate All Rows of model states
i = 2
Dim oRow As ModelStateTableRow 

Dim oRowMaster As ModelStateTableRow
For Each oRow In oTable.TableRows
	'this activates the row to make it the current state
	
	If oCurrentState = oStates.Item(i).Name Then 
		
		oRowMaster =  oTable.TableRows.Item(i)
		
		Exit For
	End If 
	
'	MessageBox.Show( , "Title")
	
'	oStates.Item(i).Activate
	

	
	
	
	
	i=i+1
Next

oTable.TableRows.Item(1) = oRowMaster
	


	'set original state active again
	oStates.Item(oCurrentState).Activate 



iLogicVb.UpdateWhenDone = True
End Sub
```

---

### 92. Reference example: adding 2 leaders to a leader note

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/reference-example-adding-2-leaders-to-a-leader-note/td-p/13806456#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/reference-example-adding-2-leaders-to-a-leader-note/td-p/13806456#messageview_0)

**Author:** Curtis_Waguespack

**Date:** ‎09-11-2025
	
		
		06:31 AM

**Description:** Recently had trouble finding an example or good info in the API help, so here's a quick example of adding 2 leaders to a leader note ( works the same with weld symbols, etc), in case it helps someone in a future search. 					 				 			 			 				 	  			 			 				 	 			 				 					 						Solved! 					 			...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,"Hello World")

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 2

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,"Hello World")

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 3

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,"Hello World")

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 4

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,"Hello World")

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 5

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,"Hello World")

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 6

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,"Hello World")

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 7

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

oMsg = InputBox("Enter text", "iLogic", "Hello World")

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,oMsg)

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 8

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

oMsg = InputBox("Enter text", "iLogic", "Hello World")

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,oMsg)

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 9

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

oMsg = InputBox("Enter text", "iLogic", "Hello World")

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,oMsg)

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 10

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

oMsg = InputBox("Enter text", "iLogic", "Hello World")

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,oMsg)

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 11

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

oMsg = InputBox("Enter text", "iLogic", "Hello World")

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,oMsg)

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

#### Code Block 12

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument

' a reference to the active sheet.
Dim oActiveSheet As Sheet
oActiveSheet = oDrawDoc.ActiveSheet

' a reference to the drawing curve segment.
' Please select a linear drwaing curve.
Dim oDrawingCurveSegment1 As DrawingCurveSegment
oDrawingCurveSegment1 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve")

' a reference to the drawing curve.
Dim oDrawingCurve1 As DrawingCurve
oDrawingCurve1 = oDrawingCurveSegment1.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint1 As Point2d
oMidPoint1 = oDrawingCurve1.MidPoint

Dim oDrawingCurveSegment2 As DrawingCurveSegment
oDrawingCurveSegment2 = ThisApplication.CommandManager.Pick(kDrawingCurveSegmentFilter, "Select a linear curve for the 2nd leader")

' a reference to the drawing curve.
Dim oDrawingCurve2 As DrawingCurve
oDrawingCurve2 = oDrawingCurveSegment2.Parent

' Get the mid point of the selected curve
' assuming that the selection curve is linear
Dim oMidPoint2 As Point2d
oMidPoint2 = oDrawingCurve2.MidPoint

 'a reference To the TransientGeometry Object.
Dim oTG As TransientGeometry
oTG = ThisApplication.TransientGeometry

Dim oLeaderPoints As ObjectCollection
oLeaderPoints = ThisApplication.TransientObjects.CreateObjectCollection

' Create a few leader points.
oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 5, oMidPoint1.Y + 10))
'oLeaderPoints.Add(oTG.CreatePoint2d(oMidPoint1.X + 10, oMidPoint1.Y + 10)) ' use this to add a second point to the leader 

' Create an intent and add to the leader points collection.
' This is the geometry that the symbol will attach to.
Dim oGeometryIntent1 As GeometryIntent
oGeometryIntent1 = oActiveSheet.CreateGeometryIntent(oDrawingCurve1)

Dim oGeometryIntent2 As GeometryIntent
oGeometryIntent2 = oActiveSheet.CreateGeometryIntent(oDrawingCurve2)

Call oLeaderPoints.Add(oGeometryIntent1)

oMsg = InputBox("Enter text", "iLogic", "Hello World")

Dim oLeaderNote As LeaderNote
oLeaderNote = oActiveSheet.DrawingNotes.LeaderNotes.Add(oLeaderPoints,oMsg)

oLeaderPoints.Clear
Call oLeaderPoints.Add(oGeometryIntent2)
oLeaderNote.Leader.RootNode.AddLeader(oLeaderPoints)
```

---

### 93. Retrieve 3D dimensions placed on an assembly in a drawing without sketches dimensions.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/retrieve-3d-dimensions-placed-on-an-assembly-in-a-drawing/td-p/10901052#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/retrieve-3d-dimensions-placed-on-an-assembly-in-a-drawing/td-p/10901052#messageview_0)

**Author:** vpeuvion

**Date:** ‎01-24-2022
	
		
		03:13 AM

**Description:** Hi,I'm trying to retrieve 3D dimensions placed on an assembly in a drawing. It works with this code but the dimensions of the sketches are recovered too. What I don't want.Is there a way to retrieve only the 3D dimensions without the sketch ones from the drawing view? How to differentiate them? Dim ...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
For Each oSheet As Inventor.Sheet In oDoc.Sheets
	For Each oView As DrawingView In oSheet.DrawingViews
		oSheet.DrawingDimensions.GeneralDimensions.Retrieve(oView)
	Next
Next
```

#### Code Block 2

```vb
oDDoc = ThisDrawing.Document
oSheet = oDDoc.ActiveSheet
oView = oSheet.DrawingViews.Item(1)
oView.Include3DAnnotations = True
```

#### Code Block 3

```vb
oDDoc = ThisDrawing.Document
oSheet = oDDoc.ActiveSheet
oView = oSheet.DrawingViews.Item(1)
oView.Include3DAnnotations = True
```

---

### 94. Run AutoCad Commands from iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/run-autocad-commands-from-ilogic/td-p/10968539#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/run-autocad-commands-from-ilogic/td-p/10968539#messageview_0)

**Author:** dalton98

**Date:** ‎02-23-2022
	
		
		02:27 PM

**Description:** Hello. I'm not sure if this is possible, but I thought I'd ask...I found an iLogic rule online that creates a dxf file from the flat pattern view.https://clintbrown.co.uk/2020/09/05/ilogic-export-all-flat-patterns-to-one-dxf/ From there I have to open the newly created dxf file and delete/rename the...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim acadExe = "C:\Program Files\Autodesk\AutoCAD 2020\acad.exe"
Dim dwgFile = "C:\Path\To\Drawing.dwg"
Dim scriptFile = "C:\Path\To\TestSrcipt.scr"
Dim args = dwgFile & " /b " & scriptFile
Process.Start(acadExe, args)
```

#### Code Block 2

```vb
Dim acadExe = "C:\Program Files\Autodesk\AutoCAD 2020\acad.exe"
Dim dwgFile = "C:\Path\To\Drawing.dwg"
Dim scriptFile = "C:\Path\To\TestSrcipt.scr"
Dim args = dwgFile & " /b " & scriptFile
Process.Start(acadExe, args)
```

#### Code Block 3

```vb
Dim acadExe = "C:\Program Files\Autodesk\AutoCAD 2020\acad.exe"
Dim dwgFile = "C:\Path\To\Drawing.dwg"
Dim scriptFile = "C:\Path\To\TestSrcipt.scr"
Dim args = dwgFile & " /b " & scriptFile
Process.Start(acadExe, args)
```

#### Code Block 4

```vb
Dim acadExe = "C:\Program Files\Autodesk\AutoCAD 2020\acad.exe"
Dim dwgFile = "C:\Path\To\Drawing.dwg"
Dim scriptFile = "C:\Path\To\TestSrcipt.scr"
Dim args = dwgFile & " /b " & scriptFile
Process.Start(acadExe, args)
```

#### Code Block 5

```vb
Dim dwgFile = """C:\Path\To\Drawing with whitespace in file name.dwg""" ' "C:\Path\To\Drawing.dwg"
```

#### Code Block 6

```vb
Dim dwgFile = """C:\Path\To\Drawing with whitespace in file name.dwg""" ' "C:\Path\To\Drawing.dwg"
```

#### Code Block 7

```vb
Dim dwgFile = """C:\Path\To\Drawing with whitespace in file name.dwg""" ' "C:\Path\To\Drawing.dwg"
```

#### Code Block 8

```vb
Dim dwgFile = """C:\Path\To\Drawing with whitespace in file name.dwg""" ' "C:\Path\To\Drawing.dwg"
```

---

### 95. Run external rule without an open document?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/run-external-rule-without-an-open-document/td-p/10149441](https://forums.autodesk.com/t5/inventor-programming-forum/run-external-rule-without-an-open-document/td-p/10149441)

**Author:** erichter

**Date:** ‎03-11-2021
	
		
		11:10 AM

**Description:** I generally write my iLogic rules in external .vb files which allows for quicker editing outside of Inventor's VB editor. I have one such script that opens documents. Since it is external, I can quickly edit it to change the documents that I want to open. I would like to be able to run this from the...

**Code Snippets (8):**

#### Code Block 1

```vb
'This is the code that does the real work when your command is executed.
Sub Run_ExternalRule()
    MessageBox.Show("This command creates a new assembly from the ZeroDoc environment via External Rule.", "Create New Assembly", MessageBoxButtons.OK, MessageBoxIcon.Information)
    Run_External_iLogic_Rule_NoDoc.RunExternalRule("\\EngServer\inventor_data\Support\iLogic\CreateNewAssemblyFromZeroDoc.iLogicVb")
End Sub
```

#### Code Block 2

```vb
'This is the code that does the real work when your command is executed.
Sub Run_ExternalRule()
    MessageBox.Show("This command creates a new assembly from the ZeroDoc environment via External Rule.", "Create New Assembly", MessageBoxButtons.OK, MessageBoxIcon.Information)
    Run_External_iLogic_Rule_NoDoc.RunExternalRule("\\EngServer\inventor_data\Support\iLogic\CreateNewAssemblyFromZeroDoc.iLogicVb")
End Sub
```

#### Code Block 3

```vb
'This is the code that does the real work when your command is executed.
Sub Run_ExternalRule()
    MessageBox.Show("This command creates a new assembly from the ZeroDoc environment via External Rule.", "Create New Assembly", MessageBoxButtons.OK, MessageBoxIcon.Information)
    Run_External_iLogic_Rule_NoDoc.RunExternalRule("\\EngServer\inventor_data\Support\iLogic\CreateNewAssemblyFromZeroDoc.iLogicVb")
End Sub
```

#### Code Block 4

```vb
'This is the code that does the real work when your command is executed.
Sub Run_ExternalRule()
    MessageBox.Show("This command creates a new assembly from the ZeroDoc environment via External Rule.", "Create New Assembly", MessageBoxButtons.OK, MessageBoxIcon.Information)
    Run_External_iLogic_Rule_NoDoc.RunExternalRule("\\EngServer\inventor_data\Support\iLogic\CreateNewAssemblyFromZeroDoc.iLogicVb")
End Sub
```

#### Code Block 5

```vb
GetiLogicAddin(ThisApplication).RunExternalRule ThisApplication.ActiveDocument, ExternalRulePath
```

#### Code Block 6

```vb
GetiLogicAddin(ThisApplication).RunExternalRule ThisApplication.ActiveDocument, ExternalRulePath
```

#### Code Block 7

```vb
GetiLogicAddin(ThisApplication).RunExternalRule ThisApplication.ActiveDocument, ExternalRulePath
```

#### Code Block 8

```vb
GetiLogicAddin(ThisApplication).RunExternalRule ThisApplication.ActiveDocument, ExternalRulePath
```

#### Code Block 9

```vb
If ThisApplication.ActiveDocument Is Nothing Then
ThisApplication.Documents.Add kPartDocumentObject
iLogicAuto.RunExternalRule ThisApplication.ActiveDocument, oPath
ThisApplication.Documents.VisibleDocuments.Item(1).Close (True)
Else
iLogicAuto.RunExternalRule ThisApplication.ActiveDocument, oPath
End If
```

#### Code Block 10

```vb
If ThisApplication.ActiveDocument Is Nothing Then
ThisApplication.Documents.Add kPartDocumentObject
iLogicAuto.RunExternalRule ThisApplication.ActiveDocument, oPath
ThisApplication.Documents.VisibleDocuments.Item(1).Close (True)
Else
iLogicAuto.RunExternalRule ThisApplication.ActiveDocument, oPath
End If
```

#### Code Block 11

```vb
If ThisApplication.ActiveDocument Is Nothing Then
ThisApplication.Documents.Add kPartDocumentObject
iLogicAuto.RunExternalRule ThisApplication.ActiveDocument, oPath
ThisApplication.Documents.VisibleDocuments.Item(1).Close (True)
Else
iLogicAuto.RunExternalRule ThisApplication.ActiveDocument, oPath
End If
```

#### Code Block 12

```vb
If ThisApplication.ActiveDocument Is Nothing Then
ThisApplication.Documents.Add kPartDocumentObject
iLogicAuto.RunExternalRule ThisApplication.ActiveDocument, oPath
ThisApplication.Documents.VisibleDocuments.Item(1).Close (True)
Else
iLogicAuto.RunExternalRule ThisApplication.ActiveDocument, oPath
End If
```

#### Code Block 13

```vb
Module Run_External_iLogic_Rule_NoDoc

    Public Sub RunExternalRule(ByVal ExternalRuleName As String)

        Try

            ' The application object.
            Dim addIns As ApplicationAddIns = g_inventorApplication.ApplicationAddIns()

            ' Unique ID code for iLogic Addin
            Dim iLogicAddIn As ApplicationAddIn = addIns.ItemById("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}")

            ' Starts the process
            iLogicAddIn.Activate()

            ' Executes the rule
            '  iLogicAddIn.Automation.RunExternalRule(g_inventorApplication.ActiveDocument, ExternalRuleName)
            iLogicAddIn.Automation.RunExternalRule(ExternalRuleName) ' << ERROR HERE
...
```

#### Code Block 14

```vb
Module Run_External_iLogic_Rule_NoDoc

    Public Sub RunExternalRule(ByVal ExternalRuleName As String)

        Try

            ' The application object.
            Dim addIns As ApplicationAddIns = g_inventorApplication.ApplicationAddIns()

            ' Unique ID code for iLogic Addin
            Dim iLogicAddIn As ApplicationAddIn = addIns.ItemById("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}")

            ' Starts the process
            iLogicAddIn.Activate()

            ' Executes the rule
            '  iLogicAddIn.Automation.RunExternalRule(g_inventorApplication.ActiveDocument, ExternalRuleName)
            iLogicAddIn.Automation.RunExternalRule(ExternalRuleName) ' << ERROR HERE
...
```

#### Code Block 15

```vb
Module Run_External_iLogic_Rule_NoDoc

    Public Sub RunExternalRule(ByVal ExternalRuleName As String)

        Try

            ' The application object.
            Dim addIns As ApplicationAddIns = g_inventorApplication.ApplicationAddIns()

            ' Unique ID code for iLogic Addin
            Dim iLogicAddIn As ApplicationAddIn = addIns.ItemById("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}")

            ' Starts the process
            iLogicAddIn.Activate()

            ' Executes the rule
            '  iLogicAddIn.Automation.RunExternalRule(g_inventorApplication.ActiveDocument, ExternalRuleName)
            iLogicAddIn.Automation.RunExternalRule(ExternalRuleName) ' << ERROR HERE
...
```

#### Code Block 16

```vb
Module Run_External_iLogic_Rule_NoDoc

    Public Sub RunExternalRule(ByVal ExternalRuleName As String)

        Try

            ' The application object.
            Dim addIns As ApplicationAddIns = g_inventorApplication.ApplicationAddIns()

            ' Unique ID code for iLogic Addin
            Dim iLogicAddIn As ApplicationAddIn = addIns.ItemById("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}")

            ' Starts the process
            iLogicAddIn.Activate()

            ' Executes the rule
            '  iLogicAddIn.Automation.RunExternalRule(g_inventorApplication.ActiveDocument, ExternalRuleName)
            iLogicAddIn.Automation.RunExternalRule(ExternalRuleName) ' << ERROR HERE
...
```

---

### 96. Sample to Modify AssetValue

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/sample-to-modify-assetvalue/td-p/13811384#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/sample-to-modify-assetvalue/td-p/13811384#messageview_0)

**Author:** Maxim-CADman77

**Date:** ‎09-15-2025
	
		
		09:36 AM

**Description:** I'd like to know if it possible to modify AssetValue by means of API.Is there any sample in API Help? 					 				 			 			 				 	Please vote for Inventor-Idea Text Search within Option Names  			 			 				 	 			 				 					 						Solved! 					 					Go to Solution.

**Code Snippets (9):**

#### Code Block 1

```vb
Dim doc As Document
    doc = ThisApplication.ActiveDocument
    
    ' Only document appearances can be edited, so that's what's created.
    ' This assumes a part or assembly document is active.
    Dim docAssets As Assets
    docAssets = doc.Assets
    
    ' Create a new appearance asset.
    Dim appearance As Asset
    appearance = docAssets.Add(kAssetTypeAppearance, "Generic", _
                                    "MyShinyRed", "My Shiny Red Color")
    
    Dim tobjs As TransientObjects
    tobjs = ThisApplication.TransientObjects


    Dim color As ColorAssetValue
    color = appearance.Item("generic_diffuse")
    color.value = tobjs.CreateColor(255, 15, 15)
    
    Dim floatValue As FloatAssetValue
    floatValue = appearance.Item("generic_reflectivity_at_0deg")
    floatValue.value = 0.5
    
    floatValue = appearance.Item("generic_reflectivity_at_90deg")
    floatValue.value = 0.5
```

#### Code Block 2

```vb
Dim doc As Document
    doc = ThisApplication.ActiveDocument
    
    ' Only document appearances can be edited, so that's what's created.
    ' This assumes a part or assembly document is active.
    Dim docAssets As Assets
    docAssets = doc.Assets
    
    ' Create a new appearance asset.
    Dim appearance As Asset
    appearance = docAssets.Add(kAssetTypeAppearance, "Generic", _
                                    "MyShinyRed", "My Shiny Red Color")
    
    Dim tobjs As TransientObjects
    tobjs = ThisApplication.TransientObjects


    Dim color As ColorAssetValue
    color = appearance.Item("generic_diffuse")
    color.value = tobjs.CreateColor(255, 15, 15)
    
    Dim floatValue As FloatAssetValue
    floatValue = appearance.Item("generic_reflectivity_at_0deg")
    floatValue.value = 0.5
    
    floatValue = appearance.Item("generic_reflectivity_at_90deg")
    floatValue.value = 0.5
```

#### Code Block 3

```vb
Dim generic_color As Inventor.TextureAssetValue
generic_color = app_ass.Item("hardwood_color")
Dim textureValue As TextureAssetValue = generic_color
Dim texture As AssetTexture = textureValue.Value
Dim textureSubValue As AssetValue = texture.Item("unifiedbitmap_Bitmap")
If texture.Item("texture_WAngle").Value <> 0 Then texture.Item("texture_WAngle").Value = 0
```

#### Code Block 4

```vb
Dim generic_color As Inventor.TextureAssetValue
generic_color = app_ass.Item("hardwood_color")
Dim textureValue As TextureAssetValue = generic_color
Dim texture As AssetTexture = textureValue.Value
Dim textureSubValue As AssetValue = texture.Item("unifiedbitmap_Bitmap")
If texture.Item("texture_WAngle").Value <> 0 Then texture.Item("texture_WAngle").Value = 0
```

#### Code Block 5

```vb
Dim material As MaterialAsset
material = projekt_asslib.MaterialAssets("mat name")
material.PhysicalPropertiesAsset.Item("structural_Density").Value=2
Logger.Info(material.PhysicalPropertiesAsset.Item("structural_Density").Value)
```

#### Code Block 6

```vb
Sub Main()
    Dim oDoc As PartDocument
    oDoc = ThisApplication.Documents.Add(kPartDocumentObject)
        
    ' Create a custom aslib which is read-write
    Dim oLib As AssetLibrary
    oLib = ThisApplication.AssetLibraries.Add("C:\Temp\TempLib.adsklib")
        
    ' Copy a material asfrom  Autodesk Material Library to custom lib
    Dim oLibAsset As Asset
    oLibAsset= ThisApplication.AssetLibraries.Item("AD121259-C03E-4A1D-92D8-59A22B4807AD").MaterialAssets("Material-001") ' Porcelain, Ivory
    
    oLibAsset.CopyTo(oLib)
    oLibAsset= oLib.MaterialAssets(1)
    
    Dim oLocalAsset As Asset
    oLocalAsset= oLibAsset.CopyTo(oDoc,False)
    
    Dim material As MaterialAsset
    material = oLocalAsset
    
    ' update the density value 
	Dim dDensity As Double
	dDensity = material.PhysicalPropertiesAsset.Item("structural_Density").Value
	Logger.Info("Initial density value: " & dDensity)
    material.PhysicalPropertiesAsset.Item("structural_Density").Value = material.PhysicalPropertiesAsset.Item("structural_Density").Value+ 550#
    Logger.Info("Updataed density value: " & material.PhysicalPropertiesAsset.Item("structural_Density").Value)
    
    ' Update the lib asset
    material.CopyTo (oLib, True)
    Logger.Info( "Lib density: " & oLib.MaterialAssets(1).PhysicalPropertiesAsset.Item("structural_Density").Value)
End Sub
```

#### Code Block 7

```vb
Sub Main()
    Dim oDoc As PartDocument
    oDoc = ThisApplication.Documents.Add(kPartDocumentObject)
        
    ' Create a custom aslib which is read-write
    Dim oLib As AssetLibrary
    oLib = ThisApplication.AssetLibraries.Add("C:\Temp\TempLib.adsklib")
        
    ' Copy a material asfrom  Autodesk Material Library to custom lib
    Dim oLibAsset As Asset
    oLibAsset= ThisApplication.AssetLibraries.Item("AD121259-C03E-4A1D-92D8-59A22B4807AD").MaterialAssets("Material-001") ' Porcelain, Ivory
    
    oLibAsset.CopyTo(oLib)
    oLibAsset= oLib.MaterialAssets(1)
    
    Dim oLocalAsset As Asset
    oLocalAsset= oLibAsset.CopyTo(oDoc,False)
    
    Dim material As MaterialAsset
    material = oLocalAsset
    
    ' update the density value 
	Dim dDensity As Double
	dDensity = material.PhysicalPropertiesAsset.Item("structural_Density").Value
	Logger.Info("Initial density value: " & dDensity)
    material.PhysicalPropertiesAsset.Item("structural_Density").Value = material.PhysicalPropertiesAsset.Item("structural_Density").Value+ 550#
    Logger.Info("Updataed density value: " & material.PhysicalPropertiesAsset.Item("structural_Density").Value)
    
    ' Update the lib asset
    material.CopyTo (oLib, True)
    Logger.Info( "Lib density: " & oLib.MaterialAssets(1).PhysicalPropertiesAsset.Item("structural_Density").Value)
End Sub
```

#### Code Block 8

```vb
materialasset.Item("physmat_Keywords").Value = sap_.Text
materialasset.Item("physmat_Label").Value = sap_.Text
materialasset.Item("physmat_Manufacturer").Value = Producent_.Text
materialasset.Item("physmat_Comments").Value = kategoria_.Text
materialasset.Item("physmat_Model").Value = wymiar_.Text
materialasset.Item("physmat_Type").Value = "physmat_" & assloctype.ToLower
materialasset.Item("physmat_class").Value = obr_czt.Text
materialasset.Item("physmat_Cost").Value = ilosc_.Text
```

#### Code Block 9

```vb
materialasset.Item("physmat_Keywords").Value = sap_.Text
materialasset.Item("physmat_Label").Value = sap_.Text
materialasset.Item("physmat_Manufacturer").Value = Producent_.Text
materialasset.Item("physmat_Comments").Value = kategoria_.Text
materialasset.Item("physmat_Model").Value = wymiar_.Text
materialasset.Item("physmat_Type").Value = "physmat_" & assloctype.ToLower
materialasset.Item("physmat_class").Value = obr_czt.Text
materialasset.Item("physmat_Cost").Value = ilosc_.Text
```

---

### 97. Save and Replace Rule

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/save-and-replace-rule/td-p/13802907#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/save-and-replace-rule/td-p/13802907#messageview_0)

**Author:** layochim

**Date:** ‎09-09-2025
	
		
		05:24 AM

**Description:** I'm trying to modify a rule i acquired to have it save and replace all parts in an iam that begin with only the characters "Project" since there are content center parts i cant have these be replaced.  Also, there are children iams in the parent iam i wish to save and replace as well. For example or...

**Code Snippets (7):**

#### Code Block 1

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("This rule '" & iLogicVb.RuleName & "' only works for Assembly Documents.",vbOK, "WRONG DOCUMENT TYPE")
	Return
End If

Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument

Dim oFileDlg As Inventor.FileDialog = Nothing
ThisApplication.CreateFileDialog(oFileDlg)
oFileDlg.Filter = "Autodesk Inventor Assembly Files (*.iam)|*.iam"
oFileDlg.InitialDirectory = ThisApplication.DesignProjectManager.ActiveDesignProject.WorkspacePath
oFileDlg.FileName = IO.Path.GetFileName(oADoc.FullFileName).TrimEnd("."c,"i"c,"a"c,"m"c)
oFileDlg.DialogTitle = "Specify New Name & Location For Copied Assembly"
oFileDlg.CancelError = True

On Error Resume Next
oFileDlg.ShowSave
If Err.Number <> 0 Then
	MsgBox("No File Saved.", vbOKOnly, "DIALOG CANCELED")
ElseIf oFileDlg.FileName <> "" Then
	oNewFileName = oFileDlg.FileName
	oADoc.SaveAs(oNewFileName, False)
End If

oADoc = Nothing

InventorVb.DocumentUpdate()

oADoc = ThisApplication.ActiveDocument

' Get the new base name without extension and path
Dim oNewBaseName As String = IO.Path.GetFileNameWithoutExtension(oADoc.FullFileName)

' Extract the new prefix (everything before the first hyphen)
Dim oNewPrefix As String = ""
Dim oHyphenPos As Integer = oNewBaseName.IndexOf("-")
If oHyphenPos > 0 Then
    oNewPrefix = oNewBaseName.Substring(0, oHyphenPos)
End If

' Calculate how many characters to keep from original name (excluding "Project")
' Based on your example: "Project-100000" -> "250001-100000"
' We keep 8 characters total, minus 6 for "Project" = 6 characters after "Project"
Dim oCharsToKeepAfterProject As Integer = oNewBaseName.Length - oNewPrefix.Length

Dim oReferenceSuffix As String
For Each oRefDoc As Document In oADoc.AllReferencedDocuments
	ThisApplication.Documents.Open(oRefDoc.FullFileName,False)
	
	' Get original filename without extension
	Dim oOriginalName As String = IO.Path.GetFileNameWithoutExtension(oRefDoc.FullFileName)
	
	' Check if it starts with "Project" and extract the suffix
	If oOriginalName.StartsWith("Project") And oOriginalName.Length > 7 Then
		' Take the specified number of characters after "Project"
		Dim oAfterProject As String = oOriginalName.Substring(7)
		If oAfterProject.Length >= oCharsToKeepAfterProject Then
			oReferenceSuffix = oAfterProject.Substring(0, oCharsToKeepAfterProject)
		Else
			oReferenceSuffix = oAfterProject ' Use all available characters if less than needed
		End If
	Else
		' If it doesn't start with "Project", use a fallback approach
		' You might want to modify this based on your specific needs
		oReferenceSuffix = oOriginalName
	End If
	
	' Save with new naming convention
	If oRefDoc.DocumentType = DocumentTypeEnum.kPartDocumentObject Then
		oRefDoc.SaveAs(Left(oADoc.FullFileName, Len(oADoc.FullFileName) -4) & "\" & oNewPrefix & oReferenceSuffix & ".ipt", True)
	ElseIf oRefDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
		oRefDoc.SaveAs(Left(oADoc.FullFileName, Len(oADoc.FullFileName) -4) & "\" & oNewPrefix & oReferenceSuffix & ".iam", True)
	End If
	oRefDoc.Close
Next

Dim oOccDoc As Document
Dim oOccNewFileName As String
For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
	oOccDoc = oOcc.Definition.Document
	
	' Get original filename without extension
	Dim oOriginalName As String = IO.Path.GetFileNameWithoutExtension(oOccDoc.FullFileName)
	
	' Check if it starts with "Project" and extract the suffix
	If oOriginalName.StartsWith("Project") And oOriginalName.Length > 7 Then
		' Take the specified number of characters after "Project"
		Dim oAfterProject As String = oOriginalName.Substring(7)
		If oAfterProject.Length >= oCharsToKeepAfterProject Then
			oReferenceSuffix = oAfterProject.Substring(0, oCharsToKeepAfterProject)
		Else
			oReferenceSuffix = oAfterProject
		End If
	Else
		oReferenceSuffix = oOriginalName
	End If
	
	' Build new filename
	If oOccDoc.DocumentType = DocumentTypeEnum.kPartDocumentObject Then
		oOccNewFileName = Left(oADoc.FullFileName,Len(oADoc.FullFileName)-4) & "\" & oNewPrefix & oReferenceSuffix & ".ipt"
	ElseIf oOccDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
		oOccNewFileName = Left(oADoc.FullFileName,Len(oADoc.FullFileName)-4) & "\" & oNewPrefix & oReferenceSuffix & ".iam"
	End If
	oOcc.Replace(oOccNewFileName, True)
Next
```

#### Code Block 2

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("This rule '" & iLogicVb.RuleName & "' only works for Assembly Documents.",vbOK, "WRONG DOCUMENT TYPE")
	Return
End If

Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument

Dim oFileDlg As Inventor.FileDialog = Nothing
ThisApplication.CreateFileDialog(oFileDlg)
oFileDlg.Filter = "Autodesk Inventor Assembly Files (*.iam)|*.iam"
oFileDlg.InitialDirectory = ThisApplication.DesignProjectManager.ActiveDesignProject.WorkspacePath
oFileDlg.FileName = IO.Path.GetFileName(oADoc.FullFileName).TrimEnd("."c,"i"c,"a"c,"m"c)
oFileDlg.DialogTitle = "Specify New Name & Location For Copied Assembly"
oFileDlg.CancelError = True

On Error Resume Next
oFileDlg.ShowSave
If Err.Number <> 0 Then
	MsgBox("No File Saved.", vbOKOnly, "DIALOG CANCELED")
ElseIf oFileDlg.FileName <> "" Then
	oNewFileName = oFileDlg.FileName
	oADoc.SaveAs(oNewFileName, False)
End If

oADoc = Nothing

InventorVb.DocumentUpdate()

oADoc = ThisApplication.ActiveDocument

' Get the new base name without extension and path
Dim oNewBaseName As String = IO.Path.GetFileNameWithoutExtension(oADoc.FullFileName)

' Extract the new prefix (everything before the first hyphen)
Dim oNewPrefix As String = ""
Dim oHyphenPos As Integer = oNewBaseName.IndexOf("-")
If oHyphenPos > 0 Then
    oNewPrefix = oNewBaseName.Substring(0, oHyphenPos)
End If

' Calculate how many characters to keep from original name (excluding "Project")
' Based on your example: "Project-100000" -> "250001-100000"
' We keep 8 characters total, minus 6 for "Project" = 6 characters after "Project"
Dim oCharsToKeepAfterProject As Integer = oNewBaseName.Length - oNewPrefix.Length

Dim oReferenceSuffix As String
For Each oRefDoc As Document In oADoc.AllReferencedDocuments
	ThisApplication.Documents.Open(oRefDoc.FullFileName,False)
	
	' Get original filename without extension
	Dim oOriginalName As String = IO.Path.GetFileNameWithoutExtension(oRefDoc.FullFileName)
	
	' Check if it starts with "Project" and extract the suffix
	If oOriginalName.StartsWith("Project") And oOriginalName.Length > 7 Then
		' Take the specified number of characters after "Project"
		Dim oAfterProject As String = oOriginalName.Substring(7)
		If oAfterProject.Length >= oCharsToKeepAfterProject Then
			oReferenceSuffix = oAfterProject.Substring(0, oCharsToKeepAfterProject)
		Else
			oReferenceSuffix = oAfterProject ' Use all available characters if less than needed
		End If
	Else
		' If it doesn't start with "Project", use a fallback approach
		' You might want to modify this based on your specific needs
		oReferenceSuffix = oOriginalName
	End If
	
	' Save with new naming convention
	If oRefDoc.DocumentType = DocumentTypeEnum.kPartDocumentObject Then
		oRefDoc.SaveAs(Left(oADoc.FullFileName, Len(oADoc.FullFileName) -4) & "\" & oNewPrefix & oReferenceSuffix & ".ipt", True)
	ElseIf oRefDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
		oRefDoc.SaveAs(Left(oADoc.FullFileName, Len(oADoc.FullFileName) -4) & "\" & oNewPrefix & oReferenceSuffix & ".iam", True)
	End If
	oRefDoc.Close
Next

Dim oOccDoc As Document
Dim oOccNewFileName As String
For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
	oOccDoc = oOcc.Definition.Document
	
	' Get original filename without extension
	Dim oOriginalName As String = IO.Path.GetFileNameWithoutExtension(oOccDoc.FullFileName)
	
	' Check if it starts with "Project" and extract the suffix
	If oOriginalName.StartsWith("Project") And oOriginalName.Length > 7 Then
		' Take the specified number of characters after "Project"
		Dim oAfterProject As String = oOriginalName.Substring(7)
		If oAfterProject.Length >= oCharsToKeepAfterProject Then
			oReferenceSuffix = oAfterProject.Substring(0, oCharsToKeepAfterProject)
		Else
			oReferenceSuffix = oAfterProject
		End If
	Else
		oReferenceSuffix = oOriginalName
	End If
	
	' Build new filename
	If oOccDoc.DocumentType = DocumentTypeEnum.kPartDocumentObject Then
		oOccNewFileName = Left(oADoc.FullFileName,Len(oADoc.FullFileName)-4) & "\" & oNewPrefix & oReferenceSuffix & ".ipt"
	ElseIf oOccDoc.DocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
		oOccNewFileName = Left(oADoc.FullFileName,Len(oADoc.FullFileName)-4) & "\" & oNewPrefix & oReferenceSuffix & ".iam"
	End If
	oOcc.Replace(oOccNewFileName, True)
Next
```

#### Code Block 3

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not System.IO.Path.GetFileName(fileName).StartsWith("PROJECT") Then
			Logger.Info("Skipping: " & comp.Name)
			Continue For
		Else
			Logger.Info("Copying: " & comp.Name)
		End If
		newFileName = fileName.Replace("PROJECT", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 4

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not System.IO.Path.GetFileName(fileName).StartsWith("PROJECT") Then
			Logger.Info("Skipping: " & comp.Name)
			Continue For
		Else
			Logger.Info("Copying: " & comp.Name)
		End If
		newFileName = fileName.Replace("PROJECT", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 5

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not System.IO.Path.GetFileName(fileName).StartsWith("PROJECT") Then
			Logger.Info("Skipping: " & comp.Name)
			Continue For
		Else
			Logger.Info("Copying: " & comp.Name)
		End If
		newFileName = fileName.Replace("PROJECT", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 6

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not System.IO.Path.GetFileName(fileName).StartsWith("PROJECT") Then
			Logger.Info("Skipping: " & comp.Name)
			Continue For
		Else
			Logger.Info("Copying: " & comp.Name)
		End If
		newFileName = fileName.Replace("PROJECT", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 7

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not fileName.StartsWith("Project") Then Continue For
		newFileName = fileName.Replace("Project", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 8

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not fileName.StartsWith("Project") Then Continue For
		newFileName = fileName.Replace("Project", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 9

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not fileName.StartsWith("Project") Then Continue For
		newFileName = fileName.Replace("Project", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 10

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not fileName.StartsWith("Project") Then Continue For
		newFileName = fileName.Replace("Project", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 11

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	Dim fileName As String = System.IO.Path.GetFileName(ThisDoc.Document.FullFileName)
	Dim newFileName As String = fileName.Replace("PROJECT", prefix)
	If newFileName <> fileName Then ThisDoc.Document.SaveAs(ThisDoc.Path & "\" & newFileName, False)
	
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not System.IO.Path.GetFileName(fileName).StartsWith("PROJECT") Then
			Logger.Info("Skipping: " & comp.Name)
			Continue For
		Else
			Logger.Info("Copying: " & comp.Name)
		End If
		newFileName = fileName.Replace("PROJECT", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 12

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	Dim fileName As String = System.IO.Path.GetFileName(ThisDoc.Document.FullFileName)
	Dim newFileName As String = fileName.Replace("PROJECT", prefix)
	If newFileName <> fileName Then ThisDoc.Document.SaveAs(ThisDoc.Path & "\" & newFileName, False)
	
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not System.IO.Path.GetFileName(fileName).StartsWith("PROJECT") Then
			Logger.Info("Skipping: " & comp.Name)
			Continue For
		Else
			Logger.Info("Copying: " & comp.Name)
		End If
		newFileName = fileName.Replace("PROJECT", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 13

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	Dim fileName As String = System.IO.Path.GetFileName(ThisDoc.Document.FullFileName)
	Dim newFileName As String = fileName.Replace("PROJECT", prefix)
	If newFileName <> fileName Then ThisDoc.Document.SaveAs(ThisDoc.Path & "\" & newFileName, False)
	
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not System.IO.Path.GetFileName(fileName).StartsWith("PROJECT") Then
			Logger.Info("Skipping: " & comp.Name)
			Continue For
		Else
			Logger.Info("Copying: " & comp.Name)
		End If
		newFileName = fileName.Replace("PROJECT", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

#### Code Block 14

```vb
Option Explicit On
Sub Main()
	
	Dim prefix As String = "25100"
	Dim fileName As String = System.IO.Path.GetFileName(ThisDoc.Document.FullFileName)
	Dim newFileName As String = fileName.Replace("PROJECT", prefix)
	If newFileName <> fileName Then ThisDoc.Document.SaveAs(ThisDoc.Path & "\" & newFileName, False)
	
	CopyAndReplace(ThisDoc.Document, prefix)
	
End Sub 'Main

Sub CopyAndReplace(doc As AssemblyDocument, prefix As String)
	
	Dim fileName As String
	Dim newFileName As String
	Dim suppressed As Boolean
	For Each comp As ComponentOccurrence In doc.ComponentDefinition.Occurrences
		fileName = GetFileName(comp)
		If fileName Is Nothing Then Continue For
		If Not System.IO.Path.GetFileName(fileName).StartsWith("PROJECT") Then
			Logger.Info("Skipping: " & comp.Name)
			Continue For
		Else
			Logger.Info("Copying: " & comp.Name)
		End If
		newFileName = fileName.Replace("PROJECT", prefix)
		
		suppressed = comp.Suppressed
		If suppressed Then comp.Unsuppress
			
		CopyFile(fileName, newFileName)
		comp.Replace(newFileName, True)
		
		If TypeOf comp.Definition Is AssemblyComponentDefinition Then CopyAndReplace(comp.Definition.Document, prefix)
		
		If suppressed Then comp.Suppress
	Next comp

End Sub 'CopyAndReplace

Sub CopyFile(sourceFile As String, targetFile As String)

    If Not System.IO.File.Exists(targetFile) Then System.IO.File.Copy(sourceFile, targetFile, True)
    My.Computer.FileSystem.GetFileInfo(targetFile).IsReadOnly = False
    
End Sub 'CopyFile

Function GetFileName(comp As ComponentOccurrence) As String

    Dim fileName As String = Nothing

    If comp IsNot Nothing AndAlso comp.ReferencedFileDescriptor IsNot Nothing Then
        fileName = comp.ReferencedFileDescriptor.FullFileName
    End If

    Return fileName

End Function 'GetFilename
```

---

### 98. Selecting sketch profile on the assembly

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/selecting-sketch-profile-on-the-assembly/td-p/13841032](https://forums.autodesk.com/t5/inventor-programming-forum/selecting-sketch-profile-on-the-assembly/td-p/13841032)

**Author:** ut2VF7RU

**Date:** ‎10-07-2025
	
		
		12:43 AM

**Description:** Hello, I would like to use extrude feature on an assembly but I want to do this automatic with my parameters. So far I can create the sketch I desire but cant select the desired sketch profile (It always selects all of my profiles) which I would like to cut. Here is the code;Dim oAsm As AssemblyDocu...

**Code Snippets (1):**

#### Code Block 1

```vb
Dim oAsm As AssemblyDocument = ThisDoc.Document
Dim oDef As AssemblyComponentDefinition = oAsm.ComponentDefinition
Dim tg As TransientGeometry = ThisApplication.TransientGeometry

Dim skName As String = "Cut_Sketch"

' Parameters
Dim DSS As Double = Parameter("DSS")      ' diameter (mm)
Dim radius As Double = DSS / 2 / 10       ' convert mm → cm if model units = cm
Dim offsetDist As Double = ((DSS / 2) - 550) / 10

' 1️⃣ Find work plane P1
Dim basePlane As WorkPlane = Nothing
For Each wp As WorkPlane In oDef.WorkPlanes
    If wp.Name = "P1" Then
        basePlane = wp
        Exit For
    End If
Next
If basePlane Is Nothing Then
    MessageBox.Show("Work plane 'P1' not found.")
    Return
End If

' 2️⃣ Delete old sketch if exists
For Each s As PlanarSketch In oDef.Sketches
    If s.Name = skName Then
        Try : s.Delete() : Catch : End Try
        Exit For
    End If
Next

' 3️⃣ Create new sketch
Dim oSketch As PlanarSketch = oDef.Sketches.Add(basePlane)
oSketch.Name = skName

' 4️⃣ Get the origin of P1
Dim p1Origin As Inventor.Point
Try
    p1Origin = basePlane.Definition.PointOnPlane
Catch
    p1Origin = tg.CreatePoint(0, 0, 0)
End Try
Dim center2D As Point2d = oSketch.ModelToSketchSpace(p1Origin)

' 5️⃣ Draw circle (not construction)
Dim circle As SketchCircle = oSketch.SketchCircles.AddByCenterRadius(center2D, radius)
Dim dimRad As DimensionConstraint = oSketch.DimensionConstraints.AddRadius(circle, _
    tg.CreatePoint2d(center2D.X + radius * 0.5, center2D.Y + radius * 0.3))
dimRad.Parameter.Expression = "DSS/2"

' 6️⃣ Calculate line endpoints so they touch circle horizontally
Dim halfChord As Double = Math.Sqrt(radius ^ 2 - offsetDist ^ 2)
Dim start3D As Inventor.Point = tg.CreatePoint(-halfChord, 0, -offsetDist)
Dim end3D As Inventor.Point = tg.CreatePoint(halfChord, 0, -offsetDist)

Dim p1 As Point2d = oSketch.ModelToSketchSpace(start3D)
Dim p2 As Point2d = oSketch.ModelToSketchSpace(end3D)
Dim baseLine As SketchLine = oSketch.SketchLines.AddByTwoPoints(p1, p2)

' 7️⃣ Constrain line to be horizontal and coincident to circle
oSketch.GeometricConstraints.AddHorizontal(baseLine)
oSketch.GeometricConstraints.AddCoincident(baseLine.StartSketchPoint, circle)
oSketch.GeometricConstraints.AddCoincident(baseLine.EndSketchPoint, circle)

' 8️⃣ Add offset dimension (vertical distance)
Dim offsetDim As DimensionConstraint
offsetDim = oSketch.DimensionConstraints.AddTwoPointDistance( _
    circle.CenterSketchPoint, baseLine.StartSketchPoint, _
    DimensionOrientationEnum.kVerticalDim, _
    tg.CreatePoint2d(center2D.X + radius, center2D.Y - offsetDist * 0.8))
offsetDim.Parameter.Expression = "((DSS/2)-550)"

' 9️⃣ Ground circle center for stability
oSketch.GeometricConstraints.AddGround(circle.CenterSketchPoint)

'MessageBox.Show("Sketch created successfully: circle + line endpoints coincident to circle.")
'--- Corrected safe version ---
Dim oProfile As Profile
oProfile = oSketch.Profiles.AddForSolid(1)

Dim oProfiles As Profiles = oSketch.Profiles
If oProfiles.Count = 0 Then
    MessageBox.Show("No closed profiles found.")
    Return
End If



Dim selectedProfile As Profile = oProfiles.Item(1)




Dim oExtrudeDef As ExtrudeDefinition
oExtrudeDef = oDef.Features.ExtrudeFeatures.CreateExtrudeDefinition( _
                selectedProfile, PartFeatureOperationEnum.kCutOperation)

oExtrudeDef.SetDistanceExtent(35, PartFeatureExtentDirectionEnum.kPositiveExtentDirection)

Dim oCut As ExtrudeFeature
oCut = oDef.Features.ExtrudeFeatures.Add(oExtrudeDef)
```

---

### 99. SelectionFilterEnum for holes

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/selectionfilterenum-for-holes/td-p/12017592](https://forums.autodesk.com/t5/inventor-programming-forum/selectionfilterenum-for-holes/td-p/12017592)

**Author:** waynehelley

**Date:** ‎06-07-2023
	
		
		07:23 AM

**Description:** Hello, Does anybody know if there is a SelectionFilterEnum option that will behave like the Hole creation tool. i.e. similar to 'kPartFaceFilter' but I also need to know the co-ordinates of where the the user clicked.  					 				 			 			 				 	Wayne HelleyInventor 2013 Certified ProfessionalAutodesk...

**Code Snippets (2):**

#### Code Block 1

```vb
Public Class ThisRule

    Sub Main()


        Dim selector As New Selector(ThisApplication)
        selector.Pick()

        Dim doc As PartDocument = ThisDoc.Document
        Dim def As PartComponentDefinition = doc.ComponentDefinition

        Dim sketch As PlanarSketch = def.Sketches.Add(selector.SelectedFace)

        Dim point2d As Point2d = sketch.ModelToSketchSpace(selector.ModelPosition)

        Dim circleRadius = 0.5 ' in Cm!
        sketch.SketchCircles.AddByCenterRadius(point2d, circleRadius)
        Dim profile = sketch.Profiles.AddForSolid()


        Dim exturdDef = def.Features.ExtrudeFeatures.CreateExtrudeDefinition(profile, PartFeatureOperationEnum.kCutOperation)
        exturdDef.SetDistanceExtent(10, PartFeatureExtentDirectionEnum.kSymmetricExtentDirection)
        def.Features.ExtrudeFeatures.Add(exturdDef)

    End Sub
End Class

Public Class Selector

    Private WithEvents _interactEvents As InteractionEvents
    Private WithEvents _selectEvents As SelectEvents
    Private _stillSelecting As Boolean
    Private _inventor As Inventor.Application

    Public Sub New(ThisApplication As Inventor.Application)
        _inventor = ThisApplication
    End Sub

    Public Sub Pick()
        _stillSelecting = True

        _interactEvents = _inventor.CommandManager.CreateInteractionEvents
        _interactEvents.InteractionDisabled = False
        _interactEvents.StatusBarText = "Select point on face."
        _interactEvents.SetCursor(CursorTypeEnum.kCursorBuiltInCrosshair)

        _selectEvents = _interactEvents.SelectEvents
        _selectEvents.WindowSelectEnabled = False

        _interactEvents.Start()
        Do While _stillSelecting
            _inventor.UserInterfaceManager.DoEvents()
        Loop
        _interactEvents.Stop()

        _inventor.CommandManager.StopActiveCommand()

    End Sub

    Public Property SelectedFace As Object = Nothing
    Public Property ModelPosition As Point = Nothing

    Private Sub oSelectEvents_OnPreSelect(
            ByRef PreSelectEntity As Object,
            ByRef DoHighlight As Boolean,
            ByRef MorePreSelectEntities As ObjectCollection,
            SelectionDevice As SelectionDeviceEnum,
            ModelPosition As Point,
            ViewPosition As Point2d,
            View As Inventor.View) Handles _selectEvents.OnPreSelect

        DoHighlight = False

        If (not TypeOf PreSelectEntity Is Face) Then Return

        Dim face As Face = PreSelectEntity

        If (face.SurfaceType <> SurfaceTypeEnum.kPlaneSurface) Then Return

        DoHighlight = True

    End Sub

    Private Sub oInteractEvents_OnTerminate() Handles _interactEvents.OnTerminate
        _stillSelecting = False
    End Sub

    Private Sub oSelectEvents_OnSelect(
            ByVal JustSelectedEntities As ObjectsEnumerator,
            ByVal SelectionDevice As SelectionDeviceEnum,
            ByVal ModelPosition As Point,
            ByVal ViewPosition As Point2d,
            ByVal View As Inventor.View) Handles _selectEvents.OnSelect

        SelectedFace = JustSelectedEntities.Item(1)
        Me.ModelPosition = ModelPosition


        _stillSelecting = False
    End Sub
End Class
```

#### Code Block 2

```vb
Public Class ThisRule

    Sub Main()


        Dim selector As New Selector(ThisApplication)
        selector.Pick()

        Dim doc As PartDocument = ThisDoc.Document
        Dim def As PartComponentDefinition = doc.ComponentDefinition

        Dim sketch As PlanarSketch = def.Sketches.Add(selector.SelectedFace)

        Dim point2d As Point2d = sketch.ModelToSketchSpace(selector.ModelPosition)

        Dim circleRadius = 0.5 ' in Cm!
        sketch.SketchCircles.AddByCenterRadius(point2d, circleRadius)
        Dim profile = sketch.Profiles.AddForSolid()


        Dim exturdDef = def.Features.ExtrudeFeatures.CreateExtrudeDefinition(profile, PartFeatureOperationEnum.kCutOperation)
        exturdDef.SetDistanceExtent(10, PartFeatureExtentDirectionEnum.kSymmetricExtentDirection)
        def.Features.ExtrudeFeatures.Add(exturdDef)

    End Sub
End Class

Public Class Selector

    Private WithEvents _interactEvents As InteractionEvents
    Private WithEvents _selectEvents As SelectEvents
    Private _stillSelecting As Boolean
    Private _inventor As Inventor.Application

    Public Sub New(ThisApplication As Inventor.Application)
        _inventor = ThisApplication
    End Sub

    Public Sub Pick()
        _stillSelecting = True

        _interactEvents = _inventor.CommandManager.CreateInteractionEvents
        _interactEvents.InteractionDisabled = False
        _interactEvents.StatusBarText = "Select point on face."
        _interactEvents.SetCursor(CursorTypeEnum.kCursorBuiltInCrosshair)

        _selectEvents = _interactEvents.SelectEvents
        _selectEvents.WindowSelectEnabled = False

        _interactEvents.Start()
        Do While _stillSelecting
            _inventor.UserInterfaceManager.DoEvents()
        Loop
        _interactEvents.Stop()

        _inventor.CommandManager.StopActiveCommand()

    End Sub

    Public Property SelectedFace As Object = Nothing
    Public Property ModelPosition As Point = Nothing

    Private Sub oSelectEvents_OnPreSelect(
            ByRef PreSelectEntity As Object,
            ByRef DoHighlight As Boolean,
            ByRef MorePreSelectEntities As ObjectCollection,
            SelectionDevice As SelectionDeviceEnum,
            ModelPosition As Point,
            ViewPosition As Point2d,
            View As Inventor.View) Handles _selectEvents.OnPreSelect

        DoHighlight = False

        If (not TypeOf PreSelectEntity Is Face) Then Return

        Dim face As Face = PreSelectEntity

        If (face.SurfaceType <> SurfaceTypeEnum.kPlaneSurface) Then Return

        DoHighlight = True

    End Sub

    Private Sub oInteractEvents_OnTerminate() Handles _interactEvents.OnTerminate
        _stillSelecting = False
    End Sub

    Private Sub oSelectEvents_OnSelect(
            ByVal JustSelectedEntities As ObjectsEnumerator,
            ByVal SelectionDevice As SelectionDeviceEnum,
            ByVal ModelPosition As Point,
            ByVal ViewPosition As Point2d,
            ByVal View As Inventor.View) Handles _selectEvents.OnSelect

        SelectedFace = JustSelectedEntities.Item(1)
        Me.ModelPosition = ModelPosition


        _stillSelecting = False
    End Sub
End Class
```

#### Code Block 3

```vb
Public Class ThisRule

    Sub Main()


        Dim selector As New Selector(ThisApplication)
        selector.Pick()

        Dim doc As PartDocument = ThisDoc.Document
        Dim def As PartComponentDefinition = doc.ComponentDefinition

        Dim sketch As PlanarSketch = def.Sketches.Add(selector.SelectedFace)

        Dim point2d As Point2d = sketch.ModelToSketchSpace(selector.ModelPosition)

        Dim circleRadius = 0.5 ' in Cm!
        sketch.SketchCircles.AddByCenterRadius(point2d, circleRadius)
        Dim profile = sketch.Profiles.AddForSolid()


        Dim exturdDef = def.Features.ExtrudeFeatures.CreateExtrudeDefinition(profile, PartFeatureOperationEnum.kCutOperation)
        exturdDef.SetDistanceExtent(10, PartFeatureExtentDirectionEnum.kSymmetricExtentDirection)
        def.Features.ExtrudeFeatures.Add(exturdDef)

    End Sub
End Class

Public Class Selector

    Private WithEvents _interactEvents As InteractionEvents
    Private WithEvents _selectEvents As SelectEvents
    Private _stillSelecting As Boolean
    Private _inventor As Inventor.Application

    Public Sub New(ThisApplication As Inventor.Application)
        _inventor = ThisApplication
    End Sub

    Public Sub Pick()
        _stillSelecting = True

        _interactEvents = _inventor.CommandManager.CreateInteractionEvents
        _interactEvents.InteractionDisabled = False
        _interactEvents.StatusBarText = "Select point on face."
        _interactEvents.SetCursor(CursorTypeEnum.kCursorBuiltInCrosshair)

        _selectEvents = _interactEvents.SelectEvents
        _selectEvents.WindowSelectEnabled = False

        _interactEvents.Start()
        Do While _stillSelecting
            _inventor.UserInterfaceManager.DoEvents()
        Loop
        _interactEvents.Stop()

        _inventor.CommandManager.StopActiveCommand()

    End Sub

    Public Property SelectedFace As Object = Nothing
    Public Property ModelPosition As Point = Nothing

    Private Sub oSelectEvents_OnPreSelect(
            ByRef PreSelectEntity As Object,
            ByRef DoHighlight As Boolean,
            ByRef MorePreSelectEntities As ObjectCollection,
            SelectionDevice As SelectionDeviceEnum,
            ModelPosition As Point,
            ViewPosition As Point2d,
            View As Inventor.View) Handles _selectEvents.OnPreSelect

        DoHighlight = False

        If (not TypeOf PreSelectEntity Is Face) Then Return

        Dim face As Face = PreSelectEntity

        If (face.SurfaceType <> SurfaceTypeEnum.kPlaneSurface) Then Return

        DoHighlight = True

    End Sub

    Private Sub oInteractEvents_OnTerminate() Handles _interactEvents.OnTerminate
        _stillSelecting = False
    End Sub

    Private Sub oSelectEvents_OnSelect(
            ByVal JustSelectedEntities As ObjectsEnumerator,
            ByVal SelectionDevice As SelectionDeviceEnum,
            ByVal ModelPosition As Point,
            ByVal ViewPosition As Point2d,
            ByVal View As Inventor.View) Handles _selectEvents.OnSelect

        SelectedFace = JustSelectedEntities.Item(1)
        Me.ModelPosition = ModelPosition


        _stillSelecting = False
    End Sub
End Class
```

#### Code Block 4

```vb
Public Class ThisRule

    Sub Main()


        Dim selector As New Selector(ThisApplication)
        selector.Pick()

        Dim doc As PartDocument = ThisDoc.Document
        Dim def As PartComponentDefinition = doc.ComponentDefinition

        Dim sketch As PlanarSketch = def.Sketches.Add(selector.SelectedFace)

        Dim point2d As Point2d = sketch.ModelToSketchSpace(selector.ModelPosition)

        Dim circleRadius = 0.5 ' in Cm!
        sketch.SketchCircles.AddByCenterRadius(point2d, circleRadius)
        Dim profile = sketch.Profiles.AddForSolid()


        Dim exturdDef = def.Features.ExtrudeFeatures.CreateExtrudeDefinition(profile, PartFeatureOperationEnum.kCutOperation)
        exturdDef.SetDistanceExtent(10, PartFeatureExtentDirectionEnum.kSymmetricExtentDirection)
        def.Features.ExtrudeFeatures.Add(exturdDef)

    End Sub
End Class

Public Class Selector

    Private WithEvents _interactEvents As InteractionEvents
    Private WithEvents _selectEvents As SelectEvents
    Private _stillSelecting As Boolean
    Private _inventor As Inventor.Application

    Public Sub New(ThisApplication As Inventor.Application)
        _inventor = ThisApplication
    End Sub

    Public Sub Pick()
        _stillSelecting = True

        _interactEvents = _inventor.CommandManager.CreateInteractionEvents
        _interactEvents.InteractionDisabled = False
        _interactEvents.StatusBarText = "Select point on face."
        _interactEvents.SetCursor(CursorTypeEnum.kCursorBuiltInCrosshair)

        _selectEvents = _interactEvents.SelectEvents
        _selectEvents.WindowSelectEnabled = False

        _interactEvents.Start()
        Do While _stillSelecting
            _inventor.UserInterfaceManager.DoEvents()
        Loop
        _interactEvents.Stop()

        _inventor.CommandManager.StopActiveCommand()

    End Sub

    Public Property SelectedFace As Object = Nothing
    Public Property ModelPosition As Point = Nothing

    Private Sub oSelectEvents_OnPreSelect(
            ByRef PreSelectEntity As Object,
            ByRef DoHighlight As Boolean,
            ByRef MorePreSelectEntities As ObjectCollection,
            SelectionDevice As SelectionDeviceEnum,
            ModelPosition As Point,
            ViewPosition As Point2d,
            View As Inventor.View) Handles _selectEvents.OnPreSelect

        DoHighlight = False

        If (not TypeOf PreSelectEntity Is Face) Then Return

        Dim face As Face = PreSelectEntity

        If (face.SurfaceType <> SurfaceTypeEnum.kPlaneSurface) Then Return

        DoHighlight = True

    End Sub

    Private Sub oInteractEvents_OnTerminate() Handles _interactEvents.OnTerminate
        _stillSelecting = False
    End Sub

    Private Sub oSelectEvents_OnSelect(
            ByVal JustSelectedEntities As ObjectsEnumerator,
            ByVal SelectionDevice As SelectionDeviceEnum,
            ByVal ModelPosition As Point,
            ByVal ViewPosition As Point2d,
            ByVal View As Inventor.View) Handles _selectEvents.OnSelect

        SelectedFace = JustSelectedEntities.Item(1)
        Me.ModelPosition = ModelPosition


        _stillSelecting = False
    End Sub
End Class
```

---

### 100. Set a component in an assembly with it's active view representation

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/set-a-component-in-an-assembly-with-it-s-active-view/td-p/13820679#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/set-a-component-in-an-assembly-with-it-s-active-view/td-p/13820679#messageview_0)

**Author:** gprimonBVPBY

**Date:** ‎09-22-2025
	
		
		06:37 AM

**Description:** Hello,I have a component with different view representations.I would like to write a rule in i logic  in the assembly file that read the active view representation of the part file and set the view representation of the component. Is that possible?Thank in advance for any help 					 				 			 			 			...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
If oADoc Is Nothing Then Return
For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
	If oOcc.Suppressed Then Continue For
	If TypeOf oOcc.Definition Is VirtualComponentDefinition Then Continue For
	If TypeOf oOcc.Definition Is WeldsComponentDefinition Then Continue For
	Dim sDVR As String = oOcc.Definition.RepresentationsManager.ActiveDesignViewRepresentation.Name
	oOcc.SetDesignViewRepresentation(sDVR,,True)
Next
oADoc.Update2(True)
```

#### Code Block 2

```vb
Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
If oADoc Is Nothing Then Return
For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
	If oOcc.Suppressed Then Continue For
	If TypeOf oOcc.Definition Is VirtualComponentDefinition Then Continue For
	If TypeOf oOcc.Definition Is WeldsComponentDefinition Then Continue For
	Dim sDVR As String = oOcc.Definition.RepresentationsManager.ActiveDesignViewRepresentation.Name
	oOcc.SetDesignViewRepresentation(sDVR,,True)
Next
oADoc.Update2(True)
```

#### Code Block 3

```vb
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument


Dim oOccurrences As ComponentOccurrences = oAsmDoc.ComponentDefinition.Occurrences

For Each oOccurrence As ComponentOccurrences In oOccurrences

	Dim oRepsMgr As Inventor.RepresentationsManager = oOccurrences.RepresentationsManager
	Dim sDVR As String = oRepsMgr.ActiveDesignViewRepresentation.Name
	oOccurrences.SetDesignViewRepresentation(sDVR,,True)
	
Next
```

#### Code Block 4

```vb
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument


Dim oOccurrences As ComponentOccurrences = oAsmDoc.ComponentDefinition.Occurrences

For Each oOccurrence As ComponentOccurrences In oOccurrences

	Dim oRepsMgr As Inventor.RepresentationsManager = oOccurrences.RepresentationsManager
	Dim sDVR As String = oRepsMgr.ActiveDesignViewRepresentation.Name
	oOccurrences.SetDesignViewRepresentation(sDVR,,True)
	
Next
```

#### Code Block 5

```vb
Dim oPickedOcc As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
If oPickedOcc Is Nothing Then Return
Dim oCD As Inventor.ComponentDefinition = oPickedOcc.Definition
Dim oRepsMgr As Inventor.RepresentationsManager = oCD.RepresentationsManager
Dim sDVR As String = oRepsMgr.ActiveDesignViewRepresentation.Name
oPickedOcc.SetDesignViewRepresentation(sDVR,,True)
```

#### Code Block 6

```vb
Dim oPickedOcc As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
If oPickedOcc Is Nothing Then Return
Dim oCD As Inventor.ComponentDefinition = oPickedOcc.Definition
Dim oRepsMgr As Inventor.RepresentationsManager = oCD.RepresentationsManager
Dim sDVR As String = oRepsMgr.ActiveDesignViewRepresentation.Name
oPickedOcc.SetDesignViewRepresentation(sDVR,,True)
```

---

### 101. SetIncludeStatus gives error

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/setincludestatus-gives-error/td-p/13830952](https://forums.autodesk.com/t5/inventor-programming-forum/setincludestatus-gives-error/td-p/13830952)

**Author:** Mehmet_Fatih_Turker

**Date:** ‎09-30-2025
	
		
		03:22 AM

**Description:** Hi all,Im trying to bring sketch that is not related to any feature to drawing view. Normally, we find model in related view then right click then apply "Get Model Sketches", is sketch isnot visible then come on the sketch, right click and apply "Include" and its there. Im trying to do that programm...

**Code Snippets (4):**

#### Code Block 1

```vb
For Each pl In pDef.WorkPlanes
                    If Not matchStr(pl.Name, featureName) Then Continue For
                    Dim px As WorkPlaneProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(pl, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next

                For Each ax In pDef.WorkAxes
                    If Not matchStr(ax.Name, featureName) Then Continue For
                    Dim px As WorkAxisProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(ax, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next
```

#### Code Block 2

```vb
For Each pl In pDef.WorkPlanes
                    If Not matchStr(pl.Name, featureName) Then Continue For
                    Dim px As WorkPlaneProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(pl, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next

                For Each ax In pDef.WorkAxes
                    If Not matchStr(ax.Name, featureName) Then Continue For
                    Dim px As WorkAxisProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(ax, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next
```

#### Code Block 3

```vb
For Each pl In pDef.WorkPlanes
                    If Not matchStr(pl.Name, featureName) Then Continue For
                    Dim px As WorkPlaneProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(pl, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next

                For Each ax In pDef.WorkAxes
                    If Not matchStr(ax.Name, featureName) Then Continue For
                    Dim px As WorkAxisProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(ax, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next
```

#### Code Block 4

```vb
For Each pl In pDef.WorkPlanes
                    If Not matchStr(pl.Name, featureName) Then Continue For
                    Dim px As WorkPlaneProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(pl, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next

                For Each ax In pDef.WorkAxes
                    If Not matchStr(ax.Name, featureName) Then Continue For
                    Dim px As WorkAxisProxy = Nothing
                    Try
                        occ.CreateGeometryProxy(ax, px)
                        view.SetIncludeStatus(px, include)
                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next
```

#### Code Block 5

```vb
For Each sk As Sketch In pDef.Sketches
                    If Not matchStr(sk.Name, featureName) Then Continue For
                    Dim px As PlanarSketchProxy = Nothing
                    Try

                        occ.CreateGeometryProxy(sk, px)

                        view.SetIncludeStatus(px, include)
                        view.SetVisibility(px, include)

                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next
```

#### Code Block 6

```vb
For Each sk As Sketch In pDef.Sketches
                    If Not matchStr(sk.Name, featureName) Then Continue For
                    Dim px As PlanarSketchProxy = Nothing
                    Try

                        occ.CreateGeometryProxy(sk, px)

                        view.SetIncludeStatus(px, include)
                        view.SetVisibility(px, include)

                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next
```

#### Code Block 7

```vb
For Each sk As Sketch In pDef.Sketches
                    If Not matchStr(sk.Name, featureName) Then Continue For
                    Dim px As PlanarSketchProxy = Nothing
                    Try

                        occ.CreateGeometryProxy(sk, px)

                        view.SetIncludeStatus(px, include)
                        view.SetVisibility(px, include)

                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next
```

#### Code Block 8

```vb
For Each sk As Sketch In pDef.Sketches
                    If Not matchStr(sk.Name, featureName) Then Continue For
                    Dim px As PlanarSketchProxy = Nothing
                    Try

                        occ.CreateGeometryProxy(sk, px)

                        view.SetIncludeStatus(px, include)
                        view.SetVisibility(px, include)

                        Return sheet.CreateGeometryIntent(px)
                    Catch ex As Exception
                        MessageBox.Show(" hata: " & ex.Message, "Hata", MessageBoxButtons.OK, MessageBoxIcon.Error)
                    End Try
                Next
```

---

### 102. Sheet metal cut feature affected bodies

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/sheet-metal-cut-feature-affected-bodies/td-p/13843101](https://forums.autodesk.com/t5/inventor-programming-forum/sheet-metal-cut-feature-affected-bodies/td-p/13843101)

**Author:** jeroen_HFG

**Date:** ‎10-08-2025
	
		
		02:32 AM

**Description:** I have a multi body part and i want to create holes using the cut feature so i can use Cut Normal.Below is part of my code.The problem is it always uses the first body and i cannot change or add another body.I can change it manually and it works but not with ilogic.The sketch is on a plane that has ...

**Code Snippets (4):**

#### Code Block 1

```vb
' --- CUT FEATURE ---
	Dim oPart As PartDocument = ThisApplication.ActiveDocument
	Dim oDef As SheetMetalComponentDefinition = oPart.ComponentDefinition
	
	Dim oSMFeatures As SheetMetalFeatures = oDef.Features
	
	' --- Create cut definition ---
	Dim oCutDef As CutDefinition = oSMFeatures.CutFeatures.CreateCutDefinition(oSketch.Profiles.AddForSolid())
	
	' --- Set cut distance using the Distance variable from Excel ---
	oCutDef.SetDistanceExtent(Distance, PartFeatureExtentDirectionEnum.kNegativeExtentDirection)
	oCutDef.CutNormalToFlat = True
	
	' --- Add the cut ---
	Dim oCut As CutFeature = oSMFeatures.CutFeatures.Add(oCutDef)
	oCut.Name = "Cut_" & PointName
```

#### Code Block 2

```vb
' --- CUT FEATURE ---
	Dim oPart As PartDocument = ThisApplication.ActiveDocument
	Dim oDef As SheetMetalComponentDefinition = oPart.ComponentDefinition
	
	Dim oSMFeatures As SheetMetalFeatures = oDef.Features
	
	' --- Create cut definition ---
	Dim oCutDef As CutDefinition = oSMFeatures.CutFeatures.CreateCutDefinition(oSketch.Profiles.AddForSolid())
	
	' --- Set cut distance using the Distance variable from Excel ---
	oCutDef.SetDistanceExtent(Distance, PartFeatureExtentDirectionEnum.kNegativeExtentDirection)
	oCutDef.CutNormalToFlat = True
	
	' --- Add the cut ---
	Dim oCut As CutFeature = oSMFeatures.CutFeatures.Add(oCutDef)
	oCut.Name = "Cut_" & PointName
```

#### Code Block 3

```vb
' =====================================
' 🔧 USER SETTINGS
' =====================================
Dim FilePath As String = "Template.xlsx"
Dim SheetName As String = "Sheet1"

Dim oPart As PartDocument = ThisApplication.ActiveDocument
Dim oDef As SheetMetalComponentDefinition = oPart.ComponentDefinition
Dim oTG As TransientGeometry = ThisApplication.TransientGeometry
oPart.Activate()

' --- Read how many rows to process ---
Dim RowCount As Integer = CInt(GoExcel.CellValue(FilePath, SheetName, "B2"))

' --- Pre-cleanup: remove extra WorkPoints, sketches, planes ---
For Each wp As WorkPoint In oDef.WorkPoints
    If wp.Name.Contains("NP_") Then wp.Delete()
Next
For Each sk As PlanarSketch In oDef.Sketches
    If sk.Name.Contains("Sketch_NP_") Then sk.Delete()
Next
For Each wp As WorkPlane In oDef.WorkPlanes
    If wp.Name.Contains("Plane_NP_") Then wp.Delete()
Next

' =====================================
' --- LOOP ---
' =====================================
For i As Integer = 5 To 5 + RowCount - 1
    ' --- Read Excel values ---
    Dim PointName As String = "NP_" & GoExcel.CellValue(FilePath, SheetName, "A" & i)
    Dim Y As Double = -CDbl(GoExcel.CellValue(FilePath, SheetName, "B" & i)) / 10
    Dim Distance As Double = CDbl(GoExcel.CellValue(FilePath, SheetName, "C" & i)) / 10
    Dim AngleDeg As Double = CDbl(GoExcel.CellValue(FilePath, SheetName, "D" & i)) - 90
    Dim Diameter As Double = CDbl(GoExcel.CellValue(FilePath, SheetName, "E" & i)) / 10

    Dim AngleRad As Double = AngleDeg * Math.PI / 180
    Dim X As Double = Distance * Math.Cos(AngleRad)
    Dim Z As Double = Distance * Math.Sin(AngleRad)

    ' --- Delete existing points ---
    For Each wp As WorkPoint In oDef.WorkPoints
        If wp.Name = PointName Or wp.Name = PointName & "_direction" Then wp.Delete()
    Next

    ' --- Create points ---
    Dim oMainPoint As WorkPoint = oDef.WorkPoints.AddFixed(oTG.CreatePoint(X, Y, Z))
    oMainPoint.Name = PointName
    oMainPoint.Visible = True

    Dim oDirPoint As WorkPoint = oDef.WorkPoints.AddFixed(oTG.CreatePoint(0, Y, 0))
    oDirPoint.Name = PointName & "_direction"
    oDirPoint.Visible = True

    ' --- Create axis ---
    Dim AxisName As String = "Axis_" & PointName
    For Each ax As WorkAxis In oDef.WorkAxes
        If ax.Name = AxisName Then ax.Delete()
    Next
    Dim oAxis As WorkAxis = oDef.WorkAxes.AddByTwoPoints(oDirPoint, oMainPoint)
    oAxis.Name = AxisName
    oAxis.Visible = False

    ' --- Create plane ---
    Dim PlaneName As String = "Plane_" & PointName
    For Each wp As WorkPlane In oDef.WorkPlanes
        If wp.Name = PlaneName Then wp.Delete()
    Next
    Dim oPlane As WorkPlane = oDef.WorkPlanes.AddByNormalToCurve(oAxis, oMainPoint)
    oPlane.Name = PlaneName
    oPlane.Visible = True

    ' --- Create sketch ---
    Dim SketchName As String = "Sketch_" & PointName
    For Each sk As PlanarSketch In oDef.Sketches
        If sk.Name = SketchName Then sk.Delete()
    Next
    Dim oSketch As PlanarSketch = oDef.Sketches.Add(oPlane)
    oSketch.Name = SketchName

    ' --- Circle ---
    Dim oSketchPoint As SketchPoint = oSketch.AddByProjectingEntity(oMainPoint)
    Dim oCircle As SketchCircle = oSketch.SketchCircles.AddByCenterRadius(oSketchPoint, Diameter / 2)
    Try
        oSketch.GeometricConstraints.AddCoincident(oCircle.CenterSketchPoint, oSketchPoint)
    Catch
    End Try

    ' --- Add diameter dimension (optional)
    Dim textPt As Point2d = oTG.CreatePoint2d(Diameter + 5, 0)
    oSketch.DimensionConstraints.AddDiameter(oCircle, textPt)

	' --- CUT FEATURE ---
	Dim oSMFeatures As SheetMetalFeatures = oDef.Features
	
	' --- Create cut definition ---
	Dim oCutDef As CutDefinition = oSMFeatures.CutFeatures.CreateCutDefinition(oSketch.Profiles.AddForSolid())
	
	' --- Set cut distance using the Distance variable from Excel ---
	oCutDef.SetDistanceExtent(Distance, PartFeatureExtentDirectionEnum.kNegativeExtentDirection)
	oCutDef.CutNormalToFlat = True
	
	' --- Add the cut ---
	Dim oCut As CutFeature = oSMFeatures.CutFeatures.Add(oCutDef)
	oCut.Name = "Cut_" & PointName
Next
```

#### Code Block 4

```vb
' =====================================
' 🔧 USER SETTINGS
' =====================================
Dim FilePath As String = "Template.xlsx"
Dim SheetName As String = "Sheet1"

Dim oPart As PartDocument = ThisApplication.ActiveDocument
Dim oDef As SheetMetalComponentDefinition = oPart.ComponentDefinition
Dim oTG As TransientGeometry = ThisApplication.TransientGeometry
oPart.Activate()

' --- Read how many rows to process ---
Dim RowCount As Integer = CInt(GoExcel.CellValue(FilePath, SheetName, "B2"))

' --- Pre-cleanup: remove extra WorkPoints, sketches, planes ---
For Each wp As WorkPoint In oDef.WorkPoints
    If wp.Name.Contains("NP_") Then wp.Delete()
Next
For Each sk As PlanarSketch In oDef.Sketches
    If sk.Name.Contains("Sketch_NP_") Then sk.Delete()
Next
For Each wp As WorkPlane In oDef.WorkPlanes
    If wp.Name.Contains("Plane_NP_") Then wp.Delete()
Next

' =====================================
' --- LOOP ---
' =====================================
For i As Integer = 5 To 5 + RowCount - 1
    ' --- Read Excel values ---
    Dim PointName As String = "NP_" & GoExcel.CellValue(FilePath, SheetName, "A" & i)
    Dim Y As Double = -CDbl(GoExcel.CellValue(FilePath, SheetName, "B" & i)) / 10
    Dim Distance As Double = CDbl(GoExcel.CellValue(FilePath, SheetName, "C" & i)) / 10
    Dim AngleDeg As Double = CDbl(GoExcel.CellValue(FilePath, SheetName, "D" & i)) - 90
    Dim Diameter As Double = CDbl(GoExcel.CellValue(FilePath, SheetName, "E" & i)) / 10

    Dim AngleRad As Double = AngleDeg * Math.PI / 180
    Dim X As Double = Distance * Math.Cos(AngleRad)
    Dim Z As Double = Distance * Math.Sin(AngleRad)

    ' --- Delete existing points ---
    For Each wp As WorkPoint In oDef.WorkPoints
        If wp.Name = PointName Or wp.Name = PointName & "_direction" Then wp.Delete()
    Next

    ' --- Create points ---
    Dim oMainPoint As WorkPoint = oDef.WorkPoints.AddFixed(oTG.CreatePoint(X, Y, Z))
    oMainPoint.Name = PointName
    oMainPoint.Visible = True

    Dim oDirPoint As WorkPoint = oDef.WorkPoints.AddFixed(oTG.CreatePoint(0, Y, 0))
    oDirPoint.Name = PointName & "_direction"
    oDirPoint.Visible = True

    ' --- Create axis ---
    Dim AxisName As String = "Axis_" & PointName
    For Each ax As WorkAxis In oDef.WorkAxes
        If ax.Name = AxisName Then ax.Delete()
    Next
    Dim oAxis As WorkAxis = oDef.WorkAxes.AddByTwoPoints(oDirPoint, oMainPoint)
    oAxis.Name = AxisName
    oAxis.Visible = False

    ' --- Create plane ---
    Dim PlaneName As String = "Plane_" & PointName
    For Each wp As WorkPlane In oDef.WorkPlanes
        If wp.Name = PlaneName Then wp.Delete()
    Next
    Dim oPlane As WorkPlane = oDef.WorkPlanes.AddByNormalToCurve(oAxis, oMainPoint)
    oPlane.Name = PlaneName
    oPlane.Visible = True

    ' --- Create sketch ---
    Dim SketchName As String = "Sketch_" & PointName
    For Each sk As PlanarSketch In oDef.Sketches
        If sk.Name = SketchName Then sk.Delete()
    Next
    Dim oSketch As PlanarSketch = oDef.Sketches.Add(oPlane)
    oSketch.Name = SketchName

    ' --- Circle ---
    Dim oSketchPoint As SketchPoint = oSketch.AddByProjectingEntity(oMainPoint)
    Dim oCircle As SketchCircle = oSketch.SketchCircles.AddByCenterRadius(oSketchPoint, Diameter / 2)
    Try
        oSketch.GeometricConstraints.AddCoincident(oCircle.CenterSketchPoint, oSketchPoint)
    Catch
    End Try

    ' --- Add diameter dimension (optional)
    Dim textPt As Point2d = oTG.CreatePoint2d(Diameter + 5, 0)
    oSketch.DimensionConstraints.AddDiameter(oCircle, textPt)

	' --- CUT FEATURE ---
	Dim oSMFeatures As SheetMetalFeatures = oDef.Features
	
	' --- Create cut definition ---
	Dim oCutDef As CutDefinition = oSMFeatures.CutFeatures.CreateCutDefinition(oSketch.Profiles.AddForSolid())
	
	' --- Set cut distance using the Distance variable from Excel ---
	oCutDef.SetDistanceExtent(Distance, PartFeatureExtentDirectionEnum.kNegativeExtentDirection)
	oCutDef.CutNormalToFlat = True
	
	' --- Add the cut ---
	Dim oCut As CutFeature = oSMFeatures.CutFeatures.Add(oCutDef)
	oCut.Name = "Cut_" & PointName
Next
```

---

### 103. Sketch symbol &amp; Table creation for QC Inspection

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/sketch-symbol-amp-table-creation-for-qc-inspection/td-p/13788076](https://forums.autodesk.com/t5/inventor-programming-forum/sketch-symbol-amp-table-creation-for-qc-inspection/td-p/13788076)

**Author:** b_pasupathy2000salem

**Date:** ‎08-28-2025
	
		
		10:25 PM

**Description:** Hi Guys, I'm working on some automation tool for QC Inspection, basically it's purpose was place a symbol with counter to all dimensions and extract these dimensions to table. Now i complete the first step which is place a symbol on dimensions and i struggle with table creation. please anyone guide ...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim oSkSybl As SketchedSymbol = ThisApplication.CommandManager.Pick( _
SelectionFilterEnum.kDrawingSketchedSymbolFilter, "Select a SketchedSymbol to inspect.")
If oSkSybl Is Nothing Then Return
Dim oLeader As Inventor.Leader = oSkSybl.Leader
If oLeader.HasRootNode Then
	Dim oRNode As LeaderNode = oLeader.RootNode
	Dim oNodes As LeaderNodesEnumerator = oLeader.AllNodes
	For Each oNode As LeaderNode In oNodes
		If oNode.AttachedEntity Is Nothing Then Continue For
		Dim oGI As Inventor.GeometryIntent = oNode.AttachedEntity
		Dim oGeom As Object = Nothing : Try : oGeom = oGI.Geometry : Catch : End Try
		If oGeom Is Nothing Then Continue For
		MsgBox("TypeName(oGeom) = " & TypeName(oGeom),,"")
		If TypeOf oGeom Is DrawingDimension Then
			Dim oDDim As DrawingDimension = oGeom
			MsgBox(oDDim.Text.Text,,"")
		End If
	Next 'oNode
End If
```

#### Code Block 2

```vb
Dim oSkSybl As SketchedSymbol = ThisApplication.CommandManager.Pick( _
SelectionFilterEnum.kDrawingSketchedSymbolFilter, "Select a SketchedSymbol to inspect.")
If oSkSybl Is Nothing Then Return
Dim oLeader As Inventor.Leader = oSkSybl.Leader
If oLeader.HasRootNode Then
	Dim oRNode As LeaderNode = oLeader.RootNode
	Dim oNodes As LeaderNodesEnumerator = oLeader.AllNodes
	For Each oNode As LeaderNode In oNodes
		If oNode.AttachedEntity Is Nothing Then Continue For
		Dim oGI As Inventor.GeometryIntent = oNode.AttachedEntity
		Dim oGeom As Object = Nothing : Try : oGeom = oGI.Geometry : Catch : End Try
		If oGeom Is Nothing Then Continue For
		MsgBox("TypeName(oGeom) = " & TypeName(oGeom),,"")
		If TypeOf oGeom Is DrawingDimension Then
			Dim oDDim As DrawingDimension = oGeom
			MsgBox(oDDim.Text.Text,,"")
		End If
	Next 'oNode
End If
```

#### Code Block 3

```vb
Dim oSkSybl As SketchedSymbol = ThisApplication.CommandManager.Pick( _
SelectionFilterEnum.kDrawingSketchedSymbolFilter, "Select a SketchedSymbol to inspect.")
If oSkSybl Is Nothing Then Return
Dim oLeader As Inventor.Leader = oSkSybl.Leader
If oLeader.HasRootNode Then
	Dim oRNode As LeaderNode = oLeader.RootNode
	Dim oNodes As LeaderNodesEnumerator = oLeader.AllNodes
	For Each oNode As LeaderNode In oNodes
		If oNode.AttachedEntity Is Nothing Then Continue For
		Dim oGI As Inventor.GeometryIntent = oNode.AttachedEntity
		Dim oGeom As Object = Nothing : Try : oGeom = oGI.Geometry : Catch : End Try
		If oGeom Is Nothing Then Continue For
		MsgBox("TypeName(oGeom) = " & TypeName(oGeom),,"")
		If TypeOf oGeom Is DrawingDimension Then
			Dim oDDim As DrawingDimension = oGeom
			MsgBox(oDDim.Text.Text,,"")
		End If
	Next 'oNode
End If
```

#### Code Block 4

```vb
Dim oSkSybl As SketchedSymbol = ThisApplication.CommandManager.Pick( _
SelectionFilterEnum.kDrawingSketchedSymbolFilter, "Select a SketchedSymbol to inspect.")
If oSkSybl Is Nothing Then Return
Dim oLeader As Inventor.Leader = oSkSybl.Leader
If oLeader.HasRootNode Then
	Dim oRNode As LeaderNode = oLeader.RootNode
	Dim oNodes As LeaderNodesEnumerator = oLeader.AllNodes
	For Each oNode As LeaderNode In oNodes
		If oNode.AttachedEntity Is Nothing Then Continue For
		Dim oGI As Inventor.GeometryIntent = oNode.AttachedEntity
		Dim oGeom As Object = Nothing : Try : oGeom = oGI.Geometry : Catch : End Try
		If oGeom Is Nothing Then Continue For
		MsgBox("TypeName(oGeom) = " & TypeName(oGeom),,"")
		If TypeOf oGeom Is DrawingDimension Then
			Dim oDDim As DrawingDimension = oGeom
			MsgBox(oDDim.Text.Text,,"")
		End If
	Next 'oNode
End If
```

#### Code Block 5

```vb
Sub Main()
    Dim oDoc As DrawingDocument = ThisDoc.Document
    Dim oSymDef As SketchedSymbolDefinition

    Try
        oSymDef = oDoc.SketchedSymbolDefinitions.Item("Your Sketched Symbol Name")
    Catch ex As Exception
        MsgBox("Sketch Symbol not found: " & ex.Message)
        Exit Sub
    End Try

    Dim counter As Integer = 1
    Dim offsetX As Double = 0.5
    Dim offsetY As Double = 0.2
    Dim oTG As TransientGeometry = ThisApplication.TransientGeometry

    Dim oSheet As Sheet
    For Each oSheet In oDoc.Sheets
        Dim oDims As GeneralDimensions = oSheet.DrawingDimensions.GeneralDimensions

        For Each oDim As GeneralDimension In oDims
            Dim dimPt As Point2d = oDim.Text.Origin

            Dim symPt As Point2d = oTG.CreatePoint2d(dimPt.X + offsetX, dimPt.Y + offsetY)

            Dim oLeaderPoints As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection()
            oLeaderPoints.Add(symPt)
            oLeaderPoints.Add(dimPt)

            Dim promptValues(0) As String
            promptValues(0) = counter.ToString()

            Try
                Dim oSketchedSymbol As SketchedSymbol = oSheet.SketchedSymbols.AddWithLeader(oSymDef, oLeaderPoints, 0, 1, promptValues)
                oSketchedSymbol.Static = True
                oSketchedSymbol.LeaderVisible = False
            Catch ex As Exception
                MsgBox("Error placing symbol " & counter & ": " & ex.Message)
            End Try

            counter += 1
        Next
    Next
End Sub
```

#### Code Block 6

```vb
Sub Main()
    Dim oDoc As DrawingDocument = ThisDoc.Document
    Dim oSymDef As SketchedSymbolDefinition

    Try
        oSymDef = oDoc.SketchedSymbolDefinitions.Item("Your Sketched Symbol Name")
    Catch ex As Exception
        MsgBox("Sketch Symbol not found: " & ex.Message)
        Exit Sub
    End Try

    Dim counter As Integer = 1
    Dim offsetX As Double = 0.5
    Dim offsetY As Double = 0.2
    Dim oTG As TransientGeometry = ThisApplication.TransientGeometry

    Dim oSheet As Sheet
    For Each oSheet In oDoc.Sheets
        Dim oDims As GeneralDimensions = oSheet.DrawingDimensions.GeneralDimensions

        For Each oDim As GeneralDimension In oDims
            Dim dimPt As Point2d = oDim.Text.Origin

            Dim symPt As Point2d = oTG.CreatePoint2d(dimPt.X + offsetX, dimPt.Y + offsetY)

            Dim oLeaderPoints As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection()
            oLeaderPoints.Add(symPt)
            oLeaderPoints.Add(dimPt)

            Dim promptValues(0) As String
            promptValues(0) = counter.ToString()

            Try
                Dim oSketchedSymbol As SketchedSymbol = oSheet.SketchedSymbols.AddWithLeader(oSymDef, oLeaderPoints, 0, 1, promptValues)
                oSketchedSymbol.Static = True
                oSketchedSymbol.LeaderVisible = False
            Catch ex As Exception
                MsgBox("Error placing symbol " & counter & ": " & ex.Message)
            End Try

            counter += 1
        Next
    Next
End Sub
```

---

### 104. Sketched Symbol

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/sketched-symbol/td-p/13813702#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/sketched-symbol/td-p/13813702#messageview_0)

**Author:** dineshkumar_arumugamYY6PL

**Date:** ‎09-16-2025
	
		
		08:30 PM

**Description:** Sub Main() AddOrInsertPromptedSymbol() InsertSymbolsNextToDimensions() End Sub  Sub AddOrInsertPromptedSymbol() Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument Dim symbolName As String = "My Symbol" Dim found As Boolean = False  ' Check if symbol definition already exists For Each oSymb...

**Code Snippets (1):**

#### Code Block 1

```vb
Sub Main()
AddOrInsertPromptedSymbol()
InsertSymbolsNextToDimensions()
End Sub

Sub AddOrInsertPromptedSymbol()
Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
Dim symbolName As String = "My Symbol"
Dim found As Boolean = False

' Check if symbol definition already exists
For Each oSymbolDef As SketchedSymbolDefinition In oDoc.SketchedSymbolDefinitions
If oSymbolDef.Name = symbolName Then
found = True
Exit For
End If
Next

If found Then Return

' Create the sketched symbol definition
Dim oSymbolDefNew As SketchedSymbolDefinition = oDoc.SketchedSymbolDefinitions.Add(symbolName)
Dim oSketch As DrawingSketch = Nothing
oSymbolDefNew.Edit(oSketch)

' Draw a circle and add prompted text box in the symbol sketch
Dim oCenter As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(12, 12)
oSketch.SketchCircles.AddByCenterRadius(oCenter, 0.25)
Dim promptPlaceholder As String = "<Prompt>Enter Text</Prompt>"
Dim oTextBox As TextBox = oSketch.TextBoxes.AddFitted(oCenter, promptPlaceholder)

oSymbolDefNew.ExitEdit(True)

' Do NOT insert the symbol instance here to avoid error on first run
End Sub

Sub InsertSymbolsNextToDimensions()
Dim oDoc As DrawingDocument = ThisDoc.Document
Dim oSymDef As SketchedSymbolDefinition

' Get the "BA" sketched symbol definition
Try
oSymDef = oDoc.SketchedSymbolDefinitions.Item("My Symbol")
Catch ex As Exception
MsgBox("Sketch Symbol 'BA' not found: " & ex.Message)
Exit Sub
End Try

Dim counter As Integer = 1
Dim offsetX As Double = 0.5
Dim offsetY As Double = 0.2
Dim oTG As TransientGeometry = ThisApplication.TransientGeometry

For Each oSheet As Sheet In oDoc.Sheets
Dim oDims As GeneralDimensions = oSheet.DrawingDimensions.GeneralDimensions
For Each oDim As GeneralDimension In oDims
Dim dimPt As Point2d = oDim.Text.Origin
Dim symPt As Point2d = oTG.CreatePoint2d(dimPt.X + offsetX, dimPt.Y + offsetY)
Dim oLeaderPoints As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection()

' Create geometry intent at the dimension location
Dim oIntent As GeometryIntent = oSheet.CreateGeometryIntent(oDim, dimPt)
oLeaderPoints.Add(symPt)
oLeaderPoints.Add(oIntent)

Dim promptValues(0) As String
promptValues(0) = counter.ToString()

Try
Dim oSketchedSymbol As SketchedSymbol = oSheet.SketchedSymbols.AddWithLeader(oSymDef, oLeaderPoints, 0, 1, promptValues)
oSketchedSymbol.Static = True
oSketchedSymbol.LeaderVisible = False
Catch ex As Exception
MsgBox("Error placing symbol " & counter & ": " & ex.Message)
End Try

counter += 1
Next
Next
End Sub
```

---

### 105. Suppress/make invisible weldment features with iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/suppress-make-invisible-weldment-features-with-ilogic/td-p/13826974](https://forums.autodesk.com/t5/inventor-programming-forum/suppress-make-invisible-weldment-features-with-ilogic/td-p/13826974)

**Author:** relicseekerharry

**Date:** ‎09-26-2025
	
		
		06:08 AM

**Description:** I am writing an iLogic rule for a configurator that enables/disables welded bosses based on certain criteria. Suppressing the bosses is simple, but their welds persist and look out of place. Attached is some sample iLogic that fails (the .Suppressed property has the same effect). It is my understand...

**Code Snippets (6):**

#### Code Block 1

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
Dim oWeldDef As WeldmentComponentDefinition = oDoc.ComponentDefinition

oWeldDef.Welds.Item("Weld 1").Visible = True
oWeldDef.Welds.Item("Weld 2").Visible = False
```

#### Code Block 2

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
Dim oWeldDef As WeldmentComponentDefinition = oDoc.ComponentDefinition

oWeldDef.Welds.Item("Weld 1").Visible = True
oWeldDef.Welds.Item("Weld 2").Visible = False
```

#### Code Block 3

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
Dim oWeldDef As WeldmentComponentDefinition = oDoc.ComponentDefinition

oWeldDef.Welds.Item("Weld 1").Visible = True
oWeldDef.Welds.Item("Weld 2").Visible = False
```

#### Code Block 4

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
Dim oWeldDef As WeldmentComponentDefinition = oDoc.ComponentDefinition

oWeldDef.Welds.Item("Weld 1").Visible = True
oWeldDef.Welds.Item("Weld 2").Visible = False
```

#### Code Block 5

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
Dim oWeldDef As WeldmentComponentDefinition = oDoc.ComponentDefinition

oWeldDef.Welds.Item("Weld 1").Visible = True
oWeldDef.Welds.Item("Weld 2").Visible = False
```

#### Code Block 6

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
Dim oWeldDef As WeldmentComponentDefinition = oDoc.ComponentDefinition

oWeldDef.Welds.Item("Weld 1").Visible = True
oWeldDef.Welds.Item("Weld 2").Visible = False
```

#### Code Block 7

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
For Each oOccurrence As ComponentOccurrence In oDoc.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			If (oSubOcc.Name.Contains("Tray Weld")) Then
				oSubOcc.Visible = False
			End If
		Next
	End If
Next
```

#### Code Block 8

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
For Each oOccurrence As ComponentOccurrence In oDoc.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			If (oSubOcc.Name.Contains("Tray Weld")) Then
				oSubOcc.Visible = False
			End If
		Next
	End If
Next
```

#### Code Block 9

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
For Each oOccurrence As ComponentOccurrence In oDoc.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			If (oSubOcc.Name.Contains("Tray Weld")) Then
				oSubOcc.Visible = False
			End If
		Next
	End If
Next
```

#### Code Block 10

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
For Each oOccurrence As ComponentOccurrence In oDoc.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			If (oSubOcc.Name.Contains("Tray Weld")) Then
				oSubOcc.Visible = False
			End If
		Next
	End If
Next
```

#### Code Block 11

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
For Each oOccurrence As ComponentOccurrence In oDoc.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			If (oSubOcc.Name.Contains("Tray Weld")) Then
				oSubOcc.Visible = False
			End If
		Next
	End If
Next
```

#### Code Block 12

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
For Each oOccurrence As ComponentOccurrence In oDoc.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			If (oSubOcc.Name.Contains("Tray Weld")) Then
				oSubOcc.Visible = False
			End If
		Next
	End If
Next
```

#### Code Block 13

```vb
For Each oOccurrence As ComponentOccurrence In oAssy.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			oSubOcc.Visible = False
		Next
	End If
Next
```

#### Code Block 14

```vb
For Each oOccurrence As ComponentOccurrence In oAssy.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			oSubOcc.Visible = False
		Next
	End If
Next
```

#### Code Block 15

```vb
For Each oOccurrence As ComponentOccurrence In oAssy.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			oSubOcc.Visible = False
		Next
	End If
Next
```

#### Code Block 16

```vb
For Each oOccurrence As ComponentOccurrence In oAssy.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			oSubOcc.Visible = False
		Next
	End If
Next
```

#### Code Block 17

```vb
For Each oOccurrence As ComponentOccurrence In oAssy.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			oSubOcc.Visible = False
		Next
	End If
Next
```

#### Code Block 18

```vb
For Each oOccurrence As ComponentOccurrence In oAssy.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			oSubOcc.Visible = False
		Next
	End If
Next
```

---

### 106. SurfaceBody Appearance Override ignored?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/surfacebody-appearance-override-ignored/td-p/13803468#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/surfacebody-appearance-override-ignored/td-p/13803468#messageview_0)

**Author:** c_hoppen

**Date:** ‎09-09-2025
	
		
		10:26 AM

**Description:** As a preview, I want to copy the surface bodies of all the assembly components into the ClientGraphics and make the components invisible.This works fine, but all surface bodies appear dark grey. It looks like the appearance setting is being ignored.Here is the code:                foreach ((string N...

**Code Snippets (8):**

#### Code Block 1

```vb
' Assign a color to the node using an existing appearance asset.
Dim oAppearance As Asset = oDoc.AppearanceAssets(1)
oLineNode.Appearance = oAppearance
```

#### Code Block 2

```vb
' Assign a color to the node using an existing appearance asset.
Dim oAppearance As Asset = oDoc.AppearanceAssets(1)
oLineNode.Appearance = oAppearance
```

#### Code Block 3

```vb
' Assign a color to the node using an existing appearance asset.
Dim oAppearance As Asset = oDoc.AppearanceAssets(1)
oLineNode.Appearance = oAppearance
```

#### Code Block 4

```vb
' Assign a color to the node using an existing appearance asset.
Dim oAppearance As Asset = oDoc.AppearanceAssets(1)
oLineNode.Appearance = oAppearance
```

#### Code Block 5

```vb
' copy to Transient BRep
Dim transBrep As TransientBRep = ThisApplication.TransientBRep
Dim body1 As SurfaceBody =  transBrep.Copy(part1.Definition.SurfaceBodies.Item(1))
Dim body2 As SurfaceBody =  transBrep.Copy(part2.Definition.SurfaceBodies.Item(1))

' Transform the bodies (NOT THE GRAPHICS NODE!) to be in the location represented in the assembly.
Call transBrep.Transform(body1, part1.Transformation)
Call transBrep.Transform(body2, part2.Transformation)
```

#### Code Block 6

```vb
' copy to Transient BRep
Dim transBrep As TransientBRep = ThisApplication.TransientBRep
Dim body1 As SurfaceBody =  transBrep.Copy(part1.Definition.SurfaceBodies.Item(1))
Dim body2 As SurfaceBody =  transBrep.Copy(part2.Definition.SurfaceBodies.Item(1))

' Transform the bodies (NOT THE GRAPHICS NODE!) to be in the location represented in the assembly.
Call transBrep.Transform(body1, part1.Transformation)
Call transBrep.Transform(body2, part2.Transformation)
```

#### Code Block 7

```vb
' copy to Transient BRep
Dim transBrep As TransientBRep = ThisApplication.TransientBRep
Dim body1 As SurfaceBody =  transBrep.Copy(part1.Definition.SurfaceBodies.Item(1))
Dim body2 As SurfaceBody =  transBrep.Copy(part2.Definition.SurfaceBodies.Item(1))

' Transform the bodies (NOT THE GRAPHICS NODE!) to be in the location represented in the assembly.
Call transBrep.Transform(body1, part1.Transformation)
Call transBrep.Transform(body2, part2.Transformation)
```

#### Code Block 8

```vb
' copy to Transient BRep
Dim transBrep As TransientBRep = ThisApplication.TransientBRep
Dim body1 As SurfaceBody =  transBrep.Copy(part1.Definition.SurfaceBodies.Item(1))
Dim body2 As SurfaceBody =  transBrep.Copy(part2.Definition.SurfaceBodies.Item(1))

' Transform the bodies (NOT THE GRAPHICS NODE!) to be in the location represented in the assembly.
Call transBrep.Transform(body1, part1.Transformation)
Call transBrep.Transform(body2, part2.Transformation)
```

#### Code Block 9

```vb
// copy the part SrfBody to BREP and transform:
SurfaceBody bRepSrfBdy = bRep.Copy(item.SrfBody);
bRep.Transform(bRepSrfBdy, item.Transformation);

// get part appearance and copy to assembly
PartComponentDefinition partDef = (PartComponentDefinition)item.SrfBody.Parent;
PartDocument partDoc = (PartDocument)partDef.Document;
try
{
    _ = partDoc.ActiveAppearance.CopyTo(assmDoc, true);
}
catch { /* appearance already exists */ }
Asset assemblyAppearance = assmDoc.AppearanceAssets[partDoc.ActiveAppearance.Name];

// build the graphics node
GraphicsNode node = cg.AddNode(nodeID++);
SurfaceGraphics srfG = node.AddSurfaceGraphics(bRepSrfBdy);

// assign the appearance
node.Appearance = assemblyAppearance;
```

#### Code Block 10

```vb
// copy the part SrfBody to BREP and transform:
SurfaceBody bRepSrfBdy = bRep.Copy(item.SrfBody);
bRep.Transform(bRepSrfBdy, item.Transformation);

// get part appearance and copy to assembly
PartComponentDefinition partDef = (PartComponentDefinition)item.SrfBody.Parent;
PartDocument partDoc = (PartDocument)partDef.Document;
try
{
    _ = partDoc.ActiveAppearance.CopyTo(assmDoc, true);
}
catch { /* appearance already exists */ }
Asset assemblyAppearance = assmDoc.AppearanceAssets[partDoc.ActiveAppearance.Name];

// build the graphics node
GraphicsNode node = cg.AddNode(nodeID++);
SurfaceGraphics srfG = node.AddSurfaceGraphics(bRepSrfBdy);

// assign the appearance
node.Appearance = assemblyAppearance;
```

#### Code Block 11

```vb
// copy the part SrfBody to BREP and transform:
SurfaceBody bRepSrfBdy = bRep.Copy(item.SrfBody);
bRep.Transform(bRepSrfBdy, item.Transformation);

// get part appearance and copy to assembly
PartComponentDefinition partDef = (PartComponentDefinition)item.SrfBody.Parent;
PartDocument partDoc = (PartDocument)partDef.Document;
try
{
    _ = partDoc.ActiveAppearance.CopyTo(assmDoc, true);
}
catch { /* appearance already exists */ }
Asset assemblyAppearance = assmDoc.AppearanceAssets[partDoc.ActiveAppearance.Name];

// build the graphics node
GraphicsNode node = cg.AddNode(nodeID++);
SurfaceGraphics srfG = node.AddSurfaceGraphics(bRepSrfBdy);

// assign the appearance
node.Appearance = assemblyAppearance;
```

#### Code Block 12

```vb
// copy the part SrfBody to BREP and transform:
SurfaceBody bRepSrfBdy = bRep.Copy(item.SrfBody);
bRep.Transform(bRepSrfBdy, item.Transformation);

// get part appearance and copy to assembly
PartComponentDefinition partDef = (PartComponentDefinition)item.SrfBody.Parent;
PartDocument partDoc = (PartDocument)partDef.Document;
try
{
    _ = partDoc.ActiveAppearance.CopyTo(assmDoc, true);
}
catch { /* appearance already exists */ }
Asset assemblyAppearance = assmDoc.AppearanceAssets[partDoc.ActiveAppearance.Name];

// build the graphics node
GraphicsNode node = cg.AddNode(nodeID++);
SurfaceGraphics srfG = node.AddSurfaceGraphics(bRepSrfBdy);

// assign the appearance
node.Appearance = assemblyAppearance;
```

#### Code Block 13

```vb
foreach ((string Name, SurfaceBody SrfBody, Matrix Transformation) item in srfBodies)
                {
                    SurfaceBody srfBdy = item.SrfBody;
                    if (srfBdy.AppearanceSourceType == AppearanceSourceTypeEnum.kPartAppearance)
                    {
                        PartComponentDefinition partDef = (PartComponentDefinition)srfBdy.Parent;
                        PartDocument partDoc = (PartDocument)partDef.Document;                        
                        srfBdy.Appearance = partDoc.ActiveAppearance;
                    }
                    GraphicsNode node = cg.AddNode(nodeID++);
                    SurfaceGraphics srfG = node.AddSurfaceGraphics(srfBdy);                                     
                    node.Transformation = item.Transformation;
                }                
                invApp.ActiveView.Update();
```

#### Code Block 14

```vb
foreach ((string Name, SurfaceBody SrfBody, Matrix Transformation) item in srfBodies)
                {
                    SurfaceBody srfBdy = item.SrfBody;
                    if (srfBdy.AppearanceSourceType == AppearanceSourceTypeEnum.kPartAppearance)
                    {
                        PartComponentDefinition partDef = (PartComponentDefinition)srfBdy.Parent;
                        PartDocument partDoc = (PartDocument)partDef.Document;                        
                        srfBdy.Appearance = partDoc.ActiveAppearance;
                    }
                    GraphicsNode node = cg.AddNode(nodeID++);
                    SurfaceGraphics srfG = node.AddSurfaceGraphics(srfBdy);                                     
                    node.Transformation = item.Transformation;
                }                
                invApp.ActiveView.Update();
```

#### Code Block 15

```vb
foreach ((string Name, SurfaceBody SrfBody, Matrix Transformation) item in srfBodies)
                {
                    SurfaceBody srfBdy = item.SrfBody;
                    if (srfBdy.AppearanceSourceType == AppearanceSourceTypeEnum.kPartAppearance)
                    {
                        PartComponentDefinition partDef = (PartComponentDefinition)srfBdy.Parent;
                        PartDocument partDoc = (PartDocument)partDef.Document;                        
                        srfBdy.Appearance = partDoc.ActiveAppearance;
                    }
                    GraphicsNode node = cg.AddNode(nodeID++);
                    SurfaceGraphics srfG = node.AddSurfaceGraphics(srfBdy);                                     
                    node.Transformation = item.Transformation;
                }                
                invApp.ActiveView.Update();
```

#### Code Block 16

```vb
foreach ((string Name, SurfaceBody SrfBody, Matrix Transformation) item in srfBodies)
                {
                    SurfaceBody srfBdy = item.SrfBody;
                    if (srfBdy.AppearanceSourceType == AppearanceSourceTypeEnum.kPartAppearance)
                    {
                        PartComponentDefinition partDef = (PartComponentDefinition)srfBdy.Parent;
                        PartDocument partDoc = (PartDocument)partDef.Document;                        
                        srfBdy.Appearance = partDoc.ActiveAppearance;
                    }
                    GraphicsNode node = cg.AddNode(nodeID++);
                    SurfaceGraphics srfG = node.AddSurfaceGraphics(srfBdy);                                     
                    node.Transformation = item.Transformation;
                }                
                invApp.ActiveView.Update();
```

---

### 107. Threaded holes while logged off using API

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/threaded-holes-while-logged-off-using-api/td-p/13115155](https://forums.autodesk.com/t5/inventor-programming-forum/threaded-holes-while-logged-off-using-api/td-p/13115155)

**Author:** ZKeimW5SN7

**Date:** ‎10-29-2024
	
		
		05:27 AM

**Description:** We are using Inventor on a computer that has a C# console application querying a database for “work to do.” This console application is started by a task that launches the console application at the machine’s startup, and it runs in the background whether a person is logged into the machine or not. ...

**Code Snippets (6):**

#### Code Block 1

```vb
"C:\Program Files\Autodesk\Inventor 2023\Bin\Inventor.exe" /install
```

#### Code Block 2

```vb
"C:\Program Files\Autodesk\Inventor 2023\Bin\Inventor.exe" /install
```

#### Code Block 3

```vb
"C:\Program Files\Autodesk\Inventor 2023\Bin\Inventor.exe" /install
```

#### Code Block 4

```vb
"C:\Program Files\Autodesk\Inventor 2023\Bin\Inventor.exe" /install
```

#### Code Block 5

```vb
Process.Start(@"C:\Program Files\Autodesk\Inventor 2023\Bin\Inventor.exe");
```

#### Code Block 6

```vb
Process.Start(@"C:\Program Files\Autodesk\Inventor 2023\Bin\Inventor.exe");
```

#### Code Block 7

```vb
Process.Start(@"C:\Program Files\Autodesk\Inventor 2023\Bin\Inventor.exe");
```

#### Code Block 8

```vb
Process.Start(@"C:\Program Files\Autodesk\Inventor 2023\Bin\Inventor.exe");
```

#### Code Block 9

```vb
Type inventorAppType = System.Type.GetTypeFromProgID("Inventor.Application");
InventorApp = System.Activator.CreateInstance(inventorAppType) as Inventor.Application;
```

#### Code Block 10

```vb
Type inventorAppType = System.Type.GetTypeFromProgID("Inventor.Application");
InventorApp = System.Activator.CreateInstance(inventorAppType) as Inventor.Application;
```

#### Code Block 11

```vb
Type inventorAppType = System.Type.GetTypeFromProgID("Inventor.Application");
InventorApp = System.Activator.CreateInstance(inventorAppType) as Inventor.Application;
```

#### Code Block 12

```vb
Type inventorAppType = System.Type.GetTypeFromProgID("Inventor.Application");
InventorApp = System.Activator.CreateInstance(inventorAppType) as Inventor.Application;
```

---

### 108. Trying to detect if the All  Workfeatures button is checked or not.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/trying-to-detect-if-the-all-workfeatures-button-is-checked-or/td-p/13766498#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/trying-to-detect-if-the-all-workfeatures-button-is-checked-or/td-p/13766498#messageview_0)

**Author:** jsemansDCRCS

**Date:** ‎08-13-2025
	
		
		02:33 PM

**Description:** I am working on an iLogic rule that will automatically click the View > Object Visibility > All  Workfeatures button. It will run whenever a document is opened (using event triggers) as long as the document is a part or assembly. I have it to where it will activate the button, but it just currently ...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim doc As Document = ThisDoc.Document
If doc.ObjectVisibility.AllWorkFeatures Then
	MessageBox.Show("Work Features Are Visible")
End If
```

#### Code Block 2

```vb
Dim doc As Document = ThisDoc.Document
If doc.ObjectVisibility.AllWorkFeatures Then
	MessageBox.Show("Work Features Are Visible")
End If
```

#### Code Block 3

```vb
Dim doc As Document = ThisDoc.Document
If doc.ObjectVisibility.AllWorkFeatures Then
	MessageBox.Show("Work Features Are Visible")
End If
```

#### Code Block 4

```vb
Dim doc As Document = ThisDoc.Document
If doc.ObjectVisibility.AllWorkFeatures Then
	MessageBox.Show("Work Features Are Visible")
End If
```

#### Code Block 5

```vb
Sub Main()
	
	Dim invApp As Inventor.Application = ThisApplication
	Dim oControlDefs As ControlDefinitions
	Dim oControlDef As ControlDefinition
	oControlDefs = invApp.CommandManager.ControlDefinitions
	
	For Each oControlDef In oControlDefs
		
		If oControlDef.DisplayName = "All Workfeatures" Then
			'MessageBox.Show("Found it")
			oControlDef.Execute
		end if
		
	Next
	
End Sub
```

#### Code Block 6

```vb
Sub Main()
	
	Dim invApp As Inventor.Application = ThisApplication
	Dim oControlDefs As ControlDefinitions
	Dim oControlDef As ControlDefinition
	oControlDefs = invApp.CommandManager.ControlDefinitions
	
	For Each oControlDef In oControlDefs
		
		If oControlDef.DisplayName = "All Workfeatures" Then
			'MessageBox.Show("Found it")
			oControlDef.Execute
		end if
		
	Next
	
End Sub
```

#### Code Block 7

```vb
Sub Main()
	
	Dim invApp As Inventor.Application = ThisApplication
	Dim oControlDefs As ControlDefinitions
	Dim oControlDef As ControlDefinition
	oControlDefs = invApp.CommandManager.ControlDefinitions
	
	For Each oControlDef In oControlDefs
		
		If oControlDef.DisplayName = "All Workfeatures" Then
			'MessageBox.Show("Found it")
			oControlDef.Execute
		end if
		
	Next
	
End Sub
```

#### Code Block 8

```vb
Sub Main()
	
	Dim invApp As Inventor.Application = ThisApplication
	Dim oControlDefs As ControlDefinitions
	Dim oControlDef As ControlDefinition
	oControlDefs = invApp.CommandManager.ControlDefinitions
	
	For Each oControlDef In oControlDefs
		
		If oControlDef.DisplayName = "All Workfeatures" Then
			'MessageBox.Show("Found it")
			oControlDef.Execute
		end if
		
	Next
	
End Sub
```

---

### 109. Turn off visibility of welds in an occurrence

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/turn-off-visibility-of-welds-in-an-occurrence/td-p/13798962#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/turn-off-visibility-of-welds-in-an-occurrence/td-p/13798962#messageview_0)

**Author:** mfoster9TD82

**Date:** ‎09-05-2025
	
		
		02:45 PM

**Description:** I can't figure out how to do turn off the visibility of the welds in a component occurrence via the API. I'm simplifying assemblies so I can export them to STEP with less detail. I tried turning welds off in ObjectVisibility but they still come through after exporting.  					 				 			 			 				 			 	...

**Code Snippets (2):**

#### Code Block 1

```vb
For Each oOccurrence As ComponentOccurrence In oAssy.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			oSubOcc.Visible = False
		Next
	End If
Next
```

#### Code Block 2

```vb
For Each oOccurrence As ComponentOccurrence In oAssy.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			oSubOcc.Visible = False
		Next
	End If
Next
```

#### Code Block 3

```vb
For Each oOccurrence As ComponentOccurrence In oAssy.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			oSubOcc.Visible = False
		Next
	End If
Next
```

#### Code Block 4

```vb
For Each oOccurrence As ComponentOccurrence In oAssy.ComponentDefinition.Occurrences
	If (oOccurrence.Name.Contains("Weld"))
		For Each oSubOcc As ComponentOccurrence In oOccurrence.SubOccurrences
			oSubOcc.Visible = False
		Next
	End If
Next
```

---

### 110. USE ILOGIC TO EXPORT FLAT PATTERN USING INI TEMPLATE FILE

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/use-ilogic-to-export-flat-pattern-using-ini-template-file/td-p/13765963#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/use-ilogic-to-export-flat-pattern-using-ini-template-file/td-p/13765963#messageview_0)

**Author:** OTHOCLOUD

**Date:** ‎08-13-2025
	
		
		08:36 AM

**Description:** We started using the new Mark feature, but we are having issues renaming the layer name for it when we use Ilogic to export to DWG using the Write Data To File.  I seen in a post that there is nothing setup for renaming the layer using this method. It works if you use the SaveCopyAs Flat Pattern DWG...

**Code Snippets (2):**

#### Code Block 1

```vb
' Get the DWG translator Add-In.
    Dim DWGAddIn As TranslatorAddIn
   DWGAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC2-122E-11D5-8E91-0010B541CD80}")

    'Set a reference to the active document (the document to be published).
    Dim oDocument As Document
    oDocument = ThisApplication.ActiveDocument

    Dim oContext As TranslationContext
    oContext = ThisApplication.TransientObjects.CreateTranslationContext
    oContext.Type = kFileBrowseIOMechanism

    ' Create a NameValueMap object
    Dim oOptions As NameValueMap
    oOptions = ThisApplication.TransientObjects.CreateNameValueMap

    ' Create a DataMedium object
    Dim oDataMedium As DataMedium
    oDataMedium = ThisApplication.TransientObjects.CreateDataMedium

    ' Check whether the translator has 'SaveCopyAs' options
    If DWGAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then

        Dim strIniFile As String
        strIniFile = "C:\tempDWGOut.ini"
        ' Create the name-value that specifies the ini file to use.
        oOptions.Value("Export_Acad_IniFile") = strIniFile
    End If

    'Set the destination file name
    oDataMedium.FileName = "c:\tempdwgout.dwg"

    'Publish document.
    Call DWGAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
```

#### Code Block 2

```vb
' Get the DWG translator Add-In.
    Dim DWGAddIn As TranslatorAddIn
   DWGAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC2-122E-11D5-8E91-0010B541CD80}")

    'Set a reference to the active document (the document to be published).
    Dim oDocument As Document
    oDocument = ThisApplication.ActiveDocument

    Dim oContext As TranslationContext
    oContext = ThisApplication.TransientObjects.CreateTranslationContext
    oContext.Type = kFileBrowseIOMechanism

    ' Create a NameValueMap object
    Dim oOptions As NameValueMap
    oOptions = ThisApplication.TransientObjects.CreateNameValueMap

    ' Create a DataMedium object
    Dim oDataMedium As DataMedium
    oDataMedium = ThisApplication.TransientObjects.CreateDataMedium

    ' Check whether the translator has 'SaveCopyAs' options
    If DWGAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then

        Dim strIniFile As String
        strIniFile = "C:\tempDWGOut.ini"
        ' Create the name-value that specifies the ini file to use.
        oOptions.Value("Export_Acad_IniFile") = strIniFile
    End If

    'Set the destination file name
    oDataMedium.FileName = "c:\tempdwgout.dwg"

    'Publish document.
    Call DWGAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
```

#### Code Block 3

```vb
'Set a reference to the active document (the document to be published).
    Dim oDoc As PartDocument
    oDoc = ThisApplication.ActiveDocument
    
    Dim oCompDef As SheetMetalComponentDefinition
   oCompDef = oDoc.ComponentDefinition
        
    If oCompDef.HasFlatPattern = False Then
        oCompDef.Unfold
    End If
    
    Dim oFlatPattern As FlatPattern
    oFlatPattern = oCompDef.FlatPattern
    
	' Get the DWG translator Add-In.
    Dim DWGAddIn As TranslatorAddIn
   DWGAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC2-122E-11D5-8E91-0010B541CD80}")
    
    Dim oContext As TranslationContext
    oContext = ThisApplication.TransientObjects.CreateTranslationContext
	oContext.Type = kFileBrowseIOMechanism
  
  ' Create a NameValueMap object
    Dim oOptions As NameValueMap
    oOptions = ThisApplication.TransientObjects.CreateNameValueMap
           
    ' Create a DataMedium object
        Dim oData As DataMedium
        oData = ThisApplication.TransientObjects.CreateDataMedium
		
	'Set the destination file name
        oData.FileName = oDoc.FullFileName & ".dwg"
		
	' Check whether the translator has 'SaveCopyAs' options
    If DWGAddIn.HasSaveCopyAsOptions(oFlatPattern, oContext, oOptions) Then
	'Set ini file for export options
        Dim strIniFile As String
        strIniFile = "C:\tempDWGOut.ini"
        ' Create the name-value that specifies the ini file to use.
        oOptions.Value("Export_Acad_IniFile") = strIniFile
    End If
	
	
    'Publish document.
	Call DWGAddIn.SaveCopyAs(oFlatPattern, oContext, oOptions, oData)
```

#### Code Block 4

```vb
'Set a reference to the active document (the document to be published).
    Dim oDoc As PartDocument
    oDoc = ThisApplication.ActiveDocument
    
    Dim oCompDef As SheetMetalComponentDefinition
   oCompDef = oDoc.ComponentDefinition
        
    If oCompDef.HasFlatPattern = False Then
        oCompDef.Unfold
    End If
    
    Dim oFlatPattern As FlatPattern
    oFlatPattern = oCompDef.FlatPattern
    
	' Get the DWG translator Add-In.
    Dim DWGAddIn As TranslatorAddIn
   DWGAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC2-122E-11D5-8E91-0010B541CD80}")
    
    Dim oContext As TranslationContext
    oContext = ThisApplication.TransientObjects.CreateTranslationContext
	oContext.Type = kFileBrowseIOMechanism
  
  ' Create a NameValueMap object
    Dim oOptions As NameValueMap
    oOptions = ThisApplication.TransientObjects.CreateNameValueMap
           
    ' Create a DataMedium object
        Dim oData As DataMedium
        oData = ThisApplication.TransientObjects.CreateDataMedium
		
	'Set the destination file name
        oData.FileName = oDoc.FullFileName & ".dwg"
		
	' Check whether the translator has 'SaveCopyAs' options
    If DWGAddIn.HasSaveCopyAsOptions(oFlatPattern, oContext, oOptions) Then
	'Set ini file for export options
        Dim strIniFile As String
        strIniFile = "C:\tempDWGOut.ini"
        ' Create the name-value that specifies the ini file to use.
        oOptions.Value("Export_Acad_IniFile") = strIniFile
    End If
	
	
    'Publish document.
	Call DWGAddIn.SaveCopyAs(oFlatPattern, oContext, oOptions, oData)
```

---

### 111. Unable to apply finish to multiple of the same part within an assembly

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/unable-to-apply-finish-to-multiple-of-the-same-part-within-an/td-p/13763396](https://forums.autodesk.com/t5/inventor-programming-forum/unable-to-apply-finish-to-multiple-of-the-same-part-within-an/td-p/13763396)

**Author:** mitchELAHB

**Date:** ‎08-11-2025
	
		
		07:42 PM

**Description:** Hi guys, I have a script I use to apply a powder coat finish to all faces in an assembly, but it fails when I have multiple of the same part within it. This is a problem as most of the assemblies I design are held together with fasteners, which are all the same part. Here is the script that I'm usin...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
```

#### Code Block 2

```vb
Option Explicit On
Sub Main
	
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition

	'set list of components to skip
	Dim oSkipList As New ArrayList
	oSkipList.Clear 
'	oSkipList.Add("20110") 'add parts to skip here
'	oSkipList.Add("20224")
	
	Dim oFaceColl As Inventor.FaceCollection
	
	For Each oComponent In oADoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceColl, oSkipList)
		
	Next
	
	Dim oFinishColour = "Manor Red" 
	Dim oAppearance As Object = oADoc.AppearanceAssets.Item(oFinishColour)
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
	
End Sub


Function GetFaces(occ As Inventor.ComponentOccurrence, Optional ByRef faceColl As Inventor.FaceCollection = Nothing, Optional oSkipList As ArrayList = Nothing) As Inventor.FaceCollection
	
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	
	Dim oOccName As String = Split(occ.Name, ":")(0)
	If oSkipList.Contains(oOccName) Then Return Nothing
	
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
		
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl, oSkipList)
		Next 'oSubOcc
	End If
	
	Return faceColl
	
End Function
```

#### Code Block 3

```vb
Option Explicit On
Sub Main
	
	Dim oInvApp As Inventor.Application = ThisApplication
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.FactoryDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then Return
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition

	'set list of components to skip
	Dim oSkipList As New ArrayList
	oSkipList.Clear 
'	oSkipList.Add("20110") 'add parts to skip here
'	oSkipList.Add("20224")
	
	Dim oFaceColl As Inventor.FaceCollection
	
	For Each oComponent In oADoc.ComponentDefinition.Occurrences
		
		If oComponent.Suppressed = True Then Continue For
		If TypeOf oComponent.Definition Is VirtualComponentDefinition Then Continue For
		
		GetFaces(oComponent, oFaceColl, oSkipList)
		
	Next
	
	Dim oFinishColour = "Manor Red" 
	Dim oAppearance As Object = oADoc.AppearanceAssets.Item(oFinishColour)
	
	Dim oFinishFeats As FinishFeatures = oADef.Features.FinishFeatures
	Dim oFinishDef As FinishDefinition = oFinishFeats.CreateFinishDefinition(oFaceColl, FinishTypeEnum.kMaterialCoatingFinishType, "Powder Coat", oAppearance)
	Dim oFinishFeat As FinishFeature = oFinishFeats.Add(oFinishDef)
	
End Sub


Function GetFaces(occ As Inventor.ComponentOccurrence, Optional ByRef faceColl As Inventor.FaceCollection = Nothing, Optional oSkipList As ArrayList = Nothing) As Inventor.FaceCollection
	
	If (occ Is Nothing) OrElse occ.Suppressed Then Return Nothing
	If TypeOf occ.Definition Is VirtualComponentDefinition Then Return Nothing
	
	Dim oOccName As String = Split(occ.Name, ":")(0)
	If oSkipList.Contains(oOccName) Then Return Nothing
	
	If faceColl Is Nothing Then faceColl = ThisApplication.TransientObjects.CreateFaceCollection()
		
	For Each oBody As SurfaceBody In occ.SurfaceBodies
		For Each oFace As Face In oBody.Faces
			faceColl.Add(oFace)
		Next 'oFace
	Next 'oBody
	
	If occ.SubOccurrences IsNot Nothing AndAlso occ.SubOccurrences.Count > 0 Then
		For Each oSubOcc As Inventor.ComponentOccurrence In occ.SubOccurrences
			GetFaces(oSubOcc, faceColl, oSkipList)
		Next 'oSubOcc
	End If
	
	Return faceColl
	
End Function
```

---

### 112. Unable to cast COM object of type 'System._ComObject to interface type 'Inventor.Point2d'.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/unable-to-cast-com-object-of-type-system-comobject-to-interface/td-p/13739507#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/unable-to-cast-com-object-of-type-system-comobject-to-interface/td-p/13739507#messageview_0)

**Author:** SPalchaudhary

**Date:** ‎07-24-2025
	
		
		11:33 PM

**Description:** Hey, so I am trying to create an ilogic code for my organization which would help us in automating drawing of simple flat mounting plates, I created my ilogic code for the same but seem to run into an error while executing the drawing, can somebody help me figure out, how can I resolve this?Below is...

**Code Snippets (2):**

#### Code Block 1

```vb
Imports System.Reflection

Sub Main()
Dim oDoc As Inventor.Document = ThisApplication.ActiveDocument
If oDoc.DocumentType <> Inventor.DocumentTypeEnum.kPartDocumentObject Then
    MessageBox.Show("Run this rule from a Part (.ipt) document.", "Error")
    Return
End If

' Create new drawing document
Dim oDrawingDoc As Inventor.DrawingDocument
' Use a specific template if you have one, otherwise default
' oDrawingDoc = ThisApplication.Documents.Add("C:\Users\Public\Documents\Autodesk\Inventor 202x\Templates\Metric\ISO.idw", True) ' Example for specific template
oDrawingDoc = ThisApplication.Documents.Add(Inventor.DocumentTypeEnum.kDrawingDocumentObject, _
    ThisApplication.FileManager.GetTemplateFile(Inventor.DocumentTypeEnum.kDrawingDocumentObject))

Dim oSheet As Inventor.Sheet = oDrawingDoc.Sheets.Item(1)
Dim tg As Inventor.TransientGeometry = ThisApplication.TransientGeometry

' Adjust scale as needed based on part size and sheet size
Dim scale As Double = 0.1 ' Start with a reasonable scale, you might need to adjust

' Define view positions on the sheet. These are arbitrary and need fine-tuning.
' Units are in cm for a default A3 sheet (e.g., ISO.idw)
Dim basePoint As Inventor.Point2d = tg.CreatePoint2d(10, 20) ' Front view
Dim projRight As Inventor.Point2d = tg.CreatePoint2d(25, 20) ' Right view
Dim projIso As Inventor.Point2d = tg.CreatePoint2d(35, 25) ' Isometric view

Dim baseView As Inventor.DrawingView
Try
    baseView = oSheet.DrawingViews.AddBaseView(oDoc, basePoint, scale, _
        Inventor.ViewOrientationTypeEnum.kFrontViewOrientation, Inventor.DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding base view: " & ex.Message, "View Creation Error")
    Return ' Exit if base view cannot be added
End Try

Dim rightView As Inventor.DrawingView
Try
    rightView = oSheet.DrawingViews.AddProjectedView(baseView, projRight, Inventor.DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding right view: " & ex.Message, "View Creation Error")
End Try

Dim isoView As Inventor.DrawingView
Try
    isoView = oSheet.DrawingViews.AddProjectedView(baseView, projIso, Inventor.DrawingViewStyleEnum.kShadedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding isometric view: " & ex.Message, "View Creation Error")
End Try


' ===========================================
' Collect edges and points for dimensioning from the base view
' ===========================================
Dim oCurves As Inventor.DrawingCurvesEnumerator = baseView.DrawingCurves
Dim horizontalEdges As New List(Of Inventor.DrawingCurve) ' Store curves directly
Dim verticalEdges As New List(Of Inventor.DrawingCurve)   ' Store curves directly
Dim chamferCurves As New List(Of Inventor.DrawingCurve)
Dim circleCurves As New List(Of Inventor.DrawingCurve)

For Each c As Inventor.DrawingCurve In oCurves
    If c.Segments.Count > 0 Then
        If TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = c.Segments.Item(1).Geometry
            Dim startPt As Inventor.Point2d = lineSeg.StartPoint
            Dim endPt As Inventor.Point2d = lineSeg.EndPoint

            If Math.Abs(startPt.Y - endPt.Y) < 0.01 Then ' Horizontal line
                horizontalEdges.Add(c)
            ElseIf Math.Abs(startPt.X - endPt.X) < 0.01 Then ' Vertical line
                verticalEdges.Add(c)
            Else ' Angled line, potential chamfer or other feature
                chamferCurves.Add(c)
            End If
        ElseIf c.Segments.Item(1).GeometryType = Inventor.Curve2dTypeEnum.kCircleCurve2d Then
            circleCurves.Add(c)
        End If
    End If
Next

Dim oDims As Inventor.GeneralDimensions = oSheet.DrawingDimensions.GeneralDimensions

' ===========================================
' Add overall horizontal dimension (length)
' ===========================================
If horizontalEdges.Count > 1 Then ' Need at least two edges for linear dimension
    Dim leftmostCurve As Inventor.DrawingCurve = Nothing
    Dim rightmostCurve As Inventor.DrawingCurve = Nothing
    Dim minX As Double = Double.MaxValue
    Dim maxX As Double = Double.MinValue
    
    For Each edge In horizontalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            ' Consider both start and end points to find the true min/max X of the entire edge set
            If lineSeg.StartPoint.X < minX Then
                minX = lineSeg.StartPoint.X
                leftmostCurve = Edge ' Store the curve associated with this point
            End If
            If lineSeg.EndPoint.X < minX Then
                minX = lineSeg.EndPoint.X
                leftmostCurve = Edge ' Store the curve associated with this point
            End If

            If lineSeg.StartPoint.X > maxX Then
                maxX = lineSeg.StartPoint.X
                rightmostCurve = Edge ' Store the curve associated with this point
            End If
            If lineSeg.EndPoint.X > maxX Then
                maxX = lineSeg.EndPoint.X
                rightmostCurve = Edge ' Store the curve associated with this point
            End If
        End If
    Next

    If leftmostCurve IsNot Nothing AndAlso rightmostCurve IsNot Nothing Then
        ' Calculate average Y of the two extreme points for text placement
        ' This is simplified, assuming the horizontal edges are roughly at the same Y
        ' Ensure the point for dim text origin is created in the sheet context
        Dim dimPointH As Inventor.Point2d = tg.CreatePoint2d((minX + maxX) / 2, baseView.Position.Y - (baseView.Height / 2) - 2)
        
        Try
            ' Use the overload that takes two DrawingCurve objects directly
            oDims.AddLinear(leftmostCurve, rightmostCurve, dimPointH, Inventor.DimensionTypeEnum.kHorizontalDimensionType)
        Catch ex As Exception
            MessageBox.Show("Error adding horizontal dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If

' ===========================================
' Add overall vertical dimension (width/height)
' ===========================================
If verticalEdges.Count > 1 Then
    Dim bottommostCurve As Inventor.DrawingCurve = Nothing
    Dim topmostCurve As Inventor.DrawingCurve = Nothing
    Dim minY As Double = Double.MaxValue
    Dim maxY As Double = Double.MinValue

    For Each edge In verticalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            If lineSeg.StartPoint.Y < minY Then
                minY = lineSeg.StartPoint.Y
                bottommostCurve = Edge
            End If
            If lineSeg.EndPoint.Y < minY Then
                minY = lineSeg.EndPoint.Y
                bottommostCurve = Edge
            End If

            If lineSeg.StartPoint.Y > maxY Then
                maxY = lineSeg.StartPoint.Y
                topmostCurve = Edge
            End If
            If lineSeg.EndPoint.Y > maxY Then
                maxY = lineSeg.EndPoint.Y
                topmostCurve = Edge
            End If
        End If
    Next

    If bottommostCurve IsNot Nothing AndAlso topmostCurve IsNot Nothing Then
        ' This is simplified, assuming the vertical edges are roughly at the same X
        ' Ensure the point for dim text origin is created in the sheet context
        Dim dimPointV As Inventor.Point2d = tg.CreatePoint2d(baseView.Position.X - (baseView.Width / 2) - 2, (minY + maxY) / 2)
        
        Try
            oDims.AddLinear(bottommostCurve, topmostCurve, dimPointV, Inventor.DimensionTypeEnum.kVerticalDimensionType)
        Catch ex As Exception
            MessageBox.Show("Error adding vertical dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If

' ===========================================
' Add thickness dimension (from the right view)
' ===========================================
' Thickness is represented by horizontal lines in the right view
Dim rightViewCurves As Inventor.DrawingCurvesEnumerator = rightView.DrawingCurves
Dim thicknessHorizontalEdges As New List(Of Inventor.DrawingCurve) 

For Each c As Inventor.DrawingCurve In rightViewCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
        Dim lineSeg As Inventor.LineSegment2d = c.Segments.Item(1).Geometry
        If Math.Abs(lineSeg.StartPoint.Y - lineSeg.EndPoint.Y) < 0.01 Then ' Horizontal line in right view
            thicknessHorizontalEdges.Add(c)
        End If
    End If
Next

If thicknessHorizontalEdges.Count > 1 Then
    Dim thicknessLeftCurve As Inventor.DrawingCurve = Nothing
    Dim thicknessRightCurve As Inventor.DrawingCurve = Nothing
    Dim thicknessMinX As Double = Double.MaxValue
    Dim thicknessMaxX As Double = Double.MinValue

    For Each edge As Inventor.DrawingCurve In thicknessHorizontalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            If lineSeg.StartPoint.X < thicknessMinX Then
                thicknessMinX = lineSeg.StartPoint.X
                thicknessLeftCurve = Edge
            End If
            If lineSeg.EndPoint.X < thicknessMinX Then
                thicknessMinX = lineSeg.EndPoint.X
                thicknessLeftCurve = Edge
            End If

            If lineSeg.StartPoint.X > thicknessMaxX Then
                thicknessMaxX = lineSeg.StartPoint.X
                thicknessRightCurve = Edge
            End If
            If lineSeg.EndPoint.X > thicknessMaxX Then
                thicknessMaxX = lineSeg.EndPoint.X
                thicknessRightCurve = Edge
            End If
        End If
    Next 

    If thicknessLeftCurve IsNot Nothing AndAlso thicknessRightCurve IsNot Nothing Then
        ' Simplified average Y for text placement
        Dim dimPointT As Inventor.Point2d = tg.CreatePoint2d(rightView.Position.X + (rightView.Width / 2) + 2, (thicknessLeftCurve.Segments.Item(1).Geometry.StartPoint.Y + thicknessRightCurve.Segments.Item(1).Geometry.StartPoint.Y) / 2)
        
        Try
            oDims.AddLinear(thicknessLeftCurve, thicknessRightCurve, dimPointT, Inventor.DimensionTypeEnum.kHorizontalDimensionType) ' Horizontal in the right view
        Catch ex As Exception
            MessageBox.Show("Error adding thickness dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If 

' ===========================================
' Add chamfer dimensions
' ===========================================
For Each c As Inventor.DrawingCurve In chamferCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then ' Ensure it's a line segment
        Try
            ' Chamfer dimensions often take the DrawingCurve directly.
            Dim chamferPoint As Inventor.Point2d = tg.CreatePoint2d(c.Segments.Item(1).Geometry.StartPoint.X + 2, c.Segments.Item(1).Geometry.StartPoint.Y + 2)
            oSheet.DrawingDimensions.ChamferDimensions.Add(c, chamferPoint)
        Catch ex As Exception
            MessageBox.Show("Error adding chamfer dimension for curve " & c.ToString() & ": " & ex.Message, "Chamfer Dimension Error")
        End Try
    End If
Next

' ===========================================
' Add radial dimensions for holes
' ===========================================
For Each c As Inventor.DrawingCurve In circleCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.Circle2d Then
        Try
            Dim circleGeom As Inventor.Circle2d = c.Segments.Item(1).Geometry
            Dim holePoint As Inventor.Point2d = tg.CreatePoint2d(circleGeom.Center.X + circleGeom.Radius + 1, circleGeom.Center.Y + circleGeom.Radius + 1)
            oSheet.DrawingDimensions.RadialDimensions.Add(c, holePoint)
        Catch ex As Exception
            MessageBox.Show("Error adding radial dimension for circle " & c.ToString() & ": " & ex.Message, "Radial Dimension Error")
        End Try
    End If
Next

' ===========================================
' Update Title Block
' ===========================================
Dim oTitleBlock As Inventor.TitleBlock = Nothing
Try
    If oSheet.TitleBlock IsNot Nothing Then
        oTitleBlock = oSheet.TitleBlock
        oTitleBlock.SetPromptResultText("TITLE", "PLATE AUTOMATION")
        oTitleBlock.SetPromptResultText("DRAWN BY", System.Environment.UserName)
        oTitleBlock.SetPromptResultText("DATE", Now.ToShortDateString)
    Else
        MessageBox.Show("No title block found on the sheet.", "Title Block Warning")
    End If
Catch ex As Exception
    MessageBox.Show("Error updating title block: " & ex.Message, "Title Block Error")
End Try

' ===========================================
' Export to PDF & DWG
' ===========================================
Dim path As String = System.IO.Path.GetDirectoryName(oDoc.FullFileName)
Dim nameOnly As String = System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName)

Dim pdfName As String = System.IO.Path.Combine(path, nameOnly & ".pdf")
Dim pdfAddIn As Inventor.TranslatorAddIn = ThisApplication.ApplicationAddIns.ItemById("{0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4}") ' PDF Translator Add-In ID
Dim pdfContext As Inventor.TranslationContext = ThisApplication.TransientObjects.CreateTranslationContext()
Dim pdfOptions As Inventor.NameValueMap = ThisApplication.TransientObjects.CreateNameValueMap()
pdfContext.Type = Inventor.IOMechanismEnum.kFileBrowseIOMechanism
If pdfAddIn.HasSaveCopyAsOptions(oDrawingDoc, pdfContext, pdfOptions) Then
    pdfOptions.Value("Sheet_Range") = Inventor.PrintRangeEnum.kPrintAllSheets
End If
Dim pdfData As Inventor.DataMedium = ThisApplication.TransientObjects.CreateDataMedium()
pdfData.FileName = pdfName
Try
    pdfAddIn.SaveCopyAs(oDrawingDoc, pdfContext, pdfOptions, pdfData)
Catch ex As Exception
    MessageBox.Show("Error exporting to PDF: " & ex.Message, "Export Error")
End Try


Dim dwgName As String = System.IO.Path.Combine(path, nameOnly & ".dwg")
Try
    oDrawingDoc.SaveAs(dwgName, False)
Catch ex As Exception
    MessageBox.Show("Error exporting to DWG: " & ex.Message, "Export Error")
End Try


ThisApplication.ActiveView.Fit
MessageBox.Show("Drawing created and exported to PDF and DWG at: " & path, "Success")

End Sub
```

#### Code Block 2

```vb
Imports System.Reflection

Sub Main()
Dim oDoc As Inventor.Document = ThisApplication.ActiveDocument
If oDoc.DocumentType <> Inventor.DocumentTypeEnum.kPartDocumentObject Then
    MessageBox.Show("Run this rule from a Part (.ipt) document.", "Error")
    Return
End If

' Create new drawing document
Dim oDrawingDoc As Inventor.DrawingDocument
' Use a specific template if you have one, otherwise default
' oDrawingDoc = ThisApplication.Documents.Add("C:\Users\Public\Documents\Autodesk\Inventor 202x\Templates\Metric\ISO.idw", True) ' Example for specific template
oDrawingDoc = ThisApplication.Documents.Add(Inventor.DocumentTypeEnum.kDrawingDocumentObject, _
    ThisApplication.FileManager.GetTemplateFile(Inventor.DocumentTypeEnum.kDrawingDocumentObject))

Dim oSheet As Inventor.Sheet = oDrawingDoc.Sheets.Item(1)
Dim tg As Inventor.TransientGeometry = ThisApplication.TransientGeometry

' Adjust scale as needed based on part size and sheet size
Dim scale As Double = 0.1 ' Start with a reasonable scale, you might need to adjust

' Define view positions on the sheet. These are arbitrary and need fine-tuning.
' Units are in cm for a default A3 sheet (e.g., ISO.idw)
Dim basePoint As Inventor.Point2d = tg.CreatePoint2d(10, 20) ' Front view
Dim projRight As Inventor.Point2d = tg.CreatePoint2d(25, 20) ' Right view
Dim projIso As Inventor.Point2d = tg.CreatePoint2d(35, 25) ' Isometric view

Dim baseView As Inventor.DrawingView
Try
    baseView = oSheet.DrawingViews.AddBaseView(oDoc, basePoint, scale, _
        Inventor.ViewOrientationTypeEnum.kFrontViewOrientation, Inventor.DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding base view: " & ex.Message, "View Creation Error")
    Return ' Exit if base view cannot be added
End Try

Dim rightView As Inventor.DrawingView
Try
    rightView = oSheet.DrawingViews.AddProjectedView(baseView, projRight, Inventor.DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding right view: " & ex.Message, "View Creation Error")
End Try

Dim isoView As Inventor.DrawingView
Try
    isoView = oSheet.DrawingViews.AddProjectedView(baseView, projIso, Inventor.DrawingViewStyleEnum.kShadedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding isometric view: " & ex.Message, "View Creation Error")
End Try


' ===========================================
' Collect edges and points for dimensioning from the base view
' ===========================================
Dim oCurves As Inventor.DrawingCurvesEnumerator = baseView.DrawingCurves
Dim horizontalEdges As New List(Of Inventor.DrawingCurve) ' Store curves directly
Dim verticalEdges As New List(Of Inventor.DrawingCurve)   ' Store curves directly
Dim chamferCurves As New List(Of Inventor.DrawingCurve)
Dim circleCurves As New List(Of Inventor.DrawingCurve)

For Each c As Inventor.DrawingCurve In oCurves
    If c.Segments.Count > 0 Then
        If TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = c.Segments.Item(1).Geometry
            Dim startPt As Inventor.Point2d = lineSeg.StartPoint
            Dim endPt As Inventor.Point2d = lineSeg.EndPoint

            If Math.Abs(startPt.Y - endPt.Y) < 0.01 Then ' Horizontal line
                horizontalEdges.Add(c)
            ElseIf Math.Abs(startPt.X - endPt.X) < 0.01 Then ' Vertical line
                verticalEdges.Add(c)
            Else ' Angled line, potential chamfer or other feature
                chamferCurves.Add(c)
            End If
        ElseIf c.Segments.Item(1).GeometryType = Inventor.Curve2dTypeEnum.kCircleCurve2d Then
            circleCurves.Add(c)
        End If
    End If
Next

Dim oDims As Inventor.GeneralDimensions = oSheet.DrawingDimensions.GeneralDimensions

' ===========================================
' Add overall horizontal dimension (length)
' ===========================================
If horizontalEdges.Count > 1 Then ' Need at least two edges for linear dimension
    Dim leftmostCurve As Inventor.DrawingCurve = Nothing
    Dim rightmostCurve As Inventor.DrawingCurve = Nothing
    Dim minX As Double = Double.MaxValue
    Dim maxX As Double = Double.MinValue
    
    For Each edge In horizontalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            ' Consider both start and end points to find the true min/max X of the entire edge set
            If lineSeg.StartPoint.X < minX Then
                minX = lineSeg.StartPoint.X
                leftmostCurve = Edge ' Store the curve associated with this point
            End If
            If lineSeg.EndPoint.X < minX Then
                minX = lineSeg.EndPoint.X
                leftmostCurve = Edge ' Store the curve associated with this point
            End If

            If lineSeg.StartPoint.X > maxX Then
                maxX = lineSeg.StartPoint.X
                rightmostCurve = Edge ' Store the curve associated with this point
            End If
            If lineSeg.EndPoint.X > maxX Then
                maxX = lineSeg.EndPoint.X
                rightmostCurve = Edge ' Store the curve associated with this point
            End If
        End If
    Next

    If leftmostCurve IsNot Nothing AndAlso rightmostCurve IsNot Nothing Then
        ' Calculate average Y of the two extreme points for text placement
        ' This is simplified, assuming the horizontal edges are roughly at the same Y
        ' Ensure the point for dim text origin is created in the sheet context
        Dim dimPointH As Inventor.Point2d = tg.CreatePoint2d((minX + maxX) / 2, baseView.Position.Y - (baseView.Height / 2) - 2)
        
        Try
            ' Use the overload that takes two DrawingCurve objects directly
            oDims.AddLinear(leftmostCurve, rightmostCurve, dimPointH, Inventor.DimensionTypeEnum.kHorizontalDimensionType)
        Catch ex As Exception
            MessageBox.Show("Error adding horizontal dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If

' ===========================================
' Add overall vertical dimension (width/height)
' ===========================================
If verticalEdges.Count > 1 Then
    Dim bottommostCurve As Inventor.DrawingCurve = Nothing
    Dim topmostCurve As Inventor.DrawingCurve = Nothing
    Dim minY As Double = Double.MaxValue
    Dim maxY As Double = Double.MinValue

    For Each edge In verticalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            If lineSeg.StartPoint.Y < minY Then
                minY = lineSeg.StartPoint.Y
                bottommostCurve = Edge
            End If
            If lineSeg.EndPoint.Y < minY Then
                minY = lineSeg.EndPoint.Y
                bottommostCurve = Edge
            End If

            If lineSeg.StartPoint.Y > maxY Then
                maxY = lineSeg.StartPoint.Y
                topmostCurve = Edge
            End If
            If lineSeg.EndPoint.Y > maxY Then
                maxY = lineSeg.EndPoint.Y
                topmostCurve = Edge
            End If
        End If
    Next

    If bottommostCurve IsNot Nothing AndAlso topmostCurve IsNot Nothing Then
        ' This is simplified, assuming the vertical edges are roughly at the same X
        ' Ensure the point for dim text origin is created in the sheet context
        Dim dimPointV As Inventor.Point2d = tg.CreatePoint2d(baseView.Position.X - (baseView.Width / 2) - 2, (minY + maxY) / 2)
        
        Try
            oDims.AddLinear(bottommostCurve, topmostCurve, dimPointV, Inventor.DimensionTypeEnum.kVerticalDimensionType)
        Catch ex As Exception
            MessageBox.Show("Error adding vertical dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If

' ===========================================
' Add thickness dimension (from the right view)
' ===========================================
' Thickness is represented by horizontal lines in the right view
Dim rightViewCurves As Inventor.DrawingCurvesEnumerator = rightView.DrawingCurves
Dim thicknessHorizontalEdges As New List(Of Inventor.DrawingCurve) 

For Each c As Inventor.DrawingCurve In rightViewCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
        Dim lineSeg As Inventor.LineSegment2d = c.Segments.Item(1).Geometry
        If Math.Abs(lineSeg.StartPoint.Y - lineSeg.EndPoint.Y) < 0.01 Then ' Horizontal line in right view
            thicknessHorizontalEdges.Add(c)
        End If
    End If
Next

If thicknessHorizontalEdges.Count > 1 Then
    Dim thicknessLeftCurve As Inventor.DrawingCurve = Nothing
    Dim thicknessRightCurve As Inventor.DrawingCurve = Nothing
    Dim thicknessMinX As Double = Double.MaxValue
    Dim thicknessMaxX As Double = Double.MinValue

    For Each edge As Inventor.DrawingCurve In thicknessHorizontalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            If lineSeg.StartPoint.X < thicknessMinX Then
                thicknessMinX = lineSeg.StartPoint.X
                thicknessLeftCurve = Edge
            End If
            If lineSeg.EndPoint.X < thicknessMinX Then
                thicknessMinX = lineSeg.EndPoint.X
                thicknessLeftCurve = Edge
            End If

            If lineSeg.StartPoint.X > thicknessMaxX Then
                thicknessMaxX = lineSeg.StartPoint.X
                thicknessRightCurve = Edge
            End If
            If lineSeg.EndPoint.X > thicknessMaxX Then
                thicknessMaxX = lineSeg.EndPoint.X
                thicknessRightCurve = Edge
            End If
        End If
    Next 

    If thicknessLeftCurve IsNot Nothing AndAlso thicknessRightCurve IsNot Nothing Then
        ' Simplified average Y for text placement
        Dim dimPointT As Inventor.Point2d = tg.CreatePoint2d(rightView.Position.X + (rightView.Width / 2) + 2, (thicknessLeftCurve.Segments.Item(1).Geometry.StartPoint.Y + thicknessRightCurve.Segments.Item(1).Geometry.StartPoint.Y) / 2)
        
        Try
            oDims.AddLinear(thicknessLeftCurve, thicknessRightCurve, dimPointT, Inventor.DimensionTypeEnum.kHorizontalDimensionType) ' Horizontal in the right view
        Catch ex As Exception
            MessageBox.Show("Error adding thickness dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If 

' ===========================================
' Add chamfer dimensions
' ===========================================
For Each c As Inventor.DrawingCurve In chamferCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then ' Ensure it's a line segment
        Try
            ' Chamfer dimensions often take the DrawingCurve directly.
            Dim chamferPoint As Inventor.Point2d = tg.CreatePoint2d(c.Segments.Item(1).Geometry.StartPoint.X + 2, c.Segments.Item(1).Geometry.StartPoint.Y + 2)
            oSheet.DrawingDimensions.ChamferDimensions.Add(c, chamferPoint)
        Catch ex As Exception
            MessageBox.Show("Error adding chamfer dimension for curve " & c.ToString() & ": " & ex.Message, "Chamfer Dimension Error")
        End Try
    End If
Next

' ===========================================
' Add radial dimensions for holes
' ===========================================
For Each c As Inventor.DrawingCurve In circleCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.Circle2d Then
        Try
            Dim circleGeom As Inventor.Circle2d = c.Segments.Item(1).Geometry
            Dim holePoint As Inventor.Point2d = tg.CreatePoint2d(circleGeom.Center.X + circleGeom.Radius + 1, circleGeom.Center.Y + circleGeom.Radius + 1)
            oSheet.DrawingDimensions.RadialDimensions.Add(c, holePoint)
        Catch ex As Exception
            MessageBox.Show("Error adding radial dimension for circle " & c.ToString() & ": " & ex.Message, "Radial Dimension Error")
        End Try
    End If
Next

' ===========================================
' Update Title Block
' ===========================================
Dim oTitleBlock As Inventor.TitleBlock = Nothing
Try
    If oSheet.TitleBlock IsNot Nothing Then
        oTitleBlock = oSheet.TitleBlock
        oTitleBlock.SetPromptResultText("TITLE", "PLATE AUTOMATION")
        oTitleBlock.SetPromptResultText("DRAWN BY", System.Environment.UserName)
        oTitleBlock.SetPromptResultText("DATE", Now.ToShortDateString)
    Else
        MessageBox.Show("No title block found on the sheet.", "Title Block Warning")
    End If
Catch ex As Exception
    MessageBox.Show("Error updating title block: " & ex.Message, "Title Block Error")
End Try

' ===========================================
' Export to PDF & DWG
' ===========================================
Dim path As String = System.IO.Path.GetDirectoryName(oDoc.FullFileName)
Dim nameOnly As String = System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName)

Dim pdfName As String = System.IO.Path.Combine(path, nameOnly & ".pdf")
Dim pdfAddIn As Inventor.TranslatorAddIn = ThisApplication.ApplicationAddIns.ItemById("{0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4}") ' PDF Translator Add-In ID
Dim pdfContext As Inventor.TranslationContext = ThisApplication.TransientObjects.CreateTranslationContext()
Dim pdfOptions As Inventor.NameValueMap = ThisApplication.TransientObjects.CreateNameValueMap()
pdfContext.Type = Inventor.IOMechanismEnum.kFileBrowseIOMechanism
If pdfAddIn.HasSaveCopyAsOptions(oDrawingDoc, pdfContext, pdfOptions) Then
    pdfOptions.Value("Sheet_Range") = Inventor.PrintRangeEnum.kPrintAllSheets
End If
Dim pdfData As Inventor.DataMedium = ThisApplication.TransientObjects.CreateDataMedium()
pdfData.FileName = pdfName
Try
    pdfAddIn.SaveCopyAs(oDrawingDoc, pdfContext, pdfOptions, pdfData)
Catch ex As Exception
    MessageBox.Show("Error exporting to PDF: " & ex.Message, "Export Error")
End Try


Dim dwgName As String = System.IO.Path.Combine(path, nameOnly & ".dwg")
Try
    oDrawingDoc.SaveAs(dwgName, False)
Catch ex As Exception
    MessageBox.Show("Error exporting to DWG: " & ex.Message, "Export Error")
End Try


ThisApplication.ActiveView.Fit
MessageBox.Show("Drawing created and exported to PDF and DWG at: " & path, "Success")

End Sub
```

#### Code Block 3

```vb
Imports System.Reflection

Sub Main()
Dim oDoc As Inventor.Document = ThisApplication.ActiveDocument
If oDoc.DocumentType <> Inventor.DocumentTypeEnum.kPartDocumentObject Then
    MessageBox.Show("Run this rule from a Part (.ipt) document.", "Error")
    Return
End If

' Create new drawing document
Dim oDrawingDoc As Inventor.DrawingDocument
' Use a specific template if you have one, otherwise default
' oDrawingDoc = ThisApplication.Documents.Add("C:\Users\Public\Documents\Autodesk\Inventor 202x\Templates\Metric\ISO.idw", True) ' Example for specific template
oDrawingDoc = ThisApplication.Documents.Add(Inventor.DocumentTypeEnum.kDrawingDocumentObject, _
    ThisApplication.FileManager.GetTemplateFile(Inventor.DocumentTypeEnum.kDrawingDocumentObject))

Dim oSheet As Inventor.Sheet = oDrawingDoc.Sheets.Item(1)
Dim tg As Inventor.TransientGeometry = ThisApplication.TransientGeometry

' Adjust scale as needed based on part size and sheet size
Dim scale As Double = 0.1 ' Start with a reasonable scale, you might need to adjust

' Define view positions on the sheet. These are arbitrary and need fine-tuning.
' Units are in cm for a default A3 sheet (e.g., ISO.idw)
Dim basePoint As Inventor.Point2d = tg.CreatePoint2d(10, 20) ' Front view
Dim projRight As Inventor.Point2d = tg.CreatePoint2d(25, 20) ' Right view
Dim projIso As Inventor.Point2d = tg.CreatePoint2d(35, 25) ' Isometric view

Dim baseView As Inventor.DrawingView
Try
    baseView = oSheet.DrawingViews.AddBaseView(oDoc, basePoint, scale, _
        Inventor.ViewOrientationTypeEnum.kFrontViewOrientation, Inventor.DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding base view: " & ex.Message, "View Creation Error")
    Return ' Exit if base view cannot be added
End Try

Dim rightView As Inventor.DrawingView
Try
    rightView = oSheet.DrawingViews.AddProjectedView(baseView, projRight, Inventor.DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding right view: " & ex.Message, "View Creation Error")
End Try

Dim isoView As Inventor.DrawingView
Try
    isoView = oSheet.DrawingViews.AddProjectedView(baseView, projIso, Inventor.DrawingViewStyleEnum.kShadedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding isometric view: " & ex.Message, "View Creation Error")
End Try


' ===========================================
' Collect edges and points for dimensioning from the base view
' ===========================================
Dim oCurves As Inventor.DrawingCurvesEnumerator = baseView.DrawingCurves
Dim horizontalEdges As New List(Of Inventor.DrawingCurve) ' Store curves directly
Dim verticalEdges As New List(Of Inventor.DrawingCurve)   ' Store curves directly
Dim chamferCurves As New List(Of Inventor.DrawingCurve)
Dim circleCurves As New List(Of Inventor.DrawingCurve)

For Each c As Inventor.DrawingCurve In oCurves
    If c.Segments.Count > 0 Then
        If TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = c.Segments.Item(1).Geometry
            Dim startPt As Inventor.Point2d = lineSeg.StartPoint
            Dim endPt As Inventor.Point2d = lineSeg.EndPoint

            If Math.Abs(startPt.Y - endPt.Y) < 0.01 Then ' Horizontal line
                horizontalEdges.Add(c)
            ElseIf Math.Abs(startPt.X - endPt.X) < 0.01 Then ' Vertical line
                verticalEdges.Add(c)
            Else ' Angled line, potential chamfer or other feature
                chamferCurves.Add(c)
            End If
        ElseIf c.Segments.Item(1).GeometryType = Inventor.Curve2dTypeEnum.kCircleCurve2d Then
            circleCurves.Add(c)
        End If
    End If
Next

Dim oDims As Inventor.GeneralDimensions = oSheet.DrawingDimensions.GeneralDimensions

' ===========================================
' Add overall horizontal dimension (length)
' ===========================================
If horizontalEdges.Count > 1 Then ' Need at least two edges for linear dimension
    Dim leftmostCurve As Inventor.DrawingCurve = Nothing
    Dim rightmostCurve As Inventor.DrawingCurve = Nothing
    Dim minX As Double = Double.MaxValue
    Dim maxX As Double = Double.MinValue
    
    For Each edge In horizontalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            ' Consider both start and end points to find the true min/max X of the entire edge set
            If lineSeg.StartPoint.X < minX Then
                minX = lineSeg.StartPoint.X
                leftmostCurve = Edge ' Store the curve associated with this point
            End If
            If lineSeg.EndPoint.X < minX Then
                minX = lineSeg.EndPoint.X
                leftmostCurve = Edge ' Store the curve associated with this point
            End If

            If lineSeg.StartPoint.X > maxX Then
                maxX = lineSeg.StartPoint.X
                rightmostCurve = Edge ' Store the curve associated with this point
            End If
            If lineSeg.EndPoint.X > maxX Then
                maxX = lineSeg.EndPoint.X
                rightmostCurve = Edge ' Store the curve associated with this point
            End If
        End If
    Next

    If leftmostCurve IsNot Nothing AndAlso rightmostCurve IsNot Nothing Then
        ' Calculate average Y of the two extreme points for text placement
        ' This is simplified, assuming the horizontal edges are roughly at the same Y
        ' Ensure the point for dim text origin is created in the sheet context
        Dim dimPointH As Inventor.Point2d = tg.CreatePoint2d((minX + maxX) / 2, baseView.Position.Y - (baseView.Height / 2) - 2)
        
        Try
            ' Use the overload that takes two DrawingCurve objects directly
            oDims.AddLinear(leftmostCurve, rightmostCurve, dimPointH, Inventor.DimensionTypeEnum.kHorizontalDimensionType)
        Catch ex As Exception
            MessageBox.Show("Error adding horizontal dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If

' ===========================================
' Add overall vertical dimension (width/height)
' ===========================================
If verticalEdges.Count > 1 Then
    Dim bottommostCurve As Inventor.DrawingCurve = Nothing
    Dim topmostCurve As Inventor.DrawingCurve = Nothing
    Dim minY As Double = Double.MaxValue
    Dim maxY As Double = Double.MinValue

    For Each edge In verticalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            If lineSeg.StartPoint.Y < minY Then
                minY = lineSeg.StartPoint.Y
                bottommostCurve = Edge
            End If
            If lineSeg.EndPoint.Y < minY Then
                minY = lineSeg.EndPoint.Y
                bottommostCurve = Edge
            End If

            If lineSeg.StartPoint.Y > maxY Then
                maxY = lineSeg.StartPoint.Y
                topmostCurve = Edge
            End If
            If lineSeg.EndPoint.Y > maxY Then
                maxY = lineSeg.EndPoint.Y
                topmostCurve = Edge
            End If
        End If
    Next

    If bottommostCurve IsNot Nothing AndAlso topmostCurve IsNot Nothing Then
        ' This is simplified, assuming the vertical edges are roughly at the same X
        ' Ensure the point for dim text origin is created in the sheet context
        Dim dimPointV As Inventor.Point2d = tg.CreatePoint2d(baseView.Position.X - (baseView.Width / 2) - 2, (minY + maxY) / 2)
        
        Try
            oDims.AddLinear(bottommostCurve, topmostCurve, dimPointV, Inventor.DimensionTypeEnum.kVerticalDimensionType)
        Catch ex As Exception
            MessageBox.Show("Error adding vertical dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If

' ===========================================
' Add thickness dimension (from the right view)
' ===========================================
' Thickness is represented by horizontal lines in the right view
Dim rightViewCurves As Inventor.DrawingCurvesEnumerator = rightView.DrawingCurves
Dim thicknessHorizontalEdges As New List(Of Inventor.DrawingCurve) 

For Each c As Inventor.DrawingCurve In rightViewCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
        Dim lineSeg As Inventor.LineSegment2d = c.Segments.Item(1).Geometry
        If Math.Abs(lineSeg.StartPoint.Y - lineSeg.EndPoint.Y) < 0.01 Then ' Horizontal line in right view
            thicknessHorizontalEdges.Add(c)
        End If
    End If
Next

If thicknessHorizontalEdges.Count > 1 Then
    Dim thicknessLeftCurve As Inventor.DrawingCurve = Nothing
    Dim thicknessRightCurve As Inventor.DrawingCurve = Nothing
    Dim thicknessMinX As Double = Double.MaxValue
    Dim thicknessMaxX As Double = Double.MinValue

    For Each edge As Inventor.DrawingCurve In thicknessHorizontalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            If lineSeg.StartPoint.X < thicknessMinX Then
                thicknessMinX = lineSeg.StartPoint.X
                thicknessLeftCurve = Edge
            End If
            If lineSeg.EndPoint.X < thicknessMinX Then
                thicknessMinX = lineSeg.EndPoint.X
                thicknessLeftCurve = Edge
            End If

            If lineSeg.StartPoint.X > thicknessMaxX Then
                thicknessMaxX = lineSeg.StartPoint.X
                thicknessRightCurve = Edge
            End If
            If lineSeg.EndPoint.X > thicknessMaxX Then
                thicknessMaxX = lineSeg.EndPoint.X
                thicknessRightCurve = Edge
            End If
        End If
    Next 

    If thicknessLeftCurve IsNot Nothing AndAlso thicknessRightCurve IsNot Nothing Then
        ' Simplified average Y for text placement
        Dim dimPointT As Inventor.Point2d = tg.CreatePoint2d(rightView.Position.X + (rightView.Width / 2) + 2, (thicknessLeftCurve.Segments.Item(1).Geometry.StartPoint.Y + thicknessRightCurve.Segments.Item(1).Geometry.StartPoint.Y) / 2)
        
        Try
            oDims.AddLinear(thicknessLeftCurve, thicknessRightCurve, dimPointT, Inventor.DimensionTypeEnum.kHorizontalDimensionType) ' Horizontal in the right view
        Catch ex As Exception
            MessageBox.Show("Error adding thickness dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If 

' ===========================================
' Add chamfer dimensions
' ===========================================
For Each c As Inventor.DrawingCurve In chamferCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then ' Ensure it's a line segment
        Try
            ' Chamfer dimensions often take the DrawingCurve directly.
            Dim chamferPoint As Inventor.Point2d = tg.CreatePoint2d(c.Segments.Item(1).Geometry.StartPoint.X + 2, c.Segments.Item(1).Geometry.StartPoint.Y + 2)
            oSheet.DrawingDimensions.ChamferDimensions.Add(c, chamferPoint)
        Catch ex As Exception
            MessageBox.Show("Error adding chamfer dimension for curve " & c.ToString() & ": " & ex.Message, "Chamfer Dimension Error")
        End Try
    End If
Next

' ===========================================
' Add radial dimensions for holes
' ===========================================
For Each c As Inventor.DrawingCurve In circleCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.Circle2d Then
        Try
            Dim circleGeom As Inventor.Circle2d = c.Segments.Item(1).Geometry
            Dim holePoint As Inventor.Point2d = tg.CreatePoint2d(circleGeom.Center.X + circleGeom.Radius + 1, circleGeom.Center.Y + circleGeom.Radius + 1)
            oSheet.DrawingDimensions.RadialDimensions.Add(c, holePoint)
        Catch ex As Exception
            MessageBox.Show("Error adding radial dimension for circle " & c.ToString() & ": " & ex.Message, "Radial Dimension Error")
        End Try
    End If
Next

' ===========================================
' Update Title Block
' ===========================================
Dim oTitleBlock As Inventor.TitleBlock = Nothing
Try
    If oSheet.TitleBlock IsNot Nothing Then
        oTitleBlock = oSheet.TitleBlock
        oTitleBlock.SetPromptResultText("TITLE", "PLATE AUTOMATION")
        oTitleBlock.SetPromptResultText("DRAWN BY", System.Environment.UserName)
        oTitleBlock.SetPromptResultText("DATE", Now.ToShortDateString)
    Else
        MessageBox.Show("No title block found on the sheet.", "Title Block Warning")
    End If
Catch ex As Exception
    MessageBox.Show("Error updating title block: " & ex.Message, "Title Block Error")
End Try

' ===========================================
' Export to PDF & DWG
' ===========================================
Dim path As String = System.IO.Path.GetDirectoryName(oDoc.FullFileName)
Dim nameOnly As String = System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName)

Dim pdfName As String = System.IO.Path.Combine(path, nameOnly & ".pdf")
Dim pdfAddIn As Inventor.TranslatorAddIn = ThisApplication.ApplicationAddIns.ItemById("{0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4}") ' PDF Translator Add-In ID
Dim pdfContext As Inventor.TranslationContext = ThisApplication.TransientObjects.CreateTranslationContext()
Dim pdfOptions As Inventor.NameValueMap = ThisApplication.TransientObjects.CreateNameValueMap()
pdfContext.Type = Inventor.IOMechanismEnum.kFileBrowseIOMechanism
If pdfAddIn.HasSaveCopyAsOptions(oDrawingDoc, pdfContext, pdfOptions) Then
    pdfOptions.Value("Sheet_Range") = Inventor.PrintRangeEnum.kPrintAllSheets
End If
Dim pdfData As Inventor.DataMedium = ThisApplication.TransientObjects.CreateDataMedium()
pdfData.FileName = pdfName
Try
    pdfAddIn.SaveCopyAs(oDrawingDoc, pdfContext, pdfOptions, pdfData)
Catch ex As Exception
    MessageBox.Show("Error exporting to PDF: " & ex.Message, "Export Error")
End Try


Dim dwgName As String = System.IO.Path.Combine(path, nameOnly & ".dwg")
Try
    oDrawingDoc.SaveAs(dwgName, False)
Catch ex As Exception
    MessageBox.Show("Error exporting to DWG: " & ex.Message, "Export Error")
End Try


ThisApplication.ActiveView.Fit
MessageBox.Show("Drawing created and exported to PDF and DWG at: " & path, "Success")

End Sub
```

#### Code Block 4

```vb
Imports System.Reflection

Sub Main()
Dim oDoc As Inventor.Document = ThisApplication.ActiveDocument
If oDoc.DocumentType <> Inventor.DocumentTypeEnum.kPartDocumentObject Then
    MessageBox.Show("Run this rule from a Part (.ipt) document.", "Error")
    Return
End If

' Create new drawing document
Dim oDrawingDoc As Inventor.DrawingDocument
' Use a specific template if you have one, otherwise default
' oDrawingDoc = ThisApplication.Documents.Add("C:\Users\Public\Documents\Autodesk\Inventor 202x\Templates\Metric\ISO.idw", True) ' Example for specific template
oDrawingDoc = ThisApplication.Documents.Add(Inventor.DocumentTypeEnum.kDrawingDocumentObject, _
    ThisApplication.FileManager.GetTemplateFile(Inventor.DocumentTypeEnum.kDrawingDocumentObject))

Dim oSheet As Inventor.Sheet = oDrawingDoc.Sheets.Item(1)
Dim tg As Inventor.TransientGeometry = ThisApplication.TransientGeometry

' Adjust scale as needed based on part size and sheet size
Dim scale As Double = 0.1 ' Start with a reasonable scale, you might need to adjust

' Define view positions on the sheet. These are arbitrary and need fine-tuning.
' Units are in cm for a default A3 sheet (e.g., ISO.idw)
Dim basePoint As Inventor.Point2d = tg.CreatePoint2d(10, 20) ' Front view
Dim projRight As Inventor.Point2d = tg.CreatePoint2d(25, 20) ' Right view
Dim projIso As Inventor.Point2d = tg.CreatePoint2d(35, 25) ' Isometric view

Dim baseView As Inventor.DrawingView
Try
    baseView = oSheet.DrawingViews.AddBaseView(oDoc, basePoint, scale, _
        Inventor.ViewOrientationTypeEnum.kFrontViewOrientation, Inventor.DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding base view: " & ex.Message, "View Creation Error")
    Return ' Exit if base view cannot be added
End Try

Dim rightView As Inventor.DrawingView
Try
    rightView = oSheet.DrawingViews.AddProjectedView(baseView, projRight, Inventor.DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding right view: " & ex.Message, "View Creation Error")
End Try

Dim isoView As Inventor.DrawingView
Try
    isoView = oSheet.DrawingViews.AddProjectedView(baseView, projIso, Inventor.DrawingViewStyleEnum.kShadedDrawingViewStyle)
Catch ex As Exception
    MessageBox.Show("Error adding isometric view: " & ex.Message, "View Creation Error")
End Try


' ===========================================
' Collect edges and points for dimensioning from the base view
' ===========================================
Dim oCurves As Inventor.DrawingCurvesEnumerator = baseView.DrawingCurves
Dim horizontalEdges As New List(Of Inventor.DrawingCurve) ' Store curves directly
Dim verticalEdges As New List(Of Inventor.DrawingCurve)   ' Store curves directly
Dim chamferCurves As New List(Of Inventor.DrawingCurve)
Dim circleCurves As New List(Of Inventor.DrawingCurve)

For Each c As Inventor.DrawingCurve In oCurves
    If c.Segments.Count > 0 Then
        If TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = c.Segments.Item(1).Geometry
            Dim startPt As Inventor.Point2d = lineSeg.StartPoint
            Dim endPt As Inventor.Point2d = lineSeg.EndPoint

            If Math.Abs(startPt.Y - endPt.Y) < 0.01 Then ' Horizontal line
                horizontalEdges.Add(c)
            ElseIf Math.Abs(startPt.X - endPt.X) < 0.01 Then ' Vertical line
                verticalEdges.Add(c)
            Else ' Angled line, potential chamfer or other feature
                chamferCurves.Add(c)
            End If
        ElseIf c.Segments.Item(1).GeometryType = Inventor.Curve2dTypeEnum.kCircleCurve2d Then
            circleCurves.Add(c)
        End If
    End If
Next

Dim oDims As Inventor.GeneralDimensions = oSheet.DrawingDimensions.GeneralDimensions

' ===========================================
' Add overall horizontal dimension (length)
' ===========================================
If horizontalEdges.Count > 1 Then ' Need at least two edges for linear dimension
    Dim leftmostCurve As Inventor.DrawingCurve = Nothing
    Dim rightmostCurve As Inventor.DrawingCurve = Nothing
    Dim minX As Double = Double.MaxValue
    Dim maxX As Double = Double.MinValue
    
    For Each edge In horizontalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            ' Consider both start and end points to find the true min/max X of the entire edge set
            If lineSeg.StartPoint.X < minX Then
                minX = lineSeg.StartPoint.X
                leftmostCurve = Edge ' Store the curve associated with this point
            End If
            If lineSeg.EndPoint.X < minX Then
                minX = lineSeg.EndPoint.X
                leftmostCurve = Edge ' Store the curve associated with this point
            End If

            If lineSeg.StartPoint.X > maxX Then
                maxX = lineSeg.StartPoint.X
                rightmostCurve = Edge ' Store the curve associated with this point
            End If
            If lineSeg.EndPoint.X > maxX Then
                maxX = lineSeg.EndPoint.X
                rightmostCurve = Edge ' Store the curve associated with this point
            End If
        End If
    Next

    If leftmostCurve IsNot Nothing AndAlso rightmostCurve IsNot Nothing Then
        ' Calculate average Y of the two extreme points for text placement
        ' This is simplified, assuming the horizontal edges are roughly at the same Y
        ' Ensure the point for dim text origin is created in the sheet context
        Dim dimPointH As Inventor.Point2d = tg.CreatePoint2d((minX + maxX) / 2, baseView.Position.Y - (baseView.Height / 2) - 2)
        
        Try
            ' Use the overload that takes two DrawingCurve objects directly
            oDims.AddLinear(leftmostCurve, rightmostCurve, dimPointH, Inventor.DimensionTypeEnum.kHorizontalDimensionType)
        Catch ex As Exception
            MessageBox.Show("Error adding horizontal dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If

' ===========================================
' Add overall vertical dimension (width/height)
' ===========================================
If verticalEdges.Count > 1 Then
    Dim bottommostCurve As Inventor.DrawingCurve = Nothing
    Dim topmostCurve As Inventor.DrawingCurve = Nothing
    Dim minY As Double = Double.MaxValue
    Dim maxY As Double = Double.MinValue

    For Each edge In verticalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            If lineSeg.StartPoint.Y < minY Then
                minY = lineSeg.StartPoint.Y
                bottommostCurve = Edge
            End If
            If lineSeg.EndPoint.Y < minY Then
                minY = lineSeg.EndPoint.Y
                bottommostCurve = Edge
            End If

            If lineSeg.StartPoint.Y > maxY Then
                maxY = lineSeg.StartPoint.Y
                topmostCurve = Edge
            End If
            If lineSeg.EndPoint.Y > maxY Then
                maxY = lineSeg.EndPoint.Y
                topmostCurve = Edge
            End If
        End If
    Next

    If bottommostCurve IsNot Nothing AndAlso topmostCurve IsNot Nothing Then
        ' This is simplified, assuming the vertical edges are roughly at the same X
        ' Ensure the point for dim text origin is created in the sheet context
        Dim dimPointV As Inventor.Point2d = tg.CreatePoint2d(baseView.Position.X - (baseView.Width / 2) - 2, (minY + maxY) / 2)
        
        Try
            oDims.AddLinear(bottommostCurve, topmostCurve, dimPointV, Inventor.DimensionTypeEnum.kVerticalDimensionType)
        Catch ex As Exception
            MessageBox.Show("Error adding vertical dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If

' ===========================================
' Add thickness dimension (from the right view)
' ===========================================
' Thickness is represented by horizontal lines in the right view
Dim rightViewCurves As Inventor.DrawingCurvesEnumerator = rightView.DrawingCurves
Dim thicknessHorizontalEdges As New List(Of Inventor.DrawingCurve) 

For Each c As Inventor.DrawingCurve In rightViewCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
        Dim lineSeg As Inventor.LineSegment2d = c.Segments.Item(1).Geometry
        If Math.Abs(lineSeg.StartPoint.Y - lineSeg.EndPoint.Y) < 0.01 Then ' Horizontal line in right view
            thicknessHorizontalEdges.Add(c)
        End If
    End If
Next

If thicknessHorizontalEdges.Count > 1 Then
    Dim thicknessLeftCurve As Inventor.DrawingCurve = Nothing
    Dim thicknessRightCurve As Inventor.DrawingCurve = Nothing
    Dim thicknessMinX As Double = Double.MaxValue
    Dim thicknessMaxX As Double = Double.MinValue

    For Each edge As Inventor.DrawingCurve In thicknessHorizontalEdges
        If TypeOf Edge.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then
            Dim lineSeg As Inventor.LineSegment2d = Edge.Segments.Item(1).Geometry
            If lineSeg.StartPoint.X < thicknessMinX Then
                thicknessMinX = lineSeg.StartPoint.X
                thicknessLeftCurve = Edge
            End If
            If lineSeg.EndPoint.X < thicknessMinX Then
                thicknessMinX = lineSeg.EndPoint.X
                thicknessLeftCurve = Edge
            End If

            If lineSeg.StartPoint.X > thicknessMaxX Then
                thicknessMaxX = lineSeg.StartPoint.X
                thicknessRightCurve = Edge
            End If
            If lineSeg.EndPoint.X > thicknessMaxX Then
                thicknessMaxX = lineSeg.EndPoint.X
                thicknessRightCurve = Edge
            End If
        End If
    Next 

    If thicknessLeftCurve IsNot Nothing AndAlso thicknessRightCurve IsNot Nothing Then
        ' Simplified average Y for text placement
        Dim dimPointT As Inventor.Point2d = tg.CreatePoint2d(rightView.Position.X + (rightView.Width / 2) + 2, (thicknessLeftCurve.Segments.Item(1).Geometry.StartPoint.Y + thicknessRightCurve.Segments.Item(1).Geometry.StartPoint.Y) / 2)
        
        Try
            oDims.AddLinear(thicknessLeftCurve, thicknessRightCurve, dimPointT, Inventor.DimensionTypeEnum.kHorizontalDimensionType) ' Horizontal in the right view
        Catch ex As Exception
            MessageBox.Show("Error adding thickness dimension: " & ex.Message, "Dimension Error")
        End Try
    End If
End If 

' ===========================================
' Add chamfer dimensions
' ===========================================
For Each c As Inventor.DrawingCurve In chamferCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.LineSegment2d Then ' Ensure it's a line segment
        Try
            ' Chamfer dimensions often take the DrawingCurve directly.
            Dim chamferPoint As Inventor.Point2d = tg.CreatePoint2d(c.Segments.Item(1).Geometry.StartPoint.X + 2, c.Segments.Item(1).Geometry.StartPoint.Y + 2)
            oSheet.DrawingDimensions.ChamferDimensions.Add(c, chamferPoint)
        Catch ex As Exception
            MessageBox.Show("Error adding chamfer dimension for curve " & c.ToString() & ": " & ex.Message, "Chamfer Dimension Error")
        End Try
    End If
Next

' ===========================================
' Add radial dimensions for holes
' ===========================================
For Each c As Inventor.DrawingCurve In circleCurves
    If c.Segments.Count > 0 AndAlso TypeOf c.Segments.Item(1).Geometry Is Inventor.Circle2d Then
        Try
            Dim circleGeom As Inventor.Circle2d = c.Segments.Item(1).Geometry
            Dim holePoint As Inventor.Point2d = tg.CreatePoint2d(circleGeom.Center.X + circleGeom.Radius + 1, circleGeom.Center.Y + circleGeom.Radius + 1)
            oSheet.DrawingDimensions.RadialDimensions.Add(c, holePoint)
        Catch ex As Exception
            MessageBox.Show("Error adding radial dimension for circle " & c.ToString() & ": " & ex.Message, "Radial Dimension Error")
        End Try
    End If
Next

' ===========================================
' Update Title Block
' ===========================================
Dim oTitleBlock As Inventor.TitleBlock = Nothing
Try
    If oSheet.TitleBlock IsNot Nothing Then
        oTitleBlock = oSheet.TitleBlock
        oTitleBlock.SetPromptResultText("TITLE", "PLATE AUTOMATION")
        oTitleBlock.SetPromptResultText("DRAWN BY", System.Environment.UserName)
        oTitleBlock.SetPromptResultText("DATE", Now.ToShortDateString)
    Else
        MessageBox.Show("No title block found on the sheet.", "Title Block Warning")
    End If
Catch ex As Exception
    MessageBox.Show("Error updating title block: " & ex.Message, "Title Block Error")
End Try

' ===========================================
' Export to PDF & DWG
' ===========================================
Dim path As String = System.IO.Path.GetDirectoryName(oDoc.FullFileName)
Dim nameOnly As String = System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName)

Dim pdfName As String = System.IO.Path.Combine(path, nameOnly & ".pdf")
Dim pdfAddIn As Inventor.TranslatorAddIn = ThisApplication.ApplicationAddIns.ItemById("{0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4}") ' PDF Translator Add-In ID
Dim pdfContext As Inventor.TranslationContext = ThisApplication.TransientObjects.CreateTranslationContext()
Dim pdfOptions As Inventor.NameValueMap = ThisApplication.TransientObjects.CreateNameValueMap()
pdfContext.Type = Inventor.IOMechanismEnum.kFileBrowseIOMechanism
If pdfAddIn.HasSaveCopyAsOptions(oDrawingDoc, pdfContext, pdfOptions) Then
    pdfOptions.Value("Sheet_Range") = Inventor.PrintRangeEnum.kPrintAllSheets
End If
Dim pdfData As Inventor.DataMedium = ThisApplication.TransientObjects.CreateDataMedium()
pdfData.FileName = pdfName
Try
    pdfAddIn.SaveCopyAs(oDrawingDoc, pdfContext, pdfOptions, pdfData)
Catch ex As Exception
    MessageBox.Show("Error exporting to PDF: " & ex.Message, "Export Error")
End Try


Dim dwgName As String = System.IO.Path.Combine(path, nameOnly & ".dwg")
Try
    oDrawingDoc.SaveAs(dwgName, False)
Catch ex As Exception
    MessageBox.Show("Error exporting to DWG: " & ex.Message, "Export Error")
End Try


ThisApplication.ActiveView.Fit
MessageBox.Show("Drawing created and exported to PDF and DWG at: " & path, "Success")

End Sub
```

---

### 113. Unreserve legacy check out file with code?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/unreserve-legacy-check-out-file-with-code/td-p/12232593](https://forums.autodesk.com/t5/inventor-programming-forum/unreserve-legacy-check-out-file-with-code/td-p/12232593)

**Author:** Curtis_Waguespack

**Date:** ‎09-11-2023
	
		
		10:31 AM

**Description:** According to this knowledge article, we should be able to automate the "Stealing" of the checkout via code, just as we can manually, but we are seeing an error when attempting to do this: https://www.autodesk.com/support/technical/article/caas/sfdcarticles/sfdcarticles/Inventor-Files-are...   This i...

**Code Snippets (1):**

#### Code Block 1

```vb
Sub Main removeCheckOutStatusSample()
    ' to remove the Check out status you need to activate a Shared Project
    ' then open documents and call below function, and then save the documents.
    Dim oDoc As Document
    For Each oDoc In ThisApplication.Documents
        removeCheckOutStatus (oDoc)
    Next
    ThisApplication.Documents.CloseAll (False)
End Sub
Sub removeCheckOutStatus(oDoc As Document)
    If oDoc.ReservedForWriteName <> "" Then
        oDoc.ReservedForWriteByMe = True
        oDoc.RevertReservedForWriteByMe
        Dim oSaveCmd As ControlDefinition
        oSaveCmd = ThisApplication.CommandManager.ControlDefinitions("AppFileSaveCmd")
        oSaveCmd.Execute
    End If
End Su
```

#### Code Block 2

```vb
Sub Main removeCheckOutStatusSample()
    ' to remove the Check out status you need to activate a Shared Project
    ' then open documents and call below function, and then save the documents.
    Dim oDoc As Document
    For Each oDoc In ThisApplication.Documents
        removeCheckOutStatus (oDoc)
    Next
    ThisApplication.Documents.CloseAll (False)
End Sub
Sub removeCheckOutStatus(oDoc As Document)
    If oDoc.ReservedForWriteName <> "" Then
        oDoc.ReservedForWriteByMe = True
        oDoc.RevertReservedForWriteByMe
        Dim oSaveCmd As ControlDefinition
        oSaveCmd = ThisApplication.CommandManager.ControlDefinitions("AppFileSaveCmd")
        oSaveCmd.Execute
    End If
End Su
```

#### Code Block 3

```vb
Sub Main removeCheckOutStatusSample()
    ' to remove the Check out status you need to activate a Shared Project
    ' then open documents and call below function, and then save the documents.
    Dim oDoc As Document
    For Each oDoc In ThisApplication.Documents
        removeCheckOutStatus (oDoc)
    Next
    ThisApplication.Documents.CloseAll (False)
End Sub
Sub removeCheckOutStatus(oDoc As Document)
    If oDoc.ReservedForWriteName <> "" Then
        oDoc.ReservedForWriteByMe = True
        oDoc.RevertReservedForWriteByMe
        Dim oSaveCmd As ControlDefinition
        oSaveCmd = ThisApplication.CommandManager.ControlDefinitions("AppFileSaveCmd")
        oSaveCmd.Execute
    End If
End Su
```

---

### 114. Update All Model States of ipt.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/update-all-model-states-of-ipt/td-p/13824102](https://forums.autodesk.com/t5/inventor-programming-forum/update-all-model-states-of-ipt/td-p/13824102)

**Author:** KaynePellegrino

**Date:** ‎09-24-2025
	
		
		10:32 AM

**Description:** I'm making a part that has hundreds of model states. I edit it via spreadsheet to make tens and hundreds of model states at once, save the spreadsheet and close it out, let the inventor part load the new model states, but then it shows I need to manually activate and local update every single model ...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim oDoc As Inventor.Document = ThisApplication.ActiveDocument
If oDoc Is Nothing Then Return
If (Not TypeOf oDoc Is AssemblyDocument) AndAlso (Not TypeOf oDoc Is PartDocument) Then Return
If oDoc.ComponentDefinition.IsModelStateMember Then
	oDoc = oDoc.ComponentDefinition.FactoryDocument
End If
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If (oMSs Is Nothing) OrElse (oMSs.Count < 2) Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate()
	Dim oFDoc As Inventor.Document = ThisApplication.ActiveDocument
	oFDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate()
```

#### Code Block 2

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	If oMSDoc Is Nothing Then Continue For
	oMSDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

---

### 115. Update Inventor internal naming of components

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/update-inventor-internal-naming-of-components/td-p/13741230](https://forums.autodesk.com/t5/inventor-programming-forum/update-inventor-internal-naming-of-components/td-p/13741230)

**Author:** jnowel

**Date:** ‎07-26-2025
	
		
		11:07 AM

**Description:** I am a bit stumped on this issue (I think it should be fairly simple)How to I make Inventor recognize the updated filenames of the components?(see sample zip file) /////////////////////////Scenario: 1. First Save filenames:Assembly1.iamPART1.iptPart2.iptPaRt3.ipt 2. Corrected the filenames to "prope...

**Code Snippets (6):**

#### Code Block 1

```vb
For Each oRefDoc As Document In ThisDoc.Document.AllReferencedDocuments
	Logger.Info("")
	Logger.Info(oRefDoc.FullDocumentName)
	Logger.Info(oRefDoc.FullFileName)
	Logger.Info(oRefDoc.File.FullFileName)
Next
```

#### Code Block 2

```vb
For Each oRefDoc As Document In ThisDoc.Document.AllReferencedDocuments
	Logger.Info("")
	Logger.Info(oRefDoc.FullDocumentName)
	Logger.Info(oRefDoc.FullFileName)
	Logger.Info(oRefDoc.File.FullFileName)
Next
```

#### Code Block 3

```vb
For Each oRefDoc As Document In ThisDoc.Document.AllReferencedDocuments
	oRefDoc.Dirty = True
	oRefDoc.Save
Next
```

#### Code Block 4

```vb
For Each oRefDoc As Document In ThisDoc.Document.AllReferencedDocuments
	oRefDoc.Dirty = True
	oRefDoc.Save
Next
```

#### Code Block 5

```vb
INFO|
INFO|X:\_Projects\Part3.ipt
INFO|X:\_Projects\PaRt3.ipt
INFO|X:\_Projects\PaRt3.ipt
```

#### Code Block 6

```vb
INFO|
INFO|X:\_Projects\Part3.ipt
INFO|X:\_Projects\PaRt3.ipt
INFO|X:\_Projects\PaRt3.ipt
```

---

### 116. Update all Model States at Once

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/update-all-model-states-at-once/td-p/13824229#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/update-all-model-states-at-once/td-p/13824229#messageview_0)

**Author:** KaynePellegrino

**Date:** ‎09-24-2025
	
		
		12:10 PM

**Description:** I'm making a part that has hundreds of model states. I edit it via spreadsheet to make tens and hundreds of model states at once, save the spreadsheet and close it out, let the inventor part load the new model states, but then it shows I need to manually activate and local update every single model ...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim oDoc As Inventor.Document = ThisApplication.ActiveDocument
If oDoc Is Nothing Then Return
If (Not TypeOf oDoc Is AssemblyDocument) AndAlso (Not TypeOf oDoc Is PartDocument) Then Return
If oDoc.ComponentDefinition.IsModelStateMember Then
	oDoc = oDoc.ComponentDefinition.FactoryDocument
End If
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If (oMSs Is Nothing) OrElse (oMSs.Count < 2) Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate()
	Dim oFDoc As Inventor.Document = ThisApplication.ActiveDocument
	oFDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate()
```

#### Code Block 2

```vb
Dim oDoc As Inventor.Document = ThisApplication.ActiveDocument
If oDoc Is Nothing Then Return
If (Not TypeOf oDoc Is AssemblyDocument) AndAlso (Not TypeOf oDoc Is PartDocument) Then Return
If oDoc.ComponentDefinition.IsModelStateMember Then
	oDoc = oDoc.ComponentDefinition.FactoryDocument
End If
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If (oMSs Is Nothing) OrElse (oMSs.Count < 2) Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate()
	Dim oFDoc As Inventor.Document = ThisApplication.ActiveDocument
	oFDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate()
```

#### Code Block 3

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	If oMSDoc Is Nothing Then Continue For
	oMSDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

#### Code Block 4

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	If oMSDoc Is Nothing Then Continue For
	oMSDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

#### Code Block 5

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Logger.Info(oMS.Name)
	'Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	'If oMSDoc Is Nothing Then Continue For
	Logger.Info("Update")
	oDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

#### Code Block 6

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Logger.Info(oMS.Name)
	'Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	'If oMSDoc Is Nothing Then Continue For
	Logger.Info("Update")
	oDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

#### Code Block 7

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Logger.Info(oMS.Name)
	'Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	'If oMSDoc Is Nothing Then Continue For
	Logger.Info("Update")
	oDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

#### Code Block 8

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Logger.Info(oMS.Name)
	'Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	'If oMSDoc Is Nothing Then Continue For
	Logger.Info("Update")
	oDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

---

### 117. Use Geometry Intent to place a balloon

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/use-geometry-intent-to-place-a-balloon/td-p/13724650#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/use-geometry-intent-to-place-a-balloon/td-p/13724650#messageview_0)

**Author:** chris_davis

**Date:** ‎07-14-2025
	
		
		01:46 PM

**Description:** Hello, I'm trying to place a balloon in a drawing view and have the balloon at a certain location.  I can get the balloon placed but it is not where I would like it.  In line 140  I'm trying to  get a work point that I created called Balloon Point 2 and get my balloon to be at that location. I belie...

**Code Snippets (6):**

#### Code Block 1

```vb
Dim Sheet_1 = ThisDrawing.Sheets.ItemByName("Samenstelling_Enkel:1")
Dim VIEW1 = Sheet_1.DrawingViews.ItemByName("FrontView")

Dim oInt = VIEW1.GetIntent("THE PART", "Face0" , intent := PointIntentEnum.kMidPointIntent)

Dim WPt = VIEW1.GetIntent("test").PointOnSheet
WPt2  = ThisDrawing.Geometry.Point2d(WPt.X *.3937, WPt.Y*.3937)

Dim balloon1 = Sheet_1.Balloons.Add("Balloon1", {WPt2}, oInt)
```

#### Code Block 2

```vb
Dim Sheet_1 = ThisDrawing.Sheets.ItemByName("Sheet:1")
Dim VIEW1 = Sheet_1.DrawingViews.ItemByName("VIEW1")

Dim Edge0 = VIEW1.GetIntent("Frame Base:1", "Edge0" , intent := PointIntentEnum.kMidPointIntent)

Dim WPt1 = VIEW1.GetIntent("Work Point3").PointOnSheet
WPt3  = ThisDrawing.Geometry.Point2d(WPt1.X * 10, WPt1.Y * 10)
Dim WPt2 = VIEW1.GetIntent("Work Point4").PointOnSheet
WPt4  = ThisDrawing.Geometry.Point2d(WPt2.X * 10 , WPt2.Y * 10)

Dim balloon1 = Sheet_1.Balloons.Add("Balloon1", {WPt4, WPt3}, Edge0)
```

#### Code Block 3

```vb
Dim Sheet_1 = ThisDrawing.Sheets.ItemByName("Sheet:1")
Dim VIEW1 = Sheet_1.DrawingViews.ItemByName("VIEW1")

Dim WPt3 = VIEW1.GetIntent("Work Point2").PointOnSheet
WPt4  = ThisDrawing.Geometry.Point2d(WPt3.X * 10, WPt3.Y * 10)

Dim WPt = VIEW1.GetIntent("Work Point3").PointOnSheet
WPt2  = ThisDrawing.Geometry.Point2d(WPt.X * 10, WPt.Y * 10)

Dim balloon1 = Sheet_1.Balloons.Add("Balloon1", {WPt2}, {WPt4})
```

#### Code Block 4

```vb
Dim Sheet_1 = ThisDrawing.Sheets.ItemByName("Sheet:1")
Dim VIEW1 = Sheet_1.DrawingViews.ItemByName("VIEW1")

Dim oInt = VIEW1.GetIntent("FlyWheel", "Pie Face2" , intent := PointIntentEnum.kMidPointIntent)

Dim WPt = VIEW1.GetIntent( "Work Point1").PointOnSheet
WPt2  = ThisDrawing.Geometry.Point2d(WPt.X *.3937, WPt.Y*.3937)

Dim balloon1 = Sheet_1.Balloons.Add("Balloon1", {WPt2}, oInt)
```

#### Code Block 5

```vb
WPt2  = ThisDrawing.Geometry.Point2d(WPt.X * 10, WPt.Y * 10)
```

#### Code Block 6

```vb
WPt2  = ThisDrawing.Geometry.Point2d(WPt.X , WPt.Y)
```

---

### 118. Using Named Entities to Automate Dimension using Inventor API.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/using-named-entities-to-automate-dimension-using-inventor-api/td-p/13728989](https://forums.autodesk.com/t5/inventor-programming-forum/using-named-entities-to-automate-dimension-using-inventor-api/td-p/13728989)

**Author:** basavaraj.bFBQWV

**Date:** ‎07-17-2025
	
		
		05:18 AM

**Description:** Hello Developers,I’ve recently started working with iLogic and the Inventor API, and I’m currently trying to automate the process of adding drawing dimensions and annotations using named entities—specifically Faces, Edges, and Vertices.However, I’m facing issues getting the code to work as expected....

**Code Snippets (6):**

#### Code Block 1

```vb
Dim Sheet_1 = ThisDrawing.Sheets.ItemByName("Sheet:1")
Dim VIEW1 = Sheet_1.DrawingViews.ItemByName("VIEW1")

Dim namedGeometry1 = VIEW1.GetIntent("BackFace")
Dim namedGeometry2 = VIEW1.GetIntent("FrontFace")

Dim genDims = Sheet_1.DrawingDimensions.GeneralDimensions

ThisDrawing.BeginManage()
If True Then 
	Dim linDim1 = genDims.AddLinear("Dimension 1", VIEW1.SheetPoint(1.1, 0.5), namedGeometry1)
	Dim linDim2 = genDims.AddLinear("Dimension 2", VIEW1.SheetPoint(-0.1, 0.5), namedGeometry2)
	Dim linDim3 = genDims.AddLinear("Dimension 3", VIEW1.SheetPoint(0.5, 1.2), namedGeometry1, namedGeometry2)
End If
ThisDrawing.EndManage()
```

#### Code Block 2

```vb
Dim Sheet_1 = ThisDrawing.Sheets.ItemByName("Sheet:1")
Dim VIEW1 = Sheet_1.DrawingViews.ItemByName("VIEW1")

Dim namedGeometry1 = VIEW1.GetIntent("BackFace")
Dim namedGeometry2 = VIEW1.GetIntent("FrontFace")

Dim genDims = Sheet_1.DrawingDimensions.GeneralDimensions

ThisDrawing.BeginManage()
If True Then 
	Dim linDim1 = genDims.AddLinear("Dimension 1", VIEW1.SheetPoint(1.1, 0.5), namedGeometry1)
	Dim linDim2 = genDims.AddLinear("Dimension 2", VIEW1.SheetPoint(-0.1, 0.5), namedGeometry2)
	Dim linDim3 = genDims.AddLinear("Dimension 3", VIEW1.SheetPoint(0.5, 1.2), namedGeometry1, namedGeometry2)
End If
ThisDrawing.EndManage()
```

#### Code Block 3

```vb
Dim doc = ThisApplication.ActiveDocument
Dim osheet = doc.ActiveSheet
Dim oview = osheet.DrawingViews.Item(1)

' Get the referenced document from the drawing view
Dim refDoc
Try
	refDoc = oview.ReferencedDocumentDescriptor.ReferencedDocument
Catch ex As Exception
	MessageBox.Show("Unable to get referenced document: " & ex.Message)
	Return
End Try

If refDoc Is Nothing Then
	MessageBox.Show("Referenced document not available.")
	Return
End If

' Get named entities from the referenced document
Dim namedEntities
Try
	namedEntities = iLogicVb.Automation.GetNamedEntities(refDoc)
Catch ex As Exception
	MessageBox.Show("Failed to get named entities: " & ex.Message)
	Return
End Try

' Find named entities
Dim ent1 = namedEntities.FindEntity("BottomEdge")
Dim ent2 = namedEntities.FindEntity("TopEdge")

If ent1 Is Nothing Or ent2 Is Nothing Then
	MessageBox.Show("Named entity 'BottomEdge' or 'TopEdge' not found.")
	Return
End If

' Create geometry intents for dimensioning
Dim wp1 = osheet.CreateGeometryIntent(ent1)
Dim wp2 = osheet.CreateGeometryIntent(ent2)

' Set position of dimension
Dim tg = ThisApplication.TransientGeometry
Dim dimpos = tg.CreatePoint2d(oview.Position.X / 2, oview.Position.Y + 1)

' Add linear dimension
osheet.DrawingDimensions.GeneralDimensions.AddLinear(dimpos, wp1, wp2)
```

#### Code Block 4

```vb
Dim doc = ThisApplication.ActiveDocument
Dim osheet = doc.ActiveSheet
Dim oview = osheet.DrawingViews.Item(1)

' Get the referenced document from the drawing view
Dim refDoc
Try
	refDoc = oview.ReferencedDocumentDescriptor.ReferencedDocument
Catch ex As Exception
	MessageBox.Show("Unable to get referenced document: " & ex.Message)
	Return
End Try

If refDoc Is Nothing Then
	MessageBox.Show("Referenced document not available.")
	Return
End If

' Get named entities from the referenced document
Dim namedEntities
Try
	namedEntities = iLogicVb.Automation.GetNamedEntities(refDoc)
Catch ex As Exception
	MessageBox.Show("Failed to get named entities: " & ex.Message)
	Return
End Try

' Find named entities
Dim ent1 = namedEntities.FindEntity("BottomEdge")
Dim ent2 = namedEntities.FindEntity("TopEdge")

If ent1 Is Nothing Or ent2 Is Nothing Then
	MessageBox.Show("Named entity 'BottomEdge' or 'TopEdge' not found.")
	Return
End If

' Create geometry intents for dimensioning
Dim wp1 = osheet.CreateGeometryIntent(ent1)
Dim wp2 = osheet.CreateGeometryIntent(ent2)

' Set position of dimension
Dim tg = ThisApplication.TransientGeometry
Dim dimpos = tg.CreatePoint2d(oview.Position.X / 2, oview.Position.Y + 1)

' Add linear dimension
osheet.DrawingDimensions.GeneralDimensions.AddLinear(dimpos, wp1, wp2)
```

#### Code Block 5

```vb
Dim doc = ThisApplication.ActiveDocument
Dim osheet = doc.ActiveSheet
Dim oview = osheet.DrawingViews.Item(1)

' Get the referenced document from the drawing view
Dim refDoc
Try
	refDoc = oview.ReferencedDocumentDescriptor.ReferencedDocument
Catch ex As Exception
	MessageBox.Show("Unable to get referenced document: " & ex.Message)
	Return
End Try

If refDoc Is Nothing Then
	MessageBox.Show("Referenced document not available.")
	Return
End If

' Get named entities from the referenced document
Dim namedEntities
Try
	namedEntities = iLogicVb.Automation.GetNamedEntities(refDoc)
Catch ex As Exception
	MessageBox.Show("Failed to get named entities: " & ex.Message)
	Return
End Try

' Find named entities
Dim ent1 = namedEntities.FindEntity("BottomEdge")
Dim ent2 = namedEntities.FindEntity("TopEdge")

If ent1 Is Nothing Or ent2 Is Nothing Then
	MessageBox.Show("Named entity 'BottomEdge' or 'TopEdge' not found.")
	Return
End If

' Create geometry intents for dimensioning
Dim wp1 = osheet.CreateGeometryIntent(ent1)
Dim wp2 = osheet.CreateGeometryIntent(ent2)

' Set position of dimension
Dim tg = ThisApplication.TransientGeometry
Dim dimpos = tg.CreatePoint2d(oview.Position.X / 2, oview.Position.Y + 1)

' Add linear dimension
osheet.DrawingDimensions.GeneralDimensions.AddLinear(dimpos, wp1, wp2)
```

#### Code Block 6

```vb
Dim doc = ThisApplication.ActiveDocument
Dim osheet = doc.ActiveSheet
Dim oview = osheet.DrawingViews.Item(1)

' Get the referenced document from the drawing view
Dim refDoc
Try
	refDoc = oview.ReferencedDocumentDescriptor.ReferencedDocument
Catch ex As Exception
	MessageBox.Show("Unable to get referenced document: " & ex.Message)
	Return
End Try

If refDoc Is Nothing Then
	MessageBox.Show("Referenced document not available.")
	Return
End If

' Get named entities from the referenced document
Dim namedEntities
Try
	namedEntities = iLogicVb.Automation.GetNamedEntities(refDoc)
Catch ex As Exception
	MessageBox.Show("Failed to get named entities: " & ex.Message)
	Return
End Try

' Find named entities
Dim ent1 = namedEntities.FindEntity("BottomEdge")
Dim ent2 = namedEntities.FindEntity("TopEdge")

If ent1 Is Nothing Or ent2 Is Nothing Then
	MessageBox.Show("Named entity 'BottomEdge' or 'TopEdge' not found.")
	Return
End If

' Create geometry intents for dimensioning
Dim wp1 = osheet.CreateGeometryIntent(ent1)
Dim wp2 = osheet.CreateGeometryIntent(ent2)

' Set position of dimension
Dim tg = ThisApplication.TransientGeometry
Dim dimpos = tg.CreatePoint2d(oview.Position.X / 2, oview.Position.Y + 1)

' Add linear dimension
osheet.DrawingDimensions.GeneralDimensions.AddLinear(dimpos, wp1, wp2)
```

---

### 119. Utilizing MakePath in SelectSet.Select

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/utilizing-makepath-in-selectset-select/td-p/13835725](https://forums.autodesk.com/t5/inventor-programming-forum/utilizing-makepath-in-selectset-select/td-p/13835725)

**Author:** Anders_Olsen

**Date:** ‎10-03-2025
	
		
		02:33 AM

**Description:** I'm trying to feed a list of part numbers from an input to the SelectSet.Select-function, but I can't get it to work. This is what I have currently: oDoc.SelectSet.Select(Component.InventorComponent(MakePath("75430:2", "75424:1")))I've checked the MakePath-function in another context, so I know I'm ...

**Code Snippets (12):**

#### Code Block 1

```vb
Dim odoc As AssemblyDocument = ThisDoc.Document
Dim occ_proxy As ComponentOccurrenceProxy = odoc.ComponentDefinition.Occurrences.Item(2).SubOccurrences.Item(1)
odoc.SelectSet.Select(occ_proxy)
Logger.Info(odoc.SelectSet(1).name)
```

#### Code Block 2

```vb
Dim odoc As AssemblyDocument = ThisDoc.Document
Dim occ_proxy As ComponentOccurrenceProxy = odoc.ComponentDefinition.Occurrences.Item(2).SubOccurrences.Item(1)
odoc.SelectSet.Select(occ_proxy)
Logger.Info(odoc.SelectSet(1).name)
```

#### Code Block 3

```vb
Sub Main
	Dim oADoc As AssemblyDocument = TryCast(ThisApplication.ActiveDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then
		Logger.Debug("Rule named '" & iLogicVb.RuleName & "' did not run because no assembly obtained!")
		Return
	End If
	
	Dim oSS As Inventor.SelectSet = oADoc.SelectSet
	Dim oOccs As ComponentOccurrences = oADoc.ComponentDefinition.Occurrences
	Dim oAllRefDocs As DocumentsEnumerator = oADoc.AllReferencedDocuments
		
	Dim oListOfPNs As List(Of String)
	oListOfPNs.Add("75430")
	oListOfPNs.Add("75424")

	For Each sPN As String In oListOfPNs
		'get the referenced Document with this Part Number (or FileName)
		For Each oRefDoc As Inventor.Document In oAllRefDocs
			Dim sPartNumber As String = oRefDoc.PropertySets.Item(3).Item(2).Value
			If sPartNumber = sPN Then
				Dim oRefOccs As ComponentOccurrencesEnumerator = oOccs.AllReferencedOccurrences(oRefDoc)
				If (oRefOccs Is Nothing) OrElse (oRefOccs.Count = 0) Then Continue For
				For Each oRefOcc As Inventor.ComponentOccurrence In oOccs
					'If oRefOcc.Name.StartsWith(sPN) Then
					oSS.Select(oRefOcc)
					'<<< DO SOMETHING WITH IT >>>
				Next 'oRefOcc
			End If
		Next 'oRefDoc
	Next 'sPN
	oADoc.Update2(True)
End Sub
```

#### Code Block 4

```vb
Sub Main
	Dim oADoc As AssemblyDocument = TryCast(ThisApplication.ActiveDocument, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then
		Logger.Debug("Rule named '" & iLogicVb.RuleName & "' did not run because no assembly obtained!")
		Return
	End If
	
	Dim oSS As Inventor.SelectSet = oADoc.SelectSet
	Dim oOccs As ComponentOccurrences = oADoc.ComponentDefinition.Occurrences
	Dim oAllRefDocs As DocumentsEnumerator = oADoc.AllReferencedDocuments
		
	Dim oListOfPNs As List(Of String)
	oListOfPNs.Add("75430")
	oListOfPNs.Add("75424")

	For Each sPN As String In oListOfPNs
		'get the referenced Document with this Part Number (or FileName)
		For Each oRefDoc As Inventor.Document In oAllRefDocs
			Dim sPartNumber As String = oRefDoc.PropertySets.Item(3).Item(2).Value
			If sPartNumber = sPN Then
				Dim oRefOccs As ComponentOccurrencesEnumerator = oOccs.AllReferencedOccurrences(oRefDoc)
				If (oRefOccs Is Nothing) OrElse (oRefOccs.Count = 0) Then Continue For
				For Each oRefOcc As Inventor.ComponentOccurrence In oOccs
					'If oRefOcc.Name.StartsWith(sPN) Then
					oSS.Select(oRefOcc)
					'<<< DO SOMETHING WITH IT >>>
				Next 'oRefOcc
			End If
		Next 'oRefDoc
	Next 'sPN
	oADoc.Update2(True)
End Sub
```

#### Code Block 5

```vb
Sub Main
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then
		Logger.Debug("The iLogic rule named '" & iLogicVb.RuleName & "' exited, because no AssemblyDocument was obtained.")
		Exit Sub
	End If
	
	'gather input from the user
	Dim sPartNumbersToFind As String = InputBox("Input part numbers separated by comma", "Select components")
	'if nothing entered, or is empty, exit the rule
	If String.IsNullOrWhiteSpace(sPartNumbersToFind) Then Return
	'attempt to put values into List
	If sPartNumbersToFind.Contains(",") Then
		oPartNumbersToFind = sPartNumbersToFind.Split(","c).ToList()
	Else
		If (oPartNumbersToFind Is Nothing) Then oPartNumbersToFind = New List(Of String)
		oPartNumbersToFind.Add(sPartNumbersToFind)
	End If
	'get assembly occurrrences collection
	Dim oOccs As ComponentOccurrences = oADoc.ComponentDefinition.Occurrences
	'call custom Sub routine to recurse this assemblies components
	'True means maintain context with parent assemblies
	RecurseComponents(oOccs, True, AddressOf ProcessComponent)
	
	'share the resulting List(Of ComponentOccurrence) object to Inventor's session memory
	SharedVariable.Value("FoundComponentsList") = oPartNumbersToFind
	'a later rule can retrieve this by: 
	'Dim FoundOccsList As List(Of ComponentOccurrence) = SharedVariable.Value("FoundComponentsList")
	
	'optionally update this assembly
	'oADoc.Update2(True)
	'optionally save this assembly
	'If oADoc.Dirty Then oADoc.Save2(True)
End Sub

'<<< declare 'global' variables here >>>
Dim oPartNumbersToFind As List(Of String)
Dim oFoundOccs As List(Of Inventor.ComponentOccurrence)

'just for assembly component recursion process (no need to customize)
Sub RecurseComponents(oComps As ComponentOccurrences, _
	preserveContext As Boolean, _
	ComponentProcess As Action(Of ComponentOccurrence))
	'validate input collection
	If (oComps Is Nothing) OrElse (oComps.Count = 0) Then Return
	'start iterating input collection
	For Each oComp As ComponentOccurrence In oComps
		'call custom task to run on this instance
		ComponentProcess(oComp)
		'if this occurrence is suppressed, we can not iterate through its sub occurrences
		If oComp.Suppressed Then Continue For
		'if this occurrrence is not an assembly, we do not want to iterate its sub occurrences
		If Not oComp.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then Continue For
		'attempt to recurse down into its sub-components, if possible, and it has some
		If preserveContext Then
			'<<< edits (can be) constrained to context of 'parent' assembly >>>
			RecurseComponents(oComp.SubOccurrences, preserveContext, ComponentProcess)
		Else
			'<<< edit each component's definition &/or referenced file independently >>>
			RecurseComponents(oComp.Definition.Occurrences, preserveContext, ComponentProcess)
		End If
	Next 'oComp
End Sub

'what to do to/with each occurrence
Sub ProcessComponent(oComp As ComponentOccurrence)
	If (oComp Is Nothing) OrElse oComp.Suppressed Then Return
	'skip virtual components
	'If (TypeOf oComp.Definition Is VirtualComponentDefinition) Then Return
	'skip welds within weldment type assemblies
	'If (TypeOf oComp.Definition Is WeldsComponentDefinition) Then Return
	'get referenced Document
	Dim oCompDoc As Inventor.Document = Nothing
	Try : oCompDoc = oComp.Definition.Document : Catch : End Try
	If oCompDoc Is Nothing Then Return
	'get Part Number iProperty value
	Dim sPN As String = oCompDoc.PropertySets.Item(3).Item(2).Value
	'if Part Number value is empty, then skip this component
	If String.IsNullOrWhiteSpace(sPN) Then Return
	'if this is 'NOT' one of the Part Number values we are looking for, then skip it
	If Not oPartNumbersToFind.Contains(sPN) Then Return
	'initialize the List, if necessary
	If (oFoundOccs Is Nothing) Then oFoundOccs = New List(Of Inventor.ComponentOccurrence)
	'meeds our requirements, so add it to our List
	If Not oFoundOccs.Contains(oComp) Then oFoundOccs.Add(oComp)
End Sub
```

#### Code Block 6

```vb
Sub Main
	Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
	If oADoc Is Nothing Then
		Logger.Debug("The iLogic rule named '" & iLogicVb.RuleName & "' exited, because no AssemblyDocument was obtained.")
		Exit Sub
	End If
	
	'gather input from the user
	Dim sPartNumbersToFind As String = InputBox("Input part numbers separated by comma", "Select components")
	'if nothing entered, or is empty, exit the rule
	If String.IsNullOrWhiteSpace(sPartNumbersToFind) Then Return
	'attempt to put values into List
	If sPartNumbersToFind.Contains(",") Then
		oPartNumbersToFind = sPartNumbersToFind.Split(","c).ToList()
	Else
		If (oPartNumbersToFind Is Nothing) Then oPartNumbersToFind = New List(Of String)
		oPartNumbersToFind.Add(sPartNumbersToFind)
	End If
	'get assembly occurrrences collection
	Dim oOccs As ComponentOccurrences = oADoc.ComponentDefinition.Occurrences
	'call custom Sub routine to recurse this assemblies components
	'True means maintain context with parent assemblies
	RecurseComponents(oOccs, True, AddressOf ProcessComponent)
	
	'share the resulting List(Of ComponentOccurrence) object to Inventor's session memory
	SharedVariable.Value("FoundComponentsList") = oPartNumbersToFind
	'a later rule can retrieve this by: 
	'Dim FoundOccsList As List(Of ComponentOccurrence) = SharedVariable.Value("FoundComponentsList")
	
	'optionally update this assembly
	'oADoc.Update2(True)
	'optionally save this assembly
	'If oADoc.Dirty Then oADoc.Save2(True)
End Sub

'<<< declare 'global' variables here >>>
Dim oPartNumbersToFind As List(Of String)
Dim oFoundOccs As List(Of Inventor.ComponentOccurrence)

'just for assembly component recursion process (no need to customize)
Sub RecurseComponents(oComps As ComponentOccurrences, _
	preserveContext As Boolean, _
	ComponentProcess As Action(Of ComponentOccurrence))
	'validate input collection
	If (oComps Is Nothing) OrElse (oComps.Count = 0) Then Return
	'start iterating input collection
	For Each oComp As ComponentOccurrence In oComps
		'call custom task to run on this instance
		ComponentProcess(oComp)
		'if this occurrence is suppressed, we can not iterate through its sub occurrences
		If oComp.Suppressed Then Continue For
		'if this occurrrence is not an assembly, we do not want to iterate its sub occurrences
		If Not oComp.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then Continue For
		'attempt to recurse down into its sub-components, if possible, and it has some
		If preserveContext Then
			'<<< edits (can be) constrained to context of 'parent' assembly >>>
			RecurseComponents(oComp.SubOccurrences, preserveContext, ComponentProcess)
		Else
			'<<< edit each component's definition &/or referenced file independently >>>
			RecurseComponents(oComp.Definition.Occurrences, preserveContext, ComponentProcess)
		End If
	Next 'oComp
End Sub

'what to do to/with each occurrence
Sub ProcessComponent(oComp As ComponentOccurrence)
	If (oComp Is Nothing) OrElse oComp.Suppressed Then Return
	'skip virtual components
	'If (TypeOf oComp.Definition Is VirtualComponentDefinition) Then Return
	'skip welds within weldment type assemblies
	'If (TypeOf oComp.Definition Is WeldsComponentDefinition) Then Return
	'get referenced Document
	Dim oCompDoc As Inventor.Document = Nothing
	Try : oCompDoc = oComp.Definition.Document : Catch : End Try
	If oCompDoc Is Nothing Then Return
	'get Part Number iProperty value
	Dim sPN As String = oCompDoc.PropertySets.Item(3).Item(2).Value
	'if Part Number value is empty, then skip this component
	If String.IsNullOrWhiteSpace(sPN) Then Return
	'if this is 'NOT' one of the Part Number values we are looking for, then skip it
	If Not oPartNumbersToFind.Contains(sPN) Then Return
	'initialize the List, if necessary
	If (oFoundOccs Is Nothing) Then oFoundOccs = New List(Of Inventor.ComponentOccurrence)
	'meeds our requirements, so add it to our List
	If Not oFoundOccs.Contains(oComp) Then oFoundOccs.Add(oComp)
End Sub
```

#### Code Block 7

```vb
Sub Main
	oDoc = ThisDoc.Document
	
	Dim oComponentsString As String = InputBox("Input part numbers separated by comma", "Select components")
	
	oComponentsList = oComponentsString.Split(","c).ToList
	
	oObjCol = ThisApplication.TransientObjects.CreateObjectCollection
	assemblyRunner(oDoc)
	
	oDoc.SelectSet.SelectMultiple(oObjCol)
End Sub

Dim oDoc As AssemblyDocument
Dim oComponentsList As List(Of String)
Dim alreadyInList As Boolean
Dim occList As New List(Of ComponentOccurrence)
Dim oObjCol As ObjectCollection

Sub assemblyRunner(aDoc As AssemblyDocument)
	
	For Each oOcc In aDoc.ComponentDefinition.Occurrences
		Dim oOccDoc As Document = oOcc.Definition.Document
		Dim oPartNo As String = oOccDoc.PropertySets.Item(3).Item("Part Number").Value
		
		If oComponentsList.Contains(oPartNo) Then
			For Each comp In occList
				compPartNo = comp.Definition.Document.PropertySets.Item(3).Item("Part Number").Value
				If compPartNo = oPartNo Then
					alreadyOnList = True
					Exit For
				End If
			Next
			If alreadyOnList Then
				alreadyOnList = False
				Continue For
			Else
				occList.Add(oOcc)
				oObjCol.Add(oOcc)
			End If
		End If
		If oOccDoc.DocumentType = kAssemblyDocumentObject Then
			assemblyRunner(oOccDoc)
		End If
	Next
End Sub
```

#### Code Block 8

```vb
Sub Main
	oDoc = ThisDoc.Document
	
	Dim oComponentsString As String = InputBox("Input part numbers separated by comma", "Select components")
	
	oComponentsList = oComponentsString.Split(","c).ToList
	
	oObjCol = ThisApplication.TransientObjects.CreateObjectCollection
	assemblyRunner(oDoc)
	
	oDoc.SelectSet.SelectMultiple(oObjCol)
End Sub

Dim oDoc As AssemblyDocument
Dim oComponentsList As List(Of String)
Dim alreadyInList As Boolean
Dim occList As New List(Of ComponentOccurrence)
Dim oObjCol As ObjectCollection

Sub assemblyRunner(aDoc As AssemblyDocument)
	
	For Each oOcc In aDoc.ComponentDefinition.Occurrences
		Dim oOccDoc As Document = oOcc.Definition.Document
		Dim oPartNo As String = oOccDoc.PropertySets.Item(3).Item("Part Number").Value
		
		If oComponentsList.Contains(oPartNo) Then
			For Each comp In occList
				compPartNo = comp.Definition.Document.PropertySets.Item(3).Item("Part Number").Value
				If compPartNo = oPartNo Then
					alreadyOnList = True
					Exit For
				End If
			Next
			If alreadyOnList Then
				alreadyOnList = False
				Continue For
			Else
				occList.Add(oOcc)
				oObjCol.Add(oOcc)
			End If
		End If
		If oOccDoc.DocumentType = kAssemblyDocumentObject Then
			assemblyRunner(oOccDoc)
		End If
	Next
End Sub
```

#### Code Block 9

```vb
Sub Main
	oDoc = ThisDoc.Document
	
	Dim oComponentsString As String = InputBox("Input part numbers separated by comma", "Select components")
	
	oComponentsList = oComponentsString.Split(","c).ToList
	
	oObjCol = ThisApplication.TransientObjects.CreateObjectCollection
	assemblyRunner(oDoc)
	
	oDoc.SelectSet.SelectMultiple(oObjCol)
End Sub

Dim oDoc As AssemblyDocument
Dim oComponentsList As List(Of String)
Dim alreadyInList As Boolean
Dim occList As New List(Of ComponentOccurrence)
Dim oObjCol As ObjectCollection

Sub assemblyRunner(aDoc As AssemblyDocument)
	
	For Each oOcc In aDoc.ComponentDefinition.Occurrences
		Dim oOccDoc As Document = oOcc.Definition.Document
		Dim oPartNo As String = oOccDoc.PropertySets.Item(3).Item("Part Number").Value
		
		If oComponentsList.Contains(oPartNo) Then
			For Each comp In occList
				compPartNo = comp.Definition.Document.PropertySets.Item(3).Item("Part Number").Value
				If compPartNo = oPartNo Then
					alreadyOnList = True
					Exit For
				End If
			Next
			If alreadyOnList Then
				alreadyOnList = False
				Continue For
			Else
				occList.Add(oOcc)
				oObjCol.Add(oOcc)
			End If
		End If
		If oOccDoc.DocumentType = kAssemblyDocumentObject Then
			assemblyRunner(oOccDoc)
		End If
	Next
End Sub
```

#### Code Block 10

```vb
Sub Main
	oDoc = ThisDoc.Document
	
	Dim oComponentsString As String = InputBox("Input part numbers separated by comma", "Select components")
	
	oComponentsList = oComponentsString.Split(","c).ToList
	
	oObjCol = ThisApplication.TransientObjects.CreateObjectCollection
	assemblyRunner(oDoc)
	
	oDoc.SelectSet.SelectMultiple(oObjCol)
End Sub

Dim oDoc As AssemblyDocument
Dim oComponentsList As List(Of String)
Dim alreadyInList As Boolean
Dim occList As New List(Of ComponentOccurrence)
Dim oObjCol As ObjectCollection

Sub assemblyRunner(aDoc As AssemblyDocument)
	
	For Each oOcc In aDoc.ComponentDefinition.Occurrences
		Dim oOccDoc As Document = oOcc.Definition.Document
		Dim oPartNo As String = oOccDoc.PropertySets.Item(3).Item("Part Number").Value
		
		If oComponentsList.Contains(oPartNo) Then
			For Each comp In occList
				compPartNo = comp.Definition.Document.PropertySets.Item(3).Item("Part Number").Value
				If compPartNo = oPartNo Then
					alreadyOnList = True
					Exit For
				End If
			Next
			If alreadyOnList Then
				alreadyOnList = False
				Continue For
			Else
				occList.Add(oOcc)
				oObjCol.Add(oOcc)
			End If
		End If
		If oOccDoc.DocumentType = kAssemblyDocumentObject Then
			assemblyRunner(oOccDoc)
		End If
	Next
End Sub
```

#### Code Block 11

```vb
Sub Main
	oDoc = ThisDoc.Document
	
	Dim oComponentsString As String = InputBox("Insert part numbers, separated by comma", "Select components")
	
	oComponentsList = oComponentsString.Split(","c).ToList
	
	oObjCol = ThisApplication.TransientObjects.CreateObjectCollection
	
	' On the first level, run through all occurrences, and add those found in the list to the object collection
	firstLevelRunner(oDoc)
	
	oDoc.SelectSet.SelectMultiple(oObjCol)
End Sub

Dim oDoc As AssemblyDocument
Dim oComponentsList As List(Of String)
Dim alreadyOnList As Boolean
Dim aOcc As ComponentOccurrence
Dim oOccProxy As ComponentOccurrenceProxy
Dim oPartNo As String
Dim oObjCol As ObjectCollection

Sub firstLevelRunner(aDoc As AssemblyDocument)
	Dim aOccDoc As Document
	
	' Loop through all first level occurrences, ignoring those already found using the "alreadyOnList"-variable
	For Each aOcc As ComponentOccurrence In aDoc.ComponentDefinition.Occurrences
		aOccDoc = aOcc.Definition.Document
		oPartNo = aOccDoc.PropertySets.Item(3).Item("Part Number").Value
		
		If oComponentsList.Contains(oPartNo) Then
			For Each comp In oObjCol
				compPartNo = comp.Definition.Document.PropertySets.Item(3).Item("Part Number").Value
				If compPartNo = oPartNo Then
					alreadyOnList = True
					Exit For
				End If
			Next
			If alreadyOnList Then
				alreadyOnList = False
				Continue For
			Else
				oObjCol.Add(aOcc)
			End If
		End If
		
		' If the current occurence is an assembly, loop through its lower levels using occurrence proxies
		If aOccDoc.DocumentType = kAssemblyDocumentObject Then
			occRunner(aOcc)
		End If
	Next
End Sub

Sub occRunner(oOcc As ComponentOccurrence)
	Dim occProxyDoc As Document
	
	For Each occProxy As ComponentOccurrenceProxy In oOcc.SubOccurrences
		occProxyDoc = occProxy.Definition.Document
		oPartNo = occProxyDoc.PropertySets.Item(3).Item("Part Number").Value
		
		If oComponentsList.Contains(oPartNo) Then
			For Each comp In oObjCol
				compPartNo = comp.Definition.Document.PropertySets.Item(3).Item("Part Number").Value
				If compPartNo = oPartNo Then
					alreadyOnList = True
					Exit For
				End If
			Next
			If alreadyOnList Then
				alreadyOnList = False
				Continue For
			Else
				oObjCol.Add(occProxy)
			End If
		End If
		If occProxyDoc.DocumentType = kAssemblyDocumentObject Then
			occRunner(occProxy)
		End If
	Next
End Sub
```

#### Code Block 12

```vb
Sub Main
	oDoc = ThisDoc.Document
	
	Dim oComponentsString As String = InputBox("Insert part numbers, separated by comma", "Select components")
	
	oComponentsList = oComponentsString.Split(","c).ToList
	
	oObjCol = ThisApplication.TransientObjects.CreateObjectCollection
	
	' On the first level, run through all occurrences, and add those found in the list to the object collection
	firstLevelRunner(oDoc)
	
	oDoc.SelectSet.SelectMultiple(oObjCol)
End Sub

Dim oDoc As AssemblyDocument
Dim oComponentsList As List(Of String)
Dim alreadyOnList As Boolean
Dim aOcc As ComponentOccurrence
Dim oOccProxy As ComponentOccurrenceProxy
Dim oPartNo As String
Dim oObjCol As ObjectCollection

Sub firstLevelRunner(aDoc As AssemblyDocument)
	Dim aOccDoc As Document
	
	' Loop through all first level occurrences, ignoring those already found using the "alreadyOnList"-variable
	For Each aOcc As ComponentOccurrence In aDoc.ComponentDefinition.Occurrences
		aOccDoc = aOcc.Definition.Document
		oPartNo = aOccDoc.PropertySets.Item(3).Item("Part Number").Value
		
		If oComponentsList.Contains(oPartNo) Then
			For Each comp In oObjCol
				compPartNo = comp.Definition.Document.PropertySets.Item(3).Item("Part Number").Value
				If compPartNo = oPartNo Then
					alreadyOnList = True
					Exit For
				End If
			Next
			If alreadyOnList Then
				alreadyOnList = False
				Continue For
			Else
				oObjCol.Add(aOcc)
			End If
		End If
		
		' If the current occurence is an assembly, loop through its lower levels using occurrence proxies
		If aOccDoc.DocumentType = kAssemblyDocumentObject Then
			occRunner(aOcc)
		End If
	Next
End Sub

Sub occRunner(oOcc As ComponentOccurrence)
	Dim occProxyDoc As Document
	
	For Each occProxy As ComponentOccurrenceProxy In oOcc.SubOccurrences
		occProxyDoc = occProxy.Definition.Document
		oPartNo = occProxyDoc.PropertySets.Item(3).Item("Part Number").Value
		
		If oComponentsList.Contains(oPartNo) Then
			For Each comp In oObjCol
				compPartNo = comp.Definition.Document.PropertySets.Item(3).Item("Part Number").Value
				If compPartNo = oPartNo Then
					alreadyOnList = True
					Exit For
				End If
			Next
			If alreadyOnList Then
				alreadyOnList = False
				Continue For
			Else
				oObjCol.Add(occProxy)
			End If
		End If
		If occProxyDoc.DocumentType = kAssemblyDocumentObject Then
			occRunner(occProxy)
		End If
	Next
End Sub
```

#### Code Block 13

```vb
ThisAssembly.Document.ComponentDefinition.Occurrences("75430:2").Definition.Occurrences("75424:1")
```

#### Code Block 14

```vb
ThisAssembly.Document.ComponentDefinition.Occurrences("75430:2").Definition.Occurrences("75424:1")
```

#### Code Block 15

```vb
ThisAssembly.Document.ComponentDefinition.Occurrences("75430:2").Definition.Occurrences("75424:1")
```

#### Code Block 16

```vb
ThisAssembly.Document.ComponentDefinition.Occurrences("75430:2").Definition.Occurrences("75424:1")
```

#### Code Block 17

```vb
oDoc.SelectSet.Select(Component.InventorComponent("75430:2"))
```

#### Code Block 18

```vb
oDoc.SelectSet.Select(Component.InventorComponent("75430:2"))
```

#### Code Block 19

```vb
oDoc.SelectSet.Select(Component.InventorComponent("75430:2"))
```

#### Code Block 20

```vb
oDoc.SelectSet.Select(Component.InventorComponent("75430:2"))
```

#### Code Block 21

```vb
oDoc.SelectSet.Select(Component.InventorComponent(MakePath("75430:2", "75424:1")))
```

#### Code Block 22

```vb
oDoc.SelectSet.Select(Component.InventorComponent(MakePath("75430:2", "75424:1")))
```

#### Code Block 23

```vb
oDoc.SelectSet.Select(ThisAssembly.Document.ComponentDefinition.Occurrences.ItembyName("75430:2").Definition.Occurrences.ItembyName("75424:1"))
```

#### Code Block 24

```vb
oDoc.SelectSet.Select(ThisAssembly.Document.ComponentDefinition.Occurrences.ItembyName("75430:2").Definition.Occurrences.ItembyName("75424:1"))
```

---

### 120. VB API to add custom IProperties to BOM

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/vb-api-to-add-custom-iproperties-to-bom/td-p/13816604](https://forums.autodesk.com/t5/inventor-programming-forum/vb-api-to-add-custom-iproperties-to-bom/td-p/13816604)

**Author:** j.romoYDW7Q

**Date:** ‎09-18-2025
	
		
		10:36 AM

**Description:** Hello, I have a bit of an issue. I can't handle adding properties to the BOM columns on Parts Only. This is my error, and below is the code. Any hints or help is apreciated.  Private Sub btnAddCustomPropsToBOM_Click(sender As Object, e As EventArgs)       Try           Dim oDoc As AssemblyDocument =...

**Code Snippets (4):**

#### Code Block 1

```vb
Private Sub btnAddCustomPropsToBOM_Click(sender As Object, e As EventArgs)
      Try
          Dim oDoc As AssemblyDocument = TryCast(_inventorApp.ActiveDocument, AssemblyDocument)
          If oDoc Is Nothing Then
              MessageBox.Show("Active document is not an assembly.", "Error")
              Return
          End If

          Dim oBOM As BOM = oDoc.ComponentDefinition.BOM
          oBOM.PartsOnlyViewEnabled = True

          ' Ensure the "Parts Only" BOM view exists
          Dim oBOMView As BOMView = Nothing
          Try
              oBOMView = oBOM.BOMViews.Item("Parts Only")
          Catch
              MessageBox.Show("The 'Parts Only' BOM view is not available.", "Error")
              Return
          End Try

          ' List of standard custom iProperties to always add as BOM columns
          Dim standardProps As String() = {
              "Ancho", "Tipo_Parte", "Proveedor", "Nombre_Parte", "CostoLaser", "TestGithub"
          }

          Dim addedCount As Integer = 0
          Dim alreadyInBOM As New List(Of String)
          For Each propName In standardProps
              Try
                  oBOMView.BOMColumns.Add(2, propName) ' 2 = User Defined Property
                  addedCount += 1
              Catch ex As Exception
                  alreadyInBOM.Add(propName)
              End Try
          Next

          Dim msg As String = $"Added {addedCount} custom iProperties to the BOM."
          If alreadyInBOM.Count > 0 Then
              msg &= vbCrLf & "Already present or could not be added: " & String.Join(", ", alreadyInBOM)
          End If
          MessageBox.Show(msg, "Result")
      Catch ex As Exception
          MessageBox.Show("Error adding custom iProperties to BOM: " & ex.Message)
      End Try
  End Sub
```

#### Code Block 2

```vb
Private Sub btnAddCustomPropsToBOM_Click(sender As Object, e As EventArgs)
      Try
          Dim oDoc As AssemblyDocument = TryCast(_inventorApp.ActiveDocument, AssemblyDocument)
          If oDoc Is Nothing Then
              MessageBox.Show("Active document is not an assembly.", "Error")
              Return
          End If

          Dim oBOM As BOM = oDoc.ComponentDefinition.BOM
          oBOM.PartsOnlyViewEnabled = True

          ' Ensure the "Parts Only" BOM view exists
          Dim oBOMView As BOMView = Nothing
          Try
              oBOMView = oBOM.BOMViews.Item("Parts Only")
          Catch
              MessageBox.Show("The 'Parts Only' BOM view is not available.", "Error")
              Return
          End Try

          ' List of standard custom iProperties to always add as BOM columns
          Dim standardProps As String() = {
              "Ancho", "Tipo_Parte", "Proveedor", "Nombre_Parte", "CostoLaser", "TestGithub"
          }

          Dim addedCount As Integer = 0
          Dim alreadyInBOM As New List(Of String)
          For Each propName In standardProps
              Try
                  oBOMView.BOMColumns.Add(2, propName) ' 2 = User Defined Property
                  addedCount += 1
              Catch ex As Exception
                  alreadyInBOM.Add(propName)
              End Try
          Next

          Dim msg As String = $"Added {addedCount} custom iProperties to the BOM."
          If alreadyInBOM.Count > 0 Then
              msg &= vbCrLf & "Already present or could not be added: " & String.Join(", ", alreadyInBOM)
          End If
          MessageBox.Show(msg, "Result")
      Catch ex As Exception
          MessageBox.Show("Error adding custom iProperties to BOM: " & ex.Message)
      End Try
  End Sub
```

#### Code Block 3

```vb
Private Sub btnAddCustomPropsToBOM_Click(sender As Object, e As EventArgs)
      Try
          Dim oDoc As AssemblyDocument = TryCast(_inventorApp.ActiveDocument, AssemblyDocument)
          If oDoc Is Nothing Then
              MessageBox.Show("Active document is not an assembly.", "Error")
              Return
          End If

          Dim oBOM As BOM = oDoc.ComponentDefinition.BOM
          oBOM.PartsOnlyViewEnabled = True

          ' Ensure the "Parts Only" BOM view exists
          Dim oBOMView As BOMView = Nothing
          Try
              oBOMView = oBOM.BOMViews.Item("Parts Only")
          Catch
              MessageBox.Show("The 'Parts Only' BOM view is not available.", "Error")
              Return
          End Try

          ' List of standard custom iProperties to always add as BOM columns
          Dim standardProps As String() = {
              "Ancho", "Tipo_Parte", "Proveedor", "Nombre_Parte", "CostoLaser", "TestGithub"
          }

          Dim addedCount As Integer = 0
          Dim alreadyInBOM As New List(Of String)
          For Each propName In standardProps
              Try
                  oBOMView.BOMColumns.Add(2, propName) ' 2 = User Defined Property
                  addedCount += 1
              Catch ex As Exception
                  alreadyInBOM.Add(propName)
              End Try
          Next

          Dim msg As String = $"Added {addedCount} custom iProperties to the BOM."
          If alreadyInBOM.Count > 0 Then
              msg &= vbCrLf & "Already present or could not be added: " & String.Join(", ", alreadyInBOM)
          End If
          MessageBox.Show(msg, "Result")
      Catch ex As Exception
          MessageBox.Show("Error adding custom iProperties to BOM: " & ex.Message)
      End Try
  End Sub
```

#### Code Block 4

```vb
Private Sub btnAddCustomPropsToBOM_Click(sender As Object, e As EventArgs)
      Try
          Dim oDoc As AssemblyDocument = TryCast(_inventorApp.ActiveDocument, AssemblyDocument)
          If oDoc Is Nothing Then
              MessageBox.Show("Active document is not an assembly.", "Error")
              Return
          End If

          Dim oBOM As BOM = oDoc.ComponentDefinition.BOM
          oBOM.PartsOnlyViewEnabled = True

          ' Ensure the "Parts Only" BOM view exists
          Dim oBOMView As BOMView = Nothing
          Try
              oBOMView = oBOM.BOMViews.Item("Parts Only")
          Catch
              MessageBox.Show("The 'Parts Only' BOM view is not available.", "Error")
              Return
          End Try

          ' List of standard custom iProperties to always add as BOM columns
          Dim standardProps As String() = {
              "Ancho", "Tipo_Parte", "Proveedor", "Nombre_Parte", "CostoLaser", "TestGithub"
          }

          Dim addedCount As Integer = 0
          Dim alreadyInBOM As New List(Of String)
          For Each propName In standardProps
              Try
                  oBOMView.BOMColumns.Add(2, propName) ' 2 = User Defined Property
                  addedCount += 1
              Catch ex As Exception
                  alreadyInBOM.Add(propName)
              End Try
          Next

          Dim msg As String = $"Added {addedCount} custom iProperties to the BOM."
          If alreadyInBOM.Count > 0 Then
              msg &= vbCrLf & "Already present or could not be added: " & String.Join(", ", alreadyInBOM)
          End If
          MessageBox.Show(msg, "Result")
      Catch ex As Exception
          MessageBox.Show("Error adding custom iProperties to BOM: " & ex.Message)
      End Try
  End Sub
```

#### Code Block 5

```vb
oBOMView.BOMColumns.Add(2, propName) ' 2 = User Defined Property
```

#### Code Block 6

```vb
oBOMView.BOMColumns.Add(2, propName) ' 2 = User Defined Property
```

#### Code Block 7

```vb
oBOMView.BOMColumns.Add(2, propName) ' 2 = User Defined Property
```

#### Code Block 8

```vb
oBOMView.BOMColumns.Add(2, propName) ' 2 = User Defined Property
```

---

### 121. View Identifier Modification Via iLogic - Parts List Properties

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/view-identifier-modification-via-ilogic-parts-list-properties/td-p/13758050#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/view-identifier-modification-via-ilogic-parts-list-properties/td-p/13758050#messageview_0)

**Author:** joe_love-gunn

**Date:** ‎08-07-2025
	
		
		06:38 AM

**Description:** Hi so I am testing a few things out in inventor iLogic and currently have developed a code to enable the view identifier on a drawing view and then modify the parameters being used in the view identifier. Currently I am attempting to see if I can link the "Panel ID" Custom property to the view ident...

**Code Snippets (1):**

#### Code Block 1

```vb
'start of ilogic code
Dim oDoc As DrawingDocument:  oDoc = ThisDoc.Document

oSheets = oDoc.Sheets

For Each occ As DrawingView In oDoc.ActiveSheet.DrawingViews
	'Reference to the drawing view from the 1st selected object
	Dim oView As DrawingView = TryCast(occ, DrawingView)
	
	If oView IsNot Nothing Then	
	
		oView.ShowLabel = True
		
			'format the model iproperties	
			oPanelID = "<StyleOverride Underline='True'><Property Document='model' PropertySet='Inventor User Defined Properties' Property='Panel ID' FormatID='{D5CDD505-2E9C-101B-9397-08002B2CF9AE}' PropertyID='28'>PANEL ID</Property></StyleOverride>"
			oQty = "<StyleOverride Underline='True'> - QTY: <Property Document='model' PropertySet='Parts List Properties' Property='QTY' FormatID='{Unknown}' PropertyID='1'>QTY</Property></StyleOverride>"

			'add the custom iproperties to the view label
			oView.Label.FormattedText = oPanelID & oQty 

	End If
Next

'end of ilogic code
```

#### Code Block 2

```vb
'start of ilogic code
Dim oDoc As DrawingDocument:  oDoc = ThisDoc.Document

oSheets = oDoc.Sheets

For Each occ As DrawingView In oDoc.ActiveSheet.DrawingViews
	'Reference to the drawing view from the 1st selected object
	Dim oView As DrawingView = TryCast(occ, DrawingView)
	
	If oView IsNot Nothing Then	
	
		oView.ShowLabel = True
		
			'format the model iproperties	
			oPanelID = "<StyleOverride Underline='True'><Property Document='model' PropertySet='Inventor User Defined Properties' Property='Panel ID' FormatID='{D5CDD505-2E9C-101B-9397-08002B2CF9AE}' PropertyID='28'>PANEL ID</Property></StyleOverride>"
			oQty = "<StyleOverride Underline='True'> - QTY: <Property Document='model' PropertySet='Parts List Properties' Property='QTY' FormatID='{Unknown}' PropertyID='1'>QTY</Property></StyleOverride>"

			'add the custom iproperties to the view label
			oView.Label.FormattedText = oPanelID & oQty 

	End If
Next

'end of ilogic code
```

---

### 122. What is good practice to build configurator?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/what-is-good-practice-to-build-configurator/td-p/13793903](https://forums.autodesk.com/t5/inventor-programming-forum/what-is-good-practice-to-build-configurator/td-p/13793903)

**Author:** m_rubach

**Date:** ‎09-02-2025
	
		
		09:56 PM

**Description:** Hello, I have been building a configurator of kitchen cabinets. I had never built a configurator before, so I'm not sure that I do it well. I will be thankful if someone can show the way how to do this right.Now I have a lot of parts in the assembly, and independent of which configuration I choose, ...

**Code Snippets (2):**

#### Code Block 1

```vb
oOcc.Visible = False
oOcc.BOMStructure = BOMStructureEnum.kReferenceBOMStructure
```

#### Code Block 2

```vb
oOcc.Visible = False
oOcc.BOMStructure = BOMStructureEnum.kReferenceBOMStructure
```

#### Code Block 3

```vb
oOcc.Visible = False
oOcc.BOMStructure = BOMStructureEnum.kReferenceBOMStructure
```

#### Code Block 4

```vb
oOcc.Visible = False
oOcc.BOMStructure = BOMStructureEnum.kReferenceBOMStructure
```

---

### 123. [iLogic/API] - Midpoint of dimension

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-api-midpoint-of-dimension/td-p/13819243](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-api-midpoint-of-dimension/td-p/13819243)

**Author:** Dai_Tech

**Date:** ‎09-20-2025
	
		
		10:47 PM

**Description:** Hello experts, I want to automatically insert Sketch Symbols at the midpoint of a dimension in a drawing using iLogic/API.However, I am facing a problem:The midpoint of a dimension does not seem to be accessible as a pickable or linkable entity.Using DimensionLine.StartPoint and EndPoint to compute ...

**Code Snippets (2):**

#### Code Block 1

```vb
' 1. Get the drawing document and active sheet
Dim oDoc As DrawingDocument = ThisDoc.Document
Dim oSheet As Sheet = oDoc.ActiveSheet

' 2. Prompt user to pick a dimension
Dim oDim As DrawingDimension = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingDimensionFilter, "Pick a Dimension")
If oDim Is Nothing Then Return

' 3. Get the midpoint of the dimension line
Dim oLine As LineSegment2d = oDim.DimensionLine
Dim midX As Double = (oLine.StartPoint.X + oLine.EndPoint.X) / 2
Dim midY As Double = (oLine.StartPoint.Y + oLine.EndPoint.Y) / 2

' 4. Define offset for symbol position (adjust as needed, units are usually cm or inches based on your template)
Dim offsetX As Double = 1.0  ' 1 cm to the right
Dim offsetY As Double = 0.5  ' 0.5 cm upward

' 5. Calculate the offset point for symbol insertion
Dim oOffsetPoint As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(midX + offsetX, midY + offsetY)

' 6. Get the sketched symbol definition name - replace with your actual symbol name
Dim symbolName As String = "AnynameofSketchsymbols"

' 7. Check if the sketched symbol exists in the document
Dim skDef As SketchedSymbolDefinition = Nothing
For Each def As SketchedSymbolDefinition In oDoc.SketchedSymbolDefinitions
    If def.Name = symbolName Then
        skDef = def
        Exit For
    End If
Next

If skDef Is Nothing Then
    MsgBox("Sketched symbol '" & symbolName & "' not found.", vbExclamation, "Error")
    Return
End If

' 8. Create geometry intent at the original dimension midpoint (no offset here)
Dim oGeometryIntent As GeometryIntent = oSheet.CreateGeometryIntent(oDim, ThisApplication.TransientGeometry.CreatePoint2d(midX, midY))

' 9. Prepare leader points: start at symbol offset point, end at geometry intent
Dim oLeaderPoints As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
oLeaderPoints.Add(oOffsetPoint)       ' Symbol insertion point (offset)
oLeaderPoints.Add(oGeometryIntent)    ' Leader target (dimension)

' 10. Prepare prompt strings for the symbol (empty if none)
Dim promptStrings() As String = {}

' 11. Add the sketched symbol with leader to the sheet
Dim skSymbol As SketchedSymbol = oSheet.SketchedSymbols.AddWithLeader(skDef, oLeaderPoints, 0, 1, promptStrings)
skSymbol.LeaderVisible = True
skSymbol.Static = True
```

#### Code Block 2

```vb
' 1. Get the drawing document and active sheet
Dim oDoc As DrawingDocument = ThisDoc.Document
Dim oSheet As Sheet = oDoc.ActiveSheet

' 2. Prompt user to pick a dimension
Dim oDim As DrawingDimension = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingDimensionFilter, "Pick a Dimension")
If oDim Is Nothing Then Return

' 3. Get the midpoint of the dimension line
Dim oLine As LineSegment2d = oDim.DimensionLine
Dim midX As Double = (oLine.StartPoint.X + oLine.EndPoint.X) / 2
Dim midY As Double = (oLine.StartPoint.Y + oLine.EndPoint.Y) / 2

' 4. Define offset for symbol position (adjust as needed, units are usually cm or inches based on your template)
Dim offsetX As Double = 1.0  ' 1 cm to the right
Dim offsetY As Double = 0.5  ' 0.5 cm upward

' 5. Calculate the offset point for symbol insertion
Dim oOffsetPoint As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(midX + offsetX, midY + offsetY)

' 6. Get the sketched symbol definition name - replace with your actual symbol name
Dim symbolName As String = "AnynameofSketchsymbols"

' 7. Check if the sketched symbol exists in the document
Dim skDef As SketchedSymbolDefinition = Nothing
For Each def As SketchedSymbolDefinition In oDoc.SketchedSymbolDefinitions
    If def.Name = symbolName Then
        skDef = def
        Exit For
    End If
Next

If skDef Is Nothing Then
    MsgBox("Sketched symbol '" & symbolName & "' not found.", vbExclamation, "Error")
    Return
End If

' 8. Create geometry intent at the original dimension midpoint (no offset here)
Dim oGeometryIntent As GeometryIntent = oSheet.CreateGeometryIntent(oDim, ThisApplication.TransientGeometry.CreatePoint2d(midX, midY))

' 9. Prepare leader points: start at symbol offset point, end at geometry intent
Dim oLeaderPoints As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
oLeaderPoints.Add(oOffsetPoint)       ' Symbol insertion point (offset)
oLeaderPoints.Add(oGeometryIntent)    ' Leader target (dimension)

' 10. Prepare prompt strings for the symbol (empty if none)
Dim promptStrings() As String = {}

' 11. Add the sketched symbol with leader to the sheet
Dim skSymbol As SketchedSymbol = oSheet.SketchedSymbols.AddWithLeader(skDef, oLeaderPoints, 0, 1, promptStrings)
skSymbol.LeaderVisible = True
skSymbol.Static = True
```

#### Code Block 3

```vb
Dim oDoc As DrawingDocument = ThisDoc.Document
Dim oSheet As Sheet = oDoc.ActiveSheet

' 1. Pick Dimension
Dim oDim As DrawingDimension
oDim = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingDimensionFilter, "Pick Dimension")
If oDim Is Nothing Then Return

' 2. Get Midpoint =Problem here (This is a temporary solution because it doesn’t maintain a link with the dimension)
Dim oLine As LineSegment2d = oDim.DimensionLine
Dim midX As Double = (oLine.StartPoint.X + oLine.EndPoint.X) / 2
Dim midY As Double = (oLine.StartPoint.Y + oLine.EndPoint.Y) / 2
Dim oMid As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(midX, midY)

' 3. Insert Sketch Symbol
Dim skDef As SketchedSymbolDefinition = oDoc.SketchedSymbolDefinitions.Item("AnynameofSketchsymbols")
oSheet.SketchedSymbols.Add(skDef, oMid, 0)
```

#### Code Block 4

```vb
Dim oDoc As DrawingDocument = ThisDoc.Document
Dim oSheet As Sheet = oDoc.ActiveSheet

' 1. Pick Dimension
Dim oDim As DrawingDimension
oDim = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingDimensionFilter, "Pick Dimension")
If oDim Is Nothing Then Return

' 2. Get Midpoint =Problem here (This is a temporary solution because it doesn’t maintain a link with the dimension)
Dim oLine As LineSegment2d = oDim.DimensionLine
Dim midX As Double = (oLine.StartPoint.X + oLine.EndPoint.X) / 2
Dim midY As Double = (oLine.StartPoint.Y + oLine.EndPoint.Y) / 2
Dim oMid As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(midX, midY)

' 3. Insert Sketch Symbol
Dim skDef As SketchedSymbolDefinition = oDoc.SketchedSymbolDefinitions.Item("AnynameofSketchsymbols")
oSheet.SketchedSymbols.Add(skDef, oMid, 0)
```

---

### 124. automate the creation of individual part drawings

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/automate-the-creation-of-individual-part-drawings/td-p/13755659](https://forums.autodesk.com/t5/inventor-programming-forum/automate-the-creation-of-individual-part-drawings/td-p/13755659)

**Author:** SergeyStenberg

**Date:** ‎08-05-2025
	
		
		11:45 PM

**Description:** Hi everyone,I’m looking to automate the creation of individual part drawings from an assembly in Autodesk Inventor using iLogic.The goal is to loop through all components in the assembly and generate a .dwg or .idw drawing for each part, using a standard drawing template. Ideally, each drawing shoul...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim oDoc As AssemblyDocument = ThisApplication.ActiveDocument

Dim fileTemplate As String = "C:\Path\To\Template.idw"

For Each oLeaf As ComponentOccurrence In oDoc.ComponentDefinition.Occurrences.AllLeafOccurrences
	
	
	Dim oDDoc1 As DrawingDocument = ThisApplication.Documents.Add(DocumentTypeEnum.kDrawingDocumentObject, fileTemplate, True)
	oDDoc1.Activate()
	
	Dim oSheet As Sheet = oDDoc1.Sheets.Item(1)
	
	Dim xPos As Double = oSheet.Width / 2 
	Dim yPos As Double = oSheet.Height / 2
	
	Dim oPartDoc As PartDocument = oLeaf.Definition.Document
	Dim oPos As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(xPos, yPos) 'adjust as needed
	Dim oScale As Double = 1 'full scale
	Dim oViewOrient As ViewOrientationTypeEnum = ViewOrientationTypeEnum.kFrontViewOrientation
	Dim oViewStyle As DrawingViewStyleEnum = DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle 'change as necessary
	
	Dim oView As DrawingView = oSheet.DrawingViews.AddBaseView(oPartDoc, oPos, oScale, oViewOrient, oViewStyle)
	
	Dim oTopViewPos As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(xPos, yPos + oView.Height*1.5) 'adjust as needed
	
	Dim oTopView As DrawingView = oSheet.DrawingViews.AddProjectedView(oView, oTopViewPos, oViewStyle)
	
	'auto-dimension
	
	oSheet.RetrieveAnnotations(oView)
	oSheet.RetrieveAnnotations(oTopView)
	
	'save as .idw, .dwg, .pdf
	
	Dim fileName As String = oPartDoc.DisplayName
	
	oDDoc1.SaveAs("C:\Path" & fileName & ".idw", False)
	
	Dim oFilePath As String = ThisDoc.Path
	Dim oFileName As String = ThisDoc.FileName
	
	Dim oSavePath As String = oFilePath & "\" & oFileName
	
	oDDoc1.SaveAs(oSavePath & ".pdf", True)
	oDDoc1.SaveAs(oSavePath & ".dwg", True)
	
Next
```

#### Code Block 2

```vb
Dim oDoc As AssemblyDocument = ThisApplication.ActiveDocument

Dim fileTemplate As String = "C:\Path\To\Template.idw"

For Each oLeaf As ComponentOccurrence In oDoc.ComponentDefinition.Occurrences.AllLeafOccurrences
	
	
	Dim oDDoc1 As DrawingDocument = ThisApplication.Documents.Add(DocumentTypeEnum.kDrawingDocumentObject, fileTemplate, True)
	oDDoc1.Activate()
	
	Dim oSheet As Sheet = oDDoc1.Sheets.Item(1)
	
	Dim xPos As Double = oSheet.Width / 2 
	Dim yPos As Double = oSheet.Height / 2
	
	Dim oPartDoc As PartDocument = oLeaf.Definition.Document
	Dim oPos As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(xPos, yPos) 'adjust as needed
	Dim oScale As Double = 1 'full scale
	Dim oViewOrient As ViewOrientationTypeEnum = ViewOrientationTypeEnum.kFrontViewOrientation
	Dim oViewStyle As DrawingViewStyleEnum = DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle 'change as necessary
	
	Dim oView As DrawingView = oSheet.DrawingViews.AddBaseView(oPartDoc, oPos, oScale, oViewOrient, oViewStyle)
	
	Dim oTopViewPos As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(xPos, yPos + oView.Height*1.5) 'adjust as needed
	
	Dim oTopView As DrawingView = oSheet.DrawingViews.AddProjectedView(oView, oTopViewPos, oViewStyle)
	
	'auto-dimension
	
	oSheet.RetrieveAnnotations(oView)
	oSheet.RetrieveAnnotations(oTopView)
	
	'save as .idw, .dwg, .pdf
	
	Dim fileName As String = oPartDoc.DisplayName
	
	oDDoc1.SaveAs("C:\Path" & fileName & ".idw", False)
	
	Dim oFilePath As String = ThisDoc.Path
	Dim oFileName As String = ThisDoc.FileName
	
	Dim oSavePath As String = oFilePath & "\" & oFileName
	
	oDDoc1.SaveAs(oSavePath & ".pdf", True)
	oDDoc1.SaveAs(oSavePath & ".dwg", True)
	
Next
```

#### Code Block 3

```vb
Dim oDoc As AssemblyDocument = ThisApplication.ActiveDocument

Dim fileTemplate As String = "C:\Path\To\Template.idw"

For Each oLeaf As ComponentOccurrence In oDoc.ComponentDefinition.Occurrences.AllLeafOccurrences
	
	
	Dim oDDoc1 As DrawingDocument = ThisApplication.Documents.Add(DocumentTypeEnum.kDrawingDocumentObject, fileTemplate, True)
	oDDoc1.Activate()
	
	Dim oSheet As Sheet = oDDoc1.Sheets.Item(1)
	
	Dim xPos As Double = oSheet.Width / 2 
	Dim yPos As Double = oSheet.Height / 2
	
	Dim oPartDoc As PartDocument = oLeaf.Definition.Document
	Dim oPos As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(xPos, yPos) 'adjust as needed
	Dim oScale As Double = 1 'full scale
	Dim oViewOrient As ViewOrientationTypeEnum = ViewOrientationTypeEnum.kFrontViewOrientation
	Dim oViewStyle As DrawingViewStyleEnum = DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle 'change as necessary
	
	Dim oView As DrawingView = oSheet.DrawingViews.AddBaseView(oPartDoc, oPos, oScale, oViewOrient, oViewStyle)
	
	Dim oTopViewPos As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(xPos, yPos + oView.Height*1.5) 'adjust as needed
	
	Dim oTopView As DrawingView = oSheet.DrawingViews.AddProjectedView(oView, oTopViewPos, oViewStyle)
	
	'auto-dimension
	
	oSheet.RetrieveAnnotations(oView)
	oSheet.RetrieveAnnotations(oTopView)
	
	'save as .idw, .dwg, .pdf
	
	Dim fileName As String = oPartDoc.DisplayName
	
	oDDoc1.SaveAs("C:\Path" & fileName & ".idw", False)
	
	Dim oFilePath As String = ThisDoc.Path
	Dim oFileName As String = ThisDoc.FileName
	
	Dim oSavePath As String = oFilePath & "\" & oFileName
	
	oDDoc1.SaveAs(oSavePath & ".pdf", True)
	oDDoc1.SaveAs(oSavePath & ".dwg", True)
	
Next
```

#### Code Block 4

```vb
Dim oDoc As AssemblyDocument = ThisApplication.ActiveDocument

Dim fileTemplate As String = "C:\Path\To\Template.idw"

For Each oLeaf As ComponentOccurrence In oDoc.ComponentDefinition.Occurrences.AllLeafOccurrences
	
	
	Dim oDDoc1 As DrawingDocument = ThisApplication.Documents.Add(DocumentTypeEnum.kDrawingDocumentObject, fileTemplate, True)
	oDDoc1.Activate()
	
	Dim oSheet As Sheet = oDDoc1.Sheets.Item(1)
	
	Dim xPos As Double = oSheet.Width / 2 
	Dim yPos As Double = oSheet.Height / 2
	
	Dim oPartDoc As PartDocument = oLeaf.Definition.Document
	Dim oPos As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(xPos, yPos) 'adjust as needed
	Dim oScale As Double = 1 'full scale
	Dim oViewOrient As ViewOrientationTypeEnum = ViewOrientationTypeEnum.kFrontViewOrientation
	Dim oViewStyle As DrawingViewStyleEnum = DrawingViewStyleEnum.kHiddenLineRemovedDrawingViewStyle 'change as necessary
	
	Dim oView As DrawingView = oSheet.DrawingViews.AddBaseView(oPartDoc, oPos, oScale, oViewOrient, oViewStyle)
	
	Dim oTopViewPos As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(xPos, yPos + oView.Height*1.5) 'adjust as needed
	
	Dim oTopView As DrawingView = oSheet.DrawingViews.AddProjectedView(oView, oTopViewPos, oViewStyle)
	
	'auto-dimension
	
	oSheet.RetrieveAnnotations(oView)
	oSheet.RetrieveAnnotations(oTopView)
	
	'save as .idw, .dwg, .pdf
	
	Dim fileName As String = oPartDoc.DisplayName
	
	oDDoc1.SaveAs("C:\Path" & fileName & ".idw", False)
	
	Dim oFilePath As String = ThisDoc.Path
	Dim oFileName As String = ThisDoc.FileName
	
	Dim oSavePath As String = oFilePath & "\" & oFileName
	
	oDDoc1.SaveAs(oSavePath & ".pdf", True)
	oDDoc1.SaveAs(oSavePath & ".dwg", True)
	
Next
```

---

### 125. create a centerline by two points

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/create-a-centerline-by-two-points/td-p/12710357#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/create-a-centerline-by-two-points/td-p/12710357#messageview_0)

**Author:** breinkemeyer

**Date:** ‎04-15-2024
	
		
		12:50 PM

**Description:** Trying to add a centerline to a drawing view but it keeps failing at the centerlines.add method.  All I get is an ambiguous error message.  What am i missing? DrawingDocument oDoc = (DrawingDocument)oInventorApp.ActiveDocument;Sheet oSheet = oDoc.ActiveSheet;DrawingView oView = oSheet.DrawingViews[1...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim drawView As DrawingView = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select a drawing view")

Dim drawDoc As DrawingDocument= ThisApplication.ActiveDocument

Dim sketch1 As DrawingSketch = drawView.Sketches.Add   
sketch1.Edit

Dim startPt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(0,0)
startPt = drawView.SheetToDrawingViewSpace(startPt)

Dim endPt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(216*2.54,0)
endPt = drawView.SheetToDrawingViewSpace(endPt)

Dim oLine As SketchLine = sketch1.SketchLines.AddByTwoPoints(startPt, endPt)
Dim layers As LayersEnumerator = drawDoc.StylesManager.Layers
oLine.Layer = layers.Item("Centerline (ANSI)")
sketch1.ExitEdit
```

#### Code Block 2

```vb
Dim drawView As DrawingView = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select a drawing view")

Dim drawDoc As DrawingDocument= ThisApplication.ActiveDocument

Dim sketch1 As DrawingSketch = drawView.Sketches.Add   
sketch1.Edit

Dim startPt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(0,0)
startPt = drawView.SheetToDrawingViewSpace(startPt)

Dim endPt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(216*2.54,0)
endPt = drawView.SheetToDrawingViewSpace(endPt)

Dim oLine As SketchLine = sketch1.SketchLines.AddByTwoPoints(startPt, endPt)
Dim layers As LayersEnumerator = drawDoc.StylesManager.Layers
oLine.Layer = layers.Item("Centerline (ANSI)")
sketch1.ExitEdit
```

#### Code Block 3

```vb
Dim drawView As DrawingView = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select a drawing view")

Dim drawDoc As DrawingDocument= ThisApplication.ActiveDocument

Dim sketch1 As DrawingSketch = drawView.Sketches.Add   
sketch1.Edit

Dim startPt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(0,0)
startPt = drawView.SheetToDrawingViewSpace(startPt)

Dim endPt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(216*2.54,0)
endPt = drawView.SheetToDrawingViewSpace(endPt)

Dim oLine As SketchLine = sketch1.SketchLines.AddByTwoPoints(startPt, endPt)
Dim layers As LayersEnumerator = drawDoc.StylesManager.Layers
oLine.Layer = layers.Item("Centerline (ANSI)")
sketch1.ExitEdit
```

#### Code Block 4

```vb
Dim drawView As DrawingView = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select a drawing view")

Dim drawDoc As DrawingDocument= ThisApplication.ActiveDocument

Dim sketch1 As DrawingSketch = drawView.Sketches.Add   
sketch1.Edit

Dim startPt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(0,0)
startPt = drawView.SheetToDrawingViewSpace(startPt)

Dim endPt As Point2d = ThisApplication.TransientGeometry.CreatePoint2d(216*2.54,0)
endPt = drawView.SheetToDrawingViewSpace(endPt)

Dim oLine As SketchLine = sketch1.SketchLines.AddByTwoPoints(startPt, endPt)
Dim layers As LayersEnumerator = drawDoc.StylesManager.Layers
oLine.Layer = layers.Item("Centerline (ANSI)")
sketch1.ExitEdit
```

---

### 126. dxfAddIn.savecopyAs uses old dxfoptions used in manual saving

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/dxfaddin-savecopyas-uses-old-dxfoptions-used-in-manual-saving/td-p/13836969#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/dxfaddin-savecopyas-uses-old-dxfoptions-used-in-manual-saving/td-p/13836969#messageview_0)

**Author:** stefvanlierop

**Date:** ‎10-04-2025
	
		
		03:08 AM

**Description:** Hi all, I have been working with ilogic for some time now and i want to export  dxf files from idw drawings. The company I work for only exports these to certain suppliers and they have made agreements of how a dxf file should look. The dxf's should only retain certain layers that are used in the ma...

**Code Snippets (2):**

#### Code Block 1

```vb
If dxfAddIn.HasSaveCopyAsOptions(oDoc, dxfContext, dxfOptions) Then
    Dim configPath As String = "C:\InventorStandaard\iLogic\Standard_dxf\DXFconfigurationfile.ini"

    ' ==== Verify config path exists ====
    If Not System.IO.File.Exists(configPath) Then
        MsgBox("DXF config file not found at: " & vbCrLf & configPath, vbCritical, "Export Cancelled")
        Exit Sub   ' stop the rule if .ini is missing
    End If

    ' Clear old cached options first (important!)
    dxfOptions.Clear()

    ' Force both keys that the translator looks for
    dxfOptions.Value("ConfigurationFile") = configPath
    dxfOptions.Value("Export_AcadIniFile") = configPath
    dxfOptions.Value("ModelGeometryOnly") = True

    ' Confirm ConfigurationFile was actually set
    Dim configVal As String = ""
    Try
        configVal = dxfOptions.Value("ConfigurationFile")
    Catch
        configVal = "(ConfigurationFile not set!)"
    End Try

    ' Build a text list of all DXF options for debug
    Dim report As String = "DXF Export Options:" & vbCrLf
    For i As Integer = 1 To dxfOptions.Count
        Dim key As String = dxfOptions.Name(i)
        Dim val As String = ""
        Try
            val = dxfOptions.Value(key)
        Catch
            val = "(no value)"
        End Try
        report &= "  " & key & " = " & val & vbCrLf
    Next

    MsgBox("DXF Config file now set to: " & configVal & vbCrLf & vbCrLf & report, _
           vbInformation, "DXF Options Debug")
End If

' Perform the export
Try
    dxfAddIn.SaveCopyAs(oDoc, dxfContext, dxfOptions, dxfData)
Catch ex As Exception
    MessageBox.Show("Error during DXF export: " & ex.Message, "Export Error")
End Try

' ==== Done ====
MsgBox("PDF and DXF exported to specified folders successfully." & vbCrLf & _
       "PDF: " & pdfPath & vbCrLf & "DXF: " & dxfPath, vbInformation, "Export Complete")
```

#### Code Block 2

```vb
If dxfAddIn.HasSaveCopyAsOptions(oDoc, dxfContext, dxfOptions) Then
    Dim configPath As String = "C:\InventorStandaard\iLogic\Standard_dxf\DXFconfigurationfile.ini"

    ' ==== Verify config path exists ====
    If Not System.IO.File.Exists(configPath) Then
        MsgBox("DXF config file not found at: " & vbCrLf & configPath, vbCritical, "Export Cancelled")
        Exit Sub   ' stop the rule if .ini is missing
    End If

    ' Clear old cached options first (important!)
    dxfOptions.Clear()

    ' Force both keys that the translator looks for
    dxfOptions.Value("ConfigurationFile") = configPath
    dxfOptions.Value("Export_AcadIniFile") = configPath
    dxfOptions.Value("ModelGeometryOnly") = True

    ' Confirm ConfigurationFile was actually set
    Dim configVal As String = ""
    Try
        configVal = dxfOptions.Value("ConfigurationFile")
    Catch
        configVal = "(ConfigurationFile not set!)"
    End Try

    ' Build a text list of all DXF options for debug
    Dim report As String = "DXF Export Options:" & vbCrLf
    For i As Integer = 1 To dxfOptions.Count
        Dim key As String = dxfOptions.Name(i)
        Dim val As String = ""
        Try
            val = dxfOptions.Value(key)
        Catch
            val = "(no value)"
        End Try
        report &= "  " & key & " = " & val & vbCrLf
    Next

    MsgBox("DXF Config file now set to: " & configVal & vbCrLf & vbCrLf & report, _
           vbInformation, "DXF Options Debug")
End If

' Perform the export
Try
    dxfAddIn.SaveCopyAs(oDoc, dxfContext, dxfOptions, dxfData)
Catch ex As Exception
    MessageBox.Show("Error during DXF export: " & ex.Message, "Export Error")
End Try

' ==== Done ====
MsgBox("PDF and DXF exported to specified folders successfully." & vbCrLf & _
       "PDF: " & pdfPath & vbCrLf & "DXF: " & dxfPath, vbInformation, "Export Complete")
```

#### Code Block 3

```vb
If dxfAddIn.HasSaveCopyAsOptions(oDoc, dxfContext, dxfOptions) Then
    Dim configPath As String = "C:\InventorStandaard\iLogic\Standard_dxf\DXFconfigurationfile.ini"

    ' ==== Verify config path exists ====
    If Not System.IO.File.Exists(configPath) Then
        MsgBox("DXF config file not found at: " & vbCrLf & configPath, vbCritical, "Export Cancelled")
        Exit Sub   ' stop the rule if .ini is missing
    End If

    ' Clear old cached options first (important!)
    dxfOptions.Clear()

    ' Force both keys that the translator looks for
    dxfOptions.Value("ConfigurationFile") = configPath
    dxfOptions.Value("Export_AcadIniFile") = configPath
    dxfOptions.Value("ModelGeometryOnly") = True

    ' Confirm ConfigurationFile was actually set
    Dim configVal As String = ""
    Try
        configVal = dxfOptions.Value("ConfigurationFile")
    Catch
        configVal = "(ConfigurationFile not set!)"
    End Try

    ' Build a text list of all DXF options for debug
    Dim report As String = "DXF Export Options:" & vbCrLf
    For i As Integer = 1 To dxfOptions.Count
        Dim key As String = dxfOptions.Name(i)
        Dim val As String = ""
        Try
            val = dxfOptions.Value(key)
        Catch
            val = "(no value)"
        End Try
        report &= "  " & key & " = " & val & vbCrLf
    Next

    MsgBox("DXF Config file now set to: " & configVal & vbCrLf & vbCrLf & report, _
           vbInformation, "DXF Options Debug")
End If

' Perform the export
Try
    dxfAddIn.SaveCopyAs(oDoc, dxfContext, dxfOptions, dxfData)
Catch ex As Exception
    MessageBox.Show("Error during DXF export: " & ex.Message, "Export Error")
End Try

' ==== Done ====
MsgBox("PDF and DXF exported to specified folders successfully." & vbCrLf & _
       "PDF: " & pdfPath & vbCrLf & "DXF: " & dxfPath, vbInformation, "Export Complete")
```

#### Code Block 4

```vb
If dxfAddIn.HasSaveCopyAsOptions(oDoc, dxfContext, dxfOptions) Then
    Dim configPath As String = "C:\InventorStandaard\iLogic\Standard_dxf\DXFconfigurationfile.ini"

    ' ==== Verify config path exists ====
    If Not System.IO.File.Exists(configPath) Then
        MsgBox("DXF config file not found at: " & vbCrLf & configPath, vbCritical, "Export Cancelled")
        Exit Sub   ' stop the rule if .ini is missing
    End If

    ' Clear old cached options first (important!)
    dxfOptions.Clear()

    ' Force both keys that the translator looks for
    dxfOptions.Value("ConfigurationFile") = configPath
    dxfOptions.Value("Export_AcadIniFile") = configPath
    dxfOptions.Value("ModelGeometryOnly") = True

    ' Confirm ConfigurationFile was actually set
    Dim configVal As String = ""
    Try
        configVal = dxfOptions.Value("ConfigurationFile")
    Catch
        configVal = "(ConfigurationFile not set!)"
    End Try

    ' Build a text list of all DXF options for debug
    Dim report As String = "DXF Export Options:" & vbCrLf
    For i As Integer = 1 To dxfOptions.Count
        Dim key As String = dxfOptions.Name(i)
        Dim val As String = ""
        Try
            val = dxfOptions.Value(key)
        Catch
            val = "(no value)"
        End Try
        report &= "  " & key & " = " & val & vbCrLf
    Next

    MsgBox("DXF Config file now set to: " & configVal & vbCrLf & vbCrLf & report, _
           vbInformation, "DXF Options Debug")
End If

' Perform the export
Try
    dxfAddIn.SaveCopyAs(oDoc, dxfContext, dxfOptions, dxfData)
Catch ex As Exception
    MessageBox.Show("Error during DXF export: " & ex.Message, "Export Error")
End Try

' ==== Done ====
MsgBox("PDF and DXF exported to specified folders successfully." & vbCrLf & _
       "PDF: " & pdfPath & vbCrLf & "DXF: " & dxfPath, vbInformation, "Export Complete")
```

---

### 127. g_inventorApplication options

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/g-inventorapplication-options/td-p/13747770#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/g-inventorapplication-options/td-p/13747770#messageview_0)

**Author:** Mehmet_Fatih_Turker

**Date:** ‎07-31-2025
	
		
		12:48 AM

**Description:** Hi all, I have developed an API and it works efectively but customers/menagers wants see it in a video, so I need to record screen but since I  adjusted ScreenUpdating property as false, user sees nothing for 4-5 mins, so I changed it to true. Im wondering if there is anymore settings or properties ...

**Code Snippets (2):**

#### Code Block 1

```vb
g_inventorApplication.UserInterfaceManager.DoEvents()
```

#### Code Block 2

```vb
g_inventorApplication.UserInterfaceManager.DoEvents()
```

---

### 128. iAssembly iLogic to overwrite weight

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/iassembly-ilogic-to-overwrite-weight/td-p/13771720#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/iassembly-ilogic-to-overwrite-weight/td-p/13771720#messageview_0)

**Author:** fwerth

**Date:** ‎08-18-2025
	
		
		01:57 AM

**Description:** Hello everyone,I am having a problem applying an ilogic rule in an assembly. The assembly contains several iAssembly variants. The tables of the inserted iAssemblies also contain a “Mass” column, which specifies the weight of the respective variant. The ilogic rule is supposed to search for the weig...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim oAsmDoc As AssemblyDocument
oAsmDoc = ThisApplication.ActiveDocument

Dim totalWeight As Double = 0

For Each oOcc As ComponentOccurrence In oAsmDoc.ComponentDefinition.Occurrences
    Try
        ' Prüfen, ob Occurrence ein iAssembly-Mitglied ist
        If oOcc.IsiAssemblyMember Then
            ' iAssemblyMember holen
            Dim member As iAssemblyMember = oOcc.Definition.iAssemblyMember

            ' Aktuelle Zeile
            Dim row As iAssemblyTableRow = member.Row

            If Not row Is Nothing Then
                ' Zelle "Masse" auslesen
                Dim cell As iAssemblyTableCell = row.Item("Masse")
                Dim variantWeight As Double = CDbl(cell.Value)

                totalWeight += variantWeight
            End If
			 Else
            ' Normales Teil / Baugruppe → Inventor-Masse
            Dim occMass As Double = oOcc.MassProperties.Mass
            totalWeight += occMass
        End If
    Catch ex As Exception
        ' suppressed Occurrences oder fehlende Spalten überspringen
    End Try
Next

' Physikalische Masse überschreiben
Dim massProps As MassProperties
massProps = oAsmDoc.ComponentDefinition.MassProperties

oAsmDoc.ComponentDefinition.MassProperties.Mass = totalWeight

' In iProperties schreiben
iProperties.Value("Custom", "Masse") = totalWeight

MessageBox.Show("Masse = " & totalWeight & " kg", "iLogic Info")
```

#### Code Block 2

```vb
Dim oAsmDoc As AssemblyDocument
oAsmDoc = ThisApplication.ActiveDocument

Dim totalWeight As Double = 0

For Each oOcc As ComponentOccurrence In oAsmDoc.ComponentDefinition.Occurrences
    Try
        Dim occDoc As Document = oOcc.Definition.Document

        If occDoc.DocumentType = kPartDocumentObject Or occDoc.DocumentType = kAssemblyDocumentObject Then
            If occDoc.ComponentDefinition.IsiAssemblyMember Then
                Dim member As iAssemblyMember = occDoc.ComponentDefinition.iAssemblyMember

                ' Die aktuell in der Baugruppe verwendete Variante holen
                Dim row As iAssemblyTableRow = member.ActiveTableRow

                If Not row Is Nothing Then
                  
                    Dim variantWeight As Double = CDbl(row("Masse").Value)
                    totalWeight += variantWeight
                End If
            End If
        End If
    Catch ex As Exception
    End Try
Next


' Physikalische Masse überschreiben
oAsmDoc.ComponentDefinition.MassProperties.Mass = totalWeight
```

---

### 129. iLogic (Input String was Not in a Correct Format)

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-input-string-was-not-in-a-correct-format/td-p/13784120](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-input-string-was-not-in-a-correct-format/td-p/13784120)

**Author:** aboykin4DAV8

**Date:** ‎08-26-2025
	
		
		02:05 PM

**Description:** Good Afternoon, I am working on creating custom user parameters and iProperties for our part templates.  The idea is to build a rule that will create parameters/iProperties if they don't exist, then allow for user inputs on the form.  Inputs will be filled in directly, or from a predefined dropdown ...

**Code Snippets (4):**

#### Code Block 1

```vb
Try
    ' Attempt to access an existing parameter
	Dim Labor_Ops_Variable As Inventor.Parameter = ThisDoc.Document.ComponentDefinition.Parameters.Item("Labor_Ops")
    ' If successful, do something with the parameter
	'Enter user defined iProperty
		customPropertySet = ThisDoc.Document.PropertySets.Item("Inventor User Defined Properties")
	
		iProperties.Value("Custom", "Labor_Ops") = Parameter("Labor_Ops")
	'Uncomment line below for test
    'MessageBox.Show("Parameter 'Labor_Ops' found with value: " & Labor_Ops_Variable.Value)

Catch
    ' If the parameter doesn't exist, create it
	Dim userParameters As UserParameters = ThisDoc.Document.ComponentDefinition.Parameters.UserParameters
	Dim newParameter As Inventor.Parameter = userParameters.AddByValue("Labor_Ops", "Saw", UnitsTypeEnum.kTextUnits)
	
	'Uncomment line below for test
    'MessageBox.Show("Parameter 'Labor_Ops' created.")
End Try
	


-----------------------------------------------------------------
' Specify your Excel file path and sheet name
    Dim excelFilePath As String = "File Path Removed for Privacy"
    Dim sheetName As String = "Inventor Form Layout"

    ' Open the Excel file
    GoExcel.Open(excelFilePath, sheetName)
	
	Dim rangeArray As Object = GoExcel.NamedRangeValue("Labor_Ops")
	
	    ' Create a list to hold the values from the Excel column
    Dim oList As ArrayList = New ArrayList()


    ' Iterate through the Excel data (assuming a single column, e.g., Column A)
    ' For each row in the rangeArray
    For iRow = rangeArray.GetLowerBound(0) To rangeArray.GetUpperBound(0)
        ' Get the value from the current row and specific column (e.g., column index 0)
		Dim cellValue As Object = rangeArray(iRow, 0) ' 0 for the first column

        ' Check if the cell is not empty before adding to the list
        If Not IsNothing(cellValue) AndAlso cellValue.ToString().Trim() <> "" Then
            oList.Add(cellValue.ToString()) ' Add the string value to the list
        End If
    Next
	
	    ' Assign the populated list to the multi-value parameter (e.g., "MyParam")
    MultiValue.List("Labor_Ops") = oList
	
	rowFound = GoExcel.FindRow(excelFilePath, sheetName, "Labor_Ops", "=", Labor_Ops)
	
	If rowFound <> -1 Then
    ' If a row is found, get the value from the "Description" column of that row
    routersValue = GoExcel.CurrentRowValue("Routers")
	'Uncomment 3 lines below to test if form is working
    'MessageBox.Show("Routers: " & routersValue)
	'Else
    'MessageBox.Show("Labor_Ops not found.")
	End If
	
	'Assigns the found cell value to the "Router_Export" parameter
	Router_Export = routersValue

	
	    ' Close the Excel file
    GoExcel.Close()
```

#### Code Block 2

```vb
Try
    ' Attempt to access an existing parameter
	Dim Labor_Ops_Variable As Inventor.Parameter = ThisDoc.Document.ComponentDefinition.Parameters.Item("Labor_Ops")
    ' If successful, do something with the parameter
	'Enter user defined iProperty
		customPropertySet = ThisDoc.Document.PropertySets.Item("Inventor User Defined Properties")
	
		iProperties.Value("Custom", "Labor_Ops") = Parameter("Labor_Ops")
	'Uncomment line below for test
    'MessageBox.Show("Parameter 'Labor_Ops' found with value: " & Labor_Ops_Variable.Value)

Catch
    ' If the parameter doesn't exist, create it
	Dim userParameters As UserParameters = ThisDoc.Document.ComponentDefinition.Parameters.UserParameters
	Dim newParameter As Inventor.Parameter = userParameters.AddByValue("Labor_Ops", "Saw", UnitsTypeEnum.kTextUnits)
	
	'Uncomment line below for test
    'MessageBox.Show("Parameter 'Labor_Ops' created.")
End Try
	


-----------------------------------------------------------------
' Specify your Excel file path and sheet name
    Dim excelFilePath As String = "File Path Removed for Privacy"
    Dim sheetName As String = "Inventor Form Layout"

    ' Open the Excel file
    GoExcel.Open(excelFilePath, sheetName)
	
	Dim rangeArray As Object = GoExcel.NamedRangeValue("Labor_Ops")
	
	    ' Create a list to hold the values from the Excel column
    Dim oList As ArrayList = New ArrayList()


    ' Iterate through the Excel data (assuming a single column, e.g., Column A)
    ' For each row in the rangeArray
    For iRow = rangeArray.GetLowerBound(0) To rangeArray.GetUpperBound(0)
        ' Get the value from the current row and specific column (e.g., column index 0)
		Dim cellValue As Object = rangeArray(iRow, 0) ' 0 for the first column

        ' Check if the cell is not empty before adding to the list
        If Not IsNothing(cellValue) AndAlso cellValue.ToString().Trim() <> "" Then
            oList.Add(cellValue.ToString()) ' Add the string value to the list
        End If
    Next
	
	    ' Assign the populated list to the multi-value parameter (e.g., "MyParam")
    MultiValue.List("Labor_Ops") = oList
	
	rowFound = GoExcel.FindRow(excelFilePath, sheetName, "Labor_Ops", "=", Labor_Ops)
	
	If rowFound <> -1 Then
    ' If a row is found, get the value from the "Description" column of that row
    routersValue = GoExcel.CurrentRowValue("Routers")
	'Uncomment 3 lines below to test if form is working
    'MessageBox.Show("Routers: " & routersValue)
	'Else
    'MessageBox.Show("Labor_Ops not found.")
	End If
	
	'Assigns the found cell value to the "Router_Export" parameter
	Router_Export = routersValue

	
	    ' Close the Excel file
    GoExcel.Close()
```

#### Code Block 3

```vb
rowFound = GoExcel.FindRow(excelFilePath, sheetName, "Labor_Ops", "=", Labor_Ops)
```

#### Code Block 4

```vb
rowFound = GoExcel.FindRow(excelFilePath, sheetName, "Labor_Ops", "=", Labor_Ops)
```

---

### 130. iLogic - turn on/off parts

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-turn-on-off-parts/td-p/13818839](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-turn-on-off-parts/td-p/13818839)

**Author:** jmckone9Z5PD

**Date:** ‎09-20-2025
	
		
		05:56 AM

**Description:** Recently, I have been experimenting with iLogic to (hopefully) simplify some window assemblies and the various options within. I have a window type that has 3 exterior size options, 5/8", 2" and 3.5" cladding.   A user parameter called 'Exterior_Options" has been created with the three size options ...

**Code Snippets (7):**

#### Code Block 1

```vb
Component.IsActive("Part1:1")
```

#### Code Block 2

```vb
Component.IsActive("Part1:1")
```

#### Code Block 3

```vb
Component.IsActive("Part1:1")
```

#### Code Block 4

```vb
Component.IsActive("Part1:1")
```

#### Code Block 5

```vb
Dim oDoc As Inventor.Document = ThisApplication.ActiveDocument
Dim oPane As BrowserPane = oDoc.BrowserPanes.Item("Model")
Dim oFolder As BrowserFolder = oPane.TopNode.BrowserFolders.Item("Group1")
oDoc.SelectSet.Clear()
oFolder.BrowserNode.DoSelect()
ThisApplication.CommandManager.ControlDefinitions.Item("AssemblyCompSuppressionCtxCmd").Execute()
oDoc.SelectSet.Clear()
```

#### Code Block 6

```vb
Dim oDoc As Inventor.Document = ThisApplication.ActiveDocument
Dim oPane As BrowserPane = oDoc.BrowserPanes.Item("Model")
Dim oFolder As BrowserFolder = oPane.TopNode.BrowserFolders.Item("Group1")
oDoc.SelectSet.Clear()
oFolder.BrowserNode.DoSelect()
ThisApplication.CommandManager.ControlDefinitions.Item("AssemblyCompSuppressionCtxCmd").Execute()
oDoc.SelectSet.Clear()
```

#### Code Block 7

```vb
Dim oPane1 As BrowserPane = ThisDoc.Document.BrowserPanes("Model")
Dim oFolder As BrowserFolder = oPane1.TopNode.BrowserFolders.Item("MyFolder")
Dim oFolderNodes = oFolder.BrowserNode.BrowserNodes
Dim oOcc As ComponentOccurrence

For Each oNode As BrowserNode In oFolderNodes
	oOcc = oNode.NativeObject
	'toggle on/off
	Component.IsActive(oOcc.name) = Not Component.IsActive(oOcc.name) 
Next
```

#### Code Block 8

```vb
Dim oPane1 As BrowserPane = ThisDoc.Document.BrowserPanes("Model")
Dim oFolder As BrowserFolder = oPane1.TopNode.BrowserFolders.Item("MyFolder")
Dim oFolderNodes = oFolder.BrowserNode.BrowserNodes
Dim oOcc As ComponentOccurrence

For Each oNode As BrowserNode In oFolderNodes
	oOcc = oNode.NativeObject
	'toggle on/off
	Component.IsActive(oOcc.name) = Not Component.IsActive(oOcc.name) 
Next
```

#### Code Block 9

```vb
Dim oPane1 As BrowserPane = ThisDoc.Document.BrowserPanes("Model")
Dim oFolder As BrowserFolder = oPane1.TopNode.BrowserFolders.Item("MyFolder")
Dim oFolderNodes = oFolder.BrowserNode.BrowserNodes
Dim oOcc As ComponentOccurrence

For Each oNode As BrowserNode In oFolderNodes
	oOcc = oNode.NativeObject
	'turn off
	Component.IsActive(oOcc.name) = False
Next
```

#### Code Block 10

```vb
Dim oPane1 As BrowserPane = ThisDoc.Document.BrowserPanes("Model")
Dim oFolder As BrowserFolder = oPane1.TopNode.BrowserFolders.Item("MyFolder")
Dim oFolderNodes = oFolder.BrowserNode.BrowserNodes
Dim oOcc As ComponentOccurrence

For Each oNode As BrowserNode In oFolderNodes
	oOcc = oNode.NativeObject
	'turn off
	Component.IsActive(oOcc.name) = False
Next
```

#### Code Block 11

```vb
Feature.IsActive("Part1:1", "featurename")
```

#### Code Block 12

```vb
Feature.IsActive("Part1:1", "featurename")
```

#### Code Block 13

```vb
If Exterior_Option = "5/8" Then
	Feature.IsActive("1201-P Mainframe Head & Sill .625") = True
	Feature.IsActive("1201-P Mainframe jamb .625") = True
	Feature.IsActive("1201-P Mainframe Head & Sill 2") = False
	Feature.IsActive("1201-P Mainframe jamb 2") = False
	Feature.IsActive("1201-P Mainframe Head & Sill 3 1/2") = False
	Feature.IsActive("1201-P Mainframe jamb 3 1/2") = False
```

#### Code Block 14

```vb
If Exterior_Option = "5/8" Then
	Feature.IsActive("1201-P Mainframe Head & Sill .625") = True
	Feature.IsActive("1201-P Mainframe jamb .625") = True
	Feature.IsActive("1201-P Mainframe Head & Sill 2") = False
	Feature.IsActive("1201-P Mainframe jamb 2") = False
	Feature.IsActive("1201-P Mainframe Head & Sill 3 1/2") = False
	Feature.IsActive("1201-P Mainframe jamb 3 1/2") = False
```

---

### 131. iLogic Code to Delete Specific Parameter in all Parts Within Assembly

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-code-to-delete-specific-parameter-in-all-parts-within/td-p/13803275#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-code-to-delete-specific-parameter-in-all-parts-within/td-p/13803275#messageview_0)

**Author:** Cadderman

**Date:** ‎09-09-2025
	
		
		08:28 AM

**Description:** Hi all, I'm not particularly good at producing iLogic codes - I need what I think should be quite a simple code... I need to delete the parameter "Thickness" in all components within an assembly.  Any help would be greatly appreciated.  					 				 			 			 				 	Keystone Blue

**Code Snippets (1):**

#### Code Block 1

```vb
Sub Main

	Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
	Dim oOccs As ComponentOccurrences = oADoc.ComponentDefinition.Occurrences

	Call TraverseAssembly(oOccs)

End Sub

Function TraverseAssembly(oOccs As ComponentOccurrences)

	Dim oOcc As ComponentOccurrence
	For Each oOcc In oOccs
		If oOcc.Suppressed = True Then Continue For
		'get the document from the occurrence
		Dim oDoc = oOcc.Definition.Document

		Try
			oDoc.ComponentDefinition.Parameters.Item("Thickness").Delete
			Logger.Info(oOcc.Name & " parameter deleted")
		Catch 
			Logger.Info(oOcc.Name & " could not find or delete parameter")
		End Try

		'if assembly loop back up and step down into it's occurrences
		If oOcc.DefinitionDocumentType = DocumentTypeEnum.kAssemblyDocumentObject Then
			Call TraverseAssembly(oOcc.SubOccurrences)
		Else 
			' handle stuff for just parts here if needed
		End If
	Next

End Function
```

---

### 132. iLogic Remove all Event Triggers &amp; add new Event Trigger

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-remove-all-event-triggers-amp-add-new-event-trigger/td-p/13234890#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-remove-all-event-triggers-amp-add-new-event-trigger/td-p/13234890#messageview_0)

**Author:** KWarrenCA

**Date:** ‎12-30-2024
	
		
		06:10 AM

**Description:** I'm working on some code to update some older files which may or may not contain an event trigger. What I'm trying to come up with is an ilogic that I can have it clear out any event triggers that are existing and add the new one in if it doesn't exist. This would be added to my existing code so tha...

**Code Snippets (10):**

#### Code Block 1

```vb
Dim oDoc As Inventor.Document = ThisDoc.Document
Dim oSet As Inventor.PropertySet = Nothing
If oDoc.PropertySets.PropertySetExists("{2C540830-0723-455E-A8E2-891722EB4C3E}", oSet) Then
	Try : oSet.Delete() : Catch : End Try
End If
```

#### Code Block 2

```vb
Dim oDoc As Inventor.Document = ThisDoc.Document
Dim oSet As Inventor.PropertySet = Nothing
If oDoc.PropertySets.PropertySetExists("{2C540830-0723-455E-A8E2-891722EB4C3E}", oSet) Then
	Try : oSet.Delete() : Catch : End Try
End If
```

#### Code Block 3

```vb
If ThisDoc.Document.DocumentInterests.HasInterest("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}") = True
	Logger.Debug("hasInterest")
ElseIf ThisDoc.Document.DocumentInterests.HasInterest("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}") = False
	Logger.Debug("hasInterest False ")
	iLogicVb.Automation.AddRule(ThisDoc.Document, "TriggerRule", "'This rule is used to activate the iLogic environment.")
	Logger.Info("The local rule TriggerRule was created to activate the iLogic environment.")
End If
```

#### Code Block 4

```vb
If ThisDoc.Document.DocumentInterests.HasInterest("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}") = True
	Logger.Debug("hasInterest")
ElseIf ThisDoc.Document.DocumentInterests.HasInterest("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}") = False
	Logger.Debug("hasInterest False ")
	iLogicVb.Automation.AddRule(ThisDoc.Document, "TriggerRule", "'This rule is used to activate the iLogic environment.")
	Logger.Info("The local rule TriggerRule was created to activate the iLogic environment.")
End If
```

#### Code Block 5

```vb
Sub Main

	Dim RuleName As String = "file://" & SharedVariable("SetEventTriggersInput1")
	Dim TriggerName As String = SharedVariable("SetEventTriggersInput2")
	Dim TriggerCode As String = SharedVariable("SetEventTriggersInput3")


	If ThisDoc.Document.DocumentInterests.HasInterest("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}") = True
		Logger.Debug("hasInterest")
	ElseIf ThisDoc.Document.DocumentInterests.HasInterest("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}") = False
		Logger.Debug("hasInterest False ")
		iLogicVb.Automation.AddRule(ThisDoc.Document, "TriggerRule", "'This rule is used to activate the iLogic environment.")
		Logger.Info("The local rule TriggerRule was created to activate the iLogic environment.")
	End If

	Dim oDoc As Document = ThisDoc.Document

	Dim oEvents As Inventor.PropertySet

	Try
		oEvents = oDoc.PropertySets.Item("{2C540830-0723-455E-A8E2-891722EB4C3E}")
	Catch
		oEvents = oDoc.PropertySets.Add("iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	End Try

'	For Each oItem As [Property] In oEvents
'		oItem.Delete
'	Next
	
	oEvents.Add(RuleName, TriggerName, TriggerCode)

End Sub
```

#### Code Block 6

```vb
Sub Main

	Dim oDoc As Document = ThisDoc.Document

	Dim oEvents As Inventor.PropertySet

	Try
		oEvents = oDoc.PropertySets.Item("{2C540830-0723-455E-A8E2-891722EB4C3E}")
	Catch
		oEvents = oDoc.PropertySets.Add("iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	End Try

	For Each oItem As [Property] In oEvents
		oItem.Delete
	Next
	
	oEvents.Add("file://StockNumber-Assembly_Copy", "BeforeDocSave", 700)

End Sub
```

#### Code Block 7

```vb
Sub Main

	Dim oDoc As Document = ThisDoc.Document

	Dim oEvents As Inventor.PropertySet

	Try
		oEvents = oDoc.PropertySets.Item("{2C540830-0723-455E-A8E2-891722EB4C3E}")
	Catch
		oEvents = oDoc.PropertySets.Add("iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	End Try

	For Each oItem As [Property] In oEvents
		oItem.Delete
	Next
	
	oEvents.Add("file://StockNumber-Assembly_Copy", "BeforeDocSave", 700)

End Sub
```

#### Code Block 8

```vb
Sub Main

	If ThisDoc.Document.DocumentInterests.HasInterest("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}") = True
		Logger.Debug("hasInterest")
	ElseIf ThisDoc.Document.DocumentInterests.HasInterest("{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}") = False
		Logger.Debug("hasInterest False ")
		iLogicVb.Automation.AddRule(ThisDoc.Document, "TriggerRule", "'This rule is used to activate the iLogic environment.")
		Logger.Info("The local rule TriggerRule was created to activate the iLogic environment.")
	End If

	Dim oDoc As Document = ThisDoc.Document

	Dim oEvents As Inventor.PropertySet

	Try
		oEvents = oDoc.PropertySets.Item("{2C540830-0723-455E-A8E2-891722EB4C3E}")
	Catch
		oEvents = oDoc.PropertySets.Add("iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	End Try

	For Each oItem As [Property] In oEvents
		oItem.Delete
	Next
	
End Sub
```

#### Code Block 9

```vb
Sub Main()
	

RemoveRulesfromEventTrigger
AssemblyEvents


End Sub


Function GetiLogicEventPropSet(cDocument As Document) As Inventor.PropertySet
	On Error Resume Next
	iLogicEventPropSet = cDocument.PropertySets.Item("iLogicEventsRules")

	If iLogicEventPropSet Is Nothing Then
		iLogicEventPropSet = cDocument.PropertySets.Item("_iLogicEventsRules")
	End If

	If iLogicEventPropSet.InternalName <> "{2C540830-0723-455E-A8E2-891722EB4C3E}" Then
		Call iLogicEventPropSet.Delete
		iLogicEventPropSet = cDocument.PropertySets.Add("iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	End If

	If iLogicEventPropSet Is Nothing Then
		iLogicEventPropSet = cDocument.PropertySets.Add("iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	End If

	If iLogicEventPropSet Is Nothing Then
		MsgBox("Unable to create the Event Triggers property for this file!", , "Event Triggers Not Set")
		Err.Raise(1)
		Exit Function
	End If
	On Error GoTo 0

	Return iLogicEventPropSet
End Function


Sub RemoveRulesfromEventTrigger()


   Try
Dim EventTrigger = ThisDoc.Document.PropertySets.Item("{2C540830-0723-455E-A8E2-891722EB4C3E}")
'MsgBox(x.Count)

If EventTrigger.Name = "StockNumber-Assembly_Copy" Then
	Return
	Else
		ThisDoc.Document.PropertySets.Item("{2C540830-0723-455E-A8E2-891722EB4C3E}").Delete
	End If
	Catch
	End Try

End Sub

Sub AssemblyEvents



	On Error Resume Next
	Dim EventPropSet As Inventor.PropertySet
	EventPropSet = GetiLogicEventPropSet(ThisApplication.ActiveDocument)
	' To make sure that the document has an iLogic DocumentInterest, add a temporary rule
	'EventPropSet.Add("file://Accessory List", "AfterDrawingViewsUpdate", 1801)
	EventPropSet.Add("file://StockNumber-Assembly_Copy", "BeforeDocSave", 700)

	'After Open Document					: AfterDocOpen                 		: 400
	'Close(Document)						: DocClose                     		: 500
	'Before Save Document                   : BeforeDocSave           			: 700
	'After Save Document               		: AfterDocSave               		: 800
	'Any Model Parameter Change        		: AfterAnyParamChange   			: 1000
	'Part Geometry Change**            		: PartBodyChanged         			: 1200
	'Material Change**                  	: AfterMaterialChange     			: 1400
	'Drawing View Change***               	: AfterDrawingViewsUpdate  			: 1500
	'iProperty(Change)                  	: AfterAnyiPropertyChange           : 1600
	'Feature Suppression Change**          	: AfterFeatureSuppressionChange   	: 2000
	'Component Suppression Change*   		: AfterComponentSuppressionChange 	: 2200
	'iPart / iAssembly Change Component* 	: AfterComponentReplace   			: 2400
	'New Document                         	: AfterDocNew                  		: 2600

	InventorVb.DocumentUpdate()


End Sub
```

#### Code Block 10

```vb
Sub Main()
	

RemoveRulesfromEventTrigger
AssemblyEvents


End Sub


Function GetiLogicEventPropSet(cDocument As Document) As Inventor.PropertySet
	On Error Resume Next
	iLogicEventPropSet = cDocument.PropertySets.Item("iLogicEventsRules")

	If iLogicEventPropSet Is Nothing Then
		iLogicEventPropSet = cDocument.PropertySets.Item("_iLogicEventsRules")
	End If

	If iLogicEventPropSet.InternalName <> "{2C540830-0723-455E-A8E2-891722EB4C3E}" Then
		Call iLogicEventPropSet.Delete
		iLogicEventPropSet = cDocument.PropertySets.Add("iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	End If

	If iLogicEventPropSet Is Nothing Then
		iLogicEventPropSet = cDocument.PropertySets.Add("iLogicEventsRules", "{2C540830-0723-455E-A8E2-891722EB4C3E}")
	End If

	If iLogicEventPropSet Is Nothing Then
		MsgBox("Unable to create the Event Triggers property for this file!", , "Event Triggers Not Set")
		Err.Raise(1)
		Exit Function
	End If
	On Error GoTo 0

	Return iLogicEventPropSet
End Function


Sub RemoveRulesfromEventTrigger()


   Try
Dim EventTrigger = ThisDoc.Document.PropertySets.Item("{2C540830-0723-455E-A8E2-891722EB4C3E}")
'MsgBox(x.Count)

If EventTrigger.Name = "StockNumber-Assembly_Copy" Then
	Return
	Else
		ThisDoc.Document.PropertySets.Item("{2C540830-0723-455E-A8E2-891722EB4C3E}").Delete
	End If
	Catch
	End Try

End Sub

Sub AssemblyEvents



	On Error Resume Next
	Dim EventPropSet As Inventor.PropertySet
	EventPropSet = GetiLogicEventPropSet(ThisApplication.ActiveDocument)
	' To make sure that the document has an iLogic DocumentInterest, add a temporary rule
	'EventPropSet.Add("file://Accessory List", "AfterDrawingViewsUpdate", 1801)
	EventPropSet.Add("file://StockNumber-Assembly_Copy", "BeforeDocSave", 700)

	'After Open Document					: AfterDocOpen                 		: 400
	'Close(Document)						: DocClose                     		: 500
	'Before Save Document                   : BeforeDocSave           			: 700
	'After Save Document               		: AfterDocSave               		: 800
	'Any Model Parameter Change        		: AfterAnyParamChange   			: 1000
	'Part Geometry Change**            		: PartBodyChanged         			: 1200
	'Material Change**                  	: AfterMaterialChange     			: 1400
	'Drawing View Change***               	: AfterDrawingViewsUpdate  			: 1500
	'iProperty(Change)                  	: AfterAnyiPropertyChange           : 1600
	'Feature Suppression Change**          	: AfterFeatureSuppressionChange   	: 2000
	'Component Suppression Change*   		: AfterComponentSuppressionChange 	: 2200
	'iPart / iAssembly Change Component* 	: AfterComponentReplace   			: 2400
	'New Document                         	: AfterDocNew                  		: 2600

	InventorVb.DocumentUpdate()


End Sub
```

---

### 133. iLogic Rule to Measure Area of Two Faces

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-to-measure-area-of-two-faces/td-p/13831748#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-to-measure-area-of-two-faces/td-p/13831748#messageview_0)

**Author:** ethan_howardMMXXV

**Date:** ‎09-30-2025
	
		
		12:30 PM

**Description:** Hello, First off, I'm not an iLogic master. I typically find a script, copy and paste it, and hope for the best. Just want you to know my level of knowledge.The part I created is a surface of a cylinder and I used 2d & 3d sketches, and "split" to create the shapes on the surface of the cylinder. I t...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim iLogicAuto = iLogicVb.Automation

Dim namedEntities = iLogicAuto.GetNamedEntities(ThisDoc.Document)

Dim COLD_OPENING_Face, HOT_OPENING_Face As Face
COLD_OPENING_Face = namedEntities.FindEntity("COLD_OPENING")
HOT_OPENING_Face = namedEntities.FindEntity("HOT_OPENING")
Dim COLD_OPENING_Area, HOT_OPENING_Area, SUM_Area As Double
COLD_OPENING_Area = COLD_OPENING_Face.Evaluator.Area
HOT_OPENING_Area = HOT_OPENING_Face.Evaluator.Area
SUM_Area = COLD_OPENING_Area + HOT_OPENING_Area
MessageBox.Show("COLD_OPENING_Area= " & COLD_OPENING_Area & vbCrLf &"HOT_OPENING_Area= " & HOT_OPENING_Area & vbCrLf & "SUM_Area= " & SUM_Area, "Area")
```

#### Code Block 2

```vb
Dim iLogicAuto = iLogicVb.Automation

Dim namedEntities = iLogicAuto.GetNamedEntities(ThisDoc.Document)

Dim COLD_OPENING_Face, HOT_OPENING_Face As Face
COLD_OPENING_Face = namedEntities.FindEntity("COLD_OPENING")
HOT_OPENING_Face = namedEntities.FindEntity("HOT_OPENING")
Dim COLD_OPENING_Area, HOT_OPENING_Area, SUM_Area As Double
COLD_OPENING_Area = COLD_OPENING_Face.Evaluator.Area
HOT_OPENING_Area = HOT_OPENING_Face.Evaluator.Area
SUM_Area = COLD_OPENING_Area + HOT_OPENING_Area
MessageBox.Show("COLD_OPENING_Area= " & COLD_OPENING_Area & vbCrLf &"HOT_OPENING_Area= " & HOT_OPENING_Area & vbCrLf & "SUM_Area= " & SUM_Area, "Area")
```

#### Code Block 3

```vb
Dim iLogicAuto = iLogicVb.Automation

Dim namedEntities = iLogicAuto.GetNamedEntities(ThisDoc.Document)

Dim f As Face
f = namedEntities.FindEntity(COLD_OPENING), (HOT_OPENING)
Dim Eval As SurfaceEvaluator
Dim area As Double
Eval = f.Evaluator
area = Eval.Area
MsgBox("Face_Area : " & area)
```

#### Code Block 4

```vb
Dim iLogicAuto = iLogicVb.Automation

Dim namedEntities = iLogicAuto.GetNamedEntities(ThisDoc.Document)

Dim f As Face
f = namedEntities.FindEntity(COLD_OPENING), (HOT_OPENING)
Dim Eval As SurfaceEvaluator
Dim area As Double
Eval = f.Evaluator
area = Eval.Area
MsgBox("Face_Area : " & area)
```

#### Code Block 5

```vb
Dim iLogicAuto = iLogicVb.Automation

Dim namedEntities = iLogicAuto.GetNamedEntities(ThisDoc.Document)
Dim uom As UnitsOfMeasure=ThisApplication.UnitsOfMeasure
Dim COLD_OPENING_Face, HOT_OPENING_Face As Face
COLD_OPENING_Face = namedEntities.FindEntity("COLD_OPENING")
HOT_OPENING_Face = namedEntities.FindEntity("HOT_OPENING")
Dim COLD_OPENING_Area, HOT_OPENING_Area, SUM_Area As Double
COLD_OPENING_Area = COLD_OPENING_Face.Evaluator.Area
HOT_OPENING_Area = HOT_OPENING_Face.Evaluator.Area
SUM_Area = COLD_OPENING_Area + HOT_OPENING_Area
COLD_OPENING_Area =  uom.ConvertUnits(COLD_OPENING_Area,UnitsTypeEnum.kDatabaseLengthUnits,ThisDoc.Document.UnitsOfMeasure.LengthUnits)
HOT_OPENING_Area =  uom.ConvertUnits(HOT_OPENING_Area,UnitsTypeEnum.kDatabaseLengthUnits,ThisDoc.Document.UnitsOfMeasure.LengthUnits)
SUM_Area= uom.ConvertUnits(SUM_Area,UnitsTypeEnum.kDatabaseLengthUnits,ThisDoc.Document.UnitsOfMeasure.LengthUnits)
MessageBox.Show("COLD_OPENING_Area= " & COLD_OPENING_Area & vbCrLf & "HOT_OPENING_Area= " & HOT_OPENING_Area & vbCrLf & "SUM_Area= " & SUM_Area, "Area")

iProperties.Value("Custom", "COLD_OPENING") = COLD_OPENING_Area
iProperties.Value("Custom", "HOT_OPENING") =  HOT_OPENING_Area
iProperties.Value("Custom", "SUM") = SUM_Area
```

#### Code Block 6

```vb
Dim iLogicAuto = iLogicVb.Automation

Dim namedEntities = iLogicAuto.GetNamedEntities(ThisDoc.Document)
Dim uom As UnitsOfMeasure=ThisApplication.UnitsOfMeasure
Dim COLD_OPENING_Face, HOT_OPENING_Face As Face
COLD_OPENING_Face = namedEntities.FindEntity("COLD_OPENING")
HOT_OPENING_Face = namedEntities.FindEntity("HOT_OPENING")
Dim COLD_OPENING_Area, HOT_OPENING_Area, SUM_Area As Double
COLD_OPENING_Area = COLD_OPENING_Face.Evaluator.Area
HOT_OPENING_Area = HOT_OPENING_Face.Evaluator.Area
SUM_Area = COLD_OPENING_Area + HOT_OPENING_Area
COLD_OPENING_Area =  uom.ConvertUnits(COLD_OPENING_Area,UnitsTypeEnum.kDatabaseLengthUnits,ThisDoc.Document.UnitsOfMeasure.LengthUnits)
HOT_OPENING_Area =  uom.ConvertUnits(HOT_OPENING_Area,UnitsTypeEnum.kDatabaseLengthUnits,ThisDoc.Document.UnitsOfMeasure.LengthUnits)
SUM_Area= uom.ConvertUnits(SUM_Area,UnitsTypeEnum.kDatabaseLengthUnits,ThisDoc.Document.UnitsOfMeasure.LengthUnits)
MessageBox.Show("COLD_OPENING_Area= " & COLD_OPENING_Area & vbCrLf & "HOT_OPENING_Area= " & HOT_OPENING_Area & vbCrLf & "SUM_Area= " & SUM_Area, "Area")

iProperties.Value("Custom", "COLD_OPENING") = COLD_OPENING_Area
iProperties.Value("Custom", "HOT_OPENING") =  HOT_OPENING_Area
iProperties.Value("Custom", "SUM") = SUM_Area
```

#### Code Block 7

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	If oMSDoc Is Nothing Then Continue For
	oMSDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

#### Code Block 8

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	If oMSDoc Is Nothing Then Continue For
	oMSDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

---

### 134. iLogic Rule: Rename Browser Nodes to Show Part Number + Title

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-rename-browser-nodes-to-show-part-number-title/td-p/13836335](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-rename-browser-nodes-to-show-part-number-title/td-p/13836335)

**Author:** gmclellanZW4DU

**Date:** ‎10-03-2025
	
		
		10:36 AM

**Description:** I put together an iLogic rule for assemblies that automatically updates the browser node display names of components to use the format: Part Number - DescriptionIt also preserves occurrence suffixes (like :1, :2, etc.) so you don’t lose reference numbering, and it skips Content Center/library parts....

**Code Snippets (1):**

#### Code Block 1

```vb
' iLogic code to change part display names in assembly to Part Number + Title
' This code should be run from within the assembly document

Sub Main()
    ' Get the active document (should be an assembly)
    Dim oAssemblyDoc As AssemblyDocument
    Try
        oAssemblyDoc = ThisApplication.ActiveDocument
    Catch
        MessageBox.Show("Please run this code from an assembly document", "Error")
        Exit Sub
    End Try
    
    ' Check if it's actually an assembly
    If oAssemblyDoc.DocumentType <> kAssemblyDocumentObject Then
        MessageBox.Show("This code must be run from an assembly document", "Error")
        Exit Sub
    End If
    
    ' Get the assembly definition
    Dim oAssemblyDef As AssemblyComponentDefinition
    oAssemblyDef = oAssemblyDoc.ComponentDefinition
    
    ' Counter for processed components
    Dim processedCount As Integer = 0
    Dim skippedCount As Integer = 0
    Dim debugInfo As String = ""
    
    ' Loop through all occurrences in the assembly
    For Each oOccurrence As ComponentOccurrence In oAssemblyDef.Occurrences
        Try
            ' Skip Content Center parts - check if it's from Content Center
            Dim isContentCenter As Boolean = False
            Try
                ' Check file path for Content Center
                Dim filePath As String = oOccurrence.Definition.Document.FullFileName
                If filePath.ToUpper().Contains("CONTENT CENTER") Or _
                   filePath.ToUpper().Contains("CONTENTCENTER") Or _
                   filePath.ToUpper().Contains("LIBRARIES") Then
                    isContentCenter = True
                End If
            Catch
                ' Alternative method - check if it's a library component
                Try
                    If oOccurrence.IsLibraryComponent Then
                        isContentCenter = True
                    End If
                Catch
                    ' If we can't determine, assume it's not Content Center
                    isContentCenter = False
                End Try
            End Try
            
            If isContentCenter Then
                skippedCount = skippedCount + 1
                debugInfo = debugInfo & "Skipped Content Center: " & oOccurrence.Name & vbCrLf
                Continue For
            End If
            
            ' Get the part document from the occurrence
            Dim oPartDoc As Document = oOccurrence.Definition.Document
            
            ' Get part number and title from iProperties
            Dim partNumber As String = ""
            Dim partTitle As String = ""
            
            ' Try multiple ways to get Part Number
            Try
                ' First try Design Tracking Properties
                partNumber = oPartDoc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value.ToString()
            Catch
                Try
                    ' Try Summary Information
                    partNumber = oPartDoc.PropertySets.Item("Summary Information").Item("Title").Value.ToString()
                Catch
                    Try
                        ' Try Inventor Summary Information
                        partNumber = oPartDoc.PropertySets.Item("Inventor Summary Information").Item("Part Number").Value.ToString()
                    Catch
                        ' Use filename without extension as fallback
                        partNumber = System.IO.Path.GetFileNameWithoutExtension(oPartDoc.FullFileName)
                    End Try
                End Try
            End Try
            
            ' Try multiple ways to get Title/Description
            Try
                ' First try Design Tracking Properties
                partTitle = oPartDoc.PropertySets.Item("Design Tracking Properties").Item("Description").Value.ToString()
            Catch
                Try
                    ' Try Summary Information
                    partTitle = oPartDoc.PropertySets.Item("Summary Information").Item("Title").Value.ToString()
                Catch
                    Try
                        ' Try Inventor Summary Information
                        partTitle = oPartDoc.PropertySets.Item("Inventor Summary Information").Item("Title").Value.ToString()
                    Catch
                        partTitle = "No Description"
                    End Try
                End Try
            End Try
            
            ' Clean up empty values
            If String.IsNullOrEmpty(partNumber) Then partNumber = "No Part Number"
            If String.IsNullOrEmpty(partTitle) Then partTitle = "No Description"
            
            ' Create new display name, preserving occurrence suffix (like :1, :2, etc.)
            Dim newDisplayName As String = partNumber & " - " & partTitle
            
            ' Check if the original name has an occurrence suffix (like :1, :2, etc.)
            Dim oldName As String = oOccurrence.Name
            Dim occurrenceSuffix As String = ""
            
            ' Look for pattern like ":1", ":2", etc. at the end of the name
            Dim colonIndex As Integer = oldName.LastIndexOf(":")
            If colonIndex > 0 Then
                Dim possibleSuffix As String = oldName.Substring(colonIndex)
                ' Check if it's a number after the colon
                Dim suffixNumber As Integer
                If Integer.TryParse(possibleSuffix.Substring(1), suffixNumber) Then
                    occurrenceSuffix = possibleSuffix
                End If
            End If
            
            ' Add the occurrence suffix back if it existed
            If occurrenceSuffix <> "" Then
                newDisplayName = newDisplayName & occurrenceSuffix
            End If
            
            ' Set the new display name for the occurrence
            oOccurrence.Name = newDisplayName
            
            processedCount = processedCount + 1
            debugInfo = debugInfo & "Updated: " & oldName & " → " & newDisplayName & vbCrLf
            
        Catch ex As Exception
            ' Continue processing other parts if one fails
            debugInfo = debugInfo & "Error processing: " & oOccurrence.Name & " - " & ex.Message & vbCrLf
        End Try
    Next
    
    ' Update the assembly
    oAssemblyDoc.Update()
    
    ' Show simple completion message
    Dim message As String = "Part names updated successfully!" & vbCrLf & vbCrLf & _
                           "Processed: " & processedCount.ToString() & " components" & vbCrLf & _
                           "Skipped: " & skippedCount.ToString() & " Content Center parts"
    
    MessageBox.Show(message, "Complete")
    
End Sub
```

---

### 135. iLogic Toggle Folders

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-toggle-folders/td-p/13836054](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-toggle-folders/td-p/13836054)

**Author:** jmckone9Z5PD

**Date:** ‎10-03-2025
	
		
		07:21 AM

**Description:** In a previous post I received the following:I created a basic test assembly 'Crank iLogic Folder Test' with 2 folders for crank options (Crank075, Crank100).  I have a few questions/issues:I am guessing that a parameter is required to select which option I want, in the real world there could easily ...

**Code Snippets (1):**

#### Code Block 1

```vb
Dim oPane1 As BrowserPane = ThisDoc.Document.BrowserPanes("Model")

'ensure list has the right values
MultiValue.SetList("CrankType", "Crank75", "Crank100")
oCrankName = CrankType 'get value of parameter

Dim oOcc As ComponentOccurrence

'llok at each folder
For Each oFolder In oPane1.TopNode.BrowserFolders
	'get the nodes in that folder
	Dim oFolderNodes = oFolder.BrowserNode.BrowserNodes
	'evalate it folder matches parameter name and hold that value as true or false
	Dim FolderIsCranktype As Boolean = (oFolder.Name = oCrankName)
	For Each oNode As BrowserNode In oFolderNodes
		oOcc = oNode.NativeObject
		'set active status of occurrence to matchthe value of ( folder name matches parameter value)
		Component.IsActive(oOcc.name) = FolderIsCranktype
	Next
Next
```

#### Code Block 2

```vb
Dim oPane1 As BrowserPane = ThisDoc.Document.BrowserPanes("Model")

'ensure list has the right values
MultiValue.SetList("CrankType", "Crank75", "Crank100")
oCrankName = CrankType 'get value of parameter

Dim oOcc As ComponentOccurrence

'llok at each folder
For Each oFolder In oPane1.TopNode.BrowserFolders
	'get the nodes in that folder
	Dim oFolderNodes = oFolder.BrowserNode.BrowserNodes
	'evalate it folder matches parameter name and hold that value as true or false
	Dim FolderIsCranktype As Boolean = (oFolder.Name = oCrankName)
	For Each oNode As BrowserNode In oFolderNodes
		oOcc = oNode.NativeObject
		'set active status of occurrence to matchthe value of ( folder name matches parameter value)
		Component.IsActive(oOcc.name) = FolderIsCranktype
	Next
Next
```

#### Code Block 3

```vb
Dim oPane1 As BrowserPane = ThisDoc.Document.BrowserPanes("Model")

'ensure list has the right values
MultiValue.SetList("CrankType", "Crank75", "Crank100")
oCrankName = CrankType 'get value of parameter

Dim oOcc As ComponentOccurrence

'llok at each folder
For Each oFolder In oPane1.TopNode.BrowserFolders
	'get the nodes in that folder
	Dim oFolderNodes = oFolder.BrowserNode.BrowserNodes
	'evalate it folder matches parameter name and hold that value as true or false
	Dim FolderIsCranktype As Boolean = (oFolder.Name = oCrankName)
	For Each oNode As BrowserNode In oFolderNodes
		oOcc = oNode.NativeObject
		'set active status of occurrence to matchthe value of ( folder name matches parameter value)
		Component.IsActive(oOcc.name) = FolderIsCranktype
	Next
Next
```

#### Code Block 4

```vb
Dim oPane1 As BrowserPane = ThisDoc.Document.BrowserPanes("Model")

'ensure list has the right values
MultiValue.SetList("CrankType", "Crank75", "Crank100")
oCrankName = CrankType 'get value of parameter

Dim oOcc As ComponentOccurrence

'llok at each folder
For Each oFolder In oPane1.TopNode.BrowserFolders
	'get the nodes in that folder
	Dim oFolderNodes = oFolder.BrowserNode.BrowserNodes
	'evalate it folder matches parameter name and hold that value as true or false
	Dim FolderIsCranktype As Boolean = (oFolder.Name = oCrankName)
	For Each oNode As BrowserNode In oFolderNodes
		oOcc = oNode.NativeObject
		'set active status of occurrence to matchthe value of ( folder name matches parameter value)
		Component.IsActive(oOcc.name) = FolderIsCranktype
	Next
Next
```

---

### 136. iLogic and Folders (again)

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-and-folders-again/td-p/13843458#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-and-folders-again/td-p/13843458#messageview_0)

**Author:** jmckone9Z5PD

**Date:** ‎10-08-2025
	
		
		06:33 AM

**Description:** A few new issues.  I tried the code from previous post and changed the user parameters as required (obviously missed something).  I get this error and all folders containing parts are suppressed (patterns not affected): [While I am at it - what happens if there is a folder inside a folder.  In this ...

**Code Snippets (1):**

#### Code Block 1

```vb
For Each oFolder In oPane1.TopNode.BrowserFolders
	'get the nodes in that folder
	Dim oFolderNodes = oFolder.BrowserNode.BrowserNodes
	'evaluate if folder matches parameter name and hold that value as true or false
	Dim FolderIsCranktype As Boolean = (oFolder.Name = oCrankName)
	For Each oNode As BrowserNode In oFolderNodes
		Try
			oOcc = oNode.NativeObject
		Catch
			Logger.Info("Could not get occurrence from node")
			Continue For
		End Try
		'set active status of occurrence to match the value of (folder name matches parameter value)
		Component.IsActive(oOcc.Name) = FolderIsCranktype
	Next
Next
```

#### Code Block 2

```vb
For Each oFolder In oPane1.TopNode.BrowserFolders
	'get the nodes in that folder
	Dim oFolderNodes = oFolder.BrowserNode.BrowserNodes
	'evaluate if folder matches parameter name and hold that value as true or false
	Dim FolderIsCranktype As Boolean = (oFolder.Name = oCrankName)
	For Each oNode As BrowserNode In oFolderNodes
		Try
			oOcc = oNode.NativeObject
		Catch
			Logger.Info("Could not get occurrence from node")
			Continue For
		End Try
		'set active status of occurrence to match the value of (folder name matches parameter value)
		Component.IsActive(oOcc.Name) = FolderIsCranktype
	Next
Next
```

---

### 137. iLogic for hide/show every possible object

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-for-hide-show-every-possible-object/td-p/13761985#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-for-hide-show-every-possible-object/td-p/13761985#messageview_0)

**Author:** b_kurt_ch

**Date:** ‎08-10-2025
	
		
		11:18 PM

**Description:** HelloSince Autodesk doesn't natively provide this functionality, I'd like to implement my own tool/iLogic to toggle the visibility of selected objects throughout the software.All features for which Inventor natively provides visibility functionality must be grouped into one code to manage them via a...

**Code Snippets (4):**

#### Code Block 1

```vb
Sub Main()

' iLogic: Sichtbarkeit umschalten je nach Dokumenttyp und Auswahl

Dim oDoc As Document = ThisApplication.ActiveDocument
Dim oSelSet As SelectSet = oDoc.SelectSet

If oSelSet.Count = 0 Then
    MsgBox("Selektiere zuerst etwas (Bauteil, Ebene, Skizze...)", vbExclamation)
    Return
End If

' Ursprüngliche Auswahl sichern
Dim savedSelection As New List(Of Object)
For Each oObj In oSelSet
    savedSelection.Add(oObj)
Next

For Each oObj In oSelSet
     Call ToggleVisibility(oObj)
Next

' Auswahl wiederherstellen
oSelSet.Clear()
For Each oObj In savedSelection
    Try
        oSelSet.Select(oObj)
    Catch
        ' Falls Objekt nicht mehr auswählbar ist (z.B. ausgeblendet)
    End Try
Next


End Sub

'--------------------------------------
' Hilfsfunktion: Sichtbarkeit umschalten
'--------------------------------------
Sub ToggleVisibility(oObj As Object)
    Try
        ' Falls das Objekt die Property "Visible" hat
        Dim t As Type = oObj.GetType()
        Dim p = t.GetProperty("Visible")
        If Not p Is Nothing Then
            Dim current As Boolean = CBool(p.GetValue(oObj, Nothing))
            p.SetValue(oObj, Not current, Nothing)
            Exit Sub
        End If
		
        ' Spezielle Fälle behandeln:
        If TypeOf oObj Is ComponentOccurrence Then
            oObj.Visible = Not oObj.Visible

        ' Skizzen im Part
        ElseIf TypeOf oObj Is PlanarSketch Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is Sketch3D Then
            oObj.Visible = Not oObj.Visible


        ' Skizzen in der Baugruppe (Proxy)
        ElseIf TypeOf oObj Is PlanarSketchProxy Then
		    Dim oProxy As PlanarSketchProxy = oObj
		    Dim oNative As PlanarSketch = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    
		    ' Occurrence im Assembly holen und sicherstellen, dass Skizzen angezeigt werden
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing Then
		        If oNative.Visible Then
		            occ.Visible = True ' Stellt sicher, dass Komponente sichtbar ist
		            occ.Parent.ShowComponentSketches = True ' Skizzenanzeige aktivieren
		        End If
		    End If
        ElseIf TypeOf oObj Is Sketch3DProxy Then
		    Dim oProxy As Sketch3DProxy = oObj
		    Dim oNative As Sketch3D = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing Then
		        If oNative.Visible Then
		            occ.Visible = True
		            occ.Parent.ShowComponentSketches = True
		        End If
		    End If


		' Arbeitsebenen
		ElseIf TypeOf oObj Is WorkPlane Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkPlaneProxy Then
		    Dim oProxy As WorkPlaneProxy = oObj
		    Dim oNative As WorkPlane = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    ' Sicherstellen, dass Arbeitsebenen in der Baugruppe angezeigt werden
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkPlanes = True
		    End If
		
		' Arbeitsachsen
		ElseIf TypeOf oObj Is WorkAxis Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkAxisProxy Then
		    Dim oProxy As WorkAxisProxy = oObj
		    Dim oNative As WorkAxis = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkAxes = True
		    End If
		
		' Arbeitspunkte
		ElseIf TypeOf oObj Is WorkPoint Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkPointProxy Then
		    Dim oProxy As WorkPointProxy = oObj
		    Dim oNative As WorkPoint = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkPoints = True
		    End If

		' Komponentenmuster Rund
		ElseIf TypeOf oObj Is CircularOccurrencePattern Then
   			 oObj.Visible = Not oObj.Visible

		' Komponentenmuster Rechteckig
		ElseIf TypeOf oObj Is RectangularOccurrencePattern Then
		    oObj.Visible = Not oObj.Visible
		
		' Flächenkörper
		ElseIf TypeOf oObj Is SurfaceBody Then
		    oObj.Visible = Not oObj.Visible

        ' Zeichnungselemente
        ElseIf TypeOf oObj Is DrawingCurveSegment Then
            oObj.Visible = Not oObj.Visible

        Else
             'Optional: Debug-Ausgabe für unbekannte Typen
			 MsgBox("Kein Sichtbarkeits-Flag für: " & TypeName(oObj) & vbCrLf & "Voller Name: " & oObj.GetType().FullName)
		End If

    Catch ex As Exception
        MsgBox("Fehler bei: " & oObj.ToString & vbCrLf & TypeName(oObj) & vbCrLf & ex.Message)
    End Try
End Sub
```

#### Code Block 2

```vb
Sub Main()

' iLogic: Sichtbarkeit umschalten je nach Dokumenttyp und Auswahl

Dim oDoc As Document = ThisApplication.ActiveDocument
Dim oSelSet As SelectSet = oDoc.SelectSet

If oSelSet.Count = 0 Then
    MsgBox("Selektiere zuerst etwas (Bauteil, Ebene, Skizze...)", vbExclamation)
    Return
End If

' Ursprüngliche Auswahl sichern
Dim savedSelection As New List(Of Object)
For Each oObj In oSelSet
    savedSelection.Add(oObj)
Next

For Each oObj In oSelSet
     Call ToggleVisibility(oObj)
Next

' Auswahl wiederherstellen
oSelSet.Clear()
For Each oObj In savedSelection
    Try
        oSelSet.Select(oObj)
    Catch
        ' Falls Objekt nicht mehr auswählbar ist (z.B. ausgeblendet)
    End Try
Next


End Sub

'--------------------------------------
' Hilfsfunktion: Sichtbarkeit umschalten
'--------------------------------------
Sub ToggleVisibility(oObj As Object)
    Try
        ' Falls das Objekt die Property "Visible" hat
        Dim t As Type = oObj.GetType()
        Dim p = t.GetProperty("Visible")
        If Not p Is Nothing Then
            Dim current As Boolean = CBool(p.GetValue(oObj, Nothing))
            p.SetValue(oObj, Not current, Nothing)
            Exit Sub
        End If
		
        ' Spezielle Fälle behandeln:
        If TypeOf oObj Is ComponentOccurrence Then
            oObj.Visible = Not oObj.Visible

        ' Skizzen im Part
        ElseIf TypeOf oObj Is PlanarSketch Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is Sketch3D Then
            oObj.Visible = Not oObj.Visible


        ' Skizzen in der Baugruppe (Proxy)
        ElseIf TypeOf oObj Is PlanarSketchProxy Then
		    Dim oProxy As PlanarSketchProxy = oObj
		    Dim oNative As PlanarSketch = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    
		    ' Occurrence im Assembly holen und sicherstellen, dass Skizzen angezeigt werden
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing Then
		        If oNative.Visible Then
		            occ.Visible = True ' Stellt sicher, dass Komponente sichtbar ist
		            occ.Parent.ShowComponentSketches = True ' Skizzenanzeige aktivieren
		        End If
		    End If
        ElseIf TypeOf oObj Is Sketch3DProxy Then
		    Dim oProxy As Sketch3DProxy = oObj
		    Dim oNative As Sketch3D = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing Then
		        If oNative.Visible Then
		            occ.Visible = True
		            occ.Parent.ShowComponentSketches = True
		        End If
		    End If


		' Arbeitsebenen
		ElseIf TypeOf oObj Is WorkPlane Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkPlaneProxy Then
		    Dim oProxy As WorkPlaneProxy = oObj
		    Dim oNative As WorkPlane = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    ' Sicherstellen, dass Arbeitsebenen in der Baugruppe angezeigt werden
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkPlanes = True
		    End If
		
		' Arbeitsachsen
		ElseIf TypeOf oObj Is WorkAxis Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkAxisProxy Then
		    Dim oProxy As WorkAxisProxy = oObj
		    Dim oNative As WorkAxis = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkAxes = True
		    End If
		
		' Arbeitspunkte
		ElseIf TypeOf oObj Is WorkPoint Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkPointProxy Then
		    Dim oProxy As WorkPointProxy = oObj
		    Dim oNative As WorkPoint = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkPoints = True
		    End If

		' Komponentenmuster Rund
		ElseIf TypeOf oObj Is CircularOccurrencePattern Then
   			 oObj.Visible = Not oObj.Visible

		' Komponentenmuster Rechteckig
		ElseIf TypeOf oObj Is RectangularOccurrencePattern Then
		    oObj.Visible = Not oObj.Visible
		
		' Flächenkörper
		ElseIf TypeOf oObj Is SurfaceBody Then
		    oObj.Visible = Not oObj.Visible

        ' Zeichnungselemente
        ElseIf TypeOf oObj Is DrawingCurveSegment Then
            oObj.Visible = Not oObj.Visible

        Else
             'Optional: Debug-Ausgabe für unbekannte Typen
			 MsgBox("Kein Sichtbarkeits-Flag für: " & TypeName(oObj) & vbCrLf & "Voller Name: " & oObj.GetType().FullName)
		End If

    Catch ex As Exception
        MsgBox("Fehler bei: " & oObj.ToString & vbCrLf & TypeName(oObj) & vbCrLf & ex.Message)
    End Try
End Sub
```

#### Code Block 3

```vb
Sub Main()

' iLogic: Sichtbarkeit umschalten je nach Dokumenttyp und Auswahl

Dim oDoc As Document = ThisApplication.ActiveDocument
Dim oSelSet As SelectSet = oDoc.SelectSet

If oSelSet.Count = 0 Then
    MsgBox("Selektiere zuerst etwas (Bauteil, Ebene, Skizze...)", vbExclamation)
    Return
End If

' Ursprüngliche Auswahl sichern
Dim savedSelection As New List(Of Object)
For Each oObj In oSelSet
    savedSelection.Add(oObj)
Next

For Each oObj In oSelSet
     Call ToggleVisibility(oObj)
Next

' Auswahl wiederherstellen
oSelSet.Clear()
For Each oObj In savedSelection
    Try
        oSelSet.Select(oObj)
    Catch
        ' Falls Objekt nicht mehr auswählbar ist (z.B. ausgeblendet)
    End Try
Next


End Sub

'--------------------------------------
' Hilfsfunktion: Sichtbarkeit umschalten
'--------------------------------------
Sub ToggleVisibility(oObj As Object)
    Try
        ' Falls das Objekt die Property "Visible" hat
        Dim t As Type = oObj.GetType()
        Dim p = t.GetProperty("Visible")
        If Not p Is Nothing Then
            Dim current As Boolean = CBool(p.GetValue(oObj, Nothing))
            p.SetValue(oObj, Not current, Nothing)
            Exit Sub
        End If
		
        ' Spezielle Fälle behandeln:
        If TypeOf oObj Is ComponentOccurrence Then
            oObj.Visible = Not oObj.Visible

        ' Skizzen im Part
        ElseIf TypeOf oObj Is PlanarSketch Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is Sketch3D Then
            oObj.Visible = Not oObj.Visible


        ' Skizzen in der Baugruppe (Proxy)
        ElseIf TypeOf oObj Is PlanarSketchProxy Then
		    Dim oProxy As PlanarSketchProxy = oObj
		    Dim oNative As PlanarSketch = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    
		    ' Occurrence im Assembly holen und sicherstellen, dass Skizzen angezeigt werden
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing Then
		        If oNative.Visible Then
		            occ.Visible = True ' Stellt sicher, dass Komponente sichtbar ist
		            occ.Parent.ShowComponentSketches = True ' Skizzenanzeige aktivieren
		        End If
		    End If
        ElseIf TypeOf oObj Is Sketch3DProxy Then
		    Dim oProxy As Sketch3DProxy = oObj
		    Dim oNative As Sketch3D = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing Then
		        If oNative.Visible Then
		            occ.Visible = True
		            occ.Parent.ShowComponentSketches = True
		        End If
		    End If


		' Arbeitsebenen
		ElseIf TypeOf oObj Is WorkPlane Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkPlaneProxy Then
		    Dim oProxy As WorkPlaneProxy = oObj
		    Dim oNative As WorkPlane = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    ' Sicherstellen, dass Arbeitsebenen in der Baugruppe angezeigt werden
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkPlanes = True
		    End If
		
		' Arbeitsachsen
		ElseIf TypeOf oObj Is WorkAxis Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkAxisProxy Then
		    Dim oProxy As WorkAxisProxy = oObj
		    Dim oNative As WorkAxis = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkAxes = True
		    End If
		
		' Arbeitspunkte
		ElseIf TypeOf oObj Is WorkPoint Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkPointProxy Then
		    Dim oProxy As WorkPointProxy = oObj
		    Dim oNative As WorkPoint = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkPoints = True
		    End If

		' Komponentenmuster Rund
		ElseIf TypeOf oObj Is CircularOccurrencePattern Then
   			 oObj.Visible = Not oObj.Visible

		' Komponentenmuster Rechteckig
		ElseIf TypeOf oObj Is RectangularOccurrencePattern Then
		    oObj.Visible = Not oObj.Visible
		
		' Flächenkörper
		ElseIf TypeOf oObj Is SurfaceBody Then
		    oObj.Visible = Not oObj.Visible

        ' Zeichnungselemente
        ElseIf TypeOf oObj Is DrawingCurveSegment Then
            oObj.Visible = Not oObj.Visible

        Else
             'Optional: Debug-Ausgabe für unbekannte Typen
			 MsgBox("Kein Sichtbarkeits-Flag für: " & TypeName(oObj) & vbCrLf & "Voller Name: " & oObj.GetType().FullName)
		End If

    Catch ex As Exception
        MsgBox("Fehler bei: " & oObj.ToString & vbCrLf & TypeName(oObj) & vbCrLf & ex.Message)
    End Try
End Sub
```

#### Code Block 4

```vb
Sub Main()

' iLogic: Sichtbarkeit umschalten je nach Dokumenttyp und Auswahl

Dim oDoc As Document = ThisApplication.ActiveDocument
Dim oSelSet As SelectSet = oDoc.SelectSet

If oSelSet.Count = 0 Then
    MsgBox("Selektiere zuerst etwas (Bauteil, Ebene, Skizze...)", vbExclamation)
    Return
End If

' Ursprüngliche Auswahl sichern
Dim savedSelection As New List(Of Object)
For Each oObj In oSelSet
    savedSelection.Add(oObj)
Next

For Each oObj In oSelSet
     Call ToggleVisibility(oObj)
Next

' Auswahl wiederherstellen
oSelSet.Clear()
For Each oObj In savedSelection
    Try
        oSelSet.Select(oObj)
    Catch
        ' Falls Objekt nicht mehr auswählbar ist (z.B. ausgeblendet)
    End Try
Next


End Sub

'--------------------------------------
' Hilfsfunktion: Sichtbarkeit umschalten
'--------------------------------------
Sub ToggleVisibility(oObj As Object)
    Try
        ' Falls das Objekt die Property "Visible" hat
        Dim t As Type = oObj.GetType()
        Dim p = t.GetProperty("Visible")
        If Not p Is Nothing Then
            Dim current As Boolean = CBool(p.GetValue(oObj, Nothing))
            p.SetValue(oObj, Not current, Nothing)
            Exit Sub
        End If
		
        ' Spezielle Fälle behandeln:
        If TypeOf oObj Is ComponentOccurrence Then
            oObj.Visible = Not oObj.Visible

        ' Skizzen im Part
        ElseIf TypeOf oObj Is PlanarSketch Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is Sketch3D Then
            oObj.Visible = Not oObj.Visible


        ' Skizzen in der Baugruppe (Proxy)
        ElseIf TypeOf oObj Is PlanarSketchProxy Then
		    Dim oProxy As PlanarSketchProxy = oObj
		    Dim oNative As PlanarSketch = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    
		    ' Occurrence im Assembly holen und sicherstellen, dass Skizzen angezeigt werden
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing Then
		        If oNative.Visible Then
		            occ.Visible = True ' Stellt sicher, dass Komponente sichtbar ist
		            occ.Parent.ShowComponentSketches = True ' Skizzenanzeige aktivieren
		        End If
		    End If
        ElseIf TypeOf oObj Is Sketch3DProxy Then
		    Dim oProxy As Sketch3DProxy = oObj
		    Dim oNative As Sketch3D = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing Then
		        If oNative.Visible Then
		            occ.Visible = True
		            occ.Parent.ShowComponentSketches = True
		        End If
		    End If


		' Arbeitsebenen
		ElseIf TypeOf oObj Is WorkPlane Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkPlaneProxy Then
		    Dim oProxy As WorkPlaneProxy = oObj
		    Dim oNative As WorkPlane = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    ' Sicherstellen, dass Arbeitsebenen in der Baugruppe angezeigt werden
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkPlanes = True
		    End If
		
		' Arbeitsachsen
		ElseIf TypeOf oObj Is WorkAxis Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkAxisProxy Then
		    Dim oProxy As WorkAxisProxy = oObj
		    Dim oNative As WorkAxis = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkAxes = True
		    End If
		
		' Arbeitspunkte
		ElseIf TypeOf oObj Is WorkPoint Then
		    oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is WorkPointProxy Then
		    Dim oProxy As WorkPointProxy = oObj
		    Dim oNative As WorkPoint = oProxy.NativeObject
		    oNative.Visible = Not oNative.Visible
		    Dim occ As ComponentOccurrence = oProxy.ContainingOccurrence
		    If Not occ Is Nothing AndAlso oNative.Visible Then
		        occ.Visible = True
		        occ.Parent.ShowComponentWorkPoints = True
		    End If

		' Komponentenmuster Rund
		ElseIf TypeOf oObj Is CircularOccurrencePattern Then
   			 oObj.Visible = Not oObj.Visible

		' Komponentenmuster Rechteckig
		ElseIf TypeOf oObj Is RectangularOccurrencePattern Then
		    oObj.Visible = Not oObj.Visible
		
		' Flächenkörper
		ElseIf TypeOf oObj Is SurfaceBody Then
		    oObj.Visible = Not oObj.Visible

        ' Zeichnungselemente
        ElseIf TypeOf oObj Is DrawingCurveSegment Then
            oObj.Visible = Not oObj.Visible

        Else
             'Optional: Debug-Ausgabe für unbekannte Typen
			 MsgBox("Kein Sichtbarkeits-Flag für: " & TypeName(oObj) & vbCrLf & "Voller Name: " & oObj.GetType().FullName)
		End If

    Catch ex As Exception
        MsgBox("Fehler bei: " & oObj.ToString & vbCrLf & TypeName(oObj) & vbCrLf & ex.Message)
    End Try
End Sub
```

#### Code Block 5

```vb
Sub Main()
' iLogic: Sichtbarkeit umschalten je nach Dokumenttyp und Auswahl

Dim oDoc As Document = ThisApplication.ActiveDocument
Dim oSelSet As SelectSet = oDoc.SelectSet

If oSelSet.Count = 0 Then
    MsgBox("Bitte mindestens ein Objekt auswählen.", vbExclamation)
    Return
End If

Select Case oDoc.DocumentType

    '------------------------------
    ' PART-Dokument (.ipt)
    '------------------------------
    Case DocumentTypeEnum.kPartDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    '------------------------------
    ' ASSEMBLY-Dokument (.iam)
    '------------------------------
    Case DocumentTypeEnum.kAssemblyDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    '------------------------------
    ' DRAWING-Dokument (.idw)
    '------------------------------
    Case DocumentTypeEnum.kDrawingDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    Case Else
        MsgBox("Dokumenttyp wird nicht unterstützt.", vbExclamation)
End Select

End Sub

'--------------------------------------
' Hilfsfunktion: Sichtbarkeit umschalten
'--------------------------------------
Sub ToggleVisibility(oObj As Object)
    Try
        ' Falls das Objekt die Property "Visible" hat
        Dim t As Type = oObj.GetType()
        Dim p = t.GetProperty("Visible")
        If Not p Is Nothing Then
            Dim current As Boolean = CBool(p.GetValue(oObj, Nothing))
            p.SetValue(oObj, Not current, Nothing)
            Exit Sub
        End If

        ' Spezielle Fälle behandeln:
        If TypeOf oObj Is ComponentOccurrence Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is Sketch Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkAxis Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkPlane Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkPoint Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is DrawingCurveSegment Then
            oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is DrawingCurve Then
            Dim oCurve As DrawingCurve = oObj
            Dim oOcc As ComponentOccurrence = oCurve.ModelGeometry.ContainingOccurrence
            If Not oOcc Is Nothing Then
                Dim oView As DrawingView = oCurve.Parent
                oView.SetVisibility(oOcc, Not oView.GetVisibility(oOcc))
            End If
        Else
            ' Optional: Debug-Ausgabe für nicht unterstützte Typen
            ' MsgBox("Kein Sichtbarkeits-Flag für: " & oObj.ToString)
        End If

    Catch ex As Exception
        MsgBox("Fehler bei: " & oObj.ToString & vbCrLf & ex.Message)
    End Try
End Sub
```

#### Code Block 6

```vb
Sub Main()
' iLogic: Sichtbarkeit umschalten je nach Dokumenttyp und Auswahl

Dim oDoc As Document = ThisApplication.ActiveDocument
Dim oSelSet As SelectSet = oDoc.SelectSet

If oSelSet.Count = 0 Then
    MsgBox("Bitte mindestens ein Objekt auswählen.", vbExclamation)
    Return
End If

Select Case oDoc.DocumentType

    '------------------------------
    ' PART-Dokument (.ipt)
    '------------------------------
    Case DocumentTypeEnum.kPartDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    '------------------------------
    ' ASSEMBLY-Dokument (.iam)
    '------------------------------
    Case DocumentTypeEnum.kAssemblyDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    '------------------------------
    ' DRAWING-Dokument (.idw)
    '------------------------------
    Case DocumentTypeEnum.kDrawingDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    Case Else
        MsgBox("Dokumenttyp wird nicht unterstützt.", vbExclamation)
End Select

End Sub

'--------------------------------------
' Hilfsfunktion: Sichtbarkeit umschalten
'--------------------------------------
Sub ToggleVisibility(oObj As Object)
    Try
        ' Falls das Objekt die Property "Visible" hat
        Dim t As Type = oObj.GetType()
        Dim p = t.GetProperty("Visible")
        If Not p Is Nothing Then
            Dim current As Boolean = CBool(p.GetValue(oObj, Nothing))
            p.SetValue(oObj, Not current, Nothing)
            Exit Sub
        End If

        ' Spezielle Fälle behandeln:
        If TypeOf oObj Is ComponentOccurrence Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is Sketch Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkAxis Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkPlane Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkPoint Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is DrawingCurveSegment Then
            oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is DrawingCurve Then
            Dim oCurve As DrawingCurve = oObj
            Dim oOcc As ComponentOccurrence = oCurve.ModelGeometry.ContainingOccurrence
            If Not oOcc Is Nothing Then
                Dim oView As DrawingView = oCurve.Parent
                oView.SetVisibility(oOcc, Not oView.GetVisibility(oOcc))
            End If
        Else
            ' Optional: Debug-Ausgabe für nicht unterstützte Typen
            ' MsgBox("Kein Sichtbarkeits-Flag für: " & oObj.ToString)
        End If

    Catch ex As Exception
        MsgBox("Fehler bei: " & oObj.ToString & vbCrLf & ex.Message)
    End Try
End Sub
```

#### Code Block 7

```vb
Sub Main()
' iLogic: Sichtbarkeit umschalten je nach Dokumenttyp und Auswahl

Dim oDoc As Document = ThisApplication.ActiveDocument
Dim oSelSet As SelectSet = oDoc.SelectSet

If oSelSet.Count = 0 Then
    MsgBox("Bitte mindestens ein Objekt auswählen.", vbExclamation)
    Return
End If

Select Case oDoc.DocumentType

    '------------------------------
    ' PART-Dokument (.ipt)
    '------------------------------
    Case DocumentTypeEnum.kPartDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    '------------------------------
    ' ASSEMBLY-Dokument (.iam)
    '------------------------------
    Case DocumentTypeEnum.kAssemblyDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    '------------------------------
    ' DRAWING-Dokument (.idw)
    '------------------------------
    Case DocumentTypeEnum.kDrawingDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    Case Else
        MsgBox("Dokumenttyp wird nicht unterstützt.", vbExclamation)
End Select

End Sub

'--------------------------------------
' Hilfsfunktion: Sichtbarkeit umschalten
'--------------------------------------
Sub ToggleVisibility(oObj As Object)
    Try
        ' Falls das Objekt die Property "Visible" hat
        Dim t As Type = oObj.GetType()
        Dim p = t.GetProperty("Visible")
        If Not p Is Nothing Then
            Dim current As Boolean = CBool(p.GetValue(oObj, Nothing))
            p.SetValue(oObj, Not current, Nothing)
            Exit Sub
        End If

        ' Spezielle Fälle behandeln:
        If TypeOf oObj Is ComponentOccurrence Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is Sketch Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkAxis Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkPlane Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkPoint Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is DrawingCurveSegment Then
            oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is DrawingCurve Then
            Dim oCurve As DrawingCurve = oObj
            Dim oOcc As ComponentOccurrence = oCurve.ModelGeometry.ContainingOccurrence
            If Not oOcc Is Nothing Then
                Dim oView As DrawingView = oCurve.Parent
                oView.SetVisibility(oOcc, Not oView.GetVisibility(oOcc))
            End If
        Else
            ' Optional: Debug-Ausgabe für nicht unterstützte Typen
            ' MsgBox("Kein Sichtbarkeits-Flag für: " & oObj.ToString)
        End If

    Catch ex As Exception
        MsgBox("Fehler bei: " & oObj.ToString & vbCrLf & ex.Message)
    End Try
End Sub
```

#### Code Block 8

```vb
Sub Main()
' iLogic: Sichtbarkeit umschalten je nach Dokumenttyp und Auswahl

Dim oDoc As Document = ThisApplication.ActiveDocument
Dim oSelSet As SelectSet = oDoc.SelectSet

If oSelSet.Count = 0 Then
    MsgBox("Bitte mindestens ein Objekt auswählen.", vbExclamation)
    Return
End If

Select Case oDoc.DocumentType

    '------------------------------
    ' PART-Dokument (.ipt)
    '------------------------------
    Case DocumentTypeEnum.kPartDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    '------------------------------
    ' ASSEMBLY-Dokument (.iam)
    '------------------------------
    Case DocumentTypeEnum.kAssemblyDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    '------------------------------
    ' DRAWING-Dokument (.idw)
    '------------------------------
    Case DocumentTypeEnum.kDrawingDocumentObject
        For Each oObj In oSelSet
            Call ToggleVisibility(oObj)
        Next

    Case Else
        MsgBox("Dokumenttyp wird nicht unterstützt.", vbExclamation)
End Select

End Sub

'--------------------------------------
' Hilfsfunktion: Sichtbarkeit umschalten
'--------------------------------------
Sub ToggleVisibility(oObj As Object)
    Try
        ' Falls das Objekt die Property "Visible" hat
        Dim t As Type = oObj.GetType()
        Dim p = t.GetProperty("Visible")
        If Not p Is Nothing Then
            Dim current As Boolean = CBool(p.GetValue(oObj, Nothing))
            p.SetValue(oObj, Not current, Nothing)
            Exit Sub
        End If

        ' Spezielle Fälle behandeln:
        If TypeOf oObj Is ComponentOccurrence Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is Sketch Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkAxis Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkPlane Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is WorkPoint Then
            oObj.Visible = Not oObj.Visible
        ElseIf TypeOf oObj Is DrawingCurveSegment Then
            oObj.Visible = Not oObj.Visible
		ElseIf TypeOf oObj Is DrawingCurve Then
            Dim oCurve As DrawingCurve = oObj
            Dim oOcc As ComponentOccurrence = oCurve.ModelGeometry.ContainingOccurrence
            If Not oOcc Is Nothing Then
                Dim oView As DrawingView = oCurve.Parent
                oView.SetVisibility(oOcc, Not oView.GetVisibility(oOcc))
            End If
        Else
            ' Optional: Debug-Ausgabe für nicht unterstützte Typen
            ' MsgBox("Kein Sichtbarkeits-Flag für: " & oObj.ToString)
        End If

    Catch ex As Exception
        MsgBox("Fehler bei: " & oObj.ToString & vbCrLf & ex.Message)
    End Try
End Sub
```

---

### 138. iLogic get preparation drawing view document

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-get-preparation-drawing-view-document/td-p/13804570](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-get-preparation-drawing-view-document/td-p/13804570)

**Author:** Nejc.Leban

**Date:** ‎09-10-2025
	
		
		05:00 AM

**Description:** Hello everyone, I'm trying to get the part document of a "Preparation" placed drawing view. On the image below, 10796-07-001-00.iam is the main weldment document. VIEW719 is pos.8 and VIEW720 is pos.11 (10796-06-001-11.ipt). These two are placed on the drawing via Place Views - Base - Model - Prepar...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oView As DrawingView
oView = oInvApp.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select View...")
If oView Is Nothing Then Exit Sub
Dim eWeld As WeldmentStateEnum
Dim oObj As Object
Call oView.GetWeldmentState(eWeld, oObj)
If Not eWeld = WeldmentStateEnum.kPreparationsWeldmentState Then Exit Sub
Dim oOcc As ComponentOccurrence = oObj
MessageBox.Show(oOcc.Name, eWeld.ToString())
```

#### Code Block 2

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oView As DrawingView
oView = oInvApp.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select View...")
If oView Is Nothing Then Exit Sub
Dim eWeld As WeldmentStateEnum
Dim oObj As Object
Call oView.GetWeldmentState(eWeld, oObj)
If Not eWeld = WeldmentStateEnum.kPreparationsWeldmentState Then Exit Sub
Dim oOcc As ComponentOccurrence = oObj
MessageBox.Show(oOcc.Name, eWeld.ToString())
```

#### Code Block 3

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oView As DrawingView
oView = oInvApp.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select View...")
If oView Is Nothing Then Exit Sub
Dim eWeld As WeldmentStateEnum
Dim oObj As Object
Call oView.GetWeldmentState(eWeld, oObj)
If Not eWeld = WeldmentStateEnum.kPreparationsWeldmentState Then Exit Sub
Dim oOcc As ComponentOccurrence = oObj
MessageBox.Show(oOcc.Name, eWeld.ToString())
```

#### Code Block 4

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oView As DrawingView
oView = oInvApp.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select View...")
If oView Is Nothing Then Exit Sub
Dim eWeld As WeldmentStateEnum
Dim oObj As Object
Call oView.GetWeldmentState(eWeld, oObj)
If Not eWeld = WeldmentStateEnum.kPreparationsWeldmentState Then Exit Sub
Dim oOcc As ComponentOccurrence = oObj
MessageBox.Show(oOcc.Name, eWeld.ToString())
```

#### Code Block 5

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oView As DrawingView
oView = oInvApp.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select View...")
If oView Is Nothing Then Exit Sub
Dim eWeld As WeldmentStateEnum
Dim oObj As Object
Call oView.GetWeldmentState(eWeld, oObj)
If Not eWeld = WeldmentStateEnum.kPreparationsWeldmentState Then Exit Sub
Dim oOcc As ComponentOccurrence = oObj
MessageBox.Show(oOcc.Name, eWeld.ToString())
```

#### Code Block 6

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oView As DrawingView
oView = oInvApp.CommandManager.Pick(SelectionFilterEnum.kDrawingViewFilter, "Select View...")
If oView Is Nothing Then Exit Sub
Dim eWeld As WeldmentStateEnum
Dim oObj As Object
Call oView.GetWeldmentState(eWeld, oObj)
If Not eWeld = WeldmentStateEnum.kPreparationsWeldmentState Then Exit Sub
Dim oOcc As ComponentOccurrence = oObj
MessageBox.Show(oOcc.Name, eWeld.ToString())
```

---

### 139. iLogic not finding sheet and column

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-not-finding-sheet-and-column/td-p/10931075](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-not-finding-sheet-and-column/td-p/10931075)

**Author:** jonathan.victor

**Date:** ‎02-05-2022
	
		
		02:59 PM

**Description:** I have an assembly, them i embed an excel xlsx via object insert command, run the code below,  i = GoExcel.FindRow("Embedding 8", "Plan1", "DIAM_EIXO", "=", 200) Then iLogic throws error:GoExcel: Could not match the column title: "DIAM_EIXO"  As you see the start cell in fact have the same and corre...

**Code Snippets (1):**

#### Code Block 1

```vb
i = GoExcel.FindRow("Embedding 8", "Plan1", "DIAM_EIXO", "=", 200)
```

#### Code Block 2

```vb
i = GoExcel.FindRow("Embedding 8", "Plan1", "DIAM_EIXO", "=", 200)
```

---

### 140. iLogic to Apply Multiple Drawing Styles Based on User Parameter (Dimensions, GD&amp;T, Leaders, Datums)

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-to-apply-multiple-drawing-styles-based-on-user-parameter/td-p/13755516#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-to-apply-multiple-drawing-styles-based-on-user-parameter/td-p/13755516#messageview_0)

**Author:** sj_leeSN79P

**Date:** ‎08-05-2025
	
		
		10:17 PM

**Description:** Hello Inventor Community,I'm working on creating an iLogic rule in Inventor drawing environment that can automatically apply multiple drawing styles based on a user parameter value.What I want to achieve:I've created a user parameter named "Type" with values "a" and "b". I want to:When "Type" parame...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument

Dim oFCFStyle As FeatureControlFrameStyle = oDoc.StylesManager.FeatureControlFrameStyles.Item("GDT1")
Dim oDimStyle As Style = oDoc.StylesManager.Styles.Item("Dim Style1")
Dim oLStyle = oDoc.StylesManager.LeaderStyles.Item("Leader1")

For Each oSheet As Sheet In oDoc.Sheets
	For Each oFCF As FeatureControlFrame In oSheet.FeatureControlFrames
		oFCF.Style = oFCFStyle
	Next 
	For Each oDim As GeneralDimension In oSheet.DrawingDimensions.GeneralDimensions
		oDim.Style = oDimStyle
	Next 
	For Each oLeader As LeaderNote In oSheet.DrawingNotes.LeaderNotes
		oLeader.DimensionStyle = oLStyle
	Next 
Next
```

#### Code Block 2

```vb
Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument

Dim oFCFStyle As FeatureControlFrameStyle = oDoc.StylesManager.FeatureControlFrameStyles.Item("GDT1")
Dim oDimStyle As Style = oDoc.StylesManager.Styles.Item("Dim Style1")
Dim oLStyle = oDoc.StylesManager.LeaderStyles.Item("Leader1")

For Each oSheet As Sheet In oDoc.Sheets
	For Each oFCF As FeatureControlFrame In oSheet.FeatureControlFrames
		oFCF.Style = oFCFStyle
	Next 
	For Each oDim As GeneralDimension In oSheet.DrawingDimensions.GeneralDimensions
		oDim.Style = oDimStyle
	Next 
	For Each oLeader As LeaderNote In oSheet.DrawingNotes.LeaderNotes
		oLeader.DimensionStyle = oLStyle
	Next 
Next
```

#### Code Block 3

```vb
Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument

Dim oFCFStyle As FeatureControlFrameStyle = oDoc.StylesManager.FeatureControlFrameStyles.Item("GDT1")
Dim oDimStyle As Style = oDoc.StylesManager.Styles.Item("Dim Style1")
Dim oLStyle = oDoc.StylesManager.LeaderStyles.Item("Leader1")

For Each oSheet As Sheet In oDoc.Sheets
	For Each oFCF As FeatureControlFrame In oSheet.FeatureControlFrames
		oFCF.Style = oFCFStyle
	Next 
	For Each oDim As GeneralDimension In oSheet.DrawingDimensions.GeneralDimensions
		oDim.Style = oDimStyle
	Next 
	For Each oLeader As LeaderNote In oSheet.DrawingNotes.LeaderNotes
		oLeader.DimensionStyle = oLStyle
	Next 
Next
```

#### Code Block 4

```vb
Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument

Dim oFCFStyle As FeatureControlFrameStyle = oDoc.StylesManager.FeatureControlFrameStyles.Item("GDT1")
Dim oDimStyle As Style = oDoc.StylesManager.Styles.Item("Dim Style1")
Dim oLStyle = oDoc.StylesManager.LeaderStyles.Item("Leader1")

For Each oSheet As Sheet In oDoc.Sheets
	For Each oFCF As FeatureControlFrame In oSheet.FeatureControlFrames
		oFCF.Style = oFCFStyle
	Next 
	For Each oDim As GeneralDimension In oSheet.DrawingDimensions.GeneralDimensions
		oDim.Style = oDimStyle
	Next 
	For Each oLeader As LeaderNote In oSheet.DrawingNotes.LeaderNotes
		oLeader.DimensionStyle = oLStyle
	Next 
Next
```

#### Code Block 5

```vb
Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument

Dim oFCFStyle As FeatureControlFrameStyle = oDoc.StylesManager.FeatureControlFrameStyles.Item("GDT1")
Dim oDimStyle As Style = oDoc.StylesManager.Styles.Item("Dim Style1")
Dim oLStyle = oDoc.StylesManager.LeaderStyles.Item("Leader1")

For Each oSheet As Sheet In oDoc.Sheets
	For Each oFCF As FeatureControlFrame In oSheet.FeatureControlFrames
		oFCF.Style = oFCFStyle
	Next 
	For Each oDim As GeneralDimension In oSheet.DrawingDimensions.GeneralDimensions
		oDim.Style = oDimStyle
	Next 
	For Each oLeader As LeaderNote In oSheet.DrawingNotes.LeaderNotes
		oLeader.DimensionStyle = oLStyle
	Next 
Next
```

#### Code Block 6

```vb
Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument

Dim oFCFStyle As FeatureControlFrameStyle = oDoc.StylesManager.FeatureControlFrameStyles.Item("GDT1")
Dim oDimStyle As Style = oDoc.StylesManager.Styles.Item("Dim Style1")
Dim oLStyle = oDoc.StylesManager.LeaderStyles.Item("Leader1")

For Each oSheet As Sheet In oDoc.Sheets
	For Each oFCF As FeatureControlFrame In oSheet.FeatureControlFrames
		oFCF.Style = oFCFStyle
	Next 
	For Each oDim As GeneralDimension In oSheet.DrawingDimensions.GeneralDimensions
		oDim.Style = oDimStyle
	Next 
	For Each oLeader As LeaderNote In oSheet.DrawingNotes.LeaderNotes
		oLeader.DimensionStyle = oLStyle
	Next 
Next
```

---

### 141. iLogic to Rename Browser Nodes to &quot;Default&quot; setting?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-to-rename-browser-nodes-to-quot-default-quot-setting/td-p/12448415#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-to-rename-browser-nodes-to-quot-default-quot-setting/td-p/12448415#messageview_0)

**Author:** mtresky

**Date:** ‎12-18-2023
	
		
		07:30 AM

**Description:** Hi, I am trying to automate the renaming of browser nodes to the default setting (see screen shot below).I know how to cycle through nodes and rename them, but I am hoping there is a way to run the command which already does this?  For the user to do this, it is 5-6 mouse clicks, just looking for a ...

**Code Snippets (6):**

#### Code Block 1

```vb
Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
If oADoc Is Nothing Then Return
For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
	Dim sPN As String = iProperties.Value(oOcc.Name, "Project", "Part Number")
	Try
		oOcc.Name = sPN
	Catch
		Logger.Error("Could not rename component named: " & oOcc.Name _
		& vbCrLf & "to: " & sPN)
	End Try
Next
oADoc.Update2(True)
```

#### Code Block 2

```vb
Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
If oADoc Is Nothing Then Return
For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
	Dim sPN As String = iProperties.Value(oOcc.Name, "Project", "Part Number")
	Try
		oOcc.Name = sPN
	Catch
		Logger.Error("Could not rename component named: " & oOcc.Name _
		& vbCrLf & "to: " & sPN)
	End Try
Next
oADoc.Update2(True)
```

#### Code Block 3

```vb
Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
If oADoc Is Nothing Then Return
For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
	Dim sPN As String = iProperties.Value(oOcc.Name, "Project", "Part Number")
	Try
		oOcc.Name = sPN
	Catch
		Logger.Error("Could not rename component named: " & oOcc.Name _
		& vbCrLf & "to: " & sPN)
	End Try
Next
oADoc.Update2(True)
```

#### Code Block 4

```vb
Dim oADoc As AssemblyDocument = TryCast(ThisDoc.Document, Inventor.AssemblyDocument)
If oADoc Is Nothing Then Return
For Each oOcc As ComponentOccurrence In oADoc.ComponentDefinition.Occurrences
	Dim sPN As String = iProperties.Value(oOcc.Name, "Project", "Part Number")
	Try
		oOcc.Name = sPN
	Catch
		Logger.Error("Could not rename component named: " & oOcc.Name _
		& vbCrLf & "to: " & sPN)
	End Try
Next
oADoc.Update2(True)
```

#### Code Block 5

```vb
For Each occ As ComponentOccurrence In ThisApplication.ActiveDocument.ComponentDefinition.Occurrences
	occ.Name = ""
Next
```

#### Code Block 6

```vb
For Each occ As ComponentOccurrence In ThisApplication.ActiveDocument.ComponentDefinition.Occurrences
	occ.Name = ""
Next
```

#### Code Block 7

```vb
For Each occ As ComponentOccurrence In ThisApplication.ActiveDocument.ComponentDefinition.Occurrences
	occ.Name = ""
Next
```

#### Code Block 8

```vb
For Each occ As ComponentOccurrence In ThisApplication.ActiveDocument.ComponentDefinition.Occurrences
	occ.Name = ""
Next
```

#### Code Block 9

```vb
For Each occ As ComponentOccurrence In ThisApplication.ActiveDocument.ComponentDefinition.Occurrences
	occ.Name = "Part Number"
Next
```

#### Code Block 10

```vb
For Each occ As ComponentOccurrence In ThisApplication.ActiveDocument.ComponentDefinition.Occurrences
	occ.Name = "Part Number"
Next
```

#### Code Block 11

```vb
For Each occ As ComponentOccurrence In ThisApplication.ActiveDocument.ComponentDefinition.Occurrences
	occ.Name = "Part Number"
Next
```

#### Code Block 12

```vb
For Each occ As ComponentOccurrence In ThisApplication.ActiveDocument.ComponentDefinition.Occurrences
	occ.Name = "Part Number"
Next
```

---

### 142. iLogic to extract Sheet Metal Data

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-to-extract-sheet-metal-data/td-p/13789124](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-to-extract-sheet-metal-data/td-p/13789124)

**Author:** b.mccarthy

**Date:** ‎08-29-2025
	
		
		12:44 PM

**Description:** Hello. I have been using a rule I found on this forum. I do not know who wrote it: 'Checks to see if kFactor, SheetStyle, FlatLength & FlatWidth parameters exist, and generates them, if not  'Source code for text parameter check  'Dim oPartDoc As PartDocument = ThisDoc.Document 'Dim oPartCompDef As ...

**Code Snippets (3):**

#### Code Block 1

```vb
'Checks to see if kFactor, SheetStyle, FlatLength & FlatWidth parameters exist, and generates them, if not

'Source code for text parameter check

'Dim oPartDoc As PartDocument = ThisDoc.Document
'Dim oPartCompDef As PartComponentDefinition = oPartDoc.ComponentDefinition
'oParams = oPartCompDef.Parameters
'Dim oUserParams As UserParameters = oParams.UserParameters

'Try
'  p = Parameter("MyParameter")
'Catch
'  oUserParams.AddByValue("MyParameter","MyValue", UnitsTypeEnum.kTextUnits)
'End Try

Dim oApp As Inventor.Application = ThisApplication
Dim oParams As Parameters
'Dim oPartDoc As PartDocument = oApp.ActiveDocument
Dim oPartDoc As PartDocument = ThisDoc.Document
Dim oPartCompDef As PartComponentDefinition = oPartDoc.ComponentDefinition
oParams = oPartCompDef.Parameters
Dim oUserParams As UserParameters = oParams.UserParameters

'kFactor
Try
  p = Parameter("kFactor")
Catch
  oUserParams.AddByValue("kFactor", SheetMetal.ActiveKFactor, UnitsTypeEnum.kUnitlessUnits)
End Try
Parameter("kFactor") = SheetMetal.ActiveKFactor
iProperties.Value("Custom", "kFactor") = SheetMetal.ActiveKFactor

'SheetStyle
Try
  p = Parameter("SheetStyle")
Catch
  oUserParams.AddByValue("SheetStyle", SheetMetal.GetActiveStyle(), UnitsTypeEnum.kTextUnits)
End Try
Parameter("SheetStyle") = SheetMetal.GetActiveStyle() 
iProperties.Value("Custom", "Sheet Style") = SheetMetal.GetActiveStyle() 

'FlatLength
Try
  p = Parameter("FlatLength")
Catch
  oUserParams.AddByValue("FlatLength", SheetMetal.FlatExtentsLength, UnitsTypeEnum.kDefaultDisplayLengthUnits)
End Try
Parameter("FlatLength") = SheetMetal.FlatExtentsLength

'FlatWidth
Try
  p = Parameter("FlatWidth")
Catch
  oUserParams.AddByValue("FlatWidth", SheetMetal.FlatExtentsWidth, UnitsTypeEnum.kDefaultDisplayLengthUnits)
End Try
Parameter("FlatWidth") = SheetMetal.FlatExtentsWidth

'dArea
Try
  p = Parameter("dArea")
Catch
  oUserParams.AddByValue("dArea", 0, "ul")
End Try

'FlatArea
Try
  p = Parameter("FlatArea")
Catch
  oUserParams.AddByValue("FlatArea", 0, "ft^2")
End Try



'Forces update after rule runs 
iLogicVb.UpdateWhenDone = True
```

#### Code Block 2

```vb
'Checks to see if kFactor, SheetStyle, FlatLength & FlatWidth parameters exist, and generates them, if not

'Source code for text parameter check

'Dim oPartDoc As PartDocument = ThisDoc.Document
'Dim oPartCompDef As PartComponentDefinition = oPartDoc.ComponentDefinition
'oParams = oPartCompDef.Parameters
'Dim oUserParams As UserParameters = oParams.UserParameters

'Try
'  p = Parameter("MyParameter")
'Catch
'  oUserParams.AddByValue("MyParameter","MyValue", UnitsTypeEnum.kTextUnits)
'End Try

Dim oApp As Inventor.Application = ThisApplication
Dim oParams As Parameters
'Dim oPartDoc As PartDocument = oApp.ActiveDocument
Dim oPartDoc As PartDocument = ThisDoc.Document
Dim oPartCompDef As PartComponentDefinition = oPartDoc.ComponentDefinition
oParams = oPartCompDef.Parameters
Dim oUserParams As UserParameters = oParams.UserParameters

'kFactor
Try
  p = Parameter("kFactor")
Catch
  oUserParams.AddByValue("kFactor", SheetMetal.ActiveKFactor, UnitsTypeEnum.kUnitlessUnits)
End Try
Parameter("kFactor") = SheetMetal.ActiveKFactor
iProperties.Value("Custom", "kFactor") = SheetMetal.ActiveKFactor

'SheetStyle
Try
  p = Parameter("SheetStyle")
Catch
  oUserParams.AddByValue("SheetStyle", SheetMetal.GetActiveStyle(), UnitsTypeEnum.kTextUnits)
End Try
Parameter("SheetStyle") = SheetMetal.GetActiveStyle() 
iProperties.Value("Custom", "Sheet Style") = SheetMetal.GetActiveStyle() 

'FlatLength
Try
  p = Parameter("FlatLength")
Catch
  oUserParams.AddByValue("FlatLength", SheetMetal.FlatExtentsLength, UnitsTypeEnum.kDefaultDisplayLengthUnits)
End Try
Parameter("FlatLength") = SheetMetal.FlatExtentsLength

'FlatWidth
Try
  p = Parameter("FlatWidth")
Catch
  oUserParams.AddByValue("FlatWidth", SheetMetal.FlatExtentsWidth, UnitsTypeEnum.kDefaultDisplayLengthUnits)
End Try
Parameter("FlatWidth") = SheetMetal.FlatExtentsWidth

'dArea
Try
  p = Parameter("dArea")
Catch
  oUserParams.AddByValue("dArea", 0, "ul")
End Try

'FlatArea
Try
  p = Parameter("FlatArea")
Catch
  oUserParams.AddByValue("FlatArea", 0, "ft^2")
End Try



'Forces update after rule runs 
iLogicVb.UpdateWhenDone = True
```

#### Code Block 3

```vb
Dim doc As PartDocument = ThisDoc.Document
Dim FlatArea As SheetMetalComponentDefinition = doc.ComponentDefinition

Parameter("FlatArea") = FlatArea.FlatPattern.TopFace.Evaluator.Area / 6.4516
```

#### Code Block 4

```vb
Dim doc As PartDocument = ThisDoc.Document
Dim FlatArea As SheetMetalComponentDefinition = doc.ComponentDefinition

Parameter("FlatArea") = FlatArea.FlatPattern.TopFace.Evaluator.Area / 6.4516
```

#### Code Block 5

```vb
Dim doc As PartDocument = ThisDoc.Document
Dim def As SheetMetalComponentDefinition = doc.ComponentDefinition
MsgBox(def.FlatPattern.TopFace.Evaluator.Area & "cm^2")
```

#### Code Block 6

```vb
Dim doc As PartDocument = ThisDoc.Document
Dim def As SheetMetalComponentDefinition = doc.ComponentDefinition
MsgBox(def.FlatPattern.TopFace.Evaluator.Area & "cm^2")
```

---

### 143. iLogic to quickly add PDF as PNG background into current activ drawing

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-to-quickly-add-pdf-as-png-background-into-current-activ/td-p/13757564#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-to-quickly-add-pdf-as-png-background-into-current-activ/td-p/13757564#messageview_0)

**Author:** ProductivCADUser

**Date:** ‎08-07-2025
	
		
		01:17 AM

**Description:** Can the following function be realised with iLogic?Or at least part of it (maybe step 3 for png file with local file selection dialog)?1. select a PDF from a local folder2. convert this PDF to PNG with 300-600dpi3. insert this PNG as an unlinked object into the current Inventor drawing, see picture ...

**Code Snippets (4):**

#### Code Block 1

```vb
Option Explicit

Sub Import_Excel()
    
    
    Dim xlApp As Object 'Excel.Application
    Dim xlWB As Variant
    Dim xlWS As Excel.WorkSheet
    
    Dim xlPath As String
    Dim xlFile As String
    Dim JobNo As Long
    Dim xlTotalPath As String
    
    Dim LastRow As Long
    
  
        JobNo = GetJobNumber() 'pass function into this location to make the document follow the job number dynamically.
    
        xlPath = "Path" & JobNo & "\"   
        xlFile = JobNo & "_Chart.xlsx"
        
    
    If JobNo > 37599 Then
        MsgBox "Job range exceeded, please notify programer"
        Exit Sub
    End If

    xlTotalPath = xlPath & xlFile
         'MsgBox xlTotalPath
    
         'Next section attempts to open the excel document off the given variables.
    Set xlApp = CreateObject("Excel.Application")
    xlApp.Visible = False
   
        'The below error change is required to dodge a dialog box that has no effect upon the opening of the document.
        
        On Error Resume Next
        If Dir(xlTotalPath) = "" Then
            'MsgBox "File not found " & xlTotalPath & " Make sure the nozzel fitting chart has been created and exported to job folder"
            Exit Sub
        Else
            Set xlWB = xlApp.Workbooks.Open(xlTotalPath)
        End If
        On Error GoTo 0
    
    
        If xlWB Is Nothing Then
            MsgBox "workbook not loaded"
        End If
    
            Set xlWS = xlWB.Sheets("Sheet1")
    
            LastRow = FindNotesLastRow(xlWS)
        
            ' MsgBox "LastRow: " & LastRow
            ' MsgBox "FindLast " & FindNotesLastRow(xlWS)
        
        xlWS.Range("A1:N" & LastRow).Copy
        
        Dim CtrlDef As Inventor.ControlDefinition
        Set CtrlDef = ThisApplication.CommandManager.ControlDefinitions.Item("AppPasteSpecialCmd")
        
        CtrlDef.Enabled = True
        CtrlDef.Execute '(True)

        xlWB.Application.CutCopyMode = False
        xlWB.Close (True)
        xlApp.Quit
End Sub


Function GetJobNumber()
    'Added later to parse for the current job number automatically.
    'This will then get passed into the jobNo variable within the main to grab the correct document.

    Dim odoc As DrawingDocument
    Set odoc = ThisApplication.ActiveDocument
  
    Dim iProperties As PropertySet
    Set iProperties = odoc.PropertySets.Item("Design Tracking Properties")
    
    Dim JobProperty As Property
    Set JobProperty = iProperties.Item("Project")
    
    Dim JobNumber As Long
    JobNumber = CLng(JobProperty.Value)
    
    GetJobNumber = JobNumber
    
End Function


Function FindNotesLastRow(xlWS As Excel.WorkSheet) As Long

        Dim Cell As Range
        Dim NotesRow As Long
        
        NotesRow = xlWS.Cells(xlWS.Rows.Count, "A").End(xlUp).Row
  
        
        FindNotesLastRow = NotesRow
        
End Function
```

#### Code Block 2

```vb
Option Explicit

Sub Import_Excel()
    
    
    Dim xlApp As Object 'Excel.Application
    Dim xlWB As Variant
    Dim xlWS As Excel.WorkSheet
    
    Dim xlPath As String
    Dim xlFile As String
    Dim JobNo As Long
    Dim xlTotalPath As String
    
    Dim LastRow As Long
    
  
        JobNo = GetJobNumber() 'pass function into this location to make the document follow the job number dynamically.
    
        xlPath = "Path" & JobNo & "\"   
        xlFile = JobNo & "_Chart.xlsx"
        
    
    If JobNo > 37599 Then
        MsgBox "Job range exceeded, please notify programer"
        Exit Sub
    End If

    xlTotalPath = xlPath & xlFile
         'MsgBox xlTotalPath
    
         'Next section attempts to open the excel document off the given variables.
    Set xlApp = CreateObject("Excel.Application")
    xlApp.Visible = False
   
        'The below error change is required to dodge a dialog box that has no effect upon the opening of the document.
        
        On Error Resume Next
        If Dir(xlTotalPath) = "" Then
            'MsgBox "File not found " & xlTotalPath & " Make sure the nozzel fitting chart has been created and exported to job folder"
            Exit Sub
        Else
            Set xlWB = xlApp.Workbooks.Open(xlTotalPath)
        End If
        On Error GoTo 0
    
    
        If xlWB Is Nothing Then
            MsgBox "workbook not loaded"
        End If
    
            Set xlWS = xlWB.Sheets("Sheet1")
    
            LastRow = FindNotesLastRow(xlWS)
        
            ' MsgBox "LastRow: " & LastRow
            ' MsgBox "FindLast " & FindNotesLastRow(xlWS)
        
        xlWS.Range("A1:N" & LastRow).Copy
        
        Dim CtrlDef As Inventor.ControlDefinition
        Set CtrlDef = ThisApplication.CommandManager.ControlDefinitions.Item("AppPasteSpecialCmd")
        
        CtrlDef.Enabled = True
        CtrlDef.Execute '(True)

        xlWB.Application.CutCopyMode = False
        xlWB.Close (True)
        xlApp.Quit
End Sub


Function GetJobNumber()
    'Added later to parse for the current job number automatically.
    'This will then get passed into the jobNo variable within the main to grab the correct document.

    Dim odoc As DrawingDocument
    Set odoc = ThisApplication.ActiveDocument
  
    Dim iProperties As PropertySet
    Set iProperties = odoc.PropertySets.Item("Design Tracking Properties")
    
    Dim JobProperty As Property
    Set JobProperty = iProperties.Item("Project")
    
    Dim JobNumber As Long
    JobNumber = CLng(JobProperty.Value)
    
    GetJobNumber = JobNumber
    
End Function


Function FindNotesLastRow(xlWS As Excel.WorkSheet) As Long

        Dim Cell As Range
        Dim NotesRow As Long
        
        NotesRow = xlWS.Cells(xlWS.Rows.Count, "A").End(xlUp).Row
  
        
        FindNotesLastRow = NotesRow
        
End Function
```

#### Code Block 3

```vb
Option Explicit

Sub Import_Excel()
    
    
    Dim xlApp As Object 'Excel.Application
    Dim xlWB As Variant
    Dim xlWS As Excel.WorkSheet
    
    Dim xlPath As String
    Dim xlFile As String
    Dim JobNo As Long
    Dim xlTotalPath As String
    
    Dim LastRow As Long
    
  
        JobNo = GetJobNumber() 'pass function into this location to make the document follow the job number dynamically.
    
        xlPath = "Path" & JobNo & "\"   
        xlFile = JobNo & "_Chart.xlsx"
        
    
    If JobNo > 37599 Then
        MsgBox "Job range exceeded, please notify programer"
        Exit Sub
    End If

    xlTotalPath = xlPath & xlFile
         'MsgBox xlTotalPath
    
         'Next section attempts to open the excel document off the given variables.
    Set xlApp = CreateObject("Excel.Application")
    xlApp.Visible = False
   
        'The below error change is required to dodge a dialog box that has no effect upon the opening of the document.
        
        On Error Resume Next
        If Dir(xlTotalPath) = "" Then
            'MsgBox "File not found " & xlTotalPath & " Make sure the nozzel fitting chart has been created and exported to job folder"
            Exit Sub
        Else
            Set xlWB = xlApp.Workbooks.Open(xlTotalPath)
        End If
        On Error GoTo 0
    
    
        If xlWB Is Nothing Then
            MsgBox "workbook not loaded"
        End If
    
            Set xlWS = xlWB.Sheets("Sheet1")
    
            LastRow = FindNotesLastRow(xlWS)
        
            ' MsgBox "LastRow: " & LastRow
            ' MsgBox "FindLast " & FindNotesLastRow(xlWS)
        
        xlWS.Range("A1:N" & LastRow).Copy
        
        Dim CtrlDef As Inventor.ControlDefinition
        Set CtrlDef = ThisApplication.CommandManager.ControlDefinitions.Item("AppPasteSpecialCmd")
        
        CtrlDef.Enabled = True
        CtrlDef.Execute '(True)

        xlWB.Application.CutCopyMode = False
        xlWB.Close (True)
        xlApp.Quit
End Sub


Function GetJobNumber()
    'Added later to parse for the current job number automatically.
    'This will then get passed into the jobNo variable within the main to grab the correct document.

    Dim odoc As DrawingDocument
    Set odoc = ThisApplication.ActiveDocument
  
    Dim iProperties As PropertySet
    Set iProperties = odoc.PropertySets.Item("Design Tracking Properties")
    
    Dim JobProperty As Property
    Set JobProperty = iProperties.Item("Project")
    
    Dim JobNumber As Long
    JobNumber = CLng(JobProperty.Value)
    
    GetJobNumber = JobNumber
    
End Function


Function FindNotesLastRow(xlWS As Excel.WorkSheet) As Long

        Dim Cell As Range
        Dim NotesRow As Long
        
        NotesRow = xlWS.Cells(xlWS.Rows.Count, "A").End(xlUp).Row
  
        
        FindNotesLastRow = NotesRow
        
End Function
```

#### Code Block 4

```vb
Option Explicit

Sub Import_Excel()
    
    
    Dim xlApp As Object 'Excel.Application
    Dim xlWB As Variant
    Dim xlWS As Excel.WorkSheet
    
    Dim xlPath As String
    Dim xlFile As String
    Dim JobNo As Long
    Dim xlTotalPath As String
    
    Dim LastRow As Long
    
  
        JobNo = GetJobNumber() 'pass function into this location to make the document follow the job number dynamically.
    
        xlPath = "Path" & JobNo & "\"   
        xlFile = JobNo & "_Chart.xlsx"
        
    
    If JobNo > 37599 Then
        MsgBox "Job range exceeded, please notify programer"
        Exit Sub
    End If

    xlTotalPath = xlPath & xlFile
         'MsgBox xlTotalPath
    
         'Next section attempts to open the excel document off the given variables.
    Set xlApp = CreateObject("Excel.Application")
    xlApp.Visible = False
   
        'The below error change is required to dodge a dialog box that has no effect upon the opening of the document.
        
        On Error Resume Next
        If Dir(xlTotalPath) = "" Then
            'MsgBox "File not found " & xlTotalPath & " Make sure the nozzel fitting chart has been created and exported to job folder"
            Exit Sub
        Else
            Set xlWB = xlApp.Workbooks.Open(xlTotalPath)
        End If
        On Error GoTo 0
    
    
        If xlWB Is Nothing Then
            MsgBox "workbook not loaded"
        End If
    
            Set xlWS = xlWB.Sheets("Sheet1")
    
            LastRow = FindNotesLastRow(xlWS)
        
            ' MsgBox "LastRow: " & LastRow
            ' MsgBox "FindLast " & FindNotesLastRow(xlWS)
        
        xlWS.Range("A1:N" & LastRow).Copy
        
        Dim CtrlDef As Inventor.ControlDefinition
        Set CtrlDef = ThisApplication.CommandManager.ControlDefinitions.Item("AppPasteSpecialCmd")
        
        CtrlDef.Enabled = True
        CtrlDef.Execute '(True)

        xlWB.Application.CutCopyMode = False
        xlWB.Close (True)
        xlApp.Quit
End Sub


Function GetJobNumber()
    'Added later to parse for the current job number automatically.
    'This will then get passed into the jobNo variable within the main to grab the correct document.

    Dim odoc As DrawingDocument
    Set odoc = ThisApplication.ActiveDocument
  
    Dim iProperties As PropertySet
    Set iProperties = odoc.PropertySets.Item("Design Tracking Properties")
    
    Dim JobProperty As Property
    Set JobProperty = iProperties.Item("Project")
    
    Dim JobNumber As Long
    JobNumber = CLng(JobProperty.Value)
    
    GetJobNumber = JobNumber
    
End Function


Function FindNotesLastRow(xlWS As Excel.WorkSheet) As Long

        Dim Cell As Range
        Dim NotesRow As Long
        
        NotesRow = xlWS.Cells(xlWS.Rows.Count, "A").End(xlUp).Row
  
        
        FindNotesLastRow = NotesRow
        
End Function
```

#### Code Block 5

```vb
Sub main()
	
	Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
	Dim oSheet4 As Sheet = oDoc.Sheets(4)
	
	'This rule checks to see whether the user is on the correct page for placement before allowing the macro to bring in excel data. 

	If oDoc.ActiveSheet Is oSheet4 Then
		InventorVb.RunMacro("ApplicationProject", "Import_Excel_Module" , "Import_Excel")
	Else
		MessageBox.Show("Please make sure you have page 4 active and selected before running this rule.")
	End If 


End Sub
```

#### Code Block 6

```vb
Sub main()
	
	Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
	Dim oSheet4 As Sheet = oDoc.Sheets(4)
	
	'This rule checks to see whether the user is on the correct page for placement before allowing the macro to bring in excel data. 

	If oDoc.ActiveSheet Is oSheet4 Then
		InventorVb.RunMacro("ApplicationProject", "Import_Excel_Module" , "Import_Excel")
	Else
		MessageBox.Show("Please make sure you have page 4 active and selected before running this rule.")
	End If 


End Sub
```

#### Code Block 7

```vb
Sub main()
	
	Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
	Dim oSheet4 As Sheet = oDoc.Sheets(4)
	
	'This rule checks to see whether the user is on the correct page for placement before allowing the macro to bring in excel data. 

	If oDoc.ActiveSheet Is oSheet4 Then
		InventorVb.RunMacro("ApplicationProject", "Import_Excel_Module" , "Import_Excel")
	Else
		MessageBox.Show("Please make sure you have page 4 active and selected before running this rule.")
	End If 


End Sub
```

#### Code Block 8

```vb
Sub main()
	
	Dim oDoc As DrawingDocument = ThisApplication.ActiveDocument
	Dim oSheet4 As Sheet = oDoc.Sheets(4)
	
	'This rule checks to see whether the user is on the correct page for placement before allowing the macro to bring in excel data. 

	If oDoc.ActiveSheet Is oSheet4 Then
		InventorVb.RunMacro("ApplicationProject", "Import_Excel_Module" , "Import_Excel")
	Else
		MessageBox.Show("Please make sure you have page 4 active and selected before running this rule.")
	End If 


End Sub
```

---

### 144. iLogic vs Sheet Metal Thickness: Different results between Inventor 2024.2 and 2026.1

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-vs-sheet-metal-thickness-different-results-between/td-p/13830817](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-vs-sheet-metal-thickness-different-results-between/td-p/13830817)

**Author:** jbetz42

**Date:** ‎09-30-2025
	
		
		01:23 AM

**Description:** We are currently in the transition from Inventor 2024.2 to Inventor 2026. During testing I noticed a strange phenomenon. We are currently using iLogic to create a flat pattern for each sheet metal part. In the second step iLogic determines the FlatPatternExtents and write those values to a custom pr...

**Code Snippets (2):**

#### Code Block 1

```vb
Private Sub GetFlatPatternDimensions()

    Dim oSheetMetalCompDef As SheetMetalComponentDefinition = ThisDoc.Document.ComponentDefinition
    Dim UOM As UnitsOfMeasure = ThisDoc.Document.UnitsOfMeasure
    Dim oFlatPattern As FlatPattern = oSheetMetalCompDef.FlatPattern

    ' Sheet Metal Thickness value is just converted to 'mm' but not rounded.
    Dim dThickness As Double
    Try
        dThickness = oSheetMetalCompDef.Thickness.Value
        dThickness = UOM.ConvertUnits(dThickness, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Thickness parameter not found.")
        dThickness = 0
    End Try

    ' Length and Width are of data type 'Double' which may contain precision errors way beyond the decimal seperator.
    ' CompanyX uses .1 precision on drawings and .3 decimal precision when dimensioning parts in 3D therefore first step is
    ' to convert values to 'mm', round values to 1 decimals to match drawing precision and later on use 'Ceil()'-Method
    ' to round up to next full integer.
    Dim dFlatPatternLength As Double
    Try
        dFlatPatternLength = Round(UOM.ConvertUnits(oFlatPattern.Length, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits), 1)
        dFlatPatternLength = Ceil(dFlatPatternLength)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Flat pattern length not found.")
        dFlatPatternLength = 0
    End Try

    Dim dFlatPatternWidth As Double
    Try
        dFlatPatternWidth = Round(UOM.ConvertUnits(oFlatPattern.Width, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits), 1)
        dFlatPatternWidth = Ceil(dFlatPatternWidth)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Flat pattern width not found.")
        dFlatPatternWidth = 0
    End Try

    Dim sSemiFinishedProductDimension As String

    ' Make sure that higher dimension value (Lenght or Width) comes first after thickness value
    If dFlatPatternLength > dFlatPatternWidth Then

        sSemiFinishedProductDimension = "Blech " & _
                                        dThickness & _
                                        " x " & _
                                        dFlatPatternLength & _
                                        " x " & _
                                        dFlatPatternWidth

    Else

        sSemiFinishedProductDimension = "Blech " & _
                                        dThickness & _
                                        " x " & _
                                        dFlatPatternWidth & _
                                        " x " & _
                                        dFlatPatternLength

    End If

    ' Write dimension to iProperty
    iProperties.Value("Custom", "Semifinished product_dimension") = sSemiFinishedProductDimension
    Logger.Info(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Semifinished Dimension: " & sSemiFinishedProductDimension)
End Sub
```

#### Code Block 2

```vb
Private Sub GetFlatPatternDimensions()

    Dim oSheetMetalCompDef As SheetMetalComponentDefinition = ThisDoc.Document.ComponentDefinition
    Dim UOM As UnitsOfMeasure = ThisDoc.Document.UnitsOfMeasure
    Dim oFlatPattern As FlatPattern = oSheetMetalCompDef.FlatPattern

    ' Sheet Metal Thickness value is just converted to 'mm' but not rounded.
    Dim dThickness As Double
    Try
        dThickness = oSheetMetalCompDef.Thickness.Value
        dThickness = UOM.ConvertUnits(dThickness, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Thickness parameter not found.")
        dThickness = 0
    End Try

    ' Length and Width are of data type 'Double' which may contain precision errors way beyond the decimal seperator.
    ' CompanyX uses .1 precision on drawings and .3 decimal precision when dimensioning parts in 3D therefore first step is
    ' to convert values to 'mm', round values to 1 decimals to match drawing precision and later on use 'Ceil()'-Method
    ' to round up to next full integer.
    Dim dFlatPatternLength As Double
    Try
        dFlatPatternLength = Round(UOM.ConvertUnits(oFlatPattern.Length, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits), 1)
        dFlatPatternLength = Ceil(dFlatPatternLength)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Flat pattern length not found.")
        dFlatPatternLength = 0
    End Try

    Dim dFlatPatternWidth As Double
    Try
        dFlatPatternWidth = Round(UOM.ConvertUnits(oFlatPattern.Width, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits), 1)
        dFlatPatternWidth = Ceil(dFlatPatternWidth)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Flat pattern width not found.")
        dFlatPatternWidth = 0
    End Try

    Dim sSemiFinishedProductDimension As String

    ' Make sure that higher dimension value (Lenght or Width) comes first after thickness value
    If dFlatPatternLength > dFlatPatternWidth Then

        sSemiFinishedProductDimension = "Blech " & _
                                        dThickness & _
                                        " x " & _
                                        dFlatPatternLength & _
                                        " x " & _
                                        dFlatPatternWidth

    Else

        sSemiFinishedProductDimension = "Blech " & _
                                        dThickness & _
                                        " x " & _
                                        dFlatPatternWidth & _
                                        " x " & _
                                        dFlatPatternLength

    End If

    ' Write dimension to iProperty
    iProperties.Value("Custom", "Semifinished product_dimension") = sSemiFinishedProductDimension
    Logger.Info(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Semifinished Dimension: " & sSemiFinishedProductDimension)
End Sub
```

#### Code Block 3

```vb
Private Sub GetFlatPatternDimensions()

    Dim oSheetMetalCompDef As SheetMetalComponentDefinition = ThisDoc.Document.ComponentDefinition
    Dim UOM As UnitsOfMeasure = ThisDoc.Document.UnitsOfMeasure
    Dim oFlatPattern As FlatPattern = oSheetMetalCompDef.FlatPattern

    ' Sheet Metal Thickness value is just converted to 'mm' but not rounded.
    Dim dThickness As Double
    Try
        dThickness = oSheetMetalCompDef.Thickness.Value
        dThickness = UOM.ConvertUnits(dThickness, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Thickness parameter not found.")
        dThickness = 0
    End Try

    ' Length and Width are of data type 'Double' which may contain precision errors way beyond the decimal seperator.
    ' CompanyX uses .1 precision on drawings and .3 decimal precision when dimensioning parts in 3D therefore first step is
    ' to convert values to 'mm', round values to 1 decimals to match drawing precision and later on use 'Ceil()'-Method
    ' to round up to next full integer.
    Dim dFlatPatternLength As Double
    Try
        dFlatPatternLength = Round(UOM.ConvertUnits(oFlatPattern.Length, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits), 1)
        dFlatPatternLength = Ceil(dFlatPatternLength)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Flat pattern length not found.")
        dFlatPatternLength = 0
    End Try

    Dim dFlatPatternWidth As Double
    Try
        dFlatPatternWidth = Round(UOM.ConvertUnits(oFlatPattern.Width, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits), 1)
        dFlatPatternWidth = Ceil(dFlatPatternWidth)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Flat pattern width not found.")
        dFlatPatternWidth = 0
    End Try

    Dim sSemiFinishedProductDimension As String

    ' Make sure that higher dimension value (Lenght or Width) comes first after thickness value
    If dFlatPatternLength > dFlatPatternWidth Then

        sSemiFinishedProductDimension = "Blech " & _
                                        dThickness & _
                                        " x " & _
                                        dFlatPatternLength & _
                                        " x " & _
                                        dFlatPatternWidth

    Else

        sSemiFinishedProductDimension = "Blech " & _
                                        dThickness & _
                                        " x " & _
                                        dFlatPatternWidth & _
                                        " x " & _
                                        dFlatPatternLength

    End If

    ' Write dimension to iProperty
    iProperties.Value("Custom", "Semifinished product_dimension") = sSemiFinishedProductDimension
    Logger.Info(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Semifinished Dimension: " & sSemiFinishedProductDimension)
End Sub
```

#### Code Block 4

```vb
Private Sub GetFlatPatternDimensions()

    Dim oSheetMetalCompDef As SheetMetalComponentDefinition = ThisDoc.Document.ComponentDefinition
    Dim UOM As UnitsOfMeasure = ThisDoc.Document.UnitsOfMeasure
    Dim oFlatPattern As FlatPattern = oSheetMetalCompDef.FlatPattern

    ' Sheet Metal Thickness value is just converted to 'mm' but not rounded.
    Dim dThickness As Double
    Try
        dThickness = oSheetMetalCompDef.Thickness.Value
        dThickness = UOM.ConvertUnits(dThickness, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Thickness parameter not found.")
        dThickness = 0
    End Try

    ' Length and Width are of data type 'Double' which may contain precision errors way beyond the decimal seperator.
    ' CompanyX uses .1 precision on drawings and .3 decimal precision when dimensioning parts in 3D therefore first step is
    ' to convert values to 'mm', round values to 1 decimals to match drawing precision and later on use 'Ceil()'-Method
    ' to round up to next full integer.
    Dim dFlatPatternLength As Double
    Try
        dFlatPatternLength = Round(UOM.ConvertUnits(oFlatPattern.Length, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits), 1)
        dFlatPatternLength = Ceil(dFlatPatternLength)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Flat pattern length not found.")
        dFlatPatternLength = 0
    End Try

    Dim dFlatPatternWidth As Double
    Try
        dFlatPatternWidth = Round(UOM.ConvertUnits(oFlatPattern.Width, UnitsTypeEnum.kDatabaseLengthUnits, UnitsTypeEnum.kMillimeterLengthUnits), 1)
        dFlatPatternWidth = Ceil(dFlatPatternWidth)
    Catch
        Logger.Warn(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Flat pattern width not found.")
        dFlatPatternWidth = 0
    End Try

    Dim sSemiFinishedProductDimension As String

    ' Make sure that higher dimension value (Lenght or Width) comes first after thickness value
    If dFlatPatternLength > dFlatPatternWidth Then

        sSemiFinishedProductDimension = "Blech " & _
                                        dThickness & _
                                        " x " & _
                                        dFlatPatternLength & _
                                        " x " & _
                                        dFlatPatternWidth

    Else

        sSemiFinishedProductDimension = "Blech " & _
                                        dThickness & _
                                        " x " & _
                                        dFlatPatternWidth & _
                                        " x " & _
                                        dFlatPatternLength

    End If

    ' Write dimension to iProperty
    iProperties.Value("Custom", "Semifinished product_dimension") = sSemiFinishedProductDimension
    Logger.Info(iLogicVb.RuleName & " | " & ThisDoc.FileName(True) & " | Semifinished Dimension: " & sSemiFinishedProductDimension)
End Sub
```

---

### 145. iLogic 規則是否可以引用部件中的元件並使用 Component.IsActive = True 或 False 控制其抑制狀態？- Can an iLogic rule reference a component in an assembly and control its suppression state using Component.IsActive = True or False?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-gui-ze-shi-fou-ke-yi-yin-yong-bu-jian-zhong-de-yuan-jian-bing-shi-yong-component-isactive-true-huo-false-kong-zhi-qi-yi-zhi-zhuang-tai/td-p/13800355](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-gui-ze-shi-fou-ke-yi-yin-yong-bu-jian-zhong-de-yuan-jian-bing-shi-yong-component-isactive-true-huo-false-kong-zhi-qi-yi-zhi-zhuang-tai/td-p/13800355)

**Author:** Nelsonkc

**Date:** ‎09-07-2025
	
		
		07:55 PM

**Description:** Hello experts, I'm a student who created four parameters to control which groups of parts are displayed in each of the four directions (front, back, left, right). All parts can be suppressed or unsuppressed based on my parameter selections, but I'm encountering an issue with the parts in Group_LoadP...

**Code Snippets (1):**

#### Code Block 1

```vb
Dim Group_DOOR_上 As Boolean = False
Dim Group_DOOR_下 As Boolean = False
Dim Group_DOOR_左 As Boolean = False
Dim Group_DOOR_右 As Boolean = False
Dim Group_SMIF_上 As Boolean = False
Dim Group_SMIF_下 As Boolean = False
Dim Group_SMIF_左 As Boolean = False
Dim Group_SMIF_右 As Boolean = False
Dim Group_LoadPort_上 As Boolean = False
Dim Group_LoadPort_下 As Boolean = False
Dim Group_LoadPort_左 As Boolean = False
Dim Group_LoadPort_右 As Boolean = False
Dim Group_Aligner_上 As Boolean = False
Dim Group_Aligner_下 As Boolean = False
Dim Group_Aligner_左 As Boolean = False
Dim Group_Aligner_右 As Boolean = False

' 根據您的選擇，獨立判斷並設定每個元件的狀態
' LoadPort
If 上 = "LoadPort" Then
    Group_LoadPort_上 = True
End If
If 下 = "LoadPort" Then
    Group_LoadPort_下 = True
End If
If 左 = "LoadPort" Then
    Group_LoadPort_左 = True
End If
If 右 = "LoadPort" Then
    Group_LoadPort_右 = True
End If
    
' DOOR
If 上 = "DOOR" Then
    Group_DOOR_上 = True    
End If
If 下 = "DOOR" Then	
    Group_DOOR_下 = True
End If
If 左 = "DOOR" Then
    Group_DOOR_左 = True
End If
If 右 = "DOOR" Then
    Group_DOOR_右 = True
End If
    
' SMIF
If 上 = "SMIF" Then
    Group_SMIF_上 = True
End If
If 下 = "SMIF" Then	
    Group_SMIF_下 = True
End If
If 左 = "SMIF" Then
    Group_SMIF_左 = True
End If
If 右 = "SMIF" Then
    Group_SMIF_右 = True
End If
    
' Aligner
If 上 = "Aligner" Then	
    Group_Aligner_上 = True
End If
If 下 = "Aligner" Then		
    Group_Aligner_下 = True
End If
If 左 = "Aligner" Then		
    Group_Aligner_左 = True
End If
If 右 = "Aligner" Then
    Group_Aligner_右 = True
End If

' 將變數值賦予元件，以啟用對應的設備

' LOAD PORT 元件啟用區塊
Component.IsActive("longup:1") = Group_LoadPort_上
Component.IsActive("shottup:1") =  Group_LoadPort_上
Component.IsActive("longdown:1") = Group_LoadPort_下
Component.IsActive("shotdown:1") =  Group_LoadPort_下
Component.IsActive("longleft:1") = Group_LoadPort_左
Component.IsActive("shotleft:1") =  Group_LoadPort_左
Component.IsActive("longright:1") = Group_LoadPort_右
Component.IsActive("shotright:1") =  Group_LoadPort_右

' DOOR
Component.IsActive("7DLR-0101-005:2") = Group_DOOR_上
Component.IsActive("7S022-0086-0101-038:2") = Group_DOOR_上
Component.IsActive("7S022-0086-0101-039:2") = Group_DOOR_上
Component.IsActive("AP-191-1-A:3") = Group_DOOR_上
Component.IsActive("AP-191-1-A:4") = Group_DOOR_上
Component.IsActive("7S022-0086-0101-057:2") = Group_DOOR_上
Component.IsActive("C-195-0H:3") = Group_DOOR_上
Component.IsActive("C-195-0H:4") = Group_DOOR_上
Component.IsActive("7DLR-0101-005:3") = Group_DOOR_下
Component.IsActive("7S022-0086-0101-038:3") = Group_DOOR_下
Component.IsActive("7S022-0086-0101-039:3") = Group_DOOR_下
Component.IsActive("AP-191-1-A:5") = Group_DOOR_下
Component.IsActive("AP-191-1-A:6") = Group_DOOR_下
Component.IsActive("7S022-0086-0101-057:3") = Group_DOOR_下
Component.IsActive("C-195-0H:5") = Group_DOOR_下
Component.IsActive("C-195-0H:6") = Group_DOOR_下
Component.IsActive("7DLR-0101-005:4") = Group_DOOR_左
Component.IsActive("7S022-0086-0101-038:4") = Group_DOOR_左
Component.IsActive("7S022-0086-0101-039:4") = Group_DOOR_左
Component.IsActive("AP-191-1-A:7") = Group_DOOR_左
Component.IsActive("AP-191-1-A:8") = Group_DOOR_左
Component.IsActive("7S022-0086-0101-057:4") = Group_DOOR_左
Component.IsActive("C-195-0H:7") = Group_DOOR_左
Component.IsActive("C-195-0H:8") = Group_DOOR_左
Component.IsActive("7DLR-0101-005:1") = Group_DOOR_右
Component.IsActive("7S022-0086-0101-038:1") = Group_DOOR_右
Component.IsActive("7S022-0086-0101-039:1") = Group_DOOR_右
Component.IsActive("AP-191-1-A:1") = Group_DOOR_右
Component.IsActive("AP-191-1-A:2") = Group_DOOR_右
Component.IsActive("7S022-0086-0101-057:1") = Group_DOOR_右
Component.IsActive("C-195-0H:1") = Group_DOOR_右
Component.IsActive("C-195-0H:2") = Group_DOOR_右
    
' SMIF
Component.IsActive("@3S025-9999-1601上:1") = Group_SMIF_上
Component.IsActive("@3S025-9999-1601下:1") = Group_SMIF_下
Component.IsActive("@3S025-9999-1601左:1") = Group_SMIF_左
Component.IsActive("@3S025-9999-1601右:1") = Group_SMIF_右

' Aligner
Component.IsActive("@LPT300-ST1 3D (RD-O3DR-24777)上:1") = Group_Aligner_上
Component.IsActive("@LPT300-ST1 3D (RD-O3DR-24777)下:1") = Group_Aligner_下
Component.IsActive("@LPT300-ST1 3D (RD-O3DR-24777)左:1") = Group_Aligner_左
Component.IsActive("@LPT300-ST1 3D (RD-O3DR-24777)右:1") = Group_Aligner_右
```

#### Code Block 2

```vb
Dim Group_DOOR_上 As Boolean = False
Dim Group_DOOR_下 As Boolean = False
Dim Group_DOOR_左 As Boolean = False
Dim Group_DOOR_右 As Boolean = False
Dim Group_SMIF_上 As Boolean = False
Dim Group_SMIF_下 As Boolean = False
Dim Group_SMIF_左 As Boolean = False
Dim Group_SMIF_右 As Boolean = False
Dim Group_LoadPort_上 As Boolean = False
Dim Group_LoadPort_下 As Boolean = False
Dim Group_LoadPort_左 As Boolean = False
Dim Group_LoadPort_右 As Boolean = False
Dim Group_Aligner_上 As Boolean = False
Dim Group_Aligner_下 As Boolean = False
Dim Group_Aligner_左 As Boolean = False
Dim Group_Aligner_右 As Boolean = False

' 根據您的選擇，獨立判斷並設定每個元件的狀態
' LoadPort
If 上 = "LoadPort" Then
    Group_LoadPort_上 = True
End If
If 下 = "LoadPort" Then
    Group_LoadPort_下 = True
End If
If 左 = "LoadPort" Then
    Group_LoadPort_左 = True
End If
If 右 = "LoadPort" Then
    Group_LoadPort_右 = True
End If
    
' DOOR
If 上 = "DOOR" Then
    Group_DOOR_上 = True    
End If
If 下 = "DOOR" Then	
    Group_DOOR_下 = True
End If
If 左 = "DOOR" Then
    Group_DOOR_左 = True
End If
If 右 = "DOOR" Then
    Group_DOOR_右 = True
End If
    
' SMIF
If 上 = "SMIF" Then
    Group_SMIF_上 = True
End If
If 下 = "SMIF" Then	
    Group_SMIF_下 = True
End If
If 左 = "SMIF" Then
    Group_SMIF_左 = True
End If
If 右 = "SMIF" Then
    Group_SMIF_右 = True
End If
    
' Aligner
If 上 = "Aligner" Then	
    Group_Aligner_上 = True
End If
If 下 = "Aligner" Then		
    Group_Aligner_下 = True
End If
If 左 = "Aligner" Then		
    Group_Aligner_左 = True
End If
If 右 = "Aligner" Then
    Group_Aligner_右 = True
End If

' 將變數值賦予元件，以啟用對應的設備

' LOAD PORT 元件啟用區塊
Component.IsActive("longup:1") = Group_LoadPort_上
Component.IsActive("shottup:1") =  Group_LoadPort_上
Component.IsActive("longdown:1") = Group_LoadPort_下
Component.IsActive("shotdown:1") =  Group_LoadPort_下
Component.IsActive("longleft:1") = Group_LoadPort_左
Component.IsActive("shotleft:1") =  Group_LoadPort_左
Component.IsActive("longright:1") = Group_LoadPort_右
Component.IsActive("shotright:1") =  Group_LoadPort_右

' DOOR
Component.IsActive("7DLR-0101-005:2") = Group_DOOR_上
Component.IsActive("7S022-0086-0101-038:2") = Group_DOOR_上
Component.IsActive("7S022-0086-0101-039:2") = Group_DOOR_上
Component.IsActive("AP-191-1-A:3") = Group_DOOR_上
Component.IsActive("AP-191-1-A:4") = Group_DOOR_上
Component.IsActive("7S022-0086-0101-057:2") = Group_DOOR_上
Component.IsActive("C-195-0H:3") = Group_DOOR_上
Component.IsActive("C-195-0H:4") = Group_DOOR_上
Component.IsActive("7DLR-0101-005:3") = Group_DOOR_下
Component.IsActive("7S022-0086-0101-038:3") = Group_DOOR_下
Component.IsActive("7S022-0086-0101-039:3") = Group_DOOR_下
Component.IsActive("AP-191-1-A:5") = Group_DOOR_下
Component.IsActive("AP-191-1-A:6") = Group_DOOR_下
Component.IsActive("7S022-0086-0101-057:3") = Group_DOOR_下
Component.IsActive("C-195-0H:5") = Group_DOOR_下
Component.IsActive("C-195-0H:6") = Group_DOOR_下
Component.IsActive("7DLR-0101-005:4") = Group_DOOR_左
Component.IsActive("7S022-0086-0101-038:4") = Group_DOOR_左
Component.IsActive("7S022-0086-0101-039:4") = Group_DOOR_左
Component.IsActive("AP-191-1-A:7") = Group_DOOR_左
Component.IsActive("AP-191-1-A:8") = Group_DOOR_左
Component.IsActive("7S022-0086-0101-057:4") = Group_DOOR_左
Component.IsActive("C-195-0H:7") = Group_DOOR_左
Component.IsActive("C-195-0H:8") = Group_DOOR_左
Component.IsActive("7DLR-0101-005:1") = Group_DOOR_右
Component.IsActive("7S022-0086-0101-038:1") = Group_DOOR_右
Component.IsActive("7S022-0086-0101-039:1") = Group_DOOR_右
Component.IsActive("AP-191-1-A:1") = Group_DOOR_右
Component.IsActive("AP-191-1-A:2") = Group_DOOR_右
Component.IsActive("7S022-0086-0101-057:1") = Group_DOOR_右
Component.IsActive("C-195-0H:1") = Group_DOOR_右
Component.IsActive("C-195-0H:2") = Group_DOOR_右
    
' SMIF
Component.IsActive("@3S025-9999-1601上:1") = Group_SMIF_上
Component.IsActive("@3S025-9999-1601下:1") = Group_SMIF_下
Component.IsActive("@3S025-9999-1601左:1") = Group_SMIF_左
Component.IsActive("@3S025-9999-1601右:1") = Group_SMIF_右

' Aligner
Component.IsActive("@LPT300-ST1 3D (RD-O3DR-24777)上:1") = Group_Aligner_上
Component.IsActive("@LPT300-ST1 3D (RD-O3DR-24777)下:1") = Group_Aligner_下
Component.IsActive("@LPT300-ST1 3D (RD-O3DR-24777)左:1") = Group_Aligner_左
Component.IsActive("@LPT300-ST1 3D (RD-O3DR-24777)右:1") = Group_Aligner_右
```

---

### 146. iProperties Update Help

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/iproperties-update-help/td-p/13808192](https://forums.autodesk.com/t5/inventor-programming-forum/iproperties-update-help/td-p/13808192)

**Author:** layochim

**Date:** ‎09-12-2025
	
		
		08:29 AM

**Description:** I've been working with a rule to update my "Part Number" iProperties with the first 12 characters of the filename to all iams and ipts within the iams that contain the first 5 characters of the filename.  This rule is what i've got but the iproperties are not updating.   ' Get the current document's...

**Code Snippets (3):**

#### Code Block 1

```vb
' Get the current document's file path and name
Dim filePath As String
filePath = ThisDoc.Document.FullFileName

' Extract the first 5 characters of the filename (optional)
Dim prefix As String
prefix = Mid(filePath, 1, 5)

' Ensure the filename has at least 12 characters
If Len(filePath) >= 12 Then
    ' Extract the filename without extension
    Dim fileName As String
    fileName = System.IO.Path.GetFileNameWithoutExtension(filePath)
    
    ' Extract the first 12 characters of the filename
    Dim partNumber As String
    partNumber = Mid(fileName, 1, 12)

    ' Access the iProperties of the document
    Dim oPropSet As PropertySet
    oPropSet = ThisDoc.Document.PropertySets.Item("Design Tracking Properties")
    
    ' Check if "Part Number" property exists and update it
    If Not oPropSet.Item("Part Number") Is Nothing Then
        oPropSet.Item("Part Number").Value = partNumber
    Else
        ' If the Part Number property is not found, throw an error or handle it
        MessageBox.Show("Part Number property not found!")
    End If
End If
```

#### Code Block 2

```vb
Sub main
Dim ass As AssemblyDocument = ThisDoc.Document
For Each doc As Document In ass.AllReferencedDocuments
	iprops(doc)
Next
	iprops(ass)
End Sub
Sub iprops(doc As Document)
	' Get the current document's file path and name
Dim filePath As String
filePath = doc.FullFileName

' Extract the first 5 characters of the filename (optional)
Dim prefix As String
prefix = Mid(filePath, 1, 5)

' Ensure the filename has at least 12 characters
If Len(filePath) >= 12 Then
    ' Extract the filename without extension
    Dim fileName As String
    fileName = System.IO.Path.GetFileNameWithoutExtension(filePath)
    
    ' Extract the first 12 characters of the filename
    Dim partNumber As String
    partNumber = Mid(fileName, 1, 12)

    ' Access the iProperties of the document
    Dim oPropSet As PropertySet
    oPropSet = doc.PropertySets.Item("Design Tracking Properties")
    
    ' Check if "Part Number" property exists and update it
    If Not oPropSet.Item("Part Number") Is Nothing Then
        oPropSet.Item("Part Number").Value = partNumber
    Else
        ' If the Part Number property is not found, throw an error or handle it
        MessageBox.Show("Part Number property not found!")
    End If
End If
End Sub
```

#### Code Block 3

```vb
Sub main
Dim ass As AssemblyDocument = ThisDoc.Document
For Each doc As Document In ass.AllReferencedDocuments
	iprops(doc)
Next
	iprops(ass)
End Sub
Sub iprops(doc As Document)
	' Get the current document's file path and name
Dim filePath As String
filePath = doc.FullFileName

' Extract the first 5 characters of the filename (optional)
Dim prefix As String
prefix = Mid(filePath, 1, 5)

' Ensure the filename has at least 12 characters
If Len(filePath) >= 12 Then
    ' Extract the filename without extension
    Dim fileName As String
    fileName = System.IO.Path.GetFileNameWithoutExtension(filePath)
    
    ' Extract the first 12 characters of the filename
    Dim partNumber As String
    partNumber = Mid(fileName, 1, 12)

    ' Access the iProperties of the document
    Dim oPropSet As PropertySet
    oPropSet = doc.PropertySets.Item("Design Tracking Properties")
    
    ' Check if "Part Number" property exists and update it
    If Not oPropSet.Item("Part Number") Is Nothing Then
        oPropSet.Item("Part Number").Value = partNumber
    Else
        ' If the Part Number property is not found, throw an error or handle it
        MessageBox.Show("Part Number property not found!")
    End If
End If
End Sub
```

---

### 147. iProperty PropertySets Cheat Sheet, Autodesk page is down

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/iproperty-propertysets-cheat-sheet-autodesk-page-is-down/td-p/13798666#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/iproperty-propertysets-cheat-sheet-autodesk-page-is-down/td-p/13798666#messageview_0)

**Author:** mfoster9TD82

**Date:** ‎09-05-2025
	
		
		10:05 AM

**Description:** I used to use this Autodesk page as a reference for iProperty PropertrySet names, but it's been down for a while.https://www.autodesk.com/support/technical/article/caas/simplecontent/content/list-all-iproperties-a...There was also a Mod The Machine one, but that is also down.Mod the Machine: Accessi...

**Code Snippets (1):**

#### Code Block 1

```vb
Dim invDoc As Document
invDoc = ThisApplication.ActiveDocument

' Get the property sets
Dim DesignTrackPropSet As PropertySet = invDoc.PropertySets.Item("Design Tracking Properties")
Dim AppSummaryPropSet As PropertySet = invDoc.PropertySets.Item("Inventor Summary Information")
Dim DocSummaryPropSet As PropertySet = invDoc.PropertySets.Item("Inventor Document Summary Information")
Dim CustomPropSet As PropertySet = invDoc.PropertySets.Item("Inventor User Defined Properties")
'get a property value using the enum/prop ID
Dim Author = AppSummaryPropSet.ItemByPropId(kAuthorSummaryInformation).Value

MsgBox(Author)
```

#### Code Block 2

```vb
Dim invDoc As Document
invDoc = ThisApplication.ActiveDocument

' Get the property sets
Dim DesignTrackPropSet As PropertySet = invDoc.PropertySets.Item("Design Tracking Properties")
Dim AppSummaryPropSet As PropertySet = invDoc.PropertySets.Item("Inventor Summary Information")
Dim DocSummaryPropSet As PropertySet = invDoc.PropertySets.Item("Inventor Document Summary Information")
Dim CustomPropSet As PropertySet = invDoc.PropertySets.Item("Inventor User Defined Properties")
'get a property value using the enum/prop ID
Dim Author = AppSummaryPropSet.ItemByPropId(kAuthorSummaryInformation).Value

MsgBox(Author)
```

#### Code Block 3

```vb
Dim invDoc As Document
invDoc = ThisApplication.ActiveDocument

' Get the property sets
Dim DesignTrackPropSet As PropertySet = invDoc.PropertySets.Item("Design Tracking Properties")
Dim AppSummaryPropSet As PropertySet = invDoc.PropertySets.Item("Inventor Summary Information")
Dim DocSummaryPropSet As PropertySet = invDoc.PropertySets.Item("Inventor Document Summary Information")
Dim CustomPropSet As PropertySet = invDoc.PropertySets.Item("Inventor User Defined Properties")
'get a property value using the enum/prop ID
Dim Author = AppSummaryPropSet.ItemByPropId(kAuthorSummaryInformation).Value

MsgBox(Author)
```

---

### 148. ilogic - Edit rectangular pattern

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-edit-rectangular-pattern/td-p/8740998](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-edit-rectangular-pattern/td-p/8740998)

**Author:** JBerns

**Date:** ‎04-18-2019
	
		
		01:55 PM

**Description:** Community,   Using iLogic in an assembly, I can create a rectangular pattern of a component using Patterns.AddRectangular.   How do you edit the Pattern quantity and spacing after it is created?   So far, my solution has been to delete the pattern, place the component again, and create the pattern a...

**Code Snippets (26):**

#### Code Block 1

```vb
Dim oDoc As AssemblyDocument
oDoc = ThisApplication.ActiveDocument

Dim oChannels As ObjectCollection
oChannels = ThisApplication.TransientObjects.CreateObjectCollection

If oChannels.Count > 0
	oChannels.Clear
End If

'add appropriate channels to object collection
Select Num_Splits
Case 0
	oChannels.Add("Channel HT")
Case 1
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 1T")
Case 2
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 12")
	oChannels.Add("Channel 2T")
Case 3
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 12")
	oChannels.Add("Channel 23")
	oChannels.Add("Channel 3T")
End Select


Dim oPatt As RectangularOccurrencePattern 

'get pattern
oPatt = oDoc.ComponentDefinition.OccurrencePatterns.Item("Channel Pattern")

'change pattern components 
oPatt.ParentComponents = oChannels
 
InventorVb.DocumentUpdate()
```

#### Code Block 2

```vb
Dim oDoc As AssemblyDocument
oDoc = ThisApplication.ActiveDocument

Dim oChannels As ObjectCollection
oChannels = ThisApplication.TransientObjects.CreateObjectCollection

If oChannels.Count > 0
	oChannels.Clear
End If

'add appropriate channels to object collection
Select Num_Splits
Case 0
	oChannels.Add("Channel HT")
Case 1
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 1T")
Case 2
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 12")
	oChannels.Add("Channel 2T")
Case 3
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 12")
	oChannels.Add("Channel 23")
	oChannels.Add("Channel 3T")
End Select


Dim oPatt As RectangularOccurrencePattern 

'get pattern
oPatt = oDoc.ComponentDefinition.OccurrencePatterns.Item("Channel Pattern")

'change pattern components 
oPatt.ParentComponents = oChannels
 
InventorVb.DocumentUpdate()
```

#### Code Block 3

```vb
Dim oDoc As AssemblyDocument
oDoc = ThisApplication.ActiveDocument

Dim oChannels As ObjectCollection
oChannels = ThisApplication.TransientObjects.CreateObjectCollection

If oChannels.Count > 0
	oChannels.Clear
End If

'add appropriate channels to object collection
Select Num_Splits
Case 0
	oChannels.Add("Channel HT")
Case 1
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 1T")
Case 2
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 12")
	oChannels.Add("Channel 2T")
Case 3
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 12")
	oChannels.Add("Channel 23")
	oChannels.Add("Channel 3T")
End Select


Dim oPatt As RectangularOccurrencePattern 

'get pattern
oPatt = oDoc.ComponentDefinition.OccurrencePatterns.Item("Channel Pattern")

'change pattern components 
oPatt.ParentComponents = oChannels
 
InventorVb.DocumentUpdate()
```

#### Code Block 4

```vb
Dim oDoc As AssemblyDocument
oDoc = ThisApplication.ActiveDocument

Dim oChannels As ObjectCollection
oChannels = ThisApplication.TransientObjects.CreateObjectCollection

If oChannels.Count > 0
	oChannels.Clear
End If

'add appropriate channels to object collection
Select Num_Splits
Case 0
	oChannels.Add("Channel HT")
Case 1
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 1T")
Case 2
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 12")
	oChannels.Add("Channel 2T")
Case 3
	oChannels.Add("Channel H1")
	oChannels.Add("Channel 12")
	oChannels.Add("Channel 23")
	oChannels.Add("Channel 3T")
End Select


Dim oPatt As RectangularOccurrencePattern 

'get pattern
oPatt = oDoc.ComponentDefinition.OccurrencePatterns.Item("Channel Pattern")

'change pattern components 
oPatt.ParentComponents = oChannels
 
InventorVb.DocumentUpdate()
```

#### Code Block 5

```vb
Dim oDoc As AssemblyDocument
oDoc = ThisApplication.ActiveDocument

Dim oChannels As ObjectCollection
oChannels = ThisApplication.TransientObjects.CreateObjectCollection

If oChannels.Count > 0
	oChannels.Clear
End If

'add appropriate channels to object collection
Select Num_Splits
Case 0
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel HT"))
Case 1
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 1T"))
Case 2
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 12"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 2T"))
Case 3
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 12"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 23"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 3T"))
End Select


Dim oPatt As RectangularOccurrencePattern 

'get pattern
oPatt = oDoc.ComponentDefinition.OccurrencePatterns.Item("Channel Pattern")

'change pattern components 
oPatt.ParentComponents = oChannels
 
InventorVb.DocumentUpdate()
```

#### Code Block 6

```vb
Dim oDoc As AssemblyDocument
oDoc = ThisApplication.ActiveDocument

Dim oChannels As ObjectCollection
oChannels = ThisApplication.TransientObjects.CreateObjectCollection

If oChannels.Count > 0
	oChannels.Clear
End If

'add appropriate channels to object collection
Select Num_Splits
Case 0
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel HT"))
Case 1
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 1T"))
Case 2
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 12"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 2T"))
Case 3
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 12"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 23"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 3T"))
End Select


Dim oPatt As RectangularOccurrencePattern 

'get pattern
oPatt = oDoc.ComponentDefinition.OccurrencePatterns.Item("Channel Pattern")

'change pattern components 
oPatt.ParentComponents = oChannels
 
InventorVb.DocumentUpdate()
```

#### Code Block 7

```vb
Dim oDoc As AssemblyDocument
oDoc = ThisApplication.ActiveDocument

Dim oChannels As ObjectCollection
oChannels = ThisApplication.TransientObjects.CreateObjectCollection

If oChannels.Count > 0
	oChannels.Clear
End If

'add appropriate channels to object collection
Select Num_Splits
Case 0
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel HT"))
Case 1
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 1T"))
Case 2
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 12"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 2T"))
Case 3
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 12"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 23"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 3T"))
End Select


Dim oPatt As RectangularOccurrencePattern 

'get pattern
oPatt = oDoc.ComponentDefinition.OccurrencePatterns.Item("Channel Pattern")

'change pattern components 
oPatt.ParentComponents = oChannels
 
InventorVb.DocumentUpdate()
```

#### Code Block 8

```vb
Dim oDoc As AssemblyDocument
oDoc = ThisApplication.ActiveDocument

Dim oChannels As ObjectCollection
oChannels = ThisApplication.TransientObjects.CreateObjectCollection

If oChannels.Count > 0
	oChannels.Clear
End If

'add appropriate channels to object collection
Select Num_Splits
Case 0
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel HT"))
Case 1
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 1T"))
Case 2
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 12"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 2T"))
Case 3
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel H1"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 12"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 23"))
	oChannels.Add(oDoc.ComponentDefinition.Occurrences.ItemByName("Channel 3T"))
End Select


Dim oPatt As RectangularOccurrencePattern 

'get pattern
oPatt = oDoc.ComponentDefinition.OccurrencePatterns.Item("Channel Pattern")

'change pattern components 
oPatt.ParentComponents = oChannels
 
InventorVb.DocumentUpdate()
```

#### Code Block 9

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
ToPatternName = "TopLinks"
Dim ToPattern As RectangularOccurrencePattern = oDoc.ComponentDefinition.OccurrencePatterns.Item(ToPatternName)
Dim Test5 As Integer = ToPattern.ColumnCount.Value
MessageBox.Show(Test5,"Test 5")
```

#### Code Block 10

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
ToPatternName = "TopLinks"
Dim ToPattern As RectangularOccurrencePattern = oDoc.ComponentDefinition.OccurrencePatterns.Item(ToPatternName)
Dim Test5 As Integer = ToPattern.ColumnCount.Value
MessageBox.Show(Test5,"Test 5")
```

#### Code Block 11

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
ToPatternName = "TopLinks"
Dim ToPattern As RectangularOccurrencePattern = oDoc.ComponentDefinition.OccurrencePatterns.Item(ToPatternName)
Dim Test5 As Integer = ToPattern.ColumnCount.Value
MessageBox.Show(Test5,"Test 5")
```

#### Code Block 12

```vb
Dim oDoc As AssemblyDocument = ThisDoc.Document
ToPatternName = "TopLinks"
Dim ToPattern As RectangularOccurrencePattern = oDoc.ComponentDefinition.OccurrencePatterns.Item(ToPatternName)
Dim Test5 As Integer = ToPattern.ColumnCount.Value
MessageBox.Show(Test5,"Test 5")
```

#### Code Block 13

```vb
Dim oPatt = Patterns.AddRectangular("BackerPattern", "Backer_01", BP_Col_Qty, BP_Col_Spc, Nothing, "X Axis", columnNaturalDirection := True, rowCount := BP_Row_Qty, rowOffset := BP_Row_Spc, rowEntityName := "Y Axis", rowNaturalDirection := True)
```

#### Code Block 14

```vb
Dim oPatt = Patterns.AddRectangular("BackerPattern", "Backer_01", BP_Col_Qty, BP_Col_Spc, Nothing, "X Axis", columnNaturalDirection := True, rowCount := BP_Row_Qty, rowOffset := BP_Row_Spc, rowEntityName := "Y Axis", rowNaturalDirection := True)
```

#### Code Block 15

```vb
Dim oPatt = Patterns.AddRectangular("BackerPattern", "Backer_01", BP_Col_Qty, BP_Col_Spc, Nothing, "X Axis", columnNaturalDirection := True, rowCount := BP_Row_Qty, rowOffset := BP_Row_Spc, rowEntityName := "Y Axis", rowNaturalDirection := True)
```

#### Code Block 16

```vb
Dim oPatt = Patterns.AddRectangular("BackerPattern", "Backer_01", BP_Col_Qty, BP_Col_Spc, Nothing, "X Axis", columnNaturalDirection := True, rowCount := BP_Row_Qty, rowOffset := BP_Row_Spc, rowEntityName := "Y Axis", rowNaturalDirection := True)
```

#### Code Block 17

```vb
Dim oPickedOcc As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
If oPickedOcc Is Nothing Then Return
Dim oADef As AssemblyComponentDefinition = oPickedOcc.Parent
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
Dim oColl As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
oColl.Add(oPickedOcc)
Dim oNewOccPatt As RectangularOccurrencePattern = _
oOccPatts.AddRectangularPattern(oColl, oADef.WorkAxes.Item(1), True, _
"mColumnOffset = 6 in", "mColumnCount = 3 ul", oADef.WorkAxes.Item(2), True, _
"mRowOffset = 8 in", "mRowCount = 6 ul")
oNewOccPatt.Name = "Rect Pattern Of " & oPickedOcc.Name.Split(":").First
```

#### Code Block 18

```vb
Dim oPickedOcc As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
If oPickedOcc Is Nothing Then Return
Dim oADef As AssemblyComponentDefinition = oPickedOcc.Parent
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
Dim oColl As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
oColl.Add(oPickedOcc)
Dim oNewOccPatt As RectangularOccurrencePattern = _
oOccPatts.AddRectangularPattern(oColl, oADef.WorkAxes.Item(1), True, _
"mColumnOffset = 6 in", "mColumnCount = 3 ul", oADef.WorkAxes.Item(2), True, _
"mRowOffset = 8 in", "mRowCount = 6 ul")
oNewOccPatt.Name = "Rect Pattern Of " & oPickedOcc.Name.Split(":").First
```

#### Code Block 19

```vb
Dim oPickedOcc As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
If oPickedOcc Is Nothing Then Return
Dim oADef As AssemblyComponentDefinition = oPickedOcc.Parent
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
Dim oColl As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
oColl.Add(oPickedOcc)
Dim oNewOccPatt As RectangularOccurrencePattern = _
oOccPatts.AddRectangularPattern(oColl, oADef.WorkAxes.Item(1), True, _
"mColumnOffset = 6 in", "mColumnCount = 3 ul", oADef.WorkAxes.Item(2), True, _
"mRowOffset = 8 in", "mRowCount = 6 ul")
oNewOccPatt.Name = "Rect Pattern Of " & oPickedOcc.Name.Split(":").First
```

#### Code Block 20

```vb
Dim oPickedOcc As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
If oPickedOcc Is Nothing Then Return
Dim oADef As AssemblyComponentDefinition = oPickedOcc.Parent
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
Dim oColl As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
oColl.Add(oPickedOcc)
Dim oNewOccPatt As RectangularOccurrencePattern = _
oOccPatts.AddRectangularPattern(oColl, oADef.WorkAxes.Item(1), True, _
"mColumnOffset = 6 in", "mColumnCount = 3 ul", oADef.WorkAxes.Item(2), True, _
"mRowOffset = 8 in", "mRowCount = 6 ul")
oNewOccPatt.Name = "Rect Pattern Of " & oPickedOcc.Name.Split(":").First
```

#### Code Block 21

```vb
Dim oPickedOcc As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
If oPickedOcc Is Nothing Then Return
Dim oADef As AssemblyComponentDefinition = oPickedOcc.Parent
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
Dim oColl As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
oColl.Add(oPickedOcc)
Dim oNewOccPatt As RectangularOccurrencePattern = _
oOccPatts.AddRectangularPattern(oColl, oADef.WorkAxes.Item(1), True, _
"mColumnOffset = ColumnOffset", "mColumnCount = ColumnCount", oADef.WorkAxes.Item(2), True, _
"mRowOffset = RowOffset", "mRowCount = RowCount")
oNewOccPatt.Name = "Rect Pattern Of " & oPickedOcc.Name.Split(":").First
```

#### Code Block 22

```vb
Dim oPickedOcc As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
If oPickedOcc Is Nothing Then Return
Dim oADef As AssemblyComponentDefinition = oPickedOcc.Parent
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
Dim oColl As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
oColl.Add(oPickedOcc)
Dim oNewOccPatt As RectangularOccurrencePattern = _
oOccPatts.AddRectangularPattern(oColl, oADef.WorkAxes.Item(1), True, _
"mColumnOffset = ColumnOffset", "mColumnCount = ColumnCount", oADef.WorkAxes.Item(2), True, _
"mRowOffset = RowOffset", "mRowCount = RowCount")
oNewOccPatt.Name = "Rect Pattern Of " & oPickedOcc.Name.Split(":").First
```

#### Code Block 23

```vb
Dim oPickedOcc As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
If oPickedOcc Is Nothing Then Return
Dim oADef As AssemblyComponentDefinition = oPickedOcc.Parent
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
Dim oColl As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
oColl.Add(oPickedOcc)
Dim oNewOccPatt As RectangularOccurrencePattern = _
oOccPatts.AddRectangularPattern(oColl, oADef.WorkAxes.Item(1), True, _
"mColumnOffset = ColumnOffset", "mColumnCount = ColumnCount", oADef.WorkAxes.Item(2), True, _
"mRowOffset = RowOffset", "mRowCount = RowCount")
oNewOccPatt.Name = "Rect Pattern Of " & oPickedOcc.Name.Split(":").First
```

#### Code Block 24

```vb
Dim oPickedOcc As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter, "Select a Component.")
If oPickedOcc Is Nothing Then Return
Dim oADef As AssemblyComponentDefinition = oPickedOcc.Parent
Dim oOccPatts As OccurrencePatterns = oADef.OccurrencePatterns
Dim oColl As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
oColl.Add(oPickedOcc)
Dim oNewOccPatt As RectangularOccurrencePattern = _
oOccPatts.AddRectangularPattern(oColl, oADef.WorkAxes.Item(1), True, _
"mColumnOffset = ColumnOffset", "mColumnCount = ColumnCount", oADef.WorkAxes.Item(2), True, _
"mRowOffset = RowOffset", "mRowCount = RowCount")
oNewOccPatt.Name = "Rect Pattern Of " & oPickedOcc.Name.Split(":").First
```

#### Code Block 25

```vb
Dim rectPattern = Patterns.AddRectangular( _
	"RectPattern2", "WR157_01", _
	ColCnt, ColSpc, Nothing, "X Axis", columnNaturalDirection := True, _
	rowCount := RowCnt, rowOffset := RowSpc, rowEntityName := "Y Axis", rowNaturalDirection := True)
```

#### Code Block 26

```vb
Dim rectPattern = Patterns.AddRectangular( _
	"RectPattern2", "WR157_01", _
	ColCnt, ColSpc, Nothing, "X Axis", columnNaturalDirection := True, _
	rowCount := RowCnt, rowOffset := RowSpc, rowEntityName := "Y Axis", rowNaturalDirection := True)
```

#### Code Block 27

```vb
Patterns.AddRectangular("BLADE PATTERN",
	{"BLADE", "BACK-RIGHT BLADE SCREW", "FRONT-RIGHT BLADE SCREW", "BACK-LEFT BLADE SCREW", "FRONT-LEFT BLADE SCREW" },
	Parameter("NO_OF_BLADES"), Parameter("Sb"), "", "Y Axis")

	Dim oPattern As RectangularOccurrencePattern
	'Find pattern through API
	oPattern = ThisApplication.ActiveDocument.ComponentDefinition.OccurrencePatterns.Item("BLADE PATTERN")
	'Change the Column count expression to a parameter
	oPattern.ColumnCount.Expression = Parameter.Param("NO_OF_BLADES").Name
	'Change the column offset expression to a parameter
	oPattern.ColumnOffset.Expression = Parameter.Param("Sb").Name
```

#### Code Block 28

```vb
Patterns.AddRectangular("BLADE PATTERN",
	{"BLADE", "BACK-RIGHT BLADE SCREW", "FRONT-RIGHT BLADE SCREW", "BACK-LEFT BLADE SCREW", "FRONT-LEFT BLADE SCREW" },
	Parameter("NO_OF_BLADES"), Parameter("Sb"), "", "Y Axis")

	Dim oPattern As RectangularOccurrencePattern
	'Find pattern through API
	oPattern = ThisApplication.ActiveDocument.ComponentDefinition.OccurrencePatterns.Item("BLADE PATTERN")
	'Change the Column count expression to a parameter
	oPattern.ColumnCount.Expression = Parameter.Param("NO_OF_BLADES").Name
	'Change the column offset expression to a parameter
	oPattern.ColumnOffset.Expression = Parameter.Param("Sb").Name
```

#### Code Block 29

```vb
Patterns.AddRectangular("BLADE PATTERN",
	{"BLADE", "BACK-RIGHT BLADE SCREW", "FRONT-RIGHT BLADE SCREW", "BACK-LEFT BLADE SCREW", "FRONT-LEFT BLADE SCREW" },
	Parameter("NO_OF_BLADES"), Parameter("Sb"), "", "Y Axis")

	Dim oPattern As RectangularOccurrencePattern
	'Find pattern through API
	oPattern = ThisApplication.ActiveDocument.ComponentDefinition.OccurrencePatterns.Item("BLADE PATTERN")
	'Change the Column count expression to a parameter
	oPattern.ColumnCount.Expression = Parameter.Param("NO_OF_BLADES").Name
	'Change the column offset expression to a parameter
	oPattern.ColumnOffset.Expression = Parameter.Param("Sb").Name
```

#### Code Block 30

```vb
Patterns.AddRectangular("BLADE PATTERN",
	{"BLADE", "BACK-RIGHT BLADE SCREW", "FRONT-RIGHT BLADE SCREW", "BACK-LEFT BLADE SCREW", "FRONT-LEFT BLADE SCREW" },
	Parameter("NO_OF_BLADES"), Parameter("Sb"), "", "Y Axis")

	Dim oPattern As RectangularOccurrencePattern
	'Find pattern through API
	oPattern = ThisApplication.ActiveDocument.ComponentDefinition.OccurrencePatterns.Item("BLADE PATTERN")
	'Change the Column count expression to a parameter
	oPattern.ColumnCount.Expression = Parameter.Param("NO_OF_BLADES").Name
	'Change the column offset expression to a parameter
	oPattern.ColumnOffset.Expression = Parameter.Param("Sb").Name
```

#### Code Block 31

```vb
Select Case Num_Splits
```

#### Code Block 32

```vb
Select Case Num_Splits
```

#### Code Block 33

```vb
Select Case Num_Splits
```

#### Code Block 34

```vb
Select Case Num_Splits
```

#### Code Block 35

```vb
Select Num_Splits
```

#### Code Block 36

```vb
Select Num_Splits
```

#### Code Block 37

```vb
Select Num_Splits
```

#### Code Block 38

```vb
Select Num_Splits
```

#### Code Block 39

```vb
Sub Main()
	
	sPattName = "BackerPattern"
	
	Dim oPatterns As OccurrencePatterns
	oPatterns = ThisApplication.ActiveDocument.ComponentDefinition.OccurrencePatterns
	
	Try
		oPatterns.Item(sPattName).Delete
	Catch ex As Exception
		'MsgBox("Error: " & ex.Message)
	End Try
	
	 
	Dim oPatt = Patterns.AddRectangular("BackerPattern", "Backer_01", _
	4, 12, Nothing, "X Axis", columnNaturalDirection := True, 
	rowCount := 3, rowOffset := 8, rowEntityName := "Y Axis", rowNaturalDirection := True)
	
	Dim oPattern As RectangularOccurrencePattern
	oPattern = ThisApplication.ActiveDocument.ComponentDefinition.OccurrencePatterns.Item(sPattName)
	oPattern.Name = sPattName
	
	oPattern.ColumnCount.Name = "BP_Col_Qty"
	oPattern.ColumnOffset.Name = "BP_Col_Spc"
	
	oPattern.RowCount.Name = "BP_Row_Qty"
	oPattern.RowOffset.Name = "BP_Row_Spc"
	
	ThisApplication.ActiveView.Fit
End Sub
```

#### Code Block 40

```vb
Sub Main()
	
	sPattName = "BackerPattern"
	
	Dim oPatterns As OccurrencePatterns
	oPatterns = ThisApplication.ActiveDocument.ComponentDefinition.OccurrencePatterns
	
	Try
		oPatterns.Item(sPattName).Delete
	Catch ex As Exception
		'MsgBox("Error: " & ex.Message)
	End Try
	
	 
	Dim oPatt = Patterns.AddRectangular("BackerPattern", "Backer_01", _
	4, 12, Nothing, "X Axis", columnNaturalDirection := True, 
	rowCount := 3, rowOffset := 8, rowEntityName := "Y Axis", rowNaturalDirection := True)
	
	Dim oPattern As RectangularOccurrencePattern
	oPattern = ThisApplication.ActiveDocument.ComponentDefinition.OccurrencePatterns.Item(sPattName)
	oPattern.Name = sPattName
	
	oPattern.ColumnCount.Name = "BP_Col_Qty"
	oPattern.ColumnOffset.Name = "BP_Col_Spc"
	
	oPattern.RowCount.Name = "BP_Row_Qty"
	oPattern.RowOffset.Name = "BP_Row_Spc"
	
	ThisApplication.ActiveView.Fit
End Sub
```

#### Code Block 41

```vb
ToPatternName = "TopLinks"
ToPattern = oDoc.ComponentDefinition.OccurrencePatterns.Item("TopLinks")
ToPattern.Name = ToPatternName
Test5 = ToPattern.ColumnCount
MessageBox.Show(Test5,"Test 5")
```

#### Code Block 42

```vb
ToPatternName = "TopLinks"
ToPattern = oDoc.ComponentDefinition.OccurrencePatterns.Item("TopLinks")
ToPattern.Name = ToPatternName
Test5 = ToPattern.ColumnCount
MessageBox.Show(Test5,"Test 5")
```

#### Code Block 43

```vb
ToPatternName = "TopLinks"
ToPattern = oDoc.ComponentDefinition.OccurrencePatterns.Item("TopLinks")
ToPattern.Name = ToPatternName
Test5 = ToPattern.ColumnCount
MessageBox.Show(Test5,"Test 5")
```

#### Code Block 44

```vb
ToPatternName = "TopLinks"
ToPattern = oDoc.ComponentDefinition.OccurrencePatterns.Item("TopLinks")
ToPattern.Name = ToPatternName
Test5 = ToPattern.ColumnCount
MessageBox.Show(Test5,"Test 5")
```

#### Code Block 45

```vb
oNewOccPatt.ColumnCount.Name = "mColumnCount"
oNewOccPatt.ColumnCount.Expression = "ColumnCount"
```

#### Code Block 46

```vb
oNewOccPatt.ColumnCount.Name = "mColumnCount"
oNewOccPatt.ColumnCount.Expression = "ColumnCount"
```

#### Code Block 47

```vb
oNewOccPatt.ColumnCount.Name = "mColumnCount"
oNewOccPatt.ColumnCount.Expression = "ColumnCount"
```

#### Code Block 48

```vb
oNewOccPatt.ColumnCount.Name = "mColumnCount"
oNewOccPatt.ColumnCount.Expression = "ColumnCount"
```

#### Code Block 49

```vb
oPatt = oAsmDef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, "BP_Col_Spc", "BP_Col_Qty", oRowEntity, True, "BP_Row_Spc", "BP_Row_Qty")
```

#### Code Block 50

```vb
oPatt = oAsmDef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, "BP_Col_Spc", "BP_Col_Qty", oRowEntity, True, "BP_Row_Spc", "BP_Row_Qty")
```

#### Code Block 51

```vb
oPatt = oAsmDef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, "BP_Col_Spc", "BP_Col_Qty", oRowEntity, True, "BP_Row_Spc", "BP_Row_Qty")
```

#### Code Block 52

```vb
oPatt = oAsmDef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, "BP_Col_Spc", "BP_Col_Qty", oRowEntity, True, "BP_Row_Spc", "BP_Row_Qty")
```

---

### 149. ilogic Rule in part runs from assembly.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-in-part-runs-from-assembly/td-p/13771406#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-in-part-runs-from-assembly/td-p/13771406#messageview_0)

**Author:** m_rubach

**Date:** ‎08-17-2025
	
		
		10:45 PM

**Description:** Hi, at the begining I would like to say that I am beginer in iLogic.I have written ilogic rules which changes color surfaces depends which value is in custom properties.i added attribute name for surface which i want to change.The trigger of rule is set after any change iProperties in part. When I a...

**Code Snippets (9):**

#### Code Block 1

```vb
Dim oPartDoc As PartDocument
oPartDoc = ThisApplication.ActiveEditDocument
Dim oCompDef As ComponentDefinition
oCompDef = oPartDoc.ComponentDefinition



Dim oFaces As Faces
Dim oFace As Face
Dim oSurfBodies As SurfaceBodies
Dim oSurfBody As SurfaceBody
Dim oStyle As RenderStyle
	oStyle = oPartDoc.RenderStyles.Item("Green") 
	 oSurfBodies = oCompDef.SurfaceBodies

oFaces = oSurfBodies.Item(1).Faces
For Each oSurfBody In oSurfBodies
oFaces = oSurfBody.Faces
	For Each oFace In oFaces
		For i = 1 To 2
			Try			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Long1" Then
				If iProperties.Value("Custom", "Long1") = "1" Or iProperties.Value("Custom", "Long1") = "2" Then
				Call oFace.SetRenderStyle(kOverrideRenderStyle, oStyle)
				Else
				Call oFace.SetRenderStyle(kPartRenderStyle)
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Long2" Then
				If iProperties.Value("Custom", "Long2") = "1" Or iProperties.Value("Custom", "Long2") = "2" Then
				Call oFace.SetRenderStyle(kOverrideRenderStyle, oStyle)
				Else
				Call oFace.SetRenderStyle(kPartRenderStyle)
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Short1" Then
				If iProperties.Value("Custom", "Short1") = "1" Or iProperties.Value("Custom", "Short1") = "2" Then
				Call oFace.SetRenderStyle(kOverrideRenderStyle, oStyle)
				Else
				Call oFace.SetRenderStyle(kPartRenderStyle)
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Skort2" Then
				If iProperties.Value("Custom", "Short2") = "1" Or iProperties.Value("Custom", "Short2") = "2" Then
				Call oFace.SetRenderStyle(kOverrideRenderStyle, oStyle)
				Else
				Call oFace.SetRenderStyle(kPartRenderStyle)
				End If 
			End If
			Catch	
			End Try
		Next		
	Next
Next
```

#### Code Block 2

```vb
Dim oPartDoc As PartDocument
oPartDoc = ThisApplication.ActiveEditDocument
Dim oCompDef As ComponentDefinition
oCompDef = oPartDoc.ComponentDefinition



Dim oFaces As Faces
Dim oFace As Face
Dim oSurfBodies As SurfaceBodies
Dim oSurfBody As SurfaceBody
Dim oStyle As RenderStyle
	oStyle = oPartDoc.RenderStyles.Item("Green") 
	 oSurfBodies = oCompDef.SurfaceBodies

oFaces = oSurfBodies.Item(1).Faces
For Each oSurfBody In oSurfBodies
oFaces = oSurfBody.Faces
	For Each oFace In oFaces
		For i = 1 To 2
			Try			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Long1" Then
				If iProperties.Value("Custom", "Long1") = "1" Or iProperties.Value("Custom", "Long1") = "2" Then
				Call oFace.SetRenderStyle(kOverrideRenderStyle, oStyle)
				Else
				Call oFace.SetRenderStyle(kPartRenderStyle)
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Long2" Then
				If iProperties.Value("Custom", "Long2") = "1" Or iProperties.Value("Custom", "Long2") = "2" Then
				Call oFace.SetRenderStyle(kOverrideRenderStyle, oStyle)
				Else
				Call oFace.SetRenderStyle(kPartRenderStyle)
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Short1" Then
				If iProperties.Value("Custom", "Short1") = "1" Or iProperties.Value("Custom", "Short1") = "2" Then
				Call oFace.SetRenderStyle(kOverrideRenderStyle, oStyle)
				Else
				Call oFace.SetRenderStyle(kPartRenderStyle)
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Skort2" Then
				If iProperties.Value("Custom", "Short2") = "1" Or iProperties.Value("Custom", "Short2") = "2" Then
				Call oFace.SetRenderStyle(kOverrideRenderStyle, oStyle)
				Else
				Call oFace.SetRenderStyle(kPartRenderStyle)
				End If 
			End If
			Catch	
			End Try
		Next		
	Next
Next
```

#### Code Block 3

```vb
Dim oPartDoc As PartDocument
oPartDoc = ThisDoc.Document
Dim oCompDef As ComponentDefinition
oCompDef = oPartDoc.ComponentDefinition

Dim oFaces As Faces
Dim oFace As Face
Dim oSurfBodies As SurfaceBodies = oCompDef.SurfaceBodies
Dim oSurfBody As SurfaceBody	

Dim localAsset As Asset = oPartDoc.Assets.Item("Green")
Dim localAssetDefault As Asset = oPartDoc.Assets.Item("White")
 

For Each oSurfBody In oSurfBodies
	oFaces = oSurfBody.Faces
	For Each oFace In oFaces
		For i = 1 To 2
			Try			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Long1" Then
				If iProperties.Value("Custom", "Long1") = "1" Or iProperties.Value("Custom", "Long1") = "2" Then
				oFace.Appearance = localAsset
				Else
				oFace.Appearance = localAssetDefault
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Long2" Then
				If iProperties.Value("Custom", "Long2") = "1" Or iProperties.Value("Custom", "Long2") = "2" Then
				oFace.Appearance = localAsset
				Else
				oFace.Appearance = localAssetDefault
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Short1" Then
				If iProperties.Value("Custom", "Short1") = "1" Or iProperties.Value("Custom", "Short1") = "2" Then
				oFace.Appearance = localAsset
				Else
				oFace.Appearance = localAssetDefault
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Short2" Then
				If iProperties.Value("Custom", "Short2") = "1" Or iProperties.Value("Custom", "Short2") = "2" Then
				oFace.Appearance = localAsset
				Else
				oFace.Appearance = localAssetDefault
				End If
			End If
			Catch	
			End Try
		Next		
	Next
Next
```

#### Code Block 4

```vb
Dim oPartDoc As PartDocument
oPartDoc = ThisDoc.Document
Dim oCompDef As ComponentDefinition
oCompDef = oPartDoc.ComponentDefinition

Dim oFaces As Faces
Dim oFace As Face
Dim oSurfBodies As SurfaceBodies = oCompDef.SurfaceBodies
Dim oSurfBody As SurfaceBody	

Dim localAsset As Asset = oPartDoc.Assets.Item("Green")
Dim localAssetDefault As Asset = oPartDoc.Assets.Item("White")
 

For Each oSurfBody In oSurfBodies
	oFaces = oSurfBody.Faces
	For Each oFace In oFaces
		For i = 1 To 2
			Try			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Long1" Then
				If iProperties.Value("Custom", "Long1") = "1" Or iProperties.Value("Custom", "Long1") = "2" Then
				oFace.Appearance = localAsset
				Else
				oFace.Appearance = localAssetDefault
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Long2" Then
				If iProperties.Value("Custom", "Long2") = "1" Or iProperties.Value("Custom", "Long2") = "2" Then
				oFace.Appearance = localAsset
				Else
				oFace.Appearance = localAssetDefault
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Short1" Then
				If iProperties.Value("Custom", "Short1") = "1" Or iProperties.Value("Custom", "Short1") = "2" Then
				oFace.Appearance = localAsset
				Else
				oFace.Appearance = localAssetDefault
				End If 
			End If
			
			If oFace.AttributeSets.Item(i).Item(1).Value = "Short2" Then
				If iProperties.Value("Custom", "Short2") = "1" Or iProperties.Value("Custom", "Short2") = "2" Then
				oFace.Appearance = localAsset
				Else
				oFace.Appearance = localAssetDefault
				End If
			End If
			Catch	
			End Try
		Next		
	Next
Next
```

#### Code Block 5

```vb
ThisApplication.ActiveEditDocument
```

#### Code Block 6

```vb
oPartDoc = ThisApplication.ActiveEditDocument
```

#### Code Block 7

```vb
oPartDoc = ThisApplication.ActiveEditDocument
```

#### Code Block 8

```vb
oPartDoc = ThisDoc.Document
```

#### Code Block 9

```vb
oPartDoc = ThisDoc.Document
```

---

### 150. ilogic code needed: Finish Feature, is it used, if so set the first one to an iproperty

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-code-needed-finish-feature-is-it-used-if-so-set-the-first/td-p/13808368#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-code-needed-finish-feature-is-it-used-if-so-set-the-first/td-p/13808368#messageview_0)

**Author:** jon17

**Date:** ‎09-12-2025
	
		
		10:45 AM

**Description:** I like the idea of the Finish feature available in 2024+.I want to predetermine the finishes.  Easy, set them in theFinish.xml file.I now want to create a template file that has an ilogic rule to see if someone used the Finish feature and if so set the finish to an iProperty "Finish".  Also, i know ...

**Code Snippets (5):**

#### Code Block 1

```vb
'USING THE FINISH FEATURE.
'USES THE FINISH SHORT DESCRIPTION FOR THE FINISH IPROPERTY, WHICH IS USED ON THE DRAWING BORDER
'LOOKS AT THE AREA Of THE FINISH AREA VS THE AREA Of THE PART And ADDS "EXCEPT AS NOTED" To THE FINISH NOTE
Dim oDoc As Document = ThisApplication.ActiveDocument
Dim hasFinishFeature As Boolean = False
Dim finishft As FinishFeature
For Each ft As PartFeature In ThisDoc.Document.componentdefinition.features
	If ft.Type = ObjectTypeEnum.kFinishFeatureObject Then
		finishft = ft
		hasFinishFeature = True
		Exit For
	End If
	Next

If hasFinishFeature = False Then
	MessageBox.Show("No Finishes Exist", "Finish Error")
	iProperties.Value("Custom", "Finish")=""
	Return
Else
	Dim finisharea As Double = 0
	Try
	finisharea = finishft.Faces(1).Evaluator.Area * 0.0393701
	'0.0393701 converts Area in mm^2 to in^2.
	Catch ex As Exception
	End Try
	surfaceArea = iProperties.Area
	If finisharea = 0 Then
		FinishComment = ""
	ElseIf surfaceArea - finisharea >.005 Then 
		FinishComment = ", EXCEPT AS NOTED"
	End If
		
	Dim oFinishFeature As FinishFeature = oDoc.ComponentDefinition.Features.FinishFeatures.Item(1)
	Dim oFinishDef As FinishDefinition = oFinishFeature.Definition
	Dim myDescription As String = ""
	Try
	myDescription = oFinishDef.ShortDescription
	Catch ex As Exception
	End Try
	iProperties.Value("Custom", "Finish") = myDescription + FinishComment
End If
```

#### Code Block 2

```vb
'USING THE FINISH FEATURE.
'USES THE FINISH SHORT DESCRIPTION FOR THE FINISH IPROPERTY, WHICH IS USED ON THE DRAWING BORDER
'LOOKS AT THE AREA Of THE FINISH AREA VS THE AREA Of THE PART And ADDS "EXCEPT AS NOTED" To THE FINISH NOTE
Dim oDoc As Document = ThisApplication.ActiveDocument
Dim hasFinishFeature As Boolean = False
Dim finishft As FinishFeature
For Each ft As PartFeature In ThisDoc.Document.componentdefinition.features
	If ft.Type = ObjectTypeEnum.kFinishFeatureObject Then
		finishft = ft
		hasFinishFeature = True
		Exit For
	End If
	Next

If hasFinishFeature = False Then
	MessageBox.Show("No Finishes Exist", "Finish Error")
	iProperties.Value("Custom", "Finish")=""
	Return
Else
	Dim finisharea As Double = 0
	Try
	finisharea = finishft.Faces(1).Evaluator.Area * 0.0393701
	'0.0393701 converts Area in mm^2 to in^2.
	Catch ex As Exception
	End Try
	surfaceArea = iProperties.Area
	If finisharea = 0 Then
		FinishComment = ""
	ElseIf surfaceArea - finisharea >.005 Then 
		FinishComment = ", EXCEPT AS NOTED"
	End If
		
	Dim oFinishFeature As FinishFeature = oDoc.ComponentDefinition.Features.FinishFeatures.Item(1)
	Dim oFinishDef As FinishDefinition = oFinishFeature.Definition
	Dim myDescription As String = ""
	Try
	myDescription = oFinishDef.ShortDescription
	Catch ex As Exception
	End Try
	iProperties.Value("Custom", "Finish") = myDescription + FinishComment
End If
```

#### Code Block 3

```vb
'USING THE FINISH FEATURE.
'USES THE FINISH SHORT DESCRIPTION FOR THE FINISH IPROPERTY, WHICH IS USED ON THE DRAWING BORDER
'LOOKS AT THE AREA Of THE FINISH AREA VS THE AREA Of THE PART And ADDS "EXCEPT AS NOTED" To THE FINISH NOTE
Dim oDoc As Document = ThisApplication.ActiveDocument
Dim hasFinishFeature As Boolean = False
Dim finishft As FinishFeature
For Each ft As PartFeature In ThisDoc.Document.componentdefinition.features
	If ft.Type = ObjectTypeEnum.kFinishFeatureObject Then
		finishft = ft
		hasFinishFeature = True
		Exit For
	End If
	Next

If hasFinishFeature = False Then
	MessageBox.Show("No Finishes Exist", "Finish Error")
	iProperties.Value("Custom", "Finish")=""
	Return
Else
	Dim finisharea As Double = 0
	Try
	finisharea = finishft.Faces(1).Evaluator.Area * 0.0393701
	'0.0393701 converts Area in mm^2 to in^2.
	Catch ex As Exception
	End Try
	surfaceArea = iProperties.Area
	If finisharea = 0 Then
		FinishComment = ""
	ElseIf surfaceArea - finisharea >.005 Then 
		FinishComment = ", EXCEPT AS NOTED"
	End If
		
	Dim oFinishFeature As FinishFeature = oDoc.ComponentDefinition.Features.FinishFeatures.Item(1)
	Dim oFinishDef As FinishDefinition = oFinishFeature.Definition
	Dim myDescription As String = ""
	Try
	myDescription = oFinishDef.ShortDescription
	Catch ex As Exception
	End Try
	iProperties.Value("Custom", "Finish") = myDescription + FinishComment
End If
```

#### Code Block 4

```vb
'USING THE FINISH FEATURE.
'USES THE FINISH SHORT DESCRIPTION FOR THE FINISH IPROPERTY, WHICH IS USED ON THE DRAWING BORDER
'LOOKS AT THE AREA Of THE FINISH AREA VS THE AREA Of THE PART And ADDS "EXCEPT AS NOTED" To THE FINISH NOTE
Dim oDoc As Document = ThisApplication.ActiveDocument
Dim hasFinishFeature As Boolean = False
Dim finishft As FinishFeature
For Each ft As PartFeature In ThisDoc.Document.componentdefinition.features
	If ft.Type = ObjectTypeEnum.kFinishFeatureObject Then
		finishft = ft
		hasFinishFeature = True
		Exit For
	End If
	Next

If hasFinishFeature = False Then
	MessageBox.Show("No Finishes Exist", "Finish Error")
	iProperties.Value("Custom", "Finish")=""
	Return
Else
	Dim finisharea As Double = 0
	Try
	finisharea = finishft.Faces(1).Evaluator.Area * 0.0393701
	'0.0393701 converts Area in mm^2 to in^2.
	Catch ex As Exception
	End Try
	surfaceArea = iProperties.Area
	If finisharea = 0 Then
		FinishComment = ""
	ElseIf surfaceArea - finisharea >.005 Then 
		FinishComment = ", EXCEPT AS NOTED"
	End If
		
	Dim oFinishFeature As FinishFeature = oDoc.ComponentDefinition.Features.FinishFeatures.Item(1)
	Dim oFinishDef As FinishDefinition = oFinishFeature.Definition
	Dim myDescription As String = ""
	Try
	myDescription = oFinishDef.ShortDescription
	Catch ex As Exception
	End Try
	iProperties.Value("Custom", "Finish") = myDescription + FinishComment
End If
```

#### Code Block 5

```vb
'USING THE FINISH FEATURE.
'USES THE FINISH SHORT DESCRIPTION FOR THE FINISH IPROPERTY, WHICH IS USED ON THE DRAWING BORDER
'LOOKS AT THE AREA Of THE FINISH AREA VS THE AREA Of THE PART And ADDS "EXCEPT AS NOTED" To THE FINISH NOTE
Dim oDoc As Document = ThisApplication.ActiveDocument
Dim hasFinishFeature As Boolean = False
Dim finishft As FinishFeature
For Each ft As PartFeature In ThisDoc.Document.componentdefinition.features
If ft.Type = ObjectTypeEnum.kFinishFeatureObject Then
finishft = ft
hasFinishFeature = True
Exit For
End If
Next
Dim finisharea As Double = 0
Try
finisharea = finishft.Faces(1).Evaluator.Area * 0.0393701
'0.0393701 converts Area in mm^2 to in^2.
Catch ex As Exception
End Try
surfaceArea = iProperties.Area
If finisharea = 0 Then
	FinishComment = ""
ElseIf surfaceArea - finisharea >.005 Then 
	FinishComment = ", EXCEPT AS NOTED"
End If

If hasFinishFeature = False Then
	MessageBox.Show("No Finishes Exist", "Finish Error")
	iProperties.Value("Custom", "Finish")=""
	Return
End if

Dim oFinishFeature As FinishFeature = oDoc.ComponentDefinition.Features.FinishFeatures.Item(1)
Dim oFinishDef As FinishDefinition = oFinishFeature.Definition
Dim myDescription As String = oFinishDef.ShortDescription
iProperties.Value("Custom", "Finish") = myDescription + FinishComment
```

#### Code Block 6

```vb
'USING THE FINISH FEATURE.
'USES THE FINISH SHORT DESCRIPTION FOR THE FINISH IPROPERTY, WHICH IS USED ON THE DRAWING BORDER
'LOOKS AT THE AREA Of THE FINISH AREA VS THE AREA Of THE PART And ADDS "EXCEPT AS NOTED" To THE FINISH NOTE
Dim oDoc As Document = ThisApplication.ActiveDocument
Dim hasFinishFeature As Boolean = False
Dim finishft As FinishFeature
For Each ft As PartFeature In ThisDoc.Document.componentdefinition.features
If ft.Type = ObjectTypeEnum.kFinishFeatureObject Then
finishft = ft
hasFinishFeature = True
Exit For
End If
Next
Dim finisharea As Double = 0
Try
finisharea = finishft.Faces(1).Evaluator.Area * 0.0393701
'0.0393701 converts Area in mm^2 to in^2.
Catch ex As Exception
End Try
surfaceArea = iProperties.Area
If finisharea = 0 Then
	FinishComment = ""
ElseIf surfaceArea - finisharea >.005 Then 
	FinishComment = ", EXCEPT AS NOTED"
End If

If hasFinishFeature = False Then
	MessageBox.Show("No Finishes Exist", "Finish Error")
	iProperties.Value("Custom", "Finish")=""
	Return
End if

Dim oFinishFeature As FinishFeature = oDoc.ComponentDefinition.Features.FinishFeatures.Item(1)
Dim oFinishDef As FinishDefinition = oFinishFeature.Definition
Dim myDescription As String = oFinishDef.ShortDescription
iProperties.Value("Custom", "Finish") = myDescription + FinishComment
```

#### Code Block 7

```vb
Dim finnishft As FinishFeature
For Each ft As PartFeature In ThisDoc.Document.componentdefinition.features
If ft.Type = ObjectTypeEnum.kFinishFeatureObject Then
finnishft = ft
Exit For
End If
Next
Dim finisharea As Double = 0
Try
finisharea=	finnishft.Faces(1).Evaluator.Area
Catch ex As Exception
	
End Try
MsgBox (finisharea)
```

#### Code Block 8

```vb
Dim finnishft As FinishFeature
For Each ft As PartFeature In ThisDoc.Document.componentdefinition.features
If ft.Type = ObjectTypeEnum.kFinishFeatureObject Then
finnishft = ft
Exit For
End If
Next
Dim finisharea As Double = 0
Try
finisharea=	finnishft.Faces(1).Evaluator.Area
Catch ex As Exception
	
End Try
MsgBox (finisharea)
```

#### Code Block 9

```vb
Dim finnishft As FinishFeature
For Each ft As PartFeature In ThisDoc.Document.componentdefinition.features
If ft.Type = ObjectTypeEnum.kFinishFeatureObject Then
finnishft = ft
Exit For
End If
Next
Dim finisharea As Double = 0
Try
finisharea=	finnishft.Faces(1).Evaluator.Area
Catch ex As Exception
	
End Try
MsgBox (finisharea)
```

#### Code Block 10

```vb
Dim finnishft As FinishFeature
For Each ft As PartFeature In ThisDoc.Document.componentdefinition.features
If ft.Type = ObjectTypeEnum.kFinishFeatureObject Then
finnishft = ft
Exit For
End If
Next
Dim finisharea As Double = 0
Try
finisharea=	finnishft.Faces(1).Evaluator.Area
Catch ex As Exception
	
End Try
MsgBox (finisharea)
```

---

### 151. ilogic rule that creating a cope of a drawing and changing its iPart instance.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-that-creating-a-cope-of-a-drawing-and-changing-its/td-p/9808596#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-that-creating-a-cope-of-a-drawing-and-changing-its/td-p/9808596#messageview_0)

**Author:** Anonymous

**Date:** ‎10-17-2020
	
		
		07:46 AM

**Description:** Hello, i have a model with a lot of iPart variants and i was wondering if it's possible to create a iLogic rule that copes a reference drawing, changes its iPart instance and then saves it.        					 				 			 			 				 			 			 				 	 			 				 					 						Solved! 					 					Go to Solution.

**Code Snippets (5):**

#### Code Block 1

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("This rule '" & iLogicVb.RuleName & "' only works for Assembly Documents.",vbOKOnly, "WRONG DOCUMENT TYPE")
	Exit Sub 'or Return
End If

Dim oADoc As AssemblyDocument = ThisAssembly.Document
Dim oRefDoc As Document
'get an iPart within the assembly
For Each oRefDoc In oADoc.AllReferencedDocuments
	If oRefDoc.DocumentType = DocumentTypeEnum.kDesignElementDocumentObject Then Exit For
Next
'get the path where this iPart's file is found.
Dim oPath As String = IO.Path.GetDirectoryName(oRefDoc.FullFileName) & "\"

'define which other iPart you want to be represented within the new drawing.
Dim oNewModelName As String = "NewModel"
Dim oNewPart As String = oPath & oNewModelName & ".ipt"
Dim oNewDrawing As String = oPath & oNewModelName & ".idw"

If IO.File.Exists(oRefDoc.FullFileName.Replace(".ipt", ".idw")) Then
	'open the existing drawing for that iPart (assuming it has the same name and stored in the same directory)
	Dim oDDoc As DrawingDocument = ThisApplication.Documents.Open(oRefDoc.FullFileName.Replace(".ipt", ".idw"), False)
	'save a new copy of the file to disk, then close this old file
	oDDoc.SaveAs(oNewDrawing, True) 'saves a new copy of it to disk, while leaving the old file open
	oDDoc.Close(True) 'True  = skip save (this is the old document, so we don't want to save it.
	'now open the new copy of the drawing
	Dim oNewDDoc As DrawingDocument = ThisApplication.Documents.Open(oNewDrawing, False)
	'get the current file descriptor being referenced by this drawing
	Dim oFD As FileDescriptor = oNewDDoc.ReferencedDocumentDescriptors.Item(1).ReferencedFileDescriptor
	'replace it with the full file name of our new iPart's file.
	oFD.ReplaceReference(oNewPart)
	'update the drawing document
	oNewDDoc.Update()
	oNewDDoc.Save
	oNewDDoc.Close(True)
End If
```

#### Code Block 2

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MsgBox("This rule '" & iLogicVb.RuleName & "' only works for Assembly Documents.",vbOKOnly, "WRONG DOCUMENT TYPE")
	Exit Sub 'or Return
End If

Dim oADoc As AssemblyDocument = ThisAssembly.Document
Dim oRefDoc As Document
'get an iPart within the assembly
For Each oRefDoc In oADoc.AllReferencedDocuments
	If oRefDoc.DocumentType = DocumentTypeEnum.kDesignElementDocumentObject Then Exit For
Next
'get the path where this iPart's file is found.
Dim oPath As String = IO.Path.GetDirectoryName(oRefDoc.FullFileName) & "\"

'define which other iPart you want to be represented within the new drawing.
Dim oNewModelName As String = "NewModel"
Dim oNewPart As String = oPath & oNewModelName & ".ipt"
Dim oNewDrawing As String = oPath & oNewModelName & ".idw"

If IO.File.Exists(oRefDoc.FullFileName.Replace(".ipt", ".idw")) Then
	'open the existing drawing for that iPart (assuming it has the same name and stored in the same directory)
	Dim oDDoc As DrawingDocument = ThisApplication.Documents.Open(oRefDoc.FullFileName.Replace(".ipt", ".idw"), False)
	'save a new copy of the file to disk, then close this old file
	oDDoc.SaveAs(oNewDrawing, True) 'saves a new copy of it to disk, while leaving the old file open
	oDDoc.Close(True) 'True  = skip save (this is the old document, so we don't want to save it.
	'now open the new copy of the drawing
	Dim oNewDDoc As DrawingDocument = ThisApplication.Documents.Open(oNewDrawing, False)
	'get the current file descriptor being referenced by this drawing
	Dim oFD As FileDescriptor = oNewDDoc.ReferencedDocumentDescriptors.Item(1).ReferencedFileDescriptor
	'replace it with the full file name of our new iPart's file.
	oFD.ReplaceReference(oNewPart)
	'update the drawing document
	oNewDDoc.Update()
	oNewDDoc.Save
	oNewDDoc.Close(True)
End If
```

#### Code Block 3

```vb
Sub Main
	Dim oDDoc As DrawingDocument = TryCast(ThisApplication.ActiveDocument, Inventor.DrawingDocument)
	If oDDoc Is Nothing Then Return
	Dim oOrigSheet As Inventor.Sheet = oDDoc.ActiveSheet
	Dim oNewSheet As Inventor.Sheet = CopySheet(oDDoc, oOrigSheet)
End Sub

Function CopySheet(oDDoc As DrawingDocument, oSheet As Inventor.Sheet) As Inventor.Sheet
	Dim oSS As SelectSet = oDDoc.SelectSet
	oSS.Clear()
	Dim oCM As CommandManager = ThisApplication.CommandManager
	Dim oCDs As ControlDefinitions = oCM.ControlDefinitions
	Dim oCopy As ControlDefinition = oCDs.Item("AppCopyCmd")
	Dim oPaste As ControlDefinition = oCDs.Item("AppPasteCmd")
	oSS.Select(oSheet)
	oCopy.Execute2(True)
	oSS.Clear()
	oPaste.Execute2(True)
	Return oDDoc.Sheets.Item(oDDoc.Sheets.Count)
End Function
```

#### Code Block 4

```vb
Sub Main
	Dim oDDoc As DrawingDocument = TryCast(ThisApplication.ActiveDocument, Inventor.DrawingDocument)
	If oDDoc Is Nothing Then Return
	Dim oOrigSheet As Inventor.Sheet = oDDoc.ActiveSheet
	Dim oNewSheet As Inventor.Sheet = CopySheet(oDDoc, oOrigSheet)
End Sub

Function CopySheet(oDDoc As DrawingDocument, oSheet As Inventor.Sheet) As Inventor.Sheet
	Dim oSS As SelectSet = oDDoc.SelectSet
	oSS.Clear()
	Dim oCM As CommandManager = ThisApplication.CommandManager
	Dim oCDs As ControlDefinitions = oCM.ControlDefinitions
	Dim oCopy As ControlDefinition = oCDs.Item("AppCopyCmd")
	Dim oPaste As ControlDefinition = oCDs.Item("AppPasteCmd")
	oSS.Select(oSheet)
	oCopy.Execute2(True)
	oSS.Clear()
	oPaste.Execute2(True)
	Return oDDoc.Sheets.Item(oDDoc.Sheets.Count)
End Function
```

#### Code Block 5

```vb
Sub Main()
    ' Get the active drawing document
    Dim oDrawDoc As DrawingDocument
    oDrawDoc = ThisApplication.ActiveDocument

    ' Get the referenced part document from the first view
    Dim oPartDoc As PartDocument
    Try
        Dim oView As DrawingView
        oView = oDrawDoc.ActiveSheet.DrawingViews.Item(1)
        oPartDoc = oView.ReferencedDocumentDescriptor.ReferencedDocument
    Catch
        MessageBox.Show("Error: No valid drawing view or referenced part found.", "Error")
        Exit Sub
    End Try

    ' Check if the part is an iPart factory
    If Not oPartDoc.ComponentDefinition.IsiPartFactory Then
        MessageBox.Show("The referenced document (" & oPartDoc.FullFileName & ") is not an iPart factory. Ensure the drawing references the iPart factory file, not a member file.", "Error")
        Exit Sub
    End If

    ' Get the iPart factory table
    Dim oFactory As iPartFactory
    oFactory = oPartDoc.ComponentDefinition.iPartFactory

    ' Verify that the factory has rows
    If oFactory.TableRows.Count = 0 Then
        MessageBox.Show("The iPart table is empty. Open the factory file and generate member files.", "Error")
        Exit Sub
    End If

    ' Get the path for saving drawings
    Dim oPath As String
    oPath = System.IO.Path.GetDirectoryName(oDrawDoc.FullFileName)

    ' Loop through each row in the iPart table
    Dim oRow As iPartTableRow
    For Each oRow In oFactory.TableRows
        ' Verify the member exists
        Dim oMemberFile As String
        oMemberFile = oRow.MemberPath
        If Not System.IO.File.Exists(oMemberFile) Then
            MessageBox.Show("Member file for " & oRow.MemberName & " does not exist at: " & oMemberFile & ". Regenerate member files in the factory.", "Warning")
            Continue For
        End If

        ' Activate the iPart member
        Try
            oFactory.DefaultRow = oRow
            oPartDoc.ComponentDefinition.iPart.ChangeRow(oRow.MemberName)
        Catch ex As Exception
            MessageBox.Show("Error switching to member: " & oRow.MemberName & vbCrLf & ex.Message, "Error")
            Continue For
        End Try

        ' Update the drawing
        Try
            oDrawDoc.Update
        Catch ex As Exception
            MessageBox.Show("Error updating drawing for member: " & oRow.MemberName & vbCrLf & ex.Message, "Error")
            Continue For
        End Try

        ' Generate a new file name for the drawing
        Dim oMemberName As String
        oMemberName = oRow.MemberName
        Dim oNewFileName As String
        oNewFileName = oPath & "\" & oMemberName & ".idw"

        ' Save a copy of the drawing
        Try
            oDrawDoc.SaveAs(oNewFileName, False)
        Catch ex As Exception
            MessageBox.Show("Error saving drawing for member: " & oMemberName & vbCrLf & ex.Message, "Error")
            Continue For
        End Try
    Next

    ' Revert to the first member
    Try
        oFactory.DefaultRow = oFactory.TableRows.Item(1)
        oPartDoc.ComponentDefinition.iPart.ChangeRow(oFactory.TableRows.Item(1).MemberName)
        oDrawDoc.Update
        oDrawDoc.Save
    Catch ex As Exception
        MessageBox.Show("Error reverting to first member: " & ex.Message, "Error")
    End Try

    MessageBox.Show("Drawings generated for all iPart members.", "Success")
End Sub
```

---

### 152. ilogic rule to create a rectangular pattern in an assembly

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-to-create-a-rectangular-pattern-in-an-assembly/td-p/9325882](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-rule-to-create-a-rectangular-pattern-in-an-assembly/td-p/9325882)

**Author:** Anonymous

**Date:** ‎02-18-2020
	
		
		09:11 AM

**Description:** Hello there, I am looking for an ilogic code to create a rectangular pattern within an assembly.There are 2 simple parts which must be patterned.They are constrained to an UCS in the model's skeleton.Pattern direction will always follow the same direction - let's say positive site X axis - and no Y ...

**Code Snippets (6):**

#### Code Block 1

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
	Dim oOccs As ComponentOccurrences = oADef.Occurrences
	Dim oTO As TransientObjects = ThisApplication.TransientObjects
	Dim oObjects As ObjectCollection = oTO.CreateObjectCollection
	oObjects.Add(oOccs.ItemByName("4349:1"))
	oObjects.Add(oOccs.ItemByName("0157:1"))
	Dim oRowEntity As Object = oADef.WorkAxes.Item(3)
	Dim oColumnEntity As Object = oADef.WorkAxes.Item(2)

	Dim oPatt As RectangularOccurrencePattern
	oPatt = oADef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, 0, 1, oRowEntity, True, Parameter("DIST_SUP"), Parameter("QTD_SUP"))
	oPatt.Name = "PADR_PARAFUSOS_INOX"
```

#### Code Block 2

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
	Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
	Dim oOccs As ComponentOccurrences = oADef.Occurrences
	Dim oTO As TransientObjects = ThisApplication.TransientObjects
	Dim oObjects As ObjectCollection = oTO.CreateObjectCollection
	oObjects.Add(oOccs.ItemByName("4349:1"))
	oObjects.Add(oOccs.ItemByName("0157:1"))
	Dim oRowEntity As Object = oADef.WorkAxes.Item(3)
	Dim oColumnEntity As Object = oADef.WorkAxes.Item(2)

	Dim oPatt As RectangularOccurrencePattern
	oPatt = oADef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, 0, 1, oRowEntity, True, Parameter("DIST_SUP"), Parameter("QTD_SUP"))
	oPatt.Name = "PADR_PARAFUSOS_INOX"
```

#### Code Block 3

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
Dim oOccs As ComponentOccurrences = oADef.Occurrences
Dim oOcc1 As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter,"Select the first Occurrence to pattern.")
Dim oOcc2 As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter,"Select the second Occurrence to pattern.")

Dim oTO As TransientObjects = ThisApplication.TransientObjects
Dim oObjects As ObjectCollection = oTO.CreateObjectCollection
oObjects.Add(oOcc1)
oObjects.Add(oOcc2)
'oObjects.Add(oOccs.Item(1))
'oObjects.Add(oOccs.Item(2))
Dim oRowEntity As Object = oADef.WorkAxes.Item(1)
Dim oColumnEntity As Object = oADef.WorkAxes.Item(2)

Dim oPatt As RectangularOccurrencePattern
oPatt = oADef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, 0, 1, oRowEntity, True, Parameter("Distance"), Parameter("Quantity"))
MsgBox("Check Model screen to make sure they are patterned right." & vbNewLine &
"Because, after you click OK, they will be deleted again.")
'Do whatever other stuff here

'For i=1 To oPatt.ParentComponents.Count
'	oPatt.ParentComponents.Remove(i)
'Next
oPatt.Delete
oOcc1.Delete
oOcc2.Delete
```

#### Code Block 4

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
Dim oOccs As ComponentOccurrences = oADef.Occurrences
Dim oOcc1 As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter,"Select the first Occurrence to pattern.")
Dim oOcc2 As ComponentOccurrence = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAssemblyOccurrenceFilter,"Select the second Occurrence to pattern.")

Dim oTO As TransientObjects = ThisApplication.TransientObjects
Dim oObjects As ObjectCollection = oTO.CreateObjectCollection
oObjects.Add(oOcc1)
oObjects.Add(oOcc2)
'oObjects.Add(oOccs.Item(1))
'oObjects.Add(oOccs.Item(2))
Dim oRowEntity As Object = oADef.WorkAxes.Item(1)
Dim oColumnEntity As Object = oADef.WorkAxes.Item(2)

Dim oPatt As RectangularOccurrencePattern
oPatt = oADef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, 0, 1, oRowEntity, True, Parameter("Distance"), Parameter("Quantity"))
MsgBox("Check Model screen to make sure they are patterned right." & vbNewLine &
"Because, after you click OK, they will be deleted again.")
'Do whatever other stuff here

'For i=1 To oPatt.ParentComponents.Count
'	oPatt.ParentComponents.Remove(i)
'Next
oPatt.Delete
oOcc1.Delete
oOcc2.Delete
```

#### Code Block 5

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
Dim oOccs As ComponentOccurrences = oADef.Occurrences
Dim oPatt1 As RectangularOccurrencePattern = oADef.OccurrencePatterns.Item("Pattern 1")
oPatt1.Delete
Dim oOcc1 As ComponentOccurrence = oOccs.ItemByName("P1")
Dim oOcc2 As ComponentOccurrence = oOccs.ItemByName("P2")
oOcc1.Delete
oOcc2.Delete
```

#### Code Block 6

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
Dim oOccs As ComponentOccurrences = oADef.Occurrences
Dim oPatt1 As RectangularOccurrencePattern = oADef.OccurrencePatterns.Item("Pattern 1")
oPatt1.Delete
Dim oOcc1 As ComponentOccurrence = oOccs.ItemByName("P1")
Dim oOcc2 As ComponentOccurrence = oOccs.ItemByName("P2")
oOcc1.Delete
oOcc2.Delete
```

#### Code Block 7

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
Dim oOccs As ComponentOccurrences = oADef.Occurrences
Dim oTO As TransientObjects = ThisApplication.TransientObjects
Dim oObjects As ObjectCollection = oTO.CreateObjectCollection
oObjects.Add(oOccs.ItemByName("P1"))
oObjects.Add(oOccs.ItemByName("P2"))
Dim oRowEntity As Object = oADef.WorkAxes.Item(3)
Dim oColumnEntity As Object = oADef.WorkAxes.Item(2)

Dim oPatt As RectangularOccurrencePattern
oPatt = oADef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, 0, 1, oRowEntity, True, 24, 3)
oPatt.Name = "Pattern 1"
```

#### Code Block 8

```vb
Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
Dim oOccs As ComponentOccurrences = oADef.Occurrences
Dim oTO As TransientObjects = ThisApplication.TransientObjects
Dim oObjects As ObjectCollection = oTO.CreateObjectCollection
oObjects.Add(oOccs.ItemByName("P1"))
oObjects.Add(oOccs.ItemByName("P2"))
Dim oRowEntity As Object = oADef.WorkAxes.Item(3)
Dim oColumnEntity As Object = oADef.WorkAxes.Item(2)

Dim oPatt As RectangularOccurrencePattern
oPatt = oADef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, 0, 1, oRowEntity, True, 24, 3)
oPatt.Name = "Pattern 1"
```

#### Code Block 9

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MessageBox.Show("THIS RULE '" & iLogicVb.RuleName & "' ONLY WORKS FOR ASSEMBLY DOCUMENTS.", "WRONG DOCUMENT TYPE", MessageBoxButtons.OK, MessageBoxIcon.Stop)
	Return
End If

Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
Dim oOccs As ComponentOccurrences = oADef.Occurrences
Dim oUParams As UserParameters = oADef.Parameters.UserParameters

Try
	Dim oPatt As RectangularOccurrencePattern = oADef.OccurrencePatterns.Item("PADR_PARAFUSOS_INOX")
	Dim oDelete As MsgBoxResult = MsgBox("An OccurrencePattern named '" & oPatt.Name & "' already exists." & vbNewLine &
	"Do you want to Delete it and its Components?", vbYesNo + vbQuestion, "PATTERN EXISTS - DELETE?")
	If oDelete = vbYes Then
		'iLogicVb.RunExternalRule("Name Of Rule To Delete Them")
		'Or
		oPatt.Delete
		'If the following names don't match actual items exactly, it will throw an error.
'		Dim oOcc1 As ComponentOccurrence = oOccs.ItemByName("4349:1")
'		Dim oOcc2 As ComponentOccurrence = oOccs.ItemByName("0157:1")
'		oOcc1.Delete
'		oOcc2.Delete
		'This can become difficult when more than one of the same item is in the same assembly.
		'Instead you can use a loop code which searches for a name that 'contains' some text, like this
		For Each oOcc As ComponentOccurrence In oOccs
			If oOcc.Name.Contains("4349") Or oOcc.Name.Contains("0157") Then
				oOcc.Delete
			End If
		Next				
	End If
	
	Dim oEdit As MsgBoxResult = MsgBox("Do you want to Edit its Properties or Values?", vbYesNo + vbQuestion, "EDIT IT?")
	If oEdit = vbYes Then
		'Perhaps use a series of InputBox or InputListBox lines of code here to offer the user the ability to change its values
		'Something like the following
		'ColumnCount is Read Only, so to change its value, change the value of the Parameter being used by it
		Dim oColumnCount As Parameter = oPatt.ColumnCount
		oColumnCount.Value = InputBox("Enter New Column Count.")
		Dim oAxisList As List(Of String)
		oAxisList.Add("X Axis")
		oAxisList.Add("Y Axis")
		oAxisList.Add("Z Axis")
		oPatt.ColumnEntity = InputListBox("Choose Axis For Column Entity.", oAxisList, oAxisList.Item(1), "COLUMN ENTITY")
		oPatt.ColumnEntityNaturalDirection = InputRadioBox("Use Column Entity Natural Direction?", True, False)
		'ColumnOffset is Read Only, so to change its value, change the value of the Parameter being used by it
		Dim oColumnOffset As Parameter = oPatt.ColumnOffset
		oColumnOffset.Value = InputBox("Enter New Column Offset.")
		'Etc
	ElseIf oEdit = vbNo Then
		Return
	End If
Catch
	'It doesn't exist yet, so create it
	Dim oTO As TransientObjects = ThisApplication.TransientObjects
	Dim oObjects As ObjectCollection = oTO.CreateObjectCollection
	oObjects.Add(oOccs.ItemByName("4349:1"))
	oObjects.Add(oOccs.ItemByName("0157:1"))
	Dim oRowEntity As Object = oADef.WorkAxes.Item("Z Axis")
	Dim oColumnEntity As Object = oADef.WorkAxes.Item("Y Axis")
	'You may also want to include a few lines here which check to make sure these UserParameters exist.
'	Dim oColumnOffset As UserParameter = 
'	Dim oColumnCount As UserParameter = 
	Dim oRowOffset As UserParameter = oUParams.Item("DIST_SUP")
	Dim oRowCount As UserParameter = oUParams.Item("QTD_SUP")

	Dim oPatt As RectangularOccurrencePattern
	oPatt = oADef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, 0, 1, oRowEntity, True, oRowOffset, oRowCount)
	oPatt.Name = "PADR_PARAFUSOS_INOX"
End Try
```

#### Code Block 10

```vb
If ThisApplication.ActiveDocumentType <> DocumentTypeEnum.kAssemblyDocumentObject Then
	MessageBox.Show("THIS RULE '" & iLogicVb.RuleName & "' ONLY WORKS FOR ASSEMBLY DOCUMENTS.", "WRONG DOCUMENT TYPE", MessageBoxButtons.OK, MessageBoxIcon.Stop)
	Return
End If

Dim oADoc As AssemblyDocument = ThisApplication.ActiveDocument
Dim oADef As AssemblyComponentDefinition = oADoc.ComponentDefinition
Dim oOccs As ComponentOccurrences = oADef.Occurrences
Dim oUParams As UserParameters = oADef.Parameters.UserParameters

Try
	Dim oPatt As RectangularOccurrencePattern = oADef.OccurrencePatterns.Item("PADR_PARAFUSOS_INOX")
	Dim oDelete As MsgBoxResult = MsgBox("An OccurrencePattern named '" & oPatt.Name & "' already exists." & vbNewLine &
	"Do you want to Delete it and its Components?", vbYesNo + vbQuestion, "PATTERN EXISTS - DELETE?")
	If oDelete = vbYes Then
		'iLogicVb.RunExternalRule("Name Of Rule To Delete Them")
		'Or
		oPatt.Delete
		'If the following names don't match actual items exactly, it will throw an error.
'		Dim oOcc1 As ComponentOccurrence = oOccs.ItemByName("4349:1")
'		Dim oOcc2 As ComponentOccurrence = oOccs.ItemByName("0157:1")
'		oOcc1.Delete
'		oOcc2.Delete
		'This can become difficult when more than one of the same item is in the same assembly.
		'Instead you can use a loop code which searches for a name that 'contains' some text, like this
		For Each oOcc As ComponentOccurrence In oOccs
			If oOcc.Name.Contains("4349") Or oOcc.Name.Contains("0157") Then
				oOcc.Delete
			End If
		Next				
	End If
	
	Dim oEdit As MsgBoxResult = MsgBox("Do you want to Edit its Properties or Values?", vbYesNo + vbQuestion, "EDIT IT?")
	If oEdit = vbYes Then
		'Perhaps use a series of InputBox or InputListBox lines of code here to offer the user the ability to change its values
		'Something like the following
		'ColumnCount is Read Only, so to change its value, change the value of the Parameter being used by it
		Dim oColumnCount As Parameter = oPatt.ColumnCount
		oColumnCount.Value = InputBox("Enter New Column Count.")
		Dim oAxisList As List(Of String)
		oAxisList.Add("X Axis")
		oAxisList.Add("Y Axis")
		oAxisList.Add("Z Axis")
		oPatt.ColumnEntity = InputListBox("Choose Axis For Column Entity.", oAxisList, oAxisList.Item(1), "COLUMN ENTITY")
		oPatt.ColumnEntityNaturalDirection = InputRadioBox("Use Column Entity Natural Direction?", True, False)
		'ColumnOffset is Read Only, so to change its value, change the value of the Parameter being used by it
		Dim oColumnOffset As Parameter = oPatt.ColumnOffset
		oColumnOffset.Value = InputBox("Enter New Column Offset.")
		'Etc
	ElseIf oEdit = vbNo Then
		Return
	End If
Catch
	'It doesn't exist yet, so create it
	Dim oTO As TransientObjects = ThisApplication.TransientObjects
	Dim oObjects As ObjectCollection = oTO.CreateObjectCollection
	oObjects.Add(oOccs.ItemByName("4349:1"))
	oObjects.Add(oOccs.ItemByName("0157:1"))
	Dim oRowEntity As Object = oADef.WorkAxes.Item("Z Axis")
	Dim oColumnEntity As Object = oADef.WorkAxes.Item("Y Axis")
	'You may also want to include a few lines here which check to make sure these UserParameters exist.
'	Dim oColumnOffset As UserParameter = 
'	Dim oColumnCount As UserParameter = 
	Dim oRowOffset As UserParameter = oUParams.Item("DIST_SUP")
	Dim oRowCount As UserParameter = oUParams.Item("QTD_SUP")

	Dim oPatt As RectangularOccurrencePattern
	oPatt = oADef.OccurrencePatterns.AddRectangularPattern(oObjects, oColumnEntity, True, 0, 1, oRowEntity, True, oRowOffset, oRowCount)
	oPatt.Name = "PADR_PARAFUSOS_INOX"
End Try
```

#### Code Block 11

```vb
On Error Resume Next
```

#### Code Block 12

```vb
On Error Resume Next
```

---

### 153. inest file giving wrong Document Type Enumerator

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/inest-file-giving-wrong-document-type-enumerator/td-p/13830209](https://forums.autodesk.com/t5/inventor-programming-forum/inest-file-giving-wrong-document-type-enumerator/td-p/13830209)

**Author:** ekeatingLWGGE

**Date:** ‎09-29-2025
	
		
		12:28 PM

**Description:** Hello, I am writing a piece of iLogic to speed up our CNC nesting process. I want to be able to bulk save and rename the sheet assemblies you get after selecting multiple sheets in nesting and clicking the create 3D model button. I can find the unsaved assemblies but I am trying to detect and exclud...

**Code Snippets (2):**

#### Code Block 1

```vb
Logger.Debug("Open Documents: " & ThisApplication.Documents.Count)

Dim oUnsavedDocs As New ArrayList 

Logger.Debug("View Frames " & ThisApplication.ViewFrames.Count)
Logger.Debug("Views " & ThisApplication.Views.Count)

For Each oAppVeiw As Inventor.View In ThisApplication.Views
'For Each oDoc As Inventor.Document In ThisApplication.Documents
	oDoc = oAppVeiw.Document
	
	Logger.Debug(oDoc.DisplayName)
	Logger.Debug("Dirty: " & oDoc.Dirty)
	
	Logger.Debug("Type: " & oDoc.DocumentType.ToString)
	
	If oDoc.FileSaveCounter<1 Then
		oUnsavedDocs.Add(oDoc)
		Logger.Debug("Times Saved: " & oDoc.FileSaveCounter)
	End If 
	
	If oDoc.DocumentType = kNestingDocument Then
		Logger.Debug("HELLO")
	End If 
	
	Next
	Logger.Debug("Size of oUnsavedDocs: " & oUnsavedDocs.Count)
```

#### Code Block 2

```vb
Logger.Debug("Open Documents: " & ThisApplication.Documents.Count)

Dim oUnsavedDocs As New ArrayList 

Logger.Debug("View Frames " & ThisApplication.ViewFrames.Count)
Logger.Debug("Views " & ThisApplication.Views.Count)

For Each oAppVeiw As Inventor.View In ThisApplication.Views
'For Each oDoc As Inventor.Document In ThisApplication.Documents
	oDoc = oAppVeiw.Document
	
	Logger.Debug(oDoc.DisplayName)
	Logger.Debug("Dirty: " & oDoc.Dirty)
	
	Logger.Debug("Type: " & oDoc.DocumentType.ToString)
	
	If oDoc.FileSaveCounter<1 Then
		oUnsavedDocs.Add(oDoc)
		Logger.Debug("Times Saved: " & oDoc.FileSaveCounter)
	End If 
	
	If oDoc.DocumentType = kNestingDocument Then
		Logger.Debug("HELLO")
	End If 
	
	Next
	Logger.Debug("Size of oUnsavedDocs: " & oUnsavedDocs.Count)
```

---

### 154. is there a way to find all Browser notes that does not show the partnumber ?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/is-there-a-way-to-find-all-browser-notes-that-does-not-show-the/td-p/13815636#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/is-there-a-way-to-find-all-browser-notes-that-does-not-show-the/td-p/13815636#messageview_0)

**Author:** Darkforce_the_ilogic_guy

**Date:** ‎09-17-2025
	
		
		10:59 PM

**Description:** is there a way to find all Browser notes that does not show the part number ? we are more then 10 uses, that Create our model in a full version og inventor.  But We have one use that only have Access to an Read Only.. He need the browsernotes to Always show the current part number. But for some reas...

**Code Snippets (3):**

#### Code Block 1

```vb
'this my current code

'Reset Browsernote that dont show the partnummer
Sub Main()
	
	Dim doc = ThisApplication.ActiveDocument
	Dim sDocumentSubType As String = doc.SubType
	
	Try
		'debug("Start ilogic: RenameBrowsernoteAll")
		Logger.Info("Start ilogic: RenameBrowsernoteAll")
		
		oDoc = ThisDoc.Document
		Dim oPane As BrowserPane
		Dim oTopNode As BrowserNode
		
			If oDoc.DocumentType = kPartDocumentObject
				oPane = oDoc.BrowserPanes.Item("PmDefault")
			Else 'kAssemblyDocumentObject or 
					oPane = oDoc.BrowserPanes.Item("Model")
			End If
			
				oTopNode = oPane.TopNode
			
			If oTopNode.BrowserNodeDefinition.Label <> System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName) Then
				oDoc.DisplayName = "" 'System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName)
			End If 
	
	Catch
		debug("RenameBrowsernoteALL ilogic code fail for unknown reason")
	End Try
If sDocumentSubType = "{E60F81E1-49B3-11D0-93C3-7E0706000000}" Or sDocumentSubType = "{28EC8354-9024-440F-A8A2-0E0E55D635B0}" Then ' = "assembly"''

If(doc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value = iProperties.Value("Project", "Part Number")) Then

Assembly

Else 
	
	Logger.Info("This is not the Aktive Doc - End Code")
	
Exit Sub


End If

End If

'debug("End ilogic: RenameBrowsernoteAll")
Logger.Info("End ilogic: RenameBrowsernoteAll")

End Sub

Public Sub debug(txt As String)
        Trace.WriteLine("NTI : " & txt)
End Sub


Sub Assembly()
	Logger.Info("Change Browsernotes Assembly", filename)
	
	Dim oAsmDoc As AssemblyDocument
	oAsmDoc = ThisApplication.ActiveDocument

	If (ThisDoc.Document.DisplayName = oAsmDoc.DisplayName) Then
	
	
	Else
		Logger.Info("Don´t run - End Code", filename)

		Exit Sub
	End If
	

Dim oRefDocs As DocumentsEnumerator
oRefDocs = oAsmDoc.AllReferencedDocuments
Dim oRefDoc As Document
 
For Each oRefDoc In oRefDocs
	
	Try
	
	
	Catch
		
		
		Try
			
			If oRefDoc.DisplayName <> oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value Then
				
				Logger.Info("All need To be true " & (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,9) <> "Zero Line").ToString & " " &  (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,9) <> "Zero line").ToString & " " & (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,15) <> "Control cabinet").ToString, filename)
	
					If Left(oRefDoc.DisplayName,9) <> "Zero Line" And Left(oRefDoc.DisplayName,9) <> "Zero line" And Left(oRefDoc.DisplayName,15) <> "Control cabinet"   Then
					oRefDoc.DisplayName = "" 
					End If
	
				
			End If 
		
		Catch
			
		End Try
	
	End Try

Next
Dim asm As AssemblyDocument = ThisDoc.Document
ResetOccurrenceNames(asm.ComponentDefinition.Occurrences)

End Sub

Sub ResetOccurrenceNames(occurrences As Object)
	
	Try
	For Each occ As ComponentOccurrence In occurrences
		Dim dispName = occ.ReferencedDocumentDescriptor.DisplayName
		
		'start
		Dim oPartDoc As Document
    oPartDoc = occ.Definition.Document
    Dim partNumber As String
    partNumber = iProperties.Value(oPartDoc, "Project", "Part Number")
		'end
		
		
		Dim length = Len(partNumber) -4
		
		If Not occ.Name.StartsWith(Left(dispName,length)) Then
		Logger.Info(occ.Name.StartsWith(Left(dispName,length)), "2")
If(Left(occ.Name, 9)) <> "Zero Line" And (Left(occ.Name, 9)) <> "Zero line" And (Left(occ.Name, 15)) <> "Control cabinet" Then
		occ.Name = ""
	End If 
		Logger.Info("Reset browsernote", filename)
		
		Else
			If Left(occ.Name.ToString, Len(dispName)) = dispName Then
			
			Else
			Logger.Info(occ.Name.StartsWith(Left(dispName,length)) & " 2" , "2")

			Logger.Info("Browser Note " & occ.Name, filename)
If (Left(occ.Name, 9)) <> "Zero Line" And (Left(occ.Name, 9)) <> "Zero line" And (Left(occ.Name, 15)) <> "Control cabinet" Then
			occ.Name = ""
			
		End If 
		
		End If
	End If 
		'ResetOccurrenceNames(occ.SubOccurrences)
	Next
	Catch
		Logger.Info("somthing fail "   , filename)

	End Try
End Sub
```

#### Code Block 2

```vb
'this my current code

'Reset Browsernote that dont show the partnummer
Sub Main()
	
	Dim doc = ThisApplication.ActiveDocument
	Dim sDocumentSubType As String = doc.SubType
	
	Try
		'debug("Start ilogic: RenameBrowsernoteAll")
		Logger.Info("Start ilogic: RenameBrowsernoteAll")
		
		oDoc = ThisDoc.Document
		Dim oPane As BrowserPane
		Dim oTopNode As BrowserNode
		
			If oDoc.DocumentType = kPartDocumentObject
				oPane = oDoc.BrowserPanes.Item("PmDefault")
			Else 'kAssemblyDocumentObject or 
					oPane = oDoc.BrowserPanes.Item("Model")
			End If
			
				oTopNode = oPane.TopNode
			
			If oTopNode.BrowserNodeDefinition.Label <> System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName) Then
				oDoc.DisplayName = "" 'System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName)
			End If 
	
	Catch
		debug("RenameBrowsernoteALL ilogic code fail for unknown reason")
	End Try
If sDocumentSubType = "{E60F81E1-49B3-11D0-93C3-7E0706000000}" Or sDocumentSubType = "{28EC8354-9024-440F-A8A2-0E0E55D635B0}" Then ' = "assembly"''

If(doc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value = iProperties.Value("Project", "Part Number")) Then

Assembly

Else 
	
	Logger.Info("This is not the Aktive Doc - End Code")
	
Exit Sub


End If

End If

'debug("End ilogic: RenameBrowsernoteAll")
Logger.Info("End ilogic: RenameBrowsernoteAll")

End Sub

Public Sub debug(txt As String)
        Trace.WriteLine("NTI : " & txt)
End Sub


Sub Assembly()
	Logger.Info("Change Browsernotes Assembly", filename)
	
	Dim oAsmDoc As AssemblyDocument
	oAsmDoc = ThisApplication.ActiveDocument

	If (ThisDoc.Document.DisplayName = oAsmDoc.DisplayName) Then
	
	
	Else
		Logger.Info("Don´t run - End Code", filename)

		Exit Sub
	End If
	

Dim oRefDocs As DocumentsEnumerator
oRefDocs = oAsmDoc.AllReferencedDocuments
Dim oRefDoc As Document
 
For Each oRefDoc In oRefDocs
	
	Try
	
	
	Catch
		
		
		Try
			
			If oRefDoc.DisplayName <> oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value Then
				
				Logger.Info("All need To be true " & (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,9) <> "Zero Line").ToString & " " &  (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,9) <> "Zero line").ToString & " " & (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,15) <> "Control cabinet").ToString, filename)
	
					If Left(oRefDoc.DisplayName,9) <> "Zero Line" And Left(oRefDoc.DisplayName,9) <> "Zero line" And Left(oRefDoc.DisplayName,15) <> "Control cabinet"   Then
					oRefDoc.DisplayName = "" 
					End If
	
				
			End If 
		
		Catch
			
		End Try
	
	End Try

Next
Dim asm As AssemblyDocument = ThisDoc.Document
ResetOccurrenceNames(asm.ComponentDefinition.Occurrences)

End Sub

Sub ResetOccurrenceNames(occurrences As Object)
	
	Try
	For Each occ As ComponentOccurrence In occurrences
		Dim dispName = occ.ReferencedDocumentDescriptor.DisplayName
		
		'start
		Dim oPartDoc As Document
    oPartDoc = occ.Definition.Document
    Dim partNumber As String
    partNumber = iProperties.Value(oPartDoc, "Project", "Part Number")
		'end
		
		
		Dim length = Len(partNumber) -4
		
		If Not occ.Name.StartsWith(Left(dispName,length)) Then
		Logger.Info(occ.Name.StartsWith(Left(dispName,length)), "2")
If(Left(occ.Name, 9)) <> "Zero Line" And (Left(occ.Name, 9)) <> "Zero line" And (Left(occ.Name, 15)) <> "Control cabinet" Then
		occ.Name = ""
	End If 
		Logger.Info("Reset browsernote", filename)
		
		Else
			If Left(occ.Name.ToString, Len(dispName)) = dispName Then
			
			Else
			Logger.Info(occ.Name.StartsWith(Left(dispName,length)) & " 2" , "2")

			Logger.Info("Browser Note " & occ.Name, filename)
If (Left(occ.Name, 9)) <> "Zero Line" And (Left(occ.Name, 9)) <> "Zero line" And (Left(occ.Name, 15)) <> "Control cabinet" Then
			occ.Name = ""
			
		End If 
		
		End If
	End If 
		'ResetOccurrenceNames(occ.SubOccurrences)
	Next
	Catch
		Logger.Info("somthing fail "   , filename)

	End Try
End Sub
```

#### Code Block 3

```vb
'this my current code

'Reset Browsernote that dont show the partnummer
Sub Main()
	
	Dim doc = ThisApplication.ActiveDocument
	Dim sDocumentSubType As String = doc.SubType
	
	Try
		'debug("Start ilogic: RenameBrowsernoteAll")
		Logger.Info("Start ilogic: RenameBrowsernoteAll")
		
		oDoc = ThisDoc.Document
		Dim oPane As BrowserPane
		Dim oTopNode As BrowserNode
		
			If oDoc.DocumentType = kPartDocumentObject
				oPane = oDoc.BrowserPanes.Item("PmDefault")
			Else 'kAssemblyDocumentObject or 
					oPane = oDoc.BrowserPanes.Item("Model")
			End If
			
				oTopNode = oPane.TopNode
			
			If oTopNode.BrowserNodeDefinition.Label <> System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName) Then
				oDoc.DisplayName = "" 'System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName)
			End If 
	
	Catch
		debug("RenameBrowsernoteALL ilogic code fail for unknown reason")
	End Try
If sDocumentSubType = "{E60F81E1-49B3-11D0-93C3-7E0706000000}" Or sDocumentSubType = "{28EC8354-9024-440F-A8A2-0E0E55D635B0}" Then ' = "assembly"''

If(doc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value = iProperties.Value("Project", "Part Number")) Then

Assembly

Else 
	
	Logger.Info("This is not the Aktive Doc - End Code")
	
Exit Sub


End If

End If

'debug("End ilogic: RenameBrowsernoteAll")
Logger.Info("End ilogic: RenameBrowsernoteAll")

End Sub

Public Sub debug(txt As String)
        Trace.WriteLine("NTI : " & txt)
End Sub


Sub Assembly()
	Logger.Info("Change Browsernotes Assembly", filename)
	
	Dim oAsmDoc As AssemblyDocument
	oAsmDoc = ThisApplication.ActiveDocument

	If (ThisDoc.Document.DisplayName = oAsmDoc.DisplayName) Then
	
	
	Else
		Logger.Info("Don´t run - End Code", filename)

		Exit Sub
	End If
	

Dim oRefDocs As DocumentsEnumerator
oRefDocs = oAsmDoc.AllReferencedDocuments
Dim oRefDoc As Document
 
For Each oRefDoc In oRefDocs
	
	Try
	
	
	Catch
		
		
		Try
			
			If oRefDoc.DisplayName <> oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value Then
				
				Logger.Info("All need To be true " & (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,9) <> "Zero Line").ToString & " " &  (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,9) <> "Zero line").ToString & " " & (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,15) <> "Control cabinet").ToString, filename)
	
					If Left(oRefDoc.DisplayName,9) <> "Zero Line" And Left(oRefDoc.DisplayName,9) <> "Zero line" And Left(oRefDoc.DisplayName,15) <> "Control cabinet"   Then
					oRefDoc.DisplayName = "" 
					End If
	
				
			End If 
		
		Catch
			
		End Try
	
	End Try

Next
Dim asm As AssemblyDocument = ThisDoc.Document
ResetOccurrenceNames(asm.ComponentDefinition.Occurrences)

End Sub

Sub ResetOccurrenceNames(occurrences As Object)
	
	Try
	For Each occ As ComponentOccurrence In occurrences
		Dim dispName = occ.ReferencedDocumentDescriptor.DisplayName
		
		'start
		Dim oPartDoc As Document
    oPartDoc = occ.Definition.Document
    Dim partNumber As String
    partNumber = iProperties.Value(oPartDoc, "Project", "Part Number")
		'end
		
		
		Dim length = Len(partNumber) -4
		
		If Not occ.Name.StartsWith(Left(dispName,length)) Then
		Logger.Info(occ.Name.StartsWith(Left(dispName,length)), "2")
If(Left(occ.Name, 9)) <> "Zero Line" And (Left(occ.Name, 9)) <> "Zero line" And (Left(occ.Name, 15)) <> "Control cabinet" Then
		occ.Name = ""
	End If 
		Logger.Info("Reset browsernote", filename)
		
		Else
			If Left(occ.Name.ToString, Len(dispName)) = dispName Then
			
			Else
			Logger.Info(occ.Name.StartsWith(Left(dispName,length)) & " 2" , "2")

			Logger.Info("Browser Note " & occ.Name, filename)
If (Left(occ.Name, 9)) <> "Zero Line" And (Left(occ.Name, 9)) <> "Zero line" And (Left(occ.Name, 15)) <> "Control cabinet" Then
			occ.Name = ""
			
		End If 
		
		End If
	End If 
		'ResetOccurrenceNames(occ.SubOccurrences)
	Next
	Catch
		Logger.Info("somthing fail "   , filename)

	End Try
End Sub
```

#### Code Block 4

```vb
'this my current code

'Reset Browsernote that dont show the partnummer
Sub Main()
	
	Dim doc = ThisApplication.ActiveDocument
	Dim sDocumentSubType As String = doc.SubType
	
	Try
		'debug("Start ilogic: RenameBrowsernoteAll")
		Logger.Info("Start ilogic: RenameBrowsernoteAll")
		
		oDoc = ThisDoc.Document
		Dim oPane As BrowserPane
		Dim oTopNode As BrowserNode
		
			If oDoc.DocumentType = kPartDocumentObject
				oPane = oDoc.BrowserPanes.Item("PmDefault")
			Else 'kAssemblyDocumentObject or 
					oPane = oDoc.BrowserPanes.Item("Model")
			End If
			
				oTopNode = oPane.TopNode
			
			If oTopNode.BrowserNodeDefinition.Label <> System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName) Then
				oDoc.DisplayName = "" 'System.IO.Path.GetFileNameWithoutExtension(oDoc.FullFileName)
			End If 
	
	Catch
		debug("RenameBrowsernoteALL ilogic code fail for unknown reason")
	End Try
If sDocumentSubType = "{E60F81E1-49B3-11D0-93C3-7E0706000000}" Or sDocumentSubType = "{28EC8354-9024-440F-A8A2-0E0E55D635B0}" Then ' = "assembly"''

If(doc.PropertySets.Item("Design Tracking Properties").Item("Part Number").Value = iProperties.Value("Project", "Part Number")) Then

Assembly

Else 
	
	Logger.Info("This is not the Aktive Doc - End Code")
	
Exit Sub


End If

End If

'debug("End ilogic: RenameBrowsernoteAll")
Logger.Info("End ilogic: RenameBrowsernoteAll")

End Sub

Public Sub debug(txt As String)
        Trace.WriteLine("NTI : " & txt)
End Sub


Sub Assembly()
	Logger.Info("Change Browsernotes Assembly", filename)
	
	Dim oAsmDoc As AssemblyDocument
	oAsmDoc = ThisApplication.ActiveDocument

	If (ThisDoc.Document.DisplayName = oAsmDoc.DisplayName) Then
	
	
	Else
		Logger.Info("Don´t run - End Code", filename)

		Exit Sub
	End If
	

Dim oRefDocs As DocumentsEnumerator
oRefDocs = oAsmDoc.AllReferencedDocuments
Dim oRefDoc As Document
 
For Each oRefDoc In oRefDocs
	
	Try
	
	
	Catch
		
		
		Try
			
			If oRefDoc.DisplayName <> oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value Then
				
				Logger.Info("All need To be true " & (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,9) <> "Zero Line").ToString & " " &  (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,9) <> "Zero line").ToString & " " & (Left(oRefDoc.PropertySets("Design Tracking Properties").Item("Part Number").Value,15) <> "Control cabinet").ToString, filename)
	
					If Left(oRefDoc.DisplayName,9) <> "Zero Line" And Left(oRefDoc.DisplayName,9) <> "Zero line" And Left(oRefDoc.DisplayName,15) <> "Control cabinet"   Then
					oRefDoc.DisplayName = "" 
					End If
	
				
			End If 
		
		Catch
			
		End Try
	
	End Try

Next
Dim asm As AssemblyDocument = ThisDoc.Document
ResetOccurrenceNames(asm.ComponentDefinition.Occurrences)

End Sub

Sub ResetOccurrenceNames(occurrences As Object)
	
	Try
	For Each occ As ComponentOccurrence In occurrences
		Dim dispName = occ.ReferencedDocumentDescriptor.DisplayName
		
		'start
		Dim oPartDoc As Document
    oPartDoc = occ.Definition.Document
    Dim partNumber As String
    partNumber = iProperties.Value(oPartDoc, "Project", "Part Number")
		'end
		
		
		Dim length = Len(partNumber) -4
		
		If Not occ.Name.StartsWith(Left(dispName,length)) Then
		Logger.Info(occ.Name.StartsWith(Left(dispName,length)), "2")
If(Left(occ.Name, 9)) <> "Zero Line" And (Left(occ.Name, 9)) <> "Zero line" And (Left(occ.Name, 15)) <> "Control cabinet" Then
		occ.Name = ""
	End If 
		Logger.Info("Reset browsernote", filename)
		
		Else
			If Left(occ.Name.ToString, Len(dispName)) = dispName Then
			
			Else
			Logger.Info(occ.Name.StartsWith(Left(dispName,length)) & " 2" , "2")

			Logger.Info("Browser Note " & occ.Name, filename)
If (Left(occ.Name, 9)) <> "Zero Line" And (Left(occ.Name, 9)) <> "Zero line" And (Left(occ.Name, 15)) <> "Control cabinet" Then
			occ.Name = ""
			
		End If 
		
		End If
	End If 
		'ResetOccurrenceNames(occ.SubOccurrences)
	Next
	Catch
		Logger.Info("somthing fail "   , filename)

	End Try
End Sub
```

#### Code Block 5

```vb
Dim ass As AssemblyDocument = ThisDoc.Document
For Each occ As ComponentOccurrence In ass.ComponentDefinition.Occurrences
	If Split(occ.Name, ":")(0) <> occ.Definition.Document.propertysets(3)("Part Number").value Then 
	occ.Name = ""
	If Split(occ.Name, ":")(0) <> occ.Definition.Document.propertysets(3)("Part Number").value Then 
	Dim doc As PartDocument = occ.Definition.Document
	doc.DisplayName = doc.propertysets(3)("Part Number").value
	occ.Name = ""
	End If 
	End If 
Next
```

#### Code Block 6

```vb
Dim ass As AssemblyDocument = ThisDoc.Document
For Each occ As ComponentOccurrence In ass.ComponentDefinition.Occurrences
	If Split(occ.Name, ":")(0) <> occ.Definition.Document.propertysets(3)("Part Number").value Then 
	occ.Name = ""
	If Split(occ.Name, ":")(0) <> occ.Definition.Document.propertysets(3)("Part Number").value Then 
	Dim doc As PartDocument = occ.Definition.Document
	doc.DisplayName = doc.propertysets(3)("Part Number").value
	occ.Name = ""
	End If 
	End If 
Next
```

---

### 155. search assembly containing virtual component

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/search-assembly-containing-virtual-component/td-p/13812753#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/search-assembly-containing-virtual-component/td-p/13812753#messageview_0)

**Author:** Bram_Jessen

**Date:** ‎09-16-2025
	
		
		05:17 AM

**Description:** Hello all, We're about to start with a PDM system. This system cannot handle virtual components. We have a a lot of assembly's en a few of them contain one or more virtual components. So we have find out which assembly has this and replace them with a "real" part. I've made batch tools in Ilogic in ...

**Code Snippets (1):**

#### Code Block 1

```vb
Dim ass As AssemblyDocument = ThisDoc.Document
For Each occ As ComponentOccurrence In ass.ComponentDefinition.Occurrences
	If TypeOf occ.Definition Is VirtualComponentDefinition Then 
				MsgBox (virtual)
	End If
Next
```

#### Code Block 2

```vb
Dim ass As AssemblyDocument = ThisDoc.Document
For Each occ As ComponentOccurrence In ass.ComponentDefinition.Occurrences
	If TypeOf occ.Definition Is VirtualComponentDefinition Then 
				MsgBox (virtual)
	End If
Next
```

---

### 156. setting Base Quantity to m^2 with iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/setting-base-quantity-to-m-2-with-ilogic/td-p/13750414](https://forums.autodesk.com/t5/inventor-programming-forum/setting-base-quantity-to-m-2-with-ilogic/td-p/13750414)

**Author:** nathan_m_gardner

**Date:** ‎08-01-2025
	
		
		11:49 AM

**Description:** We model some parts that are purchased as 50mm thick rolls (insulation) and need to display the sq meter of the part. These parts vary in size and shape. To do this, we have used the parts volume and divided it by 50(the thickness of the insulation). The issue comes with setting this in the "Bill of...

**Code Snippets (8):**

#### Code Block 1

```vb
' Check if "VOL" exists
Dim found As Boolean = False
For Each param As Parameter In ThisDoc.Document.ComponentDefinition.Parameters.UserParameters
    If param.Name = "VOL" Then
        found = True
        Exit For
    End If
Next

' Create VOL if missing, using unit string instead of enum
If Not found Then
    ThisDoc.Document.ComponentDefinition.Parameters.UserParameters.AddByValue("VOL", 1, "m^3")
End If

' Assign volume to VOL
VOL = iProperties.Volume

' Check if "AREA_INS" exists
Dim found2 As Boolean = False
For Each param As Parameter In ThisDoc.Document.ComponentDefinition.Parameters.UserParameters
    If param.Name = "AREA_INS" Then
        found2 = True
        Exit For
    End If
Next

' Create AREA_INS if missing, using unit string instead of enum
If Not found2 Then
    ThisDoc.Document.ComponentDefinition.Parameters.UserParameters.AddByValue("AREA_INS", 1, "m^2")
End If

' Assign area to AREA_INS
AREA_INS = iProperties.Volume/50 mm


' Assign New Parameters
Parameter("VOL") = iProperties.Volume
Parameter("AREA_INS") = iProperties.Volume/50 mm

iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 2

```vb
' Check if "VOL" exists
Dim found As Boolean = False
For Each param As Parameter In ThisDoc.Document.ComponentDefinition.Parameters.UserParameters
    If param.Name = "VOL" Then
        found = True
        Exit For
    End If
Next

' Create VOL if missing, using unit string instead of enum
If Not found Then
    ThisDoc.Document.ComponentDefinition.Parameters.UserParameters.AddByValue("VOL", 1, "m^3")
End If

' Assign volume to VOL
VOL = iProperties.Volume

' Check if "AREA_INS" exists
Dim found2 As Boolean = False
For Each param As Parameter In ThisDoc.Document.ComponentDefinition.Parameters.UserParameters
    If param.Name = "AREA_INS" Then
        found2 = True
        Exit For
    End If
Next

' Create AREA_INS if missing, using unit string instead of enum
If Not found2 Then
    ThisDoc.Document.ComponentDefinition.Parameters.UserParameters.AddByValue("AREA_INS", 1, "m^2")
End If

' Assign area to AREA_INS
AREA_INS = iProperties.Volume/50 mm


' Assign New Parameters
Parameter("VOL") = iProperties.Volume
Parameter("AREA_INS") = iProperties.Volume/50 mm

iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 3

```vb
' Check if "VOL" exists
Dim found As Boolean = False
For Each param As Parameter In ThisDoc.Document.ComponentDefinition.Parameters.UserParameters
    If param.Name = "VOL" Then
        found = True
        Exit For
    End If
Next

' Create VOL if missing, using unit string instead of enum
If Not found Then
    ThisDoc.Document.ComponentDefinition.Parameters.UserParameters.AddByValue("VOL", 1, "m^3")
End If

' Assign volume to VOL
VOL = iProperties.Volume

' Check if "AREA_INS" exists
Dim found2 As Boolean = False
For Each param As Parameter In ThisDoc.Document.ComponentDefinition.Parameters.UserParameters
    If param.Name = "AREA_INS" Then
        found2 = True
        Exit For
    End If
Next

' Create AREA_INS if missing, using unit string instead of enum
If Not found2 Then
    ThisDoc.Document.ComponentDefinition.Parameters.UserParameters.AddByValue("AREA_INS", 1, "m^2")
End If

' Assign area to AREA_INS
AREA_INS = iProperties.Volume/50 mm


' Assign New Parameters
Parameter("VOL") = iProperties.Volume
Parameter("AREA_INS") = iProperties.Volume/50 mm

iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 4

```vb
' Check if "VOL" exists
Dim found As Boolean = False
For Each param As Parameter In ThisDoc.Document.ComponentDefinition.Parameters.UserParameters
    If param.Name = "VOL" Then
        found = True
        Exit For
    End If
Next

' Create VOL if missing, using unit string instead of enum
If Not found Then
    ThisDoc.Document.ComponentDefinition.Parameters.UserParameters.AddByValue("VOL", 1, "m^3")
End If

' Assign volume to VOL
VOL = iProperties.Volume

' Check if "AREA_INS" exists
Dim found2 As Boolean = False
For Each param As Parameter In ThisDoc.Document.ComponentDefinition.Parameters.UserParameters
    If param.Name = "AREA_INS" Then
        found2 = True
        Exit For
    End If
Next

' Create AREA_INS if missing, using unit string instead of enum
If Not found2 Then
    ThisDoc.Document.ComponentDefinition.Parameters.UserParameters.AddByValue("AREA_INS", 1, "m^2")
End If

' Assign area to AREA_INS
AREA_INS = iProperties.Volume/50 mm


' Assign New Parameters
Parameter("VOL") = iProperties.Volume
Parameter("AREA_INS") = iProperties.Volume/50 mm

iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 5

```vb
Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
If oPDoc Is Nothing Then Exit Sub
Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
Dim dVOL As Double = oPDef.MassProperties.Volume
If dVOL = 0 Then Exit Sub
Dim oUsParams As UserParameters = oPDef.Parameters.UserParameters

Try
	oUsParams("VOL").Value = dVOL
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("VOL", dVOL, "m m m")
	oUsParam.ExposedAsProperty = True
	Call oPDef.BOMQuantity.SetBaseQuantity(BOMQuantityTypeEnum.kParameterBOMQuantity, oUsParam)
End Try

Try : oUsParams("AREA_INS").Value = dVOL / 5
Catch : oUsParams.AddByValue("AREA_INS", dVOL / 5, "m m")
End Try

Dim oCustom As PropertySet = oPDoc.PropertySets("Inventor User Defined Properties")
Try : oCustom("MATERIAL LIST DESCRIPTION").Value = "50mm BATTS"
Catch : oCustom.Add("MATERIAL LIST DESCRIPTION", "50mm BATTS") : End Try
```

#### Code Block 6

```vb
Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
If oPDoc Is Nothing Then Exit Sub
Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
Dim dVOL As Double = oPDef.MassProperties.Volume
If dVOL = 0 Then Exit Sub
Dim oUsParams As UserParameters = oPDef.Parameters.UserParameters

Try
	oUsParams("VOL").Value = dVOL
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("VOL", dVOL, "m m m")
	oUsParam.ExposedAsProperty = True
	Call oPDef.BOMQuantity.SetBaseQuantity(BOMQuantityTypeEnum.kParameterBOMQuantity, oUsParam)
End Try

Try : oUsParams("AREA_INS").Value = dVOL / 5
Catch : oUsParams.AddByValue("AREA_INS", dVOL / 5, "m m")
End Try

Dim oCustom As PropertySet = oPDoc.PropertySets("Inventor User Defined Properties")
Try : oCustom("MATERIAL LIST DESCRIPTION").Value = "50mm BATTS"
Catch : oCustom.Add("MATERIAL LIST DESCRIPTION", "50mm BATTS") : End Try
```

#### Code Block 7

```vb
Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
If oPDoc Is Nothing Then Exit Sub
Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
Dim dVOL As Double = oPDef.MassProperties.Volume
If dVOL = 0 Then Exit Sub
Dim oUsParams As UserParameters = oPDef.Parameters.UserParameters

Try
	oUsParams("VOL").Value = dVOL
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("VOL", dVOL, "m m m")
	oUsParam.ExposedAsProperty = True
	Call oPDef.BOMQuantity.SetBaseQuantity(BOMQuantityTypeEnum.kParameterBOMQuantity, oUsParam)
End Try

Try : oUsParams("AREA_INS").Value = dVOL / 5
Catch : oUsParams.AddByValue("AREA_INS", dVOL / 5, "m m")
End Try

Dim oCustom As PropertySet = oPDoc.PropertySets("Inventor User Defined Properties")
Try : oCustom("MATERIAL LIST DESCRIPTION").Value = "50mm BATTS"
Catch : oCustom.Add("MATERIAL LIST DESCRIPTION", "50mm BATTS") : End Try
```

#### Code Block 8

```vb
Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
If oPDoc Is Nothing Then Exit Sub
Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
Dim dVOL As Double = oPDef.MassProperties.Volume
If dVOL = 0 Then Exit Sub
Dim oUsParams As UserParameters = oPDef.Parameters.UserParameters

Try
	oUsParams("VOL").Value = dVOL
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("VOL", dVOL, "m m m")
	oUsParam.ExposedAsProperty = True
	Call oPDef.BOMQuantity.SetBaseQuantity(BOMQuantityTypeEnum.kParameterBOMQuantity, oUsParam)
End Try

Try : oUsParams("AREA_INS").Value = dVOL / 5
Catch : oUsParams.AddByValue("AREA_INS", dVOL / 5, "m m")
End Try

Dim oCustom As PropertySet = oPDoc.PropertySets("Inventor User Defined Properties")
Try : oCustom("MATERIAL LIST DESCRIPTION").Value = "50mm BATTS"
Catch : oCustom.Add("MATERIAL LIST DESCRIPTION", "50mm BATTS") : End Try
```

#### Code Block 9

```vb
Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
If oPDoc Is Nothing Then Exit Sub
Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
Dim dVOL As Double = oPDef.MassProperties.Volume
If dVOL = 0 Then Exit Sub
Dim oUsParams As UserParameters = oPDef.Parameters.UserParameters

Try
	oUsParams("VOL").Value = dVOL
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("VOL", dVOL, "m m m")
End Try

Try
	oUsParams("AREA_INS").Value = dVOL / 5
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("AREA_INS", dVOL / 5, "m m")
	oUsParam.ExposedAsProperty = True
	oUsParam.Units = "m"
	Call oPDef.BOMQuantity.SetBaseQuantity(BOMQuantityTypeEnum.kParameterBOMQuantity, oUsParam)
	oUsParam.Units = "m m"
End Try
Dim oCustom As PropertySet = oPDoc.PropertySets("Inventor User Defined Properties")
iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 10

```vb
Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
If oPDoc Is Nothing Then Exit Sub
Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
Dim dVOL As Double = oPDef.MassProperties.Volume
If dVOL = 0 Then Exit Sub
Dim oUsParams As UserParameters = oPDef.Parameters.UserParameters

Try
	oUsParams("VOL").Value = dVOL
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("VOL", dVOL, "m m m")
End Try

Try
	oUsParams("AREA_INS").Value = dVOL / 5
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("AREA_INS", dVOL / 5, "m m")
	oUsParam.ExposedAsProperty = True
	oUsParam.Units = "m"
	Call oPDef.BOMQuantity.SetBaseQuantity(BOMQuantityTypeEnum.kParameterBOMQuantity, oUsParam)
	oUsParam.Units = "m m"
End Try
Dim oCustom As PropertySet = oPDoc.PropertySets("Inventor User Defined Properties")
iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 11

```vb
Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
If oPDoc Is Nothing Then Exit Sub
Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
Dim dVOL As Double = oPDef.MassProperties.Volume
If dVOL = 0 Then Exit Sub
Dim oUsParams As UserParameters = oPDef.Parameters.UserParameters

Try
	oUsParams("VOL").Value = dVOL
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("VOL", dVOL, "m m m")
End Try

Try
	oUsParams("AREA_INS").Value = dVOL / 5
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("AREA_INS", dVOL / 5, "m m")
	oUsParam.ExposedAsProperty = True
	oUsParam.Units = "m"
	Call oPDef.BOMQuantity.SetBaseQuantity(BOMQuantityTypeEnum.kParameterBOMQuantity, oUsParam)
	oUsParam.Units = "m m"
End Try
Dim oCustom As PropertySet = oPDoc.PropertySets("Inventor User Defined Properties")
iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 12

```vb
Dim oPDoc As PartDocument = TryCast(ThisDoc.Document, PartDocument)
If oPDoc Is Nothing Then Exit Sub
Dim oPDef As PartComponentDefinition = oPDoc.ComponentDefinition
Dim dVOL As Double = oPDef.MassProperties.Volume
If dVOL = 0 Then Exit Sub
Dim oUsParams As UserParameters = oPDef.Parameters.UserParameters

Try
	oUsParams("VOL").Value = dVOL
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("VOL", dVOL, "m m m")
End Try

Try
	oUsParams("AREA_INS").Value = dVOL / 5
Catch
	Dim oUsParam As UserParameter = oUsParams.AddByValue("AREA_INS", dVOL / 5, "m m")
	oUsParam.ExposedAsProperty = True
	oUsParam.Units = "m"
	Call oPDef.BOMQuantity.SetBaseQuantity(BOMQuantityTypeEnum.kParameterBOMQuantity, oUsParam)
	oUsParam.Units = "m m"
End Try
Dim oCustom As PropertySet = oPDoc.PropertySets("Inventor User Defined Properties")
iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 13

```vb
Parameter("VOL") = iProperties.Volume
Parameter("AREA_INS") = iProperties.Volume/50.0 mm

iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 14

```vb
Parameter("VOL") = iProperties.Volume
Parameter("AREA_INS") = iProperties.Volume/50.0 mm

iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 15

```vb
Parameter("VOL") = iProperties.Volume
Parameter("AREA_INS") = iProperties.Volume/50.0 mm

iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

#### Code Block 16

```vb
Parameter("VOL") = iProperties.Volume
Parameter("AREA_INS") = iProperties.Volume/50.0 mm

iProperties.Value("Custom","MATERIAL LIST DESCRIPTION") = "50mm BATTS"
```

---

### 157. specifiying an ordinate zero point that is on the geometry not a center mark

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/specifiying-an-ordinate-zero-point-that-is-on-the-geometry-not-a/td-p/13801442](https://forums.autodesk.com/t5/inventor-programming-forum/specifiying-an-ordinate-zero-point-that-is-on-the-geometry-not-a/td-p/13801442)

**Author:** kurt.yonder

**Date:** ‎09-08-2025
	
		
		09:46 AM

**Description:** I have a view with center marks and I am trying to automatically create an ordinate set but I am struggling to specify the zero point which I would like to be the leftmost edge in the view not the leftmost center mark.  Is there a good way to do this? Sub Main     Dim oDDoc As DrawingDocument = This...

**Code Snippets (1):**

#### Code Block 1

```vb
Sub Main
    Dim oDDoc As DrawingDocument = ThisDrawing.Document
    Dim oSheet As Sheet = oDDoc.ActiveSheet
    Dim oOrdDimSets As OrdinateDimensionSets = oSheet.DrawingDimensions.OrdinateDimensionSets
    Dim oOrdDimSet As OrdinateDimensionSet
    Dim oIntents As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
    Dim oTG As TransientGeometry = ThisApplication.TransientGeometry

    ' Collect center mark geometry intents
    For Each oCM As Centermark In oSheet.Centermarks
        Dim oGIntent As GeometryIntent = Nothing
        If oCM.Attached Then
            If TypeOf oCM.AttachedEntity Is GeometryIntent Then
                oGIntent = oCM.AttachedEntity
            End If
        End If
        If oGIntent Is Nothing Then
            oGIntent = oSheet.CreateGeometryIntent(oCM, PointIntentEnum.kCenterPointIntent)
        End If
        oIntents.Add(oGIntent)
    Next

    If oIntents.Count = 0 Then
        MsgBox("There were no 'Geometry Intents' added to the collection. Exiting.", , "")
        Exit Sub
    End If
	
' === ORDINATE: origin at left edge, baseline just outside the view ===
' Find BASE VIEW 
Dim BASE_VIEW As DrawingView = Nothing
For Each v As DrawingView In oSheet.DrawingViews
    If StrComp(v.Name, "BASE VIEW", vbTextCompare) = 0 Then
        BASE_VIEW = v : Exit For
    End If
Next
If BASE_VIEW Is Nothing Then
    MsgBox("BASE VIEW not found.", vbExclamation, "Ordinate")
    Exit Sub
End If

' Pick the LEFTMOST centermark as the origin 
Dim originGI As GeometryIntent = Nothing
Dim minX As Double = Double.MaxValue
For Each oCM As Centermark In oSheet.Centermarks
    Dim gi As GeometryIntent = oSheet.CreateGeometryIntent(oCM, PointIntentEnum.kCenterPointIntent)
    Dim pt As Point2d = gi.PointOnSheet
    If pt.X < minX Then
        minX = pt.X
        originGI = gi
    End If
Next
If originGI Is Nothing Then
    MsgBox("No centermarks found for ordinate set.", vbExclamation, "Ordinate")
    Exit Sub
End If

' Rebuild intents so ORIGIN is first
Dim intentsOrdered As ObjectCollection = ThisApplication.TransientObjects.CreateObjectCollection
intentsOrdered.Add(originGI)
For Each o In oIntents
    If TypeOf o Is GeometryIntent Then
        Dim gi = DirectCast(o, GeometryIntent)
        If Not (gi Is originGI) Then intentsOrdered.Add(gi)
    Else
        intentsOrdered.Add(o)
    End If
Next

' Baseline: vertical at LEFT edge 
Dim gap As Double = 0.00
Dim leftX As Double = BASE_VIEW.Center.X - (BASE_VIEW.Width / 2) - gap
Dim midY  As Double = BASE_VIEW.Center.Y
Dim oPlacement As Point2d = oTG.CreatePoint2d(leftX, midY)

' Create ordinate set
Try
    oOrdDimSet = oOrdDimSets.Add(intentsOrdered, oPlacement, DimensionTypeEnum.kHorizontalDimensionType)
Catch ex As Exception
    MsgBox("Failed to add vertical ordinate set." & vbCrLf & ex.Message, vbExclamation, "Ordinate")
    Exit Sub
End Try





End Sub
```

---

### 158. trying to extrude a acad dxf by ilogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/trying-to-extrude-a-acad-dxf-by-ilogic/td-p/13745079](https://forums.autodesk.com/t5/inventor-programming-forum/trying-to-extrude-a-acad-dxf-by-ilogic/td-p/13745079)

**Author:** mecanicu

**Date:** ‎07-29-2025
	
		
		11:22 AM

**Description:** Hello.I made a ilogic code that create a sketch in a part and insert a acad dxf, after that i try to extrude the profiles but inventor cand find any on the sketch. if i try to extrude them manually i cand select the contour or the fill, everything is fine.here is my code till now :Sub Main()      Di...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim combinedProfile As Profile = oSketch.Profiles.AddForSolid()
```

#### Code Block 2

```vb
Dim combinedProfile As Profile = oSketch.Profiles.AddForSolid()
```

#### Code Block 3

```vb
Sub Main()

    Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument
    Dim oCompDef As PartComponentDefinition = oPartDoc.ComponentDefinition

    ' Șterge schița SketchLitere dacă există
    For Each sk As PlanarSketch In oCompDef.Sketches
        If sk.Name = "SketchLitere" Then
            sk.ExitEdit()
			sk.Delete()
            Exit For
        End If
    Next

    ' Creează schița SketchLitere pe planul XY (de obicei WorkPlanes.Item(3))
    Dim oXYPlane As WorkPlane = oCompDef.WorkPlanes.Item(3)
    Dim oSketch As PlanarSketch = oCompDef.Sketches.Add(oXYPlane)
    oSketch.Name = "SketchLitere"
    oSketch.Edit()

    ' Selectează fișierul DXF/DWG
    Dim dlg As New System.Windows.Forms.OpenFileDialog()
    dlg.Filter = "DXF or DWG files (*.dxf;*.dwg)|*.dxf;*.dwg"
    dlg.Title = "Selectează fișierul DXF/DWG"
    If dlg.ShowDialog() <> System.Windows.Forms.DialogResult.OK Then
        MessageBox.Show("Fișierul nu a fost selectat.", "Eroare", MessageBoxButtons.OK, MessageBoxIcon.Error)
        oSketch.ExitEdit()
        Return
    End If

    Dim sFileName As String = dlg.FileName

    ' Lansează comanda de import DXF în schița activă (SketchLitere)
    Dim oCmdMgr As CommandManager = ThisApplication.CommandManager
    oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, sFileName)
    oCmdMgr.ControlDefinitions("SketchInsertAutoCADFileCmd").Execute()

    ' Așteaptă ca utilizatorul să finalizeze importul în fereastra care s-a deschis
    MessageBox.Show("Finalizează importul în fereastra care s-a deschis, apoi apasă OK aici pentru a continua.", _
                    "Continuă", MessageBoxButtons.OK, MessageBoxIcon.Information)

    ' Închide schița pentru a putea folosi profilele
    oSketch.ExitEdit()

    ' Verifică parametrul "Adancime"
    Dim adancime As Double
    Try
        Dim oParam As UserParameter = oCompDef.Parameters.UserParameters.Item("Adancime")
        adancime = oParam.Value
    Catch ex As Exception
        MessageBox.Show("Parametrul 'Adancime' nu există. Creează-l înainte de a rula regula.", "Eroare", MessageBoxButtons.OK, MessageBoxIcon.Error)
        Return
    End Try

    ' Verifică dacă există profile
    If oSketch.Profiles.Count = 0 Then
		
        MessageBox.Show("Nu s-au importat profile din DXF.", oSketch.SketchEntities.Type.ToString, MessageBoxButtons.OK, MessageBoxIcon.Error)
        Return
    End If
    
    ' Extrudare combinată cu toate profilele
    ExtrudeAllProfiles(oCompDef, oSketch, adancime)

End Sub

Sub ExtrudeAllProfiles(oCompDef As PartComponentDefinition, oSketch As PlanarSketch, ByVal adancime As Double)
    ' Crează profil combinat cu găuri din toate profilele schiței
    Dim combinedProfile As Profile = oSketch.Profiles.AddForSolid()

    Dim extrudeDef As ExtrudeDefinition = oCompDef.Features.ExtrudeFeatures.CreateExtrudeDefinition(combinedProfile, PartFeatureOperationEnum.kNewBodyOperation)
    extrudeDef.SetDistanceExtent(adancime, PartFeatureExtentDirectionEnum.kPositiveExtentDirection)

    oCompDef.Features.ExtrudeFeatures.Add(extrudeDef)

    MessageBox.Show("Extrudare finalizată cu succes!", "Succes", MessageBoxButtons.OK, MessageBoxIcon.Information)
End Sub
```

#### Code Block 4

```vb
Sub Main()

    Dim oPartDoc As PartDocument = ThisApplication.ActiveDocument
    Dim oCompDef As PartComponentDefinition = oPartDoc.ComponentDefinition

    ' Șterge schița SketchLitere dacă există
    For Each sk As PlanarSketch In oCompDef.Sketches
        If sk.Name = "SketchLitere" Then
            sk.ExitEdit()
			sk.Delete()
            Exit For
        End If
    Next

    ' Creează schița SketchLitere pe planul XY (de obicei WorkPlanes.Item(3))
    Dim oXYPlane As WorkPlane = oCompDef.WorkPlanes.Item(3)
    Dim oSketch As PlanarSketch = oCompDef.Sketches.Add(oXYPlane)
    oSketch.Name = "SketchLitere"
    oSketch.Edit()

    ' Selectează fișierul DXF/DWG
    Dim dlg As New System.Windows.Forms.OpenFileDialog()
    dlg.Filter = "DXF or DWG files (*.dxf;*.dwg)|*.dxf;*.dwg"
    dlg.Title = "Selectează fișierul DXF/DWG"
    If dlg.ShowDialog() <> System.Windows.Forms.DialogResult.OK Then
        MessageBox.Show("Fișierul nu a fost selectat.", "Eroare", MessageBoxButtons.OK, MessageBoxIcon.Error)
        oSketch.ExitEdit()
        Return
    End If

    Dim sFileName As String = dlg.FileName

    ' Lansează comanda de import DXF în schița activă (SketchLitere)
    Dim oCmdMgr As CommandManager = ThisApplication.CommandManager
    oCmdMgr.PostPrivateEvent(PrivateEventTypeEnum.kFileNameEvent, sFileName)
    oCmdMgr.ControlDefinitions("SketchInsertAutoCADFileCmd").Execute()

    ' Așteaptă ca utilizatorul să finalizeze importul în fereastra care s-a deschis
    MessageBox.Show("Finalizează importul în fereastra care s-a deschis, apoi apasă OK aici pentru a continua.", _
                    "Continuă", MessageBoxButtons.OK, MessageBoxIcon.Information)

    ' Închide schița pentru a putea folosi profilele
    oSketch.ExitEdit()

    ' Verifică parametrul "Adancime"
    Dim adancime As Double
    Try
        Dim oParam As UserParameter = oCompDef.Parameters.UserParameters.Item("Adancime")
        adancime = oParam.Value
    Catch ex As Exception
        MessageBox.Show("Parametrul 'Adancime' nu există. Creează-l înainte de a rula regula.", "Eroare", MessageBoxButtons.OK, MessageBoxIcon.Error)
        Return
    End Try

    ' Verifică dacă există profile
    If oSketch.Profiles.Count = 0 Then
		
        MessageBox.Show("Nu s-au importat profile din DXF.", oSketch.SketchEntities.Type.ToString, MessageBoxButtons.OK, MessageBoxIcon.Error)
        Return
    End If
    
    ' Extrudare combinată cu toate profilele
    ExtrudeAllProfiles(oCompDef, oSketch, adancime)

End Sub

Sub ExtrudeAllProfiles(oCompDef As PartComponentDefinition, oSketch As PlanarSketch, ByVal adancime As Double)
    ' Crează profil combinat cu găuri din toate profilele schiței
    Dim combinedProfile As Profile = oSketch.Profiles.AddForSolid()

    Dim extrudeDef As ExtrudeDefinition = oCompDef.Features.ExtrudeFeatures.CreateExtrudeDefinition(combinedProfile, PartFeatureOperationEnum.kNewBodyOperation)
    extrudeDef.SetDistanceExtent(adancime, PartFeatureExtentDirectionEnum.kPositiveExtentDirection)

    oCompDef.Features.ExtrudeFeatures.Add(extrudeDef)

    MessageBox.Show("Extrudare finalizată cu succes!", "Succes", MessageBoxButtons.OK, MessageBoxIcon.Information)
End Sub
```

#### Code Block 5

```vb
oSketch.Profiles.AddForSolid()
```

#### Code Block 6

```vb
oSketch.Profiles.AddForSolid()
```

#### Code Block 7

```vb
oSketch.Profiles.AddForSolid()
```

#### Code Block 8

```vb
oSketch.Profiles.AddForSolid()
```

---

### 159. update drawing line colour based on part colour

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/update-drawing-line-colour-based-on-part-colour/td-p/7417136](https://forums.autodesk.com/t5/inventor-programming-forum/update-drawing-line-colour-based-on-part-colour/td-p/7417136)

**Author:** brotherkennyh

**Date:** ‎09-28-2017
	
		
		07:34 AM

**Description:** Hi, Is it possible to have the lines in an unshaded view follow the colour of the appearance of a part. I want to be able to see the part colour without having to have shaded views on.   Is this possible?   Failing that, is there a way to get the colour with iLogic to have the drawing line colours u...

**Code Snippets (7):**

#### Code Block 1

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument
Dim oSheets As Sheets
oSheets = ThisDoc.Document.Sheets

Dim oSheet As Sheet
'Iterate through the sheets
i=0
For Each oSheet In oSheets		
	If oSheet.ExcludeFromCount = True Then
		i = i + 1
		oSheet.Name = "PartsList" & "-" & i		
	End If	
Next

oPartsListSheetCount = i

i = 0
For Each oSheet In oSheets	
	If oSheet.Name.Contains("PartsList") Then
		If oSheet.TitleBlock IsNot Nothing Then 
		    oTitleBlock = oSheet.TitleBlock
		    oTextBoxes = oTitleBlock.Definition.Sketch.TextBoxes
		    For Each oTextBox In oTitleBlock.Definition.Sketch.TextBoxes
				If oTextBox.Text = "PartsList_OF_PartsLists"
					i = i + 1
					oPromptEntry =  i & " OF " & oPartsListSheetCount
					Call oTitleBlock.SetPromptResultText(oTextBox, oPromptEntry)
					
				End If
		    Next
		End If
	End If
Next
```

#### Code Block 2

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument
Dim oSheets As Sheets
oSheets = ThisDoc.Document.Sheets

Dim oSheet As Sheet
'Iterate through the sheets
i=0
For Each oSheet In oSheets		
	If oSheet.ExcludeFromCount = True Then
		i = i + 1
		oSheet.Name = "PartsList" & "-" & i		
	End If	
Next

oPartsListSheetCount = i

i = 0
For Each oSheet In oSheets	
	If oSheet.Name.Contains("PartsList") Then
		If oSheet.TitleBlock IsNot Nothing Then 
		    oTitleBlock = oSheet.TitleBlock
		    oTextBoxes = oTitleBlock.Definition.Sketch.TextBoxes
		    For Each oTextBox In oTitleBlock.Definition.Sketch.TextBoxes
				If oTextBox.Text = "PartsList_OF_PartsLists"
					i = i + 1
					oPromptEntry =  i & " OF " & oPartsListSheetCount
					Call oTitleBlock.SetPromptResultText(oTextBox, oPromptEntry)
					
				End If
		    Next
		End If
	End If
Next
```

#### Code Block 3

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument
Dim oSheets As Sheets
oSheets = ThisDoc.Document.Sheets

Dim oSheet As Sheet
'Iterate through the sheets
i=0
For Each oSheet In oSheets		
	If oSheet.Name.Contains("Stückliste") Then
		i = i + 1
	End If	
Next

oPartsListSheetCount = i

i = 0
For Each oSheet In oSheets	
	If oSheet.Name.Contains("Stückliste") Then
		If oSheet.TitleBlock IsNot Nothing Then 
		    oTitleBlock = oSheet.TitleBlock
		    oTextBoxes = oTitleBlock.Definition.Sketch.TextBoxes
		    For Each oTextBox In oTitleBlock.Definition.Sketch.TextBoxes
				If oTextBox.Text = "BlattAnzahl"
					oPromptEntry1 = oPartsListSheetCount
					Call oTitleBlock.SetPromptResultText(oTextBox, oPromptEntry1)
					
				End If
				If oTextBox.Text = "BlattNummer"
					i = i + 1
					oPromptEntry2 =  i
					Call oTitleBlock.SetPromptResultText(oTextBox, oPromptEntry2)
					
				End If
		    Next
		End If
	End If
Next
```

#### Code Block 4

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument
Dim oSheets As Sheets
oSheets = ThisDoc.Document.Sheets

Dim oSheet As Sheet
'Iterate through the sheets
i=0
For Each oSheet In oSheets		
	If oSheet.Name.Contains("Stückliste") Then
		i = i + 1
	End If	
Next

oPartsListSheetCount = i

i = 0
For Each oSheet In oSheets	
	If oSheet.Name.Contains("Stückliste") Then
		If oSheet.TitleBlock IsNot Nothing Then 
		    oTitleBlock = oSheet.TitleBlock
		    oTextBoxes = oTitleBlock.Definition.Sketch.TextBoxes
		    For Each oTextBox In oTitleBlock.Definition.Sketch.TextBoxes
				If oTextBox.Text = "BlattAnzahl"
					oPromptEntry1 = oPartsListSheetCount
					Call oTitleBlock.SetPromptResultText(oTextBox, oPromptEntry1)
					
				End If
				If oTextBox.Text = "BlattNummer"
					i = i + 1
					oPromptEntry2 =  i
					Call oTitleBlock.SetPromptResultText(oTextBox, oPromptEntry2)
					
				End If
		    Next
		End If
	End If
Next
```

#### Code Block 5

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument
Dim oSheets As Sheets
oSheets = ThisDoc.Document.Sheets

Dim oSheet As Sheet
'Iterate through the sheets
i=0
For Each oSheet In oSheets		
	If oSheet.Name.Contains("Stückliste") Then
		oSheet.ExcludeFromCount = True
		i = i + 1
	End If	
Next

'.... the rest of your code here
```

#### Code Block 6

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument
Dim oSheets As Sheets
oSheets = ThisDoc.Document.Sheets

Dim oSheet As Sheet
'Iterate through the sheets
i=0
For Each oSheet In oSheets		
	If oSheet.Name.Contains("Stückliste") Then
		oSheet.ExcludeFromCount = True
		i = i + 1
	End If	
Next

'.... the rest of your code here
```

#### Code Block 7

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument
Dim oSheets As Sheets
oSheets = ThisDoc.Document.Sheets
Dim oSheet As Sheet
oSheet = ThisDoc.Document.ActiveSheet
Dim oPageTotal As Integer
i = oPageTotal

'Iterate through the sheets
For Each oSheet In oSheets
	oSheet.Activate
		
	'Verify that the Sheet Name is Page
	If oSheet.Name = "Page" Then
		i = i+1
	End If
Next

iProperties.Value("Custom", "PartslistSheetTotal") = oPageTotal
```

#### Code Block 8

```vb
Dim oDrawDoc As DrawingDocument
oDrawDoc = ThisApplication.ActiveDocument
Dim oSheets As Sheets
oSheets = ThisDoc.Document.Sheets
Dim oSheet As Sheet
oSheet = ThisDoc.Document.ActiveSheet
Dim oPageTotal As Integer
i = oPageTotal

'Iterate through the sheets
For Each oSheet In oSheets
	oSheet.Activate
		
	'Verify that the Sheet Name is Page
	If oSheet.Name = "Page" Then
		i = i+1
	End If
Next

iProperties.Value("Custom", "PartslistSheetTotal") = oPageTotal
```

#### Code Block 9

```vb
SheetName1 = ActiveSheet.Sheet.Name
          SheetName2 = Split(SheetName1, ":")(0)
```

#### Code Block 10

```vb
SheetName1 = ActiveSheet.Sheet.Name
          SheetName2 = Split(SheetName1, ":")(0)
```

#### Code Block 11

```vb
Sub Main 
	' Get the active drawing document. 
	Dim oDoc As DrawingDocument 
	oDoc = ThisApplication.ActiveDocument 
	
	Dim oSheet As Sheet
	oSheet = oDoc.ActiveSheet	
	
	Dim oViews As DrawingViews
	Dim oView As DrawingView
	

	'get the collection of view on the sheet
	oViews = oSheet.DrawingViews		
	
	' Iterate through the views on the sheet
	For Each oView In oViews	
		
		Dim docDesc As DocumentDescriptor 
		docDesc = oView.ReferencedDocumentDescriptor  
		
		' Verify that the drawing view is of an assembly. 
		If docDesc.ReferencedDocumentType <> kAssemblyDocumentObject Then 
			Continue For
		End If  
		
		' Get the component definition for the assembly. 
		Dim asmDef As AssemblyComponentDefinition 
		asmDef = docDesc.ReferencedDocument.ComponentDefinition 
		
		'define view rep collection
		Dim oViewReps As DesignViewRepresentations
		oViewReps = asmDef.RepresentationsManager.DesignViewRepresentations
		
		oColourViewRepFound = False
		For Each oViewRep In oViewReps
			If oViewRep.Name = "Colour" Then
				oColourViewRepFound = True 
			End If
		Next
		
		If oColourViewRepFound = True Then
			Call ProcessAssemblyColor(oView, asmDef.Occurrences) 
		End If
	Next

End Sub 



Private Sub ProcessAssemblyColor(drawView As DrawingView, _ 
                                 Occurrences As ComponentOccurrences) 
   ' Iterate through the current collection of occurrences. 
   Dim occ As ComponentOccurrence 
   For Each occ In Occurrences 
      ' Check to see if this occurrence is a part or assembly. 
      If occ.DefinitionDocumentType = kPartDocumentObject Then 

         ' Get the render style of the occurrence. 
         Dim color As RenderStyle 
         Dim sourceType As StyleSourceTypeEnum 
         color = occ.GetRenderStyle(sourceType)  
		If color.name IsNot Nothing Then
		 iProperties.Value("Custom", "Colour") = color.name
		 Exit For
	 	End If
			

      End If 
   Next 
End Sub
```

#### Code Block 12

```vb
Sub Main 
	' Get the active drawing document. 
	Dim oDoc As DrawingDocument 
	oDoc = ThisApplication.ActiveDocument 
	
	Dim oSheet As Sheet
	oSheet = oDoc.ActiveSheet	
	
	Dim oViews As DrawingViews
	Dim oView As DrawingView
	

	'get the collection of view on the sheet
	oViews = oSheet.DrawingViews		
	
	' Iterate through the views on the sheet
	For Each oView In oViews	
		
		Dim docDesc As DocumentDescriptor 
		docDesc = oView.ReferencedDocumentDescriptor  
		
		' Verify that the drawing view is of an assembly. 
		If docDesc.ReferencedDocumentType <> kAssemblyDocumentObject Then 
			Continue For
		End If  
		
		' Get the component definition for the assembly. 
		Dim asmDef As AssemblyComponentDefinition 
		asmDef = docDesc.ReferencedDocument.ComponentDefinition 
		
		'define view rep collection
		Dim oViewReps As DesignViewRepresentations
		oViewReps = asmDef.RepresentationsManager.DesignViewRepresentations
		
		oColourViewRepFound = False
		For Each oViewRep In oViewReps
			If oViewRep.Name = "Colour" Then
				oColourViewRepFound = True 
			End If
		Next
		
		If oColourViewRepFound = True Then
			Call ProcessAssemblyColor(oView, asmDef.Occurrences) 
		End If
	Next

End Sub 



Private Sub ProcessAssemblyColor(drawView As DrawingView, _ 
                                 Occurrences As ComponentOccurrences) 
   ' Iterate through the current collection of occurrences. 
   Dim occ As ComponentOccurrence 
   For Each occ In Occurrences 
      ' Check to see if this occurrence is a part or assembly. 
      If occ.DefinitionDocumentType = kPartDocumentObject Then 

         ' Get the render style of the occurrence. 
         Dim color As RenderStyle 
         Dim sourceType As StyleSourceTypeEnum 
         color = occ.GetRenderStyle(sourceType)  
		If color.name IsNot Nothing Then
		 iProperties.Value("Custom", "Colour") = color.name
		 Exit For
	 	End If
			

      End If 
   Next 
End Sub
```

#### Code Block 13

```vb
Sub Main 
	' Get the active drawing document. 
	Dim oDoc As DrawingDocument 
	oDoc = ThisApplication.ActiveDocument 
	
	Dim oSheets As Sheets
	oSheets = oDoc.Sheets
	Dim oSheet As Sheet
	
	'get current sheet so it can
	'be made active again later
	Dim oCurrentSheet As Sheet
	oCurrentSheet = oDoc.ActiveSheet	
	
	Dim oViews As DrawingViews
	Dim oView As DrawingView
	
	' Iterate through the sheets
	For Each oSheet In oSheets
	'	activate the sheet
		oSheet.Activate
		
		'get the collection of view on the sheet
		oViews = oSheet.DrawingViews		
		
		' Iterate through the views on the sheet
		For Each oView In oViews	
			
			Dim docDesc As DocumentDescriptor 
			docDesc = oView.ReferencedDocumentDescriptor  
			
			' Verify that the drawing view is of an assembly. 
			If docDesc.ReferencedDocumentType <> kAssemblyDocumentObject Then 
				Continue For
			End If  
			
			' Get the component definition for the assembly. 
			Dim asmDef As AssemblyComponentDefinition 
			asmDef = docDesc.ReferencedDocument.ComponentDefinition  
			
			' Process the view, wrapping it in a transaction so the 
			' each view can be undone with a single undo operation. 
			Dim trans As Transaction 
			trans = ThisApplication.TransactionManager.StartTransaction( _ 
									oDoc, "Change drawing view color")  
			
			' Call the recursive function that does all the work. 
			Call ProcessAssemblyColor(oView, asmDef.Occurrences) 
			trans.End 
		Next
		'update the sheet
		oSheet.Update
	Next
	
	'return to original sheet	
	oCurrentSheet.Activate
End Sub 



Private Sub ProcessAssemblyColor(drawView As DrawingView, _ 
                                 Occurrences As ComponentOccurrences) 
   ' Iterate through the current collection of occurrences. 
   Dim occ As ComponentOccurrence 
   For Each occ In Occurrences 
      ' Check to see if this occurrence is a part or assembly. 
      If occ.DefinitionDocumentType = kPartDocumentObject Then 
         ' ** It's a part so process the color.  

         ' Get the render style of the occurrence. 
         Dim color As RenderStyle 
         Dim sourceType As StyleSourceTypeEnum 
         color = occ.GetRenderStyle(sourceType)  

         ' Get the TransientsObjects object to use later. 
         Dim transObjs As TransientObjects 
         transObjs = ThisApplication.TransientObjects  

         ' Verify that a layer exists for this color. 
         Dim layers As LayersEnumerator 
         layers = drawView.Parent.Parent.StylesManager.layers  

         Dim oDoc As DrawingDocument 
         oDoc = drawView.Parent.Parent  

         On Error Resume Next 
         Dim colorLayer As Layer 
         colorLayer = layers.Item(color.Name)  

         If Err.Number <> 0 Then 
            On Error Goto 0 
            ' Get the diffuse color for the render style. 
            Dim red As Byte 
            Dim green As Byte 
            Dim blue As Byte  

            ' Create a color object that is the diffuse color. 
            Call color.GetDiffuseColor(red, green, blue) 
            Dim newColor As color 
            newColor = transObjs.CreateColor(red, green, blue)  

            ' Copy an arbitrary layer giving it the name 
            ' of the render style. 
            colorLayer = layers.Item(1).Copy(color.Name) 

            ' the attributes of the layer to use the color, 
            ' have a solid line type, and a specific width. 
            colorLayer.Color = newColor 
            colorLayer.LineType = kContinuousLineType 
            colorLayer.LineWeight = 0.02 
         End If 
         On Error Goto 0  

         ' Get all of the curves associated with this occurrence. 
         On Error Resume Next 
         Dim drawcurves As DrawingCurvesEnumerator 
         drawcurves = drawView.DrawingCurves(occ) 
         If Err.Number = 0 Then 
            On Error Goto 0  

            ' Create an empty collection. 
            Dim objColl As ObjectCollection 
            objColl = transObjs.CreateObjectCollection()  

            ' Add the curve segments to the collection. 
            Dim drawCurve As DrawingCurve 
            For Each drawCurve In drawcurves 
               Dim segment As DrawingCurveSegment 
               For Each segment In drawCurve.Segments 
                  objColl.Add (segment)
               Next 
            Next  

            ' Change the layer of all of the segments. 
            Call drawView.Parent.ChangeLayer(objColl, colorLayer) 
         End If 
         On Error Goto 0 
      Else 
         ' It's an assembly so process its contents. 
         Call ProcessAssemblyColor(drawView, occ.SubOccurrences) 
      End If 
   Next 
End Sub
```

#### Code Block 14

```vb
Sub Main 
	' Get the active drawing document. 
	Dim oDoc As DrawingDocument 
	oDoc = ThisApplication.ActiveDocument 
	
	Dim oSheets As Sheets
	oSheets = oDoc.Sheets
	Dim oSheet As Sheet
	
	'get current sheet so it can
	'be made active again later
	Dim oCurrentSheet As Sheet
	oCurrentSheet = oDoc.ActiveSheet	
	
	Dim oViews As DrawingViews
	Dim oView As DrawingView
	
	' Iterate through the sheets
	For Each oSheet In oSheets
	'	activate the sheet
		oSheet.Activate
		
		'get the collection of view on the sheet
		oViews = oSheet.DrawingViews		
		
		' Iterate through the views on the sheet
		For Each oView In oViews	
			
			Dim docDesc As DocumentDescriptor 
			docDesc = oView.ReferencedDocumentDescriptor  
			
			' Verify that the drawing view is of an assembly. 
			If docDesc.ReferencedDocumentType <> kAssemblyDocumentObject Then 
				Continue For
			End If  
			
			' Get the component definition for the assembly. 
			Dim asmDef As AssemblyComponentDefinition 
			asmDef = docDesc.ReferencedDocument.ComponentDefinition  
			
			' Process the view, wrapping it in a transaction so the 
			' each view can be undone with a single undo operation. 
			Dim trans As Transaction 
			trans = ThisApplication.TransactionManager.StartTransaction( _ 
									oDoc, "Change drawing view color")  
			
			' Call the recursive function that does all the work. 
			Call ProcessAssemblyColor(oView, asmDef.Occurrences) 
			trans.End 
		Next
		'update the sheet
		oSheet.Update
	Next
	
	'return to original sheet	
	oCurrentSheet.Activate
End Sub 



Private Sub ProcessAssemblyColor(drawView As DrawingView, _ 
                                 Occurrences As ComponentOccurrences) 
   ' Iterate through the current collection of occurrences. 
   Dim occ As ComponentOccurrence 
   For Each occ In Occurrences 
      ' Check to see if this occurrence is a part or assembly. 
      If occ.DefinitionDocumentType = kPartDocumentObject Then 
         ' ** It's a part so process the color.  

         ' Get the render style of the occurrence. 
         Dim color As RenderStyle 
         Dim sourceType As StyleSourceTypeEnum 
         color = occ.GetRenderStyle(sourceType)  

         ' Get the TransientsObjects object to use later. 
         Dim transObjs As TransientObjects 
         transObjs = ThisApplication.TransientObjects  

         ' Verify that a layer exists for this color. 
         Dim layers As LayersEnumerator 
         layers = drawView.Parent.Parent.StylesManager.layers  

         Dim oDoc As DrawingDocument 
         oDoc = drawView.Parent.Parent  

         On Error Resume Next 
         Dim colorLayer As Layer 
         colorLayer = layers.Item(color.Name)  

         If Err.Number <> 0 Then 
            On Error Goto 0 
            ' Get the diffuse color for the render style. 
            Dim red As Byte 
            Dim green As Byte 
            Dim blue As Byte  

            ' Create a color object that is the diffuse color. 
            Call color.GetDiffuseColor(red, green, blue) 
            Dim newColor As color 
            newColor = transObjs.CreateColor(red, green, blue)  

            ' Copy an arbitrary layer giving it the name 
            ' of the render style. 
            colorLayer = layers.Item(1).Copy(color.Name) 

            ' the attributes of the layer to use the color, 
            ' have a solid line type, and a specific width. 
            colorLayer.Color = newColor 
            colorLayer.LineType = kContinuousLineType 
            colorLayer.LineWeight = 0.02 
         End If 
         On Error Goto 0  

         ' Get all of the curves associated with this occurrence. 
         On Error Resume Next 
         Dim drawcurves As DrawingCurvesEnumerator 
         drawcurves = drawView.DrawingCurves(occ) 
         If Err.Number = 0 Then 
            On Error Goto 0  

            ' Create an empty collection. 
            Dim objColl As ObjectCollection 
            objColl = transObjs.CreateObjectCollection()  

            ' Add the curve segments to the collection. 
            Dim drawCurve As DrawingCurve 
            For Each drawCurve In drawcurves 
               Dim segment As DrawingCurveSegment 
               For Each segment In drawCurve.Segments 
                  objColl.Add (segment)
               Next 
            Next  

            ' Change the layer of all of the segments. 
            Call drawView.Parent.ChangeLayer(objColl, colorLayer) 
         End If 
         On Error Goto 0 
      Else 
         ' It's an assembly so process its contents. 
         Call ProcessAssemblyColor(drawView, occ.SubOccurrences) 
      End If 
   Next 
End Sub
```

---

### 160. what is the &quot;correct&quot; way to write this line of code for a rule?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/what-is-the-quot-correct-quot-way-to-write-this-line-of-code-for/td-p/13761867](https://forums.autodesk.com/t5/inventor-programming-forum/what-is-the-quot-correct-quot-way-to-write-this-line-of-code-for/td-p/13761867)

**Author:** chris

**Date:** ‎08-10-2025
	
		
		07:19 PM

**Description:** I have a top level assembly, and within that top level assembly I have a sub-assembly. That sub-assembly contains a pattern feature called "Array", I'd like to control this sub-assembly feature from the top level to where it will be either "True" or "False". I'm trying to use this snippet:    Featur...

**Code Snippets (12):**

#### Code Block 1

```vb
' <FireOthersImmediately>False</FireOthersImmediately>
Sub Main() ExplodePattern
'**** Define Assembly & Pattern Occurence.
Dim oDoc As AssemblyDocument
        oDoc = ThisApplication.ActiveDocument

Dim oPattern As OccurrencePattern
		oPatternInput = InputBox("Pattern Feature Name")
        oPattern = oDoc.ComponentDefinition.OccurrencePatterns.Item(oPatternInput)
'**** Make each element dependent starting from the 2nd element.
Dim i As Integer

'**** Count the amount of elements after the 2nd.
    For i = 2 To oPattern.OccurrencePatternElements.Count

'**** Make all elements "Independent".
            oPattern.OccurrencePatternElements.Item(i).Independent = True
      Next

'**** Delete pattern leaving only original and independent items.
oPattern.Delete

 End Sub
```

#### Code Block 2

```vb
' <FireOthersImmediately>False</FireOthersImmediately>
Sub Main() ExplodePattern
'**** Define Assembly & Pattern Occurence.
Dim oDoc As AssemblyDocument
        oDoc = ThisApplication.ActiveDocument

Dim oPattern As OccurrencePattern
		oPatternInput = InputBox("Pattern Feature Name")
        oPattern = oDoc.ComponentDefinition.OccurrencePatterns.Item(oPatternInput)
'**** Make each element dependent starting from the 2nd element.
Dim i As Integer

'**** Count the amount of elements after the 2nd.
    For i = 2 To oPattern.OccurrencePatternElements.Count

'**** Make all elements "Independent".
            oPattern.OccurrencePatternElements.Item(i).Independent = True
      Next

'**** Delete pattern leaving only original and independent items.
oPattern.Delete

 End Sub
```

#### Code Block 3

```vb
' <FireOthersImmediately>False</FireOthersImmediately>
Sub Main() ExplodePattern
'**** Define Assembly & Pattern Occurence.
Dim oDoc As AssemblyDocument
        oDoc = ThisApplication.ActiveDocument

Dim oPattern As OccurrencePattern
		oPatternInput = InputBox("Pattern Feature Name")
        oPattern = oDoc.ComponentDefinition.OccurrencePatterns.Item(oPatternInput)
'**** Make each element dependent starting from the 2nd element.
Dim i As Integer

'**** Count the amount of elements after the 2nd.
    For i = 2 To oPattern.OccurrencePatternElements.Count

'**** Make all elements "Independent".
            oPattern.OccurrencePatternElements.Item(i).Independent = True
      Next

'**** Delete pattern leaving only original and independent items.
oPattern.Delete

 End Sub
```

#### Code Block 4

```vb
' <FireOthersImmediately>False</FireOthersImmediately>
Sub Main() ExplodePattern
'**** Define Assembly & Pattern Occurence.
Dim oDoc As AssemblyDocument
        oDoc = ThisApplication.ActiveDocument

Dim oPattern As OccurrencePattern
		oPatternInput = InputBox("Pattern Feature Name")
        oPattern = oDoc.ComponentDefinition.OccurrencePatterns.Item(oPatternInput)
'**** Make each element dependent starting from the 2nd element.
Dim i As Integer

'**** Count the amount of elements after the 2nd.
    For i = 2 To oPattern.OccurrencePatternElements.Count

'**** Make all elements "Independent".
            oPattern.OccurrencePatternElements.Item(i).Independent = True
      Next

'**** Delete pattern leaving only original and independent items.
oPattern.Delete

 End Sub
```

#### Code Block 5

```vb
' This line doesn't work because Component.IsActive doesn't seem to accept a path to the Occurrence Pattern
' Component.IsActive(MakePath("iStairHandrail:1", "Array")) = BooleanParameter

' Set a reference to the Assembly Document
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument

' Set a reference to the Assembly Component Definition
Dim oAsmCompDef As AssemblyComponentDefinition = oAsmDoc.ComponentDefinition

' Set a reference to the Component Occurrences
Dim oOccurrences As ComponentOccurrences = oAsmCompDef.Occurrences

' Set a reference to a Component Occurrence
Dim oOcc As ComponentOccurrence = oOccurrences.ItemByName("iStairHandrail:1") ' You should probably change this name to avoid undesirable behavior

' Set a reference to the Occurrence Component Definition
Dim oOccCompDef As AssemblyComponentDefinition = oOcc.Definition

' Set a reference to the Occurrence Pattern
Dim oOccPattern As OccurrencePattern = oOccCompDef.OccurrencePatterns.Item("Array")

' Suppress or Unsuppress the Occurrence Pattern
If BooleanParameter = False Then
	oOccPattern.Suppress
Else
	oOccPattern.Unsuppress
End If
```

#### Code Block 6

```vb
' This line doesn't work because Component.IsActive doesn't seem to accept a path to the Occurrence Pattern
' Component.IsActive(MakePath("iStairHandrail:1", "Array")) = BooleanParameter

' Set a reference to the Assembly Document
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument

' Set a reference to the Assembly Component Definition
Dim oAsmCompDef As AssemblyComponentDefinition = oAsmDoc.ComponentDefinition

' Set a reference to the Component Occurrences
Dim oOccurrences As ComponentOccurrences = oAsmCompDef.Occurrences

' Set a reference to a Component Occurrence
Dim oOcc As ComponentOccurrence = oOccurrences.ItemByName("iStairHandrail:1") ' You should probably change this name to avoid undesirable behavior

' Set a reference to the Occurrence Component Definition
Dim oOccCompDef As AssemblyComponentDefinition = oOcc.Definition

' Set a reference to the Occurrence Pattern
Dim oOccPattern As OccurrencePattern = oOccCompDef.OccurrencePatterns.Item("Array")

' Suppress or Unsuppress the Occurrence Pattern
If BooleanParameter = False Then
	oOccPattern.Suppress
Else
	oOccPattern.Unsuppress
End If
```

#### Code Block 7

```vb
' This line doesn't work because Component.IsActive doesn't seem to accept a path to the Occurrence Pattern
' Component.IsActive(MakePath("iStairHandrail:1", "Array")) = BooleanParameter

' Set a reference to the Assembly Document
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument

' Set a reference to the Assembly Component Definition
Dim oAsmCompDef As AssemblyComponentDefinition = oAsmDoc.ComponentDefinition

' Set a reference to the Component Occurrences
Dim oOccurrences As ComponentOccurrences = oAsmCompDef.Occurrences

' Set a reference to a Component Occurrence
Dim oOcc As ComponentOccurrence = oOccurrences.ItemByName("iStairHandrail:1") ' You should probably change this name to avoid undesirable behavior

' Set a reference to the Occurrence Component Definition
Dim oOccCompDef As AssemblyComponentDefinition = oOcc.Definition

' Set a reference to the Occurrence Pattern
Dim oOccPattern As OccurrencePattern = oOccCompDef.OccurrencePatterns.Item("Array")

' Suppress or Unsuppress the Occurrence Pattern
If BooleanParameter = False Then
	oOccPattern.Suppress
Else
	oOccPattern.Unsuppress
End If
```

#### Code Block 8

```vb
' This line doesn't work because Component.IsActive doesn't seem to accept a path to the Occurrence Pattern
' Component.IsActive(MakePath("iStairHandrail:1", "Array")) = BooleanParameter

' Set a reference to the Assembly Document
Dim oAsmDoc As AssemblyDocument = ThisApplication.ActiveDocument

' Set a reference to the Assembly Component Definition
Dim oAsmCompDef As AssemblyComponentDefinition = oAsmDoc.ComponentDefinition

' Set a reference to the Component Occurrences
Dim oOccurrences As ComponentOccurrences = oAsmCompDef.Occurrences

' Set a reference to a Component Occurrence
Dim oOcc As ComponentOccurrence = oOccurrences.ItemByName("iStairHandrail:1") ' You should probably change this name to avoid undesirable behavior

' Set a reference to the Occurrence Component Definition
Dim oOccCompDef As AssemblyComponentDefinition = oOcc.Definition

' Set a reference to the Occurrence Pattern
Dim oOccPattern As OccurrencePattern = oOccCompDef.OccurrencePatterns.Item("Array")

' Suppress or Unsuppress the Occurrence Pattern
If BooleanParameter = False Then
	oOccPattern.Suppress
Else
	oOccPattern.Unsuppress
End If
```

#### Code Block 9

```vb
Component.IsActive("Array") = ArrayIsActive
```

#### Code Block 10

```vb
Component.IsActive("Array") = ArrayIsActive
```

#### Code Block 11

```vb
Component.IsActive("Array") = ArrayIsActive
```

#### Code Block 12

```vb
Component.IsActive("Array") = ArrayIsActive
```

#### Code Block 13

```vb
Component.IsActive("Array") = BooleanParameter
```

#### Code Block 14

```vb
Component.IsActive("Array") = BooleanParameter
```

#### Code Block 15

```vb
Component.IsActive("Array") = BooleanParameter
```

#### Code Block 16

```vb
Component.IsActive("Array") = BooleanParameter
```

#### Code Block 17

```vb
Dim oAssyDoc As AssemblyDocument
oAssyDoc = ThisApplication.ActiveDocument

Dim oAssyCompDef As AssemblyComponentDefinition
oAssyCompDef = oAssyDoc.ComponentDefinition

Dim oOccurrences As ComponentOccurrences
oOccurrences = oAssyCompDef.Occurrences

Dim oLeafOccs As ComponentOccurrencesEnumerator
oLeafOccs = oOccurrences.AllLeafOccurrences

Dim oLeafOcc As ComponentOccurrence

For Each oLeafOcc In oLeafOccs
 ' DO YOUR WORK HERE
	
' ########## - TURN OFF VISIBILITY FOR ALL PARTS CONTAINING STRING BELOW - ###########	
	Dim oPDef As PartComponentDefinition = oLeafOcc.Definition
	oDVRepName = "Hidden"
	oDVReps = oPDef.RepresentationsManager.DesignViewRepresentations
	For Each oDVRep As DesignViewRepresentation In oDVReps
		If oDVRep.Name = oDVRepName Then
			'Found it'
			oLeafOcc.SetDesignViewRepresentation(oDVRepName, , True)
		End If
		Next
' ########## - END OF MY SECTION - ###########	

Next
```

#### Code Block 18

```vb
Dim oAssyDoc As AssemblyDocument
oAssyDoc = ThisApplication.ActiveDocument

Dim oAssyCompDef As AssemblyComponentDefinition
oAssyCompDef = oAssyDoc.ComponentDefinition

Dim oOccurrences As ComponentOccurrences
oOccurrences = oAssyCompDef.Occurrences

Dim oLeafOccs As ComponentOccurrencesEnumerator
oLeafOccs = oOccurrences.AllLeafOccurrences

Dim oLeafOcc As ComponentOccurrence

For Each oLeafOcc In oLeafOccs
 ' DO YOUR WORK HERE
	
' ########## - TURN OFF VISIBILITY FOR ALL PARTS CONTAINING STRING BELOW - ###########	
	Dim oPDef As PartComponentDefinition = oLeafOcc.Definition
	oDVRepName = "Hidden"
	oDVReps = oPDef.RepresentationsManager.DesignViewRepresentations
	For Each oDVRep As DesignViewRepresentation In oDVReps
		If oDVRep.Name = oDVRepName Then
			'Found it'
			oLeafOcc.SetDesignViewRepresentation(oDVRepName, , True)
		End If
		Next
' ########## - END OF MY SECTION - ###########	

Next
```

#### Code Block 19

```vb
Dim oAssyDoc As AssemblyDocument
oAssyDoc = ThisApplication.ActiveDocument

Dim oAssyCompDef As AssemblyComponentDefinition
oAssyCompDef = oAssyDoc.ComponentDefinition

Dim oOccurrences As ComponentOccurrences
oOccurrences = oAssyCompDef.Occurrences

Dim oLeafOccs As ComponentOccurrencesEnumerator
oLeafOccs = oOccurrences.AllLeafOccurrences

Dim oLeafOcc As ComponentOccurrence

For Each oLeafOcc In oLeafOccs
 ' DO YOUR WORK HERE
	
' ########## - TURN OFF VISIBILITY FOR ALL PARTS CONTAINING STRING BELOW - ###########	
	Dim oPDef As PartComponentDefinition = oLeafOcc.Definition
	oDVRepName = "Hidden"
	oDVReps = oPDef.RepresentationsManager.DesignViewRepresentations
	For Each oDVRep As DesignViewRepresentation In oDVReps
		If oDVRep.Name = oDVRepName Then
			'Found it'
			oLeafOcc.SetDesignViewRepresentation(oDVRepName, , True)
		End If
		Next
' ########## - END OF MY SECTION - ###########	

Next
```

#### Code Block 20

```vb
Dim oAssyDoc As AssemblyDocument
oAssyDoc = ThisApplication.ActiveDocument

Dim oAssyCompDef As AssemblyComponentDefinition
oAssyCompDef = oAssyDoc.ComponentDefinition

Dim oOccurrences As ComponentOccurrences
oOccurrences = oAssyCompDef.Occurrences

Dim oLeafOccs As ComponentOccurrencesEnumerator
oLeafOccs = oOccurrences.AllLeafOccurrences

Dim oLeafOcc As ComponentOccurrence

For Each oLeafOcc In oLeafOccs
 ' DO YOUR WORK HERE
	
' ########## - TURN OFF VISIBILITY FOR ALL PARTS CONTAINING STRING BELOW - ###########	
	Dim oPDef As PartComponentDefinition = oLeafOcc.Definition
	oDVRepName = "Hidden"
	oDVReps = oPDef.RepresentationsManager.DesignViewRepresentations
	For Each oDVRep As DesignViewRepresentation In oDVReps
		If oDVRep.Name = oDVRepName Then
			'Found it'
			oLeafOcc.SetDesignViewRepresentation(oDVRepName, , True)
		End If
		Next
' ########## - END OF MY SECTION - ###########	

Next
```

#### Code Block 21

```vb
Dim topAsm As AssemblyDocument = ThisDoc.Document
Dim subAsmOcc As ComponentOccurrence = topAsm.ComponentDefinition.Occurrences(1) 'First occurrence of the top assembly
Dim subAsmDoc As AssemblyDocument = subAsmOcc.Definition.Document

Dim subAsmComponent As ICadComponent = Autodesk.iLogic.Interfaces.StandardObjectFactory.Create(subAsmDoc).Component

Dim isActive As Boolean = subAsmComponent.IsActive("Array")
subAsmComponent.IsActive("Array") = Not isActive' switch the state of Array
```

#### Code Block 22

```vb
Dim topAsm As AssemblyDocument = ThisDoc.Document
Dim subAsmOcc As ComponentOccurrence = topAsm.ComponentDefinition.Occurrences(1) 'First occurrence of the top assembly
Dim subAsmDoc As AssemblyDocument = subAsmOcc.Definition.Document

Dim subAsmComponent As ICadComponent = Autodesk.iLogic.Interfaces.StandardObjectFactory.Create(subAsmDoc).Component

Dim isActive As Boolean = subAsmComponent.IsActive("Array")
subAsmComponent.IsActive("Array") = Not isActive' switch the state of Array
```

#### Code Block 23

```vb
Dim topAsm As AssemblyDocument = ThisDoc.Document
Dim subAsmOcc As ComponentOccurrence = topAsm.ComponentDefinition.Occurrences(1) 'First occurrence of the top assembly
Dim subAsmDoc As AssemblyDocument = subAsmOcc.Definition.Document

Dim subAsmComponent As ICadComponent = Autodesk.iLogic.Interfaces.StandardObjectFactory.Create(subAsmDoc).Component

Dim isActive As Boolean = subAsmComponent.IsActive("Array")
subAsmComponent.IsActive("Array") = Not isActive' switch the state of Array
```

#### Code Block 24

```vb
Dim topAsm As AssemblyDocument = ThisDoc.Document
Dim subAsmOcc As ComponentOccurrence = topAsm.ComponentDefinition.Occurrences(1) 'First occurrence of the top assembly
Dim subAsmDoc As AssemblyDocument = subAsmOcc.Definition.Document

Dim subAsmComponent As ICadComponent = Autodesk.iLogic.Interfaces.StandardObjectFactory.Create(subAsmDoc).Component

Dim isActive As Boolean = subAsmComponent.IsActive("Array")
subAsmComponent.IsActive("Array") = Not isActive' switch the state of Array
```

---

## Api Examples

Total: 45 posts

### 1. ActiveView.Fit does not update until after the rule finishes running.

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/activeview-fit-does-not-update-until-after-the-rule-finishes/td-p/13779026#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/activeview-fit-does-not-update-until-after-the-rule-finishes/td-p/13779026#messageview_0)

**Author:** jsemansDCRCS

**Date:** ‎08-22-2025
	
		
		07:57 AM

**Description:** I am trying to generate a library of screenshots for a quick reference. The below code is what I am using to try and fit the model to the screen then grab the view and save it out. The problem is that .Fit does not seem to be updating the screen until the rule finishes running. The rule is set up to...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim invApp As Inventor.Application = ThisApplication
invApp.ActiveView.Fit
invApp.ActiveView.SaveAsBitmap(savePath, 1150, 635)
```

#### Code Block 2

```vb
Dim invApp As Inventor.Application = ThisApplication
invApp.ActiveView.Fit
invApp.ActiveView.SaveAsBitmap(savePath, 1150, 635)
```

#### Code Block 3

```vb
Dim invApp As Inventor.Application = ThisApplication
invApp.ActiveView.Fit
invApp.ActiveView.SaveAsBitmap(savePath, 1150, 635)
```

#### Code Block 4

```vb
Dim invApp As Inventor.Application = ThisApplication
invApp.ActiveView.Fit
invApp.ActiveView.SaveAsBitmap(savePath, 1150, 635)
```

---

### 2. Add leading zeros to title block

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/add-leading-zeros-to-title-block/td-p/9722111#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/add-leading-zeros-to-title-block/td-p/9722111#messageview_0)

**Author:** ludmylla.camielli

**Date:** ‎08-31-2020
	
		
		06:06 PM

**Description:** Hi guys, I need to fill my drawing's title block with the following, which will be the document number: XXXX.XXX.XXX.<Number of Sheets><Sheet Number> However, both numbers must have a leading zero (for example 0501, meaning 5 sheets and I'm currently looking at sheet 1). I have spent a couple of hou...

**Code Snippets (6):**

#### Code Block 1

```vb
'Get Total Number of Sheets
SheetCount = ThisApplication.ActiveDocument.Sheets.Count

'Append a leading zero if less than 10
If SheetCount < 10 Then
	SheetCo = "0" & SheetCount
Else 
	SheetCo = SheetCount
End If

'Loop through each sheet and grab the sheet number from the name
For Each Sheet In ThisApplication.ActiveDocument.Sheets
SheetNumber = Mid(Sheet.Name, InStr(1, Sheet.Name, ":") + 1)

'Append a leading zero if less than 10
If SheetNumber <10 Then 
SheetNo = "0" & SheetNumber
Else
	SheetNo = SheetNumber
End If

MessageBox.Show(SheetCo & SheetNo, "Sheet descriptor")

Next
```

#### Code Block 2

```vb
'Get Total Number of Sheets
SheetCount = ThisApplication.ActiveDocument.Sheets.Count

'Append a leading zero if less than 10
If SheetCount < 10 Then
	SheetCo = "0" & SheetCount
Else 
	SheetCo = SheetCount
End If

'Loop through each sheet and grab the sheet number from the name
For Each Sheet In ThisApplication.ActiveDocument.Sheets
SheetNumber = Mid(Sheet.Name, InStr(1, Sheet.Name, ":") + 1)

'Append a leading zero if less than 10
If SheetNumber <10 Then 
SheetNo = "0" & SheetNumber
Else
	SheetNo = SheetNumber
End If

MessageBox.Show(SheetCo & SheetNo, "Sheet descriptor")

Next
```

#### Code Block 3

```vb
'Get Total Number of Sheets
SheetCount = ThisApplication.ActiveDocument.Sheets.Count

'Append a leading zero if less than 10
If SheetCount < 10 Then
	SheetCo = "0" & SheetCount
Else 
	SheetCo = SheetCount
End If

'Loop through each sheet and grab the sheet number from the name
For Each Sheet In ThisApplication.ActiveDocument.Sheets
SheetNumber = Mid(Sheet.Name, InStr(1, Sheet.Name, ":") + 1)

'Append a leading zero if less than 10
If SheetNumber <10 Then 
SheetNo = "0" & SheetNumber
Else
	SheetNo = SheetNumber
End If

MessageBox.Show(SheetCo & SheetNo, "Sheet descriptor")

Next
```

#### Code Block 4

```vb
'Get Total Number of Sheets
SheetCount = ThisApplication.ActiveDocument.Sheets.Count

'Append a leading zero if less than 10
If SheetCount < 10 Then
	SheetCo = "0" & SheetCount
Else 
	SheetCo = SheetCount
End If

'Loop through each sheet and grab the sheet number from the name
For Each Sheet In ThisApplication.ActiveDocument.Sheets
SheetNumber = Mid(Sheet.Name, InStr(1, Sheet.Name, ":") + 1)

'Append a leading zero if less than 10
If SheetNumber <10 Then 
SheetNo = "0" & SheetNumber
Else
	SheetNo = SheetNumber
End If

MessageBox.Show(SheetCo & SheetNo, "Sheet descriptor")

Next
```

#### Code Block 5

```vb
Dim oSheet As Sheet
Dim SheetNumber As Double

For Each oSheet In ThisApplication.ActiveDocument.Sheets
SheetNumber  = Mid(oSheet.Name, InStr(1, oSheet.Name, ":") + 1)
MessageBox.Show(Microsoft.VisualBasic.Strings.Format(SheetNumber,"0#"), oSheet.Name)
Next
```

#### Code Block 6

```vb
Dim oSheet As Sheet
Dim SheetNumber As Double

For Each oSheet In ThisApplication.ActiveDocument.Sheets
SheetNumber  = Mid(oSheet.Name, InStr(1, oSheet.Name, ":") + 1)
MessageBox.Show(Microsoft.VisualBasic.Strings.Format(SheetNumber,"0#"), oSheet.Name)
Next
```

#### Code Block 7

```vb
Dim oSheets As Sheets = ThisDrawing.Document.Sheets
For Each oSheet As Sheet In oSheets
	oSheetNumber = CInt(oSheet.Name.Split(":")(1)).ToString("00")
	Dim oTB As TitleBlock = oSheet.TitleBlock
	For Each oTextBox As Inventor.TextBox In oTB.Definition.Sketch.TextBoxes
		If oTextBox.Text = "<CustomSheetNumber>"
			oTB.SetPromptResultText(oTextBox, (oSheets.Count.ToString("00") & oSheetNumber))
			Exit For
		End If
	Next
Next
```

#### Code Block 8

```vb
Dim oSheets As Sheets = ThisDrawing.Document.Sheets
For Each oSheet As Sheet In oSheets
	oSheetNumber = CInt(oSheet.Name.Split(":")(1)).ToString("00")
	Dim oTB As TitleBlock = oSheet.TitleBlock
	For Each oTextBox As Inventor.TextBox In oTB.Definition.Sketch.TextBoxes
		If oTextBox.Text = "<CustomSheetNumber>"
			oTB.SetPromptResultText(oTextBox, (oSheets.Count.ToString("00") & oSheetNumber))
			Exit For
		End If
	Next
Next
```

#### Code Block 9

```vb
Dim oSheets As Sheets = ThisDrawing.Document.Sheets
For Each oSheet As Sheet In oSheets
	oSheetNumber = CInt(oSheet.Name.Split(":")(1)).ToString("00")
	MsgBox(oSheets.Count.ToString("00") & oSheetNumber)
Next
```

#### Code Block 10

```vb
Dim oSheets As Sheets = ThisDrawing.Document.Sheets
For Each oSheet As Sheet In oSheets
	oSheetNumber = CInt(oSheet.Name.Split(":")(1)).ToString("00")
	MsgBox(oSheets.Count.ToString("00") & oSheetNumber)
Next
```

#### Code Block 11

```vb
Dim oSheets As Sheets = ThisDrawing.Document.Sheets
For Each oSheet As Sheet In oSheets
	oSheetNumber = CInt(oSheet.Name.Split(":")(1)+SheetStartNum-1).ToString("0000")
	
	Dim oTB As TitleBlock = oSheet.TitleBlock
	For Each oTextBox As Inventor.TextBox In oTB.Definition.Sketch.TextBoxes
		If oTextBox.Text = "<CustomSheetNumber>"
			oTB.SetPromptResultText(oTextBox, (oSheetNumber))
			Exit For
		End If
	Next
Next
```

#### Code Block 12

```vb
Dim oSheets As Sheets = ThisDrawing.Document.Sheets
For Each oSheet As Sheet In oSheets
	oSheetNumber = CInt(oSheet.Name.Split(":")(1)+SheetStartNum-1).ToString("0000")
	
	Dim oTB As TitleBlock = oSheet.TitleBlock
	For Each oTextBox As Inventor.TextBox In oTB.Definition.Sketch.TextBoxes
		If oTextBox.Text = "<CustomSheetNumber>"
			oTB.SetPromptResultText(oTextBox, (oSheetNumber))
			Exit For
		End If
	Next
Next
```

---

### 3. Can't Debug Inventor 2025 in VS2019

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/can-t-debug-inventor-2025-in-vs2019/td-p/13003292#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/can-t-debug-inventor-2025-in-vs2019/td-p/13003292#messageview_0)

**Author:** tdant

**Date:** ‎09-05-2024
	
		
		10:30 AM

**Description:** Hey all,I'm working on debugging some addins that have been functioning fine since Inventor 2021, and have run into a new unfamiliar error since updating to 2025:Apparently this is some kind of memory write access denial, but it might as well be Greek to me. I've enabled native code debugging and bo...

**Code Snippets (2):**

#### Code Block 1

```vb
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
   <BaseAddress>285212672</BaseAddress>
   <ConfigurationOverrideFile>
   </ConfigurationOverrideFile>
   <DocumentationFile>
   </DocumentationFile>
   <FileAlignment>4096</FileAlignment>
   <NoStdLib>false</NoStdLib>
   <NoWarn>
   </NoWarn>
   <RegisterForComInterop>false</RegisterForComInterop>
   <RemoveIntegerChecks>false</RemoveIntegerChecks>
   <CodeAnalysisRuleSet>AllRules.ruleset</CodeAnalysisRuleSet>
  <OutputPath>C:\Users\MeMySelf\AppData\Roaming\Autodesk\ApplicationPlugins\HKInventorAddin\</OutputPath>
  <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
 </PropertyGroup>
```

#### Code Block 2

```vb
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
   <BaseAddress>285212672</BaseAddress>
   <ConfigurationOverrideFile>
   </ConfigurationOverrideFile>
   <DocumentationFile>
   </DocumentationFile>
   <FileAlignment>4096</FileAlignment>
   <NoStdLib>false</NoStdLib>
   <NoWarn>
   </NoWarn>
   <RegisterForComInterop>false</RegisterForComInterop>
   <RemoveIntegerChecks>false</RemoveIntegerChecks>
   <CodeAnalysisRuleSet>AllRules.ruleset</CodeAnalysisRuleSet>
  <OutputPath>C:\Users\MeMySelf\AppData\Roaming\Autodesk\ApplicationPlugins\HKInventorAddin\</OutputPath>
  <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
 </PropertyGroup>
```

#### Code Block 3

```vb
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
   <BaseAddress>285212672</BaseAddress>
   <ConfigurationOverrideFile>
   </ConfigurationOverrideFile>
   <DocumentationFile>
   </DocumentationFile>
   <FileAlignment>4096</FileAlignment>
   <NoStdLib>false</NoStdLib>
   <NoWarn>
   </NoWarn>
   <RegisterForComInterop>false</RegisterForComInterop>
   <RemoveIntegerChecks>false</RemoveIntegerChecks>
   <CodeAnalysisRuleSet>AllRules.ruleset</CodeAnalysisRuleSet>
  <OutputPath>C:\Users\MeMySelf\AppData\Roaming\Autodesk\ApplicationPlugins\HKInventorAddin\</OutputPath>
  <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
 </PropertyGroup>
```

#### Code Block 4

```vb
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
   <BaseAddress>285212672</BaseAddress>
   <ConfigurationOverrideFile>
   </ConfigurationOverrideFile>
   <DocumentationFile>
   </DocumentationFile>
   <FileAlignment>4096</FileAlignment>
   <NoStdLib>false</NoStdLib>
   <NoWarn>
   </NoWarn>
   <RegisterForComInterop>false</RegisterForComInterop>
   <RemoveIntegerChecks>false</RemoveIntegerChecks>
   <CodeAnalysisRuleSet>AllRules.ruleset</CodeAnalysisRuleSet>
  <OutputPath>C:\Users\MeMySelf\AppData\Roaming\Autodesk\ApplicationPlugins\HKInventorAddin\</OutputPath>
  <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
 </PropertyGroup>
```

---

### 4. Check Vault Status

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/check-vault-status/td-p/13834312](https://forums.autodesk.com/t5/inventor-programming-forum/check-vault-status/td-p/13834312)

**Author:** karthur1

**Date:** ‎10-02-2025
	
		
		05:27 AM

**Description:** I have an iLogic rule to quickly print to PDF (see attached). I would like to add a check to make sure the idw is the "latest" vaulted file.  Is it possible with iLogic to check the vault file status? Using Inventor 2024. Thanks,Kirk

**Code Snippets (6):**

#### Code Block 1

```vb
If Not oFile.Name = System.IO.Path.GetFileNameWithoutExtension(fullFileName) Then Continue For
```

#### Code Block 2

```vb
If Not oFile.Name = System.IO.Path.GetFileNameWithoutExtension(fullFileName) Then Continue For
```

#### Code Block 3

```vb
If Not oFile.Name = System.IO.Path.GetFileNameWithoutExtension(fullFileName) Then Continue For
```

#### Code Block 4

```vb
If Not oFile.Name = System.IO.Path.GetFileNameWithoutExtension(fullFileName) Then Continue For
```

#### Code Block 5

```vb
If Not oFile.Name.Equals(System.IO.Path.GetFileName(fullFileName), StringComparison.CurrentCultureIgnoreCase) Then Continue For
```

#### Code Block 6

```vb
If Not oFile.Name.Equals(System.IO.Path.GetFileName(fullFileName), StringComparison.CurrentCultureIgnoreCase) Then Continue For
```

#### Code Block 7

```vb
If Not oFile.Name.Equals(System.IO.Path.GetFileName(fullFileName), StringComparison.CurrentCultureIgnoreCase) Then Continue For
```

#### Code Block 8

```vb
If Not oFile.Name.Equals(System.IO.Path.GetFileName(fullFileName), StringComparison.CurrentCultureIgnoreCase) Then Continue For
```

#### Code Block 9

```vb
Imports Autodesk.DataManagement.Client.Framework.Vault
Imports Autodesk.Connectivity.WebServices
Imports VDF = Autodesk.DataManagement.Client.Framework
Imports AWS = Autodesk.Connectivity.WebServices
Imports AWST = Autodesk.Connectivity.WebServicesTools
Imports VB = Connectivity.Application.VaultBase
Imports Autodesk.DataManagement.Client.Framework.Vault.Currency'.Properties
AddReference "Autodesk.DataManagement.Client.Framework.Vault.dll"
AddReference "Autodesk.DataManagement.Client.Framework.dll"
AddReference "Connectivity.Application.VaultBase.dll"
AddReference "Autodesk.Connectivity.WebServices.dll"
Sub Main
	Dim sLocalFile As String = ThisDoc.PathAndFileName(True)
	Logger.Info("sLocalFile = " & sLocalFile)
	Dim bIsLatestVersion As Boolean = LocalFileIsLatestVersion(sLocalFile)
	MsgBox("Specified File Is Latest Version = " & bIsLatestVersion.ToString(), , "")
End Sub

Function LocalFileIsLatestVersion(fullFileName As String) As Boolean
	'validate the input
	If String.IsNullOrWhiteSpace(fullFileName) Then
		Logger.Debug("Empty value passed into the 'LocalFileIsLatestVersion' method!")
		Return False
	End If
	If Not System.IO.File.Exists(fullFileName) Then
		Logger.Debug("File specified as input into the 'LocalFileIsLatestVersion' method does not exist!")
		Return False
	End If

	'get Vault connection
	Dim oConn As VDF.Vault.Currency.Connections.Connection
	oConn = VB.ConnectionManager.Instance.Connection

	'if no connection then exit routine
	If oConn Is Nothing Then
		Logger.Debug("Could not get Vault Connection!")
		MessageBox.Show("Not Logged In to Vault! - Login first and repeat executing this rule.")
		Exit Function
	End If

	'convert the 'local' path to a 'Vault' path
	Dim sVaultPath As String = iLogicVault.ConvertLocalPathToVaultPath(fullFileName)
	Logger.Info("sVaultPath = " & sVaultPath)

	'get the 'Folder' object
	Dim oFolder As AWS.Folder = oConn.WebServiceManager.DocumentService.GetFolderByPath(sVaultPath)
	If oFolder Is Nothing Then
		Logger.Warn("Did NOT get the Vault Folder that this file was in.")
	Else
		Logger.Info("Got the Vault Folder that this file was in.")
	End If
	
	'get a dictionary of all property definitions
	'if we provide an 'EmptyCategory' instead of 'Nothing', we get no entries
	Dim oPropDefsDict As VDF.Vault.Currency.Properties.PropertyDefinitionDictionary
	oPropDefsDict = oConn.PropertyManager.GetPropertyDefinitions( _
	VDF.Vault.Currency.Entities.EntityClassIds.Files, _
	Nothing, _
	VDF.Vault.Currency.Properties.PropertyDefinitionFilter.IncludeAll)
	
	If (oPropDefsDict Is Nothing) OrElse (oPropDefsDict.Count = 0) Then
		Logger.Warn("PropertyDefinitionDictionary was either Nothing or Empty!")
	Else
		Logger.Info("Got the PropertyDefinitionDictionary, and it had " & oPropDefsDict.Count.ToString() & " entries.")
	End If

	'get the VaultStatus PropertyDefinition
	Dim oStatusPropDef As VDF.Vault.Currency.Properties.PropertyDefinition
	oStatusPropDef = oPropDefsDict(VDF.Vault.Currency.Properties.PropertyDefinitionIds.Client.VaultStatus)

	If (oStatusPropDef Is Nothing) Then
		Logger.Warn("PropertyDefinition was Nothing!")
	Else
		Logger.Info("Got the PropertyDefinition OK.")
	End If

	'get all child File objects in that folder, except the 'hidden' ones
	Dim oChildFiles As AWS.File() = oConn.WebServiceManager.DocumentService.GetLatestFilesByFolderId(oFolder.Id, False)
	'if no child files found, then exit routine
	If (oChildFiles Is Nothing) OrElse (oChildFiles.Length = 0) Then
		Logger.Warn("No child files in specified folder!")
		Return False
	Else
		Logger.Info("Found " & oChildFiles.Length.ToString() & " child files in specified folder!")
	End If

	'start iterating through each file in the folder
	For Each oFile As AWS.File In oChildFiles
		'only process one specific file, by its file name
		If Not oFile.Name = System.IO.Path.GetFileNameWithoutExtension(fullFileName) Then Continue For
		Logger.Info("Found the matching Vault file.")
		
		'get the FileIteration object of this File object
		Dim oFileIt As VDF.Vault.Currency.Entities.FileIteration
		oFileIt = New VDF.Vault.Currency.Entities.FileIteration(oConn, oFile)
		If oFileIt IsNot Nothing Then
			Logger.Info("Got the FileIteration for this file.")
		Else
			Logger.Warn("Did NOT get the FileIteration for this file.")
			Continue For
		End If
		
		'Dim oPropExtProv As VDF.Vault.Interfaces.IPropertyExtensionProvider
		'oPropExtProv = oConn.PropertyManager.
		
		'Dim oPropValueSettings As New VDF.Vault.Currency.Properties.PropertyValueSettings()
		'oPropValueSettings.AddPropertyExtensionProvider(oPropExtProv)
				
		'read value of VaultStatus Property of specified File
		Dim oStatus As VDF.Vault.Currency.Properties.EntityStatusImageInfo
		oStatus = oConn.PropertyManager.GetPropertyValue(oFileIt, oStatusPropDef, Nothing)
		
		'check value, and respond accordingly
		If oStatus.Status.VersionState = VDF.Vault.Currency.Properties.EntityStatus.VersionStateEnum.MatchesLatestVaultVersion Then
			Logger.Info("Following File Version Matches Latest Vault Version:" _
			& vbCrLf & oFile.Name)
			Return True
		Else
			Logger.Info("Following File Version Does Not Match Latest Vault Version:" _
			& vbCrLf & oFile.Name)
		End If
	Next
	Return False
End Function
```

#### Code Block 10

```vb
Imports Autodesk.DataManagement.Client.Framework.Vault
Imports Autodesk.Connectivity.WebServices
Imports VDF = Autodesk.DataManagement.Client.Framework
Imports AWS = Autodesk.Connectivity.WebServices
Imports AWST = Autodesk.Connectivity.WebServicesTools
Imports VB = Connectivity.Application.VaultBase
Imports Autodesk.DataManagement.Client.Framework.Vault.Currency'.Properties
AddReference "Autodesk.DataManagement.Client.Framework.Vault.dll"
AddReference "Autodesk.DataManagement.Client.Framework.dll"
AddReference "Connectivity.Application.VaultBase.dll"
AddReference "Autodesk.Connectivity.WebServices.dll"
Sub Main
	Dim sLocalFile As String = ThisDoc.PathAndFileName(True)
	Logger.Info("sLocalFile = " & sLocalFile)
	Dim bIsLatestVersion As Boolean = LocalFileIsLatestVersion(sLocalFile)
	MsgBox("Specified File Is Latest Version = " & bIsLatestVersion.ToString(), , "")
End Sub

Function LocalFileIsLatestVersion(fullFileName As String) As Boolean
	'validate the input
	If String.IsNullOrWhiteSpace(fullFileName) Then
		Logger.Debug("Empty value passed into the 'LocalFileIsLatestVersion' method!")
		Return False
	End If
	If Not System.IO.File.Exists(fullFileName) Then
		Logger.Debug("File specified as input into the 'LocalFileIsLatestVersion' method does not exist!")
		Return False
	End If

	'get Vault connection
	Dim oConn As VDF.Vault.Currency.Connections.Connection
	oConn = VB.ConnectionManager.Instance.Connection

	'if no connection then exit routine
	If oConn Is Nothing Then
		Logger.Debug("Could not get Vault Connection!")
		MessageBox.Show("Not Logged In to Vault! - Login first and repeat executing this rule.")
		Exit Function
	End If

	'convert the 'local' path to a 'Vault' path
	Dim sVaultPath As String = iLogicVault.ConvertLocalPathToVaultPath(fullFileName)
	Logger.Info("sVaultPath = " & sVaultPath)

	'get the 'Folder' object
	Dim oFolder As AWS.Folder = oConn.WebServiceManager.DocumentService.GetFolderByPath(sVaultPath)
	If oFolder Is Nothing Then
		Logger.Warn("Did NOT get the Vault Folder that this file was in.")
	Else
		Logger.Info("Got the Vault Folder that this file was in.")
	End If
	
	'get a dictionary of all property definitions
	'if we provide an 'EmptyCategory' instead of 'Nothing', we get no entries
	Dim oPropDefsDict As VDF.Vault.Currency.Properties.PropertyDefinitionDictionary
	oPropDefsDict = oConn.PropertyManager.GetPropertyDefinitions( _
	VDF.Vault.Currency.Entities.EntityClassIds.Files, _
	Nothing, _
	VDF.Vault.Currency.Properties.PropertyDefinitionFilter.IncludeAll)
	
	If (oPropDefsDict Is Nothing) OrElse (oPropDefsDict.Count = 0) Then
		Logger.Warn("PropertyDefinitionDictionary was either Nothing or Empty!")
	Else
		Logger.Info("Got the PropertyDefinitionDictionary, and it had " & oPropDefsDict.Count.ToString() & " entries.")
	End If

	'get the VaultStatus PropertyDefinition
	Dim oStatusPropDef As VDF.Vault.Currency.Properties.PropertyDefinition
	oStatusPropDef = oPropDefsDict(VDF.Vault.Currency.Properties.PropertyDefinitionIds.Client.VaultStatus)

	If (oStatusPropDef Is Nothing) Then
		Logger.Warn("PropertyDefinition was Nothing!")
	Else
		Logger.Info("Got the PropertyDefinition OK.")
	End If

	'get all child File objects in that folder, except the 'hidden' ones
	Dim oChildFiles As AWS.File() = oConn.WebServiceManager.DocumentService.GetLatestFilesByFolderId(oFolder.Id, False)
	'if no child files found, then exit routine
	If (oChildFiles Is Nothing) OrElse (oChildFiles.Length = 0) Then
		Logger.Warn("No child files in specified folder!")
		Return False
	Else
		Logger.Info("Found " & oChildFiles.Length.ToString() & " child files in specified folder!")
	End If

	'start iterating through each file in the folder
	For Each oFile As AWS.File In oChildFiles
		'only process one specific file, by its file name
		If Not oFile.Name = System.IO.Path.GetFileNameWithoutExtension(fullFileName) Then Continue For
		Logger.Info("Found the matching Vault file.")
		
		'get the FileIteration object of this File object
		Dim oFileIt As VDF.Vault.Currency.Entities.FileIteration
		oFileIt = New VDF.Vault.Currency.Entities.FileIteration(oConn, oFile)
		If oFileIt IsNot Nothing Then
			Logger.Info("Got the FileIteration for this file.")
		Else
			Logger.Warn("Did NOT get the FileIteration for this file.")
			Continue For
		End If
		
		'Dim oPropExtProv As VDF.Vault.Interfaces.IPropertyExtensionProvider
		'oPropExtProv = oConn.PropertyManager.
		
		'Dim oPropValueSettings As New VDF.Vault.Currency.Properties.PropertyValueSettings()
		'oPropValueSettings.AddPropertyExtensionProvider(oPropExtProv)
				
		'read value of VaultStatus Property of specified File
		Dim oStatus As VDF.Vault.Currency.Properties.EntityStatusImageInfo
		oStatus = oConn.PropertyManager.GetPropertyValue(oFileIt, oStatusPropDef, Nothing)
		
		'check value, and respond accordingly
		If oStatus.Status.VersionState = VDF.Vault.Currency.Properties.EntityStatus.VersionStateEnum.MatchesLatestVaultVersion Then
			Logger.Info("Following File Version Matches Latest Vault Version:" _
			& vbCrLf & oFile.Name)
			Return True
		Else
			Logger.Info("Following File Version Does Not Match Latest Vault Version:" _
			& vbCrLf & oFile.Name)
		End If
	Next
	Return False
End Function
```

#### Code Block 11

```vb
Imports Autodesk.DataManagement.Client.Framework.Vault
Imports Autodesk.Connectivity.WebServices
Imports VDF = Autodesk.DataManagement.Client.Framework
Imports AWS = Autodesk.Connectivity.WebServices
Imports AWST = Autodesk.Connectivity.WebServicesTools
Imports VB = Connectivity.Application.VaultBase
Imports Autodesk.DataManagement.Client.Framework.Vault.Currency'.Properties
AddReference "Autodesk.DataManagement.Client.Framework.Vault.dll"
AddReference "Autodesk.DataManagement.Client.Framework.dll"
AddReference "Connectivity.Application.VaultBase.dll"
AddReference "Autodesk.Connectivity.WebServices.dll"
Sub Main
	Dim sLocalFile As String = ThisDoc.PathAndFileName(True)
	Logger.Info("sLocalFile = " & sLocalFile)
	Dim bIsLatestVersion As Boolean = LocalFileIsLatestVersion(sLocalFile)
	MsgBox("Specified File Is Latest Version = " & bIsLatestVersion.ToString(), , "")
End Sub

Function LocalFileIsLatestVersion(fullFileName As String) As Boolean
	'validate the input
	If String.IsNullOrWhiteSpace(fullFileName) Then
		Logger.Debug("Empty value passed into the 'LocalFileIsLatestVersion' method!")
		Return False
	End If
	If Not System.IO.File.Exists(fullFileName) Then
		Logger.Debug("File specified as input into the 'LocalFileIsLatestVersion' method does not exist!")
		Return False
	End If

	'get Vault connection
	Dim oConn As VDF.Vault.Currency.Connections.Connection
	oConn = VB.ConnectionManager.Instance.Connection

	'if no connection then exit routine
	If oConn Is Nothing Then
		Logger.Debug("Could not get Vault Connection!")
		MessageBox.Show("Not Logged In to Vault! - Login first and repeat executing this rule.")
		Exit Function
	End If

	'convert the 'local' path to a 'Vault' path
	Dim sVaultPath As String = iLogicVault.ConvertLocalPathToVaultPath(fullFileName)
	Logger.Info("sVaultPath = " & sVaultPath)

	'get the 'Folder' object
	Dim oFolder As AWS.Folder = oConn.WebServiceManager.DocumentService.GetFolderByPath(sVaultPath)
	If oFolder Is Nothing Then
		Logger.Warn("Did NOT get the Vault Folder that this file was in.")
	Else
		Logger.Info("Got the Vault Folder that this file was in.")
	End If
	
	'get a dictionary of all property definitions
	'if we provide an 'EmptyCategory' instead of 'Nothing', we get no entries
	Dim oPropDefsDict As VDF.Vault.Currency.Properties.PropertyDefinitionDictionary
	oPropDefsDict = oConn.PropertyManager.GetPropertyDefinitions( _
	VDF.Vault.Currency.Entities.EntityClassIds.Files, _
	Nothing, _
	VDF.Vault.Currency.Properties.PropertyDefinitionFilter.IncludeAll)
	
	If (oPropDefsDict Is Nothing) OrElse (oPropDefsDict.Count = 0) Then
		Logger.Warn("PropertyDefinitionDictionary was either Nothing or Empty!")
	Else
		Logger.Info("Got the PropertyDefinitionDictionary, and it had " & oPropDefsDict.Count.ToString() & " entries.")
	End If

	'get the VaultStatus PropertyDefinition
	Dim oStatusPropDef As VDF.Vault.Currency.Properties.PropertyDefinition
	oStatusPropDef = oPropDefsDict(VDF.Vault.Currency.Properties.PropertyDefinitionIds.Client.VaultStatus)

	If (oStatusPropDef Is Nothing) Then
		Logger.Warn("PropertyDefinition was Nothing!")
	Else
		Logger.Info("Got the PropertyDefinition OK.")
	End If

	'get all child File objects in that folder, except the 'hidden' ones
	Dim oChildFiles As AWS.File() = oConn.WebServiceManager.DocumentService.GetLatestFilesByFolderId(oFolder.Id, False)
	'if no child files found, then exit routine
	If (oChildFiles Is Nothing) OrElse (oChildFiles.Length = 0) Then
		Logger.Warn("No child files in specified folder!")
		Return False
	Else
		Logger.Info("Found " & oChildFiles.Length.ToString() & " child files in specified folder!")
	End If

	'start iterating through each file in the folder
	For Each oFile As AWS.File In oChildFiles
		'only process one specific file, by its file name
		If Not oFile.Name = System.IO.Path.GetFileNameWithoutExtension(fullFileName) Then Continue For
		Logger.Info("Found the matching Vault file.")
		
		'get the FileIteration object of this File object
		Dim oFileIt As VDF.Vault.Currency.Entities.FileIteration
		oFileIt = New VDF.Vault.Currency.Entities.FileIteration(oConn, oFile)
		If oFileIt IsNot Nothing Then
			Logger.Info("Got the FileIteration for this file.")
		Else
			Logger.Warn("Did NOT get the FileIteration for this file.")
			Continue For
		End If
		
		'Dim oPropExtProv As VDF.Vault.Interfaces.IPropertyExtensionProvider
		'oPropExtProv = oConn.PropertyManager.
		
		'Dim oPropValueSettings As New VDF.Vault.Currency.Properties.PropertyValueSettings()
		'oPropValueSettings.AddPropertyExtensionProvider(oPropExtProv)
				
		'read value of VaultStatus Property of specified File
		Dim oStatus As VDF.Vault.Currency.Properties.EntityStatusImageInfo
		oStatus = oConn.PropertyManager.GetPropertyValue(oFileIt, oStatusPropDef, Nothing)
		
		'check value, and respond accordingly
		If oStatus.Status.VersionState = VDF.Vault.Currency.Properties.EntityStatus.VersionStateEnum.MatchesLatestVaultVersion Then
			Logger.Info("Following File Version Matches Latest Vault Version:" _
			& vbCrLf & oFile.Name)
			Return True
		Else
			Logger.Info("Following File Version Does Not Match Latest Vault Version:" _
			& vbCrLf & oFile.Name)
		End If
	Next
	Return False
End Function
```

#### Code Block 12

```vb
Imports Autodesk.DataManagement.Client.Framework.Vault
Imports Autodesk.Connectivity.WebServices
Imports VDF = Autodesk.DataManagement.Client.Framework
Imports AWS = Autodesk.Connectivity.WebServices
Imports AWST = Autodesk.Connectivity.WebServicesTools
Imports VB = Connectivity.Application.VaultBase
Imports Autodesk.DataManagement.Client.Framework.Vault.Currency'.Properties
AddReference "Autodesk.DataManagement.Client.Framework.Vault.dll"
AddReference "Autodesk.DataManagement.Client.Framework.dll"
AddReference "Connectivity.Application.VaultBase.dll"
AddReference "Autodesk.Connectivity.WebServices.dll"
Sub Main
	Dim sLocalFile As String = ThisDoc.PathAndFileName(True)
	Logger.Info("sLocalFile = " & sLocalFile)
	Dim bIsLatestVersion As Boolean = LocalFileIsLatestVersion(sLocalFile)
	MsgBox("Specified File Is Latest Version = " & bIsLatestVersion.ToString(), , "")
End Sub

Function LocalFileIsLatestVersion(fullFileName As String) As Boolean
	'validate the input
	If String.IsNullOrWhiteSpace(fullFileName) Then
		Logger.Debug("Empty value passed into the 'LocalFileIsLatestVersion' method!")
		Return False
	End If
	If Not System.IO.File.Exists(fullFileName) Then
		Logger.Debug("File specified as input into the 'LocalFileIsLatestVersion' method does not exist!")
		Return False
	End If

	'get Vault connection
	Dim oConn As VDF.Vault.Currency.Connections.Connection
	oConn = VB.ConnectionManager.Instance.Connection

	'if no connection then exit routine
	If oConn Is Nothing Then
		Logger.Debug("Could not get Vault Connection!")
		MessageBox.Show("Not Logged In to Vault! - Login first and repeat executing this rule.")
		Exit Function
	End If

	'convert the 'local' path to a 'Vault' path
	Dim sVaultPath As String = iLogicVault.ConvertLocalPathToVaultPath(fullFileName)
	Logger.Info("sVaultPath = " & sVaultPath)

	'get the 'Folder' object
	Dim oFolder As AWS.Folder = oConn.WebServiceManager.DocumentService.GetFolderByPath(sVaultPath)
	If oFolder Is Nothing Then
		Logger.Warn("Did NOT get the Vault Folder that this file was in.")
	Else
		Logger.Info("Got the Vault Folder that this file was in.")
	End If
	
	'get a dictionary of all property definitions
	'if we provide an 'EmptyCategory' instead of 'Nothing', we get no entries
	Dim oPropDefsDict As VDF.Vault.Currency.Properties.PropertyDefinitionDictionary
	oPropDefsDict = oConn.PropertyManager.GetPropertyDefinitions( _
	VDF.Vault.Currency.Entities.EntityClassIds.Files, _
	Nothing, _
	VDF.Vault.Currency.Properties.PropertyDefinitionFilter.IncludeAll)
	
	If (oPropDefsDict Is Nothing) OrElse (oPropDefsDict.Count = 0) Then
		Logger.Warn("PropertyDefinitionDictionary was either Nothing or Empty!")
	Else
		Logger.Info("Got the PropertyDefinitionDictionary, and it had " & oPropDefsDict.Count.ToString() & " entries.")
	End If

	'get the VaultStatus PropertyDefinition
	Dim oStatusPropDef As VDF.Vault.Currency.Properties.PropertyDefinition
	oStatusPropDef = oPropDefsDict(VDF.Vault.Currency.Properties.PropertyDefinitionIds.Client.VaultStatus)

	If (oStatusPropDef Is Nothing) Then
		Logger.Warn("PropertyDefinition was Nothing!")
	Else
		Logger.Info("Got the PropertyDefinition OK.")
	End If

	'get all child File objects in that folder, except the 'hidden' ones
	Dim oChildFiles As AWS.File() = oConn.WebServiceManager.DocumentService.GetLatestFilesByFolderId(oFolder.Id, False)
	'if no child files found, then exit routine
	If (oChildFiles Is Nothing) OrElse (oChildFiles.Length = 0) Then
		Logger.Warn("No child files in specified folder!")
		Return False
	Else
		Logger.Info("Found " & oChildFiles.Length.ToString() & " child files in specified folder!")
	End If

	'start iterating through each file in the folder
	For Each oFile As AWS.File In oChildFiles
		'only process one specific file, by its file name
		If Not oFile.Name = System.IO.Path.GetFileNameWithoutExtension(fullFileName) Then Continue For
		Logger.Info("Found the matching Vault file.")
		
		'get the FileIteration object of this File object
		Dim oFileIt As VDF.Vault.Currency.Entities.FileIteration
		oFileIt = New VDF.Vault.Currency.Entities.FileIteration(oConn, oFile)
		If oFileIt IsNot Nothing Then
			Logger.Info("Got the FileIteration for this file.")
		Else
			Logger.Warn("Did NOT get the FileIteration for this file.")
			Continue For
		End If
		
		'Dim oPropExtProv As VDF.Vault.Interfaces.IPropertyExtensionProvider
		'oPropExtProv = oConn.PropertyManager.
		
		'Dim oPropValueSettings As New VDF.Vault.Currency.Properties.PropertyValueSettings()
		'oPropValueSettings.AddPropertyExtensionProvider(oPropExtProv)
				
		'read value of VaultStatus Property of specified File
		Dim oStatus As VDF.Vault.Currency.Properties.EntityStatusImageInfo
		oStatus = oConn.PropertyManager.GetPropertyValue(oFileIt, oStatusPropDef, Nothing)
		
		'check value, and respond accordingly
		If oStatus.Status.VersionState = VDF.Vault.Currency.Properties.EntityStatus.VersionStateEnum.MatchesLatestVaultVersion Then
			Logger.Info("Following File Version Matches Latest Vault Version:" _
			& vbCrLf & oFile.Name)
			Return True
		Else
			Logger.Info("Following File Version Does Not Match Latest Vault Version:" _
			& vbCrLf & oFile.Name)
		End If
	Next
	Return False
End Function
```

---

### 5. Check if drawing parts list is splitted

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/check-if-drawing-parts-list-is-splitted/td-p/12568593#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/check-if-drawing-parts-list-is-splitted/td-p/12568593#messageview_0)

**Author:** goran_nilssonK2TWB

**Date:** ‎02-19-2024
	
		
		12:06 AM

**Description:** Hello! I want to check if drawing parts list is splitted. If it's splitted I want to get a message.My code is using On error resume next, so it's not possible to use a Try.I can't find any information if it's possible or not. /Goran 					 				 			 			 				 			 			 				 	 			 				 					 						Solved!...

**Code Snippets (3):**

#### Code Block 1

```vb
Public Sub Main()
	Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, DrawingDocument)
	If oDDoc Is Nothing Then Exit Sub  
	Dim oBrowserPane As BrowserPane = oDDoc.BrowserPanes.ActivePane
	Dim oTopBrowserNode As BrowserNode = oBrowserPane.TopNode   
	Dim oBrowserNode As BrowserNode    
	For Each oBrowserNode In oTopBrowserNode.BrowserNodes
		Dim oBrowserNode2 As BrowserNode
		For Each oBrowserNode2 In oBrowserNode.BrowserNodes
			Dim oNativeObject As Object = oBrowserNode2.NativeObject
			If TypeName(oNativeObject) = "PartsList" Then
				If oBrowserNode2.BrowserNodes.Count > 0 Then
					MsgBox("Parts List is split")
				Else
					MsgBox("Parts List is NOT split")
				End If
				Exit For
			End If
		Next
	Next       
End Sub
```

#### Code Block 2

```vb
Public Sub Main()
	Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, DrawingDocument)
	If oDDoc Is Nothing Then Exit Sub  
	Dim oBrowserPane As BrowserPane = oDDoc.BrowserPanes.ActivePane
	Dim oTopBrowserNode As BrowserNode = oBrowserPane.TopNode   
	Dim oBrowserNode As BrowserNode    
	For Each oBrowserNode In oTopBrowserNode.BrowserNodes
		Dim oBrowserNode2 As BrowserNode
		For Each oBrowserNode2 In oBrowserNode.BrowserNodes
			Dim oNativeObject As Object = oBrowserNode2.NativeObject
			If TypeName(oNativeObject) = "PartsList" Then
				If oBrowserNode2.BrowserNodes.Count > 0 Then
					MsgBox("Parts List is split")
				Else
					MsgBox("Parts List is NOT split")
				End If
				Exit For
			End If
		Next
	Next       
End Sub
```

#### Code Block 3

```vb
Public Sub Main()
	Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, DrawingDocument)
	If oDDoc Is Nothing Then Exit Sub  
	Dim oBrowserPane As BrowserPane = oDDoc.BrowserPanes.ActivePane
	Dim oTopBrowserNode As BrowserNode = oBrowserPane.TopNode   
	Dim oBrowserNode As BrowserNode    
	For Each oBrowserNode In oTopBrowserNode.BrowserNodes
		Dim oBrowserNode2 As BrowserNode
		For Each oBrowserNode2 In oBrowserNode.BrowserNodes
			Dim oNativeObject As Object = oBrowserNode2.NativeObject
			If TypeName(oNativeObject) = "PartsList" Then
				If oBrowserNode2.BrowserNodes.Count > 0 Then
					MsgBox("Parts List is split")
				Else
					MsgBox("Parts List is NOT split")
				End If
				Exit For
			End If
		Next
	Next       
End Sub
```

#### Code Block 4

```vb
Public Sub Main()
	Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, DrawingDocument)
	If oDDoc Is Nothing Then Exit Sub  
	Dim oBrowserPane As BrowserPane = oDDoc.BrowserPanes.ActivePane
	Dim oTopBrowserNode As BrowserNode = oBrowserPane.TopNode   
	Dim oBrowserNode As BrowserNode    
	For Each oBrowserNode In oTopBrowserNode.BrowserNodes
		Dim oBrowserNode2 As BrowserNode
		For Each oBrowserNode2 In oBrowserNode.BrowserNodes
			Dim oNativeObject As Object = oBrowserNode2.NativeObject
			If TypeName(oNativeObject) = "PartsList" Then
				If oBrowserNode2.BrowserNodes.Count > 0 Then
					MsgBox("Parts List is split")
				Else
					MsgBox("Parts List is NOT split")
				End If
				Exit For
			End If
		Next
	Next       
End Sub
```

#### Code Block 5

```vb
Sub main
	Dim DrawingDoc = ThisApplication.ActiveEditDocument
	Dim modelState As Integer = 0
	For Each oSheet In DrawingDoc.Sheets
		itemNumber=1
		While itemNumber < 10
			Try
				oPartsList = oSheet.PartsLists.Item(itemNumber)
				If modelState = oPartsList.ReferencedDocumentDescriptor.ReferencedModelState
					MsgBox("Parts List is split")
				Else
					MsgBox("Parts List is NOT split or this is the first occurance of it")
					modelState=oPartsList.ReferencedDocumentDescriptor.ReferencedModelState
				End If
					itemNumber = itemNumber + 1
			Catch
				Exit While
			End Try
		End While
	Next
End Sub
```

#### Code Block 6

```vb
Sub main
	Dim DrawingDoc = ThisApplication.ActiveEditDocument
	Dim modelState As Integer = 0
	For Each oSheet In DrawingDoc.Sheets
		itemNumber=1
		While itemNumber < 10
			Try
				oPartsList = oSheet.PartsLists.Item(itemNumber)
				If modelState = oPartsList.ReferencedDocumentDescriptor.ReferencedModelState
					MsgBox("Parts List is split")
				Else
					MsgBox("Parts List is NOT split or this is the first occurance of it")
					modelState=oPartsList.ReferencedDocumentDescriptor.ReferencedModelState
				End If
					itemNumber = itemNumber + 1
			Catch
				Exit While
			End Try
		End While
	Next
End Sub
```

---

### 6. Code to measure length and width

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/code-to-measure-length-and-width/td-p/13792602](https://forums.autodesk.com/t5/inventor-programming-forum/code-to-measure-length-and-width/td-p/13792602)

**Author:** berry.lejeune

**Date:** ‎09-02-2025
	
		
		03:23 AM

**Description:** Hi all, Don't even know if it's possible but I'll ask anywayWe've received a Revit model of a big building which is covered in stone plates. Now I need to get those dimensions of those plates for our manufacturer.But in stead of measuring each indivudial one, is it possible with a code to click on t...

**Code Snippets (3):**

#### Code Block 1

```vb
'Dimensions

Geo_Length = Measure.PreciseExtentsLength
Geo_Width = Measure.PreciseExtentsWidth
Geo_Height = Measure.PreciseExtentsHeight
```

#### Code Block 2

```vb
'Dimensions

Geo_Length = Measure.PreciseExtentsLength
Geo_Width = Measure.PreciseExtentsWidth
Geo_Height = Measure.PreciseExtentsHeight
```

#### Code Block 3

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oCM As CommandManager = oInvApp.CommandManager
Dim oUOM As UnitsOfMeasure = oInvApp.ActiveDocument.UnitsOfMeasure
'Dim eLeng As UnitsTypeEnum = UnitsTypeEnum.kFootLengthUnits
Dim eLeng As UnitsTypeEnum = UnitsTypeEnum.kCentimeterLengthUnits

Do
	Dim oFace As Object
	oFace = oCM.Pick(SelectionFilterEnum.kPartFaceFilter, "Select Face...")
	If oFace Is Nothing Then Exit Do
	Dim oBox As Box2d = oFace.Evaluator.ParamRangeRect
	Dim oSizes(1) As Double
	oSizes(0) = Round(oUOM.ConvertUnits(oBox.MaxPoint.X - oBox.MinPoint.X,
										eLeng, oUOM.LengthUnits), 3)
	oSizes(1) = Round(oUOM.ConvertUnits(oBox.MaxPoint.Y - oBox.MinPoint.Y,
										eLeng, oUOM.LengthUnits), 3)
	MessageBox.Show("Length - " & Abs(oSizes.Max) & vbLf &
					"Width - " & Abs(oSizes.Min), "Surface size:")
	Logger.Info("Length - " & Abs(oSizes.Max))
	Logger.Info("Width - " & Abs(oSizes.Min))
Loop
```

#### Code Block 4

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oCM As CommandManager = oInvApp.CommandManager
Dim oUOM As UnitsOfMeasure = oInvApp.ActiveDocument.UnitsOfMeasure
'Dim eLeng As UnitsTypeEnum = UnitsTypeEnum.kFootLengthUnits
Dim eLeng As UnitsTypeEnum = UnitsTypeEnum.kCentimeterLengthUnits

Do
	Dim oFace As Object
	oFace = oCM.Pick(SelectionFilterEnum.kPartFaceFilter, "Select Face...")
	If oFace Is Nothing Then Exit Do
	Dim oBox As Box2d = oFace.Evaluator.ParamRangeRect
	Dim oSizes(1) As Double
	oSizes(0) = Round(oUOM.ConvertUnits(oBox.MaxPoint.X - oBox.MinPoint.X,
										eLeng, oUOM.LengthUnits), 3)
	oSizes(1) = Round(oUOM.ConvertUnits(oBox.MaxPoint.Y - oBox.MinPoint.Y,
										eLeng, oUOM.LengthUnits), 3)
	MessageBox.Show("Length - " & Abs(oSizes.Max) & vbLf &
					"Width - " & Abs(oSizes.Min), "Surface size:")
	Logger.Info("Length - " & Abs(oSizes.Max))
	Logger.Info("Width - " & Abs(oSizes.Min))
Loop
```

#### Code Block 5

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oCM As CommandManager = oInvApp.CommandManager
Dim oUOM As UnitsOfMeasure = oInvApp.ActiveDocument.UnitsOfMeasure
'Dim eLeng As UnitsTypeEnum = UnitsTypeEnum.kFootLengthUnits
Dim eLeng As UnitsTypeEnum = UnitsTypeEnum.kCentimeterLengthUnits

Do
	Dim oFace As Object
	oFace = oCM.Pick(SelectionFilterEnum.kPartFaceFilter, "Select Face...")
	If oFace Is Nothing Then Exit Do
	Dim oBox As Box2d = oFace.Evaluator.ParamRangeRect
	Dim oSizes(1) As Double
	oSizes(0) = Round(oUOM.ConvertUnits(oBox.MaxPoint.X - oBox.MinPoint.X,
										eLeng, oUOM.LengthUnits), 3)
	oSizes(1) = Round(oUOM.ConvertUnits(oBox.MaxPoint.Y - oBox.MinPoint.Y,
										eLeng, oUOM.LengthUnits), 3)
	MessageBox.Show("Length - " & Abs(oSizes.Max) & vbLf &
					"Width - " & Abs(oSizes.Min), "Surface size:")
	Logger.Info("Length - " & Abs(oSizes.Max))
	Logger.Info("Width - " & Abs(oSizes.Min))
Loop
```

#### Code Block 6

```vb
Dim oInvApp As Inventor.Application = ThisApplication
Dim oCM As CommandManager = oInvApp.CommandManager
Dim oUOM As UnitsOfMeasure = oInvApp.ActiveDocument.UnitsOfMeasure
'Dim eLeng As UnitsTypeEnum = UnitsTypeEnum.kFootLengthUnits
Dim eLeng As UnitsTypeEnum = UnitsTypeEnum.kCentimeterLengthUnits

Do
	Dim oFace As Object
	oFace = oCM.Pick(SelectionFilterEnum.kPartFaceFilter, "Select Face...")
	If oFace Is Nothing Then Exit Do
	Dim oBox As Box2d = oFace.Evaluator.ParamRangeRect
	Dim oSizes(1) As Double
	oSizes(0) = Round(oUOM.ConvertUnits(oBox.MaxPoint.X - oBox.MinPoint.X,
										eLeng, oUOM.LengthUnits), 3)
	oSizes(1) = Round(oUOM.ConvertUnits(oBox.MaxPoint.Y - oBox.MinPoint.Y,
										eLeng, oUOM.LengthUnits), 3)
	MessageBox.Show("Length - " & Abs(oSizes.Max) & vbLf &
					"Width - " & Abs(oSizes.Min), "Surface size:")
	Logger.Info("Length - " & Abs(oSizes.Max))
	Logger.Info("Width - " & Abs(oSizes.Min))
Loop
```

---

### 7. ControlDefinition.Execute2 does not run unless it is the last line in the rule

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/controldefinition-execute2-does-not-run-unless-it-is-the-last/td-p/13838361#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/controldefinition-execute2-does-not-run-unless-it-is-the-last/td-p/13838361#messageview_0)

**Author:** Nick_Hall

**Date:** ‎10-05-2025
	
		
		09:06 PM

**Description:** I am writing some iLogic that interacts with the Vault Revision Table. One of the things I want to do as part of the rule is to update the Revision Table with the Vault data. I want to run it as an"After Open Document" rule.  This is a minimal version of the code I would like to run. MessageBox.Show...

**Code Snippets (4):**

#### Code Block 1

```vb
MessageBox.Show("Updating Revision Table")
Dim oControlDef As Inventor.ControlDefinition = ThisApplication.CommandManager.ControlDefinitions.Item("VaultRevisionBlockTableNode")
oControlDef.Execute2(False)
```

#### Code Block 2

```vb
MessageBox.Show("Updating Revision Table")
Dim oControlDef As Inventor.ControlDefinition = ThisApplication.CommandManager.ControlDefinitions.Item("VaultRevisionBlockTableNode")
oControlDef.Execute2(False)
```

#### Code Block 3

```vb
MessageBox.Show("Updating Revision Table")
Dim oControlDef As Inventor.ControlDefinition = ThisApplication.CommandManager.ControlDefinitions.Item("VaultRevisionBlockTableNode")
oControlDef.Execute2(False)
```

#### Code Block 4

```vb
MessageBox.Show("Updating Revision Table")
Dim oControlDef As Inventor.ControlDefinition = ThisApplication.CommandManager.ControlDefinitions.Item("VaultRevisionBlockTableNode")
oControlDef.Execute2(False)
```

#### Code Block 5

```vb
MessageBox.Show("Updating Revision Table")
Dim oControlDef As Inventor.ControlDefinition = ThisApplication.CommandManager.ControlDefinitions.Item("VaultRevisionBlockTableNode")
oControlDef.Execute2(True)
MessageBox.Show("Updated Revision Table")
```

#### Code Block 6

```vb
MessageBox.Show("Updating Revision Table")
Dim oControlDef As Inventor.ControlDefinition = ThisApplication.CommandManager.ControlDefinitions.Item("VaultRevisionBlockTableNode")
oControlDef.Execute2(True)
MessageBox.Show("Updated Revision Table")
```

#### Code Block 7

```vb
MessageBox.Show("Updating Revision Table")
Dim oControlDef As Inventor.ControlDefinition = ThisApplication.CommandManager.ControlDefinitions.Item("VaultRevisionBlockTableNode")
oControlDef.Execute2(True)
MessageBox.Show("Updated Revision Table")
```

#### Code Block 8

```vb
MessageBox.Show("Updating Revision Table")
Dim oControlDef As Inventor.ControlDefinition = ThisApplication.CommandManager.ControlDefinitions.Item("VaultRevisionBlockTableNode")
oControlDef.Execute2(True)
MessageBox.Show("Updated Revision Table")
```

---

### 8. Copy Design Issue – Suppressed Parts Not Rebuilding or Updating (Skeleton Reference Problem)

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/copy-design-issue-suppressed-parts-not-rebuilding-or-updating/td-p/13816281](https://forums.autodesk.com/t5/inventor-programming-forum/copy-design-issue-suppressed-parts-not-rebuilding-or-updating/td-p/13816281)

**Author:** pranaykapse1

**Date:** ‎09-18-2025
	
		
		06:46 AM

**Description:** Hi Everyone, I am facing an issue while working with Copy Design in Vault for my Autodesk Inventor assemblies.All of my assemblies are parametric and skeleton-based. The Copy Design process works fine for normal parts and assemblies, but I encounter problems with suppressed components.When suppresse...

**Code Snippets (2):**

#### Code Block 1

```vb
'This Rule Helps to Update all parts and assemblies (Even Suppressed) and Save.

For Each oDoc As Document In ThisApplication.Documents
Try
' Force update
oDoc.Update()

' Save after update
If oDoc.FullFileName <> "" AndAlso oDoc.IsModifiable Then
oDoc.Save2(True) ' True = Save silently without dialogs
End If
Catch
End Try
Next
iLogicVb.UpdateWhenDone = True
```

#### Code Block 2

```vb
'This Rule Helps to Update all parts and assemblies (Even Suppressed) and Save.

For Each oDoc As Document In ThisApplication.Documents
Try
' Force update
oDoc.Update()

' Save after update
If oDoc.FullFileName <> "" AndAlso oDoc.IsModifiable Then
oDoc.Save2(True) ' True = Save silently without dialogs
End If
Catch
End Try
Next
iLogicVb.UpdateWhenDone = True
```

---

### 9. Custom ribbon button doesn't execute VBA sub

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/custom-ribbon-button-doesn-t-execute-vba-sub/td-p/13788549](https://forums.autodesk.com/t5/inventor-programming-forum/custom-ribbon-button-doesn-t-execute-vba-sub/td-p/13788549)

**Author:** sv.lucht

**Date:** ‎08-29-2025
	
		
		04:54 AM

**Description:** I try to create custom ribbon tabs that get called when different criteria are met. The VBA code resides in StampMaker.ivb library in the UIManager module and everything works fine. I can create and destroy tabs,panel,buttons, but I cannot make the buttons work. The functions get never called. I tri...

**Code Snippets (4):**

#### Code Block 1

```vb
Public Sub CreateMinimalMacroButton()
' --- 1. Define the names for the macro and UI elements ---
Const MACRO_FULL_NAME As String = "Module1.MyTargetSubroutine"
Const TAB_ID As String = "StampMaker_MinimalTab_1"
Const PANEL_ID As String = "StampMaker_MinimalPanel_1"

Dim uiMgr As UserInterfaceManager
Set uiMgr = ThisApplication.UserInterfaceManager

' --- 2. Clean up any old versions of these UI elements ---
' Using "On Error Resume Next" is a simple way to delete items
' without causing an error if they don't exist yet.
On Error Resume Next

' Delete the Ribbon Tab (this also removes the panel and the button on it)
uiMgr.Ribbons.item("ZeroDoc").RibbonTabs.item(TAB_ID).delete

' Delete the Control Definition (the "brain" of the button)
ThisApplication.CommandManager.ControlDefinitions.item(MACRO_FULL_NAME).delete

' Return to normal error handling
On Error GoTo 0

' --- 3. Create the new UI ---

' Get the ribbon that's visible when no document is open
Dim zeroRibbon As Ribbon
Set zeroRibbon = uiMgr.Ribbons.item("ZeroDoc")

' Create the new tab
Dim myTab As RibbonTab
Set myTab = zeroRibbon.RibbonTabs.Add("Minimal Test", TAB_ID, "ClientID_MinimalTab")

' Create a panel on the tab
Dim myPanel As RibbonPanel
Set myPanel = myTab.RibbonPanels.Add("Test Panel", PANEL_ID, "ClientID_MinimalPanel")

' Create the Macro Definition - this links the button to your code
Dim macroDef As MacroControlDefinition
Set macroDef = ThisApplication.CommandManager.ControlDefinitions.AddMacroControlDefinition(MACRO_FULL_NAME)

' Add the actual button to the panel
Call myPanel.CommandControls.AddMacro(macroDef)

' --- 4. Notify the user ---
MsgBox "Minimal macro button has been created." & vbCrLf & _
"Look for the 'Minimal Test' tab in your ribbon.", vbInformation

End Sub
```

#### Code Block 2

```vb
Public Sub CreateMinimalMacroButton()
' --- 1. Define the names for the macro and UI elements ---
Const MACRO_FULL_NAME As String = "Module1.MyTargetSubroutine"
Const TAB_ID As String = "StampMaker_MinimalTab_1"
Const PANEL_ID As String = "StampMaker_MinimalPanel_1"

Dim uiMgr As UserInterfaceManager
Set uiMgr = ThisApplication.UserInterfaceManager

' --- 2. Clean up any old versions of these UI elements ---
' Using "On Error Resume Next" is a simple way to delete items
' without causing an error if they don't exist yet.
On Error Resume Next

' Delete the Ribbon Tab (this also removes the panel and the button on it)
uiMgr.Ribbons.item("ZeroDoc").RibbonTabs.item(TAB_ID).delete

' Delete the Control Definition (the "brain" of the button)
ThisApplication.CommandManager.ControlDefinitions.item(MACRO_FULL_NAME).delete

' Return to normal error handling
On Error GoTo 0

' --- 3. Create the new UI ---

' Get the ribbon that's visible when no document is open
Dim zeroRibbon As Ribbon
Set zeroRibbon = uiMgr.Ribbons.item("ZeroDoc")

' Create the new tab
Dim myTab As RibbonTab
Set myTab = zeroRibbon.RibbonTabs.Add("Minimal Test", TAB_ID, "ClientID_MinimalTab")

' Create a panel on the tab
Dim myPanel As RibbonPanel
Set myPanel = myTab.RibbonPanels.Add("Test Panel", PANEL_ID, "ClientID_MinimalPanel")

' Create the Macro Definition - this links the button to your code
Dim macroDef As MacroControlDefinition
Set macroDef = ThisApplication.CommandManager.ControlDefinitions.AddMacroControlDefinition(MACRO_FULL_NAME)

' Add the actual button to the panel
Call myPanel.CommandControls.AddMacro(macroDef)

' --- 4. Notify the user ---
MsgBox "Minimal macro button has been created." & vbCrLf & _
"Look for the 'Minimal Test' tab in your ribbon.", vbInformation

End Sub
```

#### Code Block 3

```vb
Public Sub CreateMinimalMacroButton()
' --- 1. Define the names for the macro and UI elements ---
Const MACRO_FULL_NAME As String = "Module1.MyTargetSubroutine"
Const TAB_ID As String = "StampMaker_MinimalTab_1"
Const PANEL_ID As String = "StampMaker_MinimalPanel_1"

Dim uiMgr As UserInterfaceManager
Set uiMgr = ThisApplication.UserInterfaceManager

' --- 2. Clean up any old versions of these UI elements ---
' Using "On Error Resume Next" is a simple way to delete items
' without causing an error if they don't exist yet.
On Error Resume Next

' Delete the Ribbon Tab (this also removes the panel and the button on it)
uiMgr.Ribbons.item("ZeroDoc").RibbonTabs.item(TAB_ID).delete

' Delete the Control Definition (the "brain" of the button)
ThisApplication.CommandManager.ControlDefinitions.item(MACRO_FULL_NAME).delete

' Return to normal error handling
On Error GoTo 0

' --- 3. Create the new UI ---

' Get the ribbon that's visible when no document is open
Dim zeroRibbon As Ribbon
Set zeroRibbon = uiMgr.Ribbons.item("ZeroDoc")

' Create the new tab
Dim myTab As RibbonTab
Set myTab = zeroRibbon.RibbonTabs.Add("Minimal Test", TAB_ID, "ClientID_MinimalTab")

' Create a panel on the tab
Dim myPanel As RibbonPanel
Set myPanel = myTab.RibbonPanels.Add("Test Panel", PANEL_ID, "ClientID_MinimalPanel")

' Create the Macro Definition - this links the button to your code
Dim macroDef As MacroControlDefinition
Set macroDef = ThisApplication.CommandManager.ControlDefinitions.AddMacroControlDefinition(MACRO_FULL_NAME)

' Add the actual button to the panel
Call myPanel.CommandControls.AddMacro(macroDef)

' --- 4. Notify the user ---
MsgBox "Minimal macro button has been created." & vbCrLf & _
"Look for the 'Minimal Test' tab in your ribbon.", vbInformation

End Sub
```

#### Code Block 4

```vb
Public Sub CreateMinimalMacroButton()
' --- 1. Define the names for the macro and UI elements ---
Const MACRO_FULL_NAME As String = "Module1.MyTargetSubroutine"
Const TAB_ID As String = "StampMaker_MinimalTab_1"
Const PANEL_ID As String = "StampMaker_MinimalPanel_1"

Dim uiMgr As UserInterfaceManager
Set uiMgr = ThisApplication.UserInterfaceManager

' --- 2. Clean up any old versions of these UI elements ---
' Using "On Error Resume Next" is a simple way to delete items
' without causing an error if they don't exist yet.
On Error Resume Next

' Delete the Ribbon Tab (this also removes the panel and the button on it)
uiMgr.Ribbons.item("ZeroDoc").RibbonTabs.item(TAB_ID).delete

' Delete the Control Definition (the "brain" of the button)
ThisApplication.CommandManager.ControlDefinitions.item(MACRO_FULL_NAME).delete

' Return to normal error handling
On Error GoTo 0

' --- 3. Create the new UI ---

' Get the ribbon that's visible when no document is open
Dim zeroRibbon As Ribbon
Set zeroRibbon = uiMgr.Ribbons.item("ZeroDoc")

' Create the new tab
Dim myTab As RibbonTab
Set myTab = zeroRibbon.RibbonTabs.Add("Minimal Test", TAB_ID, "ClientID_MinimalTab")

' Create a panel on the tab
Dim myPanel As RibbonPanel
Set myPanel = myTab.RibbonPanels.Add("Test Panel", PANEL_ID, "ClientID_MinimalPanel")

' Create the Macro Definition - this links the button to your code
Dim macroDef As MacroControlDefinition
Set macroDef = ThisApplication.CommandManager.ControlDefinitions.AddMacroControlDefinition(MACRO_FULL_NAME)

' Add the actual button to the panel
Call myPanel.CommandControls.AddMacro(macroDef)

' --- 4. Notify the user ---
MsgBox "Minimal macro button has been created." & vbCrLf & _
"Look for the 'Minimal Test' tab in your ribbon.", vbInformation

End Sub
```

#### Code Block 5

```vb
Public Sub RunCleanButtonTest()
' --- Phase 1: Aggressive Cleanup ---
'Const TEST_MACRO_NAME As String = "Default.Module1.testio"
Const TEST_MACRO_NAME As String = "StampMaker.UIManager.testprompt"
Const TEST_TAB_NAME As String = "MyTestTab"
Const TEST_PANEL_NAME As String = "MyTestPanel"

' Delete the Control Definition
On Error Resume Next
ThisApplication.CommandManager.ControlDefinitions.item(TEST_MACRO_NAME).delete
Debug.Print "Old Control Definition deleted (if it existed)."
On Error GoTo 0

' Delete the Ribbon Tab
Dim zeroRibbon As Inventor.Ribbon
Set zeroRibbon = ThisApplication.UserInterfaceManager.Ribbons.item("ZeroDoc")
On Error Resume Next
zeroRibbon.RibbonTabs.item(TEST_TAB_NAME).delete
Debug.Print "Old Ribbon Tab deleted (if it existed)."
On Error GoTo 0

' --- Phase 2: Create a single, simple button ---
Debug.Print "Creating new UI..."

' Create Tab and Panel
Dim newTab As RibbonTab
Set newTab = zeroRibbon.RibbonTabs.Add("My Test", TEST_TAB_NAME, "ClientID_TestTab")
Dim newPanel As RibbonPanel
Set newPanel = newTab.RibbonPanels.Add("My Panel", TEST_PANEL_NAME, "ClientID_TestPanel")

' Create Button Definition
Dim buttonDef As ButtonDefinition
Set buttonDef = ThisApplication.CommandManager.ControlDefinitions.AddButtonDefinition( _
"Click Me", _
TEST_MACRO_NAME, _
CommandTypesEnum.kNonShapeEditCmdType)

' Add button to panel
Call newPanel.CommandControls.AddButton(buttonDef, True)

Debug.Print "--- Test UI created. Please click the 'Click Me' button on the 'My Test' tab. ---"
End Sub


Public Sub testprompt()
Debug.Print ("HEUREKA! it works")
Debug.Print ("HEUREKA! it works")
Debug.Print ("HEUREKA! it works")
End Sub
```

#### Code Block 6

```vb
Public Sub RunCleanButtonTest()
' --- Phase 1: Aggressive Cleanup ---
'Const TEST_MACRO_NAME As String = "Default.Module1.testio"
Const TEST_MACRO_NAME As String = "StampMaker.UIManager.testprompt"
Const TEST_TAB_NAME As String = "MyTestTab"
Const TEST_PANEL_NAME As String = "MyTestPanel"

' Delete the Control Definition
On Error Resume Next
ThisApplication.CommandManager.ControlDefinitions.item(TEST_MACRO_NAME).delete
Debug.Print "Old Control Definition deleted (if it existed)."
On Error GoTo 0

' Delete the Ribbon Tab
Dim zeroRibbon As Inventor.Ribbon
Set zeroRibbon = ThisApplication.UserInterfaceManager.Ribbons.item("ZeroDoc")
On Error Resume Next
zeroRibbon.RibbonTabs.item(TEST_TAB_NAME).delete
Debug.Print "Old Ribbon Tab deleted (if it existed)."
On Error GoTo 0

' --- Phase 2: Create a single, simple button ---
Debug.Print "Creating new UI..."

' Create Tab and Panel
Dim newTab As RibbonTab
Set newTab = zeroRibbon.RibbonTabs.Add("My Test", TEST_TAB_NAME, "ClientID_TestTab")
Dim newPanel As RibbonPanel
Set newPanel = newTab.RibbonPanels.Add("My Panel", TEST_PANEL_NAME, "ClientID_TestPanel")

' Create Button Definition
Dim buttonDef As ButtonDefinition
Set buttonDef = ThisApplication.CommandManager.ControlDefinitions.AddButtonDefinition( _
"Click Me", _
TEST_MACRO_NAME, _
CommandTypesEnum.kNonShapeEditCmdType)

' Add button to panel
Call newPanel.CommandControls.AddButton(buttonDef, True)

Debug.Print "--- Test UI created. Please click the 'Click Me' button on the 'My Test' tab. ---"
End Sub


Public Sub testprompt()
Debug.Print ("HEUREKA! it works")
Debug.Print ("HEUREKA! it works")
Debug.Print ("HEUREKA! it works")
End Sub
```

#### Code Block 7

```vb
Public Sub RunCleanButtonTest()
' --- Phase 1: Aggressive Cleanup ---
'Const TEST_MACRO_NAME As String = "Default.Module1.testio"
Const TEST_MACRO_NAME As String = "StampMaker.UIManager.testprompt"
Const TEST_TAB_NAME As String = "MyTestTab"
Const TEST_PANEL_NAME As String = "MyTestPanel"

' Delete the Control Definition
On Error Resume Next
ThisApplication.CommandManager.ControlDefinitions.item(TEST_MACRO_NAME).delete
Debug.Print "Old Control Definition deleted (if it existed)."
On Error GoTo 0

' Delete the Ribbon Tab
Dim zeroRibbon As Inventor.Ribbon
Set zeroRibbon = ThisApplication.UserInterfaceManager.Ribbons.item("ZeroDoc")
On Error Resume Next
zeroRibbon.RibbonTabs.item(TEST_TAB_NAME).delete
Debug.Print "Old Ribbon Tab deleted (if it existed)."
On Error GoTo 0

' --- Phase 2: Create a single, simple button ---
Debug.Print "Creating new UI..."

' Create Tab and Panel
Dim newTab As RibbonTab
Set newTab = zeroRibbon.RibbonTabs.Add("My Test", TEST_TAB_NAME, "ClientID_TestTab")
Dim newPanel As RibbonPanel
Set newPanel = newTab.RibbonPanels.Add("My Panel", TEST_PANEL_NAME, "ClientID_TestPanel")

' Create Button Definition
Dim buttonDef As ButtonDefinition
Set buttonDef = ThisApplication.CommandManager.ControlDefinitions.AddButtonDefinition( _
"Click Me", _
TEST_MACRO_NAME, _
CommandTypesEnum.kNonShapeEditCmdType)

' Add button to panel
Call newPanel.CommandControls.AddButton(buttonDef, True)

Debug.Print "--- Test UI created. Please click the 'Click Me' button on the 'My Test' tab. ---"
End Sub


Public Sub testprompt()
Debug.Print ("HEUREKA! it works")
Debug.Print ("HEUREKA! it works")
Debug.Print ("HEUREKA! it works")
End Sub
```

#### Code Block 8

```vb
Public Sub RunCleanButtonTest()
' --- Phase 1: Aggressive Cleanup ---
'Const TEST_MACRO_NAME As String = "Default.Module1.testio"
Const TEST_MACRO_NAME As String = "StampMaker.UIManager.testprompt"
Const TEST_TAB_NAME As String = "MyTestTab"
Const TEST_PANEL_NAME As String = "MyTestPanel"

' Delete the Control Definition
On Error Resume Next
ThisApplication.CommandManager.ControlDefinitions.item(TEST_MACRO_NAME).delete
Debug.Print "Old Control Definition deleted (if it existed)."
On Error GoTo 0

' Delete the Ribbon Tab
Dim zeroRibbon As Inventor.Ribbon
Set zeroRibbon = ThisApplication.UserInterfaceManager.Ribbons.item("ZeroDoc")
On Error Resume Next
zeroRibbon.RibbonTabs.item(TEST_TAB_NAME).delete
Debug.Print "Old Ribbon Tab deleted (if it existed)."
On Error GoTo 0

' --- Phase 2: Create a single, simple button ---
Debug.Print "Creating new UI..."

' Create Tab and Panel
Dim newTab As RibbonTab
Set newTab = zeroRibbon.RibbonTabs.Add("My Test", TEST_TAB_NAME, "ClientID_TestTab")
Dim newPanel As RibbonPanel
Set newPanel = newTab.RibbonPanels.Add("My Panel", TEST_PANEL_NAME, "ClientID_TestPanel")

' Create Button Definition
Dim buttonDef As ButtonDefinition
Set buttonDef = ThisApplication.CommandManager.ControlDefinitions.AddButtonDefinition( _
"Click Me", _
TEST_MACRO_NAME, _
CommandTypesEnum.kNonShapeEditCmdType)

' Add button to panel
Call newPanel.CommandControls.AddButton(buttonDef, True)

Debug.Print "--- Test UI created. Please click the 'Click Me' button on the 'My Test' tab. ---"
End Sub


Public Sub testprompt()
Debug.Print ("HEUREKA! it works")
Debug.Print ("HEUREKA! it works")
Debug.Print ("HEUREKA! it works")
End Sub
```

---

### 10. Decimal places in iLogic form

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/decimal-places-in-ilogic-form/td-p/13806789](https://forums.autodesk.com/t5/inventor-programming-forum/decimal-places-in-ilogic-form/td-p/13806789)

**Author:** Curtis_Waguespack

**Date:** ‎09-11-2025
	
		
		10:33 AM

**Description:** Problem with decimal places in iLogic form in Inventor 2025. See attached files.   Here is the issue:       I thought I knew how to control this, by handing the value to a variable in a rule, rounding it, and then pushing that rounded value back out to the parameter, like this.  But I'm not getting ...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim pr As Inventor.Parameter = ThisDoc.Document.componentdefinition.parameters("Offset2")
Dim v As Double = pr.Value/2.54
pr.Expression=1
pr.Expression =Round(v,1)
```

#### Code Block 2

```vb
Dim pr As Inventor.Parameter = ThisDoc.Document.componentdefinition.parameters("Offset2")
Dim v As Double = pr.Value/2.54
pr.Expression=1
pr.Expression =Round(v,1)
```

#### Code Block 3

```vb
oTrigger = Offset2
Dim pr As Inventor.Parameter = ThisDoc.Document.componentdefinition.parameters("Offset2")
Dim v As Double = pr.Value/2.54
pr.Expression=1
pr.Expression =Round(v,1)
```

---

### 11. Delete ImportedComponent from part environment

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/delete-importedcomponent-from-part-environment/td-p/12156512](https://forums.autodesk.com/t5/inventor-programming-forum/delete-importedcomponent-from-part-environment/td-p/12156512)

**Author:** sneha.sadaphal

**Date:** ‎08-08-2023
	
		
		04:20 AM

**Description:** Hi,I have inserted the step file as imported component in inventor part environment.and also added one button to delete that imported component. but seems like the importedComponent.delete() is not implemented.getting error for delete();Is anyone have idea about this? if (_document != null && _docum...

**Code Snippets (4):**

#### Code Block 1

```vb
CompOcc.BreakLinkToFile();
```

#### Code Block 2

```vb
CompOcc.BreakLinkToFile();
```

#### Code Block 3

```vb
CompOcc.BreakLinkToFile();
```

#### Code Block 4

```vb
CompOcc.BreakLinkToFile();
```

#### Code Block 5

```vb
if (_document != null && _document.DocumentType == DocumentTypeEnum.kPartDocumentObject)
            {
                PartDocument _oPart = _document as PartDocument;
                var oPartCompdef = _oPart.ComponentDefinition;                
                ImportedComponents impComps = oPartCompdef.ReferenceComponents.ImportedComponents;
                foreach (ImportedComponent CompOcc in impComps)
                {                   
                  string fileUrn = CompOcc.Name.Replace(".stp","");
                   if (exchangeItem.ExchangeID.Contains(fileUrn))
                   {
                       CompOcc.Delete();
                   }
                }

            }
```

#### Code Block 6

```vb
if (_document != null && _document.DocumentType == DocumentTypeEnum.kPartDocumentObject)
            {
                PartDocument _oPart = _document as PartDocument;
                var oPartCompdef = _oPart.ComponentDefinition;                
                ImportedComponents impComps = oPartCompdef.ReferenceComponents.ImportedComponents;
                foreach (ImportedComponent CompOcc in impComps)
                {                   
                  string fileUrn = CompOcc.Name.Replace(".stp","");
                   if (exchangeItem.ExchangeID.Contains(fileUrn))
                   {
                       CompOcc.Delete();
                   }
                }

            }
```

#### Code Block 7

```vb
if (_document != null && _document.DocumentType == DocumentTypeEnum.kPartDocumentObject)
            {
                PartDocument _oPart = _document as PartDocument;
                var oPartCompdef = _oPart.ComponentDefinition;                
                ImportedComponents impComps = oPartCompdef.ReferenceComponents.ImportedComponents;
                foreach (ImportedComponent CompOcc in impComps)
                {                   
                  string fileUrn = CompOcc.Name.Replace(".stp","");
                   if (exchangeItem.ExchangeID.Contains(fileUrn))
                   {
                       CompOcc.Delete();
                   }
                }

            }
```

#### Code Block 8

```vb
if (_document != null && _document.DocumentType == DocumentTypeEnum.kPartDocumentObject)
            {
                PartDocument _oPart = _document as PartDocument;
                var oPartCompdef = _oPart.ComponentDefinition;                
                ImportedComponents impComps = oPartCompdef.ReferenceComponents.ImportedComponents;
                foreach (ImportedComponent CompOcc in impComps)
                {                   
                  string fileUrn = CompOcc.Name.Replace(".stp","");
                   if (exchangeItem.ExchangeID.Contains(fileUrn))
                   {
                       CompOcc.Delete();
                   }
                }

            }
```

---

### 12. Error 0x800AC472

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/error-0x800ac472/td-p/13755364](https://forums.autodesk.com/t5/inventor-programming-forum/error-0x800ac472/td-p/13755364)

**Author:** layochim

**Date:** ‎08-05-2025
	
		
		05:59 PM

**Description:** I'm still struggling with this iLogic error when writing to an Excel file and pulling a Value from that Excel to a parameter in my model.  Are there any known solutions to 0x800AC472?  My code is below, I've tried using the full file path name and with no success in removing the error.  The rule wil...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim Filename As String = "Straight Conveyor Pricing Test2.xlsx"
Dim SheetName As String = "Conv costing"
```

#### Code Block 2

```vb
Dim Filename As String = "Straight Conveyor Pricing.xlsx"
Dim SheetName As String = "Conv costing"

GoExcel.Open(Filename, SheetName)

GoExcel.CellValue("B9") = BeltWidth
GoExcel.CellValue("B10") = BeltLength
GoExcel.CellValue("B11") = Infeed_End
GoExcel.CellValue("B12") = Discharge_End
GoExcel.CellValue("B13") = Legs
GoExcel.CellValue("B14") = Feet
GoExcel.CellValue("B15") = Belting
GoExcel.CellValue("B16") = BeltingType
GoExcel.CellValue("B17") = BeltColor
GoExcel.CellValue("B18") = Flights
GoExcel.CellValue("B19") = Flight_Spacing
GoExcel.CellValue("B20") = Construction
GoExcel.CellValue("B21") = FlangeHeight
GoExcel.CellValue("B22") = Finish
GoExcel.CellValue("B24") = Drive_Style
GoExcel.CellValue("B25") = Drive_Position
GoExcel.CellValue("B26") = MotorVoltage
GoExcel.CellValue("B27") = Drive_Speed
GoExcel.CellValue("B28") = Motor
GoExcel.CellValue("B29") = Gearbox
GoExcel.CellValue("B30") = AdjustableGuides
GoExcel.CellValue("B31") = BeltLifters
GoExcel.CellValue("B32") = DripPan
GoExcel.CellValue("B33") = BeltScraper
GoExcel.CellValue("B34") = SprayBar
GoExcel.CellValue("B35") = GearboxGuards

Price = GoExcel.CellValue("B6")
GoExcel.Save
GoExcel.Close
```

#### Code Block 3

```vb
Dim oExcelPath As Object = "C:\Users\Lyle\SCR Solutions\Shared OneDrive - Draftsmen Access\Configurator files\Straight Conveyor Configurator\CAD\Straight Conveyor Pricing Test.xlsx"
'	Dim oExcelPath As String = "Straight Conveyor Pricing.xlsx"
	Dim oExcel As Object = CreateObject("Excel.Application")
	oExcel.Visible = False
	oExcel.DisplayAlerts = False
	Dim oWB As Object = oExcel.Workbooks.Open(oExcelPath)
	Dim oWS As Object = oWB.Sheets(1)
	oWS.Activate


oWS.Cells(9, 2) = BeltWidth
oWS.Cells(10, 2).Value = BeltLength
oWS.Cells(11, 2).Value = Infeed_End
oWS.Cells(12, 2).Value = Discharge_End
oWS.Cells(13, 2).Value = Legs
oWS.Cells(14, 2).Value = Feet
oWS.Cells(15, 2).Value = Belting
'oWS.Cells(16, 2).Value = BeltingType
'oWS.Cells(17, 2).Value = BeltColor
'oWS.Cells(18, 2).Value = Flights
'oWS.Cells(19, 2).Value = Flight_Spacing
oWS.Cells(20, 2).Value = Construction
'oWS.Cells(21, 2).Value = FlangeHeight
oWS.Cells(22, 2).Value = Finish
oWS.Cells(24, 2).Value = Drive_Style
'oWS.Cells(25, 2).Value = Drive_Position
'oWS.Cells(26, 2).Value = MotorVoltage
'oWS.Cells(27, 2).Value = Drive_Speed
oWS.Cells(28, 2).Value = Motor
oWS.Cells(29, 2).Value = Gearbox
oWS.Cells(30, 2).Value = AdjustableGuides
oWS.Cells(31, 2).Value = BeltLifters
oWS.Cells(32, 2).Value = DripPan
'oWS.Cells(33, 2).Value = BeltScraper
oWS.Cells(34, 2).Value = SprayBar
oWS.Cells(35, 2).Value = GearboxGuards

Price = oWS.Cells(6, 2).Value
	oWB.Close (True)
	oExcel.Quit
	oExcel = Nothing
```

---

### 13. Excluding Print and Count if Sheet name matches

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/excluding-print-and-count-if-sheet-name-matches/td-p/11396697#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/excluding-print-and-count-if-sheet-name-matches/td-p/11396697#messageview_0)

**Author:** adeel.malik

**Date:** ‎09-01-2022
	
		
		08:03 PM

**Description:** I have a bunch of sheets named Vendor (e.g. Vendor:1 or Vendor:2...). For certain things I want to exclude these sheets from count and print. I wanted to write an ilogic for this but my code is not working.  Dim oDoc As DrawingDocument oDoc = ThisApplication.ActiveDocument Dim oSheet As Sheet  i = 0...

**Code Snippets (10):**

#### Code Block 1

```vb
Dim oDDoc As DrawingDocument = ThisDrawing.Document
Dim oExcludeSheets As Boolean = InputRadioBox("Client or All Sheets?", "Client", "All", Client, "Toggle Sheets")
For Each oSheet As Sheet In oDDoc.Sheets
	If Not oSheet.Name.StartsWith("C") Then
		oSheet.ExcludeFromCount = oExcludeSheets
		oSheet.ExcludeFromPrinting = oExcludeSheets
	End If
Next
```

#### Code Block 2

```vb
Dim oDDoc As DrawingDocument = ThisDrawing.Document
Dim oExcludeSheets As Boolean = InputRadioBox("Client or All Sheets?", "Client", "All", Client, "Toggle Sheets")
For Each oSheet As Sheet In oDDoc.Sheets
	If Not oSheet.Name.StartsWith("C") Then
		oSheet.ExcludeFromCount = oExcludeSheets
		oSheet.ExcludeFromPrinting = oExcludeSheets
	End If
Next
```

#### Code Block 3

```vb
Dim oDDoc As DrawingDocument = ThisDrawing.Document
Dim oExcludeSheets As Boolean = InputRadioBox("Client or All Sheets?", "Client", "All", Client, "Toggle Sheets")
For Each oSheet As Sheet In oDDoc.Sheets
	If oSheet.Name.NotStartsWith("C") Then
		oSheet.ExcludeFromCount = oExcludeSheets
		oSheet.ExcludeFromPrinting = oExcludeSheets
	End If
Next
```

#### Code Block 4

```vb
Dim oDDoc As DrawingDocument = ThisDrawing.Document
Dim oExcludeSheets As Boolean = InputRadioBox("Client or All Sheets?", "Client", "All", Client, "Toggle Sheets")
For Each oSheet As Sheet In oDDoc.Sheets
	If oSheet.Name.NotStartsWith("C") Then
		oSheet.ExcludeFromCount = oExcludeSheets
		oSheet.ExcludeFromPrinting = oExcludeSheets
	End If
Next
```

#### Code Block 5

```vb
Dim oDDoc As DrawingDocument = ThisDrawing.Document
Dim oExcludeSheets As Boolean = InputRadioBox("Client or All Sheets?", "Client", "All", Client, "Toggle Sheets")
For Each oSheet As Sheet In oDDoc.Sheets
	If oSheet.Name.StartsWith("S") Then
		oSheet.ExcludeFromCount = oExcludeSheets
		oSheet.ExcludeFromPrinting = oExcludeSheets
	End If
Next
```

#### Code Block 6

```vb
Dim oDDoc As DrawingDocument = ThisDrawing.Document
Dim oExcludeSheets As Boolean = InputRadioBox("Client or All Sheets?", "Client", "All", Client, "Toggle Sheets")
For Each oSheet As Sheet In oDDoc.Sheets
	If oSheet.Name.StartsWith("S") Then
		oSheet.ExcludeFromCount = oExcludeSheets
		oSheet.ExcludeFromPrinting = oExcludeSheets
	End If
Next
```

#### Code Block 7

```vb
Dim oDDoc As DrawingDocument = ThisDrawing.Document
Dim oExcludeVendorSheets As Boolean = InputRadioBox("Exclude Vendor Sheets?", "True", "False", False, "Toggle Vendor Sheets")
For Each oSheet As Sheet In oDDoc.Sheets
	If oSheet.Name.StartsWith("Vendor") Then
		oSheet.ExcludeFromCount = oExcludeVendorSheets
		oSheet.ExcludeFromPrinting = oExcludeVendorSheets
	End If
Next
```

#### Code Block 8

```vb
Dim oDDoc As DrawingDocument = ThisDrawing.Document
Dim oExcludeVendorSheets As Boolean = InputRadioBox("Exclude Vendor Sheets?", "True", "False", False, "Toggle Vendor Sheets")
For Each oSheet As Sheet In oDDoc.Sheets
	If oSheet.Name.StartsWith("Vendor") Then
		oSheet.ExcludeFromCount = oExcludeVendorSheets
		oSheet.ExcludeFromPrinting = oExcludeVendorSheets
	End If
Next
```

#### Code Block 9

```vb
Dim oDDoc As DrawingDocument = ThisDrawing.Document
Dim oExcludeVendorSheets As Boolean = InputRadioBox("Exclude Vendor Sheets?", "True", "False", False, "Toggle Vendor Sheets")
For Each oSheet As Sheet In oDDoc.Sheets
	If oSheet.Name.StartsWith("Vendor") Then
		oSheet.ExcludeFromCount = oExcludeVendorSheets
		oSheet.ExcludeFromPrinting = oExcludeVendorSheets
	End If
Next
```

#### Code Block 10

```vb
Dim oDDoc As DrawingDocument = ThisDrawing.Document
Dim oExcludeVendorSheets As Boolean = InputRadioBox("Exclude Vendor Sheets?", "True", "False", False, "Toggle Vendor Sheets")
For Each oSheet As Sheet In oDDoc.Sheets
	If oSheet.Name.StartsWith("Vendor") Then
		oSheet.ExcludeFromCount = oExcludeVendorSheets
		oSheet.ExcludeFromPrinting = oExcludeVendorSheets
	End If
Next
```

#### Code Block 11

```vb
Dim oDoc As DrawingDocument
oDoc = ThisApplication.ActiveDocument
Dim oSheet As Sheet

i = 0
x = 0

For Each oSheet In oDoc.Sheets
	i = i + 1
Next

While (x<i)
	Sheet_Name = "Vendor:" & x 
	x= x+1
	'ThisDoc.Document.Sheets.Item(Sheet_Name).ExcludeFromPrinting = True  <---Not working
	'ThisDoc.Document.Sheets.Item(Sheet_Name).ExcludeFromCount = True <---Not working
End While
```

#### Code Block 12

```vb
Dim oDoc As DrawingDocument
oDoc = ThisApplication.ActiveDocument
Dim oSheet As Sheet

i = 0
x = 0

For Each oSheet In oDoc.Sheets
	i = i + 1
Next

While (x<i)
	Sheet_Name = "Vendor:" & x 
	x= x+1
	'ThisDoc.Document.Sheets.Item(Sheet_Name).ExcludeFromPrinting = True  <---Not working
	'ThisDoc.Document.Sheets.Item(Sheet_Name).ExcludeFromCount = True <---Not working
End While
```

#### Code Block 13

```vb
Dim oDoc As DrawingDocument = ThisDoc.Document
Dim i as Integer = 0

For Each oSheet As Sheet In oDoc.Sheets
	
	i = i + 1
	
	If oSheet.Name = "Vendor:" & i
		oDoc.Sheets.Item(oSheet.Name).ExcludeFromPrinting = True  
		oDoc.Sheets.Item(oSheet.Name).ExcludeFromCount = True
	End If
Next
```

#### Code Block 14

```vb
Dim oDoc As DrawingDocument = ThisDoc.Document
Dim i as Integer = 0

For Each oSheet As Sheet In oDoc.Sheets
	
	i = i + 1
	
	If oSheet.Name = "Vendor:" & i
		oDoc.Sheets.Item(oSheet.Name).ExcludeFromPrinting = True  
		oDoc.Sheets.Item(oSheet.Name).ExcludeFromCount = True
	End If
Next
```

#### Code Block 15

```vb
Dim oDoc As DrawingDocument = ThisDoc.Document
Dim i as Integer = 0

For Each oSheet As Sheet In oDoc.Sheets
	
	i = i + 1
	
	If oSheet.Name = "Vendor:" & i
		oDoc.Sheets.Item(oSheet.Name).ExcludeFromPrinting = True  
		oDoc.Sheets.Item(oSheet.Name).ExcludeFromCount = True
	End If
Next
```

#### Code Block 16

```vb
Dim oDoc As DrawingDocument = ThisDoc.Document
Dim i as Integer = 0

For Each oSheet As Sheet In oDoc.Sheets
	
	i = i + 1
	
	If oSheet.Name = "Vendor:" & i
		oDoc.Sheets.Item(oSheet.Name).ExcludeFromPrinting = True  
		oDoc.Sheets.Item(oSheet.Name).ExcludeFromCount = True
	End If
Next
```

#### Code Block 17

```vb
If oSheet.Name.Contains("Vendor") Then
   oDoc.Sheets.Item(oSheet.Name).ExcludeFromPrinting = True  
   oDoc.Sheets.Item(oSheet.Name).ExcludeFromCount = True
End If
```

#### Code Block 18

```vb
If oSheet.Name.Contains("Vendor") Then
   oDoc.Sheets.Item(oSheet.Name).ExcludeFromPrinting = True  
   oDoc.Sheets.Item(oSheet.Name).ExcludeFromCount = True
End If
```

#### Code Block 19

```vb
If oSheet.Name.StartsWith("S") Then
```

#### Code Block 20

```vb
If oSheet.Name.StartsWith("S") Then
```

---

### 14. Export Drawing dimension to excel

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/export-drawing-dimension-to-excel/td-p/10155062](https://forums.autodesk.com/t5/inventor-programming-forum/export-drawing-dimension-to-excel/td-p/10155062)

**Author:** eladm

**Date:** ‎03-14-2021
	
		
		12:02 AM

**Description:** Hi I need help with ilogic rule to export all drawing dimensions to ExcelNot VBA , some of the dimeson  have toleranceregards 					 				 			 			 				 			 			 				 	 			 				 					 						Solved! 					 					Go to Solution.

**Code Snippets (16):**

#### Code Block 1

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

'Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.add
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet

Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper*10
oCells.item(i,3).value  = b.Tolerance.Lower*10
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 2

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

'Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.add
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet

Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper*10
oCells.item(i,3).value  = b.Tolerance.Lower*10
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 3

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

'Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.add
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet

Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper*10
oCells.item(i,3).value  = b.Tolerance.Lower*10
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 4

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

'Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.add
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet

Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper*10
oCells.item(i,3).value  = b.Tolerance.Lower*10
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 5

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

'Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.add'.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

'oCells.item(2,1).value= b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'MsgBox (b.Text.Text & " " & b.Tolerance.ToleranceType)
	
	If b.Tolerance.ToleranceType = 31236 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = b.Tolerance.Upper*10
		oCells.item(i,3).value  = b.Tolerance.Lower*10
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If
If b.Tolerance.ToleranceType = 31233 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = b.Tolerance.Upper*10
		oCells.item(i,3).value  = b.Tolerance.Lower*10
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If
If b.Tolerance.ToleranceType = 31235 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = "+/-" & b.Tolerance.Upper*10
		'oCells.item(i,3).value  = "+/-" &b.Tolerance.Lower*10.ToString
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If


	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 6

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

'Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.add'.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

'oCells.item(2,1).value= b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'MsgBox (b.Text.Text & " " & b.Tolerance.ToleranceType)
	
	If b.Tolerance.ToleranceType = 31236 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = b.Tolerance.Upper*10
		oCells.item(i,3).value  = b.Tolerance.Lower*10
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If
If b.Tolerance.ToleranceType = 31233 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = b.Tolerance.Upper*10
		oCells.item(i,3).value  = b.Tolerance.Lower*10
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If
If b.Tolerance.ToleranceType = 31235 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = "+/-" & b.Tolerance.Upper*10
		'oCells.item(i,3).value  = "+/-" &b.Tolerance.Lower*10.ToString
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If


	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 7

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

'Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.add'.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

'oCells.item(2,1).value= b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'MsgBox (b.Text.Text & " " & b.Tolerance.ToleranceType)
	
	If b.Tolerance.ToleranceType = 31236 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = b.Tolerance.Upper*10
		oCells.item(i,3).value  = b.Tolerance.Lower*10
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If
If b.Tolerance.ToleranceType = 31233 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = b.Tolerance.Upper*10
		oCells.item(i,3).value  = b.Tolerance.Lower*10
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If
If b.Tolerance.ToleranceType = 31235 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = "+/-" & b.Tolerance.Upper*10
		'oCells.item(i,3).value  = "+/-" &b.Tolerance.Lower*10.ToString
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If


	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 8

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

'Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.add'.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

'oCells.item(2,1).value= b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'MsgBox (b.Text.Text & " " & b.Tolerance.ToleranceType)
	
	If b.Tolerance.ToleranceType = 31236 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = b.Tolerance.Upper*10
		oCells.item(i,3).value  = b.Tolerance.Lower*10
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If
If b.Tolerance.ToleranceType = 31233 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = b.Tolerance.Upper*10
		oCells.item(i,3).value  = b.Tolerance.Lower*10
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If
If b.Tolerance.ToleranceType = 31235 Then
		oCells.item(i,1).value = b.Text.Text
		oCells.item(i,2).value = "+/-" & b.Tolerance.Upper*10
		'oCells.item(i,3).value  = "+/-" &b.Tolerance.Lower*10.ToString
	
		oCells.item(1,1).value  = "Dimension"
		oCells.item(1,2).value = "Tolerance Upper"
		oCells.item(1,3).value = "Tolerance Lower"
		End If


	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 9

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

oCells.item(2,1).value= "sjgjsagjlk"'b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper
oCells.item(i,3).value  = b.Tolerance.Lower
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 10

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

oCells.item(2,1).value= "sjgjsagjlk"'b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper
oCells.item(i,3).value  = b.Tolerance.Lower
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 11

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

oCells.item(2,1).value= "sjgjsagjlk"'b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper
oCells.item(i,3).value  = b.Tolerance.Lower
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 12

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

oCells.item(2,1).value= "sjgjsagjlk"'b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper
oCells.item(i,3).value  = b.Tolerance.Lower
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 13

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

oCells.item(2,1).value= "sjgjsagjlk"'b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper*10
oCells.item(i,3).value  = b.Tolerance.Lower*10
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 14

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

oCells.item(2,1).value= "sjgjsagjlk"'b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper*10
oCells.item(i,3).value  = b.Tolerance.Lower*10
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 15

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

oCells.item(2,1).value= "sjgjsagjlk"'b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper*10
oCells.item(i,3).value  = b.Tolerance.Lower*10
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 16

```vb
AddReference "Microsoft.Office.Interop.Excel.dll"
Imports exe = Microsoft.Office.Interop.Excel

Dim oXLFile As String = "C:\TEMP\DrawingDimensions.xlsx"
Dim oSheet As String = "Sheet1"

Dim oExcel As New Microsoft.Office.Interop.Excel.ApplicationClass
Dim oWB As Microsoft.Office.Interop.Excel.Workbook = oExcel.Workbooks.Open(oXLFile)
Dim oWS As Microsoft.Office.Interop.Excel.Worksheet = oWB.Worksheets.Item(oSheet)

Dim oCells As Microsoft.Office.Interop.Excel.Range = oWS.Cells

oCells.item(2,1).value= "sjgjsagjlk"'b.Text.Text.ToString

Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
'	'MsgBox (b.Tolerance.Upper)
	
oCells.item(i,1).value = b.Text.Text.ToString
oCells.item(i,2).value = b.Tolerance.Upper*10
oCells.item(i,3).value  = b.Tolerance.Lower*10
	
oCells.item(1,1).value  = "Dimension"
oCells.item(1,2).value = "Tolerance Upper"
oCells.item(1,3).value = "Tolerance Lower"
'	GoExcel.Save()

	Next
	oWB.saveas("C:\TEMP\"& a.DisplayName & ".xlsx")
oWB.close
```

#### Code Block 17

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
	
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.CellValue("B" & i) = b.Tolerance.Upper
	GoExcel.CellValue("C" & i) = b.Tolerance.Lower
	
	GoExcel.CellValue("A" & 1) = "Dimension"
	GoExcel.CellValue("B" & 1) = "Tolerance Upper"
	GoExcel.CellValue("C" & 1) = "Tolerance Lower"
	GoExcel.Save

	Next
```

#### Code Block 18

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
	
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.CellValue("B" & i) = b.Tolerance.Upper
	GoExcel.CellValue("C" & i) = b.Tolerance.Lower
	
	GoExcel.CellValue("A" & 1) = "Dimension"
	GoExcel.CellValue("B" & 1) = "Tolerance Upper"
	GoExcel.CellValue("C" & 1) = "Tolerance Lower"
	GoExcel.Save

	Next
```

#### Code Block 19

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
	
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.CellValue("B" & i) = b.Tolerance.Upper
	GoExcel.CellValue("C" & i) = b.Tolerance.Lower
	
	GoExcel.CellValue("A" & 1) = "Dimension"
	GoExcel.CellValue("B" & 1) = "Tolerance Upper"
	GoExcel.CellValue("C" & 1) = "Tolerance Lower"
	GoExcel.Save

	Next
```

#### Code Block 20

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
	
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.CellValue("B" & i) = b.Tolerance.Upper
	GoExcel.CellValue("C" & i) = b.Tolerance.Lower
	
	GoExcel.CellValue("A" & 1) = "Dimension"
	GoExcel.CellValue("B" & 1) = "Tolerance Upper"
	GoExcel.CellValue("C" & 1) = "Tolerance Lower"
	GoExcel.Save

	Next
```

#### Code Block 21

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
	'MsgBox (b.Tolerance.Upper)
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.CellValue("B" & i) = b.Tolerance.Upper
	GoExcel.CellValue("C" & i) = b.Tolerance.Lower
	GoExcel.Save

	Next
```

#### Code Block 22

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
	'MsgBox (b.Tolerance.Upper)
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.CellValue("B" & i) = b.Tolerance.Upper
	GoExcel.CellValue("C" & i) = b.Tolerance.Lower
	GoExcel.Save

	Next
```

#### Code Block 23

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
	'MsgBox (b.Tolerance.Upper)
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.CellValue("B" & i) = b.Tolerance.Upper
	GoExcel.CellValue("C" & i) = b.Tolerance.Lower
	GoExcel.Save

	Next
```

#### Code Block 24

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i = i + 1
	'MsgBox (b.Tolerance.Upper)
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.CellValue("B" & i) = b.Tolerance.Upper
	GoExcel.CellValue("C" & i) = b.Tolerance.Lower
	GoExcel.Save

	Next
```

#### Code Block 25

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i=i+1
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.Save

	Next
```

#### Code Block 26

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i=i+1
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.Save

	Next
```

#### Code Block 27

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i=i+1
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.Save

	Next
```

#### Code Block 28

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i=i+1
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	GoExcel.Save

	Next
```

#### Code Block 29

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i=i+1
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	Next
```

#### Code Block 30

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i=i+1
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	Next
```

#### Code Block 31

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i=i+1
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	Next
```

#### Code Block 32

```vb
Dim a As Inventor.DrawingDocument = ThisDrawing.Document
Dim s As Inventor.Sheet = a.ActiveSheet


Dim i As Integer = 1
For Each b As Inventor.DrawingDimension In s.DrawingDimensions
	i=i+1
	GoExcel.CellValue("C:\TEMP\DrawingDimensions.xlsx", "Sheet1", "A" & i) = b.Text.Text.ToString
	Next
```

---

### 15. Have the sheet name automatically generate in Title block

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/have-the-sheet-name-automatically-generate-in-title-block/td-p/10784336#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/have-the-sheet-name-automatically-generate-in-title-block/td-p/10784336#messageview_0)

**Author:** BrandonLee_Innovex

**Date:** ‎11-26-2021
	
		
		12:06 PM

**Description:** I am trying to have my title block sheet name automatically populated once the sheet name has been set.  For example, the image i have attached shows the sheet names we type in, but our current process requires us to type in the sheet name multiple times to appear both in the sidebar shown as well a...

**Code Snippets (4):**

#### Code Block 1

```vb
Dim doc As DrawingDocument = ThisDoc.Document
Dim sheet As Sheet = doc.ActiveSheet
Dim titleBlock As TitleBlock = sheet.TitleBlock

Dim textBox As Inventor.TextBox = titleBlock.Definition.Sketch.TextBoxes.
        Cast(Of Inventor.TextBox).
        Where(Function(tb) tb.FormattedText.Contains("<Prompt")).
        Where(Function(tb) tb.FormattedText.Contains("SHEET DESCRIPTION")).
        FirstOrDefault()
If (textBox Is Nothing) Then Throw New Exception("Promted entry not found.")

Dim sheetDescription = sheet.Name
Dim puntPlace = InStr(sheetDescription, ":") - 1
sheetDescription = sheetDescription.Substring(0, puntPlace)
titleBlock.SetPromptResultText(textBox, sheetDescription)
```

#### Code Block 2

```vb
Dim doc As DrawingDocument = ThisDoc.Document
Dim sheet As Sheet = doc.ActiveSheet
Dim titleBlock As TitleBlock = sheet.TitleBlock

Dim textBox As Inventor.TextBox = titleBlock.Definition.Sketch.TextBoxes.
        Cast(Of Inventor.TextBox).
        Where(Function(tb) tb.FormattedText.Contains("<Prompt")).
        Where(Function(tb) tb.FormattedText.Contains("SHEET DESCRIPTION")).
        FirstOrDefault()
If (textBox Is Nothing) Then Throw New Exception("Promted entry not found.")

Dim sheetDescription = sheet.Name
Dim puntPlace = InStr(sheetDescription, ":") - 1
sheetDescription = sheetDescription.Substring(0, puntPlace)
titleBlock.SetPromptResultText(textBox, sheetDescription)
```

#### Code Block 3

```vb
Dim doc As DrawingDocument = ThisDoc.Document
Dim sheet As Sheet = doc.ActiveSheet
Dim titleBlock As TitleBlock = sheet.TitleBlock

Dim textBox As Inventor.TextBox = titleBlock.Definition.Sketch.TextBoxes.
        Cast(Of Inventor.TextBox).
        Where(Function(tb) tb.FormattedText.Contains("<Prompt")).
        Where(Function(tb) tb.FormattedText.Contains("SHEET DESCRIPTION")).
        FirstOrDefault()
If (textBox Is Nothing) Then Throw New Exception("Promted entry not found.")
titleBlock.SetPromptResultText(textBox, sheet.Name)
```

#### Code Block 4

```vb
Dim doc As DrawingDocument = ThisDoc.Document
Dim sheet As Sheet = doc.ActiveSheet
Dim titleBlock As TitleBlock = sheet.TitleBlock

Dim textBox As Inventor.TextBox = titleBlock.Definition.Sketch.TextBoxes.
        Cast(Of Inventor.TextBox).
        Where(Function(tb) tb.FormattedText.Contains("<Prompt")).
        Where(Function(tb) tb.FormattedText.Contains("SHEET DESCRIPTION")).
        FirstOrDefault()
If (textBox Is Nothing) Then Throw New Exception("Promted entry not found.")
titleBlock.SetPromptResultText(textBox, sheet.Name)
```

#### Code Block 5

```vb
Dim doc As DrawingDocument = ThisDoc.Document
For Each sheet As Sheet In doc.Sheets
    Dim titleBlock As TitleBlock = Sheet.TitleBlock

    ' Find the textbox within the title block's sketch that contains the prompt markers
    Dim textBox As Inventor.TextBox = titleBlock.Definition.Sketch.TextBoxes _
        .Cast(Of Inventor.TextBox)() _
        .Where(Function(tb) tb.FormattedText.Contains("<Prompt") AndAlso tb.FormattedText.Contains("SHEET TITLE")) _
        .FirstOrDefault()

    If (textBox Is Nothing) Then
        MsgBox("Prompted entry not found on sheet: " & Sheet.Name)
        Continue For
    End If

    ' Extract the sheet description; here, trimming after colon
    Dim sheetDescription As String = Sheet.Name
    Dim puntPlace As Integer = InStr(sheetDescription, ":")
    If puntPlace > 0 Then
        sheetDescription = sheetDescription.Substring(0, puntPlace - 1)
    End If

    ' Set the prompt result text in the title block
    titleBlock.SetPromptResultText(textBox, sheetDescription)
Next
```

#### Code Block 6

```vb
Dim doc As DrawingDocument = ThisDoc.Document
For Each sheet As Sheet In doc.Sheets
    Dim titleBlock As TitleBlock = Sheet.TitleBlock

    ' Find the textbox within the title block's sketch that contains the prompt markers
    Dim textBox As Inventor.TextBox = titleBlock.Definition.Sketch.TextBoxes _
        .Cast(Of Inventor.TextBox)() _
        .Where(Function(tb) tb.FormattedText.Contains("<Prompt") AndAlso tb.FormattedText.Contains("SHEET TITLE")) _
        .FirstOrDefault()

    If (textBox Is Nothing) Then
        MsgBox("Prompted entry not found on sheet: " & Sheet.Name)
        Continue For
    End If

    ' Extract the sheet description; here, trimming after colon
    Dim sheetDescription As String = Sheet.Name
    Dim puntPlace As Integer = InStr(sheetDescription, ":")
    If puntPlace > 0 Then
        sheetDescription = sheetDescription.Substring(0, puntPlace - 1)
    End If

    ' Set the prompt result text in the title block
    titleBlock.SetPromptResultText(textBox, sheetDescription)
Next
```

#### Code Block 7

```vb
Dim doc As DrawingDocument = ThisDoc.Document
For Each sheet As Sheet In doc.Sheets
    Dim titleBlock As TitleBlock = Sheet.TitleBlock

    Dim textBox As Inventor.TextBox = titleBlock.Definition.Sketch.TextBoxes.
	    Cast(Of Inventor.TextBox).
	    Where(Function(tb) tb.FormattedText.Contains("<Prompt")).
	    Where(Function(tb) tb.FormattedText.Contains("SHEET DESCRIPTION")).
	    FirstOrDefault()
    If (textBox Is Nothing) Then 
		MsgBox("Promted entry not found on sheet: " & Sheet.Name)
		continue for
	End If

    Dim sheetDescription = Sheet.Name
    Dim puntPlace = InStr(sheetDescription, ":") - 1
    sheetDescription = sheetDescription.Substring(0, puntPlace)
    titleBlock.SetPromptResultText(textBox, sheetDescription)
Next
```

#### Code Block 8

```vb
Dim doc As DrawingDocument = ThisDoc.Document
For Each sheet As Sheet In doc.Sheets
    Dim titleBlock As TitleBlock = Sheet.TitleBlock

    Dim textBox As Inventor.TextBox = titleBlock.Definition.Sketch.TextBoxes.
	    Cast(Of Inventor.TextBox).
	    Where(Function(tb) tb.FormattedText.Contains("<Prompt")).
	    Where(Function(tb) tb.FormattedText.Contains("SHEET DESCRIPTION")).
	    FirstOrDefault()
    If (textBox Is Nothing) Then 
		MsgBox("Promted entry not found on sheet: " & Sheet.Name)
		continue for
	End If

    Dim sheetDescription = Sheet.Name
    Dim puntPlace = InStr(sheetDescription, ":") - 1
    sheetDescription = sheetDescription.Substring(0, puntPlace)
    titleBlock.SetPromptResultText(textBox, sheetDescription)
Next
```

---

### 16. How to &quot;Show All&quot; in a part document with iLogic?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-quot-show-all-quot-in-a-part-document-with-ilogic/td-p/13832701#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-quot-show-all-quot-in-a-part-document-with-ilogic/td-p/13832701#messageview_0)

**Author:** acheungR3ZK5

**Date:** ‎10-01-2025
	
		
		04:46 AM

**Description:** How do I call the "Show All" command (shown in screenshot) in a part document with iLogic? I know how to loop through all the parts and make them visible if not visible, but it takes longer if there are many parts and you can't undo the whole command in one undo.   					 				 			 			 				 			 			 		...

**Code Snippets (8):**

#### Code Block 1

```vb
Dim oApp As Inventor.Application = ThisApplication
Dim oPDoc As PartDocument = oApp.ActiveDocument
Dim oSBColl As ObjectCollection = oApp.TransientObjects.CreateObjectCollection()
For Each oSB As SurfaceBody In oPDoc.ComponentDefinition.SurfaceBodies
    oSBColl.Add(oSB)
Next
oPDoc.SelectSet.Clear()
oPDoc.SelectSet.SelectMultiple(oSBColl)
oApp.CommandManager.ControlDefinitions.Item("PartVisibilityCtxCmd").Execute()
```

#### Code Block 2

```vb
Dim oApp As Inventor.Application = ThisApplication
Dim oPDoc As PartDocument = oApp.ActiveDocument
Dim oSBColl As ObjectCollection = oApp.TransientObjects.CreateObjectCollection()
For Each oSB As SurfaceBody In oPDoc.ComponentDefinition.SurfaceBodies
    oSBColl.Add(oSB)
Next
oPDoc.SelectSet.Clear()
oPDoc.SelectSet.SelectMultiple(oSBColl)
oApp.CommandManager.ControlDefinitions.Item("PartVisibilityCtxCmd").Execute()
```

#### Code Block 3

```vb
Dim oApp As Inventor.Application = ThisApplication
Dim oPDoc As PartDocument = oApp.ActiveDocument
Dim oSBColl As ObjectCollection = oApp.TransientObjects.CreateObjectCollection()
For Each oSB As SurfaceBody In oPDoc.ComponentDefinition.SurfaceBodies
    oSBColl.Add(oSB)
Next
oPDoc.SelectSet.Clear()
oPDoc.SelectSet.SelectMultiple(oSBColl)
oApp.CommandManager.ControlDefinitions.Item("PartVisibilityCtxCmd").Execute()
```

#### Code Block 4

```vb
Dim oApp As Inventor.Application = ThisApplication
Dim oPDoc As PartDocument = oApp.ActiveDocument
Dim oSBColl As ObjectCollection = oApp.TransientObjects.CreateObjectCollection()
For Each oSB As SurfaceBody In oPDoc.ComponentDefinition.SurfaceBodies
    oSBColl.Add(oSB)
Next
oPDoc.SelectSet.Clear()
oPDoc.SelectSet.SelectMultiple(oSBColl)
oApp.CommandManager.ControlDefinitions.Item("PartVisibilityCtxCmd").Execute()
```

#### Code Block 5

```vb
Dim partDoc As PartDocument
partDoc = ThisApplication.ActiveDocument

Dim compDef As PartComponentDefinition
compDef = partDoc.ComponentDefinition

Dim activeViewRep As DesignViewRepresentation = compDef.RepresentationsManager.ActiveDesignViewRepresentation
activeViewRep.ShowAll
```

#### Code Block 6

```vb
Dim partDoc As PartDocument
partDoc = ThisApplication.ActiveDocument

Dim compDef As PartComponentDefinition
compDef = partDoc.ComponentDefinition

Dim activeViewRep As DesignViewRepresentation = compDef.RepresentationsManager.ActiveDesignViewRepresentation
activeViewRep.ShowAll
```

#### Code Block 7

```vb
Dim partDoc As PartDocument
partDoc = ThisApplication.ActiveDocument

Dim compDef As PartComponentDefinition
compDef = partDoc.ComponentDefinition

Dim activeViewRep As DesignViewRepresentation = compDef.RepresentationsManager.ActiveDesignViewRepresentation
activeViewRep.ShowAll
```

#### Code Block 8

```vb
Dim partDoc As PartDocument
partDoc = ThisApplication.ActiveDocument

Dim compDef As PartComponentDefinition
compDef = partDoc.ComponentDefinition

Dim activeViewRep As DesignViewRepresentation = compDef.RepresentationsManager.ActiveDesignViewRepresentation
activeViewRep.ShowAll
```

#### Code Block 9

```vb
ThisApplication.CommandManager.ControlDefinitions.Item("HideOtherBodiesCtxCmd").Execute()
```

#### Code Block 10

```vb
ThisApplication.CommandManager.ControlDefinitions.Item("HideOtherBodiesCtxCmd").Execute()
```

#### Code Block 11

```vb
ThisApplication.CommandManager.ControlDefinitions.Item("HideOtherBodiesCtxCmd").Execute()
```

#### Code Block 12

```vb
ThisApplication.CommandManager.ControlDefinitions.Item("HideOtherBodiesCtxCmd").Execute()
```

#### Code Block 13

```vb
ThisApplication.CommandManager.ControlDefinitions.Item("ShowAllBodiesCtxCmd").Execute()
```

#### Code Block 14

```vb
ThisApplication.CommandManager.ControlDefinitions.Item("ShowAllBodiesCtxCmd").Execute()
```

#### Code Block 15

```vb
ThisApplication.CommandManager.ControlDefinitions.Item("ShowAllBodiesCtxCmd").Execute()
```

#### Code Block 16

```vb
ThisApplication.CommandManager.ControlDefinitions.Item("ShowAllBodiesCtxCmd").Execute()
```

---

### 17. How to determine a simplified part via iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-determine-a-simplified-part-via-ilogic/td-p/13750575](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-determine-a-simplified-part-via-ilogic/td-p/13750575)

**Author:** dnguyennn

**Date:** ‎08-01-2025
	
		
		03:12 PM

**Description:** Is there a way to better determine a part is a simplified part in iLogic and VBA?except the string "Simplify" in the name and the activedoc is a PartDocumentI also found get ShrinkwrapComponents count is also kinda work?If oDef.ReferenceComponents.ShrinkwrapComponents.Count > 0 Then     isSimplified...

**Code Snippets (2):**

#### Code Block 1

```vb
If oDef.ReferenceComponents.ShrinkwrapComponents.Count > 0 Then
    isSimplified = True
End If
```

#### Code Block 2

```vb
If oDef.ReferenceComponents.ShrinkwrapComponents.Count > 0 Then
    isSimplified = True
End If
```

---

### 18. How to refresh/open the projects window VBA

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-refresh-open-the-projects-window-vba/td-p/13725927#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-refresh-open-the-projects-window-vba/td-p/13725927#messageview_0)

**Author:** gablewatson44

**Date:** ‎07-15-2025
	
		
		07:37 AM

**Description:** Currently using inventor 2024, i have written a macro that automatically creates a workgroup path based on the file location of whatever is opened. I am using a work around with Sendkeys that quickly opens and closes the project window using a custom shortcut:' Type P, R, O then EscapeSendKeys "P", ...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim oControlDef As ControlDefinition
        
Set oControlDef = ThisApplication.CommandManager.ControlDefinitions.Item("AppProjectsCmd")
        
Call oControlDef.Execute
```

#### Code Block 2

```vb
Dim oControlDef As ControlDefinition
        
Set oControlDef = ThisApplication.CommandManager.ControlDefinitions.Item("AppProjectsCmd")
        
Call oControlDef.Execute
```

#### Code Block 3

```vb
Dim oControlDef As ControlDefinition
        
Set oControlDef = ThisApplication.CommandManager.ControlDefinitions.Item("AppProjectsCmd")
        
Call oControlDef.Execute
```

#### Code Block 4

```vb
Dim oControlDef As ControlDefinition
        
Set oControlDef = ThisApplication.CommandManager.ControlDefinitions.Item("AppProjectsCmd")
        
Call oControlDef.Execute
```

---

### 19. Ilogic split a string

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-split-a-string/td-p/8777436](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-split-a-string/td-p/8777436)

**Author:** Anonymous

**Date:** ‎05-08-2019
	
		
		12:20 AM

**Description:** Goodday, I am searching for a way to split strings. Where: Dim Separators() As Char = {";"}  Doesnt seem to work at my code.   As you see in the code the separator is-> ; for example, if the string is 1;2, it must be separated into 1 and 2 given to 2 parameters, so spot1 -> "1" and spot2 -> "2" This...

**Code Snippets (13):**

#### Code Block 1

```vb
Dim Sentence As String = "XX.YY.ZZZZ-R0 PROJECT DESCRIPTION"
Dim Separators() As Char = {".", "-", " " }
Dim Words() As String = Sentence.Split(Separators)
Dim Word1 As String = Words(0)
Dim Word2 As String = Words(1)
Dim Word3 As String = Words(2)
Dim Word4 As String = Words(3)
Dim Word5 As String = Words(4)
Dim Word6 As String = Words(5)
MsgBox("Word1 = " & Word1 & _
vbCrLf & "Word2 = " & Word2 & _
vbCrLf & "Word3 = " & Word3 & _
vbCrLf & "Word4 = " & Word4 & _
vbCrLf & "Word5 = " & Word5 & _
vbCrLf & "Word6 = " & Word6, vbInformation, "Sentence Split Into Words")
```

#### Code Block 2

```vb
Dim Sentence As String = "XX.YY.ZZZZ-R0 PROJECT DESCRIPTION"
Dim Separators() As Char = {".", "-", " " }
Dim Words() As String = Sentence.Split(Separators)
Dim Word1 As String = Words(0)
Dim Word2 As String = Words(1)
Dim Word3 As String = Words(2)
Dim Word4 As String = Words(3)
Dim Word5 As String = Words(4)
Dim Word6 As String = Words(5)
MsgBox("Word1 = " & Word1 & _
vbCrLf & "Word2 = " & Word2 & _
vbCrLf & "Word3 = " & Word3 & _
vbCrLf & "Word4 = " & Word4 & _
vbCrLf & "Word5 = " & Word5 & _
vbCrLf & "Word6 = " & Word6, vbInformation, "Sentence Split Into Words")
```

#### Code Block 3

```vb
Dim Sentence As String = "XX.YY.ZZZZ-R0 PROJECT DESCRIPTION"
Dim Words() As String = Sentence.Split({".", "-", " " },StringSplitOptions.RemoveEmptyEntries)
Dim sResults As String
For i As Integer = 0 To Words.Length - 1
	sResults &= "Word " & i & " = " & Words(i) & vbCrLf
Next
MsgBox(sResults, vbInformation, "Sentence Split Into Words")
```

#### Code Block 4

```vb
Dim Sentence As String = "XX.YY.ZZZZ-R0 PROJECT DESCRIPTION"
Dim Words() As String = Sentence.Split({".", "-", " " },StringSplitOptions.RemoveEmptyEntries)
Dim sResults As String
For i As Integer = 0 To Words.Length - 1
	sResults &= "Word " & i & " = " & Words(i) & vbCrLf
Next
MsgBox(sResults, vbInformation, "Sentence Split Into Words")
```

#### Code Block 5

```vb
Dim Sentence As String = "XX.YY.ZZZZ-R0 PROJECT DESCRIPTION"
Dim Words() As String = Sentence.Split({".", "-", " " },StringSplitOptions.RemoveEmptyEntries)
Dim sResults As String
For i As Integer = 0 To Words.Length - 1
	sResults &= "Word " & i & " = " & Words(i) & vbCrLf
Next
MsgBox(sResults, vbInformation, "Sentence Split Into Words")
```

#### Code Block 6

```vb
Dim Sentence As String = "XX.YY.ZZZZ-R0 PROJECT DESCRIPTION"
Dim Words() As String = Sentence.Split({".", "-", " " },StringSplitOptions.RemoveEmptyEntries)
Dim sResults As String
For i As Integer = 0 To Words.Length - 1
	sResults &= "Word " & i & " = " & Words(i) & vbCrLf
Next
MsgBox(sResults, vbInformation, "Sentence Split Into Words")
```

#### Code Block 7

```vb
Dim Separators() As Char = {";",vbCrLf} Sentence = "1" & vbCrLf & "2" & vbCrLf & "3" & vbCrLf & "4" & vbCrLf & "5"
Words = Sentence.Split(Separators)
i = 0
For Each wrd In Words
MessageBox.Show("Word Index #" & i & " = " & Words(i))
i=i+1
Next
```

#### Code Block 8

```vb
Dim Separators() As Char = {";",vbCrLf} Sentence = "1" & vbCrLf & "2" & vbCrLf & "3" & vbCrLf & "4" & vbCrLf & "5"
Words = Sentence.Split(Separators)
i = 0
For Each wrd In Words
MessageBox.Show("Word Index #" & i & " = " & Words(i))
i=i+1
Next
```

#### Code Block 9

```vb
Dim Separators() As Char = {";"}
```

#### Code Block 10

```vb
Dim Separators() As Char = {";"}
```

#### Code Block 11

```vb
Dim Separators() As Char = {";"} 
Sentence = "10;20;3;4;5"
Words = Sentence.Split(Separators)

spot1 = Words(0)
spot2 = Words(1)

Parameter.UpdateAfterChange = True
iLogicVb.UpdateWhenDone = True
```

#### Code Block 12

```vb
Dim Separators() As Char = {";"} 
Sentence = "10;20;3;4;5"
Words = Sentence.Split(Separators)

spot1 = Words(0)
spot2 = Words(1)

Parameter.UpdateAfterChange = True
iLogicVb.UpdateWhenDone = True
```

#### Code Block 13

```vb
Dim Separators() As Char = {";"} 
Sentence = "1;2;3;4;5"
Words = Sentence.Split(Separators)
i = 0
For Each wrd In Words
MessageBox.Show("Word Index #" & i & " = " & Words(i))
i=i+1
Next
```

#### Code Block 14

```vb
Dim Separators() As Char = {";"} 
Sentence = "1;2;3;4;5"
Words = Sentence.Split(Separators)
i = 0
For Each wrd In Words
MessageBox.Show("Word Index #" & i & " = " & Words(i))
i=i+1
Next
```

#### Code Block 15

```vb
Dim Separators() As Char = {";"} 
Sentence = StringParameter
If Sentence = "1;1" Then
Words = Sentence.Split(Separators)
spot1 = Words(0)
spot2 = Words(1)
Parameter.UpdateAfterChange = True
iLogicVb.UpdateWhenDone = True
Else If Sentence = "1;5;7" Then
Words = Sentence.Split(Separators)
spot1 = Words(0)
spot2 = Words(1)
spot3 = Words(2)
Parameter.UpdateAfterChange = True
iLogicVb.UpdateWhenDone = True
End If 
InventorVb.DocumentUpdate()
```

#### Code Block 16

```vb
Dim Separators() As Char = {";"} 
Sentence = StringParameter
If Sentence = "1;1" Then
Words = Sentence.Split(Separators)
spot1 = Words(0)
spot2 = Words(1)
Parameter.UpdateAfterChange = True
iLogicVb.UpdateWhenDone = True
Else If Sentence = "1;5;7" Then
Words = Sentence.Split(Separators)
spot1 = Words(0)
spot2 = Words(1)
spot3 = Words(2)
Parameter.UpdateAfterChange = True
iLogicVb.UpdateWhenDone = True
End If 
InventorVb.DocumentUpdate()
```

#### Code Block 17

```vb
Parameter.UpdateAfterChange = True
iLogicVb.UpdateWhenDone = True
```

#### Code Block 18

```vb
Parameter.UpdateAfterChange = True
iLogicVb.UpdateWhenDone = True
```

#### Code Block 19

```vb
Sentence = "1" & vbCrLf & "2" & vbCrLf & "3" & vbCrLf & "4" & vbCrLf & "5"
Words = Sentence.Split(vbCrLf)

For Each wrd In Words
	'strip out carraige returns & linefeeds
	wrd = wrd.Replace(vbCr, "").Replace(vbLf, "")
	MessageBox.Show("Word Index #" & i & " = " & wrd)
Next
```

#### Code Block 20

```vb
Sentence = "1" & vbCrLf & "2" & vbCrLf & "3" & vbCrLf & "4" & vbCrLf & "5"
Words = Sentence.Split(vbCrLf)

For Each wrd In Words
	'strip out carraige returns & linefeeds
	wrd = wrd.Replace(vbCr, "").Replace(vbLf, "")
	MessageBox.Show("Word Index #" & i & " = " & wrd)
Next
```

#### Code Block 21

```vb
Sentence = "1" & vbCrLf & "2" & vbCrLf & "3" & vbCrLf & "4" & vbCrLf & "5"
Words = Sentence.Split(vbCrLf)

For Each wrd In Words
	'strip out carraige returns & linefeeds
	wrd = wrd.Replace(vbCr, "").Replace(vbLf, "")
	MessageBox.Show("Word Index #" & i & " = " & wrd)
Next
```

#### Code Block 22

```vb
Sentence = "1" & vbCrLf & "2" & vbCrLf & "3" & vbCrLf & "4" & vbCrLf & "5"
Words = Sentence.Split(vbCrLf)

For Each wrd In Words
	'strip out carraige returns & linefeeds
	wrd = wrd.Replace(vbCr, "").Replace(vbLf, "")
	MessageBox.Show("Word Index #" & i & " = " & wrd)
Next
```

#### Code Block 23

```vb
Sentence = "XX.YY.ZZZZ-R0 PROJECT DESCRIPTION"
```

#### Code Block 24

```vb
Sentence = "XX.YY.ZZZZ-R0 PROJECT DESCRIPTION"
```

#### Code Block 25

```vb
Sentence = "XX.YY.ZZZZ-R0 PROJECT DESCRIPTION"
```

#### Code Block 26

```vb
Sentence = "XX.YY.ZZZZ-R0 PROJECT DESCRIPTION"
```

---

### 20. Inventor 2026 Inventor Application, GetActiveObject is not a member of Marshal

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/inventor-2026-inventor-application-getactiveobject-is-not-a/td-p/13830311#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/inventor-2026-inventor-application-getactiveobject-is-not-a/td-p/13830311#messageview_0)

**Author:** A.Acheson

**Date:** ‎09-29-2025
	
		
		02:31 PM

**Description:** I am having trouble converting a VB.Net form designed to run in the ilogic environment. Error on Line 56 : 'GetActiveObject' is not a member of 'Marshal'. I am not using visual studio so have no access to how the application object is created.  Try  	_invApp = Marshal.GetActiveObject("Inventor.Appli...

**Code Snippets (16):**

#### Code Block 1

```vb
' This method is called by Inventor when it loads the AddIn. The AddInSiteObject provides access  
        ' to the Inventor Application object. The FirstTime flag indicates if the AddIn is loaded for
        ' the first time. However, with the introduction of the ribbon this argument is always true.
        Public Sub Activate(ByVal addInSiteObject As Inventor.ApplicationAddInSite, ByVal firstTime As Boolean) Implements Inventor.ApplicationAddInServer.Activate
            ' Initialize AddIn members.
            g_inventorApplication = addInSiteObject.Application

            ' Connect to the user-interface events to handle a ribbon reset.
            m_uiEvents = g_inventorApplication.UserInterfaceManager.UserInterfaceEvents

            ' TODO: Add button definitions.

            ' Sample to illustrate creating a button definition.
			'Dim largeIcon As stdole.IPictureDisp = PictureDispConverter.ToIPictureDisp(My.Resources.YourBigImage)
			'Dim smallIcon As stdole.IPictureDisp = PictureDispConverter.ToIPictureDisp(My.Resources.YourSmallImage)
            'Dim controlDefs As Inventor.ControlDefinitions = g_inventorApplication.CommandManager.ControlDefinitions
            'm_sampleButton = controlDefs.AddButtonDefinition("Command Name", "Internal Name", CommandTypesEnum.kShapeEditCmdType, AddInClientID)

            ' Add to the user interface, if it's the first time.
            If firstTime Then
                AddToUserInterface()
            End If
        End Sub
```

#### Code Block 2

```vb
' This method is called by Inventor when it loads the AddIn. The AddInSiteObject provides access  
        ' to the Inventor Application object. The FirstTime flag indicates if the AddIn is loaded for
        ' the first time. However, with the introduction of the ribbon this argument is always true.
        Public Sub Activate(ByVal addInSiteObject As Inventor.ApplicationAddInSite, ByVal firstTime As Boolean) Implements Inventor.ApplicationAddInServer.Activate
            ' Initialize AddIn members.
            g_inventorApplication = addInSiteObject.Application

            ' Connect to the user-interface events to handle a ribbon reset.
            m_uiEvents = g_inventorApplication.UserInterfaceManager.UserInterfaceEvents

            ' TODO: Add button definitions.

            ' Sample to illustrate creating a button definition.
			'Dim largeIcon As stdole.IPictureDisp = PictureDispConverter.ToIPictureDisp(My.Resources.YourBigImage)
			'Dim smallIcon As stdole.IPictureDisp = PictureDispConverter.ToIPictureDisp(My.Resources.YourSmallImage)
            'Dim controlDefs As Inventor.ControlDefinitions = g_inventorApplication.CommandManager.ControlDefinitions
            'm_sampleButton = controlDefs.AddButtonDefinition("Command Name", "Internal Name", CommandTypesEnum.kShapeEditCmdType, AddInClientID)

            ' Add to the user interface, if it's the first time.
            If firstTime Then
                AddToUserInterface()
            End If
        End Sub
```

#### Code Block 3

```vb
' This method is called by Inventor when it loads the AddIn. The AddInSiteObject provides access  
        ' to the Inventor Application object. The FirstTime flag indicates if the AddIn is loaded for
        ' the first time. However, with the introduction of the ribbon this argument is always true.
        Public Sub Activate(ByVal addInSiteObject As Inventor.ApplicationAddInSite, ByVal firstTime As Boolean) Implements Inventor.ApplicationAddInServer.Activate
            ' Initialize AddIn members.
            g_inventorApplication = addInSiteObject.Application

            ' Connect to the user-interface events to handle a ribbon reset.
            m_uiEvents = g_inventorApplication.UserInterfaceManager.UserInterfaceEvents

            ' TODO: Add button definitions.

            ' Sample to illustrate creating a button definition.
			'Dim largeIcon As stdole.IPictureDisp = PictureDispConverter.ToIPictureDisp(My.Resources.YourBigImage)
			'Dim smallIcon As stdole.IPictureDisp = PictureDispConverter.ToIPictureDisp(My.Resources.YourSmallImage)
            'Dim controlDefs As Inventor.ControlDefinitions = g_inventorApplication.CommandManager.ControlDefinitions
            'm_sampleButton = controlDefs.AddButtonDefinition("Command Name", "Internal Name", CommandTypesEnum.kShapeEditCmdType, AddInClientID)

            ' Add to the user interface, if it's the first time.
            If firstTime Then
                AddToUserInterface()
            End If
        End Sub
```

#### Code Block 4

```vb
' This method is called by Inventor when it loads the AddIn. The AddInSiteObject provides access  
        ' to the Inventor Application object. The FirstTime flag indicates if the AddIn is loaded for
        ' the first time. However, with the introduction of the ribbon this argument is always true.
        Public Sub Activate(ByVal addInSiteObject As Inventor.ApplicationAddInSite, ByVal firstTime As Boolean) Implements Inventor.ApplicationAddInServer.Activate
            ' Initialize AddIn members.
            g_inventorApplication = addInSiteObject.Application

            ' Connect to the user-interface events to handle a ribbon reset.
            m_uiEvents = g_inventorApplication.UserInterfaceManager.UserInterfaceEvents

            ' TODO: Add button definitions.

            ' Sample to illustrate creating a button definition.
			'Dim largeIcon As stdole.IPictureDisp = PictureDispConverter.ToIPictureDisp(My.Resources.YourBigImage)
			'Dim smallIcon As stdole.IPictureDisp = PictureDispConverter.ToIPictureDisp(My.Resources.YourSmallImage)
            'Dim controlDefs As Inventor.ControlDefinitions = g_inventorApplication.CommandManager.ControlDefinitions
            'm_sampleButton = controlDefs.AddButtonDefinition("Command Name", "Internal Name", CommandTypesEnum.kShapeEditCmdType, AddInClientID)

            ' Add to the user interface, if it's the first time.
            If firstTime Then
                AddToUserInterface()
            End If
        End Sub
```

#### Code Block 5

```vb
Option Explicit On
AddReference "System.Drawing"
Imports System.Windows.Forms
Imports System.Drawing
```

#### Code Block 6

```vb
Option Explicit On
AddReference "System.Drawing"
Imports System.Windows.Forms
Imports System.Drawing
```

#### Code Block 7

```vb
Option Explicit On
AddReference "System.Drawing"
Imports System.Windows.Forms
Imports System.Drawing
```

#### Code Block 8

```vb
Option Explicit On
AddReference "System.Drawing"
Imports System.Windows.Forms
Imports System.Drawing
```

#### Code Block 9

```vb
Option Explicit On
AddReference "System.Drawing"
Imports System.Windows.Forms
Imports System.Drawing
 

 

 Class WinForm
	
	Inherits System.Windows.Forms.Form

	Public oArial10 As System.Drawing.Font = New Font("Arial", 10)
	Public oArial12Bold As System.Drawing.Font = New Font("Arial", 10, FontStyle.Bold)
	Public oArial12BoldUnderLined As System.Drawing.Font = New Font("Arial", 12, FontStyle.Underline)
	Public oDrawDoc As DrawingDocument 
	'Public  thisApp As Inventor.Application=ThisApplication
	Public Sub New(thisApp As Inventor.Application)
		oDrawDoc = thisApp.ActiveDocument
		Dim oForm As System.Windows.Forms.Form = Me
		With oForm
			.FormBorderStyle = FormBorderStyle.FixedToolWindow
			.StartPosition = FormStartPosition.CenterScreen
			
			 'Location = New System.Drawing.Point(0, 0)
			.StartPosition = FormStartPosition.Manual
			.Location = New System.Drawing.Point(oForm.Location.X +oForm.Width*4 , _ 
      										oForm.Location.Y+ oForm.Height*1)		  
			.Width = 450
			.Height = 350
			.TopMost = True
			.Font = oArial10
			.Text = "Revision Changes"
			.Name = "Revision Changes"
			.ShowInTaskbar = False
		End With
	
		'[Rev Selection Type
		Dim oRevSelTypeBoxLabel As New System.Windows.Forms.Label
		With oRevSelTypeBoxLabel
			.Text = "Rev Selection Type"
			.Font = oArial12Bold
			.Top = 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oRevSelTypeBoxLabel)
		Dim oRevSelTypeBox As New ComboBox()
		Dim oRevSelTypeList() As String = {"New Rev", "Update Existing"} 

		With oRevSelTypeBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oRevSelTypeList)
			.SelectedIndex = 1
			.Top = oRevSelTypeBoxLabel.Bottom + 1
			.Left = 25
			.Width = 150
			.Name = "Rev Selection Type"
		End With	
		oForm.Controls.Add(oRevSelTypeBox)
			']
		
		'[Designer
		Dim oDesignerBoxLabel As New System.Windows.Forms.Label
		With oDesignerBoxLabel
			.Text = "Designed By"
			.Font = oArial12Bold
			.Top = oRevSelTypeBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oDesignerBoxLabel)
		Dim oDesignerBox As New ComboBox()
		Dim oDesignerList() As String = {"AA","BB"}
		With oDesignerBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oDesignerList)
			.SelectedIndex = 0 'Index of default selection
			.Top = oDesignerBoxLabel.Bottom + 1
			.Left = 25
			.Width = 50
			.Name = "DesignerBox"
		End With	
		oForm.Controls.Add(oDesignerBox)
			']
		'[Description
		Dim oDescriptionBoxLabel As New System.Windows.Forms.Label
		With oDescriptionBoxLabel
			.Text = "Description"
			.Font = oArial12Bold
			.Top = oDesignerBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 100
		End With
		oForm.Controls.Add(oDescriptionBoxLabel)
		Dim oDescriptionBox As New ComboBox()
		Dim oDescriptionList() As String = {"RELEASE TO PRODUCTION","BB"}
		With oDescriptionBox
			.DropDownStyle = ComboBoxStyle.DropDown
			.Items.Clear()
			.Items.AddRange(oDescriptionList)
			.SelectedIndex = 1
			.Top = oDescriptionBoxLabel.Bottom + 1
			.Left = 25
			.Width = 300
			.Height = 25
			.Name = "DescriptionBox"
		End With	
		oForm.Controls.Add(oDescriptionBox)
			']
			
		'[Approved
		Dim oApprovedBoxLabel As New System.Windows.Forms.Label
		With oApprovedBoxLabel
			.Text = "Approved By"
			.Font = oArial12Bold
			.Top = oDescriptionBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 160
		End With
		oForm.Controls.Add(oApprovedBoxLabel)
		Dim oApprovedBox As New ComboBox()
		Dim oApprovedList() As String = {"AA","BB","CC","DD"}
		With oApprovedBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oApprovedList)
			.SelectedIndex = 1
			.Top = oApprovedBoxLabel.Bottom + 1
			.Left = 25
			.Width = 60
			.Name = "ApprovedBox"
		End With	
		oForm.Controls.Add(oApprovedBox)
		']

		Dim oStartButton As New Button()
		With oStartButton
			.Text = "APPLY"
			.Top = oApprovedBox.Bottom + 10
			.Left = 25
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "StartBox"
		End With
		oForm.AcceptButton = oStartButton
		oForm.Controls.Add(oStartButton)
		AddHandler oStartButton.Click, AddressOf oStartButton_Click
		Dim oCancelButton As New Button
		With oCancelButton
			.Text = "CANCEL"
			.Top = oStartButton.Top
			.Left = oStartButton.Right + 10
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "CancelButton"
		End With
		oForm.CancelButton = oCancelButton
		oForm.Controls.Add(oCancelButton)
		AddHandler oCancelButton.Click, AddressOf oCancelButton_Click
	End Sub

	'Populate the values from the form
	Public Sub oStartButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	
		Dim Choice As String = Me.Controls.Item("Rev Selection Type").Text
		Dim oArray2 As String =  Me.Controls.Item("DesignerBox").Text
		Dim oArray4 As String = Me.Controls.Item("DescriptionBox").Text
		Dim oArray5 As String = Me.Controls.Item("ApprovedBox").Text
		MessageBox.Show("Here", "Title")
		MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
		Me.Close
End Sub



Public Sub oCancelButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	Me.Close
End Sub


		
End Class

Sub Main()


	Dim oMyForm As New WinForm (ThisApplication)
	oMyForm.Show

End Sub
```

#### Code Block 10

```vb
Option Explicit On
AddReference "System.Drawing"
Imports System.Windows.Forms
Imports System.Drawing
 

 

 Class WinForm
	
	Inherits System.Windows.Forms.Form

	Public oArial10 As System.Drawing.Font = New Font("Arial", 10)
	Public oArial12Bold As System.Drawing.Font = New Font("Arial", 10, FontStyle.Bold)
	Public oArial12BoldUnderLined As System.Drawing.Font = New Font("Arial", 12, FontStyle.Underline)
	Public oDrawDoc As DrawingDocument 
	'Public  thisApp As Inventor.Application=ThisApplication
	Public Sub New(thisApp As Inventor.Application)
		oDrawDoc = thisApp.ActiveDocument
		Dim oForm As System.Windows.Forms.Form = Me
		With oForm
			.FormBorderStyle = FormBorderStyle.FixedToolWindow
			.StartPosition = FormStartPosition.CenterScreen
			
			 'Location = New System.Drawing.Point(0, 0)
			.StartPosition = FormStartPosition.Manual
			.Location = New System.Drawing.Point(oForm.Location.X +oForm.Width*4 , _ 
      										oForm.Location.Y+ oForm.Height*1)		  
			.Width = 450
			.Height = 350
			.TopMost = True
			.Font = oArial10
			.Text = "Revision Changes"
			.Name = "Revision Changes"
			.ShowInTaskbar = False
		End With
	
		'[Rev Selection Type
		Dim oRevSelTypeBoxLabel As New System.Windows.Forms.Label
		With oRevSelTypeBoxLabel
			.Text = "Rev Selection Type"
			.Font = oArial12Bold
			.Top = 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oRevSelTypeBoxLabel)
		Dim oRevSelTypeBox As New ComboBox()
		Dim oRevSelTypeList() As String = {"New Rev", "Update Existing"} 

		With oRevSelTypeBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oRevSelTypeList)
			.SelectedIndex = 1
			.Top = oRevSelTypeBoxLabel.Bottom + 1
			.Left = 25
			.Width = 150
			.Name = "Rev Selection Type"
		End With	
		oForm.Controls.Add(oRevSelTypeBox)
			']
		
		'[Designer
		Dim oDesignerBoxLabel As New System.Windows.Forms.Label
		With oDesignerBoxLabel
			.Text = "Designed By"
			.Font = oArial12Bold
			.Top = oRevSelTypeBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oDesignerBoxLabel)
		Dim oDesignerBox As New ComboBox()
		Dim oDesignerList() As String = {"AA","BB"}
		With oDesignerBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oDesignerList)
			.SelectedIndex = 0 'Index of default selection
			.Top = oDesignerBoxLabel.Bottom + 1
			.Left = 25
			.Width = 50
			.Name = "DesignerBox"
		End With	
		oForm.Controls.Add(oDesignerBox)
			']
		'[Description
		Dim oDescriptionBoxLabel As New System.Windows.Forms.Label
		With oDescriptionBoxLabel
			.Text = "Description"
			.Font = oArial12Bold
			.Top = oDesignerBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 100
		End With
		oForm.Controls.Add(oDescriptionBoxLabel)
		Dim oDescriptionBox As New ComboBox()
		Dim oDescriptionList() As String = {"RELEASE TO PRODUCTION","BB"}
		With oDescriptionBox
			.DropDownStyle = ComboBoxStyle.DropDown
			.Items.Clear()
			.Items.AddRange(oDescriptionList)
			.SelectedIndex = 1
			.Top = oDescriptionBoxLabel.Bottom + 1
			.Left = 25
			.Width = 300
			.Height = 25
			.Name = "DescriptionBox"
		End With	
		oForm.Controls.Add(oDescriptionBox)
			']
			
		'[Approved
		Dim oApprovedBoxLabel As New System.Windows.Forms.Label
		With oApprovedBoxLabel
			.Text = "Approved By"
			.Font = oArial12Bold
			.Top = oDescriptionBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 160
		End With
		oForm.Controls.Add(oApprovedBoxLabel)
		Dim oApprovedBox As New ComboBox()
		Dim oApprovedList() As String = {"AA","BB","CC","DD"}
		With oApprovedBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oApprovedList)
			.SelectedIndex = 1
			.Top = oApprovedBoxLabel.Bottom + 1
			.Left = 25
			.Width = 60
			.Name = "ApprovedBox"
		End With	
		oForm.Controls.Add(oApprovedBox)
		']

		Dim oStartButton As New Button()
		With oStartButton
			.Text = "APPLY"
			.Top = oApprovedBox.Bottom + 10
			.Left = 25
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "StartBox"
		End With
		oForm.AcceptButton = oStartButton
		oForm.Controls.Add(oStartButton)
		AddHandler oStartButton.Click, AddressOf oStartButton_Click
		Dim oCancelButton As New Button
		With oCancelButton
			.Text = "CANCEL"
			.Top = oStartButton.Top
			.Left = oStartButton.Right + 10
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "CancelButton"
		End With
		oForm.CancelButton = oCancelButton
		oForm.Controls.Add(oCancelButton)
		AddHandler oCancelButton.Click, AddressOf oCancelButton_Click
	End Sub

	'Populate the values from the form
	Public Sub oStartButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	
		Dim Choice As String = Me.Controls.Item("Rev Selection Type").Text
		Dim oArray2 As String =  Me.Controls.Item("DesignerBox").Text
		Dim oArray4 As String = Me.Controls.Item("DescriptionBox").Text
		Dim oArray5 As String = Me.Controls.Item("ApprovedBox").Text
		MessageBox.Show("Here", "Title")
		MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
		Me.Close
End Sub



Public Sub oCancelButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	Me.Close
End Sub


		
End Class

Sub Main()


	Dim oMyForm As New WinForm (ThisApplication)
	oMyForm.Show

End Sub
```

#### Code Block 11

```vb
Option Explicit On
AddReference "System.Drawing"
Imports System.Windows.Forms
Imports System.Drawing
 

 

 Class WinForm
	
	Inherits System.Windows.Forms.Form

	Public oArial10 As System.Drawing.Font = New Font("Arial", 10)
	Public oArial12Bold As System.Drawing.Font = New Font("Arial", 10, FontStyle.Bold)
	Public oArial12BoldUnderLined As System.Drawing.Font = New Font("Arial", 12, FontStyle.Underline)
	Public oDrawDoc As DrawingDocument 
	'Public  thisApp As Inventor.Application=ThisApplication
	Public Sub New(thisApp As Inventor.Application)
		oDrawDoc = thisApp.ActiveDocument
		Dim oForm As System.Windows.Forms.Form = Me
		With oForm
			.FormBorderStyle = FormBorderStyle.FixedToolWindow
			.StartPosition = FormStartPosition.CenterScreen
			
			 'Location = New System.Drawing.Point(0, 0)
			.StartPosition = FormStartPosition.Manual
			.Location = New System.Drawing.Point(oForm.Location.X +oForm.Width*4 , _ 
      										oForm.Location.Y+ oForm.Height*1)		  
			.Width = 450
			.Height = 350
			.TopMost = True
			.Font = oArial10
			.Text = "Revision Changes"
			.Name = "Revision Changes"
			.ShowInTaskbar = False
		End With
	
		'[Rev Selection Type
		Dim oRevSelTypeBoxLabel As New System.Windows.Forms.Label
		With oRevSelTypeBoxLabel
			.Text = "Rev Selection Type"
			.Font = oArial12Bold
			.Top = 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oRevSelTypeBoxLabel)
		Dim oRevSelTypeBox As New ComboBox()
		Dim oRevSelTypeList() As String = {"New Rev", "Update Existing"} 

		With oRevSelTypeBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oRevSelTypeList)
			.SelectedIndex = 1
			.Top = oRevSelTypeBoxLabel.Bottom + 1
			.Left = 25
			.Width = 150
			.Name = "Rev Selection Type"
		End With	
		oForm.Controls.Add(oRevSelTypeBox)
			']
		
		'[Designer
		Dim oDesignerBoxLabel As New System.Windows.Forms.Label
		With oDesignerBoxLabel
			.Text = "Designed By"
			.Font = oArial12Bold
			.Top = oRevSelTypeBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oDesignerBoxLabel)
		Dim oDesignerBox As New ComboBox()
		Dim oDesignerList() As String = {"AA","BB"}
		With oDesignerBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oDesignerList)
			.SelectedIndex = 0 'Index of default selection
			.Top = oDesignerBoxLabel.Bottom + 1
			.Left = 25
			.Width = 50
			.Name = "DesignerBox"
		End With	
		oForm.Controls.Add(oDesignerBox)
			']
		'[Description
		Dim oDescriptionBoxLabel As New System.Windows.Forms.Label
		With oDescriptionBoxLabel
			.Text = "Description"
			.Font = oArial12Bold
			.Top = oDesignerBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 100
		End With
		oForm.Controls.Add(oDescriptionBoxLabel)
		Dim oDescriptionBox As New ComboBox()
		Dim oDescriptionList() As String = {"RELEASE TO PRODUCTION","BB"}
		With oDescriptionBox
			.DropDownStyle = ComboBoxStyle.DropDown
			.Items.Clear()
			.Items.AddRange(oDescriptionList)
			.SelectedIndex = 1
			.Top = oDescriptionBoxLabel.Bottom + 1
			.Left = 25
			.Width = 300
			.Height = 25
			.Name = "DescriptionBox"
		End With	
		oForm.Controls.Add(oDescriptionBox)
			']
			
		'[Approved
		Dim oApprovedBoxLabel As New System.Windows.Forms.Label
		With oApprovedBoxLabel
			.Text = "Approved By"
			.Font = oArial12Bold
			.Top = oDescriptionBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 160
		End With
		oForm.Controls.Add(oApprovedBoxLabel)
		Dim oApprovedBox As New ComboBox()
		Dim oApprovedList() As String = {"AA","BB","CC","DD"}
		With oApprovedBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oApprovedList)
			.SelectedIndex = 1
			.Top = oApprovedBoxLabel.Bottom + 1
			.Left = 25
			.Width = 60
			.Name = "ApprovedBox"
		End With	
		oForm.Controls.Add(oApprovedBox)
		']

		Dim oStartButton As New Button()
		With oStartButton
			.Text = "APPLY"
			.Top = oApprovedBox.Bottom + 10
			.Left = 25
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "StartBox"
		End With
		oForm.AcceptButton = oStartButton
		oForm.Controls.Add(oStartButton)
		AddHandler oStartButton.Click, AddressOf oStartButton_Click
		Dim oCancelButton As New Button
		With oCancelButton
			.Text = "CANCEL"
			.Top = oStartButton.Top
			.Left = oStartButton.Right + 10
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "CancelButton"
		End With
		oForm.CancelButton = oCancelButton
		oForm.Controls.Add(oCancelButton)
		AddHandler oCancelButton.Click, AddressOf oCancelButton_Click
	End Sub

	'Populate the values from the form
	Public Sub oStartButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	
		Dim Choice As String = Me.Controls.Item("Rev Selection Type").Text
		Dim oArray2 As String =  Me.Controls.Item("DesignerBox").Text
		Dim oArray4 As String = Me.Controls.Item("DescriptionBox").Text
		Dim oArray5 As String = Me.Controls.Item("ApprovedBox").Text
		MessageBox.Show("Here", "Title")
		MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
		Me.Close
End Sub



Public Sub oCancelButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	Me.Close
End Sub


		
End Class

Sub Main()


	Dim oMyForm As New WinForm (ThisApplication)
	oMyForm.Show

End Sub
```

#### Code Block 12

```vb
Option Explicit On
AddReference "System.Drawing"
Imports System.Windows.Forms
Imports System.Drawing
 

 

 Class WinForm
	
	Inherits System.Windows.Forms.Form

	Public oArial10 As System.Drawing.Font = New Font("Arial", 10)
	Public oArial12Bold As System.Drawing.Font = New Font("Arial", 10, FontStyle.Bold)
	Public oArial12BoldUnderLined As System.Drawing.Font = New Font("Arial", 12, FontStyle.Underline)
	Public oDrawDoc As DrawingDocument 
	'Public  thisApp As Inventor.Application=ThisApplication
	Public Sub New(thisApp As Inventor.Application)
		oDrawDoc = thisApp.ActiveDocument
		Dim oForm As System.Windows.Forms.Form = Me
		With oForm
			.FormBorderStyle = FormBorderStyle.FixedToolWindow
			.StartPosition = FormStartPosition.CenterScreen
			
			 'Location = New System.Drawing.Point(0, 0)
			.StartPosition = FormStartPosition.Manual
			.Location = New System.Drawing.Point(oForm.Location.X +oForm.Width*4 , _ 
      										oForm.Location.Y+ oForm.Height*1)		  
			.Width = 450
			.Height = 350
			.TopMost = True
			.Font = oArial10
			.Text = "Revision Changes"
			.Name = "Revision Changes"
			.ShowInTaskbar = False
		End With
	
		'[Rev Selection Type
		Dim oRevSelTypeBoxLabel As New System.Windows.Forms.Label
		With oRevSelTypeBoxLabel
			.Text = "Rev Selection Type"
			.Font = oArial12Bold
			.Top = 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oRevSelTypeBoxLabel)
		Dim oRevSelTypeBox As New ComboBox()
		Dim oRevSelTypeList() As String = {"New Rev", "Update Existing"} 

		With oRevSelTypeBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oRevSelTypeList)
			.SelectedIndex = 1
			.Top = oRevSelTypeBoxLabel.Bottom + 1
			.Left = 25
			.Width = 150
			.Name = "Rev Selection Type"
		End With	
		oForm.Controls.Add(oRevSelTypeBox)
			']
		
		'[Designer
		Dim oDesignerBoxLabel As New System.Windows.Forms.Label
		With oDesignerBoxLabel
			.Text = "Designed By"
			.Font = oArial12Bold
			.Top = oRevSelTypeBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oDesignerBoxLabel)
		Dim oDesignerBox As New ComboBox()
		Dim oDesignerList() As String = {"AA","BB"}
		With oDesignerBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oDesignerList)
			.SelectedIndex = 0 'Index of default selection
			.Top = oDesignerBoxLabel.Bottom + 1
			.Left = 25
			.Width = 50
			.Name = "DesignerBox"
		End With	
		oForm.Controls.Add(oDesignerBox)
			']
		'[Description
		Dim oDescriptionBoxLabel As New System.Windows.Forms.Label
		With oDescriptionBoxLabel
			.Text = "Description"
			.Font = oArial12Bold
			.Top = oDesignerBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 100
		End With
		oForm.Controls.Add(oDescriptionBoxLabel)
		Dim oDescriptionBox As New ComboBox()
		Dim oDescriptionList() As String = {"RELEASE TO PRODUCTION","BB"}
		With oDescriptionBox
			.DropDownStyle = ComboBoxStyle.DropDown
			.Items.Clear()
			.Items.AddRange(oDescriptionList)
			.SelectedIndex = 1
			.Top = oDescriptionBoxLabel.Bottom + 1
			.Left = 25
			.Width = 300
			.Height = 25
			.Name = "DescriptionBox"
		End With	
		oForm.Controls.Add(oDescriptionBox)
			']
			
		'[Approved
		Dim oApprovedBoxLabel As New System.Windows.Forms.Label
		With oApprovedBoxLabel
			.Text = "Approved By"
			.Font = oArial12Bold
			.Top = oDescriptionBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 160
		End With
		oForm.Controls.Add(oApprovedBoxLabel)
		Dim oApprovedBox As New ComboBox()
		Dim oApprovedList() As String = {"AA","BB","CC","DD"}
		With oApprovedBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oApprovedList)
			.SelectedIndex = 1
			.Top = oApprovedBoxLabel.Bottom + 1
			.Left = 25
			.Width = 60
			.Name = "ApprovedBox"
		End With	
		oForm.Controls.Add(oApprovedBox)
		']

		Dim oStartButton As New Button()
		With oStartButton
			.Text = "APPLY"
			.Top = oApprovedBox.Bottom + 10
			.Left = 25
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "StartBox"
		End With
		oForm.AcceptButton = oStartButton
		oForm.Controls.Add(oStartButton)
		AddHandler oStartButton.Click, AddressOf oStartButton_Click
		Dim oCancelButton As New Button
		With oCancelButton
			.Text = "CANCEL"
			.Top = oStartButton.Top
			.Left = oStartButton.Right + 10
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "CancelButton"
		End With
		oForm.CancelButton = oCancelButton
		oForm.Controls.Add(oCancelButton)
		AddHandler oCancelButton.Click, AddressOf oCancelButton_Click
	End Sub

	'Populate the values from the form
	Public Sub oStartButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	
		Dim Choice As String = Me.Controls.Item("Rev Selection Type").Text
		Dim oArray2 As String =  Me.Controls.Item("DesignerBox").Text
		Dim oArray4 As String = Me.Controls.Item("DescriptionBox").Text
		Dim oArray5 As String = Me.Controls.Item("ApprovedBox").Text
		MessageBox.Show("Here", "Title")
		MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
		Me.Close
End Sub



Public Sub oCancelButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	Me.Close
End Sub


		
End Class

Sub Main()


	Dim oMyForm As New WinForm (ThisApplication)
	oMyForm.Show

End Sub
```

#### Code Block 13

```vb
Public Class WinForm
	
	Inherits System.Windows.Forms.Form

	Public oArial10 As System.Drawing.Font = New Font("Arial", 10)
	Public oArial12Bold As System.Drawing.Font = New Font("Arial", 10, FontStyle.Bold)
	Public oArial12BoldUnderLined As System.Drawing.Font = New Font("Arial", 12, FontStyle.Underline)
	Public oDrawDoc As DrawingDocument 
	Public thisApp As Inventor.Application
	Public Sub New
		Dim oForm As System.Windows.Forms.Form = Me
		With oForm
			.FormBorderStyle = FormBorderStyle.FixedToolWindow
			.StartPosition = FormStartPosition.CenterScreen
			
			 'Location = New System.Drawing.Point(0, 0)
			.StartPosition = FormStartPosition.Manual
			.Location = New System.Drawing.Point(oForm.Location.X +oForm.Width*4 , _ 
      										oForm.Location.Y+ oForm.Height*1)		  
			.Width = 450
			.Height = 350
			.TopMost = True
			.Font = oArial10
			.Text = "Revision Changes"
			.Name = "Revision Changes"
			.ShowInTaskbar = False
		End With
	
		'[Rev Selection Type
		Dim oRevSelTypeBoxLabel As New System.Windows.Forms.Label
		With oRevSelTypeBoxLabel
			.Text = "Rev Selection Type"
			.Font = oArial12Bold
			.Top = 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oRevSelTypeBoxLabel)
		Dim oRevSelTypeBox As New ComboBox()
		Dim oRevSelTypeList() As String = {"New Rev", "Update Existing"} 

		With oRevSelTypeBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oRevSelTypeList)
			.SelectedIndex = 1
			.Top = oRevSelTypeBoxLabel.Bottom + 1
			.Left = 25
			.Width = 150
			.Name = "Rev Selection Type"
		End With	
		oForm.Controls.Add(oRevSelTypeBox)
			']
		
		'[Designer
		Dim oDesignerBoxLabel As New System.Windows.Forms.Label
		With oDesignerBoxLabel
			.Text = "Designed By"
			.Font = oArial12Bold
			.Top = oRevSelTypeBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oDesignerBoxLabel)
		Dim oDesignerBox As New ComboBox()
		Dim oDesignerList() As String = {"AA","BB"}
		With oDesignerBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oDesignerList)
			.SelectedIndex = 0 'Index of default selection
			.Top = oDesignerBoxLabel.Bottom + 1
			.Left = 25
			.Width = 50
			.Name = "DesignerBox"
		End With	
		oForm.Controls.Add(oDesignerBox)
			']
		'[Description
		Dim oDescriptionBoxLabel As New System.Windows.Forms.Label
		With oDescriptionBoxLabel
			.Text = "Description"
			.Font = oArial12Bold
			.Top = oDesignerBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 100
		End With
		oForm.Controls.Add(oDescriptionBoxLabel)
		Dim oDescriptionBox As New ComboBox()
		Dim oDescriptionList() As String = {"RELEASE TO PRODUCTION","BB"}
		With oDescriptionBox
			.DropDownStyle = ComboBoxStyle.DropDown
			.Items.Clear()
			.Items.AddRange(oDescriptionList)
			.SelectedIndex = 1
			.Top = oDescriptionBoxLabel.Bottom + 1
			.Left = 25
			.Width = 300
			.Height = 25
			.Name = "DescriptionBox"
		End With	
		oForm.Controls.Add(oDescriptionBox)
			']
			
		'[Approved
		Dim oApprovedBoxLabel As New System.Windows.Forms.Label
		With oApprovedBoxLabel
			.Text = "Approved By"
			.Font = oArial12Bold
			.Top = oDescriptionBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 160
		End With
		oForm.Controls.Add(oApprovedBoxLabel)
		Dim oApprovedBox As New ComboBox()
		Dim oApprovedList() As String = {"AA","BB","CC","DD"}
		With oApprovedBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oApprovedList)
			.SelectedIndex = 1
			.Top = oApprovedBoxLabel.Bottom + 1
			.Left = 25
			.Width = 60
			.Name = "ApprovedBox"
		End With	
		oForm.Controls.Add(oApprovedBox)
		']

		Dim oStartButton As New Button()
		With oStartButton
			.Text = "APPLY"
			.Top = oApprovedBox.Bottom + 10
			.Left = 25
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "StartBox"
		End With
		oForm.AcceptButton = oStartButton
		oForm.Controls.Add(oStartButton)
		AddHandler oStartButton.Click, AddressOf oStartButton_Click
		Dim oCancelButton As New Button
		With oCancelButton
			.Text = "CANCEL"
			.Top = oStartButton.Top
			.Left = oStartButton.Right + 10
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "CancelButton"
		End With
		oForm.CancelButton = oCancelButton
		oForm.Controls.Add(oCancelButton)
		AddHandler oCancelButton.Click, AddressOf oCancelButton_Click
	End Sub

	'Populate the values from the form
	Public Sub oStartButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	
		Dim Choice As String = Me.Controls.Item("Rev Selection Type").Text
		Dim oArray2 As String =  Me.Controls.Item("DesignerBox").Text
		Dim oArray4 As String = Me.Controls.Item("DescriptionBox").Text
		Dim oArray5 As String = Me.Controls.Item("ApprovedBox").Text
		MessageBox.Show("Here", "Title")
		MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
		
End Sub



Public Sub oCancelButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	Me.Close
End Sub

		
End Class

Sub Main()
 Try
	thisApp = ThisApplication
	oDrawDoc = ThisApplication.ActiveDocument
	MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
  Catch ex As Exception
  End Try

	Dim oMyForm As New WinForm 
	oMyForm.Show

End Sub
```

#### Code Block 14

```vb
Public Class WinForm
	
	Inherits System.Windows.Forms.Form

	Public oArial10 As System.Drawing.Font = New Font("Arial", 10)
	Public oArial12Bold As System.Drawing.Font = New Font("Arial", 10, FontStyle.Bold)
	Public oArial12BoldUnderLined As System.Drawing.Font = New Font("Arial", 12, FontStyle.Underline)
	Public oDrawDoc As DrawingDocument 
	Public thisApp As Inventor.Application
	Public Sub New
		Dim oForm As System.Windows.Forms.Form = Me
		With oForm
			.FormBorderStyle = FormBorderStyle.FixedToolWindow
			.StartPosition = FormStartPosition.CenterScreen
			
			 'Location = New System.Drawing.Point(0, 0)
			.StartPosition = FormStartPosition.Manual
			.Location = New System.Drawing.Point(oForm.Location.X +oForm.Width*4 , _ 
      										oForm.Location.Y+ oForm.Height*1)		  
			.Width = 450
			.Height = 350
			.TopMost = True
			.Font = oArial10
			.Text = "Revision Changes"
			.Name = "Revision Changes"
			.ShowInTaskbar = False
		End With
	
		'[Rev Selection Type
		Dim oRevSelTypeBoxLabel As New System.Windows.Forms.Label
		With oRevSelTypeBoxLabel
			.Text = "Rev Selection Type"
			.Font = oArial12Bold
			.Top = 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oRevSelTypeBoxLabel)
		Dim oRevSelTypeBox As New ComboBox()
		Dim oRevSelTypeList() As String = {"New Rev", "Update Existing"} 

		With oRevSelTypeBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oRevSelTypeList)
			.SelectedIndex = 1
			.Top = oRevSelTypeBoxLabel.Bottom + 1
			.Left = 25
			.Width = 150
			.Name = "Rev Selection Type"
		End With	
		oForm.Controls.Add(oRevSelTypeBox)
			']
		
		'[Designer
		Dim oDesignerBoxLabel As New System.Windows.Forms.Label
		With oDesignerBoxLabel
			.Text = "Designed By"
			.Font = oArial12Bold
			.Top = oRevSelTypeBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oDesignerBoxLabel)
		Dim oDesignerBox As New ComboBox()
		Dim oDesignerList() As String = {"AA","BB"}
		With oDesignerBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oDesignerList)
			.SelectedIndex = 0 'Index of default selection
			.Top = oDesignerBoxLabel.Bottom + 1
			.Left = 25
			.Width = 50
			.Name = "DesignerBox"
		End With	
		oForm.Controls.Add(oDesignerBox)
			']
		'[Description
		Dim oDescriptionBoxLabel As New System.Windows.Forms.Label
		With oDescriptionBoxLabel
			.Text = "Description"
			.Font = oArial12Bold
			.Top = oDesignerBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 100
		End With
		oForm.Controls.Add(oDescriptionBoxLabel)
		Dim oDescriptionBox As New ComboBox()
		Dim oDescriptionList() As String = {"RELEASE TO PRODUCTION","BB"}
		With oDescriptionBox
			.DropDownStyle = ComboBoxStyle.DropDown
			.Items.Clear()
			.Items.AddRange(oDescriptionList)
			.SelectedIndex = 1
			.Top = oDescriptionBoxLabel.Bottom + 1
			.Left = 25
			.Width = 300
			.Height = 25
			.Name = "DescriptionBox"
		End With	
		oForm.Controls.Add(oDescriptionBox)
			']
			
		'[Approved
		Dim oApprovedBoxLabel As New System.Windows.Forms.Label
		With oApprovedBoxLabel
			.Text = "Approved By"
			.Font = oArial12Bold
			.Top = oDescriptionBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 160
		End With
		oForm.Controls.Add(oApprovedBoxLabel)
		Dim oApprovedBox As New ComboBox()
		Dim oApprovedList() As String = {"AA","BB","CC","DD"}
		With oApprovedBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oApprovedList)
			.SelectedIndex = 1
			.Top = oApprovedBoxLabel.Bottom + 1
			.Left = 25
			.Width = 60
			.Name = "ApprovedBox"
		End With	
		oForm.Controls.Add(oApprovedBox)
		']

		Dim oStartButton As New Button()
		With oStartButton
			.Text = "APPLY"
			.Top = oApprovedBox.Bottom + 10
			.Left = 25
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "StartBox"
		End With
		oForm.AcceptButton = oStartButton
		oForm.Controls.Add(oStartButton)
		AddHandler oStartButton.Click, AddressOf oStartButton_Click
		Dim oCancelButton As New Button
		With oCancelButton
			.Text = "CANCEL"
			.Top = oStartButton.Top
			.Left = oStartButton.Right + 10
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "CancelButton"
		End With
		oForm.CancelButton = oCancelButton
		oForm.Controls.Add(oCancelButton)
		AddHandler oCancelButton.Click, AddressOf oCancelButton_Click
	End Sub

	'Populate the values from the form
	Public Sub oStartButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	
		Dim Choice As String = Me.Controls.Item("Rev Selection Type").Text
		Dim oArray2 As String =  Me.Controls.Item("DesignerBox").Text
		Dim oArray4 As String = Me.Controls.Item("DescriptionBox").Text
		Dim oArray5 As String = Me.Controls.Item("ApprovedBox").Text
		MessageBox.Show("Here", "Title")
		MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
		
End Sub



Public Sub oCancelButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	Me.Close
End Sub

		
End Class

Sub Main()
 Try
	thisApp = ThisApplication
	oDrawDoc = ThisApplication.ActiveDocument
	MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
  Catch ex As Exception
  End Try

	Dim oMyForm As New WinForm 
	oMyForm.Show

End Sub
```

#### Code Block 15

```vb
Public Class WinForm
	
	Inherits System.Windows.Forms.Form

	Public oArial10 As System.Drawing.Font = New Font("Arial", 10)
	Public oArial12Bold As System.Drawing.Font = New Font("Arial", 10, FontStyle.Bold)
	Public oArial12BoldUnderLined As System.Drawing.Font = New Font("Arial", 12, FontStyle.Underline)
	Public oDrawDoc As DrawingDocument 
	Public thisApp As Inventor.Application
	Public Sub New
		Dim oForm As System.Windows.Forms.Form = Me
		With oForm
			.FormBorderStyle = FormBorderStyle.FixedToolWindow
			.StartPosition = FormStartPosition.CenterScreen
			
			 'Location = New System.Drawing.Point(0, 0)
			.StartPosition = FormStartPosition.Manual
			.Location = New System.Drawing.Point(oForm.Location.X +oForm.Width*4 , _ 
      										oForm.Location.Y+ oForm.Height*1)		  
			.Width = 450
			.Height = 350
			.TopMost = True
			.Font = oArial10
			.Text = "Revision Changes"
			.Name = "Revision Changes"
			.ShowInTaskbar = False
		End With
	
		'[Rev Selection Type
		Dim oRevSelTypeBoxLabel As New System.Windows.Forms.Label
		With oRevSelTypeBoxLabel
			.Text = "Rev Selection Type"
			.Font = oArial12Bold
			.Top = 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oRevSelTypeBoxLabel)
		Dim oRevSelTypeBox As New ComboBox()
		Dim oRevSelTypeList() As String = {"New Rev", "Update Existing"} 

		With oRevSelTypeBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oRevSelTypeList)
			.SelectedIndex = 1
			.Top = oRevSelTypeBoxLabel.Bottom + 1
			.Left = 25
			.Width = 150
			.Name = "Rev Selection Type"
		End With	
		oForm.Controls.Add(oRevSelTypeBox)
			']
		
		'[Designer
		Dim oDesignerBoxLabel As New System.Windows.Forms.Label
		With oDesignerBoxLabel
			.Text = "Designed By"
			.Font = oArial12Bold
			.Top = oRevSelTypeBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oDesignerBoxLabel)
		Dim oDesignerBox As New ComboBox()
		Dim oDesignerList() As String = {"AA","BB"}
		With oDesignerBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oDesignerList)
			.SelectedIndex = 0 'Index of default selection
			.Top = oDesignerBoxLabel.Bottom + 1
			.Left = 25
			.Width = 50
			.Name = "DesignerBox"
		End With	
		oForm.Controls.Add(oDesignerBox)
			']
		'[Description
		Dim oDescriptionBoxLabel As New System.Windows.Forms.Label
		With oDescriptionBoxLabel
			.Text = "Description"
			.Font = oArial12Bold
			.Top = oDesignerBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 100
		End With
		oForm.Controls.Add(oDescriptionBoxLabel)
		Dim oDescriptionBox As New ComboBox()
		Dim oDescriptionList() As String = {"RELEASE TO PRODUCTION","BB"}
		With oDescriptionBox
			.DropDownStyle = ComboBoxStyle.DropDown
			.Items.Clear()
			.Items.AddRange(oDescriptionList)
			.SelectedIndex = 1
			.Top = oDescriptionBoxLabel.Bottom + 1
			.Left = 25
			.Width = 300
			.Height = 25
			.Name = "DescriptionBox"
		End With	
		oForm.Controls.Add(oDescriptionBox)
			']
			
		'[Approved
		Dim oApprovedBoxLabel As New System.Windows.Forms.Label
		With oApprovedBoxLabel
			.Text = "Approved By"
			.Font = oArial12Bold
			.Top = oDescriptionBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 160
		End With
		oForm.Controls.Add(oApprovedBoxLabel)
		Dim oApprovedBox As New ComboBox()
		Dim oApprovedList() As String = {"AA","BB","CC","DD"}
		With oApprovedBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oApprovedList)
			.SelectedIndex = 1
			.Top = oApprovedBoxLabel.Bottom + 1
			.Left = 25
			.Width = 60
			.Name = "ApprovedBox"
		End With	
		oForm.Controls.Add(oApprovedBox)
		']

		Dim oStartButton As New Button()
		With oStartButton
			.Text = "APPLY"
			.Top = oApprovedBox.Bottom + 10
			.Left = 25
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "StartBox"
		End With
		oForm.AcceptButton = oStartButton
		oForm.Controls.Add(oStartButton)
		AddHandler oStartButton.Click, AddressOf oStartButton_Click
		Dim oCancelButton As New Button
		With oCancelButton
			.Text = "CANCEL"
			.Top = oStartButton.Top
			.Left = oStartButton.Right + 10
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "CancelButton"
		End With
		oForm.CancelButton = oCancelButton
		oForm.Controls.Add(oCancelButton)
		AddHandler oCancelButton.Click, AddressOf oCancelButton_Click
	End Sub

	'Populate the values from the form
	Public Sub oStartButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	
		Dim Choice As String = Me.Controls.Item("Rev Selection Type").Text
		Dim oArray2 As String =  Me.Controls.Item("DesignerBox").Text
		Dim oArray4 As String = Me.Controls.Item("DescriptionBox").Text
		Dim oArray5 As String = Me.Controls.Item("ApprovedBox").Text
		MessageBox.Show("Here", "Title")
		MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
		
End Sub



Public Sub oCancelButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	Me.Close
End Sub

		
End Class

Sub Main()
 Try
	thisApp = ThisApplication
	oDrawDoc = ThisApplication.ActiveDocument
	MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
  Catch ex As Exception
  End Try

	Dim oMyForm As New WinForm 
	oMyForm.Show

End Sub
```

#### Code Block 16

```vb
Public Class WinForm
	
	Inherits System.Windows.Forms.Form

	Public oArial10 As System.Drawing.Font = New Font("Arial", 10)
	Public oArial12Bold As System.Drawing.Font = New Font("Arial", 10, FontStyle.Bold)
	Public oArial12BoldUnderLined As System.Drawing.Font = New Font("Arial", 12, FontStyle.Underline)
	Public oDrawDoc As DrawingDocument 
	Public thisApp As Inventor.Application
	Public Sub New
		Dim oForm As System.Windows.Forms.Form = Me
		With oForm
			.FormBorderStyle = FormBorderStyle.FixedToolWindow
			.StartPosition = FormStartPosition.CenterScreen
			
			 'Location = New System.Drawing.Point(0, 0)
			.StartPosition = FormStartPosition.Manual
			.Location = New System.Drawing.Point(oForm.Location.X +oForm.Width*4 , _ 
      										oForm.Location.Y+ oForm.Height*1)		  
			.Width = 450
			.Height = 350
			.TopMost = True
			.Font = oArial10
			.Text = "Revision Changes"
			.Name = "Revision Changes"
			.ShowInTaskbar = False
		End With
	
		'[Rev Selection Type
		Dim oRevSelTypeBoxLabel As New System.Windows.Forms.Label
		With oRevSelTypeBoxLabel
			.Text = "Rev Selection Type"
			.Font = oArial12Bold
			.Top = 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oRevSelTypeBoxLabel)
		Dim oRevSelTypeBox As New ComboBox()
		Dim oRevSelTypeList() As String = {"New Rev", "Update Existing"} 

		With oRevSelTypeBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oRevSelTypeList)
			.SelectedIndex = 1
			.Top = oRevSelTypeBoxLabel.Bottom + 1
			.Left = 25
			.Width = 150
			.Name = "Rev Selection Type"
		End With	
		oForm.Controls.Add(oRevSelTypeBox)
			']
		
		'[Designer
		Dim oDesignerBoxLabel As New System.Windows.Forms.Label
		With oDesignerBoxLabel
			.Text = "Designed By"
			.Font = oArial12Bold
			.Top = oRevSelTypeBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 150
		End With
		oForm.Controls.Add(oDesignerBoxLabel)
		Dim oDesignerBox As New ComboBox()
		Dim oDesignerList() As String = {"AA","BB"}
		With oDesignerBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oDesignerList)
			.SelectedIndex = 0 'Index of default selection
			.Top = oDesignerBoxLabel.Bottom + 1
			.Left = 25
			.Width = 50
			.Name = "DesignerBox"
		End With	
		oForm.Controls.Add(oDesignerBox)
			']
		'[Description
		Dim oDescriptionBoxLabel As New System.Windows.Forms.Label
		With oDescriptionBoxLabel
			.Text = "Description"
			.Font = oArial12Bold
			.Top = oDesignerBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 100
		End With
		oForm.Controls.Add(oDescriptionBoxLabel)
		Dim oDescriptionBox As New ComboBox()
		Dim oDescriptionList() As String = {"RELEASE TO PRODUCTION","BB"}
		With oDescriptionBox
			.DropDownStyle = ComboBoxStyle.DropDown
			.Items.Clear()
			.Items.AddRange(oDescriptionList)
			.SelectedIndex = 1
			.Top = oDescriptionBoxLabel.Bottom + 1
			.Left = 25
			.Width = 300
			.Height = 25
			.Name = "DescriptionBox"
		End With	
		oForm.Controls.Add(oDescriptionBox)
			']
			
		'[Approved
		Dim oApprovedBoxLabel As New System.Windows.Forms.Label
		With oApprovedBoxLabel
			.Text = "Approved By"
			.Font = oArial12Bold
			.Top = oDescriptionBox.Bottom + 10
			.Left = 25
			.Height = 20
			.Width = 160
		End With
		oForm.Controls.Add(oApprovedBoxLabel)
		Dim oApprovedBox As New ComboBox()
		Dim oApprovedList() As String = {"AA","BB","CC","DD"}
		With oApprovedBox
			.DropDownStyle = ComboBoxStyle.DropDownList
			.Items.Clear()
			.Items.AddRange(oApprovedList)
			.SelectedIndex = 1
			.Top = oApprovedBoxLabel.Bottom + 1
			.Left = 25
			.Width = 60
			.Name = "ApprovedBox"
		End With	
		oForm.Controls.Add(oApprovedBox)
		']

		Dim oStartButton As New Button()
		With oStartButton
			.Text = "APPLY"
			.Top = oApprovedBox.Bottom + 10
			.Left = 25
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "StartBox"
		End With
		oForm.AcceptButton = oStartButton
		oForm.Controls.Add(oStartButton)
		AddHandler oStartButton.Click, AddressOf oStartButton_Click
		Dim oCancelButton As New Button
		With oCancelButton
			.Text = "CANCEL"
			.Top = oStartButton.Top
			.Left = oStartButton.Right + 10
			.Height = 25
			.Width = 75
			.Enabled = True
			.Name = "CancelButton"
		End With
		oForm.CancelButton = oCancelButton
		oForm.Controls.Add(oCancelButton)
		AddHandler oCancelButton.Click, AddressOf oCancelButton_Click
	End Sub

	'Populate the values from the form
	Public Sub oStartButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	
		Dim Choice As String = Me.Controls.Item("Rev Selection Type").Text
		Dim oArray2 As String =  Me.Controls.Item("DesignerBox").Text
		Dim oArray4 As String = Me.Controls.Item("DescriptionBox").Text
		Dim oArray5 As String = Me.Controls.Item("ApprovedBox").Text
		MessageBox.Show("Here", "Title")
		MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
		
End Sub



Public Sub oCancelButton_Click(ByVal oSender As System.Object, ByVal oEventArgs As System.EventArgs)
	Me.Close
End Sub

		
End Class

Sub Main()
 Try
	thisApp = ThisApplication
	oDrawDoc = ThisApplication.ActiveDocument
	MessageBox.Show(oDrawDoc.FullDocumentName, "Title")
  Catch ex As Exception
  End Try

	Dim oMyForm As New WinForm 
	oMyForm.Show

End Sub
```

#### Code Block 17

```vb
ThisApplication.Visible = True
```

#### Code Block 18

```vb
ThisApplication.Visible = True
```

#### Code Block 19

```vb
ThisApplication.Visible = True
```

#### Code Block 20

```vb
ThisApplication.Visible = True
```

#### Code Block 21

```vb
Try
 	_invApp = Marshal.GetActiveObject("Inventor.Application")
	Catch ex As Exception
	   Try
	     Dim invAppType As Type = _
	     GetTypeFromProgID("Inventor.Application")
	 
	     _invApp = CreateInstance(invAppType)
	     _invApp.Visible = True
	
	    'Note: if you shut down the Inventor session that was started
	    'this(way) there is still an Inventor.exe running. We will use
	    'this Boolean to test whether or not the Inventor App  will
	    'need to be shut down.
	   Catch ex2 As Exception
	     MsgBox(ex2.ToString())
	     MsgBox("Unable to get or start Inventor")
	   End Try
End Try
```

#### Code Block 22

```vb
Try
 	_invApp = Marshal.GetActiveObject("Inventor.Application")
	Catch ex As Exception
	   Try
	     Dim invAppType As Type = _
	     GetTypeFromProgID("Inventor.Application")
	 
	     _invApp = CreateInstance(invAppType)
	     _invApp.Visible = True
	
	    'Note: if you shut down the Inventor session that was started
	    'this(way) there is still an Inventor.exe running. We will use
	    'this Boolean to test whether or not the Inventor App  will
	    'need to be shut down.
	   Catch ex2 As Exception
	     MsgBox(ex2.ToString())
	     MsgBox("Unable to get or start Inventor")
	   End Try
End Try
```

#### Code Block 23

```vb
Try
 	_invApp = Marshal.GetActiveObject("Inventor.Application")
	Catch ex As Exception
	   Try
	     Dim invAppType As Type = _
	     GetTypeFromProgID("Inventor.Application")
	 
	     _invApp = CreateInstance(invAppType)
	     _invApp.Visible = True
	
	    'Note: if you shut down the Inventor session that was started
	    'this(way) there is still an Inventor.exe running. We will use
	    'this Boolean to test whether or not the Inventor App  will
	    'need to be shut down.
	   Catch ex2 As Exception
	     MsgBox(ex2.ToString())
	     MsgBox("Unable to get or start Inventor")
	   End Try
End Try
```

#### Code Block 24

```vb
Try
 	_invApp = Marshal.GetActiveObject("Inventor.Application")
	Catch ex As Exception
	   Try
	     Dim invAppType As Type = _
	     GetTypeFromProgID("Inventor.Application")
	 
	     _invApp = CreateInstance(invAppType)
	     _invApp.Visible = True
	
	    'Note: if you shut down the Inventor session that was started
	    'this(way) there is still an Inventor.exe running. We will use
	    'this Boolean to test whether or not the Inventor App  will
	    'need to be shut down.
	   Catch ex2 As Exception
	     MsgBox(ex2.ToString())
	     MsgBox("Unable to get or start Inventor")
	   End Try
End Try
```

#### Code Block 25

```vb
_invApp = Thisapplication
```

#### Code Block 26

```vb
_invApp = Thisapplication
```

#### Code Block 27

```vb
_invApp = Thisapplication
```

#### Code Block 28

```vb
_invApp = Thisapplication
```

#### Code Block 29

```vb
_invApp.Visible = True
```

#### Code Block 30

```vb
_invApp.Visible = True
```

#### Code Block 31

```vb
_invApp.Visible = True
```

#### Code Block 32

```vb
_invApp.Visible = True
```

---

### 21. Inventor DWG to AutoCAD DWG Conversion

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/inventor-dwg-to-autocad-dwg-conversion/td-p/11339593#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/inventor-dwg-to-autocad-dwg-conversion/td-p/11339593#messageview_0)

**Author:** Harshil.JAINS8RVT

**Date:** ‎08-04-2022
	
		
		02:29 AM

**Description:** Hello, I have a requirement to convert from Inventor DWG to AutoCAD DWG. I have tried the code as shown below:- ApplicationAddInsPtr pAddIns = pApplication->GetApplicationAddIns();TranslatorAddInPtr pTrans;_bstr_t ClientId = _T("{C24E3AC2-122E-11D5-8E91-0010B541CD80}");pTrans = pAddIns->GetItemById(...

**Code Snippets (5):**

#### Code Block 1

```vb
Sub Main()
    If Not ConfirmProceed() Then Return

    Dim sourceFolder As String = GetFolder("Select folder containing DWG files")
    If sourceFolder = "" Then Return

    Dim exportFolder As String = GetFolder("Select folder to save AutoCAD DWG files")
    If exportFolder = "" Then Return

    Dim configPath As String = "C:\Users\thoma\Documents\$_INDUSTRIAL_DRAFTING_&_DESIGN\INVENTOR_FILES\PRESETS\EXPORT-DWG.ini"
    If Not System.IO.File.Exists(configPath) Then
        MessageBox.Show("Missing DWG config: " & configPath)
        Return
    End If

    Dim files() As String = System.IO.Directory.GetFiles(sourceFolder, "*.dwg")
    Dim successCount As Integer = 0
    Dim skippedCount As Integer = 0
    Dim errorLog As New System.Text.StringBuilder
    Dim exportLog As New System.Text.StringBuilder

    exportLog.AppendLine("DWG Export Log - " & Now.ToString())
    exportLog.AppendLine("")

    For Each file As String In files
        Dim doc As Document = Nothing
        Try
            doc = ThisApplication.Documents.Open(file, False)
            If doc.DocumentType <> DocumentTypeEnum.kDrawingDocumentObject Then
                doc.Close(True)
                Continue For
            End If

            Dim baseName As String = System.IO.Path.GetFileNameWithoutExtension(file)
            Dim drawDoc As DrawingDocument = doc
            Dim sheet1 As Sheet = drawDoc.Sheets(1)
            If sheet1.DrawingViews.Count = 0 Then Throw New Exception("No views on Sheet 1")
            Dim baseView As DrawingView = sheet1.DrawingViews(1)

            Dim modelDoc As Document = baseView.ReferencedDocumentDescriptor.ReferencedDocument
            If modelDoc Is Nothing Then Throw New Exception("Referenced model is missing.")

            Dim modelRev As String = ""
            Try
                modelRev = iProperties.Value(modelDoc, "Project", "Revision Number")
            Catch
                modelRev = "NO-REV"
            End Try

            Dim exportName As String = baseName & "-REV-" & SanitizeFileName(modelRev) & ".dwg"
            Dim exportPath As String = System.IO.Path.Combine(exportFolder, exportName)

            exportLog.AppendLine("DWG: " & baseName)
            exportLog.AppendLine(" ↳ Model: " & modelDoc.DisplayName)
            exportLog.AppendLine(" ↳ REV: " & modelRev)

            If System.IO.File.Exists(exportPath) Then
                exportLog.AppendLine(" ⏭ Skipped (same REV already exported)")
                doc.Close(True)
                skippedCount += 1
                Continue For
            End If

            ' Set up translator
            Dim addIn As TranslatorAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC2-122E-11D5-8E91-0010B541CD80}")
            Dim context = ThisApplication.TransientObjects.CreateTranslationContext
            context.Type = IOMechanismEnum.kFileBrowseIOMechanism
            Dim options = ThisApplication.TransientObjects.CreateNameValueMap
            If addIn.HasSaveCopyAsOptions(doc, context, options) Then
                options.Value("Export_Acad_IniFile") = configPath
            End If
            Dim oData = ThisApplication.TransientObjects.CreateDataMedium
            oData.FileName = exportPath

            addIn.SaveCopyAs(doc, context, options, oData)
            doc.Close(True)
            successCount += 1
            exportLog.AppendLine(" ✅ Exported: " & exportName)
        Catch ex As Exception
            If Not doc Is Nothing Then doc.Close(True)
            errorLog.AppendLine("ERROR processing " & file & ": " & ex.Message)
        End Try

        exportLog.AppendLine("")
    Next

    ' Write logs
    System.IO.File.WriteAllText(System.IO.Path.Combine(exportFolder, "DWG_Export_Log.txt"), exportLog.ToString())
    If errorLog.Length > 0 Then
        System.IO.File.WriteAllText(System.IO.Path.Combine(exportFolder, "DWG_Export_Errors.txt"), errorLog.ToString())
    End If

    MessageBox.Show("DWG export complete." & vbCrLf & _
        "✔ Files exported: " & successCount & vbCrLf & _
        "⏭ Skipped (already exported at this REV): " & skippedCount & vbCrLf & _
        "⚠ Errors: " & errorLog.Length, "Export Summary")
End Sub

Function GetFolder(prompt As String) As String
    Dim dlg As New FolderBrowserDialog
    dlg.Description = prompt
    If dlg.ShowDialog() <> DialogResult.OK Then Return ""
    Return dlg.SelectedPath
End Function

Function ConfirmProceed() As Boolean
    Dim result = MessageBox.Show("Export DWGs only if target REV file does not exist?", "Confirm Export", MessageBoxButtons.YesNo)
    Return result = DialogResult.Yes
End Function

Function SanitizeFileName(input As String) As String
    For Each c As Char In System.IO.Path.GetInvalidFileNameChars()
        input = input.Replace(c, "_")
    Next
    Return input
End Function
```

#### Code Block 2

```vb
Sub Main()
    If Not ConfirmProceed() Then Return

    Dim sourceFolder As String = GetFolder("Select folder containing DWG files")
    If sourceFolder = "" Then Return

    Dim exportFolder As String = GetFolder("Select folder to save AutoCAD DWG files")
    If exportFolder = "" Then Return

    Dim configPath As String = "C:\Users\thoma\Documents\$_INDUSTRIAL_DRAFTING_&_DESIGN\INVENTOR_FILES\PRESETS\EXPORT-DWG.ini"
    If Not System.IO.File.Exists(configPath) Then
        MessageBox.Show("Missing DWG config: " & configPath)
        Return
    End If

    Dim files() As String = System.IO.Directory.GetFiles(sourceFolder, "*.dwg")
    Dim successCount As Integer = 0
    Dim skippedCount As Integer = 0
    Dim errorLog As New System.Text.StringBuilder
    Dim exportLog As New System.Text.StringBuilder

    exportLog.AppendLine("DWG Export Log - " & Now.ToString())
    exportLog.AppendLine("")

    For Each file As String In files
        Dim doc As Document = Nothing
        Try
            doc = ThisApplication.Documents.Open(file, False)
            If doc.DocumentType <> DocumentTypeEnum.kDrawingDocumentObject Then
                doc.Close(True)
                Continue For
            End If

            Dim baseName As String = System.IO.Path.GetFileNameWithoutExtension(file)
            Dim drawDoc As DrawingDocument = doc
            Dim sheet1 As Sheet = drawDoc.Sheets(1)
            If sheet1.DrawingViews.Count = 0 Then Throw New Exception("No views on Sheet 1")
            Dim baseView As DrawingView = sheet1.DrawingViews(1)

            Dim modelDoc As Document = baseView.ReferencedDocumentDescriptor.ReferencedDocument
            If modelDoc Is Nothing Then Throw New Exception("Referenced model is missing.")

            Dim modelRev As String = ""
            Try
                modelRev = iProperties.Value(modelDoc, "Project", "Revision Number")
            Catch
                modelRev = "NO-REV"
            End Try

            Dim exportName As String = baseName & "-REV-" & SanitizeFileName(modelRev) & ".dwg"
            Dim exportPath As String = System.IO.Path.Combine(exportFolder, exportName)

            exportLog.AppendLine("DWG: " & baseName)
            exportLog.AppendLine(" ↳ Model: " & modelDoc.DisplayName)
            exportLog.AppendLine(" ↳ REV: " & modelRev)

            If System.IO.File.Exists(exportPath) Then
                exportLog.AppendLine(" ⏭ Skipped (same REV already exported)")
                doc.Close(True)
                skippedCount += 1
                Continue For
            End If

            ' Set up translator
            Dim addIn As TranslatorAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC2-122E-11D5-8E91-0010B541CD80}")
            Dim context = ThisApplication.TransientObjects.CreateTranslationContext
            context.Type = IOMechanismEnum.kFileBrowseIOMechanism
            Dim options = ThisApplication.TransientObjects.CreateNameValueMap
            If addIn.HasSaveCopyAsOptions(doc, context, options) Then
                options.Value("Export_Acad_IniFile") = configPath
            End If
            Dim oData = ThisApplication.TransientObjects.CreateDataMedium
            oData.FileName = exportPath

            addIn.SaveCopyAs(doc, context, options, oData)
            doc.Close(True)
            successCount += 1
            exportLog.AppendLine(" ✅ Exported: " & exportName)
        Catch ex As Exception
            If Not doc Is Nothing Then doc.Close(True)
            errorLog.AppendLine("ERROR processing " & file & ": " & ex.Message)
        End Try

        exportLog.AppendLine("")
    Next

    ' Write logs
    System.IO.File.WriteAllText(System.IO.Path.Combine(exportFolder, "DWG_Export_Log.txt"), exportLog.ToString())
    If errorLog.Length > 0 Then
        System.IO.File.WriteAllText(System.IO.Path.Combine(exportFolder, "DWG_Export_Errors.txt"), errorLog.ToString())
    End If

    MessageBox.Show("DWG export complete." & vbCrLf & _
        "✔ Files exported: " & successCount & vbCrLf & _
        "⏭ Skipped (already exported at this REV): " & skippedCount & vbCrLf & _
        "⚠ Errors: " & errorLog.Length, "Export Summary")
End Sub

Function GetFolder(prompt As String) As String
    Dim dlg As New FolderBrowserDialog
    dlg.Description = prompt
    If dlg.ShowDialog() <> DialogResult.OK Then Return ""
    Return dlg.SelectedPath
End Function

Function ConfirmProceed() As Boolean
    Dim result = MessageBox.Show("Export DWGs only if target REV file does not exist?", "Confirm Export", MessageBoxButtons.YesNo)
    Return result = DialogResult.Yes
End Function

Function SanitizeFileName(input As String) As String
    For Each c As Char In System.IO.Path.GetInvalidFileNameChars()
        input = input.Replace(c, "_")
    Next
    Return input
End Function
```

#### Code Block 3

```vb
ThisRule rule;
rule.ThisApplication = GetInventor();
rule.Main();
```

#### Code Block 4

```vb
ThisRule rule;
rule.ThisApplication = GetInventor();
rule.Main();
```

#### Code Block 5

```vb
ThisRule rule;
rule.ThisApplication = GetInventor();
rule.Main();
```

#### Code Block 6

```vb
ThisRule rule;
rule.ThisApplication = GetInventor();
rule.Main();
```

#### Code Block 7

```vb
class ThisRule { 
public:
    CComPtr<Application> ThisApplication;

    void Main() {

        HRESULT Result = NOERROR;

        CComPtr<Document> gDoc;
        Result = ThisApplication->get_ActiveDocument(&gDoc);

        CComPtr<DrawingDocument> doc;
        doc = gDoc;
        
        CComPtr<TranslationContext> context;
        Result = ThisApplication->TransientObjects->CreateTranslationContext(&context);
        context->put_Type(kFileBrowseIOMechanism);

        CComPtr<NameValueMap> options;
        Result = ThisApplication->TransientObjects->CreateNameValueMap(&options);

        CComPtr<DataMedium> dataMedium;
        Result = ThisApplication->TransientObjects->CreateDataMedium(&dataMedium);

        CComPtr<TranslatorAddIn> translator;
        translator = GetDwgTranslator();


        if (translator->HasSaveCopyAsOptions[doc][context][options]) {
            _bstr_t iniFileName = _T("D:\\forum\\\\dwgExport.ini");

            VARIANT varProtType;
            varProtType.vt = VT_BSTR;
            varProtType.bstrVal = iniFileName;

            Result = options->put_Value(_T("Export_Acad_IniFile"), varProtType);
        }

        _bstr_t dwgFileName("D:\\forum\\Drawing1_AutoCAD.dwg");
        Result = dataMedium->put_FileName(dwgFileName);

        Result = translator->SaveCopyAs(doc, context, options, dataMedium);
    }

private:
    CComPtr<TranslatorAddIn> GetDwgTranslator() {
        HRESULT Result = NOERROR;

        _bstr_t ClientId = _T("{C24E3AC2-122E-11D5-8E91-0010B541CD80}");

        CComPtr<ApplicationAddIn> addin;
        Result = ThisApplication->ApplicationAddIns->get_ItemById(ClientId, &addin);

        CComPtr<TranslatorAddIn> translator;
        translator = addin;

        return translator;
    }
};
```

#### Code Block 8

```vb
class ThisRule { 
public:
    CComPtr<Application> ThisApplication;

    void Main() {

        HRESULT Result = NOERROR;

        CComPtr<Document> gDoc;
        Result = ThisApplication->get_ActiveDocument(&gDoc);

        CComPtr<DrawingDocument> doc;
        doc = gDoc;
        
        CComPtr<TranslationContext> context;
        Result = ThisApplication->TransientObjects->CreateTranslationContext(&context);
        context->put_Type(kFileBrowseIOMechanism);

        CComPtr<NameValueMap> options;
        Result = ThisApplication->TransientObjects->CreateNameValueMap(&options);

        CComPtr<DataMedium> dataMedium;
        Result = ThisApplication->TransientObjects->CreateDataMedium(&dataMedium);

        CComPtr<TranslatorAddIn> translator;
        translator = GetDwgTranslator();


        if (translator->HasSaveCopyAsOptions[doc][context][options]) {
            _bstr_t iniFileName = _T("D:\\forum\\\\dwgExport.ini");

            VARIANT varProtType;
            varProtType.vt = VT_BSTR;
            varProtType.bstrVal = iniFileName;

            Result = options->put_Value(_T("Export_Acad_IniFile"), varProtType);
        }

        _bstr_t dwgFileName("D:\\forum\\Drawing1_AutoCAD.dwg");
        Result = dataMedium->put_FileName(dwgFileName);

        Result = translator->SaveCopyAs(doc, context, options, dataMedium);
    }

private:
    CComPtr<TranslatorAddIn> GetDwgTranslator() {
        HRESULT Result = NOERROR;

        _bstr_t ClientId = _T("{C24E3AC2-122E-11D5-8E91-0010B541CD80}");

        CComPtr<ApplicationAddIn> addin;
        Result = ThisApplication->ApplicationAddIns->get_ItemById(ClientId, &addin);

        CComPtr<TranslatorAddIn> translator;
        translator = addin;

        return translator;
    }
};
```

#### Code Block 9

```vb
class ThisRule { 
public:
    CComPtr<Application> ThisApplication;

    void Main() {

        HRESULT Result = NOERROR;

        CComPtr<Document> gDoc;
        Result = ThisApplication->get_ActiveDocument(&gDoc);

        CComPtr<DrawingDocument> doc;
        doc = gDoc;
        
        CComPtr<TranslationContext> context;
        Result = ThisApplication->TransientObjects->CreateTranslationContext(&context);
        context->put_Type(kFileBrowseIOMechanism);

        CComPtr<NameValueMap> options;
        Result = ThisApplication->TransientObjects->CreateNameValueMap(&options);

        CComPtr<DataMedium> dataMedium;
        Result = ThisApplication->TransientObjects->CreateDataMedium(&dataMedium);

        CComPtr<TranslatorAddIn> translator;
        translator = GetDwgTranslator();


        if (translator->HasSaveCopyAsOptions[doc][context][options]) {
            _bstr_t iniFileName = _T("D:\\forum\\\\dwgExport.ini");

            VARIANT varProtType;
            varProtType.vt = VT_BSTR;
            varProtType.bstrVal = iniFileName;

            Result = options->put_Value(_T("Export_Acad_IniFile"), varProtType);
        }

        _bstr_t dwgFileName("D:\\forum\\Drawing1_AutoCAD.dwg");
        Result = dataMedium->put_FileName(dwgFileName);

        Result = translator->SaveCopyAs(doc, context, options, dataMedium);
    }

private:
    CComPtr<TranslatorAddIn> GetDwgTranslator() {
        HRESULT Result = NOERROR;

        _bstr_t ClientId = _T("{C24E3AC2-122E-11D5-8E91-0010B541CD80}");

        CComPtr<ApplicationAddIn> addin;
        Result = ThisApplication->ApplicationAddIns->get_ItemById(ClientId, &addin);

        CComPtr<TranslatorAddIn> translator;
        translator = addin;

        return translator;
    }
};
```

#### Code Block 10

```vb
class ThisRule { 
public:
    CComPtr<Application> ThisApplication;

    void Main() {

        HRESULT Result = NOERROR;

        CComPtr<Document> gDoc;
        Result = ThisApplication->get_ActiveDocument(&gDoc);

        CComPtr<DrawingDocument> doc;
        doc = gDoc;
        
        CComPtr<TranslationContext> context;
        Result = ThisApplication->TransientObjects->CreateTranslationContext(&context);
        context->put_Type(kFileBrowseIOMechanism);

        CComPtr<NameValueMap> options;
        Result = ThisApplication->TransientObjects->CreateNameValueMap(&options);

        CComPtr<DataMedium> dataMedium;
        Result = ThisApplication->TransientObjects->CreateDataMedium(&dataMedium);

        CComPtr<TranslatorAddIn> translator;
        translator = GetDwgTranslator();


        if (translator->HasSaveCopyAsOptions[doc][context][options]) {
            _bstr_t iniFileName = _T("D:\\forum\\\\dwgExport.ini");

            VARIANT varProtType;
            varProtType.vt = VT_BSTR;
            varProtType.bstrVal = iniFileName;

            Result = options->put_Value(_T("Export_Acad_IniFile"), varProtType);
        }

        _bstr_t dwgFileName("D:\\forum\\Drawing1_AutoCAD.dwg");
        Result = dataMedium->put_FileName(dwgFileName);

        Result = translator->SaveCopyAs(doc, context, options, dataMedium);
    }

private:
    CComPtr<TranslatorAddIn> GetDwgTranslator() {
        HRESULT Result = NOERROR;

        _bstr_t ClientId = _T("{C24E3AC2-122E-11D5-8E91-0010B541CD80}");

        CComPtr<ApplicationAddIn> addin;
        Result = ThisApplication->ApplicationAddIns->get_ItemById(ClientId, &addin);

        CComPtr<TranslatorAddIn> translator;
        translator = addin;

        return translator;
    }
};
```

---

### 22. Inventor Vb.Net &quot;AddIn&quot; - Change A Drawing View

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/inventor-vb-net-quot-addin-quot-change-a-drawing-view/td-p/13828621#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/inventor-vb-net-quot-addin-quot-change-a-drawing-view/td-p/13828621#messageview_0)

**Author:** isocam

**Date:** ‎09-28-2025
	
		
		02:27 AM

**Description:** Can anybody help? I am creating a Vb.Net "AddIn" for Autodesk Inventor. I have a part (ipt) and a drawing (idw) document called.... 1000.ipt & 1000.idw I have created a copy the two documents so they become 2000.ipt & 2000.idw At this stage everything looks OK. However, When I open the drawing 2000....

**Code Snippets (2):**

#### Code Block 1

```vb
Sub ReplaceModelReference(drawing As DrawingDocument, newFile As String)
    'This assumes the drawing references only one model

    ' EDIT: Line replaced as suggested by @WCrihfield 
    'Dim fileDescriptor As FileDescriptor = drawing.ReferencedFileDescriptors(1).DocumentDescriptor.ReferencedFileDescriptor
    Dim fileDescriptor As FileDescriptor = drawing.ReferencedDocumentDescriptors(1).ReferencedFileDescriptor


    fileDescriptor.ReplaceReference(newFile)
End Sub
```

#### Code Block 2

```vb
Sub ReplaceModelReference(drawing As DrawingDocument, newFile As String)
    'This assumes the drawing references only one model

    ' EDIT: Line replaced as suggested by @WCrihfield 
    'Dim fileDescriptor As FileDescriptor = drawing.ReferencedFileDescriptors(1).DocumentDescriptor.ReferencedFileDescriptor
    Dim fileDescriptor As FileDescriptor = drawing.ReferencedDocumentDescriptors(1).ReferencedFileDescriptor


    fileDescriptor.ReplaceReference(newFile)
End Sub
```

---

### 23. Invisible / abandoned weld seam symbols in drawing

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/invisible-abandoned-weld-seam-symbols-in-drawing/td-p/13837112](https://forums.autodesk.com/t5/inventor-programming-forum/invisible-abandoned-weld-seam-symbols-in-drawing/td-p/13837112)

**Author:** ThoStt

**Date:** ‎10-04-2025
	
		
		07:59 AM

**Description:** Hello, I am trying to cycle with an ilogic script through all weld symbols in a drawing. This script should show the position of each weld symbol in a messagebox.So far, the script works fine. However, it also displays the position or other properties of weld symbols that are not visible on the draw...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim oActiveDoc As DrawingDocument = ThisApplication.ActiveDocument

For Each oSheet As Sheet In oActiveDoc.Sheets

	For Each oDrawingWeldsymbol As DrawingWeldingSymbol In oSheet.WeldingSymbols

			MsgBox(oDrawingWeldsymbol.Position.X & vbCrLf & oDrawingWeldsymbol.Position.Y)
			
	Next

Next
```

#### Code Block 2

```vb
Dim oActiveDoc As DrawingDocument = ThisApplication.ActiveDocument

For Each oSheet As Sheet In oActiveDoc.Sheets

	For Each oDrawingWeldsymbol As DrawingWeldingSymbol In oSheet.WeldingSymbols

			MsgBox(oDrawingWeldsymbol.Position.X & vbCrLf & oDrawingWeldsymbol.Position.Y)
			
	Next

Next
```

---

### 24. Load second vba project file or reference subroutine in other project file

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/load-second-vba-project-file-or-reference-subroutine-in-other/td-p/4861128](https://forums.autodesk.com/t5/inventor-programming-forum/load-second-vba-project-file-or-reference-subroutine-in-other/td-p/4861128)

**Author:** pball

**Date:** ‎03-06-2014
	
		
		08:45 AM

**Description:** I'm looking to use two vba project files. I'll have my main ivb file and there is a second ivb file with a single script in it. I do not want to copy that script to the other project file. Is there a way to load or link the second project file from the main one?Another thing is I've manually loaded ...

**Code Snippets (1):**

#### Code Block 1

```vb
Public Sub LoadVBAProject() LoadAnotherVBAProject "Put Location of VBA project here"End SubPublic Sub LoadAnotherVBAProject(pvarLocation As String) ' counter to work out the new project number Dim varVBACounter As Long varVBACounter = ThisApplication.VBAProjects.Count ' Open the other project ThisApplication.VBAProjects.Open pvarLocation ' get a reference to the just opened VBA project Dim varTempProject As InventorVBAProject Set varTempProject = ThisApplication.VBAProjects(varVBACounter + 1) ' references for all the different parts of the VBA project Dim varVBAComponent As InventorVBAComponent Dim varVBAMember As InventorVBAMember Dim varVBAArgument As InventorVBAArgument ' go through all the components of the Project and display them For Each varVBAComponent In varTempProject.InventorVBAComponents ' print to the immediate window the name of the component Debug.Print varVBAComponent.Name For Each varVBAMember In varVBAComponent.InventorVBAMembers ' print to the immediate window the name of the members of the component Debug.Print " " & varVBAMember.Name For Each varVBAArgument In varVBAMember.Arguments Debug.Print " " & varVBAArgument.Name & "----" & varVBAArgument.ArgumentType Next varVBAArgument Next varVBAMember Next varVBAComponentEnd Sub
```

#### Code Block 2

```vb
Public Sub LoadVBAProject() LoadAnotherVBAProject "Put Location of VBA project here"End SubPublic Sub LoadAnotherVBAProject(pvarLocation As String) ' counter to work out the new project number Dim varVBACounter As Long varVBACounter = ThisApplication.VBAProjects.Count ' Open the other project ThisApplication.VBAProjects.Open pvarLocation ' get a reference to the just opened VBA project Dim varTempProject As InventorVBAProject Set varTempProject = ThisApplication.VBAProjects(varVBACounter + 1) ' references for all the different parts of the VBA project Dim varVBAComponent As InventorVBAComponent Dim varVBAMember As InventorVBAMember Dim varVBAArgument As InventorVBAArgument ' go through all the components of the Project and display them For Each varVBAComponent In varTempProject.InventorVBAComponents ' print to the immediate window the name of the component Debug.Print varVBAComponent.Name For Each varVBAMember In varVBAComponent.InventorVBAMembers ' print to the immediate window the name of the members of the component Debug.Print " " & varVBAMember.Name For Each varVBAArgument In varVBAMember.Arguments Debug.Print " " & varVBAArgument.Name & "----" & varVBAArgument.ArgumentType Next varVBAArgument Next varVBAMember Next varVBAComponentEnd Sub
```

#### Code Block 3

```vb
Public Sub LoadVBAProject() LoadAnotherVBAProject "Put Location of VBA project here"End SubPublic Sub LoadAnotherVBAProject(pvarLocation As String) ' counter to work out the new project number Dim varVBACounter As Long varVBACounter = ThisApplication.VBAProjects.Count ' Open the other project ThisApplication.VBAProjects.Open pvarLocation ' get a reference to the just opened VBA project Dim varTempProject As InventorVBAProject Set varTempProject = ThisApplication.VBAProjects(varVBACounter + 1) ' references for all the different parts of the VBA project Dim varVBAComponent As InventorVBAComponent Dim varVBAMember As InventorVBAMember Dim varVBAArgument As InventorVBAArgument ' go through all the components of the Project and display them For Each varVBAComponent In varTempProject.InventorVBAComponents ' print to the immediate window the name of the component Debug.Print varVBAComponent.Name For Each varVBAMember In varVBAComponent.InventorVBAMembers ' print to the immediate window the name of the members of the component Debug.Print " " & varVBAMember.Name For Each varVBAArgument In varVBAMember.Arguments Debug.Print " " & varVBAArgument.Name & "----" & varVBAArgument.ArgumentType Next varVBAArgument Next varVBAMember Next varVBAComponentEnd Sub
```

---

### 25. Loading an Icon in Inventor 2025

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/loading-an-icon-in-inventor-2025/td-p/12745530#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/loading-an-icon-in-inventor-2025/td-p/12745530#messageview_0)

**Author:** pfk

**Date:** ‎05-01-2024
	
		
		02:06 AM

**Description:** Hi My Inventor 2024 addin uses the following to put a button with an icon on the toolbar.              stdole.IPictureDisp standardIconIPictureDisp = null;             stdole.IPictureDisp largeIconIPictureDisp = null;             if (standardIcon != null)             { #pragma warning disable CS0618...

**Code Snippets (2):**

#### Code Block 1

```vb
stdole.IPictureDisp standardIconIPictureDisp = null;
            stdole.IPictureDisp largeIconIPictureDisp = null;
            if (standardIcon != null)
            {
#pragma warning disable CS0618 // Type or member is obsolete
                standardIconIPictureDisp = Support.IconToIPicture(standardIcon) as stdole.IPictureDisp;
                largeIconIPictureDisp = (stdole.IPictureDisp)Support.IconToIPicture(largeIcon);
#pragma warning restore CS0618 // Type or member is obsolete
            }

            mButtonDef = AddinGlobal.InventorApp.CommandManager.ControlDefinitions.AddButtonDefinition(
                displayName, internalName, commandType,
                clientId, description, tooltip,
                standardIconIPictureDisp, largeIconIPictureDisp, buttonDisplayType);
```

#### Code Block 2

```vb
stdole.IPictureDisp standardIconIPictureDisp = null;
            stdole.IPictureDisp largeIconIPictureDisp = null;
            if (standardIcon != null)
            {
#pragma warning disable CS0618 // Type or member is obsolete
                standardIconIPictureDisp = Support.IconToIPicture(standardIcon) as stdole.IPictureDisp;
                largeIconIPictureDisp = (stdole.IPictureDisp)Support.IconToIPicture(largeIcon);
#pragma warning restore CS0618 // Type or member is obsolete
            }

            mButtonDef = AddinGlobal.InventorApp.CommandManager.ControlDefinitions.AddButtonDefinition(
                displayName, internalName, commandType,
                clientId, description, tooltip,
                standardIconIPictureDisp, largeIconIPictureDisp, buttonDisplayType);
```

#### Code Block 3

```vb
stdole.IPictureDisp standardIconIPictureDisp = null;
            stdole.IPictureDisp largeIconIPictureDisp = null;
            if (standardIcon != null)
            {
#pragma warning disable CS0618 // Type or member is obsolete
                standardIconIPictureDisp = Support.IconToIPicture(standardIcon) as stdole.IPictureDisp;
                largeIconIPictureDisp = (stdole.IPictureDisp)Support.IconToIPicture(largeIcon);
#pragma warning restore CS0618 // Type or member is obsolete
            }

            mButtonDef = AddinGlobal.InventorApp.CommandManager.ControlDefinitions.AddButtonDefinition(
                displayName, internalName, commandType,
                clientId, description, tooltip,
                standardIconIPictureDisp, largeIconIPictureDisp, buttonDisplayType);
```

#### Code Block 4

```vb
stdole.IPictureDisp standardIconIPictureDisp = null;
            stdole.IPictureDisp largeIconIPictureDisp = null;
            if (standardIcon != null)
            {
#pragma warning disable CS0618 // Type or member is obsolete
                standardIconIPictureDisp = Support.IconToIPicture(standardIcon) as stdole.IPictureDisp;
                largeIconIPictureDisp = (stdole.IPictureDisp)Support.IconToIPicture(largeIcon);
#pragma warning restore CS0618 // Type or member is obsolete
            }

            mButtonDef = AddinGlobal.InventorApp.CommandManager.ControlDefinitions.AddButtonDefinition(
                displayName, internalName, commandType,
                clientId, description, tooltip,
                standardIconIPictureDisp, largeIconIPictureDisp, buttonDisplayType);
```

---

### 26. Looking for some &quot;fun&quot; iLogic code for a T-Shirt

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/looking-for-some-quot-fun-quot-ilogic-code-for-a-t-shirt/td-p/13840538#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/looking-for-some-quot-fun-quot-ilogic-code-for-a-t-shirt/td-p/13840538#messageview_0)

**Author:** chris

**Date:** ‎10-06-2025
	
		
		07:08 PM

**Description:** I'm looking to add some fun or unique iLogic code for a T-Shirt that I'm making for the designers at work. Can anyone think of some fun code that might look cool or fun on the back of a shirt? (it can be short or long), just looking for something fun/cool, I plan on using the code edit colors as wel...

**Code Snippets (8):**

#### Code Block 1

```vb
Dim Stress As Double = 0
While Project.Deadline < Now
    Stress += 1
    Sleep(1)
End While
```

#### Code Block 2

```vb
Dim Stress As Double = 0
While Project.Deadline < Now
    Stress += 1
    Sleep(1)
End While
```

#### Code Block 3

```vb
Do Until Sketch.Perfect = True
    IterateDesign()
Loop
```

#### Code Block 4

```vb
Do Until Sketch.Perfect = True
    IterateDesign()
Loop
```

#### Code Block 5

```vb
If Coffee.Level < 10 Then
    Call Coffee.Refill()
    Return
End If
Call Design.Part("Brilliance")
```

#### Code Block 6

```vb
If Coffee.Level < 10 Then
    Call Coffee.Refill()
    Return
End If
Call Design.Part("Brilliance")
```

#### Code Block 7

```vb
If Not Coffee.Exists Then
    System.Collapse()
End If
```

#### Code Block 8

```vb
If Not Coffee.Exists Then
    System.Collapse()
End If
```

#### Code Block 9

```vb
If You.AreConstrainedTo(Me) Then
    Life.IsFullyDefined = True
End If
```

#### Code Block 10

```vb
If You.AreConstrainedTo(Me) Then
    Life.IsFullyDefined = True
End If
```

#### Code Block 11

```vb
If You.Fit(My.Mate) Then
    Let'sAssemble()
End If
```

#### Code Block 12

```vb
If You.Fit(My.Mate) Then
    Let'sAssemble()
End If
```

#### Code Block 13

```vb
Sub EngineeringProcess()
    ' Engineering is spelled: C-H-A-N-G-E
    
    Design = CreateInitialConcept()
    SendToClient()
    
    While (ProjectNotCancelled)
        changeRequest = Client.SendEmail()
        
        Select Case changeRequest.Severity
            Case "Minor tweak"
                RedoEverything()
            Case "Small adjustment"
                StartFromScratch()
            Case "Just one little thing"
                QuestionCareerPath()
        End Select
        
        UpdateRevisionNumber() ' Now at Rev ZZ.47
        
        If (design.LooksLikeOriginalConcept = False) Then
            Console.WriteLine("Nailed it! ��")
        End If
        
        WaitForNextChangeRequest(milliseconds:=3)
    End While
    
    ' Note: ProjectNotCancelled always returns True
End Sub
```

#### Code Block 14

```vb
Sub EngineeringProcess()
    ' Engineering is spelled: C-H-A-N-G-E
    
    Design = CreateInitialConcept()
    SendToClient()
    
    While (ProjectNotCancelled)
        changeRequest = Client.SendEmail()
        
        Select Case changeRequest.Severity
            Case "Minor tweak"
                RedoEverything()
            Case "Small adjustment"
                StartFromScratch()
            Case "Just one little thing"
                QuestionCareerPath()
        End Select
        
        UpdateRevisionNumber() ' Now at Rev ZZ.47
        
        If (design.LooksLikeOriginalConcept = False) Then
            Console.WriteLine("Nailed it! ��")
        End If
        
        WaitForNextChangeRequest(milliseconds:=3)
    End While
    
    ' Note: ProjectNotCancelled always returns True
End Sub
```

#### Code Block 15

```vb
Try
    OpenInventor()
    StartDesigning("GeniusPart")
    While Not Done
        Iterate()
        Overthink()
    End While
Catch ex As BurnoutException
    Coffee.Refill()
    Resume Next
End Try
```

#### Code Block 16

```vb
Try
    OpenInventor()
    StartDesigning("GeniusPart")
    While Not Done
        Iterate()
        Overthink()
    End While
Catch ex As BurnoutException
    Coffee.Refill()
    Resume Next
End Try
```

---

### 27. Macro to delete specific sketch symbol?

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/macro-to-delete-specific-sketch-symbol/td-p/13783606#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/macro-to-delete-specific-sketch-symbol/td-p/13783606#messageview_0)

**Author:** jacob_r_kane

**Date:** ‎08-26-2025
	
		
		08:37 AM

**Description:** Hello,Without spending days trying to learn this myself, what is the code to scan all drawing sheets, and delete a sketch symbol named rev triangle?Thanks 					 				 			 			 				 			 			 				 	 			 				 					 						Solved! 					 					Go to Solution.

**Code Snippets (6):**

#### Code Block 1

```vb
Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, Inventor.DrawingDocument)
If oDDoc Is Nothing Then Return
For Each oSheet As Inventor.Sheet In oDDoc.Sheets
	For Each oSS As SketchedSymbol In oSheet.SketchedSymbols
		If oSS.Name = "rev triangle" Then
			oSS.Delete()
		End If
	Next 'oSS
Next 'oSheet
```

#### Code Block 2

```vb
Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, Inventor.DrawingDocument)
If oDDoc Is Nothing Then Return
For Each oSheet As Inventor.Sheet In oDDoc.Sheets
	For Each oSS As SketchedSymbol In oSheet.SketchedSymbols
		If oSS.Name = "rev triangle" Then
			oSS.Delete()
		End If
	Next 'oSS
Next 'oSheet
```

#### Code Block 3

```vb
Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, Inventor.DrawingDocument)
If oDDoc Is Nothing Then Return
For Each oSheet As Inventor.Sheet In oDDoc.Sheets
	For Each oSS As SketchedSymbol In oSheet.SketchedSymbols
		If oSS.Name = "rev triangle" Then
			oSS.Delete()
		End If
	Next 'oSS
Next 'oSheet
```

#### Code Block 4

```vb
Dim oDDoc As DrawingDocument = TryCast(ThisDoc.Document, Inventor.DrawingDocument)
If oDDoc Is Nothing Then Return
For Each oSheet As Inventor.Sheet In oDDoc.Sheets
	For Each oSS As SketchedSymbol In oSheet.SketchedSymbols
		If oSS.Name = "rev triangle" Then
			oSS.Delete()
		End If
	Next 'oSS
Next 'oSheet
```

#### Code Block 5

```vb
Public Sub DeleteSpecificSketchSymbol()
    ' Set a reference to the active drawing document.
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.ActiveDocument
    ' Define the name of the sketch symbol to delete.
    Const sSymbolName As String = "Rev Triangle" ' Replace with the actual symbol name
    ' Loop through each sheet in the drawing document.
    Dim oSheet As Sheet
    For Each oSheet In oDrawDoc.Sheets
        ' Activate the current sheet (optional, but good practice for visibility).
        oSheet.Activate
        ' Loop through each sketched symbol on the current sheet.
        Dim oSketchedSymbol As SketchedSymbol
        Dim i As Long
        For i = oSheet.SketchedSymbols.Count To 1 Step -1 ' Loop backwards to avoid issues when deleting
            Set oSketchedSymbol = oSheet.SketchedSymbols.Item(i)
            ' Check if the symbol's name matches the target name.
            If oSketchedSymbol.Name = sSymbolName Then
                ' Delete the instance of the sketch symbol.
                oSketchedSymbol.Delete
            End If
        Next i
    Next oSheet
End Sub
```

#### Code Block 6

```vb
Public Sub DeleteSpecificSketchSymbol()
    ' Set a reference to the active drawing document.
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.ActiveDocument
    ' Define the name of the sketch symbol to delete.
    Const sSymbolName As String = "Rev Triangle" ' Replace with the actual symbol name
    ' Loop through each sheet in the drawing document.
    Dim oSheet As Sheet
    For Each oSheet In oDrawDoc.Sheets
        ' Activate the current sheet (optional, but good practice for visibility).
        oSheet.Activate
        ' Loop through each sketched symbol on the current sheet.
        Dim oSketchedSymbol As SketchedSymbol
        Dim i As Long
        For i = oSheet.SketchedSymbols.Count To 1 Step -1 ' Loop backwards to avoid issues when deleting
            Set oSketchedSymbol = oSheet.SketchedSymbols.Item(i)
            ' Check if the symbol's name matches the target name.
            If oSketchedSymbol.Name = sSymbolName Then
                ' Delete the instance of the sketch symbol.
                oSketchedSymbol.Delete
            End If
        Next i
    Next oSheet
End Sub
```

#### Code Block 7

```vb
Public Sub DeleteSpecificSketchSymbol()
    ' Set a reference to the active drawing document.
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.ActiveDocument
    ' Define the name of the sketch symbol to delete.
    Const sSymbolName As String = "Rev Triangle" ' Replace with the actual symbol name
    ' Loop through each sheet in the drawing document.
    Dim oSheet As Sheet
    For Each oSheet In oDrawDoc.Sheets
        ' Activate the current sheet (optional, but good practice for visibility).
        oSheet.Activate
        ' Loop through each sketched symbol on the current sheet.
        Dim oSketchedSymbol As SketchedSymbol
        Dim i As Long
        For i = oSheet.SketchedSymbols.Count To 1 Step -1 ' Loop backwards to avoid issues when deleting
            Set oSketchedSymbol = oSheet.SketchedSymbols.Item(i)
            ' Check if the symbol's name matches the target name.
            If oSketchedSymbol.Name = sSymbolName Then
                ' Delete the instance of the sketch symbol.
                oSketchedSymbol.Delete
            End If
        Next i
    Next oSheet
End Sub
```

#### Code Block 8

```vb
Public Sub DeleteSpecificSketchSymbol()
    ' Set a reference to the active drawing document.
    Dim oDrawDoc As DrawingDocument
    Set oDrawDoc = ThisApplication.ActiveDocument
    ' Define the name of the sketch symbol to delete.
    Const sSymbolName As String = "Rev Triangle" ' Replace with the actual symbol name
    ' Loop through each sheet in the drawing document.
    Dim oSheet As Sheet
    For Each oSheet In oDrawDoc.Sheets
        ' Activate the current sheet (optional, but good practice for visibility).
        oSheet.Activate
        ' Loop through each sketched symbol on the current sheet.
        Dim oSketchedSymbol As SketchedSymbol
        Dim i As Long
        For i = oSheet.SketchedSymbols.Count To 1 Step -1 ' Loop backwards to avoid issues when deleting
            Set oSketchedSymbol = oSheet.SketchedSymbols.Item(i)
            ' Check if the symbol's name matches the target name.
            If oSketchedSymbol.Name = sSymbolName Then
                ' Delete the instance of the sketch symbol.
                oSketchedSymbol.Delete
            End If
        Next i
    Next oSheet
End Sub
```

#### Code Block 9

```vb
Sub DeleteRevTriangleSketchedSymbols()
    If Not ThisApplication.ActiveDocumentType = kDrawingDocumentObject Then Return
    Dim oDDoc As DrawingDocument
    Set oDDoc = ThisApplication.ActiveDocument
    Dim oSheet As Inventor.Sheet
    For Each oSheet In oDDoc.Sheets
        Dim oSS As SketchedSymbol
        For Each oSS In oSheet.SketchedSymbols
            If oSS.Name = "rev triangle" Then
                Call oSS.Delete
            End If
        Next 'oSS
    Next 'oSheet
End Sub
```

#### Code Block 10

```vb
Sub DeleteRevTriangleSketchedSymbols()
    If Not ThisApplication.ActiveDocumentType = kDrawingDocumentObject Then Return
    Dim oDDoc As DrawingDocument
    Set oDDoc = ThisApplication.ActiveDocument
    Dim oSheet As Inventor.Sheet
    For Each oSheet In oDDoc.Sheets
        Dim oSS As SketchedSymbol
        For Each oSS In oSheet.SketchedSymbols
            If oSS.Name = "rev triangle" Then
                Call oSS.Delete
            End If
        Next 'oSS
    Next 'oSheet
End Sub
```

#### Code Block 11

```vb
Sub DeleteRevTriangleSketchedSymbols()
    If Not ThisApplication.ActiveDocumentType = kDrawingDocumentObject Then Return
    Dim oDDoc As DrawingDocument
    Set oDDoc = ThisApplication.ActiveDocument
    Dim oSheet As Inventor.Sheet
    For Each oSheet In oDDoc.Sheets
        Dim oSS As SketchedSymbol
        For Each oSS In oSheet.SketchedSymbols
            If oSS.Name = "rev triangle" Then
                Call oSS.Delete
            End If
        Next 'oSS
    Next 'oSheet
End Sub
```

#### Code Block 12

```vb
Sub DeleteRevTriangleSketchedSymbols()
    If Not ThisApplication.ActiveDocumentType = kDrawingDocumentObject Then Return
    Dim oDDoc As DrawingDocument
    Set oDDoc = ThisApplication.ActiveDocument
    Dim oSheet As Inventor.Sheet
    For Each oSheet In oDDoc.Sheets
        Dim oSS As SketchedSymbol
        For Each oSS In oSheet.SketchedSymbols
            If oSS.Name = "rev triangle" Then
                Call oSS.Delete
            End If
        Next 'oSS
    Next 'oSheet
End Sub
```

---

### 28. Reset view lables

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/reset-view-lables/td-p/10468556#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/reset-view-lables/td-p/10468556#messageview_0)

**Author:** sschulteH6WZ3

**Date:** ‎07-14-2021
	
		
		08:09 AM

**Description:** Hi all, have the programmers of Inventor seen their way to allow view letter \ number reset with out going through a bunch of time wasting gymnastics? I have seen people complaining about this on here since 08.

**Code Snippets (1):**

#### Code Block 1

```vb
Sub Main()

Logger.Info(" ")
Logger.Info("RuleName: " & iLogicVb.RuleName)

'Re-numbers all view labels on all sheets
'	handles aplha or numeric
'	option to set all to aplha
'	option to set all to Numeric
'	option to set only details and sections to alpha


oScheme = "Numeric w/ details and sections as Alpha"
'oScheme = "All Numeric"
'oScheme = "All Alpha"

Dim oDoc As DrawingDocument
Dim oSheet As Sheet
Dim oView As DrawingView

'check if active document is a drawing
If ThisApplication.ActiveDocument.DocumentType <> kDrawingDocumentObject Then
	Exit Sub
End If

oDoc = ThisApplication.ActiveDocument

i = 9
k = 1
'Rename view identifiers 
'look at all sheets
For Each oSheet In oDoc.Sheets
	'look at all views on sheet
	For Each oView In oSheet.DrawingViews

		'renumber only detail and section
		If oScheme = "All Numeric" Then
			oView.Name = i
			i = i + 1
		ElseIf oScheme = "All Alpha" Then
			oView.Name = num2Letter(i)
			i = i + 1

		Else If oScheme = "Numeric w/ details and sections as Alpha" Then

			If oView.ViewType = DrawingViewTypeEnum.kSectionDrawingViewType Or _
				oView.ViewType = DrawingViewTypeEnum.kDetailDrawingViewType Then
				oView.Name = num2Letter(i)
				
				'skip I, O, & Q
				If InStr(1, num2Letter(i), "I") > 0 Or _
					InStr(1, num2Letter(i), "O") > 0 Or _
					InStr(1, num2Letter(i), "Q") > 0 Then
					i = i + 1
					oView.Name = num2Letter(i)
				End If
				
				i = i + 1
			Else
				oView.Name = k
				k = k + 1
			End If
		End If
	Next oView
Next oSheet

End Sub

Public Function num2Letter(num As Long) As String
	'converts long to corresponding alpha
	'Ex. 1 = A, 28 = AB

	remain = num Mod 26
	whole = Fix(num / 26)

	If num < 27 Then
		If remain = 0 Then
			num2Letter = "Z"
		Else
			num2Letter = Chr(remain + 64)
		End If
	Else
		If remain = 0 Then
			num2Letter = Chr(whole + 63) & "Z"
		Else
			num2Letter = Chr(whole + 64) & Chr(remain + 64)
		End If
	End If
End Function
```

#### Code Block 2

```vb
Sub Main()

Logger.Info(" ")
Logger.Info("RuleName: " & iLogicVb.RuleName)

'Re-numbers all view labels on all sheets
'	handles aplha or numeric
'	option to set all to aplha
'	option to set all to Numeric
'	option to set only details and sections to alpha


oScheme = "Numeric w/ details and sections as Alpha"
'oScheme = "All Numeric"
'oScheme = "All Alpha"

Dim oDoc As DrawingDocument
Dim oSheet As Sheet
Dim oView As DrawingView

'check if active document is a drawing
If ThisApplication.ActiveDocument.DocumentType <> kDrawingDocumentObject Then
	Exit Sub
End If

oDoc = ThisApplication.ActiveDocument

i = 9
k = 1
'Rename view identifiers 
'look at all sheets
For Each oSheet In oDoc.Sheets
	'look at all views on sheet
	For Each oView In oSheet.DrawingViews

		'renumber only detail and section
		If oScheme = "All Numeric" Then
			oView.Name = i
			i = i + 1
		ElseIf oScheme = "All Alpha" Then
			oView.Name = num2Letter(i)
			i = i + 1

		Else If oScheme = "Numeric w/ details and sections as Alpha" Then

			If oView.ViewType = DrawingViewTypeEnum.kSectionDrawingViewType Or _
				oView.ViewType = DrawingViewTypeEnum.kDetailDrawingViewType Then
				oView.Name = num2Letter(i)
				
				'skip I, O, & Q
				If InStr(1, num2Letter(i), "I") > 0 Or _
					InStr(1, num2Letter(i), "O") > 0 Or _
					InStr(1, num2Letter(i), "Q") > 0 Then
					i = i + 1
					oView.Name = num2Letter(i)
				End If
				
				i = i + 1
			Else
				oView.Name = k
				k = k + 1
			End If
		End If
	Next oView
Next oSheet

End Sub

Public Function num2Letter(num As Long) As String
	'converts long to corresponding alpha
	'Ex. 1 = A, 28 = AB

	remain = num Mod 26
	whole = Fix(num / 26)

	If num < 27 Then
		If remain = 0 Then
			num2Letter = "Z"
		Else
			num2Letter = Chr(remain + 64)
		End If
	Else
		If remain = 0 Then
			num2Letter = Chr(whole + 63) & "Z"
		Else
			num2Letter = Chr(whole + 64) & Chr(remain + 64)
		End If
	End If
End Function
```

---

### 29. Rule with multiple options

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/rule-with-multiple-options/td-p/13783705](https://forums.autodesk.com/t5/inventor-programming-forum/rule-with-multiple-options/td-p/13783705)

**Author:** KaynePellegrino

**Date:** ‎08-26-2025
	
		
		09:28 AM

**Description:** This is a long one.------------------------ I make doors. They can be different Widths and Heights, among different Types.Widths:3-6 (41.75")3-0 (35.75")2-10 (33.75")2-8 (31.75")2-6 (29.75") Heights:8-0 (95.375")6-8 (79.375") Types:1K (1-Panel)2K (2-Panel3F (3-Panel)3S (3-Panel w/ Glass)50 (5-Panel)...

**Code Snippets (29):**

#### Code Block 1

```vb
'"3F Skin" ActiveIf DoorType = "3F" And DoorWidthOptions = "3-0" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-10" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-8" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-6" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If
'"3F (3-6) Skin" Active
If DoorType = "3F" And DoorWidthOptions = "3-6" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If
```

#### Code Block 2

```vb
'"3F Skin" ActiveIf DoorType = "3F" And DoorWidthOptions = "3-0" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-10" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-8" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-6" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If
'"3F (3-6) Skin" Active
If DoorType = "3F" And DoorWidthOptions = "3-6" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If
```

#### Code Block 3

```vb
'Door Height
If DoorHeightOptions = "6-8" Then
		DoorHeight = 79.375
	End If

If  DoorHeightOptions = "8-0" Then
		DoorHeight = 95.375
	End If


'Door Width
If DoorWidthOptions = "3-6" Then
		DoorWidth = 41.75
	End If

If DoorWidthOptions = "3-0" Then
		DoorWidth = 35.75
	End If

If DoorWidthOptions = "2-10" Then
		DoorWidth = 33.75
	End If

If DoorWidthOptions = "2-8" Then
		DoorWidth = 31.75
	End If

If DoorWidthOptions = "2-6" Then
		DoorWidth = 29.75
	End If
```

#### Code Block 4

```vb
'Door Height
If DoorHeightOptions = "6-8" Then
		DoorHeight = 79.375
	End If

If  DoorHeightOptions = "8-0" Then
		DoorHeight = 95.375
	End If


'Door Width
If DoorWidthOptions = "3-6" Then
		DoorWidth = 41.75
	End If

If DoorWidthOptions = "3-0" Then
		DoorWidth = 35.75
	End If

If DoorWidthOptions = "2-10" Then
		DoorWidth = 33.75
	End If

If DoorWidthOptions = "2-8" Then
		DoorWidth = 31.75
	End If

If DoorWidthOptions = "2-6" Then
		DoorWidth = 29.75
	End If
```

#### Code Block 5

```vb
'Door Height
If DoorHeightOptions = "6-8" Then
		DoorHeight = 79.375
	End If

If DoorHeightOptions = "8-0" Then
		DoorHeight = 95.375
	End If
```

#### Code Block 6

```vb
'Door Height
If DoorHeightOptions = "6-8" Then
		DoorHeight = 79.375
	End If

If DoorHeightOptions = "8-0" Then
		DoorHeight = 95.375
	End If
```

#### Code Block 7

```vb
'Door Type
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False

If DoorType = "1K" Then
		Component.IsActive("1K Skin: Back") = True
		Component.IsActive("1K Skin: Front") = True
	End If

If DoorType = "2K" Then
		Component.IsActive("2K Skin: Back") = True
		Component.IsActive("2K Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidth <= 40 Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidth >= 40  And DoorHeightOptions = "8-0" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If

If DoorType = "3S" Then
		Component.IsActive("3S Skin: Back") = True
		Component.IsActive("3S Skin: Front") = True
	End If

If DoorType = "50" Then
		Component.IsActive("50 Skin: Back") = True
		Component.IsActive("50 Skin: Front") = True
	End If
```

#### Code Block 8

```vb
'Door Type
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False

If DoorType = "1K" Then
		Component.IsActive("1K Skin: Back") = True
		Component.IsActive("1K Skin: Front") = True
	End If

If DoorType = "2K" Then
		Component.IsActive("2K Skin: Back") = True
		Component.IsActive("2K Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidth <= 40 Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidth >= 40  And DoorHeightOptions = "8-0" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If

If DoorType = "3S" Then
		Component.IsActive("3S Skin: Back") = True
		Component.IsActive("3S Skin: Front") = True
	End If

If DoorType = "50" Then
		Component.IsActive("50 Skin: Back") = True
		Component.IsActive("50 Skin: Front") = True
	End If
```

#### Code Block 9

```vb
'Door Type
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False

If DoorType = "1K" Then
		Component.IsActive("1K Skin: Back") = True
		Component.IsActive("1K Skin: Front") = True
	End If

If DoorType = "2K" Then
		Component.IsActive("2K Skin: Back") = True
		Component.IsActive("2K Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "3-0" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-10" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-8" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-6" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "3-6" And DoorHeightOptions = "8-0" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If

If DoorType = "3S" Then
		Component.IsActive("3S Skin: Back") = True
		Component.IsActive("3S Skin: Front") = True
	End If

If DoorType = "50" Then
		Component.IsActive("50 Skin: Back") = True
		Component.IsActive("50 Skin: Front") = True
	End If
```

#### Code Block 10

```vb
'Door Type
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False

If DoorType = "1K" Then
		Component.IsActive("1K Skin: Back") = True
		Component.IsActive("1K Skin: Front") = True
	End If

If DoorType = "2K" Then
		Component.IsActive("2K Skin: Back") = True
		Component.IsActive("2K Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "3-0" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-10" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-8" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "2-6" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidthOptions = "3-6" And DoorHeightOptions = "8-0" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If

If DoorType = "3S" Then
		Component.IsActive("3S Skin: Back") = True
		Component.IsActive("3S Skin: Front") = True
	End If

If DoorType = "50" Then
		Component.IsActive("50 Skin: Back") = True
		Component.IsActive("50 Skin: Front") = True
	End If
```

#### Code Block 11

```vb
'Door Type
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False

Select Case DoorType
	Case "1K" 
		Component.IsActive("1K Skin: Back") = True
		Component.IsActive("1K Skin: Front") = True
	Case "2K" 
		Component.IsActive("2K Skin: Back") = True
		Component.IsActive("2K Skin: Front") = True
	Case "3F"
		If DoorWidthOptions <> "3-6"
			Component.IsActive("3F Skin: Back") = True
			Component.IsActive("3F Skin: Front") = True
		Else 
			If DoorHeightOptions = "8-0"
				Component.IsActive("3F (3-6) Skin: Back") = True
				Component.IsActive("3F (3-6) Skin: Front") = True
			Else
				MessageBox.Show(String.Format("DoorType = {0} | DoorWidthOptions = {1} | DoorHeightOptions = {2}", DoorType, DoorWidthOptions, DoorHeightOptions).ToString, "Un-Accounted For Result:")
			End If
		End If
	Case "3S" 
		Component.IsActive("3S Skin: Back") = True
		Component.IsActive("3S Skin: Front") = True
	Case "50" 
		Component.IsActive("50 Skin: Back") = True
		Component.IsActive("50 Skin: Front") = True
	Case Else
		MessageBox.Show(String.Format("DoorType = {0}", DoorType).ToString, "Un-Accounted For DoorType:")
End Select
```

#### Code Block 12

```vb
'Door Type
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False

Select Case DoorType
	Case "1K" 
		Component.IsActive("1K Skin: Back") = True
		Component.IsActive("1K Skin: Front") = True
	Case "2K" 
		Component.IsActive("2K Skin: Back") = True
		Component.IsActive("2K Skin: Front") = True
	Case "3F"
		If DoorWidthOptions <> "3-6"
			Component.IsActive("3F Skin: Back") = True
			Component.IsActive("3F Skin: Front") = True
		Else 
			If DoorHeightOptions = "8-0"
				Component.IsActive("3F (3-6) Skin: Back") = True
				Component.IsActive("3F (3-6) Skin: Front") = True
			Else
				MessageBox.Show(String.Format("DoorType = {0} | DoorWidthOptions = {1} | DoorHeightOptions = {2}", DoorType, DoorWidthOptions, DoorHeightOptions).ToString, "Un-Accounted For Result:")
			End If
		End If
	Case "3S" 
		Component.IsActive("3S Skin: Back") = True
		Component.IsActive("3S Skin: Front") = True
	Case "50" 
		Component.IsActive("50 Skin: Back") = True
		Component.IsActive("50 Skin: Front") = True
	Case Else
		MessageBox.Show(String.Format("DoorType = {0}", DoorType).ToString, "Un-Accounted For DoorType:")
End Select
```

#### Code Block 13

```vb
'Door Type
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False

Select Case DoorType
	Case "1K" 
		Component.IsActive("1K Skin: Back") = True
		Component.IsActive("1K Skin: Front") = True
	Case "2K" 
		Component.IsActive("2K Skin: Back") = True
		Component.IsActive("2K Skin: Front") = True
	Case "3F"
		If DoorWidthOptions <> "3-6"
			Component.IsActive("3F Skin: Back") = True
			Component.IsActive("3F Skin: Front") = True
		Else 
			If DoorHeightOptions = "8-0"
				Component.IsActive("3F (3-6) Skin: Back") = True
				Component.IsActive("3F (3-6) Skin: Front") = True
			Else
				MessageBox.Show(String.Format("DoorType = {0} | DoorWidthOptions = {1} | DoorHeightOptions = {2}", DoorType, DoorWidthOptions, DoorHeightOptions).ToString, "Un-Accounted For Result:")
			End If
		End If
	Case "3S" 
		Component.IsActive("3S Skin: Back") = True
		Component.IsActive("3S Skin: Front") = True
	Case "50" 
		Component.IsActive("50 Skin: Back") = True
		Component.IsActive("50 Skin: Front") = True
	Case Else
		MessageBox.Show(String.Format("DoorType = {0}", DoorType).ToString, "Un-Accounted For DoorType:")
End Select
```

#### Code Block 14

```vb
'Door Type
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False

Select Case DoorType
	Case "1K" 
		Component.IsActive("1K Skin: Back") = True
		Component.IsActive("1K Skin: Front") = True
	Case "2K" 
		Component.IsActive("2K Skin: Back") = True
		Component.IsActive("2K Skin: Front") = True
	Case "3F"
		If DoorWidthOptions <> "3-6"
			Component.IsActive("3F Skin: Back") = True
			Component.IsActive("3F Skin: Front") = True
		Else 
			If DoorHeightOptions = "8-0"
				Component.IsActive("3F (3-6) Skin: Back") = True
				Component.IsActive("3F (3-6) Skin: Front") = True
			Else
				MessageBox.Show(String.Format("DoorType = {0} | DoorWidthOptions = {1} | DoorHeightOptions = {2}", DoorType, DoorWidthOptions, DoorHeightOptions).ToString, "Un-Accounted For Result:")
			End If
		End If
	Case "3S" 
		Component.IsActive("3S Skin: Back") = True
		Component.IsActive("3S Skin: Front") = True
	Case "50" 
		Component.IsActive("50 Skin: Back") = True
		Component.IsActive("50 Skin: Front") = True
	Case Else
		MessageBox.Show(String.Format("DoorType = {0}", DoorType).ToString, "Un-Accounted For DoorType:")
End Select
```

#### Code Block 15

```vb
'Door Width
If DoorWidthOptions = "3-6" Then
		DoorWidth = 41.75
	End If

If DoorWidthOptions = "3-0" Then
		DoorWidth = 35.75
	End If

If DoorWidthOptions = "2-10" Then
		DoorWidth = 33.75
	End If

If DoorWidthOptions = "2-8" Then
		DoorWidth = 31.75
	End If

If DoorWidthOptions = "2-6" Then
		DoorWidth = 29.75
	End If
```

#### Code Block 16

```vb
'Door Width
If DoorWidthOptions = "3-6" Then
		DoorWidth = 41.75
	End If

If DoorWidthOptions = "3-0" Then
		DoorWidth = 35.75
	End If

If DoorWidthOptions = "2-10" Then
		DoorWidth = 33.75
	End If

If DoorWidthOptions = "2-8" Then
		DoorWidth = 31.75
	End If

If DoorWidthOptions = "2-6" Then
		DoorWidth = 29.75
	End If
```

#### Code Block 17

```vb
Active_Condition = (DoorType = "3F" And (DoorWidthOptions = "2-6" Or DoorWidthOptions = "2-8" Or DoorWidthOptions = "2-10" Or DoorWidthOptions = "3-0"))

Component.IsActive("1K Skin: Back") = Active_Condition
Component.IsActive("1K Skin: Front") = Active_Condition
Component.IsActive("2K Skin: Back") = Not Active_Condition
Component.IsActive("2K Skin: Front") = Not Active_Condition
Component.IsActive("3F Skin: Back") = Not Active_Condition
Component.IsActive("3F Skin: Front") = Not Active_Condition
Component.IsActive("3F (3-6) Skin: Back") = Not Active_Condition
Component.IsActive("3F (3-6) Skin: Front") = Not Active_Condition
Component.IsActive("3S Skin: Back") = Not Active_Condition
Component.IsActive("3S Skin: Front") = Not Active_Condition
Component.IsActive("50 Skin: Back") = Not Active_Condition
Component.IsActive("50 Skin: Front") = Not Active_Condition
```

#### Code Block 18

```vb
Active_Condition = (DoorType = "3F" And (DoorWidthOptions = "2-6" Or DoorWidthOptions = "2-8" Or DoorWidthOptions = "2-10" Or DoorWidthOptions = "3-0"))

Component.IsActive("1K Skin: Back") = Active_Condition
Component.IsActive("1K Skin: Front") = Active_Condition
Component.IsActive("2K Skin: Back") = Not Active_Condition
Component.IsActive("2K Skin: Front") = Not Active_Condition
Component.IsActive("3F Skin: Back") = Not Active_Condition
Component.IsActive("3F Skin: Front") = Not Active_Condition
Component.IsActive("3F (3-6) Skin: Back") = Not Active_Condition
Component.IsActive("3F (3-6) Skin: Front") = Not Active_Condition
Component.IsActive("3S Skin: Back") = Not Active_Condition
Component.IsActive("3S Skin: Front") = Not Active_Condition
Component.IsActive("50 Skin: Back") = Not Active_Condition
Component.IsActive("50 Skin: Front") = Not Active_Condition
```

#### Code Block 19

```vb
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False
If DoorType = "3F" And DoorWidthO >= 29.75 And DoorWidthO <= 35.75
	Component.IsActive("3F Skin: Back") = True
	Component.IsActive("3F Skin: Front") = True
ElseIf DoorType = "3S" And DoorWidthO >= 29.75 And DoorWidthO <= 35.75
	Component.IsActive("3S Skin: Back") = True
	Component.IsActive("3S Skin: Front") = True
End If
```

#### Code Block 20

```vb
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False
If DoorType = "3F" And DoorWidthO >= 29.75 And DoorWidthO <= 35.75
	Component.IsActive("3F Skin: Back") = True
	Component.IsActive("3F Skin: Front") = True
ElseIf DoorType = "3S" And DoorWidthO >= 29.75 And DoorWidthO <= 35.75
	Component.IsActive("3S Skin: Back") = True
	Component.IsActive("3S Skin: Front") = True
End If
```

#### Code Block 21

```vb
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False
Select Case DoorType
Case "3F"
	Select Case DoorWidthO
	Case 29.75 To 35.75
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True	
	Case 2 To 29.75
		'Etc Etc Etc
	Case Else
		'Etc Etc Etc
	End Select
Case "3S"
	Select Case DoorWidthO
	Case 12 To 20
		Component.IsActive("3S Skin: Back") = True
		Component.IsActive("3S Skin: Front") = True
	Case 2 To 12
		'Etc Etc Etc
	End Select
End Select
```

#### Code Block 22

```vb
Component.IsActive("1K Skin: Back") = False
Component.IsActive("1K Skin: Front") = False
Component.IsActive("2K Skin: Back") = False
Component.IsActive("2K Skin: Front") = False
Component.IsActive("3F Skin: Back") = False
Component.IsActive("3F Skin: Front") = False
Component.IsActive("3F (3-6) Skin: Back") = False
Component.IsActive("3F (3-6) Skin: Front") = False
Component.IsActive("3S Skin: Back") = False
Component.IsActive("3S Skin: Front") = False
Component.IsActive("50 Skin: Back") = False
Component.IsActive("50 Skin: Front") = False
Select Case DoorType
Case "3F"
	Select Case DoorWidthO
	Case 29.75 To 35.75
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True	
	Case 2 To 29.75
		'Etc Etc Etc
	Case Else
		'Etc Etc Etc
	End Select
Case "3S"
	Select Case DoorWidthO
	Case 12 To 20
		Component.IsActive("3S Skin: Back") = True
		Component.IsActive("3S Skin: Front") = True
	Case 2 To 12
		'Etc Etc Etc
	End Select
End Select
```

#### Code Block 23

```vb
Dim A,B,C As String
A = "1"
B = "0"
C = "0"

If A = "1" And (B = "1" Or C = "1")
	MessageBox.Show("1", "Test")
Else
	MessageBox.Show("2", "Test")
end if
```

#### Code Block 24

```vb
Dim A,B,C As String
A = "1"
B = "0"
C = "0"

If A = "1" And (B = "1" Or C = "1")
	MessageBox.Show("1", "Test")
Else
	MessageBox.Show("2", "Test")
end if
```

#### Code Block 25

```vb
Dim DoorWidthOptions As Double = '???
Select Case DoorType
Case "3F"
	Select Case DoorWidthOptions
	Case 18 to 36
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End Select
End Select
```

#### Code Block 26

```vb
Dim DoorWidthOptions As Double = '???
Select Case DoorType
Case "3F"
	Select Case DoorWidthOptions
	Case 18 to 36
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End Select
End Select
```

#### Code Block 27

```vb
Dim DoorWidthOptions As Double = '???
Select Case DoorType
Case "3F"
	Select Case DoorWidthOptions
	Case 36
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	Case 22
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	Case 20
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	Case 18
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End Select
End Select
```

#### Code Block 28

```vb
Dim DoorWidthOptions As Double = '???
Select Case DoorType
Case "3F"
	Select Case DoorWidthOptions
	Case 36
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	Case 22
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	Case 20
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	Case 18
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End Select
End Select
```

#### Code Block 29

```vb
Dim DoorWidthOptions As Double = '???
Select Case DoorType
Case "3F", "3F Skin", "3F (3-6) Skin"
	Select Case DoorWidthOptions
	Case 18, 20, 22, 36
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End Select
End Select
```

#### Code Block 30

```vb
Dim DoorWidthOptions As Double = '???
Select Case DoorType
Case "3F", "3F Skin", "3F (3-6) Skin"
	Select Case DoorWidthOptions
	Case 18, 20, 22, 36
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End Select
End Select
```

#### Code Block 31

```vb
ElseIf DoorWidthOptions = DoorWidthOptions = "3-6" And DoorHeightOptions = "8-0" Then
```

#### Code Block 32

```vb
ElseIf DoorWidthOptions = DoorWidthOptions = "3-6" And DoorHeightOptions = "8-0" Then
```

#### Code Block 33

```vb
If "Variable1" = "OptionA1" And "Variable2" = "OptionB1" OR "OptionB2" Then '(Multiple Options in the Same Line, separated by some kind of 'or' statement)
		"Component1" = True                Else If "Variable2" = "OptionB3" Then                "Component2" = True
	End If
```

#### Code Block 34

```vb
If "Variable1" = "OptionA1" And "Variable2" = "OptionB1" OR "OptionB2" Then '(Multiple Options in the Same Line, separated by some kind of 'or' statement)
		"Component1" = True                Else If "Variable2" = "OptionB3" Then                "Component2" = True
	End If
```

#### Code Block 35

```vb
If (MiddleLetter.StartsWith("D") = True Or MiddleLetter.StartsWith("K") = True) And LastLetter.StartsWith("H") = False Then 
				Tank_Leg_Stand_TC = True	
			Else
				Tank_Leg_Stand_TC = False
			End If
```

#### Code Block 36

```vb
If (MiddleLetter.StartsWith("D") = True Or MiddleLetter.StartsWith("K") = True) And LastLetter.StartsWith("H") = False Then 
				Tank_Leg_Stand_TC = True	
			Else
				Tank_Leg_Stand_TC = False
			End If
```

#### Code Block 37

```vb
If (MiddleLetter.StartsWith("D") = True Or MiddleLetter.StartsWith("K") = True) And LastLetter.StartsWith("H") = False Then 
				Tank_Leg_Stand_TC = True	
			Else
				Tank_Leg_Stand_TC = False
			End If
```

#### Code Block 38

```vb
If (MiddleLetter.StartsWith("D") = True Or MiddleLetter.StartsWith("K") = True) And LastLetter.StartsWith("H") = False Then 
				Tank_Leg_Stand_TC = True	
			Else
				Tank_Leg_Stand_TC = False
			End If
```

#### Code Block 39

```vb
If DoorType = "1K" Then
		Component.IsActive("1K Skin: Back") = True
		Component.IsActive("1K Skin: Front") = True
		Component.IsActive("2K Skin: Back") = False
		Component.IsActive("2K Skin: Front") = False
		Component.IsActive("3F Skin: Back") = False
		Component.IsActive("3F Skin: Front") = False
		Component.IsActive("3F (3-6) Skin: Back") = False
		Component.IsActive("3F (3-6) Skin: Front") = False
		Component.IsActive("3S Skin: Back") = False
		Component.IsActive("3S Skin: Front") = False
		Component.IsActive("50 Skin: Back") = False
		Component.IsActive("50 Skin: Front") = False
	End If
```

#### Code Block 40

```vb
If DoorType = "1K" Then
		Component.IsActive("1K Skin: Back") = True
		Component.IsActive("1K Skin: Front") = True
		Component.IsActive("2K Skin: Back") = False
		Component.IsActive("2K Skin: Front") = False
		Component.IsActive("3F Skin: Back") = False
		Component.IsActive("3F Skin: Front") = False
		Component.IsActive("3F (3-6) Skin: Back") = False
		Component.IsActive("3F (3-6) Skin: Front") = False
		Component.IsActive("3S Skin: Back") = False
		Component.IsActive("3S Skin: Front") = False
		Component.IsActive("50 Skin: Back") = False
		Component.IsActive("50 Skin: Front") = False
	End If
```

#### Code Block 41

```vb
If DoorType = "3F" And DoorWidth <= 40 Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidth >= 40  And DoorHeightOptions = "8-0" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If
```

#### Code Block 42

```vb
If DoorType = "3F" And DoorWidth <= 40 Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End If

If DoorType = "3F" And DoorWidth >= 40  And DoorHeightOptions = "8-0" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If
```

#### Code Block 43

```vb
If DoorType = "3F" And DoorWidth = 35.75, 33.75, 31.75, AndOr 29.75 Then                "Component1" = True        ElseIf DoorWidth = 41.75 Then                "Component2" = True        End If
```

#### Code Block 44

```vb
If DoorType = "3F" And DoorWidth = 35.75, 33.75, 31.75, AndOr 29.75 Then                "Component1" = True        ElseIf DoorWidth = 41.75 Then                "Component2" = True        End If
```

#### Code Block 45

```vb
If DoorType = "3F" And DoorWidthOptions = "3-0" or "2-10" or "2-8" or "2-6" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End IfIf DoorType = "3F" And DoorWidthOptions = "3-6" And DoorHeightOptions = "8-0" Then                Component.IsActive("3F Skin: Back") = True                Component.IsActive("3F Skin: Front") = True        End If
```

#### Code Block 46

```vb
If DoorType = "3F" And DoorWidthOptions = "3-0" or "2-10" or "2-8" or "2-6" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	End IfIf DoorType = "3F" And DoorWidthOptions = "3-6" And DoorHeightOptions = "8-0" Then                Component.IsActive("3F Skin: Back") = True                Component.IsActive("3F Skin: Front") = True        End If
```

#### Code Block 47

```vb
If DoorType = "3F" And DoorWidthOptions = ("2-6" or "2-8" or "2-10" or "3-0") Then
		Component.IsActive("1K Skin: Back") = False
		Component.IsActive("1K Skin: Front") = False
		Component.IsActive("2K Skin: Back") = False
		Component.IsActive("2K Skin: Front") = False
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
		Component.IsActive("3F (3-6) Skin: Back") = False
		Component.IsActive("3F (3-6) Skin: Front") = False
		Component.IsActive("3S Skin: Back") = False
		Component.IsActive("3S Skin: Front") = False
		Component.IsActive("50 Skin: Back") = False
		Component.IsActive("50 Skin: Front") = False
	End If
```

#### Code Block 48

```vb
If DoorType = "3F" And DoorWidthOptions = ("2-6" or "2-8" or "2-10" or "3-0") Then
		Component.IsActive("1K Skin: Back") = False
		Component.IsActive("1K Skin: Front") = False
		Component.IsActive("2K Skin: Back") = False
		Component.IsActive("2K Skin: Front") = False
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
		Component.IsActive("3F (3-6) Skin: Back") = False
		Component.IsActive("3F (3-6) Skin: Front") = False
		Component.IsActive("3S Skin: Back") = False
		Component.IsActive("3S Skin: Front") = False
		Component.IsActive("50 Skin: Back") = False
		Component.IsActive("50 Skin: Front") = False
	End If
```

#### Code Block 49

```vb
If DoorType = "3F" Then
	If DoorWidthOptions = "3-0" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-10" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-8" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-6" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = DoorWidthOptions = "3-6" And DoorHeightOptions = "8-0" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If
```

#### Code Block 50

```vb
If DoorType = "3F" Then
	If DoorWidthOptions = "3-0" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-10" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-8" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-6" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = DoorWidthOptions = "3-6" And DoorHeightOptions = "8-0" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If
```

#### Code Block 51

```vb
If DoorType = "3F" Then
	If DoorWidthOptions = "3-0" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-10" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-8" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-6" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = DoorWidthOptions = "3-6" And DoorHeightOptions = "8-0" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If
ElseIf DoorType = "X" Then
	'Etc etc etc
ElseIf DoorType = "Y" Then
	'Etc etc etc
ElseIf DoorType = "Z" Then
	'Etc etc etc
End If
```

#### Code Block 52

```vb
If DoorType = "3F" Then
	If DoorWidthOptions = "3-0" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-10" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-8" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = "2-6" Then
		Component.IsActive("3F Skin: Back") = True
		Component.IsActive("3F Skin: Front") = True
	ElseIf DoorWidthOptions = DoorWidthOptions = "3-6" And DoorHeightOptions = "8-0" Then
		Component.IsActive("3F (3-6) Skin: Back") = True
		Component.IsActive("3F (3-6) Skin: Front") = True
	End If
ElseIf DoorType = "X" Then
	'Etc etc etc
ElseIf DoorType = "Y" Then
	'Etc etc etc
ElseIf DoorType = "Z" Then
	'Etc etc etc
End If
```

#### Code Block 53

```vb
If DoorWidthOptions <> "3-6"
```

#### Code Block 54

```vb
If DoorWidthOptions <> "3-6"
```

#### Code Block 55

```vb
Sub main()
Dim X as integer = 1
Dim X1 as integer = 2 

Dim Y as integer = 3
Dim Y1 as integer = 4

If (x = x1 and y = y1) or y = 4 then
     'do something
Else if X = Y then 
     'Do something else
Else

End if 





End sub
```

#### Code Block 56

```vb
Sub main()
Dim X as integer = 1
Dim X1 as integer = 2 

Dim Y as integer = 3
Dim Y1 as integer = 4

If (x = x1 and y = y1) or y = 4 then
     'do something
Else if X = Y then 
     'Do something else
Else

End if 





End sub
```

#### Code Block 57

```vb
Sub main()
Dim X as integer = 1
Dim X1 as integer = 2 

Dim Y as integer = 3
Dim Y1 as integer = 4

If (x = x1 and y = y1) or y = 4 then
     'do something
Else if X = Y then 
     'Do something else
Else

End if 





End sub
```

#### Code Block 58

```vb
Sub main()
Dim X as integer = 1
Dim X1 as integer = 2 

Dim Y as integer = 3
Dim Y1 as integer = 4

If (x = x1 and y = y1) or y = 4 then
     'do something
Else if X = Y then 
     'Do something else
Else

End if 





End sub
```

---

### 30. Run iLogic rule from Zero Document ribbon state

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/run-ilogic-rule-from-zero-document-ribbon-state/td-p/6840689#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/run-ilogic-rule-from-zero-document-ribbon-state/td-p/6840689#messageview_0)

**Author:** BrandonBG

**Date:** ‎01-30-2017
	
		
		08:15 AM

**Description:** Any suggestions on how to run an external iLogic rule from a ribbon button macro in the Zero Document state? I'm getting stuck with the VBA line: iLogicAuto.RunExternalRule oDoc, ExternalRuleNameIs it possible to run rules without referencing a document? Brandon

**Code Snippets (3):**

#### Code Block 1

```vb
ThisDoc.Launch("C:\TEMP\Part1.ipt")
oEditDoc = ThisApplication.ActiveEditDocument
MessageBox.Show(oEditDoc.FullFileName, "iLogic")
oEditDoc.Close
```

#### Code Block 2

```vb
iLogicAuto.RunExternalRule oDoc, ExternalRuleName
```

#### Code Block 3

```vb
iLogicVb.RunExternalRule("ruleFileName")
```

---

### 31. Section &amp; Detail View Label

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/section-amp-detail-view-label/td-p/10752080#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/section-amp-detail-view-label/td-p/10752080#messageview_0)

**Author:** Talayoe

**Date:** ‎11-11-2021
	
		
		01:44 PM

**Description:** Good afternoon all, I am working with a large drawing package (for me at least) that is 36 pages long, 25 or so different parts for the build. What I dont care for is that the detail view labels are incrementing thru the entire drawing package and I would rathe have it sheet by sheet, if possible.  ...

**Code Snippets (6):**

#### Code Block 1

```vb
Dim oDoc As DrawingDocument
oDoc = ThisDoc.Document

Dim oSheet As Sheet
Dim oView As DrawingView
Dim oLabel As String
Dim RestartperSheet As Boolean

'Set this value to False if you want te rename views for all sheets
'Set this value to True if you want to rename views per sheet
RestartperSheet = True
'Set Start Label
oLabel = "A"

For Each oSheet In oDoc.Sheets
	'If True Set label Start Value per sheet
	If RestartperSheet = True
		oLabel = "A"
	End If
	For Each oView In oSheet.DrawingViews
		Logger.Info(oView.ViewType & " " & oView.Name)

		Select Case oView.ViewType
			Case kSectionDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kAuxiliaryDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kDetailDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kProjectedDrawingViewType
				If oView.Aligned = False Then
					'Set view name to Label
					oView.Name = oLabel
					'Set Label to next character
					oLabel = Chr(Asc(oLabel) + 1)
				End If
		End Select
	Next
Next
```

#### Code Block 2

```vb
Dim oDoc As DrawingDocument
oDoc = ThisDoc.Document

Dim oSheet As Sheet
Dim oView As DrawingView
Dim oLabel As String
Dim RestartperSheet As Boolean

'Set this value to False if you want te rename views for all sheets
'Set this value to True if you want to rename views per sheet
RestartperSheet = True
'Set Start Label
oLabel = "A"

For Each oSheet In oDoc.Sheets
	'If True Set label Start Value per sheet
	If RestartperSheet = True
		oLabel = "A"
	End If
	For Each oView In oSheet.DrawingViews
		Logger.Info(oView.ViewType & " " & oView.Name)

		Select Case oView.ViewType
			Case kSectionDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kAuxiliaryDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kDetailDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kProjectedDrawingViewType
				If oView.Aligned = False Then
					'Set view name to Label
					oView.Name = oLabel
					'Set Label to next character
					oLabel = Chr(Asc(oLabel) + 1)
				End If
		End Select
	Next
Next
```

#### Code Block 3

```vb
Dim oDoc As DrawingDocument
oDoc = ThisDoc.Document

Dim oStyleM As DrawingStylesManager
oStyleM = oDoc.StylesManager

Dim oStandard As DrawingStandardStyle
oStandard = oStyleM.ActiveStandardStyle

Dim oSheet As Sheet
Dim oView As DrawingView
Dim oLabel As String
Dim RestartperSheet As Boolean

'Set this value to False if you want te rename views for all sheets
'Set this value to True if you want to rename views per sheet
RestartperSheet = False
'Set Start Label
oLabel = "A"


For Each oSheet In oDoc.Sheets
	'If True Set label Start Value per sheet
	If RestartperSheet = True
		oLabel = "A"
	End If
	For Each oView In oSheet.DrawingViews
		Logger.Info(oView.ViewType & " " & oView.Name)
		'Exclude Charater from standard style list
		If oStandard.ApplyExcludeCharactersToViewNames = True Then
			While oStandard.ExcludeCharacters.Contains(oLabel) = True
				oLabel = Chr(Asc(oLabel) + 1)
			End While
		End If
		Select Case oView.ViewType
			Case kSectionDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kAuxiliaryDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kDetailDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kProjectedDrawingViewType
				If oView.Aligned = False Then
					'Set view name to Label
					oView.Name = oLabel
					'Set Label to next character
					oLabel = Chr(Asc(oLabel) + 1)
				End If
		End Select
	Next
Next

iLogicVb.UpdateWhenDone = True
```

#### Code Block 4

```vb
Dim oDoc As DrawingDocument
oDoc = ThisDoc.Document

Dim oStyleM As DrawingStylesManager
oStyleM = oDoc.StylesManager

Dim oStandard As DrawingStandardStyle
oStandard = oStyleM.ActiveStandardStyle

Dim oSheet As Sheet
Dim oView As DrawingView
Dim oLabel As String
Dim RestartperSheet As Boolean

'Set this value to False if you want te rename views for all sheets
'Set this value to True if you want to rename views per sheet
RestartperSheet = False
'Set Start Label
oLabel = "A"


For Each oSheet In oDoc.Sheets
	'If True Set label Start Value per sheet
	If RestartperSheet = True
		oLabel = "A"
	End If
	For Each oView In oSheet.DrawingViews
		Logger.Info(oView.ViewType & " " & oView.Name)
		'Exclude Charater from standard style list
		If oStandard.ApplyExcludeCharactersToViewNames = True Then
			While oStandard.ExcludeCharacters.Contains(oLabel) = True
				oLabel = Chr(Asc(oLabel) + 1)
			End While
		End If
		Select Case oView.ViewType
			Case kSectionDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kAuxiliaryDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kDetailDrawingViewType
				'Set view name to Label
				oView.Name = oLabel
				'Set Label to next character
				oLabel = Chr(Asc(oLabel) + 1)
			Case kProjectedDrawingViewType
				If oView.Aligned = False Then
					'Set view name to Label
					oView.Name = oLabel
					'Set Label to next character
					oLabel = Chr(Asc(oLabel) + 1)
				End If
		End Select
	Next
Next

iLogicVb.UpdateWhenDone = True
```

#### Code Block 5

```vb
Public Function GetAlphaString(ByVal ColumnLetter As String) As String
	'convert to number
	For i = 1 To Len(ColumnLetter)
		AlphaNum = AlphaNum * 26 + (Asc(UCase(Mid(ColumnLetter, i, 1))) -64)
	Next

	AlphaNum = AlphaNum + 1

	'convert back to format
	Do While AlphaNum > 0
		AlphaNum = AlphaNum - 1
		GetAlphaString = ChrW(65 + AlphaNum Mod 26) & GetAlphaString
		AlphaNum = AlphaNum \ 26
	Loop
End Function
```

#### Code Block 6

```vb
Public Function GetAlphaString(ByVal ColumnLetter As String) As String
	'convert to number
	For i = 1 To Len(ColumnLetter)
		AlphaNum = AlphaNum * 26 + (Asc(UCase(Mid(ColumnLetter, i, 1))) -64)
	Next

	AlphaNum = AlphaNum + 1

	'convert back to format
	Do While AlphaNum > 0
		AlphaNum = AlphaNum - 1
		GetAlphaString = ChrW(65 + AlphaNum Mod 26) & GetAlphaString
		AlphaNum = AlphaNum \ 26
	Loop
End Function
```

#### Code Block 7

```vb
Sub Main()
    Dim oDoc As DrawingDocument
    oDoc = ThisDoc.Document

    Dim oStyleM As DrawingStylesManager
    oStyleM = oDoc.StylesManager

    Dim oStandard As DrawingStandardStyle
    oStandard = oStyleM.ActiveStandardStyle

    Dim oSheet As Sheet
    Dim oView As DrawingView
    Dim oLabel As String
    Dim RestartperSheet As Boolean

    ' Set this value to True to rename views per sheet, False for continuous labeling across all sheets
    RestartperSheet = True
    ' Set Start Label
    oLabel = "A"

    For Each oSheet In oDoc.Sheets
        ' Reset label to A for each sheet if RestartperSheet is True
        If RestartperSheet = True Then
            oLabel = "A"
        End If
        For Each oView In oSheet.DrawingViews
            Logger.Info(oView.ViewType & " " & oView.Name)
            ' Skip excluded characters for the current label
            If oStandard.ApplyExcludeCharactersToViewNames = True Then
                While oStandard.ExcludeCharacters.Contains(oLabel) = True
                    oLabel = GetNextLabel(oLabel, oStandard)
                End While
            End If
            Select Case oView.ViewType
                Case kSectionDrawingViewType
                    ' Set view name to Label
                    oView.Name = oLabel
                    ' Get next valid label
                    oLabel = GetNextLabel(oLabel, oStandard)
                Case kAuxiliaryDrawingViewType
                    ' Set view name to Label
                    oView.Name = oLabel
                    ' Get next valid label
                    oLabel = GetNextLabel(oLabel, oStandard)
                Case kDetailDrawingViewType
                    ' Set view name to Label
                    oView.Name = oLabel
                    ' Get next valid label
                    oLabel = GetNextLabel(oLabel, oStandard)
                Case kProjectedDrawingViewType
                    If oView.Aligned = False Then
                        ' Set view name to Label
                        oView.Name = oLabel
                        ' Get next valid label
                        oLabel = GetNextLabel(oLabel, oStandard)
                    End If
            End Select
        Next
    Next

    iLogicVb.UpdateWhenDone = True
End Sub

' Function to get the next valid label (A-Z, skipping excluded characters)
Function GetNextLabel(currentLabel As String, oStandard As DrawingStandardStyle) As String
    Dim nextLabel As String
    nextLabel = Chr(Asc(currentLabel) + 1)
    ' Ensure label stays within A-Z (ASCII 65-90)
    If Asc(nextLabel) > Asc("Z") Then
        nextLabel = "A" ' Reset to A if exceeding Z
    End If
    ' Skip excluded characters
    If oStandard.ApplyExcludeCharactersToViewNames = True Then
        While oStandard.ExcludeCharacters.Contains(nextLabel) = True
            nextLabel = Chr(Asc(nextLabel) + 1)
            If Asc(nextLabel) > Asc("Z") Then
                nextLabel = "A" ' Reset to A if exceeding Z
            End If
        End While
    End If
    GetNextLabel = nextLabel
End Function
```

#### Code Block 8

```vb
Sub Main()
    Dim oDoc As DrawingDocument
    oDoc = ThisDoc.Document

    Dim oStyleM As DrawingStylesManager
    oStyleM = oDoc.StylesManager

    Dim oStandard As DrawingStandardStyle
    oStandard = oStyleM.ActiveStandardStyle

    Dim oSheet As Sheet
    Dim oView As DrawingView
    Dim oLabel As String
    Dim RestartperSheet As Boolean

    ' Set this value to True to rename views per sheet, False for continuous labeling across all sheets
    RestartperSheet = True
    ' Set Start Label
    oLabel = "A"

    For Each oSheet In oDoc.Sheets
        ' Reset label to A for each sheet if RestartperSheet is True
        If RestartperSheet = True Then
            oLabel = "A"
        End If
        For Each oView In oSheet.DrawingViews
            Logger.Info(oView.ViewType & " " & oView.Name)
            ' Skip excluded characters for the current label
            If oStandard.ApplyExcludeCharactersToViewNames = True Then
                While oStandard.ExcludeCharacters.Contains(oLabel) = True
                    oLabel = GetNextLabel(oLabel, oStandard)
                End While
            End If
            Select Case oView.ViewType
                Case kSectionDrawingViewType
                    ' Set view name to Label
                    oView.Name = oLabel
                    ' Get next valid label
                    oLabel = GetNextLabel(oLabel, oStandard)
                Case kAuxiliaryDrawingViewType
                    ' Set view name to Label
                    oView.Name = oLabel
                    ' Get next valid label
                    oLabel = GetNextLabel(oLabel, oStandard)
                Case kDetailDrawingViewType
                    ' Set view name to Label
                    oView.Name = oLabel
                    ' Get next valid label
                    oLabel = GetNextLabel(oLabel, oStandard)
                Case kProjectedDrawingViewType
                    If oView.Aligned = False Then
                        ' Set view name to Label
                        oView.Name = oLabel
                        ' Get next valid label
                        oLabel = GetNextLabel(oLabel, oStandard)
                    End If
            End Select
        Next
    Next

    iLogicVb.UpdateWhenDone = True
End Sub

' Function to get the next valid label (A-Z, skipping excluded characters)
Function GetNextLabel(currentLabel As String, oStandard As DrawingStandardStyle) As String
    Dim nextLabel As String
    nextLabel = Chr(Asc(currentLabel) + 1)
    ' Ensure label stays within A-Z (ASCII 65-90)
    If Asc(nextLabel) > Asc("Z") Then
        nextLabel = "A" ' Reset to A if exceeding Z
    End If
    ' Skip excluded characters
    If oStandard.ApplyExcludeCharactersToViewNames = True Then
        While oStandard.ExcludeCharacters.Contains(nextLabel) = True
            nextLabel = Chr(Asc(nextLabel) + 1)
            If Asc(nextLabel) > Asc("Z") Then
                nextLabel = "A" ' Reset to A if exceeding Z
            End If
        End While
    End If
    GetNextLabel = nextLabel
End Function
```

#### Code Block 9

```vb
oLabel = Chr(Asc(oLabel) + 1)
```

#### Code Block 10

```vb
oLabel = Chr(Asc(oLabel) + 1)
```

#### Code Block 11

```vb
oLabel = GetAlphaString(oLabel)
```

#### Code Block 12

```vb
oLabel = GetAlphaString(oLabel)
```

---

### 32. Show Thumbnail in the Windows.Forms.PictureBox iLogic Inventor 2026

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/show-thumbnail-in-the-windows-forms-picturebox-ilogic-inventor/td-p/13760959](https://forums.autodesk.com/t5/inventor-programming-forum/show-thumbnail-in-the-windows-forms-picturebox-ilogic-inventor/td-p/13760959)

**Author:** pavol_krasnansky1

**Date:** ‎08-09-2025
	
		
		06:47 AM

**Description:** Hi, the iLogic rule below works in Inventor 2023 and does not work in Inventor 2026. Why? What should I change? Imports System.Windows.Forms Imports System.IO Imports System.Windows.Imaging Imports System.Windows.Graphics Imports System.Drawing Imports Microsoft.VisualBasic  AddReference "System.Dra...

**Code Snippets (4):**

#### Code Block 1

```vb
Imports System.Windows.Forms
Imports System.IO
Imports System.Windows.Imaging
Imports System.Windows.Graphics
Imports System.Drawing
Imports Microsoft.VisualBasic

AddReference "System.Drawing.dll"
AddReference "Microsoft.VisualBasic.Compatibility.dll"
AddReference "Microsoft.VisualBasic.dll"
AddReference "stdole.dll"

'--------------------------------------------------------------------------------------

Sub Main()
	
	'--------------------------------------------------------------------------------------
	
	Dim oThumbnail As IPictureDisp = ThisDoc.Document.Thumbnail
	
	'--------------------------------------------------------------------------------------
	
	' oForm
	Dim oForm As New System.Windows.Forms.Form
	oForm.Text = "Thumbnail Inventor 2026"
	oForm.Size = New Drawing.Size(350, 400)
	oForm.Font = New Drawing.Font("Arial", 10)
	' oForm.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle
	oForm.StartPosition = FormStartPosition.CenterScreen
	oForm.ShowIcon = False
	oForm.HelpButton = False
	oForm.MaximizeBox = True
	oForm.MinimizeBox = True
	oForm.Margin = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vonkajšie: Left, Top, Right, Bottom
	oForm.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	
	'--------------------------------------------------------------------------------------
	
	' TableLayoutPanel1
	Dim TableLayoutPanel1 As New System.Windows.Forms.TableLayoutPanel
	TableLayoutPanel1.ColumnCount = 1
	TableLayoutPanel1.RowCount = 1
	TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Fill
	TableLayoutPanel1.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	TableLayoutPanel1.Padding = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vnútorné: Left, Top, Right, Bottom
	oForm.Controls.Add(TableLayoutPanel1)
	
	'--------------------------------------------------------------------------------------
	
	' oPictureBox
	Dim oPictureBox As New System.Windows.Forms.PictureBox
	oPictureBox.SizeMode = PictureBoxSizeMode.Zoom ' CenterImage
	oPictureBox.Dock = System.Windows.Forms.DockStyle.Fill
	oPictureBox.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	oPictureBox.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	TableLayoutPanel1.Controls.Add(oPictureBox, 0, 0)
	
	Dim oThumbnail_Image As System.Drawing.Image
	oThumbnail_Image = Compatibility.VB6.IPictureDispToImage(oThumbnail)
	Dim oThumbnail_Bitmap As New Bitmap(500, 500)
	Dim oThumbnail_Resize As System.Drawing.Graphics = Graphics.FromImage(oThumbnail_Bitmap)
	
	Try
		
		oThumbnail_Resize.DrawImage(oThumbnail_Image, 0, 0, 500, 500)
		
	Catch ex As Exception
		
		'MsgBox(ex.ToString)
		
	End Try
	
	oPictureBox.Image = oThumbnail_Bitmap
	oThumbnail_Image = Nothing
	oThumbnail_Resize = Nothing
	oThumbnail_Bitmap = Nothing
	
	'--------------------------------------------------------------------------------------
	
	oForm.ShowDialog()
	
	'--------------------------------------------------------------------------------------
	
End Sub
```

#### Code Block 2

```vb
Imports System.Windows.Forms
Imports System.IO
Imports System.Windows.Imaging
Imports System.Windows.Graphics
Imports System.Drawing
Imports Microsoft.VisualBasic

AddReference "System.Drawing.dll"
AddReference "Microsoft.VisualBasic.Compatibility.dll"
AddReference "Microsoft.VisualBasic.dll"
AddReference "stdole.dll"

'--------------------------------------------------------------------------------------

Sub Main()
	
	'--------------------------------------------------------------------------------------
	
	Dim oThumbnail As IPictureDisp = ThisDoc.Document.Thumbnail
	
	'--------------------------------------------------------------------------------------
	
	' oForm
	Dim oForm As New System.Windows.Forms.Form
	oForm.Text = "Thumbnail Inventor 2026"
	oForm.Size = New Drawing.Size(350, 400)
	oForm.Font = New Drawing.Font("Arial", 10)
	' oForm.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle
	oForm.StartPosition = FormStartPosition.CenterScreen
	oForm.ShowIcon = False
	oForm.HelpButton = False
	oForm.MaximizeBox = True
	oForm.MinimizeBox = True
	oForm.Margin = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vonkajšie: Left, Top, Right, Bottom
	oForm.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	
	'--------------------------------------------------------------------------------------
	
	' TableLayoutPanel1
	Dim TableLayoutPanel1 As New System.Windows.Forms.TableLayoutPanel
	TableLayoutPanel1.ColumnCount = 1
	TableLayoutPanel1.RowCount = 1
	TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Fill
	TableLayoutPanel1.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	TableLayoutPanel1.Padding = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vnútorné: Left, Top, Right, Bottom
	oForm.Controls.Add(TableLayoutPanel1)
	
	'--------------------------------------------------------------------------------------
	
	' oPictureBox
	Dim oPictureBox As New System.Windows.Forms.PictureBox
	oPictureBox.SizeMode = PictureBoxSizeMode.Zoom ' CenterImage
	oPictureBox.Dock = System.Windows.Forms.DockStyle.Fill
	oPictureBox.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	oPictureBox.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	TableLayoutPanel1.Controls.Add(oPictureBox, 0, 0)
	
	Dim oThumbnail_Image As System.Drawing.Image
	oThumbnail_Image = Compatibility.VB6.IPictureDispToImage(oThumbnail)
	Dim oThumbnail_Bitmap As New Bitmap(500, 500)
	Dim oThumbnail_Resize As System.Drawing.Graphics = Graphics.FromImage(oThumbnail_Bitmap)
	
	Try
		
		oThumbnail_Resize.DrawImage(oThumbnail_Image, 0, 0, 500, 500)
		
	Catch ex As Exception
		
		'MsgBox(ex.ToString)
		
	End Try
	
	oPictureBox.Image = oThumbnail_Bitmap
	oThumbnail_Image = Nothing
	oThumbnail_Resize = Nothing
	oThumbnail_Bitmap = Nothing
	
	'--------------------------------------------------------------------------------------
	
	oForm.ShowDialog()
	
	'--------------------------------------------------------------------------------------
	
End Sub
```

#### Code Block 3

```vb
Imports System.Windows.Forms
Imports System.IO
Imports System.Windows.Imaging
Imports System.Windows.Graphics
Imports System.Drawing
Imports Microsoft.VisualBasic

AddReference "System.Drawing.dll"
AddReference "Microsoft.VisualBasic.Compatibility.dll"
AddReference "Microsoft.VisualBasic.dll"
AddReference "stdole.dll"

'--------------------------------------------------------------------------------------

Sub Main()
	
	'--------------------------------------------------------------------------------------
	
	Dim oThumbnail As IPictureDisp = ThisDoc.Document.Thumbnail
	
	'--------------------------------------------------------------------------------------
	
	' oForm
	Dim oForm As New System.Windows.Forms.Form
	oForm.Text = "Thumbnail Inventor 2026"
	oForm.Size = New Drawing.Size(350, 400)
	oForm.Font = New Drawing.Font("Arial", 10)
	' oForm.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle
	oForm.StartPosition = FormStartPosition.CenterScreen
	oForm.ShowIcon = False
	oForm.HelpButton = False
	oForm.MaximizeBox = True
	oForm.MinimizeBox = True
	oForm.Margin = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vonkajšie: Left, Top, Right, Bottom
	oForm.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	
	'--------------------------------------------------------------------------------------
	
	' TableLayoutPanel1
	Dim TableLayoutPanel1 As New System.Windows.Forms.TableLayoutPanel
	TableLayoutPanel1.ColumnCount = 1
	TableLayoutPanel1.RowCount = 1
	TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Fill
	TableLayoutPanel1.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	TableLayoutPanel1.Padding = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vnútorné: Left, Top, Right, Bottom
	oForm.Controls.Add(TableLayoutPanel1)
	
	'--------------------------------------------------------------------------------------
	
	' oPictureBox
	Dim oPictureBox As New System.Windows.Forms.PictureBox
	oPictureBox.SizeMode = PictureBoxSizeMode.Zoom ' CenterImage
	oPictureBox.Dock = System.Windows.Forms.DockStyle.Fill
	oPictureBox.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	oPictureBox.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	TableLayoutPanel1.Controls.Add(oPictureBox, 0, 0)
	
	Dim oThumbnail_Image As System.Drawing.Image
	oThumbnail_Image = Compatibility.VB6.IPictureDispToImage(oThumbnail)
	Dim oThumbnail_Bitmap As New Bitmap(500, 500)
	Dim oThumbnail_Resize As System.Drawing.Graphics = Graphics.FromImage(oThumbnail_Bitmap)
	
	Try
		
		oThumbnail_Resize.DrawImage(oThumbnail_Image, 0, 0, 500, 500)
		
	Catch ex As Exception
		
		'MsgBox(ex.ToString)
		
	End Try
	
	oPictureBox.Image = oThumbnail_Bitmap
	oThumbnail_Image = Nothing
	oThumbnail_Resize = Nothing
	oThumbnail_Bitmap = Nothing
	
	'--------------------------------------------------------------------------------------
	
	oForm.ShowDialog()
	
	'--------------------------------------------------------------------------------------
	
End Sub
```

#### Code Block 4

```vb
Imports System.Windows.Forms
Imports System.IO
Imports System.Windows.Imaging
Imports System.Windows.Graphics
Imports System.Drawing
Imports Microsoft.VisualBasic

AddReference "System.Drawing.dll"
AddReference "Microsoft.VisualBasic.Compatibility.dll"
AddReference "Microsoft.VisualBasic.dll"
AddReference "stdole.dll"

'--------------------------------------------------------------------------------------

Sub Main()
	
	'--------------------------------------------------------------------------------------
	
	Dim oThumbnail As IPictureDisp = ThisDoc.Document.Thumbnail
	
	'--------------------------------------------------------------------------------------
	
	' oForm
	Dim oForm As New System.Windows.Forms.Form
	oForm.Text = "Thumbnail Inventor 2026"
	oForm.Size = New Drawing.Size(350, 400)
	oForm.Font = New Drawing.Font("Arial", 10)
	' oForm.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle
	oForm.StartPosition = FormStartPosition.CenterScreen
	oForm.ShowIcon = False
	oForm.HelpButton = False
	oForm.MaximizeBox = True
	oForm.MinimizeBox = True
	oForm.Margin = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vonkajšie: Left, Top, Right, Bottom
	oForm.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	
	'--------------------------------------------------------------------------------------
	
	' TableLayoutPanel1
	Dim TableLayoutPanel1 As New System.Windows.Forms.TableLayoutPanel
	TableLayoutPanel1.ColumnCount = 1
	TableLayoutPanel1.RowCount = 1
	TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Fill
	TableLayoutPanel1.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	TableLayoutPanel1.Padding = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vnútorné: Left, Top, Right, Bottom
	oForm.Controls.Add(TableLayoutPanel1)
	
	'--------------------------------------------------------------------------------------
	
	' oPictureBox
	Dim oPictureBox As New System.Windows.Forms.PictureBox
	oPictureBox.SizeMode = PictureBoxSizeMode.Zoom ' CenterImage
	oPictureBox.Dock = System.Windows.Forms.DockStyle.Fill
	oPictureBox.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	oPictureBox.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	TableLayoutPanel1.Controls.Add(oPictureBox, 0, 0)
	
	Dim oThumbnail_Image As System.Drawing.Image
	oThumbnail_Image = Compatibility.VB6.IPictureDispToImage(oThumbnail)
	Dim oThumbnail_Bitmap As New Bitmap(500, 500)
	Dim oThumbnail_Resize As System.Drawing.Graphics = Graphics.FromImage(oThumbnail_Bitmap)
	
	Try
		
		oThumbnail_Resize.DrawImage(oThumbnail_Image, 0, 0, 500, 500)
		
	Catch ex As Exception
		
		'MsgBox(ex.ToString)
		
	End Try
	
	oPictureBox.Image = oThumbnail_Bitmap
	oThumbnail_Image = Nothing
	oThumbnail_Resize = Nothing
	oThumbnail_Bitmap = Nothing
	
	'--------------------------------------------------------------------------------------
	
	oForm.ShowDialog()
	
	'--------------------------------------------------------------------------------------
	
End Sub
```

#### Code Block 5

```vb
Imports System.Windows.Forms
Imports System.IO
Imports System.Windows.Imaging
Imports System.Windows.Graphics
Imports System.Drawing
Imports Microsoft.VisualBasic
AddReference "System.Drawing.dll"
'AddReference "Microsoft.VisualBasic.Compatibility.dll"
AddReference "Microsoft.VisualBasic.dll"
AddReference "stdole.dll"


'--------------------------------------------------------------------------------------

Sub Main()
	
	'--------------------------------------------------------------------------------------
	
	Dim oThumbnail As IPictureDisp = ThisDoc.Document.Thumbnail
	
	'--------------------------------------------------------------------------------------
	
	' oForm
	Dim oForm As New System.Windows.Forms.Form
	oForm.Text = "Thumbnail Inventor 2026"
	oForm.Size = New Drawing.Size(350, 400)
	oForm.Font = New Drawing.Font("Arial", 10)
	' oForm.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle
	oForm.StartPosition = FormStartPosition.CenterScreen
	oForm.ShowIcon = False
	oForm.HelpButton = False
	oForm.MaximizeBox = True
	oForm.MinimizeBox = True
	oForm.Margin = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vonkajšie: Left, Top, Right, Bottom
	oForm.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	
	'--------------------------------------------------------------------------------------
	
	' TableLayoutPanel1
	Dim TableLayoutPanel1 As New System.Windows.Forms.TableLayoutPanel
	TableLayoutPanel1.ColumnCount = 1
	TableLayoutPanel1.RowCount = 1
	TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Fill
	TableLayoutPanel1.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	TableLayoutPanel1.Padding = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vnútorné: Left, Top, Right, Bottom
	oForm.Controls.Add(TableLayoutPanel1)
	
	'--------------------------------------------------------------------------------------
	
	' oPictureBox
	Dim oPictureBox As New System.Windows.Forms.PictureBox
	oPictureBox.SizeMode = PictureBoxSizeMode.Zoom ' CenterImage
	oPictureBox.Dock = System.Windows.Forms.DockStyle.Fill
	oPictureBox.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	oPictureBox.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	TableLayoutPanel1.Controls.Add(oPictureBox, 0, 0)
	
	Dim oThumbnail_Image As System.Drawing.Image
	oThumbnail_Image = PictureDispToImage(oThumbnail)
	Dim oThumbnail_Bitmap As New Bitmap(500, 500)
	Dim oThumbnail_Resize As System.Drawing.Graphics = Graphics.FromImage(oThumbnail_Bitmap)
	
	Try
		
		oThumbnail_Resize.DrawImage(oThumbnail_Image, 0, 0, 500, 500)
		
	Catch ex As Exception
		
		'MsgBox(ex.ToString)
		
	End Try
	
	oPictureBox.Image = oThumbnail_Bitmap
	oThumbnail_Image = Nothing
	oThumbnail_Resize = Nothing
	oThumbnail_Bitmap = Nothing
	
	'--------------------------------------------------------------------------------------
	
	oForm.ShowDialog()
	
	'--------------------------------------------------------------------------------------
	
End Sub

Public Shared Function PictureDispToImage(pictureDisp As stdole.IPictureDisp) As System.Drawing.Image
	Dim oImage As System.Drawing.Image
	If pictureDisp IsNot Nothing Then
		If pictureDisp.Type = 1 Then
			Dim hpalette As IntPtr = New IntPtr(pictureDisp.hPal)
			oImage = oImage.FromHbitmap(New IntPtr(pictureDisp.Handle), hpalette)
		End If
		If pictureDisp.Type = 2 Then
			oImage = New System.Drawing.Imaging.Metafile(New IntPtr(pictureDisp.Handle), New System.Drawing.Imaging.WmfPlaceableFileHeader())
		End If
	End If
	Return oImage
End Function
```

#### Code Block 6

```vb
Imports System.Windows.Forms
Imports System.IO
Imports System.Windows.Imaging
Imports System.Windows.Graphics
Imports System.Drawing
Imports Microsoft.VisualBasic
AddReference "System.Drawing.dll"
'AddReference "Microsoft.VisualBasic.Compatibility.dll"
AddReference "Microsoft.VisualBasic.dll"
AddReference "stdole.dll"


'--------------------------------------------------------------------------------------

Sub Main()
	
	'--------------------------------------------------------------------------------------
	
	Dim oThumbnail As IPictureDisp = ThisDoc.Document.Thumbnail
	
	'--------------------------------------------------------------------------------------
	
	' oForm
	Dim oForm As New System.Windows.Forms.Form
	oForm.Text = "Thumbnail Inventor 2026"
	oForm.Size = New Drawing.Size(350, 400)
	oForm.Font = New Drawing.Font("Arial", 10)
	' oForm.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle
	oForm.StartPosition = FormStartPosition.CenterScreen
	oForm.ShowIcon = False
	oForm.HelpButton = False
	oForm.MaximizeBox = True
	oForm.MinimizeBox = True
	oForm.Margin = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vonkajšie: Left, Top, Right, Bottom
	oForm.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	
	'--------------------------------------------------------------------------------------
	
	' TableLayoutPanel1
	Dim TableLayoutPanel1 As New System.Windows.Forms.TableLayoutPanel
	TableLayoutPanel1.ColumnCount = 1
	TableLayoutPanel1.RowCount = 1
	TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Fill
	TableLayoutPanel1.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	TableLayoutPanel1.Padding = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vnútorné: Left, Top, Right, Bottom
	oForm.Controls.Add(TableLayoutPanel1)
	
	'--------------------------------------------------------------------------------------
	
	' oPictureBox
	Dim oPictureBox As New System.Windows.Forms.PictureBox
	oPictureBox.SizeMode = PictureBoxSizeMode.Zoom ' CenterImage
	oPictureBox.Dock = System.Windows.Forms.DockStyle.Fill
	oPictureBox.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	oPictureBox.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	TableLayoutPanel1.Controls.Add(oPictureBox, 0, 0)
	
	Dim oThumbnail_Image As System.Drawing.Image
	oThumbnail_Image = PictureDispToImage(oThumbnail)
	Dim oThumbnail_Bitmap As New Bitmap(500, 500)
	Dim oThumbnail_Resize As System.Drawing.Graphics = Graphics.FromImage(oThumbnail_Bitmap)
	
	Try
		
		oThumbnail_Resize.DrawImage(oThumbnail_Image, 0, 0, 500, 500)
		
	Catch ex As Exception
		
		'MsgBox(ex.ToString)
		
	End Try
	
	oPictureBox.Image = oThumbnail_Bitmap
	oThumbnail_Image = Nothing
	oThumbnail_Resize = Nothing
	oThumbnail_Bitmap = Nothing
	
	'--------------------------------------------------------------------------------------
	
	oForm.ShowDialog()
	
	'--------------------------------------------------------------------------------------
	
End Sub

Public Shared Function PictureDispToImage(pictureDisp As stdole.IPictureDisp) As System.Drawing.Image
	Dim oImage As System.Drawing.Image
	If pictureDisp IsNot Nothing Then
		If pictureDisp.Type = 1 Then
			Dim hpalette As IntPtr = New IntPtr(pictureDisp.hPal)
			oImage = oImage.FromHbitmap(New IntPtr(pictureDisp.Handle), hpalette)
		End If
		If pictureDisp.Type = 2 Then
			oImage = New System.Drawing.Imaging.Metafile(New IntPtr(pictureDisp.Handle), New System.Drawing.Imaging.WmfPlaceableFileHeader())
		End If
	End If
	Return oImage
End Function
```

#### Code Block 7

```vb
Imports System.Windows.Forms
Imports System.IO
Imports System.Windows.Imaging
Imports System.Windows.Graphics
Imports System.Drawing
Imports Microsoft.VisualBasic
AddReference "System.Drawing.dll"
'AddReference "Microsoft.VisualBasic.Compatibility.dll"
AddReference "Microsoft.VisualBasic.dll"
AddReference "stdole.dll"


'--------------------------------------------------------------------------------------

Sub Main()
	
	'--------------------------------------------------------------------------------------
	
	Dim oThumbnail As IPictureDisp = ThisDoc.Document.Thumbnail
	
	'--------------------------------------------------------------------------------------
	
	' oForm
	Dim oForm As New System.Windows.Forms.Form
	oForm.Text = "Thumbnail Inventor 2026"
	oForm.Size = New Drawing.Size(350, 400)
	oForm.Font = New Drawing.Font("Arial", 10)
	' oForm.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle
	oForm.StartPosition = FormStartPosition.CenterScreen
	oForm.ShowIcon = False
	oForm.HelpButton = False
	oForm.MaximizeBox = True
	oForm.MinimizeBox = True
	oForm.Margin = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vonkajšie: Left, Top, Right, Bottom
	oForm.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	
	'--------------------------------------------------------------------------------------
	
	' TableLayoutPanel1
	Dim TableLayoutPanel1 As New System.Windows.Forms.TableLayoutPanel
	TableLayoutPanel1.ColumnCount = 1
	TableLayoutPanel1.RowCount = 1
	TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Fill
	TableLayoutPanel1.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	TableLayoutPanel1.Padding = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vnútorné: Left, Top, Right, Bottom
	oForm.Controls.Add(TableLayoutPanel1)
	
	'--------------------------------------------------------------------------------------
	
	' oPictureBox
	Dim oPictureBox As New System.Windows.Forms.PictureBox
	oPictureBox.SizeMode = PictureBoxSizeMode.Zoom ' CenterImage
	oPictureBox.Dock = System.Windows.Forms.DockStyle.Fill
	oPictureBox.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	oPictureBox.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	TableLayoutPanel1.Controls.Add(oPictureBox, 0, 0)
	
	Dim oThumbnail_Image As System.Drawing.Image
	oThumbnail_Image = PictureDispToImage(oThumbnail)
	Dim oThumbnail_Bitmap As New Bitmap(500, 500)
	Dim oThumbnail_Resize As System.Drawing.Graphics = Graphics.FromImage(oThumbnail_Bitmap)
	
	Try
		
		oThumbnail_Resize.DrawImage(oThumbnail_Image, 0, 0, 500, 500)
		
	Catch ex As Exception
		
		'MsgBox(ex.ToString)
		
	End Try
	
	oPictureBox.Image = oThumbnail_Bitmap
	oThumbnail_Image = Nothing
	oThumbnail_Resize = Nothing
	oThumbnail_Bitmap = Nothing
	
	'--------------------------------------------------------------------------------------
	
	oForm.ShowDialog()
	
	'--------------------------------------------------------------------------------------
	
End Sub

Public Shared Function PictureDispToImage(pictureDisp As stdole.IPictureDisp) As System.Drawing.Image
	Dim oImage As System.Drawing.Image
	If pictureDisp IsNot Nothing Then
		If pictureDisp.Type = 1 Then
			Dim hpalette As IntPtr = New IntPtr(pictureDisp.hPal)
			oImage = oImage.FromHbitmap(New IntPtr(pictureDisp.Handle), hpalette)
		End If
		If pictureDisp.Type = 2 Then
			oImage = New System.Drawing.Imaging.Metafile(New IntPtr(pictureDisp.Handle), New System.Drawing.Imaging.WmfPlaceableFileHeader())
		End If
	End If
	Return oImage
End Function
```

#### Code Block 8

```vb
Imports System.Windows.Forms
Imports System.IO
Imports System.Windows.Imaging
Imports System.Windows.Graphics
Imports System.Drawing
Imports Microsoft.VisualBasic
AddReference "System.Drawing.dll"
'AddReference "Microsoft.VisualBasic.Compatibility.dll"
AddReference "Microsoft.VisualBasic.dll"
AddReference "stdole.dll"


'--------------------------------------------------------------------------------------

Sub Main()
	
	'--------------------------------------------------------------------------------------
	
	Dim oThumbnail As IPictureDisp = ThisDoc.Document.Thumbnail
	
	'--------------------------------------------------------------------------------------
	
	' oForm
	Dim oForm As New System.Windows.Forms.Form
	oForm.Text = "Thumbnail Inventor 2026"
	oForm.Size = New Drawing.Size(350, 400)
	oForm.Font = New Drawing.Font("Arial", 10)
	' oForm.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle
	oForm.StartPosition = FormStartPosition.CenterScreen
	oForm.ShowIcon = False
	oForm.HelpButton = False
	oForm.MaximizeBox = True
	oForm.MinimizeBox = True
	oForm.Margin = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vonkajšie: Left, Top, Right, Bottom
	oForm.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	
	'--------------------------------------------------------------------------------------
	
	' TableLayoutPanel1
	Dim TableLayoutPanel1 As New System.Windows.Forms.TableLayoutPanel
	TableLayoutPanel1.ColumnCount = 1
	TableLayoutPanel1.RowCount = 1
	TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 100.0!))
	TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Fill
	TableLayoutPanel1.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	TableLayoutPanel1.Padding = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vnútorné: Left, Top, Right, Bottom
	oForm.Controls.Add(TableLayoutPanel1)
	
	'--------------------------------------------------------------------------------------
	
	' oPictureBox
	Dim oPictureBox As New System.Windows.Forms.PictureBox
	oPictureBox.SizeMode = PictureBoxSizeMode.Zoom ' CenterImage
	oPictureBox.Dock = System.Windows.Forms.DockStyle.Fill
	oPictureBox.Margin = New System.Windows.Forms.Padding(5, 5, 5, 5) ' Vonkajšie: Left, Top, Right, Bottom
	oPictureBox.Padding = New System.Windows.Forms.Padding(0, 0, 0, 0) ' Vnútorné: Left, Top, Right, Bottom
	TableLayoutPanel1.Controls.Add(oPictureBox, 0, 0)
	
	Dim oThumbnail_Image As System.Drawing.Image
	oThumbnail_Image = PictureDispToImage(oThumbnail)
	Dim oThumbnail_Bitmap As New Bitmap(500, 500)
	Dim oThumbnail_Resize As System.Drawing.Graphics = Graphics.FromImage(oThumbnail_Bitmap)
	
	Try
		
		oThumbnail_Resize.DrawImage(oThumbnail_Image, 0, 0, 500, 500)
		
	Catch ex As Exception
		
		'MsgBox(ex.ToString)
		
	End Try
	
	oPictureBox.Image = oThumbnail_Bitmap
	oThumbnail_Image = Nothing
	oThumbnail_Resize = Nothing
	oThumbnail_Bitmap = Nothing
	
	'--------------------------------------------------------------------------------------
	
	oForm.ShowDialog()
	
	'--------------------------------------------------------------------------------------
	
End Sub

Public Shared Function PictureDispToImage(pictureDisp As stdole.IPictureDisp) As System.Drawing.Image
	Dim oImage As System.Drawing.Image
	If pictureDisp IsNot Nothing Then
		If pictureDisp.Type = 1 Then
			Dim hpalette As IntPtr = New IntPtr(pictureDisp.hPal)
			oImage = oImage.FromHbitmap(New IntPtr(pictureDisp.Handle), hpalette)
		End If
		If pictureDisp.Type = 2 Then
			oImage = New System.Drawing.Imaging.Metafile(New IntPtr(pictureDisp.Handle), New System.Drawing.Imaging.WmfPlaceableFileHeader())
		End If
	End If
	Return oImage
End Function
```

---

### 33. Stop an iLogic rule while it's running

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/stop-an-ilogic-rule-while-it-s-running/td-p/12304171#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/stop-an-ilogic-rule-while-it-s-running/td-p/12304171#messageview_0)

**Author:** Daan_M

**Date:** ‎10-13-2023
	
		
		06:31 AM

**Description:** Hi, I'm currently running a loop on 250+ files taking about 2hrs, i forgot one line of code. Is it possible to cancel your rule during a run?  if so, how do i do this? 					 				 			 			 				 			 			 				 	 			 				 					 						Solved! 					 					Go to Solution.

**Code Snippets (4):**

#### Code Block 1

```vb
' iLogic: Save all open documents, skipping any that error.
' Drops dialogs (SilentOperation) and restores settings afterward.

Dim app As Inventor.Application = ThisApplication
Dim docs As Inventor.Documents = app.Documents

Dim total As Integer = 0
Dim saved As Integer = 0
Dim failed As New System.Collections.Generic.List(Of String)

' Remember app settings
Dim originalSilent As Boolean = app.SilentOperation
Dim originalScreen As Boolean = app.ScreenUpdating

Try
    app.SilentOperation = True
    app.ScreenUpdating = False

    ' Take a snapshot of currently open docs (collection can change while saving)
    Dim openDocs As New System.Collections.Generic.List(Of Inventor.Document)
    For Each d As Inventor.Document In docs
        openDocs.Add(d)
    Next

    For Each d As Inventor.Document In openDocs
        total += 1
        Try
            d.Save()                           ' Try to save everything
            saved += 1
        Catch ex As System.Exception
            failed.Add(d.DisplayName & " — " & ex.Message)
            ' Skip and continue with the next document
        End Try
    Next

Finally
    app.SilentOperation = originalSilent
    app.ScreenUpdating = originalScreen
End Try

Dim report As String = _
    "Save All — iLogic" & vbCrLf & vbCrLf & _
    "Open docs: " & total & vbCrLf & _
    "Saved: " & saved & vbCrLf & _
    "Failed: " & failed.Count

If failed.Count > 0 Then
    report &= vbCrLf & vbCrLf & "Failures:" & vbCrLf & "— " & String.Join(vbCrLf & "— ", failed.ToArray())
End If

MsgBox(report, vbInformation, "iLogic Save All")
```

#### Code Block 2

```vb
' iLogic: Save all open documents, skipping any that error.
' Drops dialogs (SilentOperation) and restores settings afterward.

Dim app As Inventor.Application = ThisApplication
Dim docs As Inventor.Documents = app.Documents

Dim total As Integer = 0
Dim saved As Integer = 0
Dim failed As New System.Collections.Generic.List(Of String)

' Remember app settings
Dim originalSilent As Boolean = app.SilentOperation
Dim originalScreen As Boolean = app.ScreenUpdating

Try
    app.SilentOperation = True
    app.ScreenUpdating = False

    ' Take a snapshot of currently open docs (collection can change while saving)
    Dim openDocs As New System.Collections.Generic.List(Of Inventor.Document)
    For Each d As Inventor.Document In docs
        openDocs.Add(d)
    Next

    For Each d As Inventor.Document In openDocs
        total += 1
        Try
            d.Save()                           ' Try to save everything
            saved += 1
        Catch ex As System.Exception
            failed.Add(d.DisplayName & " — " & ex.Message)
            ' Skip and continue with the next document
        End Try
    Next

Finally
    app.SilentOperation = originalSilent
    app.ScreenUpdating = originalScreen
End Try

Dim report As String = _
    "Save All — iLogic" & vbCrLf & vbCrLf & _
    "Open docs: " & total & vbCrLf & _
    "Saved: " & saved & vbCrLf & _
    "Failed: " & failed.Count

If failed.Count > 0 Then
    report &= vbCrLf & vbCrLf & "Failures:" & vbCrLf & "— " & String.Join(vbCrLf & "— ", failed.ToArray())
End If

MsgBox(report, vbInformation, "iLogic Save All")
```

#### Code Block 3

```vb
For Each ...
	If IO.File.exists("C:\Temp\IF_YOU_DELETE_THIS_CODE_WILL_STOP.txt")
                MsgBox("rule " & iLogicVb.RuleName & " stopped because text file doesn't exist")                'logger.info("rule " & iLogicVb.RuleName & " stopped because text file doesn't exist")                return                 'exit sub                'goto ...
	End If
	...
Next
```

#### Code Block 4

```vb
Public Sub Main
    progBar = New TestProgressBar(ThisApplication)
    progBar.Start()
End Sub

Public Class TestProgressBar
    Private WithEvents progBar As Inventor.ProgressBar
    Private invApp As Inventor.Application

    Public Sub New(InventorApp As Inventor.Application)
        invApp = InventorApp
    End Sub

    Public Sub Start()
        progBar = invApp.CreateProgressBar(False, 10, "Test of Progress Bar", True)

        Dim j As Integer
        For j = 0 To 10
            progBar.Message = ("Current Index: " & j & "/" & 10)
            Threading.Thread.Sleep(1000)
            progBar.UpdateProgress()
        Next

        progBar.Close()
    End Sub

    Private Sub progBar_OnCancel() Handles progBar.OnCancel
        progBar.Close()
        MsgBox("Cancelled")
    End Sub
End Class
```

---

### 34. Switch active drawing Standard with iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/switch-active-drawing-standard-with-ilogic/td-p/13772691#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/switch-active-drawing-standard-with-ilogic/td-p/13772691#messageview_0)

**Author:** Jesse_Glaze

**Date:** ‎08-18-2025
	
		
		11:27 AM

**Description:** I am looking for a (hopefully) simple code that would allow me to activate a different drawing standard.This rule would also be used for updating old drawings, so it should work even if the standard is saved to the style library but not saved in the local document.   					 				 			 			 				 			 			 ...

**Code Snippets (2):**

#### Code Block 1

```vb
Sub SetActiveDrawingStandardStyle(oDrawDoc As DrawingDocument, _
	Optional styleName As String = Nothing)
	Const sDefaultStyleName As String = "Default"
	If String.IsNullOrWhiteSpace(styleName) Then
		styleName = sDefaultStyleName
	End If
	Dim oSMgr As DrawingStylesManager = oDrawDoc.StylesManager
	Dim oStStyle As DrawingStandardStyle = Nothing
	Try
		oStStyle = oSMgr.StandardStyles.Item(styleName)
	Catch oEx As Exception
		Logger.Error("Failed to find specified DrawingStanardStyle to make active." _
		& vbCrLf & oEx.Message & vbCrLf & oEx.StackTrace)
	End Try
	If Not oStStyle Is Nothing Then
		If oStStyle.StyleLocation = StyleLocationEnum.kLibraryStyleLocation Then
			oStStyle = oStStyle.ConvertToLocal()
		ElseIf oStStyle.StyleLocation = StyleLocationEnum.kBothStyleLocation Then
			oStStyle.UpdateFromGlobal()
		End If
		oSMgr.ActiveStandardStyle = oStStyle
	End If
End Sub
```

#### Code Block 2

```vb
Sub SetActiveDrawingStandardStyle(oDrawDoc As DrawingDocument, _
	Optional styleName As String = Nothing)
	Const sDefaultStyleName As String = "Default"
	If String.IsNullOrWhiteSpace(styleName) Then
		styleName = sDefaultStyleName
	End If
	Dim oSMgr As DrawingStylesManager = oDrawDoc.StylesManager
	Dim oStStyle As DrawingStandardStyle = Nothing
	Try
		oStStyle = oSMgr.StandardStyles.Item(styleName)
	Catch oEx As Exception
		Logger.Error("Failed to find specified DrawingStanardStyle to make active." _
		& vbCrLf & oEx.Message & vbCrLf & oEx.StackTrace)
	End Try
	If Not oStStyle Is Nothing Then
		If oStStyle.StyleLocation = StyleLocationEnum.kLibraryStyleLocation Then
			oStStyle = oStStyle.ConvertToLocal()
		ElseIf oStStyle.StyleLocation = StyleLocationEnum.kBothStyleLocation Then
			oStStyle.UpdateFromGlobal()
		End If
		oSMgr.ActiveStandardStyle = oStStyle
	End If
End Sub
```

#### Code Block 3

```vb
Sub SetActiveDrawingStandardStyle(oDrawDoc As DrawingDocument, _
	Optional styleName As String = Nothing)
	Const sDefaultStyleName As String = "Default"
	If String.IsNullOrWhiteSpace(styleName) Then
		styleName = sDefaultStyleName
	End If
	Dim oSMgr As DrawingStylesManager = oDrawDoc.StylesManager
	Dim oStStyle As DrawingStandardStyle = Nothing
	Try
		oStStyle = oSMgr.StandardStyles.Item(styleName)
	Catch oEx As Exception
		Logger.Error("Failed to find specified DrawingStanardStyle to make active." _
		& vbCrLf & oEx.Message & vbCrLf & oEx.StackTrace)
	End Try
	If Not oStStyle Is Nothing Then
		If oStStyle.StyleLocation = StyleLocationEnum.kLibraryStyleLocation Then
			oStStyle = oStStyle.ConvertToLocal()
		ElseIf oStStyle.StyleLocation = StyleLocationEnum.kBothStyleLocation Then
			oStStyle.UpdateFromGlobal()
		End If
		oSMgr.ActiveStandardStyle = oStStyle
	End If
End Sub
```

#### Code Block 4

```vb
Sub SetActiveDrawingStandardStyle(oDrawDoc As DrawingDocument, _
	Optional styleName As String = Nothing)
	Const sDefaultStyleName As String = "Default"
	If String.IsNullOrWhiteSpace(styleName) Then
		styleName = sDefaultStyleName
	End If
	Dim oSMgr As DrawingStylesManager = oDrawDoc.StylesManager
	Dim oStStyle As DrawingStandardStyle = Nothing
	Try
		oStStyle = oSMgr.StandardStyles.Item(styleName)
	Catch oEx As Exception
		Logger.Error("Failed to find specified DrawingStanardStyle to make active." _
		& vbCrLf & oEx.Message & vbCrLf & oEx.StackTrace)
	End Try
	If Not oStStyle Is Nothing Then
		If oStStyle.StyleLocation = StyleLocationEnum.kLibraryStyleLocation Then
			oStStyle = oStStyle.ConvertToLocal()
		ElseIf oStStyle.StyleLocation = StyleLocationEnum.kBothStyleLocation Then
			oStStyle.UpdateFromGlobal()
		End If
		oSMgr.ActiveStandardStyle = oStStyle
	End If
End Sub
```

---

### 35. Trailing Zeros

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/trailing-zeros/td-p/13803427#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/trailing-zeros/td-p/13803427#messageview_0)

**Author:** cgchad

**Date:** ‎09-09-2025
	
		
		10:09 AM

**Description:** I know this has been asked dozens of times but for some reason I can't get it to work out.  I am running Inventor Professional 2024.I have 2 parameters that i need to display with just 2 decimal places.  Even if those decimal places are zeros.  No matter what I have done it stops when it's a whole n...

**Code Snippets (9):**

#### Code Block 1

```vb
'round values
LENGTH = Round(SheetMetal.FlatExtentsLength, 2) 
WIDTH = Round(SheetMetal.FlatExtentsWidth, 2)

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 2

```vb
'round values
LENGTH = Round(SheetMetal.FlatExtentsLength, 2) 
WIDTH = Round(SheetMetal.FlatExtentsWidth, 2)

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 3

```vb
'round values
LENGTH = Round(SheetMetal.FlatExtentsLength, 2) 
WIDTH = Round(SheetMetal.FlatExtentsWidth, 2)

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 4

```vb
'round values
LENGTH = Round(SheetMetal.FlatExtentsLength, 2) 
WIDTH = Round(SheetMetal.FlatExtentsWidth, 2)

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 5

```vb
'round values
LENGTH = Round(SheetMetal.FlatExtentsLength, 2) 
WIDTH = Round(SheetMetal.FlatExtentsWidth, 2)

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 6

```vb
'round values
LENGTH = Round(SheetMetal.FlatExtentsLength, 2) 
WIDTH = Round(SheetMetal.FlatExtentsWidth, 2)

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 7

```vb
'round values
LENGTH = Round(SheetMetal.FlatExtentsLength, 2) 
WIDTH = Round(SheetMetal.FlatExtentsWidth, 2)
'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & WIDTH & " x " & LENGTH
```

#### Code Block 8

```vb
'round values
LENGTH = Round(SheetMetal.FlatExtentsLength, 2) 
WIDTH = Round(SheetMetal.FlatExtentsWidth, 2)
'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & WIDTH & " x " & LENGTH
```

#### Code Block 9

```vb
'round values
LENGTH = Round(SheetMetal.FlatExtentsLength, 2) 
WIDTH = Round(SheetMetal.FlatExtentsWidth, 2)
'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & WIDTH & " x " & LENGTH
```

#### Code Block 10

```vb
Dim DoubleLength As Double = Round(SheetMetal.FlatExtentsLength, 2)
Dim DoubleWidth As Double = Round(SheetMetal.FlatExtentsWidth, 2)
LENGTH = DoubleLength
WIDTH = DoubleWidth

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & DoubleWidth.ToString("F2") & " x " & DoubleLength.ToString("F2")
```

#### Code Block 11

```vb
Dim DoubleLength As Double = Round(SheetMetal.FlatExtentsLength, 2)
Dim DoubleWidth As Double = Round(SheetMetal.FlatExtentsWidth, 2)
LENGTH = DoubleLength
WIDTH = DoubleWidth

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & DoubleWidth.ToString("F2") & " x " & DoubleLength.ToString("F2")
```

#### Code Block 12

```vb
Dim DoubleLength As Double = Round(SheetMetal.FlatExtentsLength, 2)
Dim DoubleWidth As Double = Round(SheetMetal.FlatExtentsWidth, 2)
LENGTH = DoubleLength
WIDTH = DoubleWidth

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & DoubleWidth.ToString("F2") & " x " & DoubleLength.ToString("F2")
```

#### Code Block 13

```vb
Dim DoubleLength As Double = Round(SheetMetal.FlatExtentsLength, 2)
Dim DoubleWidth As Double = Round(SheetMetal.FlatExtentsWidth, 2)
LENGTH = DoubleLength
WIDTH = DoubleWidth

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & DoubleWidth.ToString("F2") & " x " & DoubleLength.ToString("F2")
```

#### Code Block 14

```vb
Dim DoubleLength As Double = Round(SheetMetal.FlatExtentsLength, 2)
Dim DoubleWidth As Double = Round(SheetMetal.FlatExtentsWidth, 2)
LENGTH = DoubleLength
WIDTH = DoubleWidth

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & DoubleWidth.ToString("F2") & " x " & DoubleLength.ToString("F2")
```

#### Code Block 15

```vb
Dim DoubleLength As Double = Round(SheetMetal.FlatExtentsLength, 2)
Dim DoubleWidth As Double = Round(SheetMetal.FlatExtentsWidth, 2)
LENGTH = DoubleLength
WIDTH = DoubleWidth

'set raw part information
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & DoubleWidth.ToString("F2") & " x " & DoubleLength.ToString("F2")
```

#### Code Block 16

```vb
Dim Height As Double = tank_id
Dim Width As Double = tank_height

Dim HeightString As String = CStr(Height)
Dim WidthString As String = CStr(Width)

Dim HeightParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_id")
Dim WidthParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_height")

HeightParam.Precision = 3 'I wish this worked to control the decimals displayed from either the expression or value. 
WidthParam.Precision = 3

Dim HeightSubString As String() = HeightParam.Expression.Split(" "c) 
Dim WidthSubString As String() = WidthParam.Expression.Split(" "c)


Logger.Info("Height blue value: " & tank_id & " Height double: " & Height & " Height String: " & HeightString & " Height param expression: " & HeightParam.Expression & " Height param value direct: " & HeightParam.Value / 2.54 & " Height substring: " & HeightSubString(0))
Logger.Info("Width blue value: "  & tank_height & " Widdth double: " & Width & "  Width String: " & WidthString & " Width param expression: " & WidthParam.Expression & " Width param value direct: " & HeightParam.Value / 2.54 & " Width substring: " & WidthSubString(0))
```

#### Code Block 17

```vb
Dim Height As Double = tank_id
Dim Width As Double = tank_height

Dim HeightString As String = CStr(Height)
Dim WidthString As String = CStr(Width)

Dim HeightParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_id")
Dim WidthParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_height")

HeightParam.Precision = 3 'I wish this worked to control the decimals displayed from either the expression or value. 
WidthParam.Precision = 3

Dim HeightSubString As String() = HeightParam.Expression.Split(" "c) 
Dim WidthSubString As String() = WidthParam.Expression.Split(" "c)


Logger.Info("Height blue value: " & tank_id & " Height double: " & Height & " Height String: " & HeightString & " Height param expression: " & HeightParam.Expression & " Height param value direct: " & HeightParam.Value / 2.54 & " Height substring: " & HeightSubString(0))
Logger.Info("Width blue value: "  & tank_height & " Widdth double: " & Width & "  Width String: " & WidthString & " Width param expression: " & WidthParam.Expression & " Width param value direct: " & HeightParam.Value / 2.54 & " Width substring: " & WidthSubString(0))
```

#### Code Block 18

```vb
Dim Height As Double = tank_id
Dim Width As Double = tank_height

Dim HeightString As String = CStr(Height)
Dim WidthString As String = CStr(Width)

Dim HeightParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_id")
Dim WidthParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_height")

HeightParam.Precision = 3 'I wish this worked to control the decimals displayed from either the expression or value. 
WidthParam.Precision = 3

Dim HeightSubString As String() = HeightParam.Expression.Split(" "c) 
Dim WidthSubString As String() = WidthParam.Expression.Split(" "c)


Logger.Info("Height blue value: " & tank_id & " Height double: " & Height & " Height String: " & HeightString & " Height param expression: " & HeightParam.Expression & " Height param value direct: " & HeightParam.Value / 2.54 & " Height substring: " & HeightSubString(0))
Logger.Info("Width blue value: "  & tank_height & " Widdth double: " & Width & "  Width String: " & WidthString & " Width param expression: " & WidthParam.Expression & " Width param value direct: " & HeightParam.Value / 2.54 & " Width substring: " & WidthSubString(0))
```

#### Code Block 19

```vb
Dim Height As Double = tank_id
Dim Width As Double = tank_height

Dim HeightString As String = CStr(Height)
Dim WidthString As String = CStr(Width)

Dim HeightParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_id")
Dim WidthParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_height")

HeightParam.Precision = 3 'I wish this worked to control the decimals displayed from either the expression or value. 
WidthParam.Precision = 3

Dim HeightSubString As String() = HeightParam.Expression.Split(" "c) 
Dim WidthSubString As String() = WidthParam.Expression.Split(" "c)


Logger.Info("Height blue value: " & tank_id & " Height double: " & Height & " Height String: " & HeightString & " Height param expression: " & HeightParam.Expression & " Height param value direct: " & HeightParam.Value / 2.54 & " Height substring: " & HeightSubString(0))
Logger.Info("Width blue value: "  & tank_height & " Widdth double: " & Width & "  Width String: " & WidthString & " Width param expression: " & WidthParam.Expression & " Width param value direct: " & HeightParam.Value / 2.54 & " Width substring: " & WidthSubString(0))
```

#### Code Block 20

```vb
Dim Height As Double = tank_id
Dim Width As Double = tank_height

Dim HeightString As String = CStr(Height)
Dim WidthString As String = CStr(Width)

Dim HeightParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_id")
Dim WidthParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_height")

HeightParam.Precision = 3 'I wish this worked to control the decimals displayed from either the expression or value. 
WidthParam.Precision = 3

Dim HeightSubString As String() = HeightParam.Expression.Split(" "c) 
Dim WidthSubString As String() = WidthParam.Expression.Split(" "c)


Logger.Info("Height blue value: " & tank_id & " Height double: " & Height & " Height String: " & HeightString & " Height param expression: " & HeightParam.Expression & " Height param value direct: " & HeightParam.Value / 2.54 & " Height substring: " & HeightSubString(0))
Logger.Info("Width blue value: "  & tank_height & " Widdth double: " & Width & "  Width String: " & WidthString & " Width param expression: " & WidthParam.Expression & " Width param value direct: " & HeightParam.Value / 2.54 & " Width substring: " & WidthSubString(0))
```

#### Code Block 21

```vb
Dim Height As Double = tank_id
Dim Width As Double = tank_height

Dim HeightString As String = CStr(Height)
Dim WidthString As String = CStr(Width)

Dim HeightParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_id")
Dim WidthParam As Inventor.Parameter = ThisApplication.ActiveDocument.componentDefinition.Parameters.Item("tank_height")

HeightParam.Precision = 3 'I wish this worked to control the decimals displayed from either the expression or value. 
WidthParam.Precision = 3

Dim HeightSubString As String() = HeightParam.Expression.Split(" "c) 
Dim WidthSubString As String() = WidthParam.Expression.Split(" "c)


Logger.Info("Height blue value: " & tank_id & " Height double: " & Height & " Height String: " & HeightString & " Height param expression: " & HeightParam.Expression & " Height param value direct: " & HeightParam.Value / 2.54 & " Height substring: " & HeightSubString(0))
Logger.Info("Width blue value: "  & tank_height & " Widdth double: " & Width & "  Width String: " & WidthString & " Width param expression: " & WidthParam.Expression & " Width param value direct: " & HeightParam.Value / 2.54 & " Width substring: " & WidthSubString(0))
```

#### Code Block 22

```vb
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 23

```vb
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 24

```vb
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 25

```vb
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 26

```vb
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

#### Code Block 27

```vb
iProperties.Value("Project", "Stock Number") = "HRS " & iProperties.Value("Custom", "GAUGE") & " x " & FormatNumber(WIDTH, 2) & " x " & FormatNumber(LENGTH, 2)
```

---

### 36. Use filename of 2D file, to fill in iproperties - Inventor 2024

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/use-filename-of-2d-file-to-fill-in-iproperties-inventor-2024/td-p/13802821#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/use-filename-of-2d-file-to-fill-in-iproperties-inventor-2024/td-p/13802821#messageview_0)

**Author:** jens_herrebaut83

**Date:** ‎09-09-2025
	
		
		04:46 AM

**Description:** Hi,   Is there a way to save a 2D file (ex: Title-desciption-customer.idw) and it automatically fills in the iproperties of that 2D file?     @jens_herrebaut83 Your post title was modified to add the product name and version and to increase findability - CGBenner     					 				 			 			 				 			 			 ...

**Code Snippets (2):**

#### Code Block 1

```vb
Try
	Dim oDoc As Document = ThisApplication.ActiveEditDocument
	Dim oName As String = ThisDoc.FileName(False)
	Dim oFirstDashPos As Integer = InStr(oName, "-")
	Dim oSecondDashPos As Integer = InStr(oFirstDashPos + 1, oName, "-")
	Dim oTitle As String = Left(oName, oFirstDashPos -1)
	Dim oClient As String = Mid(oName, oFirstDashPos + 1, oSecondDashPos - oFirstDashPos - 1)
	Dim oDesc As String = Right(oName, Len(oName) - oSecondDashPos)
	
	iProperties.Value("Summary", "Title") = oTitle
	iProperties.Value("Custom", "Client") = oClient
	iProperties.Value("Project", "Description") = oDesc
Catch
End Try
```

#### Code Block 2

```vb
Try
	Dim oDoc As Document = ThisApplication.ActiveEditDocument
	Dim oName As String = ThisDoc.FileName(False)
	Dim oFirstDashPos As Integer = InStr(oName, "-")
	Dim oSecondDashPos As Integer = InStr(oFirstDashPos + 1, oName, "-")
	Dim oTitle As String = Left(oName, oFirstDashPos -1)
	Dim oClient As String = Mid(oName, oFirstDashPos + 1, oSecondDashPos - oFirstDashPos - 1)
	Dim oDesc As String = Right(oName, Len(oName) - oSecondDashPos)
	
	iProperties.Value("Summary", "Title") = oTitle
	iProperties.Value("Custom", "Client") = oClient
	iProperties.Value("Project", "Description") = oDesc
Catch
End Try
```

#### Code Block 3

```vb
Try
	Dim oDoc As Document = ThisApplication.ActiveEditDocument
	Dim oName As String = ThisDoc.FileName(False)
	Dim oFirstDashPos As Integer = InStr(oName, "-")
	Dim oSecondDashPos As Integer = InStr(oFirstDashPos + 1, oName, "-")
	Dim oTitle As String = Left(oName, oFirstDashPos -1)
	Dim oClient As String = Mid(oName, oFirstDashPos + 1, oSecondDashPos - oFirstDashPos - 1)
	Dim oDesc As String = Right(oName, Len(oName) - oSecondDashPos)
	
	iProperties.Value("Summary", "Title") = oTitle
	iProperties.Value("Custom", "Client") = oClient
	iProperties.Value("Project", "Description") = oDesc
Catch
End Try
```

#### Code Block 4

```vb
Try
	Dim oDoc As Document = ThisApplication.ActiveEditDocument
	Dim oName As String = ThisDoc.FileName(False)
	Dim oFirstDashPos As Integer = InStr(oName, "-")
	Dim oSecondDashPos As Integer = InStr(oFirstDashPos + 1, oName, "-")
	Dim oTitle As String = Left(oName, oFirstDashPos -1)
	Dim oClient As String = Mid(oName, oFirstDashPos + 1, oSecondDashPos - oFirstDashPos - 1)
	Dim oDesc As String = Right(oName, Len(oName) - oSecondDashPos)
	
	iProperties.Value("Summary", "Title") = oTitle
	iProperties.Value("Custom", "Client") = oClient
	iProperties.Value("Project", "Description") = oDesc
Catch
End Try
```

---

### 37. Using Ilogic to update model states

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/using-ilogic-to-update-model-states/td-p/12844817](https://forums.autodesk.com/t5/inventor-programming-forum/using-ilogic-to-update-model-states/td-p/12844817)

**Author:** aberningR89Y3

**Date:** ‎06-17-2024
	
		
		10:52 AM

**Description:** I am looking for a way to update every model state in a part file without having to manually select each model state and click 'local update'.Ideally, I would like to do this without having to know the name of every model state beforehand. Something like: find each model state name, put it into an a...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	If oMSDoc Is Nothing Then Continue For
	oMSDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

#### Code Block 2

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	If oMSDoc Is Nothing Then Continue For
	oMSDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

#### Code Block 3

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	If oMSDoc Is Nothing Then Continue For
	oMSDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

#### Code Block 4

```vb
Dim oDoc As Inventor.Document = ThisDoc.FactoryDocument
If oDoc Is Nothing Then Return
Dim oMSs As ModelStates = oDoc.ComponentDefinition.ModelStates
If oMSs Is Nothing OrElse oMSs.Count = 0 Then Return
Dim oAMS As ModelState = oMSs.ActiveModelState
For Each oMS As ModelState In oMSs
	oMS.Activate
	Dim oMSDoc As Inventor.Document = TryCast(oMS.Document, Inventor.Document)
	If oMSDoc Is Nothing Then Continue For
	oMSDoc.Update2(True)
Next oMS
If oMSs.ActiveModelState IsNot oAMS Then oAMS.Activate
```

#### Code Block 5

```vb
ThisApplication.ActiveView.Update()
```

#### Code Block 6

```vb
ThisApplication.ActiveView.Update()
```

---

### 38. VBA : Using GetObject in Inventor 2024

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/vba-using-getobject-in-inventor-2024/td-p/13777048](https://forums.autodesk.com/t5/inventor-programming-forum/vba-using-getobject-in-inventor-2024/td-p/13777048)

**Author:** TONELLAL

**Date:** ‎08-21-2025
	
		
		04:05 AM

**Description:** Hello,I have several macros in VBA, using Excel. They connect to Excel using GetObject(, "Excel.application"), or CreateObject("Excel.application").These commands are not existing anymore in .NET framework > 5, so they don't work anymore with Inventor 2024.I found several links using .NET or C#, but...

**Code Snippets (2):**

#### Code Block 1

```vb
Option Explicit
Sub OpenExcel()
    Dim oExcelApp As Object
    Set oExcelApp = CreateObject("Excel.Application")
    oExcelApp.Visible = True
    
    Dim oWB As Object
    Set oWB = oExcelApp.Workbooks.Add()
    
    Dim oWS As Object
    Set oWS = oWB.Worksheets.Add()
    oWS.Name = "My New Worksheet"
    
    Call MsgBox("Review New Instance Of Excel, And New, Renamed Sheet In It.", , "")
    
    Call oWB.Close
    Call oExcelApp.Quit
    
    Set oWS = Nothing
    Set oWB = Nothing
    Set oExcelApp = Nothing
End Sub
```

#### Code Block 2

```vb
Option Explicit
Sub OpenExcel()
    Dim oExcelApp As Object
    Set oExcelApp = CreateObject("Excel.Application")
    oExcelApp.Visible = True
    
    Dim oWB As Object
    Set oWB = oExcelApp.Workbooks.Add()
    
    Dim oWS As Object
    Set oWS = oWB.Worksheets.Add()
    oWS.Name = "My New Worksheet"
    
    Call MsgBox("Review New Instance Of Excel, And New, Renamed Sheet In It.", , "")
    
    Call oWB.Close
    Call oExcelApp.Quit
    
    Set oWS = Nothing
    Set oWB = Nothing
    Set oExcelApp = Nothing
End Sub
```

#### Code Block 3

```vb
Option Explicit
Sub OpenExcel()
    Dim oExcelApp As Object
    Set oExcelApp = CreateObject("Excel.Application")
    oExcelApp.Visible = True
    
    Dim oWB As Object
    Set oWB = oExcelApp.Workbooks.Add()
    
    Dim oWS As Object
    Set oWS = oWB.Worksheets.Add()
    oWS.Name = "My New Worksheet"
    
    Call MsgBox("Review New Instance Of Excel, And New, Renamed Sheet In It.", , "")
    
    Call oWB.Close
    Call oExcelApp.Quit
    
    Set oWS = Nothing
    Set oWB = Nothing
    Set oExcelApp = Nothing
End Sub
```

#### Code Block 4

```vb
Option Explicit
Sub OpenExcel()
    Dim oExcelApp As Object
    Set oExcelApp = CreateObject("Excel.Application")
    oExcelApp.Visible = True
    
    Dim oWB As Object
    Set oWB = oExcelApp.Workbooks.Add()
    
    Dim oWS As Object
    Set oWS = oWB.Worksheets.Add()
    oWS.Name = "My New Worksheet"
    
    Call MsgBox("Review New Instance Of Excel, And New, Renamed Sheet In It.", , "")
    
    Call oWB.Close
    Call oExcelApp.Quit
    
    Set oWS = Nothing
    Set oWB = Nothing
    Set oExcelApp = Nothing
End Sub
```

---

### 39. Workflow to modify MaterialAsset (apply another PhysicalPropertiesAsset)

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/workflow-to-modify-materialasset-apply-another/td-p/13822777](https://forums.autodesk.com/t5/inventor-programming-forum/workflow-to-modify-materialasset-apply-another/td-p/13822777)

**Author:** Maxim-CADman77

**Date:** ‎09-23-2025
	
		
		04:12 PM

**Description:** I'm studying the possibility to automate modification of MaterialAssets (apply another PhysicalPropertiesAsset according to some logic).PhysicalPropertiesAsset description says it is a writable Asset property and "When assigning physical properties, the physical properties asset must exist in the sa...

**Code Snippets (6):**

#### Code Block 1

```vb
Dim ptDoc As PartDocument = ThisDoc.Document

Logger.Info(ptDoc.MaterialAssets.Count)

Dim srcMat As Asset = ptDoc.MaterialAssets(1)
Logger.Info(srcMat.DisplayName)
Logger.Info(vbTab & srcMat.PhysicalPropertiesAsset.DisplayName)

Dim tgtMat As Asset = ptDoc.MaterialAssets(2)
Logger.Info(tgtMat.DisplayName)
Logger.Info(vbTab & tgtMat.PhysicalPropertiesAsset.DisplayName)

tgtMat.PhysicalPropertiesAsset = srcMat.PhysicalPropertiesAsset ' HRESULT: 0x80020003 (DISP_E_MEMBERNOTFOUND)
```

#### Code Block 2

```vb
Dim ptDoc As PartDocument = ThisDoc.Document

Logger.Info(ptDoc.MaterialAssets.Count)

Dim srcMat As Asset = ptDoc.MaterialAssets(1)
Logger.Info(srcMat.DisplayName)
Logger.Info(vbTab & srcMat.PhysicalPropertiesAsset.DisplayName)

Dim tgtMat As Asset = ptDoc.MaterialAssets(2)
Logger.Info(tgtMat.DisplayName)
Logger.Info(vbTab & tgtMat.PhysicalPropertiesAsset.DisplayName)

tgtMat.PhysicalPropertiesAsset = srcMat.PhysicalPropertiesAsset ' HRESULT: 0x80020003 (DISP_E_MEMBERNOTFOUND)
```

#### Code Block 3

```vb
Dim ptDoc As PartDocument = ThisDoc.Document

Logger.Info(ptDoc.MaterialAssets.Count)

Dim srcMat As Asset = ptDoc.MaterialAssets(1)
Logger.Info(srcMat.DisplayName)
Logger.Info(vbTab & srcMat.PhysicalPropertiesAsset.DisplayName)

Dim tgtMat As Asset = ptDoc.MaterialAssets(2)
Logger.Info(tgtMat.DisplayName)
Logger.Info(vbTab & tgtMat.PhysicalPropertiesAsset.DisplayName)

tgtMat.PhysicalPropertiesAsset = srcMat.PhysicalPropertiesAsset ' HRESULT: 0x80020003 (DISP_E_MEMBERNOTFOUND)
```

#### Code Block 4

```vb
Dim ptDoc As PartDocument = ThisDoc.Document

Logger.Info(ptDoc.MaterialAssets.Count)

Dim srcMat As Asset = ptDoc.MaterialAssets(1)
Logger.Info(srcMat.DisplayName)
Logger.Info(vbTab & srcMat.PhysicalPropertiesAsset.DisplayName)

Dim tgtMat As Asset = ptDoc.MaterialAssets(2)
Logger.Info(tgtMat.DisplayName)
Logger.Info(vbTab & tgtMat.PhysicalPropertiesAsset.DisplayName)

tgtMat.PhysicalPropertiesAsset = srcMat.PhysicalPropertiesAsset ' HRESULT: 0x80020003 (DISP_E_MEMBERNOTFOUND)
```

#### Code Block 5

```vb
Dim srcMat As Asset = ptDoc.MaterialAssets(1)
Dim tgtMat As Asset = ptDoc.MaterialAssets(2)
```

#### Code Block 6

```vb
Dim srcMat As Asset = ptDoc.MaterialAssets(1)
Dim tgtMat As Asset = ptDoc.MaterialAssets(2)
```

#### Code Block 7

```vb
Dim srcMat As Asset = ptDoc.MaterialAssets(1)
Dim tgtMat As Asset = ptDoc.MaterialAssets(2)
```

#### Code Block 8

```vb
Dim srcMat As Asset = ptDoc.MaterialAssets(1)
Dim tgtMat As Asset = ptDoc.MaterialAssets(2)
```

#### Code Block 9

```vb
Dim srcMat As MaterialAsset = ptDoc.MaterialAssets(1)
Dim tgtMat As MaterialAsset = ptDoc.MaterialAssets(2)
```

#### Code Block 10

```vb
Dim srcMat As MaterialAsset = ptDoc.MaterialAssets(1)
Dim tgtMat As MaterialAsset = ptDoc.MaterialAssets(2)
```

#### Code Block 11

```vb
Dim srcMat As MaterialAsset = ptDoc.MaterialAssets(1)
Dim tgtMat As MaterialAsset = ptDoc.MaterialAssets(2)
```

#### Code Block 12

```vb
Dim srcMat As MaterialAsset = ptDoc.MaterialAssets(1)
Dim tgtMat As MaterialAsset = ptDoc.MaterialAssets(2)
```

---

### 40. acad.exe link problem!

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/acad-exe-link-problem/td-p/13822188](https://forums.autodesk.com/t5/inventor-programming-forum/acad-exe-link-problem/td-p/13822188)

**Author:** SergeLachance

**Date:** ‎09-23-2025
	
		
		07:43 AM

**Description:** i have a old rule who working great until a install inventor 2026??? i just change the new link but error message!any body can help me???sorry for my horrible english! my old rule: ' Get the DXF translator Add-In. Dim DXFAddIn As TranslatorAddIn DXFAddIn = ThisApplication.ApplicationAddIns.ItemById(...

**Code Snippets (8):**

#### Code Block 1

```vb
"‪‪C:\Program Files\Autodesk\AutoCAD 2026\acad.exe"
```

#### Code Block 2

```vb
"‪‪C:\Program Files\Autodesk\AutoCAD 2026\acad.exe"
```

#### Code Block 3

```vb
' Get the DXF translator Add-In.
Dim DXFAddIn As TranslatorAddIn
DXFAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC4-122E-11D5-8E91-0010B541CD80}")
'Set a reference to the active document (the document to be published).
Dim oDocument As Document
oDocument = ThisApplication.ActiveDocument
Dim oContext As TranslationContext
oContext = ThisApplication.TransientObjects.CreateTranslationContext
oContext.Type = IOMechanismEnum.kFileBrowseIOMechanism
' Create a NameValueMap object
Dim oOptions As NameValueMap
oOptions = ThisApplication.TransientObjects.CreateNameValueMap
' Create a DataMedium object
Dim oDataMedium As DataMedium
oDataMedium = ThisApplication.TransientObjects.CreateDataMedium
' Check whether the translator has 'SaveCopyAs' options
If DXFAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then
Dim strIniFile As String
strIniFile = "I:\INVENTOR\ILOGIC\TEMPLATE\DXFOut.ini"
' Create the name-value that specifies the ini file to use.
oOptions.Value("Export_Acad_IniFile") = strIniFile
End If

DOSSIER = ThisDoc.Path
POSITION1 = InStrRev(DOSSIER, "\") 
POSITION2 = Right(DOSSIER, Len(DOSSIER) - POSITION1)

'get DXF target folder path
oFolder = "I:\DOCUMENTS\ARTICLES\" & POSITION2 & "\"
oFileName = ThisDoc.FileName(False) 'without extension

'Check for the PDF folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
    System.IO.Directory.CreateDirectory(oFolder)
End If

For i = 1 To 100
chiffre = i
myFile = oFolder & oFileName & "_Sheet_" & chiffre & ".dxf"
If(System.IO.File.Exists(myFile)) Then
Kill (myFile)
End If
Next i

'Set the destination file name
oDataMedium.FileName = oFolder & oFileName & ".dxf"
oFileName = ThisDoc.FileName(False) 'without extension

'Publish document.
DXFAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
'Launch the dxf file in whatever application Windows is set to open this document type with

myFile2 = oFolder & oFileName & "_Sheet_" & 100 & ".dxf"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If

' Get the DWG translator Add-In.
Dim oDWGAddIn As TranslatorAddIn 
oDWGAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC4-122E-11D5-8E91-0010B541CD80}")
' Check whether the translator has 'SaveCopyAs' options
If oDWGAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then
Dim strIniFile As String
strIniFile = "I:\INVENTOR\ILOGIC\TEMPLATE\DWGOut.ini"
' Create the name-value that specifies the ini file to use.
oOptions.Value("Export_Acad_IniFile") = strIniFile
End If

'get DXF target folder path
oFolder2 = "I:\DOCUMENTS\ARTICLES\" & POSITION2 & "\"
oFileName2 = ThisDoc.FileName(False) 'without extension

'Check for the PDF folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder2) Then
    System.IO.Directory.CreateDirectory(oFolder2)
End If

For i = 1 To 100
chiffre2 = i
myFile2 = oFolder2 & oFileName2 & "_Sheet_" & chiffre2 & ".dwg"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If
Next i

'Set the destination file name
oDataMedium.FileName = oFolder2 & oFileName2 & ".dwg"
oFileName2 = ThisDoc.FileName(False) 'without extension

'Publish document.
oDWGAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
'Launch the dxf file in whatever application Windows is set to open this document type with

myFile2 = oFolder2 & oFileName2 & "_Sheet_" & 100 & ".dwg"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If

question = MessageBox.Show("VEUX-TU OUVRIR AUTOCAD POUR PURGER TES DESSINS???", "OUVERTURE AUTOCAD???", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1)
MultiValue.SetValueOptions(True)
If question = vbYes Then
GoTo OUVERTURE
Else If question = vbNo Then
GoTo FIN
End If

OUVERTURE :
Dim acadExe = "C:\Program Files\Autodesk\AutoCAD 2025\acad.exe"

'MessageBox.Show("N'OUBLIE PAS DE SAUVER EN VERSION 2000, UNE FOIS TON DESSIN PURGER ET DE PURGER TOUTES TES PAGES", "ATTENTION",MessageBoxButtons.OK,MessageBoxIcon.Warning)
Process.Start(acadExe, oFolder2 & oFileName2 & "_Sheet_" & 1 & ".dwg")

FIN:
```

#### Code Block 4

```vb
' Get the DXF translator Add-In.
Dim DXFAddIn As TranslatorAddIn
DXFAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC4-122E-11D5-8E91-0010B541CD80}")
'Set a reference to the active document (the document to be published).
Dim oDocument As Document
oDocument = ThisApplication.ActiveDocument
Dim oContext As TranslationContext
oContext = ThisApplication.TransientObjects.CreateTranslationContext
oContext.Type = IOMechanismEnum.kFileBrowseIOMechanism
' Create a NameValueMap object
Dim oOptions As NameValueMap
oOptions = ThisApplication.TransientObjects.CreateNameValueMap
' Create a DataMedium object
Dim oDataMedium As DataMedium
oDataMedium = ThisApplication.TransientObjects.CreateDataMedium
' Check whether the translator has 'SaveCopyAs' options
If DXFAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then
Dim strIniFile As String
strIniFile = "I:\INVENTOR\ILOGIC\TEMPLATE\DXFOut.ini"
' Create the name-value that specifies the ini file to use.
oOptions.Value("Export_Acad_IniFile") = strIniFile
End If

DOSSIER = ThisDoc.Path
POSITION1 = InStrRev(DOSSIER, "\") 
POSITION2 = Right(DOSSIER, Len(DOSSIER) - POSITION1)

'get DXF target folder path
oFolder = "I:\DOCUMENTS\ARTICLES\" & POSITION2 & "\"
oFileName = ThisDoc.FileName(False) 'without extension

'Check for the PDF folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
    System.IO.Directory.CreateDirectory(oFolder)
End If

For i = 1 To 100
chiffre = i
myFile = oFolder & oFileName & "_Sheet_" & chiffre & ".dxf"
If(System.IO.File.Exists(myFile)) Then
Kill (myFile)
End If
Next i

'Set the destination file name
oDataMedium.FileName = oFolder & oFileName & ".dxf"
oFileName = ThisDoc.FileName(False) 'without extension

'Publish document.
DXFAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
'Launch the dxf file in whatever application Windows is set to open this document type with

myFile2 = oFolder & oFileName & "_Sheet_" & 100 & ".dxf"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If

' Get the DWG translator Add-In.
Dim oDWGAddIn As TranslatorAddIn 
oDWGAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC4-122E-11D5-8E91-0010B541CD80}")
' Check whether the translator has 'SaveCopyAs' options
If oDWGAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then
Dim strIniFile As String
strIniFile = "I:\INVENTOR\ILOGIC\TEMPLATE\DWGOut.ini"
' Create the name-value that specifies the ini file to use.
oOptions.Value("Export_Acad_IniFile") = strIniFile
End If

'get DXF target folder path
oFolder2 = "I:\DOCUMENTS\ARTICLES\" & POSITION2 & "\"
oFileName2 = ThisDoc.FileName(False) 'without extension

'Check for the PDF folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder2) Then
    System.IO.Directory.CreateDirectory(oFolder2)
End If

For i = 1 To 100
chiffre2 = i
myFile2 = oFolder2 & oFileName2 & "_Sheet_" & chiffre2 & ".dwg"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If
Next i

'Set the destination file name
oDataMedium.FileName = oFolder2 & oFileName2 & ".dwg"
oFileName2 = ThisDoc.FileName(False) 'without extension

'Publish document.
oDWGAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
'Launch the dxf file in whatever application Windows is set to open this document type with

myFile2 = oFolder2 & oFileName2 & "_Sheet_" & 100 & ".dwg"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If

question = MessageBox.Show("VEUX-TU OUVRIR AUTOCAD POUR PURGER TES DESSINS???", "OUVERTURE AUTOCAD???", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1)
MultiValue.SetValueOptions(True)
If question = vbYes Then
GoTo OUVERTURE
Else If question = vbNo Then
GoTo FIN
End If

OUVERTURE :
Dim acadExe = "C:\Program Files\Autodesk\AutoCAD 2025\acad.exe"

'MessageBox.Show("N'OUBLIE PAS DE SAUVER EN VERSION 2000, UNE FOIS TON DESSIN PURGER ET DE PURGER TOUTES TES PAGES", "ATTENTION",MessageBoxButtons.OK,MessageBoxIcon.Warning)
Process.Start(acadExe, oFolder2 & oFileName2 & "_Sheet_" & 1 & ".dwg")

FIN:
```

#### Code Block 5

```vb
' Get the DXF translator Add-In.
Dim DXFAddIn As TranslatorAddIn
DXFAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC4-122E-11D5-8E91-0010B541CD80}")
'Set a reference to the active document (the document to be published).
Dim oDocument As Document
oDocument = ThisApplication.ActiveDocument
Dim oContext As TranslationContext
oContext = ThisApplication.TransientObjects.CreateTranslationContext
oContext.Type = IOMechanismEnum.kFileBrowseIOMechanism
' Create a NameValueMap object
Dim oOptions As NameValueMap
oOptions = ThisApplication.TransientObjects.CreateNameValueMap
' Create a DataMedium object
Dim oDataMedium As DataMedium
oDataMedium = ThisApplication.TransientObjects.CreateDataMedium
' Check whether the translator has 'SaveCopyAs' options
If DXFAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then
Dim strIniFile As String
strIniFile = "I:\INVENTOR\ILOGIC\TEMPLATE\DXFOut.ini"
' Create the name-value that specifies the ini file to use.
oOptions.Value("Export_Acad_IniFile") = strIniFile
End If

DOSSIER = ThisDoc.Path
POSITION1 = InStrRev(DOSSIER, "\") 
POSITION2 = Right(DOSSIER, Len(DOSSIER) - POSITION1)

'get DXF target folder path
oFolder = "I:\DOCUMENTS\ARTICLES\" & POSITION2 & "\"
oFileName = ThisDoc.FileName(False) 'without extension

'Check for the PDF folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
    System.IO.Directory.CreateDirectory(oFolder)
End If

For i = 1 To 100
chiffre = i
myFile = oFolder & oFileName & "_Sheet_" & chiffre & ".dxf"
If(System.IO.File.Exists(myFile)) Then
Kill (myFile)
End If
Next i

'Set the destination file name
oDataMedium.FileName = oFolder & oFileName & ".dxf"
oFileName = ThisDoc.FileName(False) 'without extension

'Publish document.
DXFAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
'Launch the dxf file in whatever application Windows is set to open this document type with

myFile2 = oFolder & oFileName & "_Sheet_" & 100 & ".dxf"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If

' Get the DWG translator Add-In.
Dim oDWGAddIn As TranslatorAddIn 
oDWGAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC4-122E-11D5-8E91-0010B541CD80}")
' Check whether the translator has 'SaveCopyAs' options
If oDWGAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then
Dim strIniFile As String
strIniFile = "I:\INVENTOR\ILOGIC\TEMPLATE\DWGOut.ini"
' Create the name-value that specifies the ini file to use.
oOptions.Value("Export_Acad_IniFile") = strIniFile
End If

'get DXF target folder path
oFolder2 = "I:\DOCUMENTS\ARTICLES\" & POSITION2 & "\"
oFileName2 = ThisDoc.FileName(False) 'without extension

'Check for the PDF folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder2) Then
    System.IO.Directory.CreateDirectory(oFolder2)
End If

For i = 1 To 100
chiffre2 = i
myFile2 = oFolder2 & oFileName2 & "_Sheet_" & chiffre2 & ".dwg"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If
Next i

'Set the destination file name
oDataMedium.FileName = oFolder2 & oFileName2 & ".dwg"
oFileName2 = ThisDoc.FileName(False) 'without extension

'Publish document.
oDWGAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
'Launch the dxf file in whatever application Windows is set to open this document type with

myFile2 = oFolder2 & oFileName2 & "_Sheet_" & 100 & ".dwg"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If

question = MessageBox.Show("VEUX-TU OUVRIR AUTOCAD POUR PURGER TES DESSINS???", "OUVERTURE AUTOCAD???", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1)
MultiValue.SetValueOptions(True)
If question = vbYes Then
GoTo OUVERTURE
Else If question = vbNo Then
GoTo FIN
End If

OUVERTURE :
Dim acadExe = "‪‪C:\Program Files\Autodesk\AutoCAD 2026\acad.exe"

'MessageBox.Show("N'OUBLIE PAS DE SAUVER EN VERSION 2000, UNE FOIS TON DESSIN PURGER ET DE PURGER TOUTES TES PAGES", "ATTENTION",MessageBoxButtons.OK,MessageBoxIcon.Warning)
Process.Start(acadExe, oFolder2 & oFileName2 & "_Sheet_" & 1 & ".dwg")

FIN:
```

#### Code Block 6

```vb
' Get the DXF translator Add-In.
Dim DXFAddIn As TranslatorAddIn
DXFAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC4-122E-11D5-8E91-0010B541CD80}")
'Set a reference to the active document (the document to be published).
Dim oDocument As Document
oDocument = ThisApplication.ActiveDocument
Dim oContext As TranslationContext
oContext = ThisApplication.TransientObjects.CreateTranslationContext
oContext.Type = IOMechanismEnum.kFileBrowseIOMechanism
' Create a NameValueMap object
Dim oOptions As NameValueMap
oOptions = ThisApplication.TransientObjects.CreateNameValueMap
' Create a DataMedium object
Dim oDataMedium As DataMedium
oDataMedium = ThisApplication.TransientObjects.CreateDataMedium
' Check whether the translator has 'SaveCopyAs' options
If DXFAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then
Dim strIniFile As String
strIniFile = "I:\INVENTOR\ILOGIC\TEMPLATE\DXFOut.ini"
' Create the name-value that specifies the ini file to use.
oOptions.Value("Export_Acad_IniFile") = strIniFile
End If

DOSSIER = ThisDoc.Path
POSITION1 = InStrRev(DOSSIER, "\") 
POSITION2 = Right(DOSSIER, Len(DOSSIER) - POSITION1)

'get DXF target folder path
oFolder = "I:\DOCUMENTS\ARTICLES\" & POSITION2 & "\"
oFileName = ThisDoc.FileName(False) 'without extension

'Check for the PDF folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder) Then
    System.IO.Directory.CreateDirectory(oFolder)
End If

For i = 1 To 100
chiffre = i
myFile = oFolder & oFileName & "_Sheet_" & chiffre & ".dxf"
If(System.IO.File.Exists(myFile)) Then
Kill (myFile)
End If
Next i

'Set the destination file name
oDataMedium.FileName = oFolder & oFileName & ".dxf"
oFileName = ThisDoc.FileName(False) 'without extension

'Publish document.
DXFAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
'Launch the dxf file in whatever application Windows is set to open this document type with

myFile2 = oFolder & oFileName & "_Sheet_" & 100 & ".dxf"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If

' Get the DWG translator Add-In.
Dim oDWGAddIn As TranslatorAddIn 
oDWGAddIn = ThisApplication.ApplicationAddIns.ItemById("{C24E3AC4-122E-11D5-8E91-0010B541CD80}")
' Check whether the translator has 'SaveCopyAs' options
If oDWGAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then
Dim strIniFile As String
strIniFile = "I:\INVENTOR\ILOGIC\TEMPLATE\DWGOut.ini"
' Create the name-value that specifies the ini file to use.
oOptions.Value("Export_Acad_IniFile") = strIniFile
End If

'get DXF target folder path
oFolder2 = "I:\DOCUMENTS\ARTICLES\" & POSITION2 & "\"
oFileName2 = ThisDoc.FileName(False) 'without extension

'Check for the PDF folder and create it if it does not exist
If Not System.IO.Directory.Exists(oFolder2) Then
    System.IO.Directory.CreateDirectory(oFolder2)
End If

For i = 1 To 100
chiffre2 = i
myFile2 = oFolder2 & oFileName2 & "_Sheet_" & chiffre2 & ".dwg"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If
Next i

'Set the destination file name
oDataMedium.FileName = oFolder2 & oFileName2 & ".dwg"
oFileName2 = ThisDoc.FileName(False) 'without extension

'Publish document.
oDWGAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
'Launch the dxf file in whatever application Windows is set to open this document type with

myFile2 = oFolder2 & oFileName2 & "_Sheet_" & 100 & ".dwg"
If(System.IO.File.Exists(myFile2)) Then
Kill (myFile2)
End If

question = MessageBox.Show("VEUX-TU OUVRIR AUTOCAD POUR PURGER TES DESSINS???", "OUVERTURE AUTOCAD???", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1)
MultiValue.SetValueOptions(True)
If question = vbYes Then
GoTo OUVERTURE
Else If question = vbNo Then
GoTo FIN
End If

OUVERTURE :
Dim acadExe = "‪‪C:\Program Files\Autodesk\AutoCAD 2026\acad.exe"

'MessageBox.Show("N'OUBLIE PAS DE SAUVER EN VERSION 2000, UNE FOIS TON DESSIN PURGER ET DE PURGER TOUTES TES PAGES", "ATTENTION",MessageBoxButtons.OK,MessageBoxIcon.Warning)
Process.Start(acadExe, oFolder2 & oFileName2 & "_Sheet_" & 1 & ".dwg")

FIN:
```

#### Code Block 7

```vb
C:\Program Files\Autodesk\AutoCAD 2026\acad.exe
```

#### Code Block 8

```vb
C:\Program Files\Autodesk\AutoCAD 2026\acad.exe
```

#### Code Block 9

```vb
Dim acadExe = "‪‪C:\Program Files\Autodesk\AutoCAD 2026\acad.exe"

'MessageBox.Show("N'OUBLIE PAS DE SAUVER EN VERSION 2000, UNE FOIS TON DESSIN PURGER ET DE PURGER TOUTES TES PAGES", "ATTENTION",MessageBoxButtons.OK,MessageBoxIcon.Warning)
Process.Start(acadExe)
```

#### Code Block 10

```vb
Dim acadExe = "‪‪C:\Program Files\Autodesk\AutoCAD 2026\acad.exe"

'MessageBox.Show("N'OUBLIE PAS DE SAUVER EN VERSION 2000, UNE FOIS TON DESSIN PURGER ET DE PURGER TOUTES TES PAGES", "ATTENTION",MessageBoxButtons.OK,MessageBoxIcon.Warning)
Process.Start(acadExe)
```

#### Code Block 11

```vb
Dim acadExe = "‪‪C:\Program Files\Autodesk\AutoCAD 2026\acad.exe"

Process.Start(acadExe)
```

#### Code Block 12

```vb
Dim acadExe = "‪‪C:\Program Files\Autodesk\AutoCAD 2026\acad.exe"

Process.Start(acadExe)
```

#### Code Block 13

```vb
Process.Start("notepad.exe")
```

#### Code Block 14

```vb
Process.Start("notepad.exe")
```

#### Code Block 15

```vb
Process.Start(acad.exe)
```

#### Code Block 16

```vb
Process.Start(acad.exe)
```

---

### 41. how to change weld size in weld symbol by ilogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/how-to-change-weld-size-in-weld-symbol-by-ilogic/td-p/13788475](https://forums.autodesk.com/t5/inventor-programming-forum/how-to-change-weld-size-in-weld-symbol-by-ilogic/td-p/13788475)

**Author:** sameer_maratheRNRKJ

**Date:** ‎08-29-2025
	
		
		04:13 AM

**Code Snippets (2):**

#### Code Block 1

```vb
Dim obj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAllEntitiesFilter, "Select a weld symbol")

If (TypeOf obj IsNot DrawingWeldingSymbol) Then
    MsgBox("You did not select a welding symbol")
    Return
End If

Dim symbol As DrawingWeldingSymbol = obj
Dim def As DrawingWeldingSymbolDefinition = symbol.Definitions.Item(1)
Dim symbolDef1 = def.WeldSymbolOne
Dim symbolDef2 = def.WeldSymbolTwo

symbolDef1.Prefix = "Prefix 1"
symbolDef1.Leg1 = "Leg 1.1"
symbolDef1.Leg2 = "Leg 1.2"
symbolDef1.WeldSymbolType = WeldSymbolTypeEnum.kFilletWeldSymbolType
symbolDef1.Length = "Length 1"
symbolDef1.Pitch = "Pitch 1"

symbolDef2.Prefix = "Prefix 2"
symbolDef2.Leg1 = "Leg 2.1"
symbolDef2.Leg2 = "Leg 2.2"
symbolDef2.WeldSymbolType = WeldSymbolTypeEnum.kFilletWeldSymbolType
symbolDef2.Length = "Length 2"
symbolDef2.Pitch = "Pitch 2"
```

#### Code Block 2

```vb
Dim obj = ThisApplication.CommandManager.Pick(SelectionFilterEnum.kAllEntitiesFilter, "Select a weld symbol")

If (TypeOf obj IsNot DrawingWeldingSymbol) Then
    MsgBox("You did not select a welding symbol")
    Return
End If

Dim symbol As DrawingWeldingSymbol = obj
Dim def As DrawingWeldingSymbolDefinition = symbol.Definitions.Item(1)
Dim symbolDef1 = def.WeldSymbolOne
Dim symbolDef2 = def.WeldSymbolTwo

symbolDef1.Prefix = "Prefix 1"
symbolDef1.Leg1 = "Leg 1.1"
symbolDef1.Leg2 = "Leg 1.2"
symbolDef1.WeldSymbolType = WeldSymbolTypeEnum.kFilletWeldSymbolType
symbolDef1.Length = "Length 1"
symbolDef1.Pitch = "Pitch 1"

symbolDef2.Prefix = "Prefix 2"
symbolDef2.Leg1 = "Leg 2.1"
symbolDef2.Leg2 = "Leg 2.2"
symbolDef2.WeldSymbolType = WeldSymbolTypeEnum.kFilletWeldSymbolType
symbolDef2.Length = "Length 2"
symbolDef2.Pitch = "Pitch 2"
```

---

### 42. iLogic - Check active project is true

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-check-active-project-is-true/td-p/10218046](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-check-active-project-is-true/td-p/10218046)

**Author:** neil.cooke

**Date:** ‎04-07-2021
	
		
		02:19 AM

**Description:** I have found similar requests with solution but I am quite a new user to iLogic and perhaps missing the obvious (Sorry). I am trying to check that a specific project file is active, if it is not true then to pop up a message box stating you need to set the active project to the specified file. Pleas...

**Code Snippets (4):**

#### Code Block 1

```vb
Public Sub InventorProjectFile(oInvapp As Inventor.Application)

        Dim proj As DesignProject

        Try
            proj = oInvapp.DesignProjectManager.DesignProjects.ItemByName("C:\#######.ipj")
            proj.Activate()
        Catch ex As Exception
            If Not oInvapp.DesignProjectManager.ActiveDesignProject.FullFileName = "C:\#######.ipj" Then
                MsgBox("The wrong Project file has been Loaded !" & vbCrLf & "The Current Project file = " & oInvapp.DesignProjectManager.ActiveDesignProject.Name & vbCrLf & "Load the " & "C:\#######.ipj" & " file", vbCritical)
            End If
        End Try
end sub
```

#### Code Block 2

```vb
Public Sub InventorProjectFile(oInvapp As Inventor.Application)

        Dim proj As DesignProject

        Try
            proj = oInvapp.DesignProjectManager.DesignProjects.ItemByName("C:\#######.ipj")
            proj.Activate()
        Catch ex As Exception
            If Not oInvapp.DesignProjectManager.ActiveDesignProject.FullFileName = "C:\#######.ipj" Then
                MsgBox("The wrong Project file has been Loaded !" & vbCrLf & "The Current Project file = " & oInvapp.DesignProjectManager.ActiveDesignProject.Name & vbCrLf & "Load the " & "C:\#######.ipj" & " file", vbCritical)
            End If
        End Try
end sub
```

#### Code Block 3

```vb
Public Sub InventorProjectFile(oInvapp As Inventor.Application)

        Dim proj As DesignProject

        Try
            proj = oInvapp.DesignProjectManager.DesignProjects.ItemByName("C:\#######.ipj")
            proj.Activate()
        Catch ex As Exception
            If Not oInvapp.DesignProjectManager.ActiveDesignProject.FullFileName = "C:\#######.ipj" Then
                MsgBox("The wrong Project file has been Loaded !" & vbCrLf & "The Current Project file = " & oInvapp.DesignProjectManager.ActiveDesignProject.Name & vbCrLf & "Load the " & "C:\#######.ipj" & " file", vbCritical)
            End If
        End Try
end sub
```

#### Code Block 4

```vb
Public Sub InventorProjectFile(oInvapp As Inventor.Application)

        Dim proj As DesignProject

        Try
            proj = oInvapp.DesignProjectManager.DesignProjects.ItemByName("C:\#######.ipj")
            proj.Activate()
        Catch ex As Exception
            If Not oInvapp.DesignProjectManager.ActiveDesignProject.FullFileName = "C:\#######.ipj" Then
                MsgBox("The wrong Project file has been Loaded !" & vbCrLf & "The Current Project file = " & oInvapp.DesignProjectManager.ActiveDesignProject.Name & vbCrLf & "Load the " & "C:\#######.ipj" & " file", vbCritical)
            End If
        End Try
end sub
```

#### Code Block 5

```vb
Sub Main
	Const sProjPath As String = "C:\Temp\"
	Const sProjFileName As String = "MyInventorProject.ipj"
	Const sProjFile As String = "C:\Temp\MyInventorProject.ipj"
	Dim oProjMgr As Inventor.DesignProjectManager = ThisApplication.DesignProjectManager
	'get FullFileName of active DesignProject
	Dim sActiveProj As String = oProjMgr.ActiveDesignProject.FullFileName
	'only react if it is not the one expected / wanted
	If Not sActiveProj = sProjFile Then
		'Log it, or let user know
		Logger.Info("Active Project File Is:  " & sActiveProj)
		'MessageBox.Show("Active Project File Is:  " & sActiveProj)
		'try to find / get the DesignProject we want, by its FullFileName
		Dim oMyProj As Inventor.DesignProject = Nothing
		Try
			oMyProj = oProjMgr.DesignProjects.ItemByName(sProjFile)
		Catch
			Logger.Warn("Specified Inventor DesignProject Not Fount In Projects Collection!")
		End Try
		'if it was not found in that collection, then add it
		If oMyProj Is Nothing Then
			Try
				oMyProj = oProjMgr.DesignProjects.AddExisting(sProjFile)
			Catch
				Logger.Error("Error Adding Specified DesignProject To Projects Collection!")
			End Try
		End If
		'if we now have it, then activate it
		If oMyProj IsNot Nothing Then
			Try
				'True = Set as Default Project
				oMyProj.Activate(True)
			Catch
				Logger.Error("Error Activating Specified DesignProject!")
			End Try
		End If
	End If
End Sub
```

#### Code Block 6

```vb
Sub Main
	Const sProjPath As String = "C:\Temp\"
	Const sProjFileName As String = "MyInventorProject.ipj"
	Const sProjFile As String = "C:\Temp\MyInventorProject.ipj"
	Dim oProjMgr As Inventor.DesignProjectManager = ThisApplication.DesignProjectManager
	'get FullFileName of active DesignProject
	Dim sActiveProj As String = oProjMgr.ActiveDesignProject.FullFileName
	'only react if it is not the one expected / wanted
	If Not sActiveProj = sProjFile Then
		'Log it, or let user know
		Logger.Info("Active Project File Is:  " & sActiveProj)
		'MessageBox.Show("Active Project File Is:  " & sActiveProj)
		'try to find / get the DesignProject we want, by its FullFileName
		Dim oMyProj As Inventor.DesignProject = Nothing
		Try
			oMyProj = oProjMgr.DesignProjects.ItemByName(sProjFile)
		Catch
			Logger.Warn("Specified Inventor DesignProject Not Fount In Projects Collection!")
		End Try
		'if it was not found in that collection, then add it
		If oMyProj Is Nothing Then
			Try
				oMyProj = oProjMgr.DesignProjects.AddExisting(sProjFile)
			Catch
				Logger.Error("Error Adding Specified DesignProject To Projects Collection!")
			End Try
		End If
		'if we now have it, then activate it
		If oMyProj IsNot Nothing Then
			Try
				'True = Set as Default Project
				oMyProj.Activate(True)
			Catch
				Logger.Error("Error Activating Specified DesignProject!")
			End Try
		End If
	End If
End Sub
```

#### Code Block 7

```vb
Sub Main
	Const sProjPath As String = "C:\Temp\"
	Const sProjFileName As String = "MyInventorProject.ipj"
	Const sProjFile As String = "C:\Temp\MyInventorProject.ipj"
	Dim oProjMgr As Inventor.DesignProjectManager = ThisApplication.DesignProjectManager
	'get FullFileName of active DesignProject
	Dim sActiveProj As String = oProjMgr.ActiveDesignProject.FullFileName
	'only react if it is not the one expected / wanted
	If Not sActiveProj = sProjFile Then
		'Log it, or let user know
		Logger.Info("Active Project File Is:  " & sActiveProj)
		'MessageBox.Show("Active Project File Is:  " & sActiveProj)
		'try to find / get the DesignProject we want, by its FullFileName
		Dim oMyProj As Inventor.DesignProject = Nothing
		Try
			oMyProj = oProjMgr.DesignProjects.ItemByName(sProjFile)
		Catch
			Logger.Warn("Specified Inventor DesignProject Not Fount In Projects Collection!")
		End Try
		'if it was not found in that collection, then add it
		If oMyProj Is Nothing Then
			Try
				oMyProj = oProjMgr.DesignProjects.AddExisting(sProjFile)
			Catch
				Logger.Error("Error Adding Specified DesignProject To Projects Collection!")
			End Try
		End If
		'if we now have it, then activate it
		If oMyProj IsNot Nothing Then
			Try
				'True = Set as Default Project
				oMyProj.Activate(True)
			Catch
				Logger.Error("Error Activating Specified DesignProject!")
			End Try
		End If
	End If
End Sub
```

#### Code Block 8

```vb
Sub Main
	Const sProjPath As String = "C:\Temp\"
	Const sProjFileName As String = "MyInventorProject.ipj"
	Const sProjFile As String = "C:\Temp\MyInventorProject.ipj"
	Dim oProjMgr As Inventor.DesignProjectManager = ThisApplication.DesignProjectManager
	'get FullFileName of active DesignProject
	Dim sActiveProj As String = oProjMgr.ActiveDesignProject.FullFileName
	'only react if it is not the one expected / wanted
	If Not sActiveProj = sProjFile Then
		'Log it, or let user know
		Logger.Info("Active Project File Is:  " & sActiveProj)
		'MessageBox.Show("Active Project File Is:  " & sActiveProj)
		'try to find / get the DesignProject we want, by its FullFileName
		Dim oMyProj As Inventor.DesignProject = Nothing
		Try
			oMyProj = oProjMgr.DesignProjects.ItemByName(sProjFile)
		Catch
			Logger.Warn("Specified Inventor DesignProject Not Fount In Projects Collection!")
		End Try
		'if it was not found in that collection, then add it
		If oMyProj Is Nothing Then
			Try
				oMyProj = oProjMgr.DesignProjects.AddExisting(sProjFile)
			Catch
				Logger.Error("Error Adding Specified DesignProject To Projects Collection!")
			End Try
		End If
		'if we now have it, then activate it
		If oMyProj IsNot Nothing Then
			Try
				'True = Set as Default Project
				oMyProj.Activate(True)
			Catch
				Logger.Error("Error Activating Specified DesignProject!")
			End Try
		End If
	End If
End Sub
```

---

### 43. iLogic Code to export Sheets to IDWS

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-code-to-export-sheets-to-idws/td-p/13705767#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-code-to-export-sheets-to-idws/td-p/13705767#messageview_0)

**Author:** rossPJ9W7

**Date:** ‎07-01-2025
	
		
		05:12 AM

**Description:** I need help with this code. The goal is to export all the sheets in a idw file to seperate idws with the sheet name as the file name. The code works. All the sheets are saved in a new folder created called " Sheets". All new idw files are named with the sheet name. Issue: The new idws dont open. Fro...

**Code Snippets (8):**

#### Code Block 1

```vb
'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
```

#### Code Block 2

```vb
'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
```

#### Code Block 3

```vb
'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
```

#### Code Block 4

```vb
'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
```

#### Code Block 5

```vb
Dim sSheetName As String = oSheet.Name
		If sSheetName.Contains(":") Then
			'Split Sheet name at colon character to create Array of Strings
			'then just get the first String in that Array, as the sheet's name
			'expecting only one colon character in the name, just before sheet number
			sSheetName = sSheetName.Split(":").First()
		End If
		'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
		'combine full path with new file name and file extension, as value of new variable
		Dim sNewDrawingFFN As String = System.IO.Path.Combine(sNewPath, sSheetName & ".idw")
```

#### Code Block 6

```vb
Dim sSheetName As String = oSheet.Name
		If sSheetName.Contains(":") Then
			'Split Sheet name at colon character to create Array of Strings
			'then just get the first String in that Array, as the sheet's name
			'expecting only one colon character in the name, just before sheet number
			sSheetName = sSheetName.Split(":").First()
		End If
		'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
		'combine full path with new file name and file extension, as value of new variable
		Dim sNewDrawingFFN As String = System.IO.Path.Combine(sNewPath, sSheetName & ".idw")
```

#### Code Block 7

```vb
Dim sSheetName As String = oSheet.Name
		If sSheetName.Contains(":") Then
			'Split Sheet name at colon character to create Array of Strings
			'then just get the first String in that Array, as the sheet's name
			'expecting only one colon character in the name, just before sheet number
			sSheetName = sSheetName.Split(":").First()
		End If
		'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
		'combine full path with new file name and file extension, as value of new variable
		Dim sNewDrawingFFN As String = System.IO.Path.Combine(sNewPath, sSheetName & ".idw")
```

#### Code Block 8

```vb
Dim sSheetName As String = oSheet.Name
		If sSheetName.Contains(":") Then
			'Split Sheet name at colon character to create Array of Strings
			'then just get the first String in that Array, as the sheet's name
			'expecting only one colon character in the name, just before sheet number
			sSheetName = sSheetName.Split(":").First()
		End If
		'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
		'combine full path with new file name and file extension, as value of new variable
		Dim sNewDrawingFFN As String = System.IO.Path.Combine(sNewPath, sSheetName & ".idw")
```

#### Code Block 9

```vb
Sub Main
	'get the Inventor Application to a variable
	Dim oInvApp As Inventor.Application = ThisApplication
	'get the main Documents object of the application, for use later
	Dim oDocs As Inventor.Documents = oInvApp.Documents
	'get the 'active' Document, and try to 'Cast' it to the DrawingDocument Type
	'if this fails, then no value will be assigned to the variable
	'but no error will happen either
	Dim oDDoc As DrawingDocument = TryCast(oInvApp.ActiveDocument, Inventor.DrawingDocument)
	'check if the variable got assigned a value...if not, then exit rule
	If oDDoc Is Nothing Then Return
	'get the main Sheets collection of the 'active' drawing
	Dim oSheets As Inventor.Sheets = oDDoc.Sheets
	'if only 1 sheet, then exit rule, because noting to do
	If oSheets.Count = 1 Then Return
	'record currently 'active' Sheet, to reset to active at the end
	Dim oASheet As Inventor.Sheet = oDDoc.ActiveSheet
	'get the full path of the active drawing, without final directory separator character
	Dim sPath As String = System.IO.Path.GetDirectoryName(oDDoc.FullFileName)
	'specify name of sub folder to put new drawing documents into for each sheet
	Dim sSubFolder As String = "Sheets"
	'combine main Path with sub folder name, to make new path
	'adds the directory separator character in for us, automatically
	Dim sNewPath As String = System.IO.Path.Combine(sPath, sSubFolder)
	'create the sub directory, if it does not already exist
	If Not System.IO.Directory.Exists(sNewPath) Then
		System.IO.Directory.CreateDirectory(sNewPath)
	End If
	'not using 'For Each' on purpose, to maintain proper order 
	For iSheetIndex As Integer = 1 To oSheets.Count
		'get the Sheet at this index
		Dim oSheet As Inventor.Sheet = oSheets.Item(iSheetIndex)
		'make this sheet the active sheet
		oSheet.Activate()
		Dim sSheetName As String = oSheet.Name
		If sSheetName.Contains(":") Then
			'Split Sheet name at colon character to create Array of Strings
			'then just get the first String in that Array, as the sheet's name
			'expecting only one colon character in the name, just before sheet number
			sSheetName = sSheetName.Split(":").First()
		End If
		'inserting a single space between sheet name and its Index number, for clarity
		'sSheetName = sSheetName & " " & iSheetIndex.ToString()
		'combine full path with new file name and file extension, as value of new variable
		Dim sNewDrawingFFN As String = System.IO.Path.Combine(sNewPath, sSheetName & ".idw")
		'save copy of this drawing to new file, in background (new copy not open yet)
		oDDoc.SaveAs(sNewDrawingFFN , True)
		'open that new drawing file (invisibly), so we can modify it
		Dim oNewDDoc As DrawingDocument = oDocs.Open(sNewDrawingFFN, False)
		'get Sheets collection of new drawing to a variable
		Dim oNewDocSheets As Inventor.Sheets = oNewDDoc.Sheets
		'get the Sheet at same Index in new drawing (the one to keep)
		Dim oThisNewDocSheet As Inventor.Sheet = oNewDocSheets.Item(iSheetIndex)
		'delete all other sheets in new drawing besides this sheet
		For Each oNewDocSheet As Inventor.Sheet In oNewDocSheets
			If Not oNewDocSheet Is oThisNewDocSheet Then
				Try
					'Optional 'RetainDependentViews' is False by default
					oNewDocSheet.Delete() 
				Catch
					Logger.Error("Error deleting Sheet named:  " & oNewDocSheet.Name)
				End Try
			End If
		Next
		'save new drawing document again, after changes
		oNewDDoc.Save()
		'next line only valid when not visibly opened, and not being referenced
		oNewDDoc.ReleaseReference()
		'if visibly opened, then use oNewDDoc.Close() method instead
	Next 'oSheet
	'activate originally active sheet again
	oASheet.Activate()
	'only clear out all Documents that are 'unreferenced' in Inventor's memory
	'used after ReleaseReference, to clean-up
	oDocs.CloseAll(True)
End Sub
```

#### Code Block 10

```vb
Sub Main
	'get the Inventor Application to a variable
	Dim oInvApp As Inventor.Application = ThisApplication
	'get the main Documents object of the application, for use later
	Dim oDocs As Inventor.Documents = oInvApp.Documents
	'get the 'active' Document, and try to 'Cast' it to the DrawingDocument Type
	'if this fails, then no value will be assigned to the variable
	'but no error will happen either
	Dim oDDoc As DrawingDocument = TryCast(oInvApp.ActiveDocument, Inventor.DrawingDocument)
	'check if the variable got assigned a value...if not, then exit rule
	If oDDoc Is Nothing Then Return
	'get the main Sheets collection of the 'active' drawing
	Dim oSheets As Inventor.Sheets = oDDoc.Sheets
	'if only 1 sheet, then exit rule, because noting to do
	If oSheets.Count = 1 Then Return
	'record currently 'active' Sheet, to reset to active at the end
	Dim oASheet As Inventor.Sheet = oDDoc.ActiveSheet
	'get the full path of the active drawing, without final directory separator character
	Dim sPath As String = System.IO.Path.GetDirectoryName(oDDoc.FullFileName)
	'specify name of sub folder to put new drawing documents into for each sheet
	Dim sSubFolder As String = "Sheets"
	'combine main Path with sub folder name, to make new path
	'adds the directory separator character in for us, automatically
	Dim sNewPath As String = System.IO.Path.Combine(sPath, sSubFolder)
	'create the sub directory, if it does not already exist
	If Not System.IO.Directory.Exists(sNewPath) Then
		System.IO.Directory.CreateDirectory(sNewPath)
	End If
	'not using 'For Each' on purpose, to maintain proper order 
	For iSheetIndex As Integer = 1 To oSheets.Count
		'get the Sheet at this index
		Dim oSheet As Inventor.Sheet = oSheets.Item(iSheetIndex)
		'make this sheet the active sheet
		oSheet.Activate()
		Dim sSheetName As String = oSheet.Name
		If sSheetName.Contains(":") Then
			'Split Sheet name at colon character to create Array of Strings
			'then just get the first String in that Array, as the sheet's name
			'expecting only one colon character in the name, just before sheet number
			sSheetName = sSheetName.Split(":").First()
		End If
		'inserting a single space between sheet name and its Index number, for clarity
		'sSheetName = sSheetName & " " & iSheetIndex.ToString()
		'combine full path with new file name and file extension, as value of new variable
		Dim sNewDrawingFFN As String = System.IO.Path.Combine(sNewPath, sSheetName & ".idw")
		'save copy of this drawing to new file, in background (new copy not open yet)
		oDDoc.SaveAs(sNewDrawingFFN , True)
		'open that new drawing file (invisibly), so we can modify it
		Dim oNewDDoc As DrawingDocument = oDocs.Open(sNewDrawingFFN, False)
		'get Sheets collection of new drawing to a variable
		Dim oNewDocSheets As Inventor.Sheets = oNewDDoc.Sheets
		'get the Sheet at same Index in new drawing (the one to keep)
		Dim oThisNewDocSheet As Inventor.Sheet = oNewDocSheets.Item(iSheetIndex)
		'delete all other sheets in new drawing besides this sheet
		For Each oNewDocSheet As Inventor.Sheet In oNewDocSheets
			If Not oNewDocSheet Is oThisNewDocSheet Then
				Try
					'Optional 'RetainDependentViews' is False by default
					oNewDocSheet.Delete() 
				Catch
					Logger.Error("Error deleting Sheet named:  " & oNewDocSheet.Name)
				End Try
			End If
		Next
		'save new drawing document again, after changes
		oNewDDoc.Save()
		'next line only valid when not visibly opened, and not being referenced
		oNewDDoc.ReleaseReference()
		'if visibly opened, then use oNewDDoc.Close() method instead
	Next 'oSheet
	'activate originally active sheet again
	oASheet.Activate()
	'only clear out all Documents that are 'unreferenced' in Inventor's memory
	'used after ReleaseReference, to clean-up
	oDocs.CloseAll(True)
End Sub
```

#### Code Block 11

```vb
Sub Main
	'get the Inventor Application to a variable
	Dim oInvApp As Inventor.Application = ThisApplication
	'get the main Documents object of the application, for use later
	Dim oDocs As Inventor.Documents = oInvApp.Documents
	'get the 'active' Document, and try to 'Cast' it to the DrawingDocument Type
	'if this fails, then no value will be assigned to the variable
	'but no error will happen either
	Dim oDDoc As DrawingDocument = TryCast(oInvApp.ActiveDocument, Inventor.DrawingDocument)
	'check if the variable got assigned a value...if not, then exit rule
	If oDDoc Is Nothing Then Return
	'get the main Sheets collection of the 'active' drawing
	Dim oSheets As Inventor.Sheets = oDDoc.Sheets
	'if only 1 sheet, then exit rule, because noting to do
	If oSheets.Count = 1 Then Return
	'record currently 'active' Sheet, to reset to active at the end
	Dim oASheet As Inventor.Sheet = oDDoc.ActiveSheet
	'get the full path of the active drawing, without final directory separator character
	Dim sPath As String = System.IO.Path.GetDirectoryName(oDDoc.FullFileName)
	'specify name of sub folder to put new drawing documents into for each sheet
	Dim sSubFolder As String = "Sheets"
	'combine main Path with sub folder name, to make new path
	'adds the directory separator character in for us, automatically
	Dim sNewPath As String = System.IO.Path.Combine(sPath, sSubFolder)
	'create the sub directory, if it does not already exist
	If Not System.IO.Directory.Exists(sNewPath) Then
		System.IO.Directory.CreateDirectory(sNewPath)
	End If
	'not using 'For Each' on purpose, to maintain proper order 
	For iSheetIndex As Integer = 1 To oSheets.Count
		'get the Sheet at this index
		Dim oSheet As Inventor.Sheet = oSheets.Item(iSheetIndex)
		'make this sheet the active sheet
		oSheet.Activate()
		Dim sSheetName As String = oSheet.Name
		If sSheetName.Contains(":") Then
			'Split Sheet name at colon character to create Array of Strings
			'then just get the first String in that Array, as the sheet's name
			'expecting only one colon character in the name, just before sheet number
			sSheetName = sSheetName.Split(":").First()
		End If
		'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
		'combine full path with new file name and file extension, as value of new variable
		Dim sNewDrawingFFN As String = System.IO.Path.Combine(sNewPath, sSheetName & ".idw")
		'save copy of this drawing to new file, in background (new copy not open yet)
		oDDoc.SaveAs(sNewDrawingFFN, True)
		'open that new drawing file (invisibly), so we can modify it
		Dim oNewDDoc As DrawingDocument = oDocs.Open(sNewDrawingFFN, False)
		'get Sheets collection of new drawing to a variable
		Dim oNewDocSheets As Inventor.Sheets = oNewDDoc.Sheets
		'get the Sheet at same Index in new drawing (the one to keep)
		Dim oThisNewDocSheet As Inventor.Sheet = oNewDocSheets.Item(iSheetIndex)
		'delete all other sheets in new drawing besides this sheet
		For Each oNewDocSheet As Inventor.Sheet In oNewDocSheets
			If Not oNewDocSheet Is oThisNewDocSheet Then
				Try
					'Optional 'RetainDependentViews' is False by default
					oNewDocSheet.Delete() 
				Catch
					Logger.Error("Error deleting Sheet named:  " & oNewDocSheet.Name)
				End Try
			End If
		Next
		'save new drawing document again, after changes
		oNewDDoc.Save()
		'next line only valid when not visibly opened, and not being referenced
		oNewDDoc.ReleaseReference()
		'if visibly opened, then use oNewDDoc.Close() method instead
	Next 'oSheet
	'activate originally active sheet again
	oASheet.Activate()
	'only clear out all Documents that are 'unreferenced' in Inventor's memory
	'used after ReleaseReference, to clean-up
	oDocs.CloseAll(True)
End Sub
```

#### Code Block 12

```vb
Sub Main
	'get the Inventor Application to a variable
	Dim oInvApp As Inventor.Application = ThisApplication
	'get the main Documents object of the application, for use later
	Dim oDocs As Inventor.Documents = oInvApp.Documents
	'get the 'active' Document, and try to 'Cast' it to the DrawingDocument Type
	'if this fails, then no value will be assigned to the variable
	'but no error will happen either
	Dim oDDoc As DrawingDocument = TryCast(oInvApp.ActiveDocument, Inventor.DrawingDocument)
	'check if the variable got assigned a value...if not, then exit rule
	If oDDoc Is Nothing Then Return
	'get the main Sheets collection of the 'active' drawing
	Dim oSheets As Inventor.Sheets = oDDoc.Sheets
	'if only 1 sheet, then exit rule, because noting to do
	If oSheets.Count = 1 Then Return
	'record currently 'active' Sheet, to reset to active at the end
	Dim oASheet As Inventor.Sheet = oDDoc.ActiveSheet
	'get the full path of the active drawing, without final directory separator character
	Dim sPath As String = System.IO.Path.GetDirectoryName(oDDoc.FullFileName)
	'specify name of sub folder to put new drawing documents into for each sheet
	Dim sSubFolder As String = "Sheets"
	'combine main Path with sub folder name, to make new path
	'adds the directory separator character in for us, automatically
	Dim sNewPath As String = System.IO.Path.Combine(sPath, sSubFolder)
	'create the sub directory, if it does not already exist
	If Not System.IO.Directory.Exists(sNewPath) Then
		System.IO.Directory.CreateDirectory(sNewPath)
	End If
	'not using 'For Each' on purpose, to maintain proper order 
	For iSheetIndex As Integer = 1 To oSheets.Count
		'get the Sheet at this index
		Dim oSheet As Inventor.Sheet = oSheets.Item(iSheetIndex)
		'make this sheet the active sheet
		oSheet.Activate()
		Dim sSheetName As String = oSheet.Name
		If sSheetName.Contains(":") Then
			'Split Sheet name at colon character to create Array of Strings
			'then just get the first String in that Array, as the sheet's name
			'expecting only one colon character in the name, just before sheet number
			sSheetName = sSheetName.Split(":").First()
		End If
		'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
		'combine full path with new file name and file extension, as value of new variable
		Dim sNewDrawingFFN As String = System.IO.Path.Combine(sNewPath, sSheetName & ".idw")
		'save copy of this drawing to new file, in background (new copy not open yet)
		oDDoc.SaveAs(sNewDrawingFFN, True)
		'open that new drawing file (invisibly), so we can modify it
		Dim oNewDDoc As DrawingDocument = oDocs.Open(sNewDrawingFFN, False)
		'get Sheets collection of new drawing to a variable
		Dim oNewDocSheets As Inventor.Sheets = oNewDDoc.Sheets
		'get the Sheet at same Index in new drawing (the one to keep)
		Dim oThisNewDocSheet As Inventor.Sheet = oNewDocSheets.Item(iSheetIndex)
		'delete all other sheets in new drawing besides this sheet
		For Each oNewDocSheet As Inventor.Sheet In oNewDocSheets
			If Not oNewDocSheet Is oThisNewDocSheet Then
				Try
					'Optional 'RetainDependentViews' is False by default
					oNewDocSheet.Delete() 
				Catch
					Logger.Error("Error deleting Sheet named:  " & oNewDocSheet.Name)
				End Try
			End If
		Next
		'save new drawing document again, after changes
		oNewDDoc.Save()
		'next line only valid when not visibly opened, and not being referenced
		oNewDDoc.ReleaseReference()
		'if visibly opened, then use oNewDDoc.Close() method instead
	Next 'oSheet
	'activate originally active sheet again
	oASheet.Activate()
	'only clear out all Documents that are 'unreferenced' in Inventor's memory
	'used after ReleaseReference, to clean-up
	oDocs.CloseAll(True)
End Sub
```

#### Code Block 13

```vb
Sub Main
	'get the Inventor Application to a variable
	Dim oInvApp As Inventor.Application = ThisApplication
	'get the main Documents object of the application, for use later
	Dim oDocs As Inventor.Documents = oInvApp.Documents
	'get the 'active' Document, and try to 'Cast' it to the DrawingDocument Type
	'if this fails, then no value will be assigned to the variable
	'but no error will happen either
	Dim oDDoc As DrawingDocument = TryCast(oInvApp.ActiveDocument, Inventor.DrawingDocument)
	'check if the variable got assigned a value...if not, then exit rule
	If oDDoc Is Nothing Then Return
	'get the main Sheets collection of the 'active' drawing
	Dim oSheets As Inventor.Sheets = oDDoc.Sheets
	'if only 1 sheet, then exit rule, because noting to do
	If oSheets.Count = 1 Then Return
	'record currently 'active' Sheet, to reset to active at the end
	Dim oASheet As Inventor.Sheet = oDDoc.ActiveSheet
	'get the full path of the active drawing, without final directory separator character
	Dim sPath As String = System.IO.Path.GetDirectoryName(oDDoc.FullFileName)
	'specify name of sub folder to put new drawing documents into for each sheet
	Dim sSubFolder As String = "Sheets"
	'combine main Path with sub folder name, to make new path
	'adds the directory separator character in for us, automatically
	Dim sNewPath As String = System.IO.Path.Combine(sPath, sSubFolder)
	'create the sub directory, if it does not already exist
	If Not System.IO.Directory.Exists(sNewPath) Then
		System.IO.Directory.CreateDirectory(sNewPath)
	End If
	'not using 'For Each' on purpose, to maintain proper order 
	For iSheetIndex As Integer = 1 To oSheets.Count
		'get the Sheet at this index
		Dim oSheet As Inventor.Sheet = oSheets.Item(iSheetIndex)
		'make this sheet the active sheet
		oSheet.Activate()
		Dim sSheetName As String = oSheet.Name
		If sSheetName.Contains(":") Then
			'Split Sheet name at colon character to create Array of Strings
			'then just get the first String in that Array, as the sheet's name
			'expecting only one colon character in the name, just before sheet number
			sSheetName = sSheetName.Split(":").First()
		End If
		'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
		'combine full path with new file name and file extension, as value of new variable
		Dim sNewDrawingFFN As String = System.IO.Path.Combine(sNewPath, sSheetName & ".idw")
		'save copy of this drawing to new file, in background (new copy not open yet)
		oDDoc.SaveAs(sNewDrawingFFN, True)
		'open that new drawing file (invisibly), so we can modify it
		Dim oNewDDoc As DrawingDocument = oDocs.Open(sNewDrawingFFN, False)
		'get Sheets collection of new drawing to a variable
		Dim oNewDocSheets As Inventor.Sheets = oNewDDoc.Sheets
		'get the Sheet at same Index in new drawing (the one to keep)
		Dim oThisNewDocSheet As Inventor.Sheet = oNewDocSheets.Item(iSheetIndex)
		'delete all other sheets in new drawing besides this sheet
		For Each oNewDocSheet As Inventor.Sheet In oNewDocSheets
			If Not oNewDocSheet Is oThisNewDocSheet Then
				Try
					'Optional 'RetainDependentViews' is False by default
					oNewDocSheet.Delete() 
				Catch
					Logger.Error("Error deleting Sheet named:  " & oNewDocSheet.Name)
				End Try
			End If
		Next
		'save new drawing document again, after changes
		oNewDDoc.Save()
		'next line only valid when not visibly opened, and not being referenced
		oNewDDoc.ReleaseReference()
		'if visibly opened, then use oNewDDoc.Close() method instead
	Next 'oSheet
	'activate originally active sheet again
	oASheet.Activate()
	'only clear out all Documents that are 'unreferenced' in Inventor's memory
	'used after ReleaseReference, to clean-up
	oDocs.CloseAll(True)
End Sub
```

#### Code Block 14

```vb
Sub Main
	'get the Inventor Application to a variable
	Dim oInvApp As Inventor.Application = ThisApplication
	'get the main Documents object of the application, for use later
	Dim oDocs As Inventor.Documents = oInvApp.Documents
	'get the 'active' Document, and try to 'Cast' it to the DrawingDocument Type
	'if this fails, then no value will be assigned to the variable
	'but no error will happen either
	Dim oDDoc As DrawingDocument = TryCast(oInvApp.ActiveDocument, Inventor.DrawingDocument)
	'check if the variable got assigned a value...if not, then exit rule
	If oDDoc Is Nothing Then Return
	'get the main Sheets collection of the 'active' drawing
	Dim oSheets As Inventor.Sheets = oDDoc.Sheets
	'if only 1 sheet, then exit rule, because noting to do
	If oSheets.Count = 1 Then Return
	'record currently 'active' Sheet, to reset to active at the end
	Dim oASheet As Inventor.Sheet = oDDoc.ActiveSheet
	'get the full path of the active drawing, without final directory separator character
	Dim sPath As String = System.IO.Path.GetDirectoryName(oDDoc.FullFileName)
	'specify name of sub folder to put new drawing documents into for each sheet
	Dim sSubFolder As String = "Sheets"
	'combine main Path with sub folder name, to make new path
	'adds the directory separator character in for us, automatically
	Dim sNewPath As String = System.IO.Path.Combine(sPath, sSubFolder)
	'create the sub directory, if it does not already exist
	If Not System.IO.Directory.Exists(sNewPath) Then
		System.IO.Directory.CreateDirectory(sNewPath)
	End If
	'not using 'For Each' on purpose, to maintain proper order 
	For iSheetIndex As Integer = 1 To oSheets.Count
		'get the Sheet at this index
		Dim oSheet As Inventor.Sheet = oSheets.Item(iSheetIndex)
		'make this sheet the active sheet
		oSheet.Activate()
		Dim sSheetName As String = oSheet.Name
		If sSheetName.Contains(":") Then
			'Split Sheet name at colon character to create Array of Strings
			'then just get the first String in that Array, as the sheet's name
			'expecting only one colon character in the name, just before sheet number
			sSheetName = sSheetName.Split(":").First()
		End If
		'inserting a single space between sheet name and its Index number, for clarity
		sSheetName = sSheetName & " " & iSheetIndex.ToString()
		'combine full path with new file name and file extension, as value of new variable
		Dim sNewDrawingFFN As String = System.IO.Path.Combine(sNewPath, sSheetName & ".idw")
		'save copy of this drawing to new file, in background (new copy not open yet)
		oDDoc.SaveAs(sNewDrawingFFN, True)
		'open that new drawing file (invisibly), so we can modify it
		Dim oNewDDoc As DrawingDocument = oDocs.Open(sNewDrawingFFN, False)
		'get Sheets collection of new drawing to a variable
		Dim oNewDocSheets As Inventor.Sheets = oNewDDoc.Sheets
		'get the Sheet at same Index in new drawing (the one to keep)
		Dim oThisNewDocSheet As Inventor.Sheet = oNewDocSheets.Item(iSheetIndex)
		'delete all other sheets in new drawing besides this sheet
		For Each oNewDocSheet As Inventor.Sheet In oNewDocSheets
			If Not oNewDocSheet Is oThisNewDocSheet Then
				Try
					'Optional 'RetainDependentViews' is False by default
					oNewDocSheet.Delete() 
				Catch
					Logger.Error("Error deleting Sheet named:  " & oNewDocSheet.Name)
				End Try
			End If
		Next
		'save new drawing document again, after changes
		oNewDDoc.Save()
		'next line only valid when not visibly opened, and not being referenced
		oNewDDoc.ReleaseReference()
		'if visibly opened, then use oNewDDoc.Close() method instead
	Next 'oSheet
	'activate originally active sheet again
	oASheet.Activate()
	'only clear out all Documents that are 'unreferenced' in Inventor's memory
	'used after ReleaseReference, to clean-up
	oDocs.CloseAll(True)
End Sub
```

#### Code Block 15

```vb
iSheetIndex.ToString()
```

#### Code Block 16

```vb
iSheetIndex.ToString()
```

---

### 44. iLogic Drawing Layer Visibility Toggle

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-drawing-layer-visibility-toggle/td-p/13816579#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-drawing-layer-visibility-toggle/td-p/13816579#messageview_0)

**Author:** dave_novak

**Date:** ‎09-18-2025
	
		
		10:09 AM

**Description:** Hello, I would like to figure out (with a little help from my friends) how to get Drawings to show the correct Visibility State in the Layer Drop Down after running the following iLogic Rule: If ThisDrawing.Document.StylesManager.Layers("Visible Narrow (ANSI)").Visible = False Then 	ThisDrawing.Docu...

**Code Snippets (1):**

#### Code Block 1

```vb
If ThisDrawing.Document.StylesManager.Layers("Visible Narrow (ANSI)").Visible = False Then
	ThisDrawing.Document.StylesManager.Layers("Visible Narrow (ANSI)").Visible = True
	ElseIf ThisDrawing.Document.StylesManager.Layers("Visible Narrow (ANSI)").Visible = True Then
	ThisDrawing.Document.StylesManager.Layers("Visible Narrow (ANSI)").Visible = False
	
End If

iLogicVb.UpdateWhenDone = True
```

#### Code Block 2

```vb
If ThisDrawing.Document.StylesManager.Layers("Visible Narrow (ANSI)").Visible = False Then
	ThisDrawing.Document.StylesManager.Layers("Visible Narrow (ANSI)").Visible = True
	ElseIf ThisDrawing.Document.StylesManager.Layers("Visible Narrow (ANSI)").Visible = True Then
	ThisDrawing.Document.StylesManager.Layers("Visible Narrow (ANSI)").Visible = False
	
End If

iLogicVb.UpdateWhenDone = True
```

---

### 45. problem with rules on remote pc

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/problem-with-rules-on-remote-pc/td-p/13810727#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/problem-with-rules-on-remote-pc/td-p/13810727#messageview_0)

**Author:** Frank_DoucetLYPFL

**Date:** ‎09-15-2025
	
		
		02:08 AM

**Description:** i made a rules in inventor for copying and renaming all files from one folder to another, at home it worked like it schould, at work we use remote pc and there i did not work, getting errorLine29 : 'directory' is not declared, it may be inaccessible due to its protection levelLine30 : 'directory' is...

**Code Snippets (2):**

#### Code Block 1

```vb
Imports System.IO

Sub Main()
' Define source folder
Dim sourceFolder As String = "C:\Users\Frank\Documents\Inventor\ilogic Afsluiter"

' Ask user to choose destination folder
Dim fbd As New FolderBrowserDialog()
fbd.Description = "Select the destination folder"
fbd.ShowNewFolderButton = True

Dim result As DialogResult = fbd.ShowDialog()
If result <> DialogResult.OK Then
MessageBox.Show("Operation cancelled.", "iLogic")
Exit Sub
End If

Dim destFolder As String = fbd.SelectedPath

' Ask user for prefix (e.g. M593)
Dim prefix As String = InputBox("Enter the prefix (example: M593)", "File Prefix", "M593")
If prefix = "" Then
MessageBox.Show("No prefix entered. Operation cancelled.", "iLogic")
Exit Sub
End If

' Create destination folder if it doesn’t exist
If Not Directory.Exists(destFolder) Then
Directory.CreateDirectory(destFolder)
End If

' Get all files in source folder
Dim files() As String = Directory.GetFiles(sourceFolder)

' Counter for renaming
Dim counter As Integer = 0

For Each filePath As String In files
Dim ext As String = Path.GetExtension(filePath)
Dim newName As String = prefix & "-" & counter.ToString("000") & "-00" & ext
Dim destPath As String = Path.Combine(destFolder, newName)

' Copy file (overwrite if already exists)
File.Copy(filePath, destPath, True)

counter += 1
Next

MessageBox.Show("Files copied and renamed successfully to:" & vbCrLf & destFolder, "iLogic")
End Sub
```

#### Code Block 2

```vb
Imports System.IO

Sub Main()
' Define source folder
Dim sourceFolder As String = "C:\Users\Frank\Documents\Inventor\ilogic Afsluiter"

' Ask user to choose destination folder
Dim fbd As New FolderBrowserDialog()
fbd.Description = "Select the destination folder"
fbd.ShowNewFolderButton = True

Dim result As DialogResult = fbd.ShowDialog()
If result <> DialogResult.OK Then
MessageBox.Show("Operation cancelled.", "iLogic")
Exit Sub
End If

Dim destFolder As String = fbd.SelectedPath

' Ask user for prefix (e.g. M593)
Dim prefix As String = InputBox("Enter the prefix (example: M593)", "File Prefix", "M593")
If prefix = "" Then
MessageBox.Show("No prefix entered. Operation cancelled.", "iLogic")
Exit Sub
End If

' Create destination folder if it doesn’t exist
If Not Directory.Exists(destFolder) Then
Directory.CreateDirectory(destFolder)
End If

' Get all files in source folder
Dim files() As String = Directory.GetFiles(sourceFolder)

' Counter for renaming
Dim counter As Integer = 0

For Each filePath As String In files
Dim ext As String = Path.GetExtension(filePath)
Dim newName As String = prefix & "-" & counter.ToString("000") & "-00" & ext
Dim destPath As String = Path.Combine(destFolder, newName)

' Copy file (overwrite if already exists)
File.Copy(filePath, destPath, True)

counter += 1
Next

MessageBox.Show("Files copied and renamed successfully to:" & vbCrLf & destFolder, "iLogic")
End Sub
```

#### Code Block 3

```vb
Imports System.IO

Sub Main()
' Define source folder
Dim sourceFolder As String = "C:\Users\Frank\Documents\Inventor\ilogic Afsluiter"

' Ask user to choose destination folder
Dim fbd As New FolderBrowserDialog()
fbd.Description = "Select the destination folder"
fbd.ShowNewFolderButton = True

Dim result As DialogResult = fbd.ShowDialog()
If result <> DialogResult.OK Then
MessageBox.Show("Operation cancelled.", "iLogic")
Exit Sub
End If

Dim destFolder As String = fbd.SelectedPath

' Ask user for prefix (e.g. M593)
Dim prefix As String = InputBox("Enter the prefix (example: M593)", "File Prefix", "M593")
If prefix = "" Then
MessageBox.Show("No prefix entered. Operation cancelled.", "iLogic")
Exit Sub
End If

' Create destination folder if it doesn’t exist
If Not Directory.Exists(destFolder) Then
Directory.CreateDirectory(destFolder)
End If

' Get all files in source folder
Dim files() As String = Directory.GetFiles(sourceFolder)

' Counter for renaming
Dim counter As Integer = 0

For Each filePath As String In files
Dim ext As String = Path.GetExtension(filePath)
Dim newName As String = prefix & "-" & counter.ToString("000") & "-00" & ext
Dim destPath As String = Path.Combine(destFolder, newName)

' Copy file (overwrite if already exists)
File.Copy(filePath, destPath, True)

counter += 1
Next

MessageBox.Show("Files copied and renamed successfully to:" & vbCrLf & destFolder, "iLogic")
End Sub
```

#### Code Block 4

```vb
Imports System.IO

Sub Main()
' Define source folder
Dim sourceFolder As String = "C:\Users\Frank\Documents\Inventor\ilogic Afsluiter"

' Ask user to choose destination folder
Dim fbd As New FolderBrowserDialog()
fbd.Description = "Select the destination folder"
fbd.ShowNewFolderButton = True

Dim result As DialogResult = fbd.ShowDialog()
If result <> DialogResult.OK Then
MessageBox.Show("Operation cancelled.", "iLogic")
Exit Sub
End If

Dim destFolder As String = fbd.SelectedPath

' Ask user for prefix (e.g. M593)
Dim prefix As String = InputBox("Enter the prefix (example: M593)", "File Prefix", "M593")
If prefix = "" Then
MessageBox.Show("No prefix entered. Operation cancelled.", "iLogic")
Exit Sub
End If

' Create destination folder if it doesn’t exist
If Not Directory.Exists(destFolder) Then
Directory.CreateDirectory(destFolder)
End If

' Get all files in source folder
Dim files() As String = Directory.GetFiles(sourceFolder)

' Counter for renaming
Dim counter As Integer = 0

For Each filePath As String In files
Dim ext As String = Path.GetExtension(filePath)
Dim newName As String = prefix & "-" & counter.ToString("000") & "-00" & ext
Dim destPath As String = Path.Combine(destFolder, newName)

' Copy file (overwrite if already exists)
File.Copy(filePath, destPath, True)

counter += 1
Next

MessageBox.Show("Files copied and renamed successfully to:" & vbCrLf & destFolder, "iLogic")
End Sub
```

#### Code Block 5

```vb
Imports System.IO

Sub Main()
' Define source folder
Dim sourceFolder As String = "C:\Users\Frank\Documents\Inventor\ilogic Afsluiter"

' Ask user to choose destination folder
Dim fbd As New FolderBrowserDialog()
fbd.Description = "Select the destination folder"
fbd.ShowNewFolderButton = True

Dim result As DialogResult = fbd.ShowDialog()
If result <> DialogResult.OK Then
MessageBox.Show("Operation cancelled.", "iLogic")
Exit Sub
End If

Dim destFolder As String = fbd.SelectedPath

' Ask user for prefix (e.g. M593)
Dim prefix As String = InputBox("Enter the prefix (example: M593)", "File Prefix", "M593")
If prefix = "" Then
MessageBox.Show("No prefix entered. Operation cancelled.", "iLogic")
Exit Sub
End If

' Create destination folder if it doesn’t exist
If Not Directory.Exists(destFolder) Then
Directory.CreateDirectory(destFolder)
End If

' Get all files in source folder
Dim files() As String = Directory.GetFiles(sourceFolder)

' Counter for renaming
Dim counter As Integer = 0

For Each filePath As String In files
Dim ext As String = Path.GetExtension(filePath)
Dim newName As String = prefix & "-" & counter.ToString("000") & "-00" & ext
Dim destPath As String = Path.Combine(destFolder, newName)

' Copy file (overwrite if already exists)
File.Copy(filePath, destPath, True)

counter += 1
Next

MessageBox.Show("Files copied and renamed successfully to:" & vbCrLf & destFolder, "iLogic")
End Sub
```

#### Code Block 6

```vb
Imports System.IO

Sub Main()
' Define source folder
Dim sourceFolder As String = "C:\Users\Frank\Documents\Inventor\ilogic Afsluiter"

' Ask user to choose destination folder
Dim fbd As New FolderBrowserDialog()
fbd.Description = "Select the destination folder"
fbd.ShowNewFolderButton = True

Dim result As DialogResult = fbd.ShowDialog()
If result <> DialogResult.OK Then
MessageBox.Show("Operation cancelled.", "iLogic")
Exit Sub
End If

Dim destFolder As String = fbd.SelectedPath

' Ask user for prefix (e.g. M593)
Dim prefix As String = InputBox("Enter the prefix (example: M593)", "File Prefix", "M593")
If prefix = "" Then
MessageBox.Show("No prefix entered. Operation cancelled.", "iLogic")
Exit Sub
End If

' Create destination folder if it doesn’t exist
If Not Directory.Exists(destFolder) Then
Directory.CreateDirectory(destFolder)
End If

' Get all files in source folder
Dim files() As String = Directory.GetFiles(sourceFolder)

' Counter for renaming
Dim counter As Integer = 0

For Each filePath As String In files
Dim ext As String = Path.GetExtension(filePath)
Dim newName As String = prefix & "-" & counter.ToString("000") & "-00" & ext
Dim destPath As String = Path.Combine(destFolder, newName)

' Copy file (overwrite if already exists)
File.Copy(filePath, destPath, True)

counter += 1
Next

MessageBox.Show("Files copied and renamed successfully to:" & vbCrLf & destFolder, "iLogic")
End Sub
```

---

## Basic Examples

Total: 3 posts

### 1. 3D-Pdf export to same location as 3D-file

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/3d-pdf-export-to-same-location-as-3d-file/td-p/13757662](https://forums.autodesk.com/t5/inventor-programming-forum/3d-pdf-export-to-same-location-as-3d-file/td-p/13757662)

**Author:** Kupiszewski_A_

**Date:** ‎08-07-2025
	
		
		02:17 AM

**Description:** Hello everyone, I'm trying to write an ilogic rule that creates a 3D PDF and saves it in the same folder (or subfolder) as the original 3D part. I've tried many things, but it just doesn't work.  Can someone please help me? Thank you very much! 					 				 			 			 				 			 			 				 	 			 				 					 	...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim ExportFileName = ThisDoc.ChangeExtension(".pdf")
```

#### Code Block 2

```vb
Dim ExportFileName = ThisDoc.ChangeExtension(".pdf")
```

#### Code Block 3

```vb
Dim ExportFileName = oFolder & ThisDoc.FileName & ".pdf"
```

#### Code Block 4

```vb
Dim ExportFileName = oFolder & ThisDoc.FileName & ".pdf"
```

---

### 2. Greater than Less Than

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/greater-than-less-than/td-p/13754306#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/greater-than-less-than/td-p/13754306#messageview_0)

**Author:** layochim

**Date:** ‎08-05-2025
	
		
		04:34 AM

**Description:** Hello, I'm trying to create a statement for my conveyor heights.I have two heights Infeed_End and Discharge_End. I'm trying to write "If Discharge_End > 115 And Infeed_End < 25 Then Discharge_End = 114 And Infeed_End = 26" I'm having no luck on this.  Can anyone help me on this? 					 				 			 			 	...

**Code Snippets (2):**

#### Code Block 1

```vb
If ((Discharge_End > 115) And (Infeed_End < 25) ) Or (Belt_Length = 200) Then 
	Discharge_End = 114 
	Infeed_End  = 26
End If
```

#### Code Block 2

```vb
If ((Discharge_End > 115) And (Infeed_End < 25) ) Or (Belt_Length = 200) Then 
	Discharge_End = 114 
	Infeed_End  = 26
End If
```

#### Code Block 3

```vb
If (Discharge_End > 115) And (Infeed_End < 25) Then 
	Discharge_End = 114 
	Infeed_End  = 26
End If
```

#### Code Block 4

```vb
If (Discharge_End > 115) And (Infeed_End < 25) Then 
	Discharge_End = 114 
	Infeed_End  = 26
End If
```

---

### 3. View &quot;Dim&quot; Variable Values

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/view-quot-dim-quot-variable-values/td-p/13332453](https://forums.autodesk.com/t5/inventor-programming-forum/view-quot-dim-quot-variable-values/td-p/13332453)

**Author:** Joseph.Lasser

**Date:** ‎02-21-2025
	
		
		07:40 AM

**Description:** This is likely a poor question, but is there a a way to view a list of all declared variables in a rule and their associated values?  For example, please reference the script below:Dim Test1 = 1 Dim Test2 = 2 Dim Test3 = 3 Dim Sum = Test1+Test2+Test3Within the rule editor, would there be a way to se...

**Code Snippets (3):**

#### Code Block 1

```vb
Dim Test1 = 1
Dim Test2 = 2
Dim Test3 = 3
Dim Sum = Test1+Test2+Test3
```

#### Code Block 2

```vb
Dim Test1 = 1
Dim Test2 = 2
Dim Test3 = 3
Dim Sum = Test1+Test2+Test3
```

#### Code Block 3

```vb
Dim Val1 As Double = 1.5
Dim Val2 As Double = 3
Dim Val3 As Double = 5.5
Dim values As New List(Of Double) From {Val1, Val2, Val3 }
Dim sum As Double = values.Sum
Logger.Info("Sum = " & sum.ToString())
```

#### Code Block 4

```vb
Dim Val1 As Double = 1.5
Dim Val2 As Double = 3
Dim Val3 As Double = 5.5
Dim values As New List(Of Double) From {Val1, Val2, Val3 }
Dim sum As Double = values.Sum
Logger.Info("Sum = " & sum.ToString())
```

#### Code Block 5

```vb
Dim Val1 As Double = 1.5
Dim Val2 As Double = 3
Dim Val3 As Double = 5.5
Dim values As New List(Of Double) From {Val1, Val2, Val3 }
Dim sum As Double = values.Sum
Logger.Info("Sum = " & sum.ToString())
```

#### Code Block 6

```vb
Dim Val1 As Double = 1.5
Dim Val2 As Double = 3
Dim Val3 As Double = 5.5
Dim values As New List(Of Double) From {Val1, Val2, Val3 }
Dim sum As Double = values.Sum
Logger.Info("Sum = " & sum.ToString())
```

---

## Troubleshooting Examples

Total: 5 posts

### 1. Creating a dimension from edge of circle with a face

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/creating-a-dimension-from-edge-of-circle-with-a-face/td-p/11569540](https://forums.autodesk.com/t5/inventor-programming-forum/creating-a-dimension-from-edge-of-circle-with-a-face/td-p/11569540)

**Author:** phucminhnguyen.76

**Date:** ‎11-22-2022
	
		
		01:42 AM

**Description:** Hi everyone, I started to use iLogic and create Rules in my projects recently.I would like to create a dimension like my attached image. Does someone has the iLogic experience to help me?Thanks!

**Code Snippets (2):**

#### Code Block 1

```vb
' Get sheet and view
Dim Sheet_1 = ThisDrawing.Sheets.ItemByName("Sheet:1")
Dim VIEW1 = Sheet_1.DrawingViews.ItemByName("VIEW1")

' Get named entities
Dim VFB_Face_Left = VIEW1.GetIntent("Vert_Flat_Bar_01", "Face_Left", PointIntentEnum.kEndPointIntent)
Dim VFB_Face_Bottom = VIEW1.GetIntent("Vert_Flat_Bar_01", "Face_Bottom", PointIntentEnum.kEndPointIntent)
Dim VRB_Face_Cylinder_Right = VIEW1.GetIntent("Vert_Rnd_Bar", "Face_Cylinder", PointIntentEnum.kCircularRightPointIntent)
Dim VRB_Face_Cylinder_Top = VIEW1.GetIntent("Vert_Rnd_Bar", "Face_Cylinder", PointIntentEnum.kCircularTopPointIntent)

' Declare access to drawing dimensions
Dim genDims = Sheet_1.DrawingDimensions.GeneralDimensions

' Add the dimensions
Try
	genDims.AddLinear("Dim01", VIEW1.SheetPoint(0.5, -0.1875), VFB_Face_Left, VRB_Face_Cylinder_Right, DimensionTypeEnum.kHorizontalDimensionType)
	genDims.AddLinear("Dim02", VIEW1.SheetPoint(-0.03125, 0), VFB_Face_Bottom, VRB_Face_Cylinder_Top, DimensionTypeEnum.kVerticalDimensionType)
Catch ex As Exception
	MsgBox("Error: ", ex.Message )
End Try
```

#### Code Block 2

```vb
' Get sheet and view
Dim Sheet_1 = ThisDrawing.Sheets.ItemByName("Sheet:1")
Dim VIEW1 = Sheet_1.DrawingViews.ItemByName("VIEW1")

' Get named entities
Dim VFB_Face_Left = VIEW1.GetIntent("Vert_Flat_Bar_01", "Face_Left", PointIntentEnum.kEndPointIntent)
Dim VFB_Face_Bottom = VIEW1.GetIntent("Vert_Flat_Bar_01", "Face_Bottom", PointIntentEnum.kEndPointIntent)
Dim VRB_Face_Cylinder_Right = VIEW1.GetIntent("Vert_Rnd_Bar", "Face_Cylinder", PointIntentEnum.kCircularRightPointIntent)
Dim VRB_Face_Cylinder_Top = VIEW1.GetIntent("Vert_Rnd_Bar", "Face_Cylinder", PointIntentEnum.kCircularTopPointIntent)

' Declare access to drawing dimensions
Dim genDims = Sheet_1.DrawingDimensions.GeneralDimensions

' Add the dimensions
Try
	genDims.AddLinear("Dim01", VIEW1.SheetPoint(0.5, -0.1875), VFB_Face_Left, VRB_Face_Cylinder_Right, DimensionTypeEnum.kHorizontalDimensionType)
	genDims.AddLinear("Dim02", VIEW1.SheetPoint(-0.03125, 0), VFB_Face_Bottom, VRB_Face_Cylinder_Top, DimensionTypeEnum.kVerticalDimensionType)
Catch ex As Exception
	MsgBox("Error: ", ex.Message )
End Try
```

#### Code Block 3

```vb
' Get sheet and view
Dim Sheet_1 = ThisDrawing.Sheets.ItemByName("Sheet:1")
Dim VIEW1 = Sheet_1.DrawingViews.ItemByName("VIEW1")

' Get named entities
Dim VFB_Face_Left = VIEW1.GetIntent("Vert_Flat_Bar_01", "Face_Left", PointIntentEnum.kEndPointIntent)
Dim VFB_Face_Bottom = VIEW1.GetIntent("Vert_Flat_Bar_01", "Face_Bottom", PointIntentEnum.kEndPointIntent)
Dim VRB_Face_Cylinder_Right = VIEW1.GetIntent("Vert_Rnd_Bar", "Face_Cylinder", PointIntentEnum.kCircularRightPointIntent)
Dim VRB_Face_Cylinder_Top = VIEW1.GetIntent("Vert_Rnd_Bar", "Face_Cylinder", PointIntentEnum.kCircularTopPointIntent)

' Declare access to drawing dimensions
Dim genDims = Sheet_1.DrawingDimensions.GeneralDimensions

' Add the dimensions
Try
	genDims.AddLinear("Dim01", VIEW1.SheetPoint(0.5, -0.1875), VFB_Face_Left, VRB_Face_Cylinder_Right, DimensionTypeEnum.kHorizontalDimensionType)
	genDims.AddLinear("Dim02", VIEW1.SheetPoint(-0.03125, 0), VFB_Face_Bottom, VRB_Face_Cylinder_Top, DimensionTypeEnum.kVerticalDimensionType)
Catch ex As Exception
	MsgBox("Error: ", ex.Message )
End Try
```

#### Code Block 4

```vb
' Get sheet and view
Dim Sheet_1 = ThisDrawing.Sheets.ItemByName("Sheet:1")
Dim VIEW1 = Sheet_1.DrawingViews.ItemByName("VIEW1")

' Get named entities
Dim VFB_Face_Left = VIEW1.GetIntent("Vert_Flat_Bar_01", "Face_Left", PointIntentEnum.kEndPointIntent)
Dim VFB_Face_Bottom = VIEW1.GetIntent("Vert_Flat_Bar_01", "Face_Bottom", PointIntentEnum.kEndPointIntent)
Dim VRB_Face_Cylinder_Right = VIEW1.GetIntent("Vert_Rnd_Bar", "Face_Cylinder", PointIntentEnum.kCircularRightPointIntent)
Dim VRB_Face_Cylinder_Top = VIEW1.GetIntent("Vert_Rnd_Bar", "Face_Cylinder", PointIntentEnum.kCircularTopPointIntent)

' Declare access to drawing dimensions
Dim genDims = Sheet_1.DrawingDimensions.GeneralDimensions

' Add the dimensions
Try
	genDims.AddLinear("Dim01", VIEW1.SheetPoint(0.5, -0.1875), VFB_Face_Left, VRB_Face_Cylinder_Right, DimensionTypeEnum.kHorizontalDimensionType)
	genDims.AddLinear("Dim02", VIEW1.SheetPoint(-0.03125, 0), VFB_Face_Bottom, VRB_Face_Cylinder_Top, DimensionTypeEnum.kVerticalDimensionType)
Catch ex As Exception
	MsgBox("Error: ", ex.Message )
End Try
```

---

### 2. Excel Error with iLogic

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/excel-error-with-ilogic/td-p/13752877#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/excel-error-with-ilogic/td-p/13752877#messageview_0)

**Author:** layochim

**Date:** ‎08-04-2025
	
		
		08:01 AM

**Description:** I'm sure this is a common error, but I'm unable to fix it.  I've got a Pricing rule below that works the first time then when i modify a parameter i get the following.  Anyone have a solution for this?My code is:Dim Filename As String = "Straight Conveyor Pricing.xlsx" Dim SheetName As String = "Con...

**Code Snippets (2):**

#### Code Block 1

```vb
Dim Filename As String = "C:/Folder/Another Folder/Straight Conveyor Pricing.xlsx"
```

#### Code Block 2

```vb
Dim Filename As String = "C:/Folder/Another Folder/Straight Conveyor Pricing.xlsx"
```

#### Code Block 3

```vb
Dim Filename As String = "Straight Conveyor Pricing.xlsx"
Dim SheetName As String = "Conv costing"
GoExcel.Open(Filename, SheetName)

GoExcel.CellValue("B9") = BeltWidth
GoExcel.CellValue("B10") = BeltLength
GoExcel.CellValue("B11") = Infeed_End
GoExcel.CellValue("B12") = Discharge_End
GoExcel.CellValue("B13") = Legs
GoExcel.CellValue("B14") = Feet
GoExcel.CellValue("B15") = Belting
GoExcel.CellValue("B16") = BeltingType
GoExcel.CellValue("B17") = BeltColor
GoExcel.CellValue("B18") = Flights
GoExcel.CellValue("B19") = Flight_Spacing
GoExcel.CellValue("B20") = Construction
GoExcel.CellValue("B21") = FlangeHeight
GoExcel.CellValue("B22") = Finish
GoExcel.CellValue("B24") = Drive_Style
GoExcel.CellValue("B25") = Drive_Position
GoExcel.CellValue("B26") = MotorVoltage
GoExcel.CellValue("B27") = Drive_Speed
GoExcel.CellValue("B28") = Motor
GoExcel.CellValue("B29") = Gearbox
GoExcel.CellValue("B30") = AdjustableGuides
GoExcel.CellValue("B31") = BeltLifters
GoExcel.CellValue("B32") = DripPan
GoExcel.CellValue("B33") = BeltScraper
GoExcel.CellValue("B34") = SprayBar
GoExcel.CellValue("B35") = GearboxGuards

Price = GoExcel.CellValue("B6")

GoExcel.Save
GoExcel.Close
```

#### Code Block 4

```vb
Dim Filename As String = "Straight Conveyor Pricing.xlsx"
Dim SheetName As String = "Conv costing"
GoExcel.Open(Filename, SheetName)

GoExcel.CellValue("B9") = BeltWidth
GoExcel.CellValue("B10") = BeltLength
GoExcel.CellValue("B11") = Infeed_End
GoExcel.CellValue("B12") = Discharge_End
GoExcel.CellValue("B13") = Legs
GoExcel.CellValue("B14") = Feet
GoExcel.CellValue("B15") = Belting
GoExcel.CellValue("B16") = BeltingType
GoExcel.CellValue("B17") = BeltColor
GoExcel.CellValue("B18") = Flights
GoExcel.CellValue("B19") = Flight_Spacing
GoExcel.CellValue("B20") = Construction
GoExcel.CellValue("B21") = FlangeHeight
GoExcel.CellValue("B22") = Finish
GoExcel.CellValue("B24") = Drive_Style
GoExcel.CellValue("B25") = Drive_Position
GoExcel.CellValue("B26") = MotorVoltage
GoExcel.CellValue("B27") = Drive_Speed
GoExcel.CellValue("B28") = Motor
GoExcel.CellValue("B29") = Gearbox
GoExcel.CellValue("B30") = AdjustableGuides
GoExcel.CellValue("B31") = BeltLifters
GoExcel.CellValue("B32") = DripPan
GoExcel.CellValue("B33") = BeltScraper
GoExcel.CellValue("B34") = SprayBar
GoExcel.CellValue("B35") = GearboxGuards

Price = GoExcel.CellValue("B6")

GoExcel.Save
GoExcel.Close
```

---

### 3. Overridden Balloons

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/overridden-balloons/td-p/13699659#messageview_0](https://forums.autodesk.com/t5/inventor-programming-forum/overridden-balloons/td-p/13699659#messageview_0)

**Author:** gerardo_arellanoPYCV8

**Date:** ‎06-26-2025
	
		
		07:21 AM

**Description:** Hello, I've been working with a macro that iterates through the balloons in a drawing with the intention of compare the balloons to the BOM.  I've tried several ways and did not work.The main issue is getting the information of overridden balloons like this format = (item / qty).I want to get the in...

**Code Snippets (6):**

#### Code Block 1

```vb
Dim balloonType As BalloonTypeEnum
Dim balloonTypeData As Variant
Call oBalloon.GetBalloonType(balloonType, balloonTypeData)
Debug.Print "Balloon type = " & balloonType
```

#### Code Block 2

```vb
Dim balloonType As BalloonTypeEnum
Dim balloonTypeData As Variant
Call oBalloon.GetBalloonType(balloonType, balloonTypeData)
Debug.Print "Balloon type = " & balloonType
```

#### Code Block 3

```vb
Dim balloonType As BalloonTypeEnum
Dim balloonTypeData As Variant
Call oBalloon.GetBalloonType(balloonType, balloonTypeData)
Debug.Print "Balloon type = " & balloonType
```

#### Code Block 4

```vb
Dim balloonType As BalloonTypeEnum
Dim balloonTypeData As Variant
Call oBalloon.GetBalloonType(balloonType, balloonTypeData)
Debug.Print "Balloon type = " & balloonType
```

#### Code Block 5

```vb
Select Case oBalloon.GetBalloonType
```

#### Code Block 6

```vb
Select Case oBalloon.GetBalloonType
```

#### Code Block 7

```vb
Select Case oBalloon.GetBalloonType
```

#### Code Block 8

```vb
Select Case oBalloon.GetBalloonType
```

#### Code Block 9

```vb
Select Case oBalloon.Type
```

#### Code Block 10

```vb
Select Case oBalloon.Type
```

#### Code Block 11

```vb
Select Case oBalloon.Type
```

#### Code Block 12

```vb
Select Case oBalloon.Type
```

---

### 4. Using GoExcel to read a embedded spreadsheet

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/using-goexcel-to-read-a-embedded-spreadsheet/td-p/13788308](https://forums.autodesk.com/t5/inventor-programming-forum/using-goexcel-to-read-a-embedded-spreadsheet/td-p/13788308)

**Author:** harvey_craig2RCUH

**Date:** ‎08-29-2025
	
		
		02:04 AM

**Description:** I can't get GoExcel to read a cell in an embedded spreadsheet. The spreadsheet has one cell:I've embedded it using the UI:This is my local rule:MsgBox(GoExcel.CellValue("3rd Party:Embedding 1", "Sheet1", "A1")) And this is my error:I have tried both these options in the options:Both get the same obj...

**Code Snippets (1):**

#### Code Block 1

```vb
MsgBox(GoExcel.CellValue("3rd Party:Embedding 1", "Sheet1", "A1"))
```

#### Code Block 2

```vb
MsgBox(GoExcel.CellValue("3rd Party:Embedding 1", "Sheet1", "A1"))
```

---

### 5. iLogic code to zip files suddenly stopped working

**URL:** [https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-code-to-zip-files-suddenly-stopped-working/td-p/13180134](https://forums.autodesk.com/t5/inventor-programming-forum/ilogic-code-to-zip-files-suddenly-stopped-working/td-p/13180134)

**Author:** b.graaf

**Date:** ‎11-28-2024
	
		
		07:04 AM

**Description:** Hi! I have an iLogic code which generate several stepfiles and add them into a new created compressed folder (ZIP).I am using it in several Inventor versions and we are now on the latest Inventor professional 2025. I have used this iLogic rule about a year ago for the last time and now it suddenly d...

**Code Snippets (7):**

#### Code Block 1

```vb
AddReference "C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.8\System.IO.Compression.FileSystem.dll"
```

#### Code Block 2

```vb
AddReference "C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.8\System.IO.Compression.FileSystem.dll"
```

#### Code Block 3

```vb
AddReference "C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.8\System.IO.Compression.FileSystem.dll"
```

#### Code Block 4

```vb
AddReference "C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.8\System.IO.Compression.FileSystem.dll"
```

#### Code Block 5

```vb
AddReference "System.IO.Compression"
AddReference "System.IO.Compression.FileSystem"
```

#### Code Block 6

```vb
AddReference "System.IO.Compression"
AddReference "System.IO.Compression.FileSystem"
```

#### Code Block 7

```vb
AddReference "System.IO.Compression"
AddReference "System.IO.Compression.FileSystem"
```

#### Code Block 8

```vb
AddReference "System.IO.Compression"
AddReference "System.IO.Compression.FileSystem"
```

#### Code Block 9

```vb
System.IO.Compression.FileSystem
```

#### Code Block 10

```vb
System.IO.Compression.FileSystem
```

#### Code Block 11

```vb
System.IO.Compression.ZipFile.CreateFromDirectory(_export_Location, _ZipFileName)
```

#### Code Block 12

```vb
System.IO.Compression.ZipFile.CreateFromDirectory(_export_Location, _ZipFileName)
```

#### Code Block 13

```vb
System.IO.Compression.ZipFile.CreateFromDirectory(_export_Location, _ZipFileName)
```

#### Code Block 14

```vb
System.IO.Compression.ZipFile.CreateFromDirectory(_export_Location, _ZipFileName)
```

---

